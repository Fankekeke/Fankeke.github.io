<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="前端魔法堂——异常不仅仅是try/catch"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>前端魔法堂——异常不仅仅是try/catch | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/01pro19uo0mo/",
				"appid": "1613049289050283", 
				"title": "前端魔法堂——异常不仅仅是try/catch | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-28T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/qkwk8zpexyr/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/6d06t5g3t75/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f01pro19uo0mo%2f&text=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e5%bc%82%e5%b8%b8%e4%b8%8d%e4%bb%85%e4%bb%85%e6%98%aftry%2fcatch"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f01pro19uo0mo%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f01pro19uo0mo%2f&text=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e5%bc%82%e5%b8%b8%e4%b8%8d%e4%bb%85%e4%bb%85%e6%98%aftry%2fcatch"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f01pro19uo0mo%2f&title=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e5%bc%82%e5%b8%b8%e4%b8%8d%e4%bb%85%e4%bb%85%e6%98%aftry%2fcatch"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f01pro19uo0mo%2f&is_video=false&description=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e5%bc%82%e5%b8%b8%e4%b8%8d%e4%bb%85%e4%bb%85%e6%98%aftry%2fcatch"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e5%bc%82%e5%b8%b8%e4%b8%8d%e4%bb%85%e4%bb%85%e6%98%aftry%2fcatch&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f01pro19uo0mo%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f01pro19uo0mo%2f&title=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e5%bc%82%e5%b8%b8%e4%b8%8d%e4%bb%85%e4%bb%85%e6%98%aftry%2fcatch"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f01pro19uo0mo%2f&title=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e5%bc%82%e5%b8%b8%e4%b8%8d%e4%bb%85%e4%bb%85%e6%98%aftry%2fcatch"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f01pro19uo0mo%2f&title=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e5%bc%82%e5%b8%b8%e4%b8%8d%e4%bb%85%e4%bb%85%e6%98%aftry%2fcatch"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f01pro19uo0mo%2f&title=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e5%bc%82%e5%b8%b8%e4%b8%8d%e4%bb%85%e4%bb%85%e6%98%aftry%2fcatch"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">前端魔法堂——异常不仅仅是try/catch</h1><div class="meta"><div class="postdate"><time datetime="2018-12-28" itemprop="datePublished">2018-12-28</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e前言\x3c\/h2\x3e\n\x3cp\x3e 编程时我们往往拿到的是业务流程正确的业务说明文档或规范，但实际开发中却布满荆棘和例外情况，而这些例外中包含业务用例的例外，也包含技术上的例外。对于业务用例的例外我们别无它法，必须要求实施人员与用户共同提供合理的解决方案；而技术上的例外，则必须由我们码农们手刃之，而这也是我想记录的内容。\x3cbr\x3e 我打算分成\x3ca href=\x22http:\/\/www.cnblogs.com\/fsjohnhuang\/p\/7685144.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e《前端魔法堂——异常不仅仅是try\/catch》\x3c\/a\x3e和《前端魔法堂——调用栈，异常实例中的宝藏》两篇分别叙述内置\/自定义异常类，捕获运行时异常\/语法异常\/网络请求异常\/PromiseRejection事件，什么是调用栈和如何获取调用栈的相关信息。\x3cbr\x3e 是不是未出发就已经很期待呢？好吧，大家捉紧扶手，老司机要开车了^_^\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e概要\x3c\/h2\x3e\n\x3cp\x3e 本篇将叙述如下内容：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3ca href=\x22#\x22\x3e异常还是错误？它会如何影响我们的代码？\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22#\x22\x3e内置异常类型有哪些？\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22#\x22\x3e动手写自己的异常类型吧！\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22#\x22\x3e捕获“同步代码”中的\x22运行时异常\x22，用\x3ccode\x3etry\/catch\x3c\/code\x3e就够了。\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22#\x22\x3e\x22万能\x22异常捕获者\x3ccode\x3ewindow.onerror\x3c\/code\x3e，真的万能吗？\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22#\x22\x3ePromise.reject也抛异常，怎么办？\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22#\x22\x3e404等网络请求异常真心要后之后觉吗？\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e一.异常还是错误？它会如何影响我们的代码？\x3c\/h2\x3e\n\x3cp\x3e 在学习Java时我们会被告知异常(Exception)和错误(Error)是不一样的，异常是不会导致进程终止从而可以被修复(try\/catch)，但错误将会导致进程终止因此不能被修复。当对于JavaScript而言，我们要面对的仅仅有异常（虽然异常类名为Error或含Error字样），异常的出现不会导致JavaScript引擎崩溃，最多就是让当前执行的任务终止而已。\x3cbr\x3e 上面说到异常的出现最多就是让当前执行的任务终止，到底是什么意思呢？这里就涉及到Event Loop的原理了，下面我尝试用代码大致说明吧。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript\x3e\n  \/\/ 1.当前代码块将作为一个任务压入任务队列中，JavaScript线程会不断地从任务队列中提取任务执行；\n  \/\/ 2.当任务执行过程中报异常，且异常没有捕获处理，则会一路沿着调用栈从顶到底抛出，最终终止当前任务的执行；\n  \/\/ 3.JavaScript线程会继续从任务队列中提取下一个任务继续执行。\n  function a(){throw Error(\x26quot;test\x26quot;)}\n  function b(){a()}\n  b()\n  console.log(\x26quot;永远不会执行！\x26quot;)\n\x3c\/script\x3e\n\x3cscript\x3e\n  \/\/ 下一个任务\n  console.log(\x26quot;你有你抛异常，我照样执行！\x26quot;)\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1.当前代码块将作为一个任务压入任务队列中，JavaScript线程会不断地从任务队列中提取任务执行；\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2.当任务执行过程中报异常，且异常没有捕获处理，则会一路沿着调用栈从顶到底抛出，最终终止当前任务的执行；\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 3.JavaScript线程会继续从任务队列中提取下一个任务继续执行。\x3c\/span\x3e\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ea\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22test\x22\x3c\/span\x3e)}\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eb\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{a()}\n  b()\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22永远不会执行！\x22\x3c\/span\x3e)\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 下一个任务\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22你有你抛异常，我照样执行！\x22\x3c\/span\x3e)\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e二.内置异常类型有哪些？\x3c\/h2\x3e\n\x3cp\x3e 说到内置异常类那么必先提到的就是\x3ccode\x3eError\x3c\/code\x3e这个祖先类型了，其他所有的内置异常类和自定义类都必须继承它。而它的标准属性和方法就以下这寥寥几个而已\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@prop {String} name - 异常名称\n@prop {String} message - 供人类阅读的异常信息\n@prop {Function} constructor - 类型构造器\n@method toString():String - 输出异常信息\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs delphi\x22\x3e\x3ccode\x3e@prop \x3cspan class=\x22hljs-comment\x22\x3e{String}\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ename\x3c\/span\x3e - 异常名称\n@prop \x3cspan class=\x22hljs-comment\x22\x3e{String}\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3emessage\x3c\/span\x3e - 供人类阅读的异常信息\n@prop \x3cspan class=\x22hljs-comment\x22\x3e{Function}\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e - 类型构造器\n@\x3cspan class=\x22hljs-title\x22\x3emethod\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etoString\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e:\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3eString\x3c\/span\x3e - 输出异常信息\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 由于标准属性实在太少，无法提供更有效的信息供开发者定位异常发生的位置和重现事故现场，因此各浏览器厂家均手多多的自己增加些属性，然后逐渐成了事实标准。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@prop {String} fileName - 异常发生的脚本URI\n@prop {number} lineNumber - 异常发生的行号\n@prop {number} columnNumber - 异常发生的列号\n@prop {String} stack - 异常发生时的调用栈信息，IE10及以上才支持\n@method toSource():String - 异常发生的脚本内容\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs oxygene\x22\x3e\x3ccode\x3e@prop \x3cspan class=\x22hljs-comment\x22\x3e{String}\x3c\/span\x3e fileName - 异常发生的脚本URI\n@prop \x3cspan class=\x22hljs-comment\x22\x3e{number}\x3c\/span\x3e lineNumber - 异常发生的行号\n@prop \x3cspan class=\x22hljs-comment\x22\x3e{number}\x3c\/span\x3e columnNumber - 异常发生的列号\n@prop \x3cspan class=\x22hljs-comment\x22\x3e{String}\x3c\/span\x3e stack - 异常发生时的调用栈信息，IE10及以上才支持\n@\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3emethod\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etoSource\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e:\x3c\/span\x3eString - 异常发生的脚本内容\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e另外巨硬还新增以下两个属性\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@prop {String} description - 和message差不多\n@prop {number} number - 异常类型的编号，巨硬为每个异常设置了一个唯一的编号\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs autoit\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-symbol\x22\x3e@prop\x3c\/span\x3e {\x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e} description - 和message差不多\n\x3cspan class=\x22hljs-symbol\x22\x3e@prop\x3c\/span\x3e {\x3cspan class=\x22hljs-built_in\x22\x3enumber\x3c\/span\x3e} \x3cspan class=\x22hljs-built_in\x22\x3enumber\x3c\/span\x3e - 异常类型的编号，巨硬为每个异常设置了一个唯一的编号\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 那么现在我要实例化一个Error对象，只需调用\x3ccode\x3eError()\x3c\/code\x3e或\x3ccode\x3enew Error()\x3c\/code\x3e即可；若想同时设置message，则改为\x3ccode\x3eError(\x22test\x22)\x3c\/code\x3e或\x3ccode\x3enew Error(\x22test\x22)\x3c\/code\x3e。其实Error的构造函数签名是这样的\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@constructor\n@param {String=} message - 设置message属性\n@param {String=} fileName - 设置fileName属性\n@param {number=} lineNumber - 设置lineNUmber属性\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs delphi\x22\x3e\x3ccode\x3e@\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e\n@\x3cspan class=\x22hljs-title\x22\x3eparam\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e{String=}\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emessage\x3c\/span\x3e - 设置\x3cspan class=\x22hljs-title\x22\x3emessage\x3c\/span\x3e属性\n@\x3cspan class=\x22hljs-title\x22\x3eparam\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e{String=}\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efileName\x3c\/span\x3e - 设置\x3cspan class=\x22hljs-title\x22\x3efileName\x3c\/span\x3e属性\n@\x3cspan class=\x22hljs-title\x22\x3eparam\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e{number=}\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3elineNumber\x3c\/span\x3e - 设置\x3cspan class=\x22hljs-title\x22\x3elineNUmber\x3c\/span\x3e属性\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e现在我们看看具体有哪些内置的异常类型吧！\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3cstrong\x3eEvalError\x3c\/strong\x3e，调用\x3ccode\x3eeval()\x3c\/code\x3e时发生的异常，已被废弃只用于向后兼容而已\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eInternalError\x3c\/strong\x3e，JavaScript引擎内部异常，FireFox独门提供的！\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eRangeError\x3c\/strong\x3e，当函数实参越界时发生，如\x3ccode\x3eArray\x3c\/code\x3e，\x3ccode\x3eNumber.toExponential\x3c\/code\x3e,\x3ccode\x3eNumber.toFixed\x3c\/code\x3e和\x3ccode\x3eNumber.toPrecision\x3c\/code\x3e时入参非法时。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eReferenceError\x3c\/strong\x3e，当引用未声明的变量时发生\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eSyntaxError\x3c\/strong\x3e，解析时发生语法错误\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eTypeError\x3c\/strong\x3e，当值不是所期待的类型时，\x3ccode\x3enull.f()\x3c\/code\x3e也报这个错\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eURIError\x3c\/strong\x3e，当传递一个非法的URI给全局URI处理函数时发生，如\x3ccode\x3edecodeURIComponent(\x27%\x27)\x3c\/code\x3e，即\x3ccode\x3edecodeURIComponent\x3c\/code\x3e，\x3ccode\x3edecodeURI\x3c\/code\x3e,\x3ccode\x3eencodeURIComponent\x3c\/code\x3e，\x3ccode\x3eencodeURI\x3c\/code\x3e\n\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e三.动手写自己的异常类型吧！\x3c\/h2\x3e\n\x3cp\x3e 关于在StackOverflow上早有人讨论如何自定义异常类型了\x3ca href=\x22https:\/\/stackoverflow.com\/questions\/1382107\/whats-a-good-way-to-extend-error-in-javascript\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e参考\x3c\/a\x3e\x3cbr\x3e于是我们顺手拈来即可\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function MyError(message, fileName, lineNumber){\n  if (this instanceof MyError);else return new MyError(message, fileName, lineNumber)\n  this.message = message || \x26quot;\x26quot;\n  if (fileName){ this.fileName = fileName }\n  if (lineNumber){ this.lineNumber = lineNumber }\n}\n\nvar proto = MyError.prototype = Object.create(Error.prototype)\nproto.name = \x26quot;MyError\x26quot;\nproto.constructor = MyError\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eMyError\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3emessage, fileName, lineNumber\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3einstanceof\x3c\/span\x3e MyError);\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e MyError(message, fileName, lineNumber)\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.message = message || \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (fileName){ \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.fileName = fileName }\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (lineNumber){ \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.lineNumber = lineNumber }\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e proto = MyError.prototype = \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.create(\x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e.prototype)\nproto.name = \x3cspan class=\x22hljs-string\x22\x3e\x22MyError\x22\x3c\/span\x3e\nproto.constructor = MyError\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ecljs实现如下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22(defn ^export MyError [\x26amp; args]\n  (this-as this\n    (if (instance? MyError this)\n      (let [ps [\x26quot;message\x26quot; \x26quot;fileName\x26quot; \x26quot;lineNumber\x26quot;]\n            idxs (-\x3e (min (count args) (count ps)) range)]\n        (reduce\n          (fn [accu i]\n            (aset accu (nth ps i) (nth args i))\n            accu)\n          this\n          idxs))\n      (apply new MyError args))))\n\n(def proto\n  (aset MyError \x26quot;prototype\x26quot; (.create js\/Object (.-prototype Error))))\n(aset proto \x26quot;name\x26quot; \x26quot;MyError\x26quot;)\n(aset proto \x26quot;constructor\x26quot; MyError)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs clojure\x22\x3e\x3ccode\x3e(\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3edefn\x3c\/span\x3e\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e^export\x3c\/span\x3e MyError [\x26amp; args]\n  (\x3cspan class=\x22hljs-name\x22\x3ethis-as\x3c\/span\x3e this\n    (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3eif\x3c\/span\x3e\x3c\/span\x3e (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3einstance?\x3c\/span\x3e\x3c\/span\x3e MyError this)\n      (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3elet\x3c\/span\x3e\x3c\/span\x3e [ps [\x3cspan class=\x22hljs-string\x22\x3e\x22message\x22\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22fileName\x22\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22lineNumber\x22\x3c\/span\x3e]\n            idxs (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3e-\x26gt;\x3c\/span\x3e\x3c\/span\x3e (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3emin\x3c\/span\x3e\x3c\/span\x3e (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3ecount\x3c\/span\x3e\x3c\/span\x3e args) (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3ecount\x3c\/span\x3e\x3c\/span\x3e ps)) range)]\n        (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3ereduce\x3c\/span\x3e\x3c\/span\x3e\n          (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3efn\x3c\/span\x3e\x3c\/span\x3e [accu i]\n            (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3easet\x3c\/span\x3e\x3c\/span\x3e accu (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3enth\x3c\/span\x3e\x3c\/span\x3e ps i) (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3enth\x3c\/span\x3e\x3c\/span\x3e args i))\n            accu)\n          this\n          idxs))\n      (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3eapply\x3c\/span\x3e\x3c\/span\x3e new MyError args))))\n\n(\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3edef\x3c\/span\x3e\x3c\/span\x3e proto\n  (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3easet\x3c\/span\x3e\x3c\/span\x3e MyError \x3cspan class=\x22hljs-string\x22\x3e\x22prototype\x22\x3c\/span\x3e (\x3cspan class=\x22hljs-name\x22\x3e.create\x3c\/span\x3e js\/Object (\x3cspan class=\x22hljs-name\x22\x3e.-prototype\x3c\/span\x3e Error))))\n(\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3easet\x3c\/span\x3e\x3c\/span\x3e proto \x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22MyError\x22\x3c\/span\x3e)\n(\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3easet\x3c\/span\x3e\x3c\/span\x3e proto \x3cspan class=\x22hljs-string\x22\x3e\x22constructor\x22\x3c\/span\x3e MyError)\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e四.捕获“同步代码”中的\x22运行时异常\x22，用\x3ccode\x3etry\/catch\x3c\/code\x3e就够了\x3c\/h2\x3e\n\x3cp\x3e 为了防止由于异常的出现，导致正常代码被略过的风险，我们习惯采取\x3ccode\x3etry\/catch\x3c\/code\x3e来捕获并处理异常。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22try{\n  throw Error(\x26quot;unexpected operation happen...\x26quot;)\n}\ncatch (e){\n  console.log(e.message)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22unexpected operation happen...\x22\x3c\/span\x3e)\n}\n\x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (e){\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(e.message)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ecljs写法\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22(try\n  (throw (Error. \x26quot;unexpected operation happen...\x26quot;)\n  (catch e\n         (println (.-message e)))))\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs clojure\x22\x3e\x3ccode\x3e(\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3etry\x3c\/span\x3e\x3c\/span\x3e\n  (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3ethrow\x3c\/span\x3e\x3c\/span\x3e (\x3cspan class=\x22hljs-name\x22\x3eError.\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22unexpected operation happen...\x22\x3c\/span\x3e)\n  (\x3cspan class=\x22hljs-name\x22\x3ecatch\x3c\/span\x3e e\n         (\x3cspan class=\x22hljs-name\x22\x3eprintln\x3c\/span\x3e (\x3cspan class=\x22hljs-name\x22\x3e.-message\x3c\/span\x3e e)))))\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 很多时我们会以为这样书写就万事大吉了，但其实\x3ccode\x3etry\/catch\x3c\/code\x3e能且仅能捕获“同步代码”中的\x22运行时异常\x22。\x3cbr\x3e1.\x22同步代码\x22就是说无法获取如\x3ccode\x3esetTimeout\x3c\/code\x3e、\x3ccode\x3ePromise\x3c\/code\x3e等异步代码的异常，也就是说\x3ccode\x3etry\/catch\x3c\/code\x3e仅能捕获当前任务的异常，\x3ccode\x3esetTimeout\x3c\/code\x3e等异步代码是在下一个EventLoop中执行。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 真心捕获不到啊亲～！\ntry{\n  setTimeout(function(){\n    throw Error(\x26quot;unexpected operation happen...\x26quot;)\n  }, 0)\n} catch(e){\n  console.log(e)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 真心捕获不到啊亲～！\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e{\n  setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22unexpected operation happen...\x22\x3c\/span\x3e)\n  }, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\n} \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(e){\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(e)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.\x22运行时异常\x22是指非SyntaxError，也就是语法错误是无法捕获的，因为在解析JavaScript源码时就报错了，还怎么捕获呢～～\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 非法标识符a-\x3eb，真心捕获不到啊亲～！\ntry{\n  a-\x3eb = 1\n} catch(e){\n  console.log(e)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cpp\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 非法标识符a-\x26gt;b，真心捕获不到啊亲～！\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e{\n  a-\x26gt;b = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n} \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(e){\n  console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(e)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 这时大家会急不可待地问：“异步代码的异常咋办呢？语法异常咋办呢？”在解答上述疑问前，我们先偏离一下，稍微挖挖\x3ccode\x3ethrow\x3c\/code\x3e语句的特性。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e\n\x3ccode\x3ethrow\x3c\/code\x3e后面可以跟什么啊？\x3c\/h3\x3e\n\x3cp\x3e 一般而言我们会\x3ccode\x3ethrow\x3c\/code\x3e一个Error或其子类的实例(如\x3ccode\x3ethrow Error()\x3c\/code\x3e)，其实我们\x3ccode\x3ethrow\x3c\/code\x3e任何类型的数据（如\x3ccode\x3ethrow 1\x3c\/code\x3e,\x3ccode\x3ethrow \x22test\x22\x3c\/code\x3e,\x3ccode\x3ethrow true\x3c\/code\x3e等）。但即使可以抛出任意类型的数据，我们还是要坚持抛出Error或其子类的实例。这是为什么呢？\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22try{\n  throw \x26quot;unexpected operation happen...\x26quot;\n} catch(e){\n  console.log(e)\n}\n\ntry{\n  throw TypeError(\x26quot;unexpected operation happen...\x26quot;)\n} catch(e){\n  if (\x26quot;TypeError\x26quot; == e.name){\n    \/\/ Do something1\n  }\n  else if (\x26quot;RangeError\x26quot; == e.name){\n    \/\/ Do something2\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs sqf\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22unexpected operation happen...\x22\x3c\/span\x3e\n} \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(e){\n  console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(e)\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e TypeError(\x3cspan class=\x22hljs-string\x22\x3e\x22unexpected operation happen...\x22\x3c\/span\x3e)\n} \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(e){\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x22TypeError\x22\x3c\/span\x3e == e.\x3cspan class=\x22hljs-built_in\x22\x3ename\x3c\/span\x3e){\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Do something1\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x22RangeError\x22\x3c\/span\x3e == e.\x3cspan class=\x22hljs-built_in\x22\x3ename\x3c\/span\x3e){\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Do something2\x3c\/span\x3e\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 原因显然易见——异常发生时提供信息越全越好，更容易追踪定位重现问题嘛！\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e五.\x22万能\x22异常捕获者\x3ccode\x3ewindow.onerror\x3c\/code\x3e，真的万能吗？\x3c\/h2\x3e\n\x3cp\x3e 在每个可能发生异常的地方都写上\x3ccode\x3etry\/catch\x3c\/code\x3e显然是不实际的(另外还存在性能问题)，即使是罗嗦如Java我们开发时也就是不断声明\x3ccode\x3ethrows\x3c\/code\x3e，然后在顶层处理异常罢了。那么，JavaScript中对应的顶层异常处理入口又在哪呢？木有错，就是在\x3ccode\x3ewindow.onerror\x3c\/code\x3e。看看方法签名吧\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@description window.onerror处理函数\n@param {string} message - 异常信息\x26quot;\n@param {string} source  - 发生异常的脚本的URI\n@param {number} lineno  - 发生异常的脚本行号\n@param {number} colno   - 发生异常的脚本列号\n@param {?Error} error   - Error实例，Safari和IE10中没有这个实参\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode\x3e@\x3cspan class=\x22hljs-keyword\x22\x3edescription\x3c\/span\x3e window.onerror处理函数\n@param {\x3cspan class=\x22hljs-selector-tag\x22\x3estring\x3c\/span\x3e} \x3cspan class=\x22hljs-selector-tag\x22\x3emessage\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3e-\x3c\/span\x3e 异常信息\x22\n@\x3cspan class=\x22hljs-keyword\x22\x3eparam\x3c\/span\x3e {\x3cspan class=\x22hljs-selector-tag\x22\x3estring\x3c\/span\x3e} \x3cspan class=\x22hljs-selector-tag\x22\x3esource\x3c\/span\x3e  \x3cspan class=\x22hljs-selector-tag\x22\x3e-\x3c\/span\x3e 发生异常的脚本的\x3cspan class=\x22hljs-selector-tag\x22\x3eURI\x3c\/span\x3e\n@\x3cspan class=\x22hljs-keyword\x22\x3eparam\x3c\/span\x3e {\x3cspan class=\x22hljs-selector-tag\x22\x3enumber\x3c\/span\x3e} \x3cspan class=\x22hljs-selector-tag\x22\x3elineno\x3c\/span\x3e  \x3cspan class=\x22hljs-selector-tag\x22\x3e-\x3c\/span\x3e 发生异常的脚本行号\n@\x3cspan class=\x22hljs-keyword\x22\x3eparam\x3c\/span\x3e {\x3cspan class=\x22hljs-selector-tag\x22\x3enumber\x3c\/span\x3e} \x3cspan class=\x22hljs-selector-tag\x22\x3ecolno\x3c\/span\x3e   \x3cspan class=\x22hljs-selector-tag\x22\x3e-\x3c\/span\x3e 发生异常的脚本列号\n@\x3cspan class=\x22hljs-keyword\x22\x3eparam\x3c\/span\x3e {?\x3cspan class=\x22hljs-selector-tag\x22\x3eError\x3c\/span\x3e} \x3cspan class=\x22hljs-selector-tag\x22\x3eerror\x3c\/span\x3e   \x3cspan class=\x22hljs-selector-tag\x22\x3e-\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3eError\x3c\/span\x3e实例，\x3cspan class=\x22hljs-selector-tag\x22\x3eSafari\x3c\/span\x3e和\x3cspan class=\x22hljs-selector-tag\x22\x3eIE10\x3c\/span\x3e中没有这个实参\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 这时我们就可以通过它捕获除了\x3ccode\x3etry\/catch\x3c\/code\x3e能捕获的异常外，还可以捕获\x3ccode\x3esetTimeout\x3c\/code\x3e等的异步代码异常，语法错误。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22window.onerror = function(message, source, lineno, colno, error){\n  \/\/ Do something you like.\n}\n\nsetTimeout(function(){ throw Error(\x26quot;oh no!\x26quot;) }, 0)\na-\x3eb = 1\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.onerror = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3emessage, source, lineno, colno, error\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Do something you like.\x3c\/span\x3e\n}\n\nsetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22oh no!\x22\x3c\/span\x3e) }, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\na-\x26gt;b = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 这样就满足了吗？还没出大杀技呢——屏蔽异常、屏蔽、屏～～\x3cbr\x3e 只有onerror函数返回\x3ccode\x3etrue\x3c\/code\x3e时，异常就不会继续向上抛(否则继续上抛就成了Uncaught Error了)。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 有异常没问题啊，因为我看不到^_^\nwindow.onerror = function(){return true}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 有异常没问题啊，因为我看不到^_^\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.onerror = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 现在回到标题的疑问中，有了onerror就可以捕获所有异常了吗？答案又是否定的（我的娘啊，还要折腾多久啊～0～）\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3eChrome中对于跨域脚本所报的异常，虽然onerror能够捕获，但统一报\x3ccode\x3eScript Error\x3c\/code\x3e。若要得到正确的错误信息，则要配置跨域资源共享CORS才可以。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3ewindow.onerror\x3c\/code\x3e实际上采用的事件冒泡的机制捕获异常，并且在冒泡(bubble)阶段时才触发，因此像网络请求异常这些不会冒泡的异常是无法捕获的。\x3c\/li\x3e\n\x3cli\x3ePromise.reject产生的未被catch的异常，\x3ccode\x3ewindow.onerror\x3c\/code\x3e也是无能为力。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e六.Promise.reject也抛异常，怎么办？\x3c\/h2\x3e\n\x3cp\x3e 通过Promise来处理复杂的异步流程控制让我们得心应手，但倘若其中出现异常或Promise实例状态变为rejected时，会是怎样一个状况，我们又可以如何处理呢？\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3ePromise是如何标识异常发生的？\x3c\/h3\x3e\n\x3cp\x3e Promise实例的初始化状态是pending，而发生异常时则为rejected，而导致状态从pending转变为rejected的操作有\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e调用\x3ccode\x3ePromise.reject\x3c\/code\x3e类方法\x3c\/li\x3e\n\x3cli\x3e在工厂方法中调用\x3ccode\x3ereject\x3c\/code\x3e方法\x3c\/li\x3e\n\x3cli\x3e在工厂方法或then回调函数中抛异常\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 方式1\nPromise.reject(\x26quot;anything you want\x26quot;)\n\n\/\/ 方式2\nnew Promise(function(resolve, reject) { reject(\x26quot;anything you want\x26quot;) })\n\n\/\/ 方式3\nnew Promise(function{ throw \x26quot;anything you want\x26quot; })\nnew Promise(function(r) { r(Error(\x26quot;anything you want\x26quot; ) }).then(function(e) { throw e })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 方式1\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(\x3cspan class=\x22hljs-string\x22\x3e\x22anything you want\x22\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 方式2\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) \x3c\/span\x3e{ reject(\x3cspan class=\x22hljs-string\x22\x3e\x22anything you want\x22\x3c\/span\x3e) })\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 方式3\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22anything you want\x22\x3c\/span\x3e })\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3er\x3c\/span\x3e) \x3c\/span\x3e{ r(\x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22anything you want\x22\x3c\/span\x3e ) }).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e e })\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 当Promise实例从pending转变为rejected时，和之前谈论到异常一样，要么被捕获处理，要么继续抛出直到成为\x3ccode\x3eUncaught(in promise) Error\x3c\/code\x3e为止。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e异常发生前就\x3ccode\x3ecatch\x3c\/code\x3e掉\x3c\/h3\x3e\n\x3cp\x3e 若在异常发生前我们已经调用\x3ccode\x3ecatch\x3c\/code\x3e方法来捕获异常，那么则相安无事\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new Promise(function(resolve, reject){\n  setTimeout(reject, 0)\n}).catch(function(e){\n  console.log(\x26quot;catch\x26quot;)\n  return \x26quot;bingo\x26quot;\n}).then(function(x){\n  console.log(x)\n})\n\n\/\/ 回显 bingo\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n  setTimeout(reject, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\n}).catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22catch\x22\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22bingo\x22\x3c\/span\x3e\n}).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ex\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(x)\n})\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 回显 bingo\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e专属于Promise的顶层异常处理\x3c\/h3\x3e\n\x3cp\x3e 若在异常发生前我们没有调用\x3ccode\x3ecatch\x3c\/code\x3e方法来捕获异常，还是可以通过\x3ccode\x3ewindow\x3c\/code\x3e的\x3ccode\x3eunhandledrejection\x3c\/code\x3e事件捕获异常的\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22window.addEventListener(\x26quot;unhandledrejection\x26quot;, function(e){\n  \/\/ Event新增属性\n  \/\/ @prop {Promise} promise - 状态为rejected的Promise实例\n  \/\/ @prop {String|Object} reason - 异常信息或rejected的内容\n\n  \/\/ 会阻止异常继续抛出，不让Uncaught(in promise) Error产生\n  e.preventDefault()\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x22unhandledrejection\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Event新增属性\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ @prop {Promise} promise - 状态为rejected的Promise实例\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ @prop {String|Object} reason - 异常信息或rejected的内容\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 会阻止异常继续抛出，不让Uncaught(in promise) Error产生\x3c\/span\x3e\n  e.preventDefault()\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e迟来的\x3ccode\x3ecatch\x3c\/code\x3e\n\x3c\/h3\x3e\n\x3cp\x3e 由于Promise实例可异步订阅其状态变化，也就是可以异步注册catch处理函数，这时其实已经抛出\x3ccode\x3eUncaught(in promise) Error\x3c\/code\x3e，但我们依然可以处理\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p = new Promise(function(resolve, reject){\n  setTimeout(reject, 0)\n})\nsetTimeout(function(){\n  p.catch(function(e){\n    console.log(\x26quot;catch\x26quot;)\n    return \x26quot;bingo\x26quot;\n  })\n}, 1000)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n  setTimeout(reject, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\n})\nsetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  p.catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22catch\x22\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22bingo\x22\x3c\/span\x3e\n  })\n}, \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 另外，还可以通过\x3ccode\x3ewindow\x3c\/code\x3e的\x3ccode\x3erejectionhandled\x3c\/code\x3e事件监听异步注册catch处理函数的行为\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22window.addEventListener(\x26quot;rejectionhandled\x26quot;, function(e){\n  \/\/ Event新增属性\n  \/\/ @prop {Promise} promise - 状态为rejected的Promise实例\n  \/\/ @prop {String|Object} reason - 异常信息或rejected的内容\n\n  \/\/ Uncaught(in promise) Error已经抛出，所以这句毫无意义^_^\n  e.preventDefault()\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x22rejectionhandled\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Event新增属性\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ @prop {Promise} promise - 状态为rejected的Promise实例\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ @prop {String|Object} reason - 异常信息或rejected的内容\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Uncaught(in promise) Error已经抛出，所以这句毫无意义^_^\x3c\/span\x3e\n  e.preventDefault()\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e注意：只有抛出\x3ccode\x3eUncaught(in promise) Error\x3c\/code\x3e后，异步catch才会触发该事件。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader13\x22\x3e七.404等网络请求异常真心要后之后觉吗？\x3c\/h2\x3e\n\x3cp\x3e 也许我们都遇到\x3ccode\x3e\x26lt;img src=\x22.\/404.png\x22\x26gt;\x3c\/code\x3e报404网络请求异常的情况，然后测试或用户保障怎么哪个哪个图标没有显示。其实我们我们可以通过以下方式捕获这类异常\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22window.addEventListener(\x26quot;error\x26quot;, function(e){\n  \/\/ Do something\n  console.log(e.bubbles) \/\/ 回显false\n}, true)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x22error\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Do something\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(e.bubbles) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 回显false\x3c\/span\x3e\n}, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 由于网络请求异常不会冒泡，因此必须在capture阶段捕获才可以。但还有一个问题是这种方式无法精确判断异常的HTTP状态是404还是500等，因此还是要配合服务端日志来排查分析才可以。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader14\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e 对异常和如何捕获异常仅仅是前端智能监控中的一小撮知识点，敬请期待后续另一小撮知识点《前端魔法堂——调用栈，异常实例中的宝藏》吧:D\x3cbr\x3e 尊重原创，转载请注明来自：\x3ca href=\x22http:\/\/www.cnblogs.com\/fsjohnhuang\/p\/7685144.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.cnblogs.com\/fsjohn...\x3c\/a\x3e ^_^肥仔John\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader15\x22\x3e参考\x3c\/h2\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/TypeError\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/developer.mozilla.org...\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22https:\/\/stackoverflow.com\/questions\/8504673\/how-to-detect-on-page-404-errors-using-javascript\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/stackoverflow.com\/que...\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>前端魔法堂——异常不仅仅是try/catch</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011602203">https://segmentfault.com/a/1190000011602203</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/01pro19uo0mo/" target="_blank">https://alili.tech/archive/01pro19uo0mo/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>