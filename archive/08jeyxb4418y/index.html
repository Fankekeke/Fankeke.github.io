<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="图解 React Virtual DOM"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>图解 React Virtual DOM | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/08jeyxb4418y/",
				"appid": "1613049289050283", 
				"title": "图解 React Virtual DOM | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-02T02:30:09"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/22dz06pd45s/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/aykt5yjb0qc/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f08jeyxb4418y%2f&text=%e5%9b%be%e8%a7%a3%20React%20Virtual%20DOM"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f08jeyxb4418y%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f08jeyxb4418y%2f&text=%e5%9b%be%e8%a7%a3%20React%20Virtual%20DOM"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f08jeyxb4418y%2f&title=%e5%9b%be%e8%a7%a3%20React%20Virtual%20DOM"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f08jeyxb4418y%2f&is_video=false&description=%e5%9b%be%e8%a7%a3%20React%20Virtual%20DOM"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%9b%be%e8%a7%a3%20React%20Virtual%20DOM&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f08jeyxb4418y%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f08jeyxb4418y%2f&title=%e5%9b%be%e8%a7%a3%20React%20Virtual%20DOM"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f08jeyxb4418y%2f&title=%e5%9b%be%e8%a7%a3%20React%20Virtual%20DOM"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f08jeyxb4418y%2f&title=%e5%9b%be%e8%a7%a3%20React%20Virtual%20DOM"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f08jeyxb4418y%2f&title=%e5%9b%be%e8%a7%a3%20React%20Virtual%20DOM"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">图解 React Virtual DOM</h1><div class="meta"><div class="postdate"><time datetime="2019-01-02" itemprop="datePublished">2019-01-02</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3e作者： 阿希 （沪江Web前端开发工程师）\x3cbr\x3e本文原创，转载请注明作者及出处。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e了解 React 的人几乎都听过说 Virtual DOM，甚至不了解 React 的人也听过 Virtual DOM。那么 React 的 Virtual DOM 到底长什么样子呢？今天我们将一探 React 的源码来揭开 React  Virtual DOM 的神秘面纱。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e参考源码为React稳定版，版本号v15.4.1。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e1. React\x3c\/h2\x3e\n\x3cp\x3e我们首先试着在控制台打印一下 \x3ccode\x3eReact\x3c\/code\x3e 看看会是什么样子:\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010924028\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010924028\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e从控制台看来，React是一个对象，那接下来我们找到相应的源码来确认看看(src\/isomorphic\/React.js)：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var React = {\n  Children: {\n    map: ReactChildren.map,\n    forEach: ReactChildren.forEach,\n    count: ReactChildren.count,\n    toArray: ReactChildren.toArray,\n    only: onlyChild,\n  },\n  Component: ReactComponent,\n  PureComponent: ReactPureComponent,\n  createElement: createElement,\n  cloneElement: cloneElement,\n  isValidElement: ReactElement.isValidElement,\n  PropTypes: ReactPropTypes,\n  createClass: ReactClass.createClass,\n  createFactory: createFactory,\n  createMixin: function(mixin) {\n    return mixin;\n  },\n  DOM: ReactDOMFactories,\n  version: ReactVersion,\n  __spread: __spread,\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e React = {\n  \x3cspan class=\x22hljs-attr\x22\x3eChildren\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3emap\x3c\/span\x3e: ReactChildren.map,\n    \x3cspan class=\x22hljs-attr\x22\x3eforEach\x3c\/span\x3e: ReactChildren.forEach,\n    \x3cspan class=\x22hljs-attr\x22\x3ecount\x3c\/span\x3e: ReactChildren.count,\n    \x3cspan class=\x22hljs-attr\x22\x3etoArray\x3c\/span\x3e: ReactChildren.toArray,\n    \x3cspan class=\x22hljs-attr\x22\x3eonly\x3c\/span\x3e: onlyChild,\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3eComponent\x3c\/span\x3e: ReactComponent,\n  \x3cspan class=\x22hljs-attr\x22\x3ePureComponent\x3c\/span\x3e: ReactPureComponent,\n  \x3cspan class=\x22hljs-attr\x22\x3ecreateElement\x3c\/span\x3e: createElement,\n  \x3cspan class=\x22hljs-attr\x22\x3ecloneElement\x3c\/span\x3e: cloneElement,\n  \x3cspan class=\x22hljs-attr\x22\x3eisValidElement\x3c\/span\x3e: ReactElement.isValidElement,\n  \x3cspan class=\x22hljs-attr\x22\x3ePropTypes\x3c\/span\x3e: ReactPropTypes,\n  \x3cspan class=\x22hljs-attr\x22\x3ecreateClass\x3c\/span\x3e: ReactClass.createClass,\n  \x3cspan class=\x22hljs-attr\x22\x3ecreateFactory\x3c\/span\x3e: createFactory,\n  \x3cspan class=\x22hljs-attr\x22\x3ecreateMixin\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3emixin\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e mixin;\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3eDOM\x3c\/span\x3e: ReactDOMFactories,\n  \x3cspan class=\x22hljs-attr\x22\x3eversion\x3c\/span\x3e: ReactVersion,\n  \x3cspan class=\x22hljs-attr\x22\x3e__spread\x3c\/span\x3e: __spread,\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以了解到，React 确实是一个 Object ，我们可以把 React 对象画成下图的形式，方便大家直观的观察：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010924029\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010924029\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3eReact 是一个对象，里面包含了许多方法和属性，有最新的 v15 版本的方法，也有些以前的 API 和一些已经废弃不建议使用的 API。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eComponent\x3c\/code\x3e 用来创建 React 组件类。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3ePureComponent\x3c\/code\x3e 用来创建 React 纯组件类。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3ecreateElement\x3c\/code\x3e 创建 React 元素。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3ecloneElement\x3c\/code\x3e 拷贝 React 元素。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eisValidElement\x3c\/code\x3e 判断是否是有效的 React 元素。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3ePropTypes\x3c\/code\x3e 定义 React props 类型。(过时的API)\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3ecreateClass\x3c\/code\x3e 创建 React 组件类（过时的API）。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3ecreateFactory\x3c\/code\x3e 创建 React 工厂函数。（不建议使用）。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3ecreateMixin\x3c\/code\x3e 创建 Mixin。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eDOM\x3c\/code\x3e 主要和同构相关。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eversion\x3c\/code\x3e 当前使用的 React 版本号。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3e__spread\x3c\/code\x3e \x3cstrong\x3e已废弃\x3c\/strong\x3e，直接用 \x3ccode\x3eObject.assign()\x3c\/code\x3e 代替\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3ccode\x3e__spread\x3c\/code\x3e 方法已经\x3cstrong\x3e废弃\x3c\/strong\x3e，不再建议使用。在作者写这篇文章的时候，React 又发布了 v15.5.0 版本，在这个版本里，\x3ccode\x3ecreateClass\x3c\/code\x3e 和 \x3ccode\x3ePropTypes\x3c\/code\x3e 也已经被标记为\x3cstrong\x3e过时\x3c\/strong\x3e的 API，会提示 warning。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e对于原来的旧 API \x3ccode\x3eReact.createClass\x3c\/code\x3e，现在推荐开发者用 class 的方式继承 \x3ccode\x3eComponent\x3c\/code\x3e 或者 \x3ccode\x3ePureComponent\x3c\/code\x3e。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e对于 \x3ccode\x3ePropTypes\x3c\/code\x3e 的引入方式也不是原来的 \x3ccode\x3eimport { PropTypes } from \x27react\x27\x3c\/code\x3e，而变成了 \x3ccode\x3eimport PropTypes from \x27prop-types\x27\x3c\/code\x3e。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e其他属性和方法我们暂且就不详细的讲述了，这篇文章就只详细的研究一下和创建 React Virtual DOM 最紧密相关的方法——\x3ccode\x3eReact.createElement\x3c\/code\x3e。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e\x3ccode\x3eReact.createElement\x3c\/code\x3e 方法其实是调用的ReactElement模块的 \x3ccode\x3eReactElement.createElement\x3c\/code\x3e 方法。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e2. React Element\x3c\/h2\x3e\n\x3cp\x3eVirtual DOM 是真实 DOM 的模拟，真实 DOM 是由真实的 DOM 元素构成，Virtual DOM 也是由虚拟的 DOM 元素构成。真实 DOM 元素我们已经很熟悉了，它们都是 HTML 元素（HTML Element）。那虚拟 DOM 元素是什么呢？React 给虚拟 DOM 元素取名叫 React 元素（React Element）。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010924030\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010924030\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e我们知道，React 可以通过组合一些 HTML 原生元素形成组件，然后组件又可以被其他的组件复用。所以，原生元素和组件其实在概念上都是一致的，都是具有特定功能和 UI 的可复用的元素。因此，React 把这些元素抽象成了 React Element。不论是 HTML 原生元素，例如：\x3ccode\x3e\x26lt;p\x26gt;\x26lt;\/p\x26gt;\x3c\/code\x3e，\x3ccode\x3e\x26lt;a\x26gt;\x26lt;\/a\x26gt;\x3c\/code\x3e，等。或者这些原生元素的组合（组件），例如 \x3ccode\x3e\x26lt;Message \/\x26gt;\x3c\/code\x3e 等。它们都是 React Element，而创建这些 Element 的方法就是 \x3ccode\x3eReact.createElement\x3c\/code\x3e。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e\x3cstrong\x3eReact Virtual DOM 就是由 React Element 构成的一棵树\x3c\/strong\x3e。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e接下来我们就探究下 React Element 到底长什么样以及 React 是如何创建这些 React Element 的。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e2.1 ReactElement 模块\x3c\/h3\x3e\n\x3cp\x3e我们在控制台里直接打印出 \x3ccode\x3e\x26lt;h1\x26gt;hello\x26lt;\/h1\x26gt;\x3c\/code\x3e：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010924031\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010924031\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e我们再打印出 \x3ccode\x3e\x26lt;App \/\x26gt;\x3c\/code\x3e，App 组件的结构如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv\x3e\n    \x3ch1\x3eApp\x3c\/h1\x3e\n    \x3cp\x3eHello world!\x3c\/p\x3e\n\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh1\x3c\/span\x3e\x26gt;\x3c\/span\x3eApp\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh1\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3eHello world!\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e打印出的结果如下：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010924032\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010924032\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e可以很直观的发现，打印的 HTML 元素并不是真实的 DOM 元素，打印的组件也不是 DOM 元素的集合，所有打印出来的元素都是一个对象，而且它们长的非常相似，那其实这些对象都是 React Element 对象。\x3c\/p\x3e\n\x3cp\x3e然后我们再看看源码部分：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var ReactElement = function(type, key, ref, self, source, owner, props) {\n  var element = {\n    $$typeof: REACT_ELEMENT_TYPE,\n    type: type,\n    key: key,\n    ref: ref,\n    props: props,\n    _owner: owner,\n  };\n  if (__DEV__) {\n    \/\/ ...\n  }\n  return element;\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ReactElement = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etype, key, ref, self, source, owner, props\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e element = {\n    \x3cspan class=\x22hljs-attr\x22\x3e$$typeof\x3c\/span\x3e: REACT_ELEMENT_TYPE,\n    \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e: type,\n    \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e: key,\n    \x3cspan class=\x22hljs-attr\x22\x3eref\x3c\/span\x3e: ref,\n    \x3cspan class=\x22hljs-attr\x22\x3eprops\x3c\/span\x3e: props,\n    \x3cspan class=\x22hljs-attr\x22\x3e_owner\x3c\/span\x3e: owner,\n  };\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (__DEV__) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e element;\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eReactElement其实是一个工厂函数，接受7个参数，最终返回一个React Element对象。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3e$$type\x3c\/code\x3e React Element 的标志，是一个Symbol类型。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3etype\x3c\/code\x3e React 元素的类型。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3ekey\x3c\/code\x3e React 元素的 key，diff 算法会用到。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eref\x3c\/code\x3e React 元素的 ref 属性，当 React 元素生成实际 DOM 后，返回 DOM 的引用。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eprops\x3c\/code\x3e React 元素的属性，是一个对象。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3e_owner\x3c\/code\x3e 负责创建这个 React 元素的组件。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e参数中的 \x3ccode\x3eself\x3c\/code\x3e 和 \x3ccode\x3esource\x3c\/code\x3e 都是只供开发环境下用的参数。从上面的例子我们可以发现唯一不同的就是\x3ccode\x3etype\x3c\/code\x3e 了，对于原生元素，\x3ccode\x3etype\x3c\/code\x3e 是一个字符串类型，记录了原生元素的类型；对于 react 组件来说呢，\x3ccode\x3etype\x3c\/code\x3e 是一个构造函数，或者说它是一个类，记录了这个 react 组件的是哪一个类的实例。所以\x3ccode\x3e\x26lt;App\/\x26gt;.type === App\x3c\/code\x3e 的。\x3c\/p\x3e\n\x3cp\x3e所以，每一个包装过后的React元素都是这样的对象:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n    $$typeof: REACT_ELEMENT_TYPE,\n    type: type,\n    key: key,\n    ref: ref,\n    props: props,\n    _owner: owner,\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e{\n    \x3cspan class=\x22hljs-attr\x22\x3e$$typeof\x3c\/span\x3e: REACT_ELEMENT_TYPE,\n    \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e: type,\n    \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e: key,\n    \x3cspan class=\x22hljs-attr\x22\x3eref\x3c\/span\x3e: ref,\n    \x3cspan class=\x22hljs-attr\x22\x3eprops\x3c\/span\x3e: props,\n    \x3cspan class=\x22hljs-attr\x22\x3e_owner\x3c\/span\x3e: owner,\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e用图片表示 React Element，就是下图这样：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010924033\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010924033\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e2.2 ReactElement.createElement 方法\x3c\/h3\x3e\n\x3cp\x3e在此之前，可能有人会问，我们开发当中似乎没有用到 React.createElement 方法呀。其实不然，看下面的示例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22class OriginalElement extends Component {\n  render() {\n    return (\n      \x3cdiv\x3eOriginal Element div\x3c\/div\x3e\n    );\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eOriginalElement\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n  render() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n      \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3eOriginal Element div\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n    );\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e经过babel转译之后是这样的\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22_createClass(OriginalElement, [{\n    key: \x26quot;render\x26quot;,\n    value: function render() {\n      return React.createElement(\n        \x26quot;div\x26quot;,\n        null,\n        \x26quot;Original Element div\x26quot;\n      );\n    }\n  }]);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e_createClass(OriginalElement, [{\n    \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22render\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erender\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e React.createElement(\n        \x3cspan class=\x22hljs-string\x22\x3e\x22div\x22\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-string\x22\x3e\x22Original Element div\x22\x3c\/span\x3e\n      );\n    }\n  }]);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看到，所有的 JSX 都会被编译成 React.createElement 方法，所以这个方法可能是我们在使用React用的最多的方法。\x3c\/p\x3e\n\x3cp\x3e接下来我们看看 React.createElement 方法是怎样的，前面说过了 React.createElement 方法其实就是 ReactElement.createElement 方法。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ReactElement.createElement = function(type, config, children) {\n  var propName;\n  var props = {};\n  var key = null;\n  var ref = null;\n  var self = null;\n  var source = null;\n  if (config != null) {\n    if (hasValidRef(config)) {\n      ref = config.ref;\n    }\n    if (hasValidKey(config)) {\n      key = \x27\x27 \x2b config.key;\n    }\n    self = config.__self === undefined ? null : config.__self;\n    source = config.__source === undefined ? null : config.__source;\n\n    for (propName in config) {\n      if (hasOwnProperty.call(config, propName) \x26amp;\x26amp;\n          !RESERVED_PROPS.hasOwnProperty(propName)) {\n        props[propName] = config[propName];\n      }\n    }\n  }\n  var childrenLength = arguments.length - 2;\n  if (childrenLength === 1) {\n    props.children = children;\n  } else if (childrenLength \x3e 1) {\n    var childArray = Array(childrenLength);\n    for (var i = 0; i \x3c childrenLength; i\x2b\x2b) {\n      childArray[i] = arguments[i \x2b 2];\n    }\n    if (__DEV__) {\n      \/\/ ...\n    }\n    props.children = childArray;\n  }\n  if (type \x26amp;\x26amp; type.defaultProps) {\n    var defaultProps = type.defaultProps;\n    for (propName in defaultProps) {\n      if (props[propName] === undefined) {\n        props[propName] = defaultProps[propName];\n      }\n    }\n  }\n  if (__DEV__) {\n    \/\/ ...\n  }\n  return ReactElement(\n    type,\n    key,\n    ref,\n    self,\n    source,\n    ReactCurrentOwner.current,\n    props\n  );\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3eReactElement.createElement = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etype, config, children\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e propName;\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e props = {};\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e key = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ref = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e self = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e source = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (config != \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (hasValidRef(config)) {\n      ref = config.ref;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (hasValidKey(config)) {\n      key = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e \x2b config.key;\n    }\n    self = config.__self === \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e ? \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e : config.__self;\n    source = config.__source === \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e ? \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e : config.__source;\n\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (propName \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e config) {\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (hasOwnProperty.call(config, propName) \x26amp;\x26amp;\n          !RESERVED_PROPS.hasOwnProperty(propName)) {\n        props[propName] = config[propName];\n      }\n    }\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e childrenLength = \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e.length - \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (childrenLength === \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) {\n    props.children = children;\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (childrenLength \x26gt; \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e childArray = \x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e(childrenLength);\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; childrenLength; i\x2b\x2b) {\n      childArray[i] = \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e[i \x2b \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e];\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (__DEV__) {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    }\n    props.children = childArray;\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (type \x26amp;\x26amp; type.defaultProps) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e defaultProps = type.defaultProps;\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (propName \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e defaultProps) {\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (props[propName] === \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e) {\n        props[propName] = defaultProps[propName];\n      }\n    }\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (__DEV__) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e ReactElement(\n    type,\n    key,\n    ref,\n    self,\n    source,\n    ReactCurrentOwner.current,\n    props\n  );\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ereactElement.createElement大致做了2件事。\x3c\/p\x3e\n\x3cp\x3e第一件是初始化 React Element 里的各种参数，例如 \x3ccode\x3etype\x3c\/code\x3e，\x3ccode\x3eprops\x3c\/code\x3e 和 \x3ccode\x3echildren\x3c\/code\x3e 等。在初始化的时候，会提取出 \x3ccode\x3ekey\x3c\/code\x3e，\x3ccode\x3eref\x3c\/code\x3e 这两个属性，然后 __self，__source 这两个属性也是仅开发用。所以如果你在组件里定义了 \x3ccode\x3ekey\x3c\/code\x3e，\x3ccode\x3eref\x3c\/code\x3e，\x3ccode\x3e__self\x3c\/code\x3e，\x3ccode\x3e__source\x3c\/code\x3e 这4个属性中的任何一个，都是不能在 \x3ccode\x3ethis.props\x3c\/code\x3e 里访问到的。从第三个参数开始，传入的参数都会合并为 \x3ccode\x3echildren\x3c\/code\x3e 属性，如果只有一个，那么 \x3ccode\x3echildren\x3c\/code\x3e 就是第三个元素，如果超过一个，那么这些元素就会合并成一个 \x3ccode\x3echildren\x3c\/code\x3e 数组。\x3c\/p\x3e\n\x3cp\x3e第二件是初始化 \x3ccode\x3edefaultProps\x3c\/code\x3e，我们可以发现，\x3ccode\x3edefaultProps\x3c\/code\x3e 是通过 \x3ccode\x3etype\x3c\/code\x3e 来初始化的，我们在上面也说过，对于 \x3ccode\x3ereact\x3c\/code\x3e 组件来说，\x3ccode\x3etype\x3c\/code\x3e 是 React Element 所属的类，所以可以通过 \x3ccode\x3etype\x3c\/code\x3e 取到该类的 \x3ccode\x3edefaultProps\x3c\/code\x3e（默认属性）。这里还有一点需要注意，如果我们把某个属性的值定义成 \x3ccode\x3eundefined\x3c\/code\x3e，那么这个属性也会使用默认属性，但是定义成 \x3ccode\x3enull\x3c\/code\x3e 就不会使用默认属性。\x3c\/p\x3e\n\x3cp\x3e下面是图解：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010924034\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010924034\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e4. 创建Virtual DOM树\x3c\/h2\x3e\n\x3cp\x3e有了上面的作为基础，那创建 Virtual DOM 就很简单了。整个 Virtual DOM 就是一个巨大的对象。\x3c\/p\x3e\n\x3cp\x3e比如我们有这么一个 \x3ccode\x3eApp\x3c\/code\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22App:\n\x3cdiv\x3e\n  \x3cHeader \/\x3e\n  \x3cList \/\x3e\n\x3c\/div\x3e\n\nHeader:\n\x3cdiv\x3e\n  \x3cLogo \/\x3e\n  \x3cbutton\x3e菜单\x3c\/button\x3e\n\x3c\/div\x3e\n\nList:\n\x3cul\x3e\n  \x3cli\x3etext 1\x3c\/li\x3e\n  \x3cli\x3etext 2\x3c\/li\x3e\n  \x3cli\x3etext 3\x3c\/li\x3e\n\x3c\/ul\x3e\n\nLogo:\n\x3cdiv\x3e\n  \x3cimg src=\x26quot;.\/foo.png\x26quot; alt=\x26quot;logo\x26quot; \/\x3e\n  \x3cp\x3etext logo\x3c\/p\x3e\n\x3c\/div\x3e\n\nReactDOM.render(\x3cApp \/\x3e, document.getElementById(\x27root\x27))\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3eApp:\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eHeader\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eList\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\nHeader:\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eLogo\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e菜单\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\nList:\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3etext 1\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3etext 2\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3etext 3\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\nLogo:\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eimg\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22.\/foo.png\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ealt\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22logo\x22\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3etext logo\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\nReactDOM.render(\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eApp\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e, document.getElementById(\x27root\x27))\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e通过上面的了解到的 React Element 创建方式，我们不难知道，生成的对应的 Virtual DOM 应该是类似于这样的：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010924035\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010924035\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e需要注意的是，这些元素\x3cstrong\x3e并不是\x3c\/strong\x3e真实的 DOM 元素， 它们只是一些对象，而且我们可以看到 React 组件实际上是概念上的形态，最终还是会生成原生的虚拟 DOM 对象。当这些对象上的数据发生变化时，通过打 patch 把变化同步到真实的 DOM 上去。\x3c\/p\x3e\n\x3cp\x3e目前我们可以认为 Virtual DOM 就是这样的一种形态，但是实际上，并没有这么简单，这只是最基本的样子，在后续的文章中我会带大家一起看看更高级的形态。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010887896\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010887896\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVT6wG?w=1500\x26amp;h=854\x22 src=\x22https:\/\/static.alili.tech\/img\/bVT6wG?w=1500\x26amp;h=854\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eiKcamp原创新书《移动Web前端高效开发实战》已在亚马逊、京东、当当开售。\x3c\/p\x3e\x3c\/blockquote\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>图解 React Virtual DOM</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010924023">https://segmentfault.com/a/1190000010924023</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/08jeyxb4418y/" target="_blank">https://alili.tech/archive/08jeyxb4418y/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>