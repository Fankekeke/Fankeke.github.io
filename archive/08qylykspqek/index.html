<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="前端小知识--地图坐标转换"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>前端小知识--地图坐标转换 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/08qylykspqek/",
				"appid": "1613049289050283", 
				"title": "前端小知识--地图坐标转换 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-11T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/vfxekpnuw9g/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/7hja7u5q8yx/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f08qylykspqek%2f&text=%e5%89%8d%e7%ab%af%e5%b0%8f%e7%9f%a5%e8%af%86--%e5%9c%b0%e5%9b%be%e5%9d%90%e6%a0%87%e8%bd%ac%e6%8d%a2"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f08qylykspqek%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f08qylykspqek%2f&text=%e5%89%8d%e7%ab%af%e5%b0%8f%e7%9f%a5%e8%af%86--%e5%9c%b0%e5%9b%be%e5%9d%90%e6%a0%87%e8%bd%ac%e6%8d%a2"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f08qylykspqek%2f&title=%e5%89%8d%e7%ab%af%e5%b0%8f%e7%9f%a5%e8%af%86--%e5%9c%b0%e5%9b%be%e5%9d%90%e6%a0%87%e8%bd%ac%e6%8d%a2"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f08qylykspqek%2f&is_video=false&description=%e5%89%8d%e7%ab%af%e5%b0%8f%e7%9f%a5%e8%af%86--%e5%9c%b0%e5%9b%be%e5%9d%90%e6%a0%87%e8%bd%ac%e6%8d%a2"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%89%8d%e7%ab%af%e5%b0%8f%e7%9f%a5%e8%af%86--%e5%9c%b0%e5%9b%be%e5%9d%90%e6%a0%87%e8%bd%ac%e6%8d%a2&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f08qylykspqek%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f08qylykspqek%2f&title=%e5%89%8d%e7%ab%af%e5%b0%8f%e7%9f%a5%e8%af%86--%e5%9c%b0%e5%9b%be%e5%9d%90%e6%a0%87%e8%bd%ac%e6%8d%a2"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f08qylykspqek%2f&title=%e5%89%8d%e7%ab%af%e5%b0%8f%e7%9f%a5%e8%af%86--%e5%9c%b0%e5%9b%be%e5%9d%90%e6%a0%87%e8%bd%ac%e6%8d%a2"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f08qylykspqek%2f&title=%e5%89%8d%e7%ab%af%e5%b0%8f%e7%9f%a5%e8%af%86--%e5%9c%b0%e5%9b%be%e5%9d%90%e6%a0%87%e8%bd%ac%e6%8d%a2"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f08qylykspqek%2f&title=%e5%89%8d%e7%ab%af%e5%b0%8f%e7%9f%a5%e8%af%86--%e5%9c%b0%e5%9b%be%e5%9d%90%e6%a0%87%e8%bd%ac%e6%8d%a2"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">前端小知识--地图坐标转换</h1><div class="meta"><div class="postdate"><time datetime="2018-12-11" itemprop="datePublished">2018-12-11</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e地图坐标转换\x3c\/h2\x3e\n\x3cblockquote\x3eLBS，基于位置的服务（Location Based Service)，近年来已经无处不在，尤其是我们前端，相信或多或少都有接触一些地图API服务，比如高德、百度啊、谷歌啊~\x3cbr\x3e但是用的时候可能看到下面这些字眼：比如BD09、火星坐标、WGS84……不由得还是蒙圈了啊?\x3c\/blockquote\x3e\n\x3cp\x3e那么接下来，我们就来了解一下，关于当前用到的一些互联网地图的基础坐标转换知识~\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e0、首先给大家出一个题\x3c\/h3\x3e\n\x3cp\x3e\x3cstrong\x3e地图上的经纬度\x3c\/strong\x3e转换到平面坐标时，和\x3cstrong\x3e平面坐标的XY\x3c\/strong\x3e的对应关系是什么，就是经度（longitude）和维度（latitude）分别给对应X,Y中的谁？\x3c\/p\x3e\n\x3cp\x3e这是在实际中经常会用到的一个知识点，我之前没有想太多，反正就把数值往里尝试，因为位置差异很大，正确还是错误一眼就看出来了的，但是这样其实很不好，被师兄说了，我一个GISer的连这个都弄不明白不应该，哈哈哈。不求甚解是可以的，但是专业性还是要强化的。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV3Qty?w=328\x26amp;h=198\x22 src=\x22https:\/\/static.alili.tech\/img\/bV3Qty?w=328\x26amp;h=198\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e来看看上面的图：\x3cbr\x3e经纬度大家都知道，地球上横线是纬度，纵线是经度。\x3cbr\x3e这也导致了我们下意识就会觉得，横线是X，纵线是Y。这样的认知显然是错误的。\x3c\/p\x3e\n\x3cp\x3e但其实，横线是刻画了Y轴上的刻度，纵线是刻画了X轴上的刻度，这里要用到投影的角度来看问题。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV3Qvm?w=904\x26amp;h=479\x22 src=\x22https:\/\/static.alili.tech\/img\/bV3Qvm?w=904\x26amp;h=479\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e所以大家要记住\x3cstrong\x3e经纬XY\x3c\/strong\x3e\x3cbr\x3e\x3cstrong\x3e经度 （longitude） —— 对应 X\x3c\/strong\x3e\x3cbr\x3e\x3cstrong\x3e维度 （ latitude ）  ——  对应 Y\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e一、当前互联网地图的坐标系现状\x3c\/h3\x3e\n\x3ch4\x3e1.地球坐标 (WGS84)\x3c\/h4\x3e\n\x3cp\x3e国际标准，从专业GPS 设备中取出的数据的坐标系\x3cbr\x3e国际地图提供商使用的坐标系\x3c\/p\x3e\n\x3ch4\x3e2.火星坐标 (GCJ-02)也叫国测局坐标系\x3c\/h4\x3e\n\x3cp\x3e中国标准，从国行移动设备中定位获取的坐标数据使用这个坐标系\x3cbr\x3e国家规定： 国内出版的各种地图系统（包括电子形式），必须至少采用GCJ-02对地理位置进行首次加密。\x3c\/p\x3e\n\x3ch4\x3e3.百度坐标 (BD-09)\x3c\/h4\x3e\n\x3cp\x3e百度标准，百度 SDK，百度地图，Geocoding 使用\x3cbr\x3e(百度在火星坐标上的二次加密)\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e二、互联网在线地图使用的坐标系\x3c\/h3\x3e\n\x3cp\x3e火星坐标系：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    iOS 地图（其实是高德）\n    Gogole地图\n    搜搜、阿里云、高德地图\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs nginx\x22\x3e\x3ccode\x3e    \x3cspan class=\x22hljs-attribute\x22\x3eiOS\x3c\/span\x3e 地图（其实是高德）\n    Gogole地图\n    搜搜、阿里云、高德地图\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e百度坐标系：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    当然只有百度地图\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e    当然只有百度地图\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eWGS84坐标系：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    国际标准，谷歌国外地图、osm地图等国外的地图一般都是这个\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs\x22\x3e\x3ccode\x3e    国际标准，谷歌国外地图、osm地图等国外的地图一般都是这个\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e三、从设备获取经纬度（GPS）坐标\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  如果使用的是百度sdk那么可以获得百度坐标（bd09）或者火星坐标（GCJ02),默认是bd09\n  如果使用的是ios的原生定位库，那么获得的坐标是WGS84\n  如果使用的是高德sdk,那么获取的坐标是GCJ02\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs armasm\x22\x3e\x3ccode\x3e  如果使用的是百度sdk那么可以获得百度坐标（\x3cspan class=\x22hljs-keyword\x22\x3ebd09）或者火星坐标（GCJ02),默认是bd09\n\x3c\/span\x3e  如果使用的是ios的原生定位库，那么获得的坐标是WGS84\n  如果使用的是高德sdk,那么获取的坐标是GCJ02\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e四、坐标转换方法--JS版本\x3c\/h3\x3e\n\x3cp\x3e我在之前的一篇文章里，基于Ionic框架的使用讲到了地图定位：\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000011034873\x22\x3eionic2入门教程（六）地图服务（谷歌、高德、百度定位）\x3c\/a\x3e，现在重新写一个小demo来实现我们的坐标转换。\x3cbr\x3e关于方法，我找到了应该是最通用的一种，\x3ca href=\x22https:\/\/github.com\/wandergis\/coordtransform\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e源码地址\x3c\/a\x3e——作者wandergis，大部分的转换方式应该都是基于他的这个版本，相关说明也是最清楚的。\x3cbr\x3e实际中我们可能会用到不同的地图，那么就对应到不同坐标系的转换，比如说，你有一份wgs84的数据服务，你要展现在百度或者高德地图上，这时候你就需要转换了。\x3cbr\x3e我这里的例子是，我用到百度搜索地名，得到经纬度，但是我要将它绘制在以84为坐标系的地图leaflet之上，这时候我就需要将返回的经纬度进行转换。\x3cbr\x3e我们先用百度搜索广州塔，定位中心\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV42Ld?w=478\x26amp;h=626\x22 src=\x22https:\/\/static.alili.tech\/img\/bV42Ld?w=478\x26amp;h=626\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e基于我们选择的OpenStreetMap，未转换之前，我们用百度搜索广州塔返回的值画点，可以看出很明显是偏移了的：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV42LR?w=444\x26amp;h=741\x22 src=\x22https:\/\/static.alili.tech\/img\/bV42LR?w=444\x26amp;h=741\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    \x3ch1\x3e百度地名搜索\x3c\/h1\x3e\n    \x3cinput type=\x26quot;text\x26quot; id=\x26quot;searchVal\x26quot;\x3e\n    \x3cbutton id=\x26quot;searchBtn\x26quot;\x3e广州市内搜索\x3c\/button\x3e\n    \x3cdiv id=\x26quot;map1\x26quot;\x3e\n\n    \x3c\/div\x3e\n    \x3cscript\x3e\n        var searchBtn = document.getElementById(\x27searchBtn\x27);\n\n        var mymap = L.map(\x27map1\x27).setView([39.897445, 116.331398], 13);\n\n        L.tileLayer(\n            \x27https:\/\/api.tiles.mapbox.com\/v4\/{id}\/{z}\/{x}\/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw\x27, {\n                maxZoom: 18,\n                attribution: \x27Map data \x26amp;copy; \x3ca href=\x26quot;http:\/\/openstreetmap.org\x26quot;\x3eOpenStreetMap\x3c\/a\x3e contributors, \x27 \x2b\n                    \x27\x3ca href=\x26quot;http:\/\/creativecommons.org\/licenses\/by-sa\/2.0\/\x26quot;\x3eCC-BY-SA\x3c\/a\x3e, \x27 \x2b\n                    \x27Imagery © \x3ca href=\x26quot;http:\/\/mapbox.com\x26quot;\x3eMapbox\x3c\/a\x3e\x27,\n                id: \x27mapbox.streets\x27\n            }).addTo(mymap);\n\n        \/\/ 创建地址解析器实例\n        searchBtn.onclick = function () {\n            var searchVal = document.getElementById(\x27searchVal\x27).value;\n            var myGeo = new BMap.Geocoder();\n            \/\/ 将地址解析结果显示在地图上,并调整地图视野\n            myGeo.getPoint(searchVal, function (point) {\n                if (point) {\n                    console.log(point);\n                    L.marker([point.lat,point.lng]).addTo(mymap);\n                    mymap.setView([point.lat,point.lng],15);\n                } else {\n                    alert(\x26quot;您选择地址没有解析到结果!\x26quot;);\n                }\n            }, \x26quot;广州市\x26quot;);\n        }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh1\x3c\/span\x3e\x26gt;\x3c\/span\x3e百度地名搜索\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh1\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22searchVal\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22searchBtn\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e广州市内搜索\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22map1\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e searchBtn = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27searchBtn\x27\x3c\/span\x3e);\n\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e mymap = L.map(\x3cspan class=\x22hljs-string\x22\x3e\x27map1\x27\x3c\/span\x3e).setView([\x3cspan class=\x22hljs-number\x22\x3e39.897445\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e116.331398\x3c\/span\x3e], \x3cspan class=\x22hljs-number\x22\x3e13\x3c\/span\x3e);\n\n        L.tileLayer(\n            \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/api.tiles.mapbox.com\/v4\/{id}\/{z}\/{x}\/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw\x27\x3c\/span\x3e, {\n                \x3cspan class=\x22hljs-attr\x22\x3emaxZoom\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e18\x3c\/span\x3e,\n                \x3cspan class=\x22hljs-attr\x22\x3eattribution\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Map data \x26amp;copy; \x26lt;a href=\x22http:\/\/openstreetmap.org\x22\x26gt;OpenStreetMap\x26lt;\/a\x26gt; contributors, \x27\x3c\/span\x3e \x2b\n                    \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;a href=\x22http:\/\/creativecommons.org\/licenses\/by-sa\/2.0\/\x22\x26gt;CC-BY-SA\x26lt;\/a\x26gt;, \x27\x3c\/span\x3e \x2b\n                    \x3cspan class=\x22hljs-string\x22\x3e\x27Imagery © \x26lt;a href=\x22http:\/\/mapbox.com\x22\x26gt;Mapbox\x26lt;\/a\x26gt;\x27\x3c\/span\x3e,\n                \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27mapbox.streets\x27\x3c\/span\x3e\n            }).addTo(mymap);\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建地址解析器实例\x3c\/span\x3e\n        searchBtn.onclick = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e searchVal = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27searchVal\x27\x3c\/span\x3e).value;\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e myGeo = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e BMap.Geocoder();\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 将地址解析结果显示在地图上,并调整地图视野\x3c\/span\x3e\n            myGeo.getPoint(searchVal, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3epoint\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (point) {\n                    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(point);\n                    L.marker([point.lat,point.lng]).addTo(mymap);\n                    mymap.setView([point.lat,point.lng],\x3cspan class=\x22hljs-number\x22\x3e15\x3c\/span\x3e);\n                } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                    alert(\x3cspan class=\x22hljs-string\x22\x3e\x22您选择地址没有解析到结果!\x22\x3c\/span\x3e);\n                }\n            }, \x3cspan class=\x22hljs-string\x22\x3e\x22广州市\x22\x3c\/span\x3e);\n        }\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e转换代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/**\n * copy from https:\/\/github.com\/wandergis\/coordtransform\n * Created by Wandergis on 2015\/7\/8.\n * 提供了百度坐标（BD09）、国测局坐标（火星坐标，GCJ02）、和WGS84坐标系之间的转换\n *\/\n\/\/UMD魔法代码\n\/\/ if the module has no dependencies, the above pattern can be simplified to\n(function (root, factory) {\n    if (typeof define === \x27function\x27 \x26amp;\x26amp; define.amd) {\n      \/\/ AMD. Register as an anonymous module.\n      define([], factory);\n    } else if (typeof module === \x27object\x27 \x26amp;\x26amp; module.exports) {\n      \/\/ Node. Does not work with strict CommonJS, but\n      \/\/ only CommonJS-like environments that support module.exports,\n      \/\/ like Node.\n      module.exports = factory();\n    } else {\n      \/\/ Browser globals (root is window)\n      root.coordtransform = factory();\n    }\n  }(this, function () {\n    \/\/定义一些常量\n    var x_PI = 3.14159265358979324 * 3000.0 \/ 180.0;\n    var PI = 3.1415926535897932384626;\n    var a = 6378245.0;\n    var ee = 0.00669342162296594323;\n    \/**\n     * 百度坐标系 (BD-09) 与 火星坐标系 (GCJ-02)的转换\n     * 即 百度 转 谷歌、高德\n     * @param bd_lon\n     * @param bd_lat\n     * @returns {*[]}\n     *\/\n    var bd09togcj02 = function bd09togcj02(bd_lon, bd_lat) {\n      var bd_lon = \x2bbd_lon;\n      var bd_lat = \x2bbd_lat;\n      var x = bd_lon - 0.0065;\n      var y = bd_lat - 0.006;\n      var z = Math.sqrt(x * x \x2b y * y) - 0.00002 * Math.sin(y * x_PI);\n      var theta = Math.atan2(y, x) - 0.000003 * Math.cos(x * x_PI);\n      var gg_lng = z * Math.cos(theta);\n      var gg_lat = z * Math.sin(theta);\n      return [gg_lng, gg_lat]\n    };\n  \n    \/**\n     * 火星坐标系 (GCJ-02) 与百度坐标系 (BD-09) 的转换\n     * 即谷歌、高德 转 百度\n     * @param lng\n     * @param lat\n     * @returns {*[]}\n     *\/\n    var gcj02tobd09 = function gcj02tobd09(lng, lat) {\n      var lat = \x2blat;\n      var lng = \x2blng;\n      var z = Math.sqrt(lng * lng \x2b lat * lat) \x2b 0.00002 * Math.sin(lat * x_PI);\n      var theta = Math.atan2(lat, lng) \x2b 0.000003 * Math.cos(lng * x_PI);\n      var bd_lng = z * Math.cos(theta) \x2b 0.0065;\n      var bd_lat = z * Math.sin(theta) \x2b 0.006;\n      return [bd_lng, bd_lat]\n    };\n  \n    \/**\n     * WGS84转GCj02\n     * @param lng\n     * @param lat\n     * @returns {*[]}\n     *\/\n    var wgs84togcj02 = function wgs84togcj02(lng, lat) {\n      var lat = \x2blat;\n      var lng = \x2blng;\n      if (out_of_china(lng, lat)) {\n        return [lng, lat]\n      } else {\n        var dlat = transformlat(lng - 105.0, lat - 35.0);\n        var dlng = transformlng(lng - 105.0, lat - 35.0);\n        var radlat = lat \/ 180.0 * PI;\n        var magic = Math.sin(radlat);\n        magic = 1 - ee * magic * magic;\n        var sqrtmagic = Math.sqrt(magic);\n        dlat = (dlat * 180.0) \/ ((a * (1 - ee)) \/ (magic * sqrtmagic) * PI);\n        dlng = (dlng * 180.0) \/ (a \/ sqrtmagic * Math.cos(radlat) * PI);\n        var mglat = lat \x2b dlat;\n        var mglng = lng \x2b dlng;\n        return [mglng, mglat]\n      }\n    };\n  \n    \/**\n     * GCJ02 转换为 WGS84\n     * @param lng\n     * @param lat\n     * @returns {*[]}\n     *\/\n    var gcj02towgs84 = function gcj02towgs84(lng, lat) {\n      var lat = \x2blat;\n      var lng = \x2blng;\n      if (out_of_china(lng, lat)) {\n        return [lng, lat]\n      } else {\n        var dlat = transformlat(lng - 105.0, lat - 35.0);\n        var dlng = transformlng(lng - 105.0, lat - 35.0);\n        var radlat = lat \/ 180.0 * PI;\n        var magic = Math.sin(radlat);\n        magic = 1 - ee * magic * magic;\n        var sqrtmagic = Math.sqrt(magic);\n        dlat = (dlat * 180.0) \/ ((a * (1 - ee)) \/ (magic * sqrtmagic) * PI);\n        dlng = (dlng * 180.0) \/ (a \/ sqrtmagic * Math.cos(radlat) * PI);\n        var mglat = lat \x2b dlat;\n        var mglng = lng \x2b dlng;\n        return [lng * 2 - mglng, lat * 2 - mglat]\n      }\n    };\n  \n    var transformlat = function transformlat(lng, lat) {\n      var lat = \x2blat;\n      var lng = \x2blng;\n      var ret = -100.0 \x2b 2.0 * lng \x2b 3.0 * lat \x2b 0.2 * lat * lat \x2b 0.1 * lng * lat \x2b 0.2 * Math.sqrt(Math.abs(lng));\n      ret \x2b= (20.0 * Math.sin(6.0 * lng * PI) \x2b 20.0 * Math.sin(2.0 * lng * PI)) * 2.0 \/ 3.0;\n      ret \x2b= (20.0 * Math.sin(lat * PI) \x2b 40.0 * Math.sin(lat \/ 3.0 * PI)) * 2.0 \/ 3.0;\n      ret \x2b= (160.0 * Math.sin(lat \/ 12.0 * PI) \x2b 320 * Math.sin(lat * PI \/ 30.0)) * 2.0 \/ 3.0;\n      return ret\n    };\n  \n    var transformlng = function transformlng(lng, lat) {\n      var lat = \x2blat;\n      var lng = \x2blng;\n      var ret = 300.0 \x2b lng \x2b 2.0 * lat \x2b 0.1 * lng * lng \x2b 0.1 * lng * lat \x2b 0.1 * Math.sqrt(Math.abs(lng));\n      ret \x2b= (20.0 * Math.sin(6.0 * lng * PI) \x2b 20.0 * Math.sin(2.0 * lng * PI)) * 2.0 \/ 3.0;\n      ret \x2b= (20.0 * Math.sin(lng * PI) \x2b 40.0 * Math.sin(lng \/ 3.0 * PI)) * 2.0 \/ 3.0;\n      ret \x2b= (150.0 * Math.sin(lng \/ 12.0 * PI) \x2b 300.0 * Math.sin(lng \/ 30.0 * PI)) * 2.0 \/ 3.0;\n      return ret\n    };\n  \n    \/**\n     * 判断是否在国内，不在国内则不做偏移\n     * @param lng\n     * @param lat\n     * @returns {boolean}\n     *\/\n    var out_of_china = function out_of_china(lng, lat) {\n      var lat = \x2blat;\n      var lng = \x2blng;\n      \/\/ 纬度3.86~53.55,经度73.66~135.05 \n      return !(lng \x3e 73.66 \x26amp;\x26amp; lng \x3c 135.05 \x26amp;\x26amp; lat \x3e 3.86 \x26amp;\x26amp; lat \x3c 53.55);\n    };\n  \n    return {\n      bd09togcj02: bd09togcj02,\n      gcj02tobd09: gcj02tobd09,\n      wgs84togcj02: wgs84togcj02,\n      gcj02towgs84: gcj02towgs84\n    }\n  }));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * copy from https:\/\/github.com\/wandergis\/coordtransform\n * Created by Wandergis on 2015\/7\/8.\n * 提供了百度坐标（BD09）、国测局坐标（火星坐标，GCJ02）、和WGS84坐标系之间的转换\n *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/UMD魔法代码\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ if the module has no dependencies, the above pattern can be simplified to\x3c\/span\x3e\n(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eroot, factory\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e define === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e \x26amp;\x26amp; define.amd) {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ AMD. Register as an anonymous module.\x3c\/span\x3e\n      define([], factory);\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports) {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Node. Does not work with strict CommonJS, but\x3c\/span\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ only CommonJS-like environments that support module.exports,\x3c\/span\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ like Node.\x3c\/span\x3e\n      \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = factory();\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Browser globals (root is window)\x3c\/span\x3e\n      root.coordtransform = factory();\n    }\n  }(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/定义一些常量\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e x_PI = \x3cspan class=\x22hljs-number\x22\x3e3.14159265358979324\x3c\/span\x3e * \x3cspan class=\x22hljs-number\x22\x3e3000.0\x3c\/span\x3e \/ \x3cspan class=\x22hljs-number\x22\x3e180.0\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e PI = \x3cspan class=\x22hljs-number\x22\x3e3.1415926535897932384626\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e a = \x3cspan class=\x22hljs-number\x22\x3e6378245.0\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ee = \x3cspan class=\x22hljs-number\x22\x3e0.00669342162296594323\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * 百度坐标系 (BD-09) 与 火星坐标系 (GCJ-02)的转换\n     * 即 百度 转 谷歌、高德\n     * @param bd_lon\n     * @param bd_lat\n     * @returns {*[]}\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e bd09togcj02 = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ebd09togcj02\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ebd_lon, bd_lat\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e bd_lon = \x2bbd_lon;\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e bd_lat = \x2bbd_lat;\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e x = bd_lon - \x3cspan class=\x22hljs-number\x22\x3e0.0065\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e y = bd_lat - \x3cspan class=\x22hljs-number\x22\x3e0.006\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e z = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sqrt(x * x \x2b y * y) - \x3cspan class=\x22hljs-number\x22\x3e0.00002\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(y * x_PI);\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e theta = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.atan2(y, x) - \x3cspan class=\x22hljs-number\x22\x3e0.000003\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.cos(x * x_PI);\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e gg_lng = z * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.cos(theta);\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e gg_lat = z * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(theta);\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e [gg_lng, gg_lat]\n    };\n  \n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * 火星坐标系 (GCJ-02) 与百度坐标系 (BD-09) 的转换\n     * 即谷歌、高德 转 百度\n     * @param lng\n     * @param lat\n     * @returns {*[]}\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e gcj02tobd09 = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egcj02tobd09\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3elng, lat\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e lat = \x2blat;\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e lng = \x2blng;\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e z = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sqrt(lng * lng \x2b lat * lat) \x2b \x3cspan class=\x22hljs-number\x22\x3e0.00002\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(lat * x_PI);\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e theta = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.atan2(lat, lng) \x2b \x3cspan class=\x22hljs-number\x22\x3e0.000003\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.cos(lng * x_PI);\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e bd_lng = z * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.cos(theta) \x2b \x3cspan class=\x22hljs-number\x22\x3e0.0065\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e bd_lat = z * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(theta) \x2b \x3cspan class=\x22hljs-number\x22\x3e0.006\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e [bd_lng, bd_lat]\n    };\n  \n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * WGS84转GCj02\n     * @param lng\n     * @param lat\n     * @returns {*[]}\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e wgs84togcj02 = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ewgs84togcj02\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3elng, lat\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e lat = \x2blat;\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e lng = \x2blng;\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (out_of_china(lng, lat)) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e [lng, lat]\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e dlat = transformlat(lng - \x3cspan class=\x22hljs-number\x22\x3e105.0\x3c\/span\x3e, lat - \x3cspan class=\x22hljs-number\x22\x3e35.0\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e dlng = transformlng(lng - \x3cspan class=\x22hljs-number\x22\x3e105.0\x3c\/span\x3e, lat - \x3cspan class=\x22hljs-number\x22\x3e35.0\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e radlat = lat \/ \x3cspan class=\x22hljs-number\x22\x3e180.0\x3c\/span\x3e * PI;\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e magic = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(radlat);\n        magic = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e - ee * magic * magic;\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e sqrtmagic = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sqrt(magic);\n        dlat = (dlat * \x3cspan class=\x22hljs-number\x22\x3e180.0\x3c\/span\x3e) \/ ((a * (\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e - ee)) \/ (magic * sqrtmagic) * PI);\n        dlng = (dlng * \x3cspan class=\x22hljs-number\x22\x3e180.0\x3c\/span\x3e) \/ (a \/ sqrtmagic * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.cos(radlat) * PI);\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e mglat = lat \x2b dlat;\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e mglng = lng \x2b dlng;\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e [mglng, mglat]\n      }\n    };\n  \n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * GCJ02 转换为 WGS84\n     * @param lng\n     * @param lat\n     * @returns {*[]}\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e gcj02towgs84 = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egcj02towgs84\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3elng, lat\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e lat = \x2blat;\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e lng = \x2blng;\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (out_of_china(lng, lat)) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e [lng, lat]\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e dlat = transformlat(lng - \x3cspan class=\x22hljs-number\x22\x3e105.0\x3c\/span\x3e, lat - \x3cspan class=\x22hljs-number\x22\x3e35.0\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e dlng = transformlng(lng - \x3cspan class=\x22hljs-number\x22\x3e105.0\x3c\/span\x3e, lat - \x3cspan class=\x22hljs-number\x22\x3e35.0\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e radlat = lat \/ \x3cspan class=\x22hljs-number\x22\x3e180.0\x3c\/span\x3e * PI;\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e magic = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(radlat);\n        magic = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e - ee * magic * magic;\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e sqrtmagic = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sqrt(magic);\n        dlat = (dlat * \x3cspan class=\x22hljs-number\x22\x3e180.0\x3c\/span\x3e) \/ ((a * (\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e - ee)) \/ (magic * sqrtmagic) * PI);\n        dlng = (dlng * \x3cspan class=\x22hljs-number\x22\x3e180.0\x3c\/span\x3e) \/ (a \/ sqrtmagic * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.cos(radlat) * PI);\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e mglat = lat \x2b dlat;\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e mglng = lng \x2b dlng;\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e [lng * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e - mglng, lat * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e - mglat]\n      }\n    };\n  \n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e transformlat = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etransformlat\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3elng, lat\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e lat = \x2blat;\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e lng = \x2blng;\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ret = \x3cspan class=\x22hljs-number\x22\x3e-100.0\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e * lng \x2b \x3cspan class=\x22hljs-number\x22\x3e3.0\x3c\/span\x3e * lat \x2b \x3cspan class=\x22hljs-number\x22\x3e0.2\x3c\/span\x3e * lat * lat \x2b \x3cspan class=\x22hljs-number\x22\x3e0.1\x3c\/span\x3e * lng * lat \x2b \x3cspan class=\x22hljs-number\x22\x3e0.2\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sqrt(\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(lng));\n      ret \x2b= (\x3cspan class=\x22hljs-number\x22\x3e20.0\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(\x3cspan class=\x22hljs-number\x22\x3e6.0\x3c\/span\x3e * lng * PI) \x2b \x3cspan class=\x22hljs-number\x22\x3e20.0\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(\x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e * lng * PI)) * \x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e \/ \x3cspan class=\x22hljs-number\x22\x3e3.0\x3c\/span\x3e;\n      ret \x2b= (\x3cspan class=\x22hljs-number\x22\x3e20.0\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(lat * PI) \x2b \x3cspan class=\x22hljs-number\x22\x3e40.0\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(lat \/ \x3cspan class=\x22hljs-number\x22\x3e3.0\x3c\/span\x3e * PI)) * \x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e \/ \x3cspan class=\x22hljs-number\x22\x3e3.0\x3c\/span\x3e;\n      ret \x2b= (\x3cspan class=\x22hljs-number\x22\x3e160.0\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(lat \/ \x3cspan class=\x22hljs-number\x22\x3e12.0\x3c\/span\x3e * PI) \x2b \x3cspan class=\x22hljs-number\x22\x3e320\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(lat * PI \/ \x3cspan class=\x22hljs-number\x22\x3e30.0\x3c\/span\x3e)) * \x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e \/ \x3cspan class=\x22hljs-number\x22\x3e3.0\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e ret\n    };\n  \n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e transformlng = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etransformlng\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3elng, lat\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e lat = \x2blat;\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e lng = \x2blng;\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ret = \x3cspan class=\x22hljs-number\x22\x3e300.0\x3c\/span\x3e \x2b lng \x2b \x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e * lat \x2b \x3cspan class=\x22hljs-number\x22\x3e0.1\x3c\/span\x3e * lng * lng \x2b \x3cspan class=\x22hljs-number\x22\x3e0.1\x3c\/span\x3e * lng * lat \x2b \x3cspan class=\x22hljs-number\x22\x3e0.1\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sqrt(\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(lng));\n      ret \x2b= (\x3cspan class=\x22hljs-number\x22\x3e20.0\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(\x3cspan class=\x22hljs-number\x22\x3e6.0\x3c\/span\x3e * lng * PI) \x2b \x3cspan class=\x22hljs-number\x22\x3e20.0\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(\x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e * lng * PI)) * \x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e \/ \x3cspan class=\x22hljs-number\x22\x3e3.0\x3c\/span\x3e;\n      ret \x2b= (\x3cspan class=\x22hljs-number\x22\x3e20.0\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(lng * PI) \x2b \x3cspan class=\x22hljs-number\x22\x3e40.0\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(lng \/ \x3cspan class=\x22hljs-number\x22\x3e3.0\x3c\/span\x3e * PI)) * \x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e \/ \x3cspan class=\x22hljs-number\x22\x3e3.0\x3c\/span\x3e;\n      ret \x2b= (\x3cspan class=\x22hljs-number\x22\x3e150.0\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(lng \/ \x3cspan class=\x22hljs-number\x22\x3e12.0\x3c\/span\x3e * PI) \x2b \x3cspan class=\x22hljs-number\x22\x3e300.0\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(lng \/ \x3cspan class=\x22hljs-number\x22\x3e30.0\x3c\/span\x3e * PI)) * \x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e \/ \x3cspan class=\x22hljs-number\x22\x3e3.0\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e ret\n    };\n  \n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * 判断是否在国内，不在国内则不做偏移\n     * @param lng\n     * @param lat\n     * @returns {boolean}\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e out_of_china = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eout_of_china\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3elng, lat\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e lat = \x2blat;\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e lng = \x2blng;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 纬度3.86~53.55,经度73.66~135.05 \x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e !(lng \x26gt; \x3cspan class=\x22hljs-number\x22\x3e73.66\x3c\/span\x3e \x26amp;\x26amp; lng \x26lt; \x3cspan class=\x22hljs-number\x22\x3e135.05\x3c\/span\x3e \x26amp;\x26amp; lat \x26gt; \x3cspan class=\x22hljs-number\x22\x3e3.86\x3c\/span\x3e \x26amp;\x26amp; lat \x26lt; \x3cspan class=\x22hljs-number\x22\x3e53.55\x3c\/span\x3e);\n    };\n  \n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-attr\x22\x3ebd09togcj02\x3c\/span\x3e: bd09togcj02,\n      \x3cspan class=\x22hljs-attr\x22\x3egcj02tobd09\x3c\/span\x3e: gcj02tobd09,\n      \x3cspan class=\x22hljs-attr\x22\x3ewgs84togcj02\x3c\/span\x3e: wgs84togcj02,\n      \x3cspan class=\x22hljs-attr\x22\x3egcj02towgs84\x3c\/span\x3e: gcj02towgs84\n    }\n  }));\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e坐标转换后显示如下，我们需要将百度坐标转成火星坐标再转成wgs84，因为我们用的地图是openstreet，是wgs84坐标系\x3cbr\x3e可以看到，下面中三个点中，有一个已经是正确了的\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV42ZX?w=451\x26amp;h=801\x22 src=\x22https:\/\/static.alili.tech\/img\/bV42ZX?w=451\x26amp;h=801\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22        myGeo.getPoint(searchVal, function (point) {\n                if (point) {\n                    console.log(point);\n                    \/\/ bd09-\x3egcj02\n                    var myPoint = coordtransform.bd09togcj02(point.lng, point.lat);\n                    console.log(myPoint);\n                    \/\/ gcj02-\x3ewgs84\n                    var myPoint2 = coordtransform.gcj02towgs84(myPoint[0], myPoint[1]);\n                    console.log(myPoint2);\n                    var latlng = L.latLng([myPoint[1], myPoint[0]]);\n                    var latlng2 = L.latLng([myPoint2[1], myPoint2[0]]);\n                    \/\/ 画点\n                    L.marker(point).addTo(mymap);\n                    L.marker(latlng).addTo(mymap);\n                    L.marker(latlng2).addTo(mymap);\n                    \/\/ 设置中心\n                    mymap.setView([point.lat, point.lng], 13);\n                } else {\n                    alert(\x26quot;您选择地址没有解析到结果!\x26quot;);\n                }\n            }, \x26quot;广州市\x26quot;);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3e        myGeo.getPoint(searchVal, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3epoint\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3epoint\x3c\/span\x3e) {\n                    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-built_in\x22\x3epoint\x3c\/span\x3e);\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ bd09-\x26gt;gcj02\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e myPoint = coordtransform.bd09togcj02(\x3cspan class=\x22hljs-built_in\x22\x3epoint\x3c\/span\x3e.lng, \x3cspan class=\x22hljs-built_in\x22\x3epoint\x3c\/span\x3e.lat);\n                    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(myPoint);\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ gcj02-\x26gt;wgs84\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e myPoint2 = coordtransform.gcj02towgs84(myPoint[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e], myPoint[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e]);\n                    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(myPoint2);\n                    \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e latlng = L.latLng([myPoint[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e], myPoint[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]]);\n                    \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e latlng2 = L.latLng([myPoint2[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e], myPoint2[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]]);\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 画点\x3c\/span\x3e\n                    L.marker(\x3cspan class=\x22hljs-built_in\x22\x3epoint\x3c\/span\x3e).addTo(mymap);\n                    L.marker(latlng).addTo(mymap);\n                    L.marker(latlng2).addTo(mymap);\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置中心\x3c\/span\x3e\n                    mymap.setView([\x3cspan class=\x22hljs-built_in\x22\x3epoint\x3c\/span\x3e.lat, \x3cspan class=\x22hljs-built_in\x22\x3epoint\x3c\/span\x3e.lng], \x3cspan class=\x22hljs-number\x22\x3e13\x3c\/span\x3e);\n                } \x3cspan class=\x22hljs-title\x22\x3eelse\x3c\/span\x3e {\n                    alert(\x3cspan class=\x22hljs-string\x22\x3e\x22您选择地址没有解析到结果!\x22\x3c\/span\x3e);\n                }\n            }, \x3cspan class=\x22hljs-string\x22\x3e\x22广州市\x22\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/JiaXinYi\/ife-study\/tree\/master\/%E5%89%8D%E7%AB%AF%E5%B0%8F%E7%9F%A5%E8%AF%86\/map\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e源码\x3c\/a\x3e：\x3cstrong\x3e\x3ca href=\x22https:\/\/github.com\/JiaXinYi\/ife-study\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/JiaXinYi\/i...\x3c\/a\x3e\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e五、EPSG:3857\x3c\/h3\x3e\n\x3cp\x3e如果你用到了leaflet\/openlayers\/arcgis jsAPI的话，应该还有一个点需要了解\x3cbr\x3e这个算是题外话，因为一般都是学gis的才会用到这些，一般情况下百度高德这些大概都能够满足需求了。\x3cbr\x3e像用到这些地图的情况，经常会涉及到EPSG:3857 或者OpenLayers:900913，acrgis： 102100(3857)。\x3c\/p\x3e\n\x3cp\x3eEPSG:3857 其实是EPSG协会（European Petroleum Survey Group）为 Web Wercator 最终设立的WKID，也就是现在我们常用的Web 地图的坐标系，并且给定官方命名 “WGS 84 \/ Pseudo-Mercator“。\x3c\/p\x3e\n\x3cp\x3eWeb Mercator 是一个投影坐标系统，其基准面是 WGS 1984 。\x3c\/p\x3e\n\x3cp\x3eWGS 1984 是一个长半轴(a)为6378137，短半轴（b）为6356752.314245179 的椭球体，扁率(f)为298.257223563，f=(a-b)\/a 。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV43kU?w=277\x26amp;h=277\x22 src=\x22https:\/\/static.alili.tech\/img\/bV43kU?w=277\x26amp;h=277\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e但是，Web Mercator 坐标系使用的投影方法不是严格意义的墨卡托投影而是一个被 EPSG称为伪墨卡托的投影方法，这个伪墨卡托投影方法的大名是 Popular Visualization Pseudo Mercator，PVPM。\x3c\/p\x3e\n\x3cp\x3eGoogle 最先发明了这套系统，在投影过程中，将表示地球的参考椭球体近似的作为正球体处理（正球体半径 R = 椭球体半长轴 a）。\x3c\/p\x3e\n\x3cp\x3e后来，Web Mercator 在 Web 地图领域被广泛使用，这个坐标系就名声大噪。尽管这个坐标系由于精度问题一度不被GIS专业人士接受，但最终 EPSG 还是给了 WKID:3857。\x3c\/p\x3e\n\x3cp\x3e所以其实看到EPSG:3857，就知道，当前的坐标系是wgs84，而这个属性，通常在地图的默认设置中。就是说，如果你不改，这些地图就应该是wgs84坐标系。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e六、坐标转换方法--TS版本（待完成）\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22请输入代码\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e请输入代码\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果对你有帮助的话，能否考虑打赏a cup of coffee,比心\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV43nS?w=760\x26amp;h=1208\x22 src=\x22https:\/\/static.alili.tech\/img\/bV43nS?w=760\x26amp;h=1208\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e参考：\x3cbr\x3e\x3ca href=\x22http:\/\/wandergis.com\/coordtransform\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/wandergis.com\/coordtra...\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22http:\/\/blog.csdn.net\/kikitamoon\/article\/details\/46124935\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/blog.csdn.net\/kikitamo...\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22https:\/\/www.sogou.com\/link?url=hedJjaC291MMvQpiKePMcn_OsEuIVmUmOmDEbjJYhuQNbcbs4Dv99g..\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/www.sogou.com\/link?ur...\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22http:\/\/developer.baidu.com\/map\/jsdemo.htm#i7_1\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/developer.baidu.com\/ma...\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>前端小知识&ndash;地图坐标转换</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000013558653">https://segmentfault.com/a/1190000013558653</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/08qylykspqek/" target="_blank">https://alili.tech/archive/08qylykspqek/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>