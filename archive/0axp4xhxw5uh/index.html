<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="微信小程序：自定义组件的数据传递"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>微信小程序：自定义组件的数据传递 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/0axp4xhxw5uh/",
				"appid": "1613049289050283", 
				"title": "微信小程序：自定义组件的数据传递 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-04T02:30:05"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/q83fj2l9t8/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/8qowe1d2h8h/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f0axp4xhxw5uh%2f&text=%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f%ef%bc%9a%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e7%9a%84%e6%95%b0%e6%8d%ae%e4%bc%a0%e9%80%92"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f0axp4xhxw5uh%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f0axp4xhxw5uh%2f&text=%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f%ef%bc%9a%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e7%9a%84%e6%95%b0%e6%8d%ae%e4%bc%a0%e9%80%92"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f0axp4xhxw5uh%2f&title=%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f%ef%bc%9a%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e7%9a%84%e6%95%b0%e6%8d%ae%e4%bc%a0%e9%80%92"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f0axp4xhxw5uh%2f&is_video=false&description=%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f%ef%bc%9a%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e7%9a%84%e6%95%b0%e6%8d%ae%e4%bc%a0%e9%80%92"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f%ef%bc%9a%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e7%9a%84%e6%95%b0%e6%8d%ae%e4%bc%a0%e9%80%92&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f0axp4xhxw5uh%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f0axp4xhxw5uh%2f&title=%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f%ef%bc%9a%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e7%9a%84%e6%95%b0%e6%8d%ae%e4%bc%a0%e9%80%92"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f0axp4xhxw5uh%2f&title=%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f%ef%bc%9a%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e7%9a%84%e6%95%b0%e6%8d%ae%e4%bc%a0%e9%80%92"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f0axp4xhxw5uh%2f&title=%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f%ef%bc%9a%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e7%9a%84%e6%95%b0%e6%8d%ae%e4%bc%a0%e9%80%92"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f0axp4xhxw5uh%2f&title=%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f%ef%bc%9a%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e7%9a%84%e6%95%b0%e6%8d%ae%e4%bc%a0%e9%80%92"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">微信小程序：自定义组件的数据传递</h1><div class="meta"><div class="postdate"><time datetime="2018-12-04" itemprop="datePublished">2018-12-04</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2\x3e一、前言\x3c\/h2\x3e\n\x3cp\x3e如果小程序中有可复用的UI且具有一定的功能性，就可以使用自定义组件将其封装起来。下面介绍一个简单的组件和一个复杂的组件。\x3c\/p\x3e\n\x3ch2\x3e二、简单的组件（计数器）\x3c\/h2\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVbcuoK?w=81\x26amp;h=32\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbcuoK?w=81\x26amp;h=32\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3\x3e1. 组件功能介绍\x3c\/h3\x3e\n\x3cp\x3e这个组件常见于外卖软件中，用于记录想要购买的商品的数量。初始化的时候只有一个加号，点击加号以后出现数字和减号，并最后将数字传到组件外供外部使用。\x3c\/p\x3e\n\x3ch3\x3e2. 创建组件\x3c\/h3\x3e\n\x3cp\x3e首先在根目录创建components文件夹（或者你喜欢的地方），然后创建num-controller文件夹（我取的组件名字），在这个文件夹上点击右键新建一个component，名字依然叫做num-controller。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVbcuqA?w=189\x26amp;h=138\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbcuqA?w=189\x26amp;h=138\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3enum-controller.\x3cstrong\x3ewxml\x3c\/strong\x3e\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3e\x26lt;view class=\x22num-controller\x22\x26gt;\n  \x26lt;view class=\x22iconfont icon-jianshao sub-btn\x22 hidden=\x22\x22{{\x22num\x26lt;1\x22}}\x22\x22 bindtap=\x22sub\x22\x26gt;\x26lt;\/view\x26gt;\n  \x26lt;view class=\x22goods-num\x22 hidden=\x22\x22{{\x22num\x26lt;1\x22}}\x22\x22\x26gt;\x22{{\x22num\x22}}\x22\x26lt;\/view\x26gt;\n  \x26lt;view class=\x22iconfont icon-zengjia add-btn\x22 bindtap=\x22add\x22\x26gt;\x26lt;\/view\x26gt;\n\x26lt;\/view\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这段代码就是加减两个按钮和一个数字，因为我使用的是字体图标所以view里什么都没有。\x3c\/p\x3e\n\x3cp\x3enum-controller.\x3cstrong\x3ejson\x3c\/strong\x3e\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3e{\n  \x22component\x22: true,\n  \x22usingComponents\x22: {}\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个文件在创建component的时候会自动写入这段代码。\x3c\/p\x3e\n\x3cp\x3enum-controller.js\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3eComponent({\n  \/**\n   * 组件的属性列表\n   *\/\n  properties: {\n    num: Number\n  },\n\n  \/**\n   * 组件的初始数据\n   *\/\n  data: {\n\n  },\n\n  \/**\n   * 组件的方法列表\n   *\/\n  methods: {\n    add() {\n      \n      this.setData({\n        num: this.data.num \x2b 1\n      })\n      this.triggerEvent(\x27numChange\x27, this.data.num);\n    },\n    sub() {\n      if(this.data.num \x26gt; 0) {\n        this.setData({\n          num: this.data.num - 1\n        })\n      }\n      this.triggerEvent(\x27numChange\x27, this.data.num);\n    }\n  }\n})\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e组件内部接收一个参数num，类型是Number；\x3cbr\x3e点击加号触发add方法，首先把init状态变为false，然后数字\x2b1，同时\x3cstrong\x3e触发numChange方法将改变的数字传到组件外部\x3c\/strong\x3e；\x3cbr\x3e点击减号触发sub方法，数字-1，如果数字为0则把init状态变为true，同时\x3cstrong\x3e触发numChange方法将改变的数字传到组件外部\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e将组件数据传到外部的方法为\x3cstrong\x3ethis.triggerEvent(\x27方法名\x27,{要传递的数据})\x3c\/strong\x3e。\x3c\/p\x3e\n\x3ch3\x3e3. 引入组件\x3c\/h3\x3e\n\x3cp\x3e假如我要在index.\x3cstrong\x3ewxml\x3c\/strong\x3e里引入组件：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3e\x26lt;num-controller num=\x22\x22{{\x22num\x22}}\x22\x22 bindnumChange=\x22numChange\x22\x26gt;\x26lt;\/num-controller\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eindex.\x3cstrong\x3ejson\x3c\/strong\x3e\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3e{\n  \x22usingComponents\x22: {\n    \x22num-controller\x22: \x22\/components\/num-controller\/num-controller\x22\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在json文件里注册组件。\x3c\/p\x3e\n\x3cp\x3eindex.\x3cstrong\x3ejs\x3c\/strong\x3e\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3edata: {\n    num: 1\n},\nnumChange(e) {\n    const numi = e.detail;\n    \n }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3edata里的num是从组件外传入的num，在numChange方法里用e.detail可以拿到组件内部通过this.triggerEvent传出来的数据，然后根据业务需求做逻辑修改。\x3c\/p\x3e\n\x3ch2\x3e三、复杂的组件（筛选面板）\x3c\/h2\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV8PLC?w=376\x26amp;h=163\x22 src=\x22https:\/\/static.alili.tech\/img\/bV8PLC?w=376\x26amp;h=163\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e一个二级菜单，点击左边（一级）会改变右边（二级）的展示。\x3c\/p\x3e\n\x3ch3\x3e1. 创建组件并引入\x3c\/h3\x3e\n\x3cp\x3e组件内部：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3e\/\/ filter-panel.wxml\n\n\x26lt;view class=\x22filter-panel\x22\x26gt;\n  \x26lt;view class=\x22panel-container\x22\x26gt;\n    \x26lt;view class=\x22panel-left\x22\x26gt;\n      ...\n    \x26lt;\/view\x26gt;\n\n    \x26lt;view class=\x22panel-right\x22\x26gt;\n      ...\n    \x26lt;\/view\x26gt;\n  \x26lt;\/view\x26gt;\n\x26lt;\/view\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cpre\x3e\x3ccode\x3e\/\/ filter-panel.json\n\n{\n  \x22component\x22: true\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e组件外部：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3e\/\/ index.wxml\n\n\x26lt;filter-panel\x26gt;\x26lt;\/filter-panel\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cpre\x3e\x3ccode\x3eindex.json\n\n{\n  \x22usingComponents\x22: {\n    \x22filter-panel\x22: \x22\/components\/filter-panel\/filter-panel-component\x22\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样就成功引入组件啦~（说真的组件化做好了非常舒服，后期会省很多力气）\x3c\/p\x3e\n\x3ch3\x3e2.组件与外部的数据传递（重点）\x3c\/h3\x3e\n\x3ch4\x3e(1) 固定数据渲染\x3c\/h4\x3e\n\x3cpre\x3e\x3ccode\x3e\/\/ filter-panel-component.js\n\nComponent({\n  \/**\n   * 组件的属性列表\n   *\/\n  properties: {\n    mode: String,\n    panel: String,\n    text: Array,\n    active: Array\n  },\n\n  \/**\n   * 组件的初始数据\n   *\/\n  data: {\n    filterActive:[]\n  },\n\n  \/**\n   * 组件的方法列表\n   *\/\n  methods: {\n    ...\n  }\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cpre\x3e\x3ccode\x3e\/\/ index.wxml\n\n\x26lt;filter-panel mode=\x22mode1\x22 panel=\x22panel1\x22 text=\x22\x22{{\x22panel1Text\x22}}\x22\x22 active=\x22\x22{{\x22panel1Active\x22}}\x22\x22\x26gt;\x26lt;\/filter-panel\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cpre\x3e\x3ccode\x3e\/\/ index.js\n\npanel1Text: [\n  {\n    \x27location\x27: \x27附近\x27,\n    \x27choice\x27: [\x27不限\x27, \x271km\x27, \x272km\x27, \x273km\x27]\n  }, {\n    \x27location\x27: \x27地铁站\x27,\n    \x27choice\x27: [\x27江汉路\x27, \x27光谷广场\x27, \x27陶家岭\x27, \x27六渡桥\x27]\n  }\n],\npanel1Active: [0, 0]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e从组件外向组件内传递数据，直接在外部引入的组件上传。\x3cbr\x3e这里我传入了4个数据，\x3cbr\x3e\x3cstrong\x3emode\x3c\/strong\x3e代表筛选面板的模式，虽然这里只写了一种，但是实际上有三种形式，我写在了一个组件里，所以每次引入的时候都要指定mode。\x3cbr\x3e\x3cstrong\x3epanel\x3c\/strong\x3e代表是第几个面板，虽然模式有三种，但是首页有四个面板，其中有两个的mode是相同的，为了区分每一个面板传入panel。\x3cbr\x3e\x3cstrong\x3epanel1Text\x3c\/strong\x3e是渲染的数据。\x3cbr\x3e\x3cstrong\x3epanel1Active\x3c\/strong\x3e是用户选择的数据。\x3c\/p\x3e\n\x3cp\x3e到这里组件已经可以正常展示了，但是点击显示选中项还未实现。\x3c\/p\x3e\n\x3ch4\x3e(2) 可变数据渲染\x3c\/h4\x3e\n\x3cp\x3e控制组件active项的是外部的数据panel1Active: [0, 0]，通过组件传到了内部，在组件内部：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3e\/\/ filter-panel-component.js\n\n  properties: {\n    mode: String,\n    panel: String,\n    text: Array,\n    active: Array\n  },\n  data: {\n    filterActive:[]\n  },\n  attached() {\n    this.dataInit();\n  },\n\n  \/**\n   * 组件的方法列表\n   *\/\n  methods: {\n    dataInit() {\n      let active = this.properties.active;\n      this.setData({\n        filterActive: active\n      })\n    },\n    _chooseMode1Left(e) {\n      let mode1LeftIndex = e.currentTarget.dataset.index;\n      let mode1Active = this.data.filterActive;\n      if (mode1LeftIndex == 0) {\n        mode1Active.fill(0, 1, 2);\n      } else {\n        mode1Active.fill(-1, 1, 2);\n      }\n      mode1Active.fill(mode1LeftIndex, 0, 1);\n      this.setData({\n        filterActive: mode1Active\n      })\n    },\n    _chooseMode1Right(e) {\n      let mode1RightIndex = e.currentTarget.dataset.index;\n      let mode1Active = this.data.filterActive;\n      mode1Active.fill(mode1RightIndex, 1, 2);\n      this.setData({\n        filterActive: mode1Active\n      })\n      wx.setStorageSync(this.properties.panel, this.data.filterActive);\n      this.triggerEvent(\x27closePanel\x27, {});\n    }\n  }\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3edataInit方法指把外部传进来的active数组赋给内部的私有变量filterActive，然后在内部控制点击的active项。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3e\/\/ index.wxml\n\n\x26lt;view class=\x22filter-panel mode1\x22 wx:if=\x22\x22{{\x22mode == \x27mode1\x27\x22}}\x22\x22\x26gt;\n  \x26lt;view class=\x22panel-container\x22\x26gt;\n    \x26lt;view class=\x22panel-left\x22\x26gt;\n      \x26lt;view class=\x22left-item \x22{{\x22filterActive[0] == idx1?\x27active\x27:\x27\x27\x22}}\x22\x22 bindtap=\x22_chooseMode1Left\x22 wx:for=\x22\x22{{\x22text\x22}}\x22\x22 wx:for-index=\x22idx1\x22 data-index=\x22\x22{{\x22idx1\x22}}\x22\x22\x26gt;\x22{{\x22item.location\x22}}\x22\x26lt;\/view\x26gt;\n    \x26lt;\/view\x26gt;\n\n    \x26lt;view class=\x22panel-right \x22{{\x22filterActive[0] == idx1?\x27\x27:\x27hide\x27\x22}}\x22\x22 wx:for=\x22\x22{{\x22text\x22}}\x22\x22 wx:for-index=\x22idx1\x22 data-index=\x22\x22{{\x22idx1\x22}}\x22\x22\x26gt;\n      \x26lt;view class=\x22right-item \x22{{\x22filterActive[1] == idx2?\x27active\x27:\x27\x27\x22}}\x22\x22 bindtap=\x22_chooseMode1Right\x22 wx:for=\x22\x22{{\x22item.choice\x22}}\x22\x22 wx:for-index=\x22idx2\x22 data-index=\x22\x22{{\x22idx2\x22}}\x22\x22\x26gt;\n        \x26lt;span\x26gt;\x22{{\x22item\x22}}\x22\x26lt;\/span\x26gt;\n        \x26lt;view class=\x22iconfont icon-correct\x22 hidden=\x22\x22{{\x22filterActive[1] != idx2\x22}}\x22\x22\x26gt;\x26lt;\/view\x26gt;\n      \x26lt;\/view\x26gt;\n    \x26lt;\/view\x26gt;\n  \x26lt;\/view\x26gt;\n\x26lt;\/view\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e_chooseMode1Left和_chooseMode1Right是两个私有方法，官方建议是在函数名前面加上下划线以便区分。\x3cbr\x3e在点击右侧的时候触发外部的方法closePanel。\x3c\/p\x3e\n\x3ch4\x3e(3) 组件内数据传到外部\x3c\/h4\x3e\n\x3cp\x3etriggerEvent方法可以把组件内部的数据传到外面，触发组件外的事件。它接收3个参数：\x3cbr\x3ethis.triggerEvent(\x27myevent\x27, myEventDetail, myEventOption);\x3c\/p\x3e\n\x3cp\x3emyEventDetail和myEventOption都是对象，myEventDetail是传到组件外的数据，myEventOption有三个参数可以设置：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3ebubbles    默认false 事件是否冒泡\ncomposed 默认false 事件是否可以穿越组件边界\ncapturePhase 默认false 事件是否拥有捕获阶段\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e但是这里我并没有用triggerEvent将数据传出去，因为我这么做了之后发现组件内外的数据开始同步了，这不是我想要的效果。在组件外部有可能点击其他地方隐藏筛选面板，就算用户点击了左侧也不改变上一次保留的数据，所以我用wx.setStorageSync来保存上一次用户确定的数据。如果用户点击其他地方隐藏面板，则从Storage里取出真实的数据渲染。\x3c\/p\x3e\n\x3cp\x3e在组件外部可以这样操作内部的方法：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3e\/\/ index.js\n\nonReady() {\n  this.panel1 = this.selectComponent(\x22#panel1\x22);\n},\nshowPanel(e) {\n  this.panel1.dataInit();\n},\x3c\/code\x3e\x3c\/pre\x3e\n\x3cpre\x3e\x3ccode\x3eindex.wxml\n\n\x26lt;filter-panel mode=\x22mode1\x22 panel=\x22panel1\x22 text=\x22\x22{{\x22panel1Text\x22}}\x22\x22 active=\x22\x22{{\x22panel1Active\x22}}\x22\x22 bind:closePanel=\x22closePanel\x22 id=\x22panel1\x22\x26gt;\x26lt;\/filter-panel\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e通过id获取到组件，然后调用组件内的方法。可以在每次显示筛选面板的时候初始化数据。这就是我最后使用的解决办法。\x3c\/p\x3e\n\x3ch2\x3e三、总结\x3c\/h2\x3e\n\x3cp\x3e这个项目里倒是没用用到组件间的数据传递，所以只是组件和外部的传递，还算是比较简单，但是一定要思考清楚数据的变化状态。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>微信小程序：自定义组件的数据传递</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000014474289">https://segmentfault.com/a/1190000014474289</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/0axp4xhxw5uh/" target="_blank">https://alili.tech/archive/0axp4xhxw5uh/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>