<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="你真的会用 Babel 吗?"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>你真的会用 Babel 吗? | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/0ewz2tbeufg8/",
				"appid": "1613049289050283", 
				"title": "你真的会用 Babel 吗? | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-31T02:30:30"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/oszp1csmn5f/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/1oth49dw1x8/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f0ewz2tbeufg8%2f&text=%e4%bd%a0%e7%9c%9f%e7%9a%84%e4%bc%9a%e7%94%a8%20Babel%20%e5%90%97%3f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f0ewz2tbeufg8%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f0ewz2tbeufg8%2f&text=%e4%bd%a0%e7%9c%9f%e7%9a%84%e4%bc%9a%e7%94%a8%20Babel%20%e5%90%97%3f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f0ewz2tbeufg8%2f&title=%e4%bd%a0%e7%9c%9f%e7%9a%84%e4%bc%9a%e7%94%a8%20Babel%20%e5%90%97%3f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f0ewz2tbeufg8%2f&is_video=false&description=%e4%bd%a0%e7%9c%9f%e7%9a%84%e4%bc%9a%e7%94%a8%20Babel%20%e5%90%97%3f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%bd%a0%e7%9c%9f%e7%9a%84%e4%bc%9a%e7%94%a8%20Babel%20%e5%90%97%3f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f0ewz2tbeufg8%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f0ewz2tbeufg8%2f&title=%e4%bd%a0%e7%9c%9f%e7%9a%84%e4%bc%9a%e7%94%a8%20Babel%20%e5%90%97%3f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f0ewz2tbeufg8%2f&title=%e4%bd%a0%e7%9c%9f%e7%9a%84%e4%bc%9a%e7%94%a8%20Babel%20%e5%90%97%3f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f0ewz2tbeufg8%2f&title=%e4%bd%a0%e7%9c%9f%e7%9a%84%e4%bc%9a%e7%94%a8%20Babel%20%e5%90%97%3f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f0ewz2tbeufg8%2f&title=%e4%bd%a0%e7%9c%9f%e7%9a%84%e4%bc%9a%e7%94%a8%20Babel%20%e5%90%97%3f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">你真的会用 Babel 吗?</h1><div class="meta"><div class="postdate"><time datetime="2018-12-31" itemprop="datePublished">2018-12-31</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e引入\x3c\/h2\x3e\n\x3cp\x3e这个问题是对自己的发问，但我相信会有很多跟我一样的同学。\x3cbr\x3e对于 babel 的使用，近半年来一直停留在与 webpack 结合使用，以及在浏览器开发环境下。导致很多 babel 的包，我都不清楚他们是干嘛的。比如 babel-register，还有 babel-runtime，各种 presets 的区别，transform-runtime 和 babel-polyfill 的区别，helpers 是干嘛的。尽管网上的 babel 的教程很多了，但是解答自己的一些疑问，还是要花费一些功夫。所以抽出时间来总结一下。如果你对于以上概念已经比较清楚了，就不需要往下看了。\x3c\/p\x3e\n\x3cp\x3e本次的 example 代码都在 \x3ca href=\x22https:\/\/github.com\/sunyongjian\/babel-usage\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3egithub\x3c\/a\x3e 上，而且每个文件夹都有详细的 README，说明我的使用方式。可以去参照一下用例的使用，并 clone 下来自己研究一下。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e版本变化\x3c\/h2\x3e\n\x3cp\x3e说实话，从我做前端的时候，接触 babel 的时候，就已经是 babel 6 了，但是这不妨碍了解一下它的重大版本变化。\x3cbr\x3e上一个版本 babel 5 是全家桶，包括各种package， plugins，尽可能的想通过你的一次安装，达到全能的效果。不过你现在安装\x3ccode\x3enpm install babel\x3c\/code\x3e，会得到一个 warning。babel 6 是 \x3ca href=\x22https:\/\/github.com\/babel\/babel\/releases?after=v6.0.1\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e2015年10月30号\x3c\/a\x3e发布，主要做了以下更新：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e拆分成几个核心包，\x3ccode\x3ebabel-core\x3c\/code\x3e,\x3ccode\x3ebabel-node\x3c\/code\x3e,\x3ccode\x3ebabel-cli\x3c\/code\x3e...\x3c\/li\x3e\n\x3cli\x3e没有了默认的转换，现在你需要手动的添加 plugin。也就是插件化\x3c\/li\x3e\n\x3cli\x3e添加了 preset，也就是预置条件。\x3c\/li\x3e\n\x3cli\x3e增加了 .babelrc 文件，方便自定义的配置。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e差不多了，我感觉其他的也不需要了解了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e包\x3c\/h2\x3e\n\x3cp\x3ebabel 里面有好多的包，所以必须搞清楚他们都是干嘛的，才能让我们更好的使用这个工具。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3ebabel-core\x3c\/h3\x3e\n\x3cp\x3e可以看做 babel 的编译器。babel 的核心 api 都在这里面，比如 transform，主要都是处理转码的。它会把我们的 js 代码，抽象成 ast，即 abstract syntax tree 的缩写，是源代码的抽象语法结构的树状表现形式。我们可以理解为，它定义的一种分析 js 语法的树状结构。也就是说 es6 的新语法，跟老语法是不一样的，那我们怎么去定义这个语法呢。所以必须要先转成 ast，去发现这个语法的 kind，分别做对应的处理，才能转化成 es5.\x3c\/p\x3e\n\x3cp\x3e主要 api：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var babel = require(\x27babel-core\x27);\nvar transform = babel.transform;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e babel = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27babel-core\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e transform = babel.transform;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3ebabel.transform(code: string, options?: Object)\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22transform(\x26quot;code\x26quot;, options) \/\/ =\x3e { code, map, ast }\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3etransform(\x3cspan class=\x22hljs-string\x22\x3e\x22code\x22\x3c\/span\x3e, options) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ =\x26gt; { code, map, ast }\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3ebabel.transformFile(filename: string, options?: Object, callback: Function)\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var path = require(\x27path\x27);\nvar result = babel.transformFileSync(path.resolve(__dirname) \x2b \x26quot;\/test.js\x26quot;, {\n  presets: [\x27env\x27],\n  plugins: [\x27transform-runtime\x27],\n}, function(err, result) {\/\/ { code, map, ast }\n    console.log(result);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e path = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27path\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e result = babel.transformFileSync(path.resolve(__dirname) \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22\/test.js\x22\x3c\/span\x3e, {\n  \x3cspan class=\x22hljs-attr\x22\x3epresets\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27env\x27\x3c\/span\x3e],\n  \x3cspan class=\x22hljs-attr\x22\x3eplugins\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27transform-runtime\x27\x3c\/span\x3e],\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr, result\x3c\/span\x3e) \x3c\/span\x3e{\x3cspan class=\x22hljs-comment\x22\x3e\/\/ { code, map, ast }\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(result);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3ebabel.transformFileSync(filename: string, options?: Object)\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var result = babel.transformFileSync(path.resolve(__dirname) \x2b \x26quot;\/test.js\x26quot;, {\n  presets: [\x27env\x27],\n  plugins: [\x27transform-runtime\x27],\n});\nconsole.log(result, \x27res\x27);\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e result = babel.transformFileSync(path.resolve(__dirname) \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22\/test.js\x22\x3c\/span\x3e, {\n  \x3cspan class=\x22hljs-attr\x22\x3epresets\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27env\x27\x3c\/span\x3e],\n  \x3cspan class=\x22hljs-attr\x22\x3eplugins\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27transform-runtime\x27\x3c\/span\x3e],\n});\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(result, \x3cspan class=\x22hljs-string\x22\x3e\x27res\x27\x3c\/span\x3e);\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3ebabel.transformFromAst(ast: Object, code?: string, options?: Object)\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e反转，你把 ast 传入，解析为 code 代码。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/babel\/babel\/tree\/master\/packages\/babel-core\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eoptions\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3ebabel-cli\x3c\/h3\x3e\n\x3cp\x3e提供命令行运行 babel。也就是你可以 \x3ccode\x3ebabel filename\x3c\/code\x3e 去对文件转码。\x3cbr\x3e安装的话\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install --save-dev babel-cli\n\nnpm isntall babel-cli -g\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs mipsasm\x22\x3e\x3ccode\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3einstall \x3c\/span\x3e--save-dev \x3cspan class=\x22hljs-keyword\x22\x3ebabel-cli\n\x3c\/span\x3e\nnpm isntall \x3cspan class=\x22hljs-keyword\x22\x3ebabel-cli \x3c\/span\x3e-g\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e使用对应就是\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22node_module\/.bin\/babel script.js --out-file script-compiled.js\n\nbabel script.js --out-file script-compiled.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3enode_module\/.bin\/babel script\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e --out-file script-compiled\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n\nbabel script\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e --out-file script-compiled.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e具体使用还是看\x3ca href=\x22http:\/\/babeljs.io\/docs\/usage\/cli\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e官方文档\x3c\/a\x3e吧，我就不搬文档了。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3ebabel-external-helpers\x3c\/h3\x3e\n\x3cp\x3ebabel-cli 中的一个command，用来生成一段代码，包含 babel 所有的 helper 函数。\x3c\/p\x3e\n\x3cp\x3e首先我们需要了解什么是 helpers。babel 有很多帮助函数，例如 toArray函数， jsx转化函数。这些函数是 babel transform 的时候用的，都放在 \x3ccode\x3ebabel-helpers\x3c\/code\x3e这个包中。如果 babe 编译的时候检测到某个文件需要这些 helpers，在编译成模块的时候，会放到模块的顶部。\x3cbr\x3e像这样\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22(function(module, exports, __webpack_require__) {\n\nfunction _asyncToGenerator(fn) { return function () {  }; } \/\/ 模块顶部定义 helper\n\n\/\/ some code \n\/\/ async 语法已经被 transform-async-to-generator 转化，再利用 helper 函数包装，消费 generator。\nconst func = (() =\x3e {\n  var _ref = _asyncToGenerator(function* () {\n    console.log(\x27begin\x27);\n    yield new Promise(function (resolve) {\n      setTimeout(function () {\n        resolve();\n      }, 1000);\n    });\n    console.log(\x27done\x27);\n  });\n})\n\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3emodule, exports, __webpack_require__\x3c\/span\x3e) \x3c\/span\x3e{\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3e_asyncToGenerator\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3efn\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{  }; } \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 模块顶部定义 helper\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ some code \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ async 语法已经被 transform-async-to-generator 转化，再利用 helper 函数包装，消费 generator。\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e func = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e(\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _ref = _asyncToGenerator(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e* (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27begin\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3eyield\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eresolve\x3c\/span\x3e) \x3c\/span\x3e{\n      setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        resolve();\n      }, \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e);\n    });\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27done\x27\x3c\/span\x3e);\n  });\n})\n\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e但是如果多个文件都需要提供，会重复引用这些 helpers，会导致每一个模块都定义一份，代码冗余。所以 babel 提供了这个命令，用于生成一个包含了所有 helpers 的 js 文件，用于直接引用。然后再通过一个 plugin，去检测全局下是否存在这个模块，存在就不需要重新定义了。\x3c\/p\x3e\n\x3cp\x3e使用：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3cp\x3e执行 babel-external-helpers 生成 helpers.js 文件，\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 node_modules\/.bin\/babel-external-helpers \x3e helpers.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs armasm\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e node_modules\/.\x3cspan class=\x22hljs-keyword\x22\x3ebin\/babel-external-helpers \x3c\/span\x3e\x26gt; helpers.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e注意：示例代码的包都是装到项目中的，也就是本地。同样你可以全局安装直接执行。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e安装 plugin\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install --save-dev babel-plugin-external-helpers\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3enpm install --save-dev babel-plugin-external-helpers\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e然后在 babel 的配置文件加入\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;plugins\x26quot;: [\x26quot;external-helpers\x26quot;]\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs json\x22\x3e\x3ccode\x3e{\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22plugins\x22\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x22external-helpers\x22\x3c\/span\x3e]\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e入口文件引入 helpers.js\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22require(\x27.\/helpers.js\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/helpers.js\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e这样就可以啦，还是可以减少很多代码量的。另外如果使用了 transform-runtime，就不需要生成 helpers.js 文件了，这个在后面的 babel-runtime 再说。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3ebabel-node\x3c\/h3\x3e\n\x3cp\x3e也是 babel-cli 下面的一个 command，主要是实现了 node 执行脚本和命令行写代码的能力。举两个栗子就清楚了。\x3c\/p\x3e\n\x3ch5\x3e执行脚本\x3c\/h5\x3e\n\x3cp\x3enode 环境肯定是不支持 jsx 的\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ test.js\nconst React = require(\x27react\x27);\nconst elements = [1, 2, 3].map((item) =\x3e {\n  return (\n    \x3cdiv\x3e{item}\x3c\/div\x3e\n  )\n});\n\nconsole.log(elements);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ test.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e React = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e elements = [\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e].map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n    \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e{item}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n  )\n});\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(elements);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e执行 test.js，会报错，不认识这个语法。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22node test.js \/\/报错\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs crmsh\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3enode\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etest\x3c\/span\x3e.js \/\/报错\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e但是使用 babel-node 就可以。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 node_modules\/.bin\/babel-node --presets react test.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs crmsh\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e node_modules\/.bin\/babel-\x3cspan class=\x22hljs-keyword\x22\x3enode\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3e--presets\x3c\/span\x3e react test.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e--presets react 是参数，等同于\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;presets\x26quot;: [\x26quot;react\x26quot;]\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs json\x22\x3e\x3ccode\x3e{\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22presets\x22\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x22react\x22\x3c\/span\x3e]\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e执行正常。\x3c\/p\x3e\n\x3ch5\x3enode 命令行写代码\x3c\/h5\x3e\n\x3cp\x3e注意： 本文所有代码示例，均在 node 版本 4.8.4 下执行。\x3c\/p\x3e\n\x3cp\x3e写个解构赋值的，直接运行 node，不支持。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVU0w5?w=353\x26amp;h=110\x22 src=\x22https:\/\/static.alili.tech\/img\/bVU0w5?w=353\x26amp;h=110\x22 alt=\x2230377925-1f2112da-98c4-11e7-95ce-ac7f497c0f93.png\x22 title=\x2230377925-1f2112da-98c4-11e7-95ce-ac7f497c0f93.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e运行 \x3ccode\x3enode_modules\/.bin\/babel-node --presets env\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVU0xt?w=578\x26amp;h=83\x22 src=\x22https:\/\/static.alili.tech\/img\/bVU0xt?w=578\x26amp;h=83\x22 alt=\x2230377934-29b8a8a2-98c4-11e7-822d-226f0b9d5b81.png\x22 title=\x2230377934-29b8a8a2-98c4-11e7-822d-226f0b9d5b81.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e得到 a 的 value 是 1。\x3c\/p\x3e\n\x3cp\x3e通过栗子基本已经介绍了 babel-node 的用法了，就是方便我们平常开发时候，写一些脚本的。所以它不适用于生产环境。另外，babel-node 已经内置了 polyfill，并依赖 babel-register 来编译脚本。好，那 babel-register 是什么呢\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3ebabel-register\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install babel-register --save-dev\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs sql\x22\x3e\x3ccode class=\x22shell\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3einstall\x3c\/span\x3e babel-\x3cspan class=\x22hljs-keyword\x22\x3eregister\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e--save-dev\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ebabel-node 可以通过它编译代码，可以了解到，它其实就是一个编译器。我们同样可以在代码中引入它 \x3ccode\x3erequire(\x27babel-register\x27)\x3c\/code\x3e，并通过 node 执行我们的代码。\x3c\/p\x3e\n\x3cp\x3e它的原理是通过改写 node 本身的 require，添加钩子，然后在 require 其他模块的时候，就会触发 babel 编译。也就是你引入\x3ccode\x3erequire(\x27babel-register\x27)\x3c\/code\x3e的文件代码，是不会被编译的。只有通过 require 引入的其他代码才会。我们是不是可以理解，babel-node 就是在内存中写入一个临时文件，在顶部引入 babel-register，然后再引入我们的脚本或者代码？\x3c\/p\x3e\n\x3cp\x3e举个栗子，还是 node 中执行 jsx，要通过 babel 编译。我们可以把 jsx 的代码 a.js 编译完输出到一个 b.js，然后 \x3ccode\x3enode b.js\x3c\/code\x3e 也是可以执行的。但是太麻烦，不利于开发。让我们看一下通过 register 怎么用：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ register.js 引入 babel-register，并配置。然后引入要执行代码的入口文件\nrequire(\x27babel-register\x27)({ presets: [\x27react\x27] });\nrequire(\x27.\/test\x27)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ register.js 引入 babel-register，并配置。然后引入要执行代码的入口文件\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27babel-register\x27\x3c\/span\x3e)({ \x3cspan class=\x22hljs-attr\x22\x3epresets\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e] });\n\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/test\x27\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ test.js 这个文件是 jsx...\nconst React = require(\x27react\x27);\nconst elements = [1, 2, 3].map((item) =\x3e {\n  return (\n    \x3cdiv\x3e{item}\x3c\/div\x3e\n  )\n});\nconsole.log(elements);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ test.js 这个文件是 jsx...\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e React = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e elements = [\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e].map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n    \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e{item}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n  )\n});\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(elements);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 执行\n$ node register.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs crmsh\x22\x3e\x3ccode\x3e\/\/ 执行\n$ \x3cspan class=\x22hljs-keyword\x22\x3enode\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eregister\x3c\/span\x3e.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e它的特点就是实时编译，不需要输出文件，执行的时候再去编译。所以它很适用于开发。总结一下就是，多用在 node 跑程序，做实时编译用的，通常会结合其他插件作编译器使用，比如 mocha 做测试的时候。\x3c\/p\x3e\n\x3cp\x3e值得一提的是，babel-register 这个包之前是在 babel-core 下面的，所以也可以 \x3ccode\x3erequire(\x27babel-core\/register\x27)\x3c\/code\x3e 去引入，跟\x3ccode\x3erequire(\x27babel-register\x27)\x3c\/code\x3e是一样的。但是，babel 的团队把 register 独立出来了，而且未来的某一天（升 7.0）会从 babel-core 中废除，所以我们现在最好还是使用 babel-register 吧。\x3ca href=\x22https:\/\/github.com\/babel\/babel\/blob\/master\/packages\/babel-core\/register.js#L3\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ebabel-core\/register.js\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3ebabel-runtime\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install babel-runtime --save\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs mipsasm\x22\x3e\x3ccode class=\x22shell\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3einstall \x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ebabel-runtime \x3c\/span\x3e--save\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个包很简单，就是引用了 core-js 和 regenerator，然后生产环境把它们编译到 dist 目录下，做了映射，供使用。那么什么是 core-js 和 regenerator 呢。\x3cbr\x3e首先我们要知道上面提到的 babel-core 是对语法进行 transform 的，但是它不支持 build-ints（Eg: promise，Set，Map），prototype function（Eg: array.reduce,string.trim），class static function （Eg：Array.form，Object.assgin），regenerator （Eg：generator，async）等等拓展的编译。所以才要用到 core-js 和 regenerator。\x3c\/p\x3e\n\x3ch4\x3ecore-js\x3c\/h4\x3e\n\x3cp\x3ecore-js 是用于 JavaScript 的组合式标准化库，它包含 es5 （e.g: object.freeze）, es6的 promise，symbols, collections, iterators, typed arrays， es7\x2b提案等等的 polyfills 实现。也就是说，它几乎包含了所有 JavaScript 最新标准的垫片。不过为什么它不把 generator 也实现了... 😁\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 比如，只不过需要单个引用\nrequire(\x27core-js\/array\/reduce\x27);\nrequire(\x27core-js\/object\/values\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 比如，只不过需要单个引用\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27core-js\/array\/reduce\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27core-js\/object\/values\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3eregenerator\x3c\/h4\x3e\n\x3cp\x3e它是来自于 facebook 的一个库，\x3ca href=\x22https:\/\/github.com\/facebook\/regenerator\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e链接\x3c\/a\x3e。主要就是实现了 generator\/yeild， async\/await。\x3c\/p\x3e\n\x3cp\x3e所以 babel-runtime 是单纯的实现了 core-js 和 regenerator 引入和导出，比如这里是 filter 函数的定义，做了一个中转并处理了 esModule 的兼容。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22module.exports = { \x26quot;default\x26quot;: require(\x26quot;core-js\/library\/fn\/array\/filter\x26quot;), __esModule: true };\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = { \x3cspan class=\x22hljs-string\x22\x3e\x22default\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22core-js\/library\/fn\/array\/filter\x22\x3c\/span\x3e), \x3cspan class=\x22hljs-attr\x22\x3e__esModule\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e };\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3ehelpers\x3c\/h4\x3e\n\x3cp\x3e还记得提 babel-external-helpers 的时候，介绍 helpers 了吗。babel-runtime 里面的 helpers 就相当于我们上面通过 babel-external-helpers 生成的 helpers.js。只不过它把每个 helper 都单独放到一个文件夹里。这样，配合 transform-runtime 使用的时候，需要用 helper 转化的时候，就从 babel-runtime 中直接引用了。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var _asyncToGenerator2 = require(\x27babel-runtime\/helpers\/asyncToGenerator\x27);\n\nvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _asyncToGenerator2 = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27babel-runtime\/helpers\/asyncToGenerator\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e文件结构：\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011164344\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011164344\x22 alt=\x22文件结构\x22 title=\x22文件结构\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e使用\x3c\/h4\x3e\n\x3cp\x3e可以单独引入\x3ccode\x3erequire(\x27babel-runtime\/core-js\/object\/values\x27);\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e不过这些模块都做了 esModule 的兼容处理，也就是上面引入的模块是\x3ccode\x3e{ \x22default\x22: require(\x22core-js\/library\/fn\/array\/filter\x22), __esModule: true }\x3c\/code\x3e这样的，要使用还得加上 \x3ccode\x3e.default\x3c\/code\x3e。所以我们期待的是，最好能有帮我们自动处理的插件，\x3ccode\x3ebabel-plugin-transform-runtime\x3c\/code\x3e就是用来做这个的。这个我们放到 plugin 去讲。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3ebabel-polyfill\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install babel-polyfill --save\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs mipsasm\x22\x3e\x3ccode class=\x22shell\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3einstall \x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ebabel-polyfill \x3c\/span\x3e--save\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ebabel-runtime 已经是一堆 polyfill 了，为什么这里还有一个类似的包，它同样是引用了 core-js 和 regenerator，垫片支持是一样的。官网是这么说的，babel-polyfill 是为了模拟一个完整的ES2015 \x2b环境，旨在用于应用程序而不是库\/工具。并且使用babel-node时，这个polyfill会自动加载（这个我们在介绍 babel-node 的最后已经说了）。\x3c\/p\x3e\n\x3cp\x3e也就是说，它会让我们程序的执行环境，模拟成完美支持 es6\x2b 的环境，毕竟无论是浏览器环境还是 node 环境对 es6\x2b 的支持都不一样。它是以重载全局变量 （E.g: Promise）,还有原型和类上的静态方法（E.g：Array.prototype.reduce\/Array.form），从而达到对 es6\x2b 的支持。不同于 babel-runtime 的是，babel-polyfill 是一次性引入你的项目中的，就像是 React 包一样，同项目代码一起编译到生产环境。\x3c\/p\x3e\n\x3ch4\x3e使用\x3c\/h4\x3e\n\x3cp\x3e我们结合 babel-register 去使用一下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ index.js\nrequire(\x27babel-core\/register\x27)({});\nrequire(\x27babel-polyfill\x27);\nrequire(\x27.\/async\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ index.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27babel-core\/register\x27\x3c\/span\x3e)({});\n\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27babel-polyfill\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/async\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ async.js\nasync function a() {\n  console.log(\x27begin\x27);\n  await new Promise((resolve) =\x3e {\n    setTimeout(() =\x3e {\n      resolve();\n    }, 1000)\n  })\n  console.log(\x27done\x27);\n}\na();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ async.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3easync\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ea\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27begin\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3eawait\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      resolve();\n    }, \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e)\n  })\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27done\x27\x3c\/span\x3e);\n}\na();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$ node index.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs crmsh\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e$ \x3cspan class=\x22hljs-keyword\x22\x3enode\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eindex\x3c\/span\x3e.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e完美运行。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3eplugins\x3c\/h2\x3e\n\x3cp\x3e要说 plugins 就不得不提 babel 编译的过程。babel 编译分为三步：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3eparser：通过 \x3ca href=\x22https:\/\/github.com\/babel\/babylon\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ebabylon\x3c\/a\x3e 解析成 AST。\x3c\/li\x3e\n\x3cli\x3etransform[s]：All the plugins\/presets ，进一步的做语法等自定义的转译，仍然是 AST。\x3c\/li\x3e\n\x3cli\x3egenerator： 最后通过 \x3ca href=\x22https:\/\/github.com\/babel\/babel\/blob\/master\/packages\/babel-generator\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ebabel-generator\x3c\/a\x3e 生成  output string。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e所以 plugins 是在第二步加强转译的，所以假如我们自己写个 plugin，应该就是对 ast 结构做一个遍历，操作。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3ebabel-plugin-transform-runtime\x3c\/h3\x3e\n\x3cp\x3e上面我们知道，transform-runtime 是为了方便使用 babel-runtime 的，它会分析我们的 ast 中，是否有引用 babel-rumtime 中的垫片（通过映射关系），如果有，就会在当前模块顶部插入我们需要的垫片。试一下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install babel-plugin-transform-runtime\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs sql\x22\x3e\x3ccode class=\x22shell\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3einstall\x3c\/span\x3e babel-\x3cspan class=\x22hljs-keyword\x22\x3eplugin\x3c\/span\x3e-transform-runtime\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 编译前\nconsole.log(Object.values({ 1: 2 }));\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 编译前\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.values({ \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e }));\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22node_modules\/.bin\/babel --plugins transform-runtime values.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gradle\x22\x3e\x3ccode class=\x22shell\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3enode_modules\x3cspan class=\x22hljs-regexp\x22\x3e\/.bin\/\x3c\/span\x3ebabel --plugins transform-\x3cspan class=\x22hljs-keyword\x22\x3eruntime\x3c\/span\x3e values.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 编译后\n\x27use strict\x27;\n\nvar _values = require(\x27babel-runtime\/core-js\/object\/values\x27);\n\nvar _values2 = _interopRequireDefault(_values);\n\nfunction _interopRequireDefault(obj) { return obj \x26amp;\x26amp; obj.__esModule ? obj : { default: obj }; }\n\nonsole.log((0, _values2.default)({ 1: 2 }));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 编译后\x3c\/span\x3e\n\x3cspan class=\x22hljs-meta\x22\x3e\x27use strict\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _values = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27babel-runtime\/core-js\/object\/values\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _values2 = _interopRequireDefault(_values);\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3e_interopRequireDefault\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eobj\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e obj \x26amp;\x26amp; obj.__esModule ? obj : { \x3cspan class=\x22hljs-attr\x22\x3edefault\x3c\/span\x3e: obj }; }\n\nonsole.log((\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, _values2.default)({ \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e }));\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e另外，它还有几个配置\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 默认值\n{\n  \x26quot;plugins\x26quot;: [\n    [\x26quot;transform-runtime\x26quot;, {\n      \x26quot;helpers\x26quot;: true,\n      \x26quot;polyfill\x26quot;: true,\n      \x26quot;regenerator\x26quot;: true,\n      \x26quot;moduleName\x26quot;: \x26quot;babel-runtime\x26quot;\n    }]\n  ]\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 默认值\x3c\/span\x3e\n{\n  \x3cspan class=\x22hljs-string\x22\x3e\x22plugins\x22\x3c\/span\x3e: [\n    [\x3cspan class=\x22hljs-string\x22\x3e\x22transform-runtime\x22\x3c\/span\x3e, {\n      \x3cspan class=\x22hljs-string\x22\x3e\x22helpers\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22polyfill\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22regenerator\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22moduleName\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22babel-runtime\x22\x3c\/span\x3e\n    }]\n  ]\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果你只需要用 regenerator，不需要 core-js 里面的 polyfill 那你就可以在 options 中把 polyfill 设为 false。helpers 设为 false，就相当于没有启用 \x3ccode\x3ebabel-plugin-external-helpers\x3c\/code\x3e 的效果，比如翻译 async 的时候，用到了 asyncToGenerator 函数，每个文件还会重新定义一下。moduleName 的话，就是用到的库，你可以把 babel-runtime 换成其他类似的。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3etransform-runtime 对比 babel-polyfill\x3c\/h3\x3e\n\x3cp\x3e其实通过上面的介绍我们已经了解他们是干什么的了，这里再稍微总结区分一下吧。我在这里把 babel-runtime 和 babel-plugin-transform-runtime 统称为 transform-runtime，因为一起用才比较好。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3ebabel-polyfill 是当前环境注入这些 es6\x2b 标准的垫片，好处是引用一次，不再担心兼容，而且它就是全局下的包，代码的任何地方都可以使用。缺点也很明显，它可能会污染原生的一些方法而把原生的方法重写。如果当前项目已经有一个 polyfill 的包了，那你只能保留其一。而且一次性引入这么一个包，会大大增加体积。如果你只是用几个特性，就没必要了，如果你是开发较大的应用，而且会频繁使用新特性并考虑兼容，那就直接引入吧。\x3c\/li\x3e\n\x3cli\x3etransform-runtime 是利用 plugin 自动识别并替换代码中的新特性，你不需要再引入，只需要装好 babel-runtime 和 配好 plugin 就可以了。好处是按需替换，检测到你需要哪个，就引入哪个 polyfill，如果只用了一部分，打包完的文件体积对比 babel-polyfill 会小很多。而且 transform-runtime 不会污染原生的对象，方法，也不会对其他 polyfill 产生影响。所以 transform-runtime 的方式更适合开发工具包，库，一方面是体积够小，另一方面是用户（开发者）不会因为引用了我们的工具，包而污染了全局的原生方法，产生副作用，还是应该留给用户自己去选择。缺点是随着应用的增大，相同的 polyfill 每个模块都要做重复的工作（检测，替换），虽然 polyfill 只是引用，编译效率不够高效。\x3cstrong\x3e值得注意的是，instance 上新添加的一些方法，babel-plugin-transform-runtime 是没有做处理的，比如 数组的 \x3ccode\x3eincludes, filter, fill\x3c\/code\x3e 等，这个算是一个关键问题吧，直接推荐用 polyfill。\x3c\/strong\x3e\x3ca href=\x22https:\/\/github.com\/jakwuh\/babel-plugin-transform-runtime\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3elink\x3c\/a\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e另外，关于 babel-runtime 为什么是 dependencies 依赖。它只是一个集中了 polyfill 的 library，对应需要的 polyfill 都是要引入项目中，并跟项目代码一起打包的。不过它不会都引入，你用了哪个，plugin 就给你 require 哪个。所以即使你最终项目只是 \x3ccode\x3erequire(\x27babel-runtime\/core-js\/object\/values\x27)\x3c\/code\x3e其中的一个文件，但是对于这包来说，也是生产依赖的。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011245833\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011245833\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e注意：babel-polyfill 并不是一定会污染全局环境，在引入这个 js，并运行的时候，它会先判断当前有没有这个方法，在看要不要重写。如上图\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader13\x22\x3epresets\x3c\/h2\x3e\n\x3cp\x3e各种配置 plugin 实在是费劲，es6\x2b 编译要加入好多 plugins，比如为了在 node 中使用 esmodule，要把 esmodule 转化成 commomjs，使用 \x3ccode\x3etransform-es2015-modules-commonjs\x3c\/code\x3e，还有 asyncToGenerator，React jsx转化等等，不仅要装好多，还要配好多。\x3c\/p\x3e\n\x3cp\x3epresets 就是 plugins 的组合，你也可以理解为是套餐... 主要有\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/babeljs.io\/docs\/plugins\/preset-env\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eenv\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/babeljs.io\/docs\/plugins\/preset-es2015\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ees2015\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/babeljs.io\/docs\/plugins\/preset-react\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/babeljs.io\/docs\/plugins\/preset-latest\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3elastet\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/babeljs.io\/docs\/plugins\/#presets-stage-x-experimental-presets-\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3estage-x\x3c\/a\x3e   具体的语法属于哪个 stage 可参照\x3ca href=\x22https:\/\/github.com\/tc39\/proposals\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etc39\x3c\/a\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e大部分的 presets 我觉得都不需要介绍了，官网上写的比较详细。而且 babel-preset-lastet 已经废弃，被 babel-preset-env 代替。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{ \x26quot;presets\x26quot;: [\x26quot;latest\x26quot;] } === { \x26quot;presets\x26quot;: [\x26quot;env\x26quot;] }\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e{ \x3cspan class=\x22hljs-string\x22\x3e\x22presets\x22\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x22latest\x22\x3c\/span\x3e] } === { \x3cspan class=\x22hljs-string\x22\x3e\x22presets\x22\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x22env\x22\x3c\/span\x3e] }\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader14\x22\x3ebabel-preset-env\x3c\/h3\x3e\n\x3cp\x3e这个 preset 真是神器啊，它能根据当前的运行环境，自动确定你需要的 plugins 和 polyfills。通过各个 es标准 feature 在不同浏览器以及 node 版本的支持情况，再去维护一个 feature 跟 plugins 之间的映射关系，最终确定需要的 plugins。\x3c\/p\x3e\n\x3ch4\x3epreset-env 配置\x3c\/h4\x3e\n\x3cp\x3e详情：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;presets\x26quot;: [\n    [\n      \x26quot;env\x26quot;,\n      {\n        \x26quot;targets\x26quot;: { \/\/ 配支持的环境\n          \x26quot;browsers\x26quot;: [ \/\/ 浏览器\n            \x26quot;last 2 versions\x26quot;,\n            \x26quot;safari \x3e= 7\x26quot;\n          ],\n          \x26quot;node\x26quot;: \x26quot;current\x26quot;\n        },\n        \x26quot;modules\x26quot;: true,  \/\/设置ES6 模块转译的模块格式 默认是 commonjs\n        \x26quot;debug\x26quot;: true, \/\/ debug，编译的时候 console\n        \x26quot;useBuiltIns\x26quot;: false, \/\/ 是否开启自动支持 polyfill\n        \x26quot;include\x26quot;: [], \/\/ 总是启用哪些 plugins\n        \x26quot;exclude\x26quot;: []  \/\/ 强制不启用哪些 plugins，用来防止某些插件被启用\n      }\n    ]\n  ],\n  plugins: [\n    \x26quot;transform-react-jsx\x26quot; \/\/如果是需要支持 jsx 这个东西要单独装一下。\n  ]\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e{\n  \x3cspan class=\x22hljs-string\x22\x3e\x22presets\x22\x3c\/span\x3e: [\n    [\n      \x3cspan class=\x22hljs-string\x22\x3e\x22env\x22\x3c\/span\x3e,\n      {\n        \x3cspan class=\x22hljs-string\x22\x3e\x22targets\x22\x3c\/span\x3e: { \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 配支持的环境\x3c\/span\x3e\n          \x3cspan class=\x22hljs-string\x22\x3e\x22browsers\x22\x3c\/span\x3e: [ \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 浏览器\x3c\/span\x3e\n            \x3cspan class=\x22hljs-string\x22\x3e\x22last 2 versions\x22\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-string\x22\x3e\x22safari \x26gt;= 7\x22\x3c\/span\x3e\n          ],\n          \x3cspan class=\x22hljs-string\x22\x3e\x22node\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22current\x22\x3c\/span\x3e\n        },\n        \x3cspan class=\x22hljs-string\x22\x3e\x22modules\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,  \x3cspan class=\x22hljs-comment\x22\x3e\/\/设置ES6 模块转译的模块格式 默认是 commonjs\x3c\/span\x3e\n        \x3cspan class=\x22hljs-string\x22\x3e\x22debug\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ debug，编译的时候 console\x3c\/span\x3e\n        \x3cspan class=\x22hljs-string\x22\x3e\x22useBuiltIns\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 是否开启自动支持 polyfill\x3c\/span\x3e\n        \x3cspan class=\x22hljs-string\x22\x3e\x22include\x22\x3c\/span\x3e: [], \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 总是启用哪些 plugins\x3c\/span\x3e\n        \x3cspan class=\x22hljs-string\x22\x3e\x22exclude\x22\x3c\/span\x3e: []  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 强制不启用哪些 plugins，用来防止某些插件被启用\x3c\/span\x3e\n      }\n    ]\n  ],\n  \x3cspan class=\x22hljs-attr\x22\x3eplugins\x3c\/span\x3e: [\n    \x3cspan class=\x22hljs-string\x22\x3e\x22transform-react-jsx\x22\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果是需要支持 jsx 这个东西要单独装一下。\x3c\/span\x3e\n  ]\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e主要介绍 debug 和 很好用的 useBuiltIns 吧。\x3c\/p\x3e\n\x3ch4\x3edebug\x3c\/h4\x3e\n\x3cp\x3e开启debug后，编译结果会得到使用的 targets，plugins，polyfill 等信息\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Using targets:\n{\n  \x26quot;chrome\x26quot;: \x26quot;59\x26quot;,\n  \x26quot;android\x26quot;: \x26quot;4.4.3\x26quot;,\n  \x26quot;edge\x26quot;: \x26quot;14\x26quot;,\n  \x26quot;firefox\x26quot;: \x26quot;54\x26quot;,\n  \x26quot;ie\x26quot;: \x26quot;10\x26quot;,\n  \x26quot;ios\x26quot;: \x26quot;10\x26quot;,\n  \x26quot;safari\x26quot;: \x26quot;7\x26quot;,\n  \x26quot;node\x26quot;: \x26quot;4.8.4\x26quot;\n}\n\nModules transform: commonjs\n\nUsing plugins:\n  check-es2015-constants {\x26quot;android\x26quot;:\x26quot;4.4.3\x26quot;,\x26quot;ie\x26quot;:\x26quot;10\x26quot;,\x26quot;safari\x26quot;:\x26quot;7\x26quot;,\x26quot;node\x26quot;:\x26quot;4.8.4\x26quot;}\n  transform-es2015-arrow-functions {\x26quot;android\x26quot;:\x26quot;4.4.3\x26quot;,\x26quot;ie\x26quot;:\x26quot;10\x26quot;,\x26quot;safari\x26quot;:\x26quot;7\x26quot;,\x26quot;node\x26quot;:\x26quot;4.8.4\x26quot;}\n  transform-es2015-block-scoped-functions {\x26quot;android\x26quot;:\x26quot;4.4.3\x26quot;,\x26quot;ie\x26quot;:\x26quot;10\x26quot;,\x26quot;safari\x26quot;:\x26quot;7\x26quot;}\n  transform-es2015-block-scoping {\x26quot;android\x26quot;:\x26quot;4.4.3\x26quot;,\x26quot;ie\x26quot;:\x26quot;10\x26quot;,\x26quot;safari\x26quot;:\x26quot;7\x26quot;,\x26quot;node\x26quot;:\x26quot;4.8.4\x26quot;}\n  ...\nUsing polyfills:\n  es6.typed.array-buffer {\x26quot;android\x26quot;:\x26quot;4.4.3\x26quot;,\x26quot;ie\x26quot;:\x26quot;10\x26quot;,\x26quot;safari\x26quot;:\x26quot;7\x26quot;,\x26quot;node\x26quot;:\x26quot;4.8.4\x26quot;}\n  es6.typed.int8-array {\x26quot;android\x26quot;:\x26quot;4.4.3\x26quot;,\x26quot;ie\x26quot;:\x26quot;10\x26quot;,\x26quot;safari\x26quot;:\x26quot;7\x26quot;,\x26quot;node\x26quot;:\x26quot;4.8.4\x26quot;}\n  es6.typed.uint8-array {\x26quot;android\x26quot;:\x26quot;4.4.3\x26quot;,\x26quot;ie\x26quot;:\x26quot;10\x26quot;,\x26quot;safari\x26quot;:\x26quot;7\x26quot;,\x26quot;node\x26quot;:\x26quot;4.8.4\x26quot;}\n  es6.typed.uint8-clamped-array {\x26quot;android\x26quot;:\x26quot;4.4.3\x26quot;,\x26quot;ie\x26quot;:\x26quot;10\x26quot;,\x26quot;safari\x26quot;:\x26quot;7\x26quot;,\x26quot;node\x26quot;:\x26quot;4.8.4\x26quot;}\n  es6.typed.int16-array {\x26quot;android\x26quot;:\x26quot;4.4.3\x26quot;,\x26quot;ie\x26quot;:\x26quot;10\x26quot;,\x26quot;safari\x26quot;:\x26quot;7\x26quot;,\x26quot;node\x26quot;:\x26quot;4.8.4\x26quot;}\n  ...\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eUsing targets:\n{\n  \x3cspan class=\x22hljs-string\x22\x3e\x22chrome\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2259\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22android\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x224.4.3\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22edge\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2214\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22firefox\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2254\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22ie\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2210\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22ios\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2210\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22safari\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x227\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22node\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x224.8.4\x22\x3c\/span\x3e\n}\n\nModules transform: commonjs\n\nUsing plugins:\n  check-es2015-constants {\x3cspan class=\x22hljs-string\x22\x3e\x22android\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.4.3\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22ie\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x2210\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22safari\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x227\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22node\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.8.4\x22\x3c\/span\x3e}\n  transform-es2015-arrow-functions {\x3cspan class=\x22hljs-string\x22\x3e\x22android\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.4.3\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22ie\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x2210\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22safari\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x227\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22node\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.8.4\x22\x3c\/span\x3e}\n  transform-es2015-block-scoped-functions {\x3cspan class=\x22hljs-string\x22\x3e\x22android\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.4.3\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22ie\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x2210\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22safari\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x227\x22\x3c\/span\x3e}\n  transform-es2015-block-scoping {\x3cspan class=\x22hljs-string\x22\x3e\x22android\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.4.3\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22ie\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x2210\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22safari\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x227\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22node\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.8.4\x22\x3c\/span\x3e}\n  ...\nUsing polyfills:\n  es6.typed.array-buffer {\x3cspan class=\x22hljs-string\x22\x3e\x22android\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.4.3\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22ie\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x2210\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22safari\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x227\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22node\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.8.4\x22\x3c\/span\x3e}\n  es6.typed.int8-array {\x3cspan class=\x22hljs-string\x22\x3e\x22android\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.4.3\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22ie\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x2210\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22safari\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x227\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22node\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.8.4\x22\x3c\/span\x3e}\n  es6.typed.uint8-array {\x3cspan class=\x22hljs-string\x22\x3e\x22android\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.4.3\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22ie\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x2210\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22safari\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x227\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22node\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.8.4\x22\x3c\/span\x3e}\n  es6.typed.uint8-clamped-array {\x3cspan class=\x22hljs-string\x22\x3e\x22android\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.4.3\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22ie\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x2210\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22safari\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x227\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22node\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.8.4\x22\x3c\/span\x3e}\n  es6.typed.int16-array {\x3cspan class=\x22hljs-string\x22\x3e\x22android\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.4.3\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22ie\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x2210\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22safari\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x227\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22node\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x224.8.4\x22\x3c\/span\x3e}\n  ...\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3euseBuiltIns\x3c\/h4\x3e\n\x3cp\x3eenv 会自动根据我们的运行环境，去判断需要什么样的 polyfill，而且，打包后的代码体积也会大大减小，但是这一切都在使用 useBuiltIns，而且需要你安装 babel-polyfill，并 import。它会启用一个插件，替换你的\x3ccode\x3eimport \x27babel-polyfill\x27\x3c\/code\x3e，不是整个引入了，而是根据你配置的环境和个人需要单独的引入 polyfill。 我尝试了一下是否真的有效，下面是我的对比实验过程：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3estep1: \x3c\/strong\x3e   首先是这样一段测试编译的代码，有 jsx，Object.values，async。env 的配置除了 useBuiltIns 都跟上面的配置一样。然后通过 webpack \x2b babel-loader 打包，生成 build.js\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22require(\x27.\/async\x27);\n\/\/ import \x27babel-polyfill\x27;\n\nconst React = require(\x27react\x27);\nconst elements = [1, 2, 3].map((item) =\x3e {\n  return (\n    \x3cdiv\x3e{item}\x3c\/div\x3e\n  )\n});\n\nconsole.log(elements);\n\nasync function a() {\n  console.log(\x27begin\x27);\n  await new Promise((resolve) =\x3e {\n    setTimeout(() =\x3e {\n      resolve();\n    }, 1000)\n  })\n  console.log(\x27done\x27);\n}\na();\n\nconsole.log(Object.values({ 1: 2 }));\n\nconsole.log(Array.isArray([]));\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/async\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ import \x27babel-polyfill\x27;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e React = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e elements = [\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e].map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n    \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e{item}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n  )\n});\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(elements);\n\n\x3cspan class=\x22hljs-keyword\x22\x3easync\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ea\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27begin\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3eawait\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      resolve();\n    }, \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e)\n  })\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27done\x27\x3c\/span\x3e);\n}\na();\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.values({ \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e }));\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e.isArray([]));\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3estep2:\x3c\/strong\x3e  然后通过设置不同的参数，打包，获取 build.js，并执行。得到下表\x3c\/p\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth\x3e \x3c\/th\x3e\n\x3cth\x3e \x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd\x3epreset-env 条件下\x3c\/td\x3e\n\x3ctd\x3euseBuiltIns: true\x3c\/td\x3e\n\x3ctd\x3euseBuiltIns: fase\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e不引入 polyfill\x3c\/td\x3e\n\x3ctd\x3ebuild.js 代码体积 158k，node build.js 执行报错。\x3c\/td\x3e\n\x3ctd\x3ebuild.js 代码体积 158k，node build.js 执行报错。\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e引入 polyfill\x3c\/td\x3e\n\x3ctd\x3ebuild.js 体积 369k，执行通过。包确实减小了。\x3c\/td\x3e\n\x3ctd\x3e因为引入了 polyfill，build.js 代码体积瞬间 420k，执行通过\x3c\/td\x3e\n\x3ctd\x3e \x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3cul\x3e\x3cli\x3e用 preset-es2015，并引入 polyfill\x3cbr\x3eplugins 多加一个 transform-regenerator，这方面确实不如 env 方便一些。\x3cbr\x3e体积 418k，执行通过。不方便在要配好多 plugins。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e具体的过程、截图猛戳 \x3ca href=\x22https:\/\/github.com\/sunyongjian\/babel-usage\/tree\/master\/env\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这里\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e最终的结论就是，使用了 useBuiltIns 确实体积变小了，比直接 \x3ccode\x3eimport \x27babel-polyfill\x27\x3c\/code\x3e  好了许多。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3estep3:\x3c\/strong\x3e 然后...  我又试了一下 env 下，使用 transform-runtime。在不加 useBuiltIns，不引入 babel-polyfill 的情况下。build.js 体积234k，执行通过。\x3c\/p\x3e\n\x3cp\x3e咦，这样好像体积更小啊。别忘了，我们的 babel-polyfill 是配置了执行环境的，通过环境看你需要哪些 polyfill。而 transform-runtime，是发现我们代码需要什么 polyfill，当然会少很多了。所以，又回到了用哪个的问题...  😓 参考上面的总结。\x3c\/p\x3e\n\x3ch4\x3ethen\x3c\/h4\x3e\n\x3cp\x3ehelpers 的问题。开发项目，使用 preset-env，并 \x3ccode\x3eimport \x27babel-polyfill\x27\x3c\/code\x3e，但是 helpers 好像没有地方配置。而且我试了两个文件分别用 async 函数，编译后每个模块都定义了 asyncToGenerat 函数，这种情况下我觉得最后就是自己生成一个 helpers.js 文件了。\x3c\/p\x3e\n\x3ch4\x3e总结\x3c\/h4\x3e\n\x3cp\x3e现在看起来开发大点的项目，最好用的配置应该就是 preset-env，确定自己的运行环境，如果有需要，再加上 useBuiltIns，并生成一份 helpers.js 的文件。不过，一切还是看你的需求，我的前提是开发大点的“项目”，不过了解了这些东西，你会做出自己的选择。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader15\x22\x3ebabel 的配置\x3c\/h2\x3e\n\x3cp\x3e目前 babel 官方推荐是写到 .babelrc 文件下，你还可以在 package.json 里面添加 babel 字段。不用配置文件的话，可以把配置当做参数传给 babel-cli\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e.babelrc\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;presets\x26quot;: [\n    \x26quot;env\x26quot;\n  ],\n  \x26quot;plugins\x26quot;: [\n    [\x26quot;transform-runtime\x26quot;, {\n      \x26quot;helpers\x26quot;: true,\n      \x26quot;polyfill\x26quot;: true,\n      \x26quot;regenerator\x26quot;: true,\n      \x26quot;moduleName\x26quot;: \x26quot;babel-runtime\x26quot;\n    }]\n  ]\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs json\x22\x3e\x3ccode\x3e{\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22presets\x22\x3c\/span\x3e: [\n    \x3cspan class=\x22hljs-string\x22\x3e\x22env\x22\x3c\/span\x3e\n  ],\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22plugins\x22\x3c\/span\x3e: [\n    [\x3cspan class=\x22hljs-string\x22\x3e\x22transform-runtime\x22\x3c\/span\x3e, {\n      \x3cspan class=\x22hljs-attr\x22\x3e\x22helpers\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3e\x22polyfill\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3e\x22regenerator\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3e\x22moduleName\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22babel-runtime\x22\x3c\/span\x3e\n    }]\n  ]\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e写到 package.json\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;babel\x26quot;: {\n  \x26quot;presets\x26quot;: [\n    \x26quot;env\x26quot;\n  ],\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs prolog\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22babel\x22\x3c\/span\x3e: {\n  \x3cspan class=\x22hljs-string\x22\x3e\x22presets\x22\x3c\/span\x3e: [\n    \x3cspan class=\x22hljs-string\x22\x3e\x22env\x22\x3c\/span\x3e\n  ],\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3ebabel cli\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22babel script.js --plugins=transform-runtime --presets=env\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3ebabel script\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e --plugins=\x3cspan class=\x22hljs-attribute\x22\x3etransform\x3c\/span\x3e-runtime --presets=env\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader16\x22\x3e配合其他工具\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader17\x22\x3ewebpack\x3c\/h3\x3e\n\x3cp\x3e比较常用，除了 babel 自己的包，多装一个 \x3ccode\x3ebabel-loader\x3c\/code\x3e 配合 webpack 使用。并在 webpack.config.js 中加入 loader 的配置\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  module: {\n    rules: [\n      {\n        test: \/\\.js$\/,\n        use: [\x27babel-loader\x27],\n        exclude: \/node_modules\/,\n      }\n    ]\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e  \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3erules\x3c\/span\x3e: [\n      {\n        \x3cspan class=\x22hljs-attr\x22\x3etest\x3c\/span\x3e: \x3cspan class=\x22hljs-regexp\x22\x3e\/\\.js$\/\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3euse\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27babel-loader\x27\x3c\/span\x3e],\n        \x3cspan class=\x22hljs-attr\x22\x3eexclude\x3c\/span\x3e: \x3cspan class=\x22hljs-regexp\x22\x3e\/node_modules\/\x3c\/span\x3e,\n      }\n    ]\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader18\x22\x3emocha\x3c\/h3\x3e\n\x3cp\x3e项目里的代码都是用 es6\x2b 写的，但是做单元测试的时候，测试框架并不认识你的什么 esModule，es6\x2b 的一些语法，mocha 是 node 程序，所以你要把 esModule 转化成 commomjs 之类的。\x3c\/p\x3e\n\x3cp\x3emocha 是支持编译器的，通过 \x3ccode\x3e--compilers \x3c\/code\x3e 指定，这里我们用 babel，举个栗子\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 求和函数 add.js\nconst add = (x, y) =\x3e x \x2b y;\n\nexport default add;\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dockerfile\x22\x3e\x3ccode class=\x22javascipt\x22\x3e\/\/ 求和函数 \x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e.\x3cspan class=\x22bash\x22\x3ejs\n\x3c\/span\x3econst \x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e = (x, y) =\x26gt; x \x2b y;\n\x3c\/span\x3e\nexport default \x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e;\n\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 测试脚本 add.test.js\nimport { expect } from \x27chai\x27; \/\/ chai 是断言库\nimport add from \x27.\/add\x27;\n\ndescribe(\x27es6 两数相加\x27, () =\x3e {\n  it(\x272 \x2b 4 = 6\x27, () =\x3e {\n    expect(add(2, 4)).equal(6);\n  })\n});\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 测试脚本 add.test.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { expect } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27chai\x27\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ chai 是断言库\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e add \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/add\x27\x3c\/span\x3e;\n\ndescribe(\x3cspan class=\x22hljs-string\x22\x3e\x27es6 两数相加\x27\x3c\/span\x3e, () =\x26gt; {\n  it(\x3cspan class=\x22hljs-string\x22\x3e\x272 \x2b 4 = 6\x27\x3c\/span\x3e, () =\x26gt; {\n    expect(add(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e)).equal(\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e);\n  })\n});\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22.\/node_modules\/mocha\/bin\/mocha --compilers js:babel-register add.test.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode class=\x22shell\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e.\x3cspan class=\x22hljs-regexp\x22\x3e\/node_modules\/\x3c\/span\x3emocha\x3cspan class=\x22hljs-regexp\x22\x3e\/bin\/\x3c\/span\x3emocha --compilers \x3cspan class=\x22hljs-string\x22\x3ejs:\x3c\/span\x3ebabel-register add.test.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e因为 mocha 终究是在跑 node 程序的，适用于实时编译，所以可以用 babel-register 做编译器。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader19\x22\x3e最后\x3c\/h3\x3e\n\x3cp\x3e总结这些东西花了我两三天的时间，虽然搞清楚了这些包是干嘛的，但是又在想到底应不应该花时间研究这些，工具始终是用来使用的，对于 babel 来说更应该研究的是它对 ast 的处理方式？不过看到自己的产出，我觉得是有必要的，另外，因为对工具更进一步的了解，才能更好的在项目中使用它们，而不是一顿照搬，代码是可以正常用了，但是可能会有很多不需要的东西，导致代码体积变大。“割鸡焉用牛刀”，我觉得还是需要有精益求精的精神。希望对你有所帮助。\x3c\/p\x3e\n\x3cp\x3e我的个人博客地址 \x3ca href=\x22https:\/\/github.com\/sunyongjian\/blog\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/sunyongjia...\x3c\/a\x3e ，欢迎订阅，star，谢谢。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>你真的会用 Babel 吗?</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011155061">https://segmentfault.com/a/1190000011155061</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/0ewz2tbeufg8/" target="_blank">https://alili.tech/archive/0ewz2tbeufg8/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>