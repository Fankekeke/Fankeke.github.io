<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="读懂 SOLID 的「依赖倒置」原则"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>读懂 SOLID 的「依赖倒置」原则 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/1k3ep9brhs2/",
				"appid": "1613049289050283", 
				"title": "读懂 SOLID 的「依赖倒置」原则 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-16T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/3bvk488gkec/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/cko5mexkrm/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f1k3ep9brhs2%2f&text=%e8%af%bb%e6%87%82%20SOLID%20%e7%9a%84%e3%80%8c%e4%be%9d%e8%b5%96%e5%80%92%e7%bd%ae%e3%80%8d%e5%8e%9f%e5%88%99"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f1k3ep9brhs2%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f1k3ep9brhs2%2f&text=%e8%af%bb%e6%87%82%20SOLID%20%e7%9a%84%e3%80%8c%e4%be%9d%e8%b5%96%e5%80%92%e7%bd%ae%e3%80%8d%e5%8e%9f%e5%88%99"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f1k3ep9brhs2%2f&title=%e8%af%bb%e6%87%82%20SOLID%20%e7%9a%84%e3%80%8c%e4%be%9d%e8%b5%96%e5%80%92%e7%bd%ae%e3%80%8d%e5%8e%9f%e5%88%99"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f1k3ep9brhs2%2f&is_video=false&description=%e8%af%bb%e6%87%82%20SOLID%20%e7%9a%84%e3%80%8c%e4%be%9d%e8%b5%96%e5%80%92%e7%bd%ae%e3%80%8d%e5%8e%9f%e5%88%99"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e8%af%bb%e6%87%82%20SOLID%20%e7%9a%84%e3%80%8c%e4%be%9d%e8%b5%96%e5%80%92%e7%bd%ae%e3%80%8d%e5%8e%9f%e5%88%99&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f1k3ep9brhs2%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f1k3ep9brhs2%2f&title=%e8%af%bb%e6%87%82%20SOLID%20%e7%9a%84%e3%80%8c%e4%be%9d%e8%b5%96%e5%80%92%e7%bd%ae%e3%80%8d%e5%8e%9f%e5%88%99"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1k3ep9brhs2%2f&title=%e8%af%bb%e6%87%82%20SOLID%20%e7%9a%84%e3%80%8c%e4%be%9d%e8%b5%96%e5%80%92%e7%bd%ae%e3%80%8d%e5%8e%9f%e5%88%99"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1k3ep9brhs2%2f&title=%e8%af%bb%e6%87%82%20SOLID%20%e7%9a%84%e3%80%8c%e4%be%9d%e8%b5%96%e5%80%92%e7%bd%ae%e3%80%8d%e5%8e%9f%e5%88%99"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1k3ep9brhs2%2f&title=%e8%af%bb%e6%87%82%20SOLID%20%e7%9a%84%e3%80%8c%e4%be%9d%e8%b5%96%e5%80%92%e7%bd%ae%e3%80%8d%e5%8e%9f%e5%88%99"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">读懂 SOLID 的「依赖倒置」原则</h1><div class="meta"><div class="postdate"><time datetime="2018-12-16" itemprop="datePublished">2018-12-16</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e这是理解\x3ccode\x3eSOLID\x3c\/code\x3e原则中，关于\x3cstrong\x3e依赖倒置\x3c\/strong\x3e原则如何帮助我们编写低耦合和可测试代码的第一篇文章。\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e写在前头\x3c\/h2\x3e\n\x3cp\x3e当我们在读书，或者在和一些别的开发者聊天的时候，可能会谈及或者听到术语\x3ccode\x3eSOILD\x3c\/code\x3e。在这些讨论中，一些人会提及它的重要性，以及一个理想中的系统，应当包含它所包含的5条原则的特性。\x3c\/p\x3e\n\x3cp\x3e我们在每次的工作中，你可能没有那么多时间思考关于\x3cstrong\x3e架构\x3c\/strong\x3e这个比较大的概念，或者在有限的时间内或督促下，你也没有办法实践一些好的设计理念。\x3c\/p\x3e\n\x3cp\x3e但是，这些原则存在的意义不是让我们“跳过”它们。软件工程师应当将这些原则应用到他们的开发工作中。所以，在你每一次敲代码的时候，如何能够正确的将这些原则付诸于行，才是真正的问题所在。如果可以那样的话，你的代码会变得更优雅。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eSOLID\x3c\/code\x3e原则是由5个基本的原则构成的。这些概念会帮助创造更好（或者说更健壮）的软件架构。这些原则包含（\x3ccode\x3eSOLID\x3c\/code\x3e是这5个原则的开头字母组成的缩略词）：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eS stands for SRP (Single responsibility principle)：\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000013100807\x22\x3e单一职能原则\x3c\/a\x3e\n\x3c\/li\x3e\n\x3cli\x3eO stands for OCP (Open closed principle)：\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000013123183\x22 target=\x22_blank\x22\x3e开闭原则\x3c\/a\x3e\n\x3c\/li\x3e\n\x3cli\x3eL stands for LSP (Liskov substitution principle)：\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000013208730\x22\x3e里氏替换原则\x3c\/a\x3e\n\x3c\/li\x3e\n\x3cli\x3eI stand for ISP ( Interface segregation principle)：\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000013208721\x22 target=\x22_blank\x22\x3e接口隔离原则\x3c\/a\x3e\n\x3c\/li\x3e\n\x3cli\x3eD stands for DIP ( Dependency inversion principle)：\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000012929864\x22\x3e依赖倒置原则\x3c\/a\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e起初这些原则是\x3ca href=\x22https:\/\/en.wikipedia.org\/wiki\/Robert_Cecil_Martin\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRobert C. Martin\x3c\/a\x3e在1990年提出的，遵循这些原则可以帮助我们更好的构建，低耦合、高内聚的软件架构，同时能够真正的对现实中的业务逻辑进行恰到好处的封装。\x3c\/p\x3e\n\x3cp\x3e不过这些原则并不会使一个差劲的程序员转变为一个优秀的程序员。这些法则取决于你如何应用它们，如果你是很随意的应用它们，那等同于你并没有使用它们一样。\x3c\/p\x3e\n\x3cp\x3e关于原则和模式的知识能够帮助你决定在何时何地正确的使用它们。尽管这些原则仅仅是启示性的，它们是常见问题的常规解决方案。实践中，这些原则的正确性已经被证实了很多次，所以它们应当成为一种常识。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e依赖倒置原则是什么\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e高级模块不应当依赖于低级模块。它们都应当依赖于抽象。\x3c\/li\x3e\n\x3cli\x3e抽象不应当依赖于实现，实现应当依赖于抽象。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e这两句话的意思是什么呢？\x3c\/p\x3e\n\x3cp\x3e一方面，你会抽象一些东西。在软件工程和计算机科学中，抽象是一种关于规划计算机系统中的复杂性的技术。它的工作原理一般是在一个人与系统交互的复杂环境中，隐藏当前级别下的更复杂的实现细节，同时它的范围很广，常常会覆盖多个子系统。这样，当我们在与一个以高级层面作为抽象的系统协作时，我们仅仅需要在意，我们能做什么，而不是我们\x3cstrong\x3e如何\x3c\/strong\x3e做。\x3c\/p\x3e\n\x3cp\x3e另外，你会针对你的抽象，有一写低级别的模块或者具体实现逻辑。这些东西与抽象是相反的。它们是被用于解决某些特定问题所编写的代码。它们的作用域仅仅在某个单元和子系统中。比如，建立一个与MySQL数据库的连接就是一个低级别的实现逻辑，因为它与某个特定的技术领域所绑定。\x3c\/p\x3e\n\x3cp\x3e现在仔细读这两句话，我们能够得到什么暗示呢？\x3c\/p\x3e\n\x3cp\x3e依赖倒置原则存在的真正意义是指，我们需要将一些对象解耦，它们的耦合关系需要达到当一个对象依赖的对象作出改变时，对象本身不需要更改任何代码。\x3c\/p\x3e\n\x3cp\x3e这样的架构可以实现一种松耦合的状态的系统，因为系统中所有的组件，彼此之间都了解很少或者不需要了解系统中其余组件的具体定义和实现细节。它同时实现了一种可测试和可替换的系统架构，因为在松耦合的系统中，任何组件都可以被提供相同服务的组件所替换。\x3c\/p\x3e\n\x3cp\x3e但是相反的，依赖倒置也有一些缺点，就是你需要一个用于处理依赖倒置逻辑的容器，同时，你还需要配置它。容器通常需要具备能够在系统中注入服务，这些服务需要具备正确的作用域和参数，还应当被注入正确的执行上下文中。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e以提供Websocket连接服务为例子\x3c\/h2\x3e\n\x3cp\x3e举个例子，我们可以在这个例子中学到更多关于依赖倒置的知识，我们将使用\x3ccode\x3eInversify.js\x3c\/code\x3e作为依赖倒置的容器，通过这个依赖倒置容器，我们可以看看如何针对提供\x3ccode\x3eWebsocket\x3c\/code\x3e连接服务的业务场景，提供服务。\x3c\/p\x3e\n\x3cp\x3e比如，我们有一个web服务器提供\x3ccode\x3eWebSockets\x3c\/code\x3e连接服务，同时客户端想要连接服务器，同时接受更新的通知。当前我们有若干种解决方案来提供一个WebSocket服务，比如说\x3ccode\x3eSocket.io\x3c\/code\x3e、\x3ccode\x3eSocks\x3c\/code\x3e或者使用浏览器提供的关于原生的\x3ccode\x3eWebSocket\x3c\/code\x3e接口。每一套解决方案，都提供不同的接口和方法供我们调用，那么问题来了，我们是否可以在一个接口中，将所有的解决方案都抽象成一个提供\x3ccode\x3eWebSocket\x3c\/code\x3e连接服务的提供者？这样，我们就可以根据我们的实际需求，使用不同的WebSocket服务提供者。\x3c\/p\x3e\n\x3cp\x3e首先，我们来定义我们的接口：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export interface WebSocketConfiguration {\n  uri: string;\n  options?: Object;\n}\nexport interface SocketFactory {\n  createSocket(configuration: WebSocketConfiguration): any;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3einterface\x3c\/span\x3e WebSocketConfiguration {\n  uri: \x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e;\n  options?: \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e;\n}\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3einterface\x3c\/span\x3e SocketFactory {\n  createSocket(configuration: WebSocketConfiguration): \x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e注意在接口中，我们没有提供任何的实现细节，因此它既是我们所拥有的\x3cstrong\x3e抽象\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e接下来，如果我们想要一个提供\x3ccode\x3eSocket.io\x3c\/code\x3e服务工厂：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import {Manager} from \x27socket.io-client\x27;\n\nclass SocketIOFactory implements SocketFactory {\n  createSocket(configuration: WebSocketConfiguration): any {\n    return new Manager(configuration.uri, configuration.opts);\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {Manager} from \x3cspan class=\x22hljs-string\x22\x3e\x27socket.io-client\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eSocketIOFactory\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eimplements\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eSocketFactory\x3c\/span\x3e {\x3c\/span\x3e\n  createSocket(\x3cspan class=\x22hljs-string\x22\x3econfiguration:\x3c\/span\x3e WebSocketConfiguration): any {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Manager(configuration.uri, configuration.opts);\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里已经包含了一些具体的实现细节，因此它不再是抽象，因为它声明了一个从\x3ccode\x3eSocket.io\x3c\/code\x3e库中导入的\x3ccode\x3eManager\x3c\/code\x3e对象，它是我们的具体实现细节。\x3c\/p\x3e\n\x3cp\x3e我们可以通过实现\x3ccode\x3eSocketFactory\x3c\/code\x3e接口，来增加若干工厂类，只要我们实现这个接口即可。\x3c\/p\x3e\n\x3cp\x3e我们在提供一个关于客户端连接实例的抽象：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export interface SocketClient {\n  connect(configuration: WebSocketConfiguration): Promise\x3cany\x3e;\n  close(): Promise\x3cany\x3e;\n  emit(event: string, ...args: any[]): Promise\x3cany\x3e;\n  on(event: string, fn: Function): Promise\x3cany\x3e;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3einterface\x3c\/span\x3e SocketClient {\n  connect(configuration: WebSocketConfiguration): \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e\x26gt;;\n  close(): \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e\x26gt;;\n  emit(event: \x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e, ...args: \x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e[]): \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e\x26gt;;\n  on(event: \x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e, fn: \x3cspan class=\x22hljs-built_in\x22\x3eFunction\x3c\/span\x3e): \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e\x26gt;;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后再提供一些实现细节：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22class WebSocketClient implements SocketClient {\n  private socketFactory: SocketFactory;\n  private socket: any;\n  public constructor(webSocketFactory: SocketFactory) {\n    this.socketFactory = webSocketFactory;\n  }\n  public connect(config: WebSocketConfiguration): Promise\x3cany\x3e {\n    if (!this.socket) {\n      this.socket = this.socketFactory.createSocket(config);\n    }\n    return new Promise\x3cany\x3e((resolve, reject) =\x3e {\n      this.socket.on(\x27connect\x27, () =\x3e resolve());\n      this.socket.on(\x27connect_error\x27, (error: Error) =\x3e reject(error));\n    });\n  }\n  public emit(event: string, ...args: any[]): Promise\x3cany\x3e {\n    return new Promise\x3cstring | Object\x3e((resolve, reject) =\x3e {\n      if (!this.socket) {\n        return reject(\x27No socket connection.\x27);\n      }\n      return this.socket.emit(event, args, (response: any) =\x3e {\n        if (response.error) {\n          return reject(response.error);\n        }\n        return resolve();\n      });\n    });\n  }\n  public on(event: string, fn: Function): Promise\x3cany\x3e {\n    return new Promise\x3cany\x3e((resolve, reject) =\x3e {\n      if (!this.socket) {\n        return reject(\x27No socket connection.\x27);\n      }\n      this.socket.on(event, fn);\n      resolve();\n    });\n  }\n  public close(): Promise\x3cany\x3e {\n    return new Promise\x3cany\x3e((resolve) =\x3e {\n      this.socket.close(() =\x3e {\n        this.socket = null;\n        resolve();\n      });\n    });\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e WebSocketClient \x3cspan class=\x22hljs-keyword\x22\x3eimplements\x3c\/span\x3e SocketClient {\n  \x3cspan class=\x22hljs-keyword\x22\x3eprivate\x3c\/span\x3e socketFactory: SocketFactory;\n  \x3cspan class=\x22hljs-keyword\x22\x3eprivate\x3c\/span\x3e socket: \x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ewebSocketFactory: SocketFactory\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.socketFactory = webSocketFactory;\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e connect(config: WebSocketConfiguration): \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e\x26gt; {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.socket) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.socket = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.socketFactory.createSocket(config);\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e\x26gt;\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) =\x26gt; {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.socket.on(\x3cspan class=\x22hljs-params\x22\x3e\x27connect\x27, (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) =\x26gt; resolve(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.socket.on(\x3cspan class=\x22hljs-params\x22\x3e\x27connect_error\x27, (\x3cspan class=\x22hljs-params\x22\x3eerror: \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e\x3c\/span\x3e) =\x26gt; reject(\x3cspan class=\x22hljs-params\x22\x3eerror\x3c\/span\x3e)\x3c\/span\x3e);\n    }\x3c\/span\x3e);\n  }\n  \x3cspan class=\x22hljs-params\x22\x3epublic\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3eemit\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent: \x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e, ...args: \x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e[]\x3c\/span\x3e): \x3cspan class=\x22hljs-params\x22\x3ePromise\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-params\x22\x3eany\x3c\/span\x3e\x26gt; {\n    \x3cspan class=\x22hljs-params\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3ePromise\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-params\x22\x3estring\x3c\/span\x3e | \x3cspan class=\x22hljs-params\x22\x3eObject\x3c\/span\x3e\x26gt;(\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) =\x26gt; {\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e!\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.socket\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e reject(\x3cspan class=\x22hljs-params\x22\x3e\x27No socket connection.\x27\x3c\/span\x3e);\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.socket.emit(\x3cspan class=\x22hljs-params\x22\x3eevent, args, (\x3cspan class=\x22hljs-params\x22\x3eresponse: \x3cspan class=\x22hljs-built_in\x22\x3eany\x3c\/span\x3e\x3c\/span\x3e) =\x26gt; {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eresponse.error\x3c\/span\x3e) {\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e reject(\x3cspan class=\x22hljs-params\x22\x3eresponse.error\x3c\/span\x3e);\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e resolve(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e);\n      }\x3c\/span\x3e);\n    }\x3c\/span\x3e);\n  }\n  \x3cspan class=\x22hljs-params\x22\x3epublic\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3eon\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent: \x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e, fn: \x3cspan class=\x22hljs-built_in\x22\x3eFunction\x3c\/span\x3e\x3c\/span\x3e): \x3cspan class=\x22hljs-params\x22\x3ePromise\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-params\x22\x3eany\x3c\/span\x3e\x26gt; {\n    \x3cspan class=\x22hljs-params\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3ePromise\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-params\x22\x3eany\x3c\/span\x3e\x26gt;(\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) =\x26gt; {\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e!\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.socket\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e reject(\x3cspan class=\x22hljs-params\x22\x3e\x27No socket connection.\x27\x3c\/span\x3e);\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.socket.on(\x3cspan class=\x22hljs-params\x22\x3eevent, fn\x3c\/span\x3e);\n      resolve(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e);\n    }\x3c\/span\x3e);\n  }\n  \x3cspan class=\x22hljs-params\x22\x3epublic\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3eclose\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e: \x3cspan class=\x22hljs-params\x22\x3ePromise\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-params\x22\x3eany\x3c\/span\x3e\x26gt; {\n    \x3cspan class=\x22hljs-params\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3ePromise\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-params\x22\x3eany\x3c\/span\x3e\x26gt;(\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve\x3c\/span\x3e) =\x26gt; {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.socket.close(\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) =\x26gt; {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.socket = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n        resolve(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e);\n      }\x3c\/span\x3e);\n    }\x3c\/span\x3e);\n  }\n}\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e值得注意的是，这里我们在构造函数中，传入了一个类型是\x3ccode\x3eSocketFactory\x3c\/code\x3e的参数，这是为了满足关于依赖倒置原则的第一条规则。对于第二条规则，我们需要一种方式来提供这个不需要了解内部实现细节的、可替换的、易于配置的参数。\x3c\/p\x3e\n\x3cp\x3e这也是为什么我们要使用\x3ccode\x3eInversify\x3c\/code\x3e这个库的原因，我们来加入一些额外的代码和注解（装饰器）：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import {injectable} from \x27inversify\x27;\nconst webSocketFactoryType: symbol = Symbol(\x27WebSocketFactory\x27);\nconst webSocketClientType: symbol = Symbol(\x27WebSocketClient\x27);\nlet TYPES: any = {\n    WebSocketFactory: webSocketFactoryType,\n    WebSocketClient: webSocketClientType\n};\n\n@injectable()\nclass SocketIOFactory implements SocketFactory {...}\n...\n@injectable()\nclass WebSocketClient implements SocketClient {\npublic constructor(@inject(TYPES.WebSocketFactory) webSocketFactory: SocketFactory) {\n  this.socketFactory = webSocketFactory;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {injectable} from \x3cspan class=\x22hljs-string\x22\x3e\x27inversify\x27\x3c\/span\x3e;\nconst \x3cspan class=\x22hljs-string\x22\x3ewebSocketFactoryType:\x3c\/span\x3e symbol = Symbol(\x3cspan class=\x22hljs-string\x22\x3e\x27WebSocketFactory\x27\x3c\/span\x3e);\nconst \x3cspan class=\x22hljs-string\x22\x3ewebSocketClientType:\x3c\/span\x3e symbol = Symbol(\x3cspan class=\x22hljs-string\x22\x3e\x27WebSocketClient\x27\x3c\/span\x3e);\nlet \x3cspan class=\x22hljs-string\x22\x3eTYPES:\x3c\/span\x3e any = {\n\x3cspan class=\x22hljs-symbol\x22\x3e    WebSocketFactory:\x3c\/span\x3e webSocketFactoryType,\n\x3cspan class=\x22hljs-symbol\x22\x3e    WebSocketClient:\x3c\/span\x3e webSocketClientType\n};\n\n\x3cspan class=\x22hljs-meta\x22\x3e@injectable\x3c\/span\x3e()\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eSocketIOFactory\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eimplements\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eSocketFactory\x3c\/span\x3e {\x3c\/span\x3e...}\n...\n\x3cspan class=\x22hljs-meta\x22\x3e@injectable\x3c\/span\x3e()\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eWebSocketClient\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eimplements\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eSocketClient\x3c\/span\x3e {\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e constructor(\x3cspan class=\x22hljs-meta\x22\x3e@inject\x3c\/span\x3e(TYPES.WebSocketFactory) \x3cspan class=\x22hljs-string\x22\x3ewebSocketFactory:\x3c\/span\x3e SocketFactory) {\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.socketFactory = webSocketFactory;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这些注释（装饰器）仅仅会在代码运行时，在如何提供这些组件实例时，提供一些元数据，接下来我们仅仅需要创建一个依赖倒置容器，并将所有的对象按正确的类型绑定起来，如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import {Container} from \x27inversify\x27;\nimport \x27reflect-metadata\x27;\nimport {TYPES, SocketClient, SocketFactory, SocketIOFactory, WebSocketClient} from \x27@web\/app\x27;\nconst provider = new Container({defaultScope: \x27Singleton\x27});\n\/\/ Bindings\nprovider.bind\x3cSocketClient\x3e(TYPES.WebSocketClient).to(WebSocketClient);\nprovider.bind\x3cSocketFactory\x3e(TYPES.WebSocketFactory).to(SocketIOFactory);\nexport default provider;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {Container} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27inversify\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27reflect-metadata\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {TYPES, SocketClient, SocketFactory, SocketIOFactory, WebSocketClient} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27@web\/app\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e provider = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Container({\x3cspan class=\x22hljs-attr\x22\x3edefaultScope\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Singleton\x27\x3c\/span\x3e});\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Bindings\x3c\/span\x3e\nprovider.bind\x26lt;SocketClient\x26gt;(TYPES.WebSocketClient).to(WebSocketClient);\nprovider.bind\x26lt;SocketFactory\x26gt;(TYPES.WebSocketFactory).to(SocketIOFactory);\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e provider;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e让我们来看看我们如何使用我们提供连接服务的客户端实例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var socketClient = provider.get\x3cSocketClient\x3e(TYPES.WebSocketClient);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cs\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e socketClient = provider.\x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e\x26lt;SocketClient\x26gt;(TYPES.WebSocketClient);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当然，使用\x3ccode\x3eInversify\x3c\/code\x3e可以提供一些更简单易用的绑定，可以通过浏览它的网站来了解。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e译者注\x3c\/h2\x3e\n\x3cp\x3e一般说到依赖倒置原则，往往第一个想到的术语即是\x3ccode\x3e依赖注入\x3c\/code\x3e，这种在各个技术栈都有应用，之后又会马上想到\x3ccode\x3espring\x3c\/code\x3e、\x3ccode\x3eng\x3c\/code\x3e等前后端框架。\x3c\/p\x3e\n\x3cp\x3e我们确实是通过使用这些框架熟知这个概念的，但是如果你仔细想想的话，是否还有其他的一些场景也使用了类似的概念呢？\x3c\/p\x3e\n\x3cp\x3e比如：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e一些使用插件和中间件的框架，如\x3ccode\x3eexpress\x3c\/code\x3e、\x3ccode\x3eredux\x3c\/code\x3e\n\x3c\/li\x3e\n\x3cli\x3ejs中this的动态绑定\x3c\/li\x3e\n\x3cli\x3ejs中的回调函数\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e也许有的人会不同意我的观点，会说依赖注入一般都是面向类和接口来讲的，这确实有一定的道理，但是我认为没有必要局限在一种固定的模式中去理解依赖倒置，毕竟它是一种思想，一种模式，在js中，所有的东西都是动态的，函数是一等公民，是对象，那么把这些与依赖倒置原则联系起来，完全也讲的通。我们真正关心的是核心问题是如何\x3cstrong\x3e解耦\x3c\/strong\x3e，把更多的注意力投入的真正的业务逻辑中去。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>读懂 SOLID 的「依赖倒置」原则</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000012929864">https://segmentfault.com/a/1190000012929864</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/1k3ep9brhs2/" target="_blank">https://alili.tech/archive/1k3ep9brhs2/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>