<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="JavaScript执行顺序分析"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>JavaScript执行顺序分析 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/1lsilnwzcxm/",
				"appid": "1613049289050283", 
				"title": "JavaScript执行顺序分析 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-24T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/81nyove1ci7/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/081j1hr3178e/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f1lsilnwzcxm%2f&text=JavaScript%e6%89%a7%e8%a1%8c%e9%a1%ba%e5%ba%8f%e5%88%86%e6%9e%90"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f1lsilnwzcxm%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f1lsilnwzcxm%2f&text=JavaScript%e6%89%a7%e8%a1%8c%e9%a1%ba%e5%ba%8f%e5%88%86%e6%9e%90"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f1lsilnwzcxm%2f&title=JavaScript%e6%89%a7%e8%a1%8c%e9%a1%ba%e5%ba%8f%e5%88%86%e6%9e%90"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f1lsilnwzcxm%2f&is_video=false&description=JavaScript%e6%89%a7%e8%a1%8c%e9%a1%ba%e5%ba%8f%e5%88%86%e6%9e%90"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=JavaScript%e6%89%a7%e8%a1%8c%e9%a1%ba%e5%ba%8f%e5%88%86%e6%9e%90&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f1lsilnwzcxm%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f1lsilnwzcxm%2f&title=JavaScript%e6%89%a7%e8%a1%8c%e9%a1%ba%e5%ba%8f%e5%88%86%e6%9e%90"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1lsilnwzcxm%2f&title=JavaScript%e6%89%a7%e8%a1%8c%e9%a1%ba%e5%ba%8f%e5%88%86%e6%9e%90"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1lsilnwzcxm%2f&title=JavaScript%e6%89%a7%e8%a1%8c%e9%a1%ba%e5%ba%8f%e5%88%86%e6%9e%90"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1lsilnwzcxm%2f&title=JavaScript%e6%89%a7%e8%a1%8c%e9%a1%ba%e5%ba%8f%e5%88%86%e6%9e%90"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">JavaScript执行顺序分析</h1><div class="meta"><div class="postdate"><time datetime="2018-12-24" itemprop="datePublished">2018-12-24</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e前言\x3c\/h1\x3e\n\x3cp\x3e上星期面试被问到了事件执行顺序的问题，想起来之前看\x3ccode\x3e《深入浅出Node.js》\x3c\/code\x3e时看到这一章就忽略了，这次来分析一下JavaScript的事件执行顺序。废话少说，正题开始。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3e单线程JavaScript\x3c\/h1\x3e\n\x3cp\x3e首先我们要知道\x3ccode\x3eJavaScript\x3c\/code\x3e是一门\x3cstrong\x3e单线程解释型\x3c\/strong\x3e语言。这就意味着在同一个时间下，我们只能执行一条命令。之所以它是一门单线程语言，和它的用途有关。\x3cbr\x3eJavaScript设计出来的初衷是为了增强浏览器与用户的交互，尤其是表单的交互，而之后的Ajax技术也是为了使表单的交互更加人性化而发明出来的。因为JavaScript是一门解释型的语言，而解释器内嵌于浏览器，这个解释器是单线程的。\x3cbr\x3e之所以不设计成多线程是因为渲染网页的时候多线程容易引起死锁或者资源冲突等问题。但是浏览器本身是多线程的，比如解释运行JavaScript的同时还在加载网络资源。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/stackoverflow.com\/questions\/39879\/why-doesnt-javascript-support-multithreading\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eWhy doesn\x27t JavaScript support multithreading?\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x26lt;!-- more --\x26gt;\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3e事件循环\x3c\/h1\x3e\n\x3cp\x3e单线程就意味着如果你要运行很多命令，那么这些命令需要排序，一般情况下，这些命令是从上到下排序执行（因为解释器是从文件顶部开始）。比如以下代码是按照顺序执行的。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22console.log(\x26quot;1\x26quot;);\nconsole.log(\x26quot;2\x26quot;);\nconsole.log(\x26quot;3\x26quot;);\n\/\/1\n\/\/2\n\/\/3\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cpp\x22\x3e\x3ccode\x3econsole.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x221\x22\x3c\/span\x3e);\nconsole.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x222\x22\x3c\/span\x3e);\nconsole.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x223\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/1\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/2\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/3\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3chr\x3e\n\x3cp\x3e但是我们还有知道在JavaScript里有异步编程的说法，比如Ajax，setTimeout，setInterval或者ES6中的Promise，async，await。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e\x3cstrong\x3e那么什么是同步和异步呢？\x3c\/strong\x3e\x3c\/h3\x3e\n\x3cp\x3e一条命令的执行在计算机里的意思就是它此时在使用CPU等资源，那么因为想要获得CPU资源的命令有很多，而CPU执行命令也需要时间去运算获得结果，于是就有了同步异步的概念。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e同步就是在发出一个CPU请求时，在没有得到结果之前，该CPU请求就不返回。但是一旦调用返回，就得到返回值了。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e异步表示CPU请求在发出之后，这个调用就直接返回了，所以没有返回结果。在运行结束后，需要通过一系列手段来获得返回值\x3c\/strong\x3e\x3c\/p\x3e\n\x3chr\x3e\n\x3cp\x3e这时候就要引入进程和线程的概念。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e进程与线程\x3c\/h3\x3e\n\x3ch4\x3e进程\x3c\/h4\x3e\n\x3cp\x3e概念：\x3cstrong\x3e进程是一个具有一定独立功能的程序在一个数据集上的一次动态执行的过程，是操作系统进行资源分配和调度的一个独立单位，是应用程序运行的载体。\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch4\x3e线程\x3c\/h4\x3e\n\x3cp\x3e由于进程对于CPU的使用是轮流的，那么就存在进程的切换，但是由于现在的程序都比较大，切换的开销很大会浪费CPU的资源，于是就发明了线程，把一个大的进程分解成多个线程共同执行。\x3c\/p\x3e\n\x3ch4\x3e区别\x3c\/h4\x3e\n\x3cul\x3e\n\x3cli\x3e进程是操作系统分配资源的最小单位，线程是程序执行的最小单位。\x3c\/li\x3e\n\x3cli\x3e一个进程由一个或多个线程组成，线程是一个进程中代码的不同执行路线；\x3c\/li\x3e\n\x3cli\x3e进程之间相互独立，但同一进程下的各个线程之间共享程序的内存空间(包括代码段、数据集、堆等)及一些进程级的资源(如打开文件和信号)。\x3c\/li\x3e\n\x3cli\x3e调度和切换：线程上下文切换比进程上下文切换要快得多。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch4\x3e举个例子\x3c\/h4\x3e\n\x3cp\x3e假如我是鸣人，我想吃很多拉面，如果我一个人吃10碗的话，那我就是一个进程一个线程完成吃拉面这件事情。\x3cbr\x3e但是如果我用9个分身和我一起吃10碗拉面，那我就是一个进程用9个线程去完成吃拉面这件事情。\x3cbr\x3e而多进程这表示名人在一乐拉面里面吃拉面的同时，好色仙人在偷看妹子洗澡~ ~。好色仙人是单进程单线程去偷看的哦！\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e浏览器的线程\x3c\/h3\x3e\n\x3cp\x3e浏览器的内核是多线程的，在内核控制下各线程相互配合以保持同步，一个浏览器通常由一下线程组成：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eGUI 渲染线程\x3c\/li\x3e\n\x3cli\x3eJavaScript引擎线程\x3c\/li\x3e\n\x3cli\x3e事件触发线程\x3c\/li\x3e\n\x3cli\x3e异步http请求线程\x3c\/li\x3e\n\x3cli\x3eEventLoop轮询的处理线程\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e这些线程的作用：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eUI线程用于渲染页面\x3c\/li\x3e\n\x3cli\x3ejs线程用于执行js任务\x3c\/li\x3e\n\x3cli\x3e浏览器事件触发线程用于控制交互，响应用户\x3c\/li\x3e\n\x3cli\x3ehttp线程用于处理请求，ajax是委托给浏览器新开一个http线程\x3c\/li\x3e\n\x3cli\x3eEventLoop处理线程用于轮询消息队列\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012220314?w=674\x26amp;h=368\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012220314?w=674\x26amp;h=368\x22 alt=\x22图片\x22 title=\x22图片\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3eJavaScript事件循环和消息队列（浏览器环境）\x3c\/h3\x3e\n\x3cp\x3e因为JavaScript是单线程的，而浏览器是多线程的，所以为了执行不同的同步异步的代码，JavaScript运行的环境采用里事件循环和消息队列来达到目的。\x3cbr\x3e\x3cstrong\x3e每个线程的任务执行顺序都是FIFO(先进先出)\x3c\/strong\x3e\x3cbr\x3e在JavaScript运行的环境中，有一个负责程序本身的运行，作为主线程；另一个负责主线程与其他线程的通信，被称为\x3ccode\x3eEvent Loop 线程\x3c\/code\x3e。\x3cbr\x3e每当主线程遇到异步的任务，把他们移入到\x3ccode\x3eEvent Loop 线程\x3c\/code\x3e，然后主线程继续运行，等到主线程完全运行完之后，再去\x3ccode\x3eEvent Loop 线程\x3c\/code\x3e拿结果。\x3cbr\x3e而每个异步任务都包含着与它相关联的信息，比如运行状态，回调函数等。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006763057?w=581\x26amp;h=420\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006763057?w=581\x26amp;h=420\x22 alt=\x22事件循环\x22 title=\x22事件循环\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e由此我们可以知道，同步任务和异步任务会被分发到不同的线程去执行。\x3cbr\x3e现在我们就可以分析一下一下代码的运行结果了。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22setTimeout(()=\x3e{console.log(\x26quot;我才是第一\x26quot;);},0);\nconsole.log(\x26quot;我是第一\x26quot;);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3esetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22我才是第一\x22\x3c\/span\x3e);},\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22我是第一\x22\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3col\x3e\n\x3cli\x3e因为setTimeout是异步的事件，所以主线程把它调入Event Loop线程进行注册。\x3c\/li\x3e\n\x3cli\x3e主线程继续执行\x3ccode\x3econsole.log(\x22我是第一\x22);\x3c\/code\x3e\n\x3c\/li\x3e\n\x3cli\x3e主线程执行完毕，从Event Loop 线程读取回调函数。再执行\x3ccode\x3econsole.log(\x22我才是第一\x22);\x3c\/code\x3e;\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3esetTimeout 和 setInterval\x3c\/h3\x3e\n\x3ch4\x3esetTimeout\x3c\/h4\x3e\n\x3cp\x3e这里值得一提的是，\x3ccode\x3esetTimeout(callback,0)\x3c\/code\x3e指的是主线程中的同步任务运行完了之后立刻由Event Loop 线程调入主线程。\x3cbr\x3e而计时是在调入Event Loop线程注册时开始的，此时\x3ccode\x3esetTimeout的回调函数执行时间\x3c\/code\x3e与主线程运行结束的时间相关。\x3cbr\x3e关于setTimeout要补充的是，即便主线程为空，0毫秒实际上也是达不到的。根据HTML的标准，最低是4毫秒。\x3c\/p\x3e\n\x3ch4\x3esetInterval\x3c\/h4\x3e\n\x3cp\x3e需要注意的是，此函数是每隔一段时间将回调函数放入Event Loop线程。\x3cbr\x3e\x3cstrong\x3e一旦setInterval的回调函数fn执行时间超过了延迟时间ms，那么就完全看不出来有时间间隔了\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch4\x3e\n\x3ccode\x3emicro-task（微任务）\x3c\/code\x3e 与 \x3ccode\x3emacro-task（宏任务）\x3c\/code\x3e\n\x3c\/h4\x3e\n\x3cp\x3e\x3ccode\x3eEvent Loop线程\x3c\/code\x3e中包含任务队列（用来对不同优先级的异步事件进行排序），而任务队列又分为\x3ccode\x3emacro-task（宏任务）\x3c\/code\x3e与\x3ccode\x3emicro-task（微任务）\x3c\/code\x3e，在最新标准中，它们被分别称为\x3ccode\x3etask\x3c\/code\x3e与\x3ccode\x3ejobs\x3c\/code\x3e。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3emacro-task大概包括：script(整体代码), setTimeout, setInterval, setImmediate, I\/O, UI rendering。\x3c\/li\x3e\n\x3cli\x3emicro-task大概包括: process.nextTick, Promise, Object.observe(已废弃), MutationObserver(html5新特性)\x3c\/li\x3e\n\x3cli\x3esetTimeout\/Promise等我们称之为\x3ccode\x3e任务源\x3c\/code\x3e。而进入任务队列的是他们指定的具体执行任务（回调函数）。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e来自不同的任务源的任务会进入到不同的任务队列中，而不同的任务队列执行过程如下：\x3cbr\x3e执行过程如下：\x3cbr\x3eJavaScript引擎首先从\x3ccode\x3emacro-task\x3c\/code\x3e中取出第一个任务，\x3cbr\x3e执行完毕后，将\x3ccode\x3emicro-task\x3c\/code\x3e中的所有任务取出，按顺序全部执行；\x3cbr\x3e然后再从\x3ccode\x3emacro-task\x3c\/code\x3e中取下一个，\x3cbr\x3e执行完毕后，再次将\x3ccode\x3emicro-task\x3c\/code\x3e中的全部取出；\x3cbr\x3e循环往复，直到两个队列中的任务都取完。\x3c\/p\x3e\n\x3ch4\x3e举个大例子\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22console.log(\x26quot;start\x26quot;);\nvar promise = new Promise((resolve) =\x3e {\n    console.log(\x26quot;promise start..\x26quot;);\n    resolve(\x26quot;promise\x26quot;);\n}); \/\/3\npromise.then((val) =\x3e console.log(val));\nsetTimeout(()=\x3e{console.log(\x26quot;setTime1\x26quot;)},0);\nconsole.log(\x26quot;test end...\x26quot;)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22start\x22\x3c\/span\x3e);\nvar promise = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22promise start..\x22\x3c\/span\x3e);\n    resolve(\x3cspan class=\x22hljs-string\x22\x3e\x22promise\x22\x3c\/span\x3e);\n}); \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\npromise.\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(val)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(val));\nsetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22setTime1\x22\x3c\/span\x3e)},\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22test end...\x22\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里我们按顺序来分析。\x3c\/p\x3e\n\x3ch5\x3e第一轮\x3c\/h5\x3e\n\x3col\x3e\n\x3cli\x3e整体script代码作为一个宏任务进入主线程，运行\x3ccode\x3econsole.log(\x22start\x22);\x3c\/code\x3e。\x3c\/li\x3e\n\x3cli\x3e然后遇到\x3ccode\x3ePromises\x3c\/code\x3e直接运行\x3ccode\x3econsole.log(\x22promise start..\x22)\x3c\/code\x3e。\x3c\/li\x3e\n\x3cli\x3e然后遇到\x3ccode\x3epromise.then\x3c\/code\x3e，存入到\x3ccode\x3emicro-task队列\x3c\/code\x3e中。\x3c\/li\x3e\n\x3cli\x3e然后遇到\x3ccode\x3esetTimeout\x3c\/code\x3e,存入到\x3ccode\x3emacro-task队列\x3c\/code\x3e中。\x3c\/li\x3e\n\x3cli\x3e于然后运行\x3ccode\x3econsole.log(\x22test end...\x22)\x3c\/code\x3e;\x3c\/li\x3e\n\x3cli\x3e在这一轮中，宏任务运行结束，运行micro-task队列中的 \x3ccode\x3epromise.then\x3c\/code\x3e，输出\x3ccode\x3epromise\x3c\/code\x3e\n\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch5\x3e第二轮\x3c\/h5\x3e\n\x3col\x3e\x3cli\x3e取出\x3ccode\x3emacro-task队列\x3c\/code\x3e中的\x3ccode\x3esetTimeout\x3c\/code\x3e，运行\x3ccode\x3econsole.log(\x22setTime1\x22);\x3c\/code\x3e\n\x3c\/li\x3e\x3c\/ol\x3e\n\x3ch5\x3e结果\x3c\/h5\x3e\n\x3cp\x3e输出的顺序就是\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ start\n\/\/ promise start\n\/\/ test end...\n\/\/ promise\n\/\/setTime1\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs 1c\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ start\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ promise start\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ test end...\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ promise\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/setTime1\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e留一个案例你们去分析\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22async function testSometing() {\n    console.log(\x26quot;执行testSometing\x26quot;);\n    return \x26quot;testSometing\x26quot;;\n}\n\nasync function testAsync() {\n    console.log(\x26quot;执行testAsync\x26quot;);\n    return Promise.resolve(\x26quot;hello async\x26quot;);\n}\n\nasync function test() {\n    console.log(\x26quot;test start...\x26quot;);\n    const v1 = await testSometing();\n    console.log(v1);\n    const v2 = await testAsync();\n    console.log(v2);\n    console.log(v1, v2);\n}\n\ntest();\n\nvar promise = new Promise((resolve) =\x3e {\n    console.log(\x26quot;promise start..\x26quot;);\n    resolve(\x26quot;promise\x26quot;);\n}); \/\/3\npromise.then((val) =\x3e console.log(val));\nsetTimeout(()=\x3e{console.log(\x26quot;setTime1\x26quot;)},3000);\nconsole.log(\x26quot;test end...\x26quot;)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3easync\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etestSometing\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22执行testSometing\x22\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22testSometing\x22\x3c\/span\x3e;\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3easync\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etestAsync\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22执行testAsync\x22\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-string\x22\x3e\x22hello async\x22\x3c\/span\x3e);\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3easync\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etest\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22test start...\x22\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e v1 = \x3cspan class=\x22hljs-keyword\x22\x3eawait\x3c\/span\x3e testSometing();\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(v1);\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e v2 = \x3cspan class=\x22hljs-keyword\x22\x3eawait\x3c\/span\x3e testAsync();\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(v2);\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(v1, v2);\n}\n\ntest();\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e promise = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22promise start..\x22\x3c\/span\x3e);\n    resolve(\x3cspan class=\x22hljs-string\x22\x3e\x22promise\x22\x3c\/span\x3e);\n}); \x3cspan class=\x22hljs-comment\x22\x3e\/\/3\x3c\/span\x3e\npromise.then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eval\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(val));\nsetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22setTime1\x22\x3c\/span\x3e)},\x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e);\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22test end...\x22\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader8\x22\x3e感谢以下文章\x3c\/h1\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.jianshu.com\/p\/12b9f73c5a4f#\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e前端基础进阶（十二）：深入核心，详解事件循环机制\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e[[JavaScript] Macrotask Queue和Microtask Queue](\x3ca href=\x22http:\/\/www.jianshu.com\/p\/3ed992529cfc)\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.jianshu.com\/p\/3ed9...\x3c\/a\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/blog.csdn.net\/newfishcoder\/article\/details\/70843741\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJavaScript运行机制（堆、栈、消息队列）\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2014\/10\/event-loop.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJavaScript 运行机制详解：再谈Event Loop\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/juejin.im\/post\/59e85eebf265da430d571f89\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这一次，彻底弄懂 JavaScript 执行机制\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>JavaScript执行顺序分析</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000012220307">https://segmentfault.com/a/1190000012220307</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/1lsilnwzcxm/" target="_blank">https://alili.tech/archive/1lsilnwzcxm/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>