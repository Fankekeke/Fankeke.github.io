<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="http-proxy-middleware 服务代理"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>http-proxy-middleware 服务代理 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/1wbx8th422f/",
				"appid": "1613049289050283", 
				"title": "http-proxy-middleware 服务代理 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-27T02:30:12"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/k3g6t2s7lu/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/mwbvbt5eilm/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f1wbx8th422f%2f&text=http-proxy-middleware%20%e6%9c%8d%e5%8a%a1%e4%bb%a3%e7%90%86"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f1wbx8th422f%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f1wbx8th422f%2f&text=http-proxy-middleware%20%e6%9c%8d%e5%8a%a1%e4%bb%a3%e7%90%86"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f1wbx8th422f%2f&title=http-proxy-middleware%20%e6%9c%8d%e5%8a%a1%e4%bb%a3%e7%90%86"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f1wbx8th422f%2f&is_video=false&description=http-proxy-middleware%20%e6%9c%8d%e5%8a%a1%e4%bb%a3%e7%90%86"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=http-proxy-middleware%20%e6%9c%8d%e5%8a%a1%e4%bb%a3%e7%90%86&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f1wbx8th422f%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f1wbx8th422f%2f&title=http-proxy-middleware%20%e6%9c%8d%e5%8a%a1%e4%bb%a3%e7%90%86"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1wbx8th422f%2f&title=http-proxy-middleware%20%e6%9c%8d%e5%8a%a1%e4%bb%a3%e7%90%86"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1wbx8th422f%2f&title=http-proxy-middleware%20%e6%9c%8d%e5%8a%a1%e4%bb%a3%e7%90%86"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f1wbx8th422f%2f&title=http-proxy-middleware%20%e6%9c%8d%e5%8a%a1%e4%bb%a3%e7%90%86"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">http-proxy-middleware 服务代理</h1><div class="meta"><div class="postdate"><time datetime="2018-12-27" itemprop="datePublished">2018-12-27</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch3 id=\x22articleHeader0\x22\x3e该文章以收录 \x3ca href=\x22http:\/\/webxiaoma.com\/blogs\/2017\/09\/14\/webpack-log\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e《webpack、npm探索之路》\x3c\/a\x3e\n\x3c\/h3\x3e\n\x3cp\x3e本文为 http-proxy-middleware 官网译文 \x3c\/p\x3e\n\x3cp\x3e单线程node.js代理中间件，用于连接，快速和浏览器同步\x3c\/p\x3e\n\x3cp\x3eNode.js代理简单。 轻松配置代理中间件连接，快速，浏览器同步等。\x3c\/p\x3e\n\x3cp\x3e由流行的Nodejitsu http代理提供。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3eTL;DR\x3c\/h1\x3e\n\x3cp\x3e代理\x3ccode\x3e\/api\x3c\/code\x3e请求到\x3ccode\x3ehttp:\/\/www.example.org\x3c\/code\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var express = require(\x27express\x27);\nvar proxy = require(\x27http-proxy-middleware\x27);\n\nvar app = express();\n\napp.use(\x27\/api\x27, proxy({target: \x27http:\/\/www.example.org\x27, changeOrigin: true}));\napp.listen(3000);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e express = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27express\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e proxy = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27http-proxy-middleware\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = express();\n\napp.\x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27\/api\x27\x3c\/span\x3e, proxy({target: \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/www.example.org\x27\x3c\/span\x3e, changeOrigin: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e}));\napp.listen(\x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以使用所有http-proxy选项，以及一些额外的http-proxy-middleware选项。\x3c\/p\x3e\n\x3cp\x3e提示：将基于名称的虚拟托管网站的选项changeOrigin设置为true。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3e安装\x3c\/h1\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$ npm install --save-dev http-proxy-middleware\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs q\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e$ npm install --\x3cspan class=\x22hljs-built_in\x22\x3esave\x3c\/span\x3e-\x3cspan class=\x22hljs-built_in\x22\x3edev\x3c\/span\x3e http-proxy-middleware\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader3\x22\x3e核心概念\x3c\/h1\x3e\n\x3cp\x3e\x3cstrong\x3e proxy([context,] config)\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var proxy = require(\x27http-proxy-middleware\x27);\n\nvar apiProxy = proxy(\x27\/api\x27, {target: \x27http:\/\/www.example.org\x27});\n\/\/                   \\____\/   \\_____________________________\/ \n\/\/                     |                    | \n\/\/                   context             options \n\n\/\/ \x27apiProxy\x27 is now ready to be used as middleware in a server. \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs livescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e proxy = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27http-proxy-middleware\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e apiProxy = proxy(\x3cspan class=\x22hljs-string\x22\x3e\x27\/api\x27\x3c\/span\x3e, {target: \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/www.example.org\x27\x3c\/span\x3e});\n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/                   \\____\/   \\_____________________________\/ \n\/\/\x3c\/span\x3e                     |                    | \n\x3cspan class=\x22hljs-regexp\x22\x3e\/\/                   context             options \n\n\/\/\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27apiProxy\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eis\x3c\/span\x3e now ready \x3cspan class=\x22hljs-keyword\x22\x3eto\x3c\/span\x3e be used as middleware \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e a server. \x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\n\x3cli\x3econtext：确定应将哪些请求代理到目标主机。 （更多关于上下文匹配）\x3c\/li\x3e\n\x3cli\x3eoptions.target：目标主机到代理。 （协议\x2b主机）\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e（http-proxy-middleware配置选项的完整列表）\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3eproxy(uri [, config])\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ shorthand syntax for the example above: \nvar apiProxy = proxy(\x27http:\/\/www.example.org\/api\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs scala\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ shorthand syntax for the example above: \x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e apiProxy = proxy(\x3cspan class=\x22hljs-symbol\x22\x3e\x27http\x3c\/span\x3e:\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.example.org\/api\x27);\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e更多关于速记配置。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader4\x22\x3e举个栗子\x3c\/h1\x3e\n\x3cp\x3e使用express服务器的示例。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ include dependencies \nvar express = require(\x27express\x27);\nvar proxy = require(\x27http-proxy-middleware\x27);\n\n\/\/ proxy middleware options \nvar options = {\n        target: \x27http:\/\/www.example.org\x27, \/\/ target host \n        changeOrigin: true,               \/\/ needed for virtual hosted sites \n        ws: true,                         \/\/ proxy websockets \n        pathRewrite: {\n            \x27^\/api\/old-path\x27 : \x27\/api\/new-path\x27,     \/\/ rewrite path \n            \x27^\/api\/remove\/path\x27 : \x27\/path\x27           \/\/ remove base path \n        },\n        router: {\n            \/\/ when request.headers.host == \x27dev.localhost:3000\x27, \n            \/\/ override target \x27http:\/\/www.example.org\x27 to \x27http:\/\/localhost:8000\x27 \n            \x27dev.localhost:3000\x27 : \x27http:\/\/localhost:8000\x27\n        }\n    };\n\n\/\/ create the proxy (without context) \nvar exampleProxy = proxy(options);\n\n\/\/ mount `exampleProxy` in web server \nvar app = express();\n    app.use(\x27\/api\x27, exampleProxy);\n    app.listen(3000);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ include dependencies \x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e express = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27express\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e proxy = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27http-proxy-middleware\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ proxy middleware options \x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e options = {\n        target: \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/www.example.org\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ target host \x3c\/span\x3e\n        changeOrigin: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e,               \x3cspan class=\x22hljs-comment\x22\x3e\/\/ needed for virtual hosted sites \x3c\/span\x3e\n        ws: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e,                         \x3cspan class=\x22hljs-comment\x22\x3e\/\/ proxy websockets \x3c\/span\x3e\n        pathRewrite: {\n            \x3cspan class=\x22hljs-string\x22\x3e\x27^\/api\/old-path\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27\/api\/new-path\x27\x3c\/span\x3e,     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ rewrite path \x3c\/span\x3e\n            \x3cspan class=\x22hljs-string\x22\x3e\x27^\/api\/remove\/path\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27\/path\x27\x3c\/span\x3e           \x3cspan class=\x22hljs-comment\x22\x3e\/\/ remove base path \x3c\/span\x3e\n        },\n        router: {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ when request.headers.host == \x27dev.localhost:3000\x27, \x3c\/span\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ override target \x27http:\/\/www.example.org\x27 to \x27http:\/\/localhost:8000\x27 \x3c\/span\x3e\n            \x3cspan class=\x22hljs-string\x22\x3e\x27dev.localhost:3000\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/localhost:8000\x27\x3c\/span\x3e\n        }\n    };\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ create the proxy (without context) \x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e exampleProxy = proxy(options);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ mount `exampleProxy` in web server \x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = express();\n    app.\x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27\/api\x27\x3c\/span\x3e, exampleProxy);\n    app.listen(\x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader5\x22\x3e匹配代理规则\x3c\/h1\x3e\n\x3cp\x3e提供一种替代方式来决定哪些请求应该被代理;如果您无法使用服务器的路径参数来装载代理，或者需要更多的灵活性。\x3c\/p\x3e\n\x3cp\x3eRFC 3986路径用于上下文匹配。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22     foo:\/\/example.com:8042\/over\/there?name=ferret#nose\n     \\_\/   \\______________\/\\_________\/ \\_________\/ \\__\/\n      |           |            |            |        |\n   scheme     authority       path        query   fragment\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gherkin\x22\x3e\x3ccode\x3e     foo:\/\/example.com:8042\/over\/there?name=ferret\x3cspan class=\x22hljs-comment\x22\x3e#nose\x3c\/span\x3e\n     \\_\/   \\______________\/\\_________\/ \\_________\/ \\__\/\n      |\x3cspan class=\x22hljs-string\x22\x3e           \x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e            \x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e            \x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e        \x3c\/span\x3e|\n   scheme     authority       path        query   fragment\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cstrong\x3e路径匹配\x3c\/strong\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3ccode\x3eproxy({...})\x3c\/code\x3e - 匹配任意路径，所有的请求都会被代理。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eproxy(\x27\/\x27, {...})\x3c\/code\x3e-匹配任意路径，所有的请求都会被代理。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eproxy(\x27\/api\x27, {...})\x3c\/code\x3e-匹配所有以\/api开始的路径。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cul\x3e\x3cli\x3e\x3cstrong\x3e多重路径匹配\x3c\/strong\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3col\x3e\x3cli\x3e\x3ccode\x3eproxy([\x27\/api\x27, \x27\/ajax\x27, \x27\/someotherpath\x27], {...})\x3c\/code\x3e\x3c\/li\x3e\x3c\/ol\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cstrong\x3e通配符路径匹配\x3c\/strong\x3e \x3cbr\x3e 对于细粒度控制，您可以使用通配符匹配。通过micromatch进行全局模式匹配。访问micromatch或glob更多globbing示例。\x3c\/li\x3e\x3c\/ul\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3ccode\x3eproxy(\x27**\x27, {...})\x3c\/code\x3e 匹配任意路径，所有的请求都会被代理。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eproxy(\x27**\/*.html\x27, {...})\x3c\/code\x3e 匹配所有以.html结尾的任意路径。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eproxy(\x27\/*.html\x27, {...})\x3c\/code\x3e 直接匹配绝对路径下的路径。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eproxy(\x27\/api\/**\/*.html\x27, {...})\x3c\/code\x3e匹配在\/api路径下以.html结尾的请求。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eproxy([\x27\/api\/**\x27, \x27\/ajax\/**\x27], {...})\x3c\/code\x3e组合多重路由模式。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eproxy([\x27\/api\/**\x27, \x27!**\/bad.json\x27], {...})\x3c\/code\x3e排除匹配。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cstrong\x3e自定义匹配\x3c\/strong\x3e \x3cbr\x3e为了完全控制，您可以提供一个自定义函数来确定哪些请求应该被代理。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var filter = function (pathname, req) {\n    return (pathname.match(\x27^\/api\x27) \x26amp;\x26amp; req.method === \x27GET\x27);\n};\n\nvar apiProxy = proxy(filter, {target: \x27http:\/\/www.example.org\x27})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e filter = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(pathname, req)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (pathname.match(\x3cspan class=\x22hljs-string\x22\x3e\x27^\/api\x27\x3c\/span\x3e) \x26amp;\x26amp; req.method === \x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e);\n};\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e apiProxy = proxy(filter, {target: \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/www.example.org\x27\x3c\/span\x3e})\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader6\x22\x3e选项\x3c\/h1\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3ehttp-proxy-middleware选项\x3c\/h3\x3e\n\x3cul\x3e\x3cli\x3e\n\x3ccode\x3eoption.pathRewrite：Object\/Function\x3c\/code\x3e，重写目标的url路径。对象键将被用作RegExp来匹配路径。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ rewrite path \npathRewrite: {\x27^\/old\/api\x27 : \x27\/new\/api\x27}\n\n\/\/ remove path \npathRewrite: {\x27^\/remove\/api\x27 : \x27\x27}\n\n\/\/ add base path \npathRewrite: {\x27^\/\x27 : \x27\/basepath\/\x27}\n\n\/\/ custom rewriting \npathRewrite: function (path, req) { return path.replace(\x27\/api\x27, \x27\/base\/api\x27) }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ rewrite path \x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3epathRewrite:\x3c\/span\x3e {\x3cspan class=\x22hljs-string\x22\x3e\x27^\/old\/api\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27\/new\/api\x27\x3c\/span\x3e}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ remove path \x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3epathRewrite:\x3c\/span\x3e {\x3cspan class=\x22hljs-string\x22\x3e\x27^\/remove\/api\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ add base path \x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3epathRewrite:\x3c\/span\x3e {\x3cspan class=\x22hljs-string\x22\x3e\x27^\/\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27\/basepath\/\x27\x3c\/span\x3e}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ custom rewriting \x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3epathRewrite:\x3c\/span\x3e function (path, req) { \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e path.replace(\x3cspan class=\x22hljs-string\x22\x3e\x27\/api\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/base\/api\x27\x3c\/span\x3e) }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\n\x3ccode\x3eoption.router：Object\/Function\x3c\/code\x3e，重新定位特定请求的\x3ccode\x3eoption.target\x3c\/code\x3e。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Use `host` and\/or `path` to match requests. First match will be used. \n\/\/ The order of the configuration matters. \nrouter: {\n    \x27integration.localhost:3000\x27 : \x27http:\/\/localhost:8001\x27,  \/\/ host only \n    \x27staging.localhost:3000\x27     : \x27http:\/\/localhost:8002\x27,  \/\/ host only \n    \x27localhost:3000\/api\x27         : \x27http:\/\/localhost:8003\x27,  \/\/ host \x2b path \n    \x27\/rest\x27                      : \x27http:\/\/localhost:8004\x27   \/\/ path only \n}\n\n\/\/ Custom router function \nrouter: function(req) {\n    return \x27http:\/\/localhost:8004\x27;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Use `host` and\/or `path` to match requests. First match will be used. \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ The order of the configuration matters. \x3c\/span\x3e\nrouter: {\n    \x3cspan class=\x22hljs-string\x22\x3e\x27integration.localhost:3000\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/localhost:8001\x27\x3c\/span\x3e,  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ host only \x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e\x27staging.localhost:3000\x27\x3c\/span\x3e     : \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/localhost:8002\x27\x3c\/span\x3e,  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ host only \x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e\x27localhost:3000\/api\x27\x3c\/span\x3e         : \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/localhost:8003\x27\x3c\/span\x3e,  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ host \x2b path \x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\/rest\x27\x3c\/span\x3e                      : \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/localhost:8004\x27\x3c\/span\x3e   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ path only \x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Custom router function \x3c\/span\x3e\nrouter: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(req)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/localhost:8004\x27\x3c\/span\x3e;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ccode\x3eoption.logLevel：String\x3c\/code\x3e， [‘debug’, ‘info’, ‘warn’, ‘error’, ‘silent’]. 默认：\x3ccode\x3einfo\x3c\/code\x3e。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eoption.logProvider：Function\x3c\/code\x3e，修改或者替换日志服务。默认：\x3ccode\x3econsole\x3c\/code\x3e。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ simple replace \nfunction logProvider(provider) {\n    \/\/ replace the default console log provider. \n    return require(\x27winston\x27);\n}\n\n\/\/ verbose replacement \nfunction logProvider(provider) {\n    var logger = new (require(\x27winston\x27).Logger)();\n\n    var myCustomProvider = {\n        log: logger.log,\n        debug: logger.debug,\n        info: logger.info,\n        warn: logger.warn,\n        error: logger.error\n    }\n    return myCustomProvider;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ simple replace \x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3elogProvider\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eprovider\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ replace the default console log provider. \x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27winston\x27\x3c\/span\x3e);\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ verbose replacement \x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3elogProvider\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eprovider\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e logger = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27winston\x27\x3c\/span\x3e).Logger)();\n\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e myCustomProvider = {\n        \x3cspan class=\x22hljs-attr\x22\x3elog\x3c\/span\x3e: logger.log,\n        \x3cspan class=\x22hljs-attr\x22\x3edebug\x3c\/span\x3e: logger.debug,\n        \x3cspan class=\x22hljs-attr\x22\x3einfo\x3c\/span\x3e: logger.info,\n        \x3cspan class=\x22hljs-attr\x22\x3ewarn\x3c\/span\x3e: logger.warn,\n        \x3cspan class=\x22hljs-attr\x22\x3eerror\x3c\/span\x3e: logger.error\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e myCustomProvider;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e-（已弃用）\x3ccode\x3eoption.proxyHost\x3c\/code\x3e：用\x3ccode\x3eoption.changeOrigin = true\x3c\/code\x3e代替。\x3cbr\x3e-（已弃用）\x3ccode\x3eoption.proxyTable\x3c\/code\x3e：用\x3ccode\x3eoption.router\x3c\/code\x3e代替。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3ehttp-proxy 事件\x3c\/h3\x3e\n\x3cul\x3e\x3cli\x3e\n\x3ccode\x3eoption.onError：Function\x3c\/code\x3e，订阅\x3ccode\x3ehttp-proxy\x3c\/code\x3e的\x3ccode\x3eerror\x3c\/code\x3e事件以进行自定义错误处理。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function onError(err, req, res) {\n    res.writeHead(500, {\n        \x27Content-Type\x27: \x27text\/plain\x27\n    });\n    res.end(\x27Something went wrong. And we are reporting a custom error message.\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lua\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonError\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(err, req, res)\x3c\/span\x3e\x3c\/span\x3e {\n    res.writeHead(\x3cspan class=\x22hljs-number\x22\x3e500\x3c\/span\x3e, {\n        \x3cspan class=\x22hljs-string\x22\x3e\x27Content-Type\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27text\/plain\x27\x3c\/span\x3e\n    });\n    res.\x3cspan class=\x22hljs-keyword\x22\x3eend\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27Something went wrong. And we are reporting a custom error message.\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\n\x3ccode\x3eoption.onProxyRes：Function\x3c\/code\x3e，订阅\x3ccode\x3ehttp-proxy\x3c\/code\x3e的\x3ccode\x3eproxyRes\x3c\/code\x3e事件。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function onProxyRes(proxyRes, req, res) {\n    proxyRes.headers[\x27x-added\x27] = \x27foobar\x27;     \/\/ add new header to response \n    delete proxyRes.headers[\x27x-removed\x27];       \/\/ remove header from response \n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonProxyRes\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(proxyRes, req, res)\x3c\/span\x3e \x3c\/span\x3e{\n    proxyRes.headers[\x3cspan class=\x22hljs-string\x22\x3e\x27x-added\x27\x3c\/span\x3e] = \x3cspan class=\x22hljs-string\x22\x3e\x27foobar\x27\x3c\/span\x3e;     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ add new header to response \x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3edelete\x3c\/span\x3e proxyRes.headers[\x3cspan class=\x22hljs-string\x22\x3e\x27x-removed\x27\x3c\/span\x3e];       \x3cspan class=\x22hljs-comment\x22\x3e\/\/ remove header from response \x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\n\x3ccode\x3eoption.onProxyReq：Function\x3c\/code\x3e，订阅\x3ccode\x3ehttp-proxy\x3c\/code\x3e的\x3ccode\x3eproxyReq\x3c\/code\x3e事件。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function onProxyReq(proxyReq, req, res) {\n    \/\/ add custom header to request \n    proxyReq.setHeader(\x27x-added\x27, \x27foobar\x27);\n    \/\/ or log the req \n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs perl\x22\x3e\x3ccode\x3efunction onProxyRe\x3cspan class=\x22hljs-string\x22\x3eq(proxyReq, req, res)\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e add custom header to request \n    proxyReq.setHeader(\x3cspan class=\x22hljs-string\x22\x3e\x27x-added\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27foobar\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eor\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3elog\x3c\/span\x3e the req \n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\n\x3ccode\x3eoption.onProxyReqWs：Function\x3c\/code\x3e，订阅\x3ccode\x3ehttp-proxy\x3c\/code\x3e的\x3ccode\x3eproxyReqWs\x3c\/code\x3e事件。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function onProxyReqWs(proxyReq, req, socket, options, head) {\n    \/\/ add custom header \n    proxyReq.setHeader(\x27X-Special-Proxy-Header\x27, \x27foobar\x27);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonProxyReqWs\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(proxyReq, req, socket, options, head)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ add custom header \x3c\/span\x3e\n    proxyReq.setHeader(\x3cspan class=\x22hljs-string\x22\x3e\x27X-Special-Proxy-Header\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27foobar\x27\x3c\/span\x3e);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\n\x3ccode\x3eoption.onOpen：Function\x3c\/code\x3e，订阅\x3ccode\x3ehttp-proxy\x3c\/code\x3e的 \x3ccode\x3eopen\x3c\/code\x3e事件。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function onOpen(proxySocket) {\n    \/\/ listen for messages coming FROM the target here \n    proxySocket.on(\x27data\x27, hybiParseAndLogMessage);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonOpen\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(proxySocket)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ listen for messages coming FROM the target here \x3c\/span\x3e\n    proxySocket.on(\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e, hybiParseAndLogMessage);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\n\x3ccode\x3eoption.onClose：Function\x3c\/code\x3e，订阅\x3ccode\x3ehttp-proxy\x3c\/code\x3e 的\x3ccode\x3eclose\x3c\/code\x3e事件。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function onClose(res, socket, head) {\n    \/\/ view disconnected websocket connections \n    console.log(\x27Client disconnected\x27);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonClose\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eres, socket, head\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ view disconnected websocket connections \x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27Client disconnected\x27\x3c\/span\x3e);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3ehttp-proxy选项\x3c\/h3\x3e\n\x3cp\x3e底层http-proxy库提供以下选项。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eoption.target：url\x3c\/code\x3e 字符串将与url模块解析\x3cbr\x3e\x3ccode\x3eoption.forward：url\x3c\/code\x3e字符串将与url模块解析\x3cbr\x3e\x3ccode\x3eoption.target\x3c\/code\x3e：传递给http(s)请求的对象（参阅Node https代理和http代理对象）\x3cbr\x3e\x3ccode\x3eoption.ssl\x3c\/code\x3e：传递给https.createServer()的对象\x3cbr\x3e\x3ccode\x3eoption.ws：true \/ false\x3c\/code\x3e，如果你想要代理websockets\x3cbr\x3e\x3ccode\x3eoption.xfwd：true \/ false\x3c\/code\x3e，添加x-forward请求头\x3cbr\x3e\x3ccode\x3eoption.secure：true \/ false\x3c\/code\x3e，如果你想要验证SSL证书\x3cbr\x3e\x3ccode\x3eoption.toProxy：true \/ false\x3c\/code\x3e，将绝对URL作为path（对代理使用代理时很有用）\x3cbr\x3e\x3ccode\x3eoption.prependPath：true \/ false\x3c\/code\x3e，默认：true-指定是否要将目标的路径预置到代理路径\x3cbr\x3e\x3ccode\x3eoption.ignorePath：true \/ false\x3c\/code\x3e，默认：false-指定是否要忽略传入请求的代理路径（注意：如果需要，您将必须附加\/手动）。\x3cbr\x3e\x3ccode\x3eoption.localAddress\x3c\/code\x3e：用于传出连接的本地接口字符串\x3cbr\x3e\x3ccode\x3eoption.changeOrigin：true \/ false\x3c\/code\x3e，默认值：false - 将主机头的源更改为目标URL\x3cbr\x3e\x3ccode\x3eoption.auth\x3c\/code\x3e：基本认证，即“用户：密码”来计算授权头。\x3cbr\x3e\x3ccode\x3eoption.hostRewrite\x3c\/code\x3e：重写（301\/302\/307\/308）重定向的位置主机名。\x3cbr\x3e\x3ccode\x3eoption.autoRewrite\x3c\/code\x3e：根据请求的主机\/端口重写（301\/302\/307\/308）重定向的位置主机\/端口。默认值：false。\x3cbr\x3e\x3ccode\x3eoption.protocolRewrite\x3c\/code\x3e：重写位置协议（301\/302\/307\/308）重定向到’http’或’https’。默认值：null。\x3cbr\x3e\x3ccode\x3eoption.cookieDomainRewrite\x3c\/code\x3e：重写set-cookie标头的域。可能的值：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3efalse（默认）：禁止重写cookie\x3c\/li\x3e\n\x3cli\x3e字符串：新域名，比如说cookieDomainRewrite:\x22new.domain\x22。使用cookieDomainRewrite:\x22\x22删除域名。\x3c\/li\x3e\n\x3cli\x3e对象：域名到新域名的映射，用”*”匹配所有域名。 \x3cbr\x3e举个栗子：保持一个域名不变，重写一个域名并且删除其他的：\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22cookieDomainRewrite: { \n\x26quot;unchanged.domain\x26quot;: \x26quot;unchanged.domain\x26quot;, \n\x26quot;old.domain\x26quot;: \x26quot;new.domain\x26quot;, \n\x26quot;*\x26quot;: \x26quot;\x26quot; \n} \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs avrasm\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-symbol\x22\x3ecookieDomainRewrite:\x3c\/span\x3e { \n\x3cspan class=\x22hljs-string\x22\x3e\x22unchanged.domain\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22unchanged.domain\x22\x3c\/span\x3e, \n\x3cspan class=\x22hljs-string\x22\x3e\x22old.domain\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22new.domain\x22\x3c\/span\x3e, \n\x3cspan class=\x22hljs-string\x22\x3e\x22*\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e \n} \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3eoption.headers\x3c\/code\x3e：对象，添加请求头。（比如：{host:\x27www.example.org\x27}）\x3cbr\x3e\x3ccode\x3eoption.proxyTimeout\x3c\/code\x3e：超时时间（毫秒）当代理接收不到目标服务器的返回\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader10\x22\x3e速记\x3c\/h1\x3e\n\x3cp\x3e当不需要详细配置时，请使用简写语法。当使用速记时，上下文和option.target将被自动配置。如果需要，仍然可以使用选项。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22proxy(\x27http:\/\/www.example.org:8000\/api\x27);\n\/\/ proxy(\x27\/api\x27, {target: \x27http:\/\/www.example.org:8000\x27}); \n\n\nproxy(\x27http:\/\/www.example.org:8000\/api\/books\/*\/**.json\x27);\n\/\/ proxy(\x27\/api\/books\/*\/**.json\x27, {target: \x27http:\/\/www.example.org:8000\x27}); \n\n\nproxy(\x27http:\/\/www.example.org:8000\/api\x27, {changeOrigin:true});\n\/\/ proxy(\x27\/api\x27, {target: \x27http:\/\/www.example.org:8000\x27, changeOrigin: true}); \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lisp\x22\x3e\x3ccode\x3eproxy(\x27http\x3cspan class=\x22hljs-symbol\x22\x3e:\/\/www\x3c\/span\x3e.example.org:\x3cspan class=\x22hljs-number\x22\x3e8000\x3c\/span\x3e\/api\x27)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n\/\/ proxy(\x27\/api\x27, {target: \x27http\x3cspan class=\x22hljs-symbol\x22\x3e:\/\/www\x3c\/span\x3e.example.org:\x3cspan class=\x22hljs-number\x22\x3e8000\x3c\/span\x3e\x27})\x3cspan class=\x22hljs-comment\x22\x3e; \x3c\/span\x3e\n\n\nproxy(\x27http\x3cspan class=\x22hljs-symbol\x22\x3e:\/\/www\x3c\/span\x3e.example.org:\x3cspan class=\x22hljs-number\x22\x3e8000\x3c\/span\x3e\/api\/books\/*\/**.json\x27)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n\/\/ proxy(\x27\/api\/books\/*\/**.json\x27, {target: \x27http\x3cspan class=\x22hljs-symbol\x22\x3e:\/\/www\x3c\/span\x3e.example.org:\x3cspan class=\x22hljs-number\x22\x3e8000\x3c\/span\x3e\x27})\x3cspan class=\x22hljs-comment\x22\x3e; \x3c\/span\x3e\n\n\nproxy(\x27http\x3cspan class=\x22hljs-symbol\x22\x3e:\/\/www\x3c\/span\x3e.example.org:\x3cspan class=\x22hljs-number\x22\x3e8000\x3c\/span\x3e\/api\x27, {changeOrigin\x3cspan class=\x22hljs-symbol\x22\x3e:true\x3c\/span\x3e})\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n\/\/ proxy(\x27\/api\x27, {target: \x27http\x3cspan class=\x22hljs-symbol\x22\x3e:\/\/www\x3c\/span\x3e.example.org:\x3cspan class=\x22hljs-number\x22\x3e8000\x3c\/span\x3e\x27, changeOrigin: true})\x3cspan class=\x22hljs-comment\x22\x3e; \x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eapp.use(path, proxy)\x3c\/p\x3e\n\x3cp\x3e如果要使用服务器的app.usepath参数匹配请求;创建并装载不带http-proxy-middleware`上下文参数的代理：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22app.use(\x27\/api\x27, proxy({target:\x27http:\/\/www.example.org\x27, changeOrigin:true}));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eapp.use(\x3cspan class=\x22hljs-string\x22\x3e\x27\/api\x27\x3c\/span\x3e, proxy({\x3cspan class=\x22hljs-string\x22\x3etarget:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/www.example.org\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3echangeOrigin:\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e}));\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader11\x22\x3eapp.use文档\x3c\/h1\x3e\n\x3cp\x3eexpress： \x3ca href=\x22http:\/\/expressjs.com\/en\/4x\/api.html#app.use\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/expressjs.com\/en\/4x\/api.html#app.use\x3c\/a\x3e\x3cbr\x3econnect：\x3ca href=\x22https:\/\/github.com\/senchalabs\/connect#mount-middleware\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/senchalabs\/connect#mount-middleware\x3c\/a\x3e\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader12\x22\x3eWebsocket\x3c\/h1\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ verbose api \nproxy(\x27\/\x27, {target:\x27http:\/\/echo.websocket.org\x27, ws:true});\n\n\/\/ shorthand \nproxy(\x27http:\/\/echo.websocket.org\x27, {ws:true});\n\n\/\/ shorter shorthand \nproxy(\x27ws:\/\/echo.websocket.org\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ verbose api \x3c\/span\x3e\nproxy(\x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e, {\x3cspan class=\x22hljs-string\x22\x3etarget:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/echo.websocket.org\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3ews:\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e});\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ shorthand \x3c\/span\x3e\nproxy(\x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/echo.websocket.org\x27\x3c\/span\x3e, {\x3cspan class=\x22hljs-string\x22\x3ews:\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e});\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ shorter shorthand \x3c\/span\x3e\nproxy(\x3cspan class=\x22hljs-string\x22\x3e\x27ws:\/\/echo.websocket.org\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader13\x22\x3e外部WebSocket升级\x3c\/h1\x3e\n\x3cp\x3e在以前的WebSocket示例中，http代理中间件依赖于初始http请求以便侦听http升级事件。如果需要在没有初始http请求的情况下代理WebSockets，则可以手动预订服务器的http升级事件。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var wsProxy = proxy(\x27ws:\/\/echo.websocket.org\x27, {changeOrigin:true});\n\nvar app = express();\n    app.use(wsProxy);\n\nvar server = app.listen(3000);\n    server.on(\x27upgrade\x27, wsProxy.upgrade);  \/\/ \x3c-- subscribe to http \x27upgrade\x27 \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stata\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e wsProxy = proxy(\x27ws:\x3cspan class=\x22hljs-comment\x22\x3e\/\/echo.websocket.org\x27, {changeOrigin:true});\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eapp\x3c\/span\x3e = express();\n    \x3cspan class=\x22hljs-keyword\x22\x3eapp\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e(wsProxy);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e server = \x3cspan class=\x22hljs-keyword\x22\x3eapp\x3c\/span\x3e.listen(3000);\n    server.\x3cspan class=\x22hljs-keyword\x22\x3eon\x3c\/span\x3e(\x27upgrade\x27, wsProxy.upgrade);  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ \x26lt;-- subscribe to http \x27upgrade\x27 \x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>http-proxy-middleware 服务代理</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011776090">https://segmentfault.com/a/1190000011776090</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/1wbx8th422f/" target="_blank">https://alili.tech/archive/1wbx8th422f/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>