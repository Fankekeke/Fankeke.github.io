<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="VUEX源码学习笔记（第5~6章 共6章）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>VUEX源码学习笔记（第5~6章 共6章） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/219ekj5pf8/",
				"appid": "1613049289050283", 
				"title": "VUEX源码学习笔记（第5~6章 共6章） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-28T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/igkenm2gei/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/tm4braffwy/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f219ekj5pf8%2f&text=VUEX%e6%ba%90%e7%a0%81%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%ef%bc%88%e7%ac%ac5~6%e7%ab%a0%20%e5%85%b16%e7%ab%a0%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f219ekj5pf8%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f219ekj5pf8%2f&text=VUEX%e6%ba%90%e7%a0%81%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%ef%bc%88%e7%ac%ac5~6%e7%ab%a0%20%e5%85%b16%e7%ab%a0%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f219ekj5pf8%2f&title=VUEX%e6%ba%90%e7%a0%81%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%ef%bc%88%e7%ac%ac5~6%e7%ab%a0%20%e5%85%b16%e7%ab%a0%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f219ekj5pf8%2f&is_video=false&description=VUEX%e6%ba%90%e7%a0%81%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%ef%bc%88%e7%ac%ac5~6%e7%ab%a0%20%e5%85%b16%e7%ab%a0%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=VUEX%e6%ba%90%e7%a0%81%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%ef%bc%88%e7%ac%ac5~6%e7%ab%a0%20%e5%85%b16%e7%ab%a0%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f219ekj5pf8%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f219ekj5pf8%2f&title=VUEX%e6%ba%90%e7%a0%81%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%ef%bc%88%e7%ac%ac5~6%e7%ab%a0%20%e5%85%b16%e7%ab%a0%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f219ekj5pf8%2f&title=VUEX%e6%ba%90%e7%a0%81%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%ef%bc%88%e7%ac%ac5~6%e7%ab%a0%20%e5%85%b16%e7%ab%a0%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f219ekj5pf8%2f&title=VUEX%e6%ba%90%e7%a0%81%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%ef%bc%88%e7%ac%ac5~6%e7%ab%a0%20%e5%85%b16%e7%ab%a0%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f219ekj5pf8%2f&title=VUEX%e6%ba%90%e7%a0%81%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%ef%bc%88%e7%ac%ac5~6%e7%ab%a0%20%e5%85%b16%e7%ab%a0%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">VUEX源码学习笔记（第5~6章 共6章）</h1><div class="meta"><div class="postdate"><time datetime="2018-12-28" itemprop="datePublished">2018-12-28</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e第五章 辅助函数\x3c\/h1\x3e\n\x3cp\x3e在第一章我们曾经说过：\x3c\/p\x3e\n\x3cblockquote\x3eVUEX采用的是典型的IIFE(立即执行函数表达式)模式，当代码被加载(通过\x3ccode\x3e\x26lt;script\x26gt;\x3c\/code\x3e或\x3ccode\x3eVue.use()\x3c\/code\x3e)后，VUEX会返回一个对象，这个对象包含了\x3ccode\x3eStore\x3c\/code\x3e类、\x3ccode\x3einstall\x3c\/code\x3e方法、\x3ccode\x3emapState\x3c\/code\x3e辅助函数、\x3ccode\x3emapMutations\x3c\/code\x3e辅助函数、\x3ccode\x3emapGetters\x3c\/code\x3e辅助函数、\x3ccode\x3emapActions\x3c\/code\x3e辅助函数、\x3ccode\x3ecreateNamespacedHelpers\x3c\/code\x3e辅助函数以及当前的版本号\x3ccode\x3eversion\x3c\/code\x3e。\x3c\/blockquote\x3e\n\x3cp\x3e本章就将详细讲解\x3ccode\x3emapState\x3c\/code\x3e、\x3ccode\x3emapMutations\x3c\/code\x3e、\x3ccode\x3emapGetters\x3c\/code\x3e、\x3ccode\x3emapActions\x3c\/code\x3e、\x3ccode\x3ecreateNamespacedHelpers这5个辅助和函数。\x3c\/code\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e5.1 主要辅助函数\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e5.1.1 mapState\x3c\/h3\x3e\n\x3cp\x3e如果你在使用VUEX过程中使用过\x3ccode\x3emapState\x3c\/code\x3e辅助函数将state映射为计算属性你应该会为它所支持的多样化的映射形式感到惊讶。我们不妨先来看看官方文档对它的介绍：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVW7Kr?w=777\x26amp;h=743\x22 src=\x22https:\/\/static.alili.tech\/img\/bVW7Kr?w=777\x26amp;h=743\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e如果你深入思考过你可能会有疑问：VUEX的\x3ccode\x3emapState\x3c\/code\x3e是如何实现这么多种映射的呢？如果你现在还不明白，那么跟随我们来一起看看吧！\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3emapState\x3c\/code\x3e辅助函数定义在VUEX源码中的790 ~ 815 行，主要是对多种映射方式以及带命名空间的模块提供了支持，我们来看看它的源码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var mapState = normalizeNamespace(function (namespace, states) {\n  var res = {};\n  normalizeMap(states).forEach(function (ref) {\n    var key = ref.key;\n    var val = ref.val;\n\n    res[key] = function mappedState () {\n      var state = this.$store.state;\n      var getters = this.$store.getters;\n      if (namespace) {\n        var module = getModuleByNamespace(this.$store, \x27mapState\x27, namespace);\n        if (!module) {\n          return\n        }\n        state = module.context.state;\n        getters = module.context.getters;\n      }\n      return typeof val === \x27function\x27\n        ? val.call(this, state, getters)\n        : state[val]\n    };\n    \/\/ mark vuex getter for devtools\n    res[key].vuex = true;\n  });\n  return res\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3evar mapState = normalizeNamespace(function (namespace, states) {\n  var res = {};\n  normalizeMap(states).\x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3eEach(function (ref) {\n    var key = ref.key;\n    var val = ref.val;\n\n    res[key] = function mappedState () {\n      var \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e = this.\x3cspan class=\x22hljs-variable\x22\x3e$store\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e;\n      var getters = this.\x3cspan class=\x22hljs-variable\x22\x3e$store\x3c\/span\x3e.getters;\n      if (namespace) {\n        var module = getModuleByNamespace(this.\x3cspan class=\x22hljs-variable\x22\x3e$store\x3c\/span\x3e, \x27mapState\x27, namespace);\n        if (!module) {\n          return\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e = module.context.\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e;\n        getters = module.context.getters;\n      }\n      return typeof val === \x27function\x27\n        ? val.call(this, \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e, getters)\n        : \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e[val]\n    };\n    \/\/ mark vuex getter \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e devtools\n    res[key].vuex = true;\n  });\n  return res\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看到，mapState函数实际上是以函数表达式的形式的形式定义的，它的实际函数是normalizeNamespace函数，这个函数会对mapState函数的输入参数进行归一化\/规范化处理，其最主要的功能是实现了支持带命名空间的模块，我们来看一下它的实现：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function normalizeNamespace (fn) {\n  return function (namespace, map) {\n    if (typeof namespace !== \x27string\x27) {\n      map = namespace;\n      namespace = \x27\x27;\n    } else if (namespace.charAt(namespace.length - 1) !== \x27\/\x27) {\n      namespace \x2b= \x27\/\x27;\n    }\n    return fn(namespace, map)\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3enormalizeNamespace\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(fn)\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(namespace, map)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e !== \x3cspan class=\x22hljs-string\x22\x3e\x27string\x27\x3c\/span\x3e) {\n      map = \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e.charAt(\x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e.length - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) !== \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e \x2b= \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e fn(\x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e, map)\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看到mapState实际上是中间的那段函数：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22return function (namespace, map) {\n  if (typeof namespace !== \x27string\x27) {\n    map = namespace;\n    namespace = \x27\x27;\n  } else if (namespace.charAt(namespace.length - 1) !== \x27\/\x27) {\n    namespace \x2b= \x27\/\x27;\n  }\n  return fn(namespace, map)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(namespace, map)\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e !== \x3cspan class=\x22hljs-string\x22\x3e\x27string\x27\x3c\/span\x3e) {\n    map = \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e.charAt(\x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e.length - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) !== \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e \x2b= \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e;\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e fn(\x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e, map)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e它实际接收namespace, map可以接收两个参数，也可以只接受一个map参数。\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e当用户只提供了一个map参数时。这种情况由于类型不是string，会直接将其作为map，并将namespace置为空字符串。这种情况其实就和官方文档的使用方式相匹配。我们可以看看官方文档的示例就是只提供了一个map参数，并没有提供namespace参数。\x3c\/li\x3e\n\x3cli\x3e当用户提供了namespace, map两个参数时，但namespace不是字符串类型。实际上这种情况会和情况1做一样的处理，传进去的第一个参数作为实际的map，第二个参数会被忽略。\x3c\/li\x3e\n\x3cli\x3e当用户提供了namespace, map两个参数时，且namespace是字符串类型。这种情况下会根据字符串最末一位字符串是否是反斜线(\/)来区别对待。最终程序内部会将namespace统一处理成最后一位是反斜线(\/)的字符串。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e由以上分析我们可以知道，上述官方文档在此处的示例其实并不完善，该实例并没有指出\x3cstrong\x3e可以通过提供模块名称作为mapState的第一个参数来映射带命名空间的模块的state\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e我们举个例子看一下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const moduleA = {\n  namespaced: true,\/\/带命名空间\n  state: { count1: 1, age1: 20 }\n}\nconst store = new Vuex.Store({\n  state() {\n    return {\n        count: 0, age: 0\n    }\n  },\n  modules: {\n    a: moduleA\n  }\n})\nvar vm = new Vue({\n  el: \x27#example\x27,\n  store,\n  computed: Vuex.mapState(\x27a\x27, {\/\/ 映射时提供模块名作为第一个参数\n     count1: state =\x3e state.count1,\n     age1: state =\x3e state.age1,\n  })\n})\nconsole.log(vm)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3econst moduleA = {\n  namespaced: true,\/\/带命名空间\n  \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e: { count1: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, age1: \x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e }\n}\nconst store = new Vuex.Store({\n  \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e() {\n    return {\n        count: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, age: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n    }\n  },\n  modules: {\n    a: moduleA\n  }\n})\nvar vm = new Vue({\n  el: \x27\x3cspan class=\x22hljs-comment\x22\x3e#example\x27,\x3c\/span\x3e\n  store,\n  computed: Vuex.mapState(\x27a\x27, {\/\/ 映射时提供模块名作为第一个参数\n     count1: \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e =\x26gt; \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.count1,\n     age1: \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e =\x26gt; \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.age1,\n  })\n})\nconsole.\x3cspan class=\x22hljs-keyword\x22\x3elog\x3c\/span\x3e(vm)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其输出如下：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVW7Kz?w=1195\x26amp;h=552\x22 src=\x22https:\/\/static.alili.tech\/img\/bVW7Kz?w=1195\x26amp;h=552\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e传递模块名称后，我们只能映射带命名空间的该模块的state，如果该模块不带命名空间（即没有设置namespace属性）、或者对于其它名字的模块，我们是不能映射他们的state的。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e传递了模块名称，但该模块不带命名空间，尝试对其进行映射：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const moduleA = {\n  \/\/ namespaced: true,\n  state: { count1: 1, age1: 20 }\n}\nconst store = new Vuex.Store({\n  state() {\n    return {\n        count: 0, age: 0\n    }\n  },\n  modules: {\n    a: moduleA\n  }\n})\nvar vm = new Vue({\n  el: \x27#example\x27,\n  store,\n  computed: Vuex.mapState(\x27a\x27, {\n     count1: state =\x3e state.count1,\n     age1: state =\x3e state.age1,\n  })\n})\nconsole.log(vm)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3econst moduleA = {\n  \/\/ namespaced: true,\n  \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e: { count1: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, age1: \x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e }\n}\nconst store = new Vuex.Store({\n  \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e() {\n    return {\n        count: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, age: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n    }\n  },\n  modules: {\n    a: moduleA\n  }\n})\nvar vm = new Vue({\n  el: \x27\x3cspan class=\x22hljs-comment\x22\x3e#example\x27,\x3c\/span\x3e\n  store,\n  computed: Vuex.mapState(\x27a\x27, {\n     count1: \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e =\x26gt; \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.count1,\n     age1: \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e =\x26gt; \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.age1,\n  })\n})\nconsole.\x3cspan class=\x22hljs-keyword\x22\x3elog\x3c\/span\x3e(vm)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e传递了模块名称，但尝试映射其它模块的state：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const moduleA = {\n  namespaced: true,\n  state: { count1: 1, age1: 20 }\n}\nconst store = new Vuex.Store({\n  state() {\n    return {\n        count: 0, age: 0\n    }\n  },\n  modules: {\n    a: moduleA\n  }\n})\nvar vm = new Vue({\n  el: \x27#example\x27,\n  store,\n  computed: Vuex.mapState(\x27a\x27, {\n     count1: state =\x3e state.count,\n     age1: state =\x3e state.age,\n  })\n})\nconsole.log(vm)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3econst moduleA = {\n  namespaced: true,\n  \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e: { count1: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, age1: \x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e }\n}\nconst store = new Vuex.Store({\n  \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e() {\n    return {\n        count: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, age: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n    }\n  },\n  modules: {\n    a: moduleA\n  }\n})\nvar vm = new Vue({\n  el: \x27\x3cspan class=\x22hljs-comment\x22\x3e#example\x27,\x3c\/span\x3e\n  store,\n  computed: Vuex.mapState(\x27a\x27, {\n     count1: \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e =\x26gt; \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.count,\n     age1: \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e =\x26gt; \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.age,\n  })\n})\nconsole.\x3cspan class=\x22hljs-keyword\x22\x3elog\x3c\/span\x3e(vm)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这两种情况下的输出结果都会是undefined:\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVW7KC?w=945\x26amp;h=481\x22 src=\x22https:\/\/static.alili.tech\/img\/bVW7KC?w=945\x26amp;h=481\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e讲完了mapState的参数，我们接着回过头来看看mapState的实现。这里重复粘贴一下前面有关mapState定义的代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function normalizeNamespace (fn) {\n  return function (namespace, map) {\n    if (typeof namespace !== \x27string\x27) {\n      map = namespace;\n      namespace = \x27\x27;\n    } else if (namespace.charAt(namespace.length - 1) !== \x27\/\x27) {\n      namespace \x2b= \x27\/\x27;\n    }\n    return fn(namespace, map)\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3enormalizeNamespace\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(fn)\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(namespace, map)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e !== \x3cspan class=\x22hljs-string\x22\x3e\x27string\x27\x3c\/span\x3e) {\n      map = \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e.charAt(\x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e.length - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) !== \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e \x2b= \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e fn(\x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e, map)\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们可以看到，在归一化\/规范化输入参数后，mapState函数实际上是返回了另外一个函数的执行结果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22return fn(namespace, map)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cpp\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e fn(\x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个\x3ccode\x3efn\x3c\/code\x3e就是以函数表达式定义mapState函数时的normalizeNamespace 函数的参数，我们在前面已经见到过。再次粘贴其代码以便于分析：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function (namespace, states) {\n  var res = {};\n  normalizeMap(states).forEach(function (ref) {\n    var key = ref.key;\n    var val = ref.val;\n\n    res[key] = function mappedState () {\n      var state = this.$store.state;\n      var getters = this.$store.getters;\n      if (namespace) {\n        var module = getModuleByNamespace(this.$store, \x27mapState\x27, namespace);\n        if (!module) {\n          return\n        }\n        state = module.context.state;\n        getters = module.context.getters;\n      }\n      return typeof val === \x27function\x27\n        ? val.call(this, state, getters)\n        : state[val]\n    };\n    \/\/ mark vuex getter for devtools\n    res[key].vuex = true;\n  });\n  return res\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3efunction (namespace, states) {\n  var res = {};\n  normalizeMap(states).\x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3eEach(function (ref) {\n    var key = ref.key;\n    var val = ref.val;\n\n    res[key] = function mappedState () {\n      var \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e = this.\x3cspan class=\x22hljs-variable\x22\x3e$store\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e;\n      var getters = this.\x3cspan class=\x22hljs-variable\x22\x3e$store\x3c\/span\x3e.getters;\n      if (namespace) {\n        var module = getModuleByNamespace(this.\x3cspan class=\x22hljs-variable\x22\x3e$store\x3c\/span\x3e, \x27mapState\x27, namespace);\n        if (!module) {\n          return\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e = module.context.\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e;\n        getters = module.context.getters;\n      }\n      return typeof val === \x27function\x27\n        ? val.call(this, \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e, getters)\n        : \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e[val]\n    };\n    \/\/ mark vuex getter \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e devtools\n    res[key].vuex = true;\n  });\n  return res\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e粗略来看，这个函数会重新定义map对象的key-value对，并作为一个新的对象返回。我们来进一步具体分析一下。\x3c\/p\x3e\n\x3cp\x3e该函数首先调用normalizeMap函数对state参数进行归一化\/规范化。normalizeMap函数定义在VUEX源码的899 ~ 903行，我们来具体看看它的实现：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function normalizeMap (map) {\n  return Array.isArray(map)\n    ? map.map(function (key) { return ({ key: key, val: key }); })\n    : Object.keys(map).map(function (key) { return ({ key: key, val: map[key] }); })\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs processing\x22\x3e\x3ccode\x3efunction normalizeMap (\x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e) {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eArray\x3c\/span\x3e.isArray(\x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e)\n    ? \x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e.\x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e(function (\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e) { \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e ({ \x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e, val: \x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e }); })\n    : \x3cspan class=\x22hljs-keyword\x22\x3eObject\x3c\/span\x3e.keys(\x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e).\x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e(function (\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e) { \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e ({ \x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e, val: \x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e[\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e] }); })\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e该函数实际上意味着mapState函数的map参数同时支持数组和对象两种形式。\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e如果是数组，则会遍历数组元素，将数组元素转成{value: value}对象。\x3c\/li\x3e\n\x3cli\x3e如果是对象，则会遍历对象key，以key-value构成{key: value}对象。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e这两种形式最终都会得到一个新数组，而数组元素就是{key: value}形式的对象。\x3c\/p\x3e\n\x3cp\x3e这也与官方文档的描述相印证，官方文档的既提供了mapState函数的map参数是对象的例子，也提供了参数是数组的例子。\x3c\/p\x3e\n\x3cp\x3e回过头来看，normalizeMap(states)函数执行完后会遍历，针对每一个对象元素的value做进一步的处理。它首先拿的是根实例上挂载的store模块的state：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var state = this.$store.state;\nvar getters = this.$store.getters;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3evar \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e = this.\x3cspan class=\x22hljs-variable\x22\x3e$store\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e;\nvar getters = this.\x3cspan class=\x22hljs-variable\x22\x3e$store\x3c\/span\x3e.getters;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e而如果mapState函数提供了命名空间参数（即模块名），则会拿带命名空间模块的state:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (namespace) {\n  var module = getModuleByNamespace(this.$store, \x27mapState\x27, namespace);\n  if (!module) {\n    return\n  }\n  state = module.context.state;\n  getters = module.context.getters;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs arduino\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e) {\n  var \x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e = getModuleByNamespace(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store, \x3cspan class=\x22hljs-string\x22\x3e\x27mapState\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-built_in\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-built_in\x22\x3ereturn\x3c\/span\x3e\n  }\n  state = \x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e.context.state;\n  getters = \x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e.context.getters;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这其中会调用一个从根store开始，向下查找对应命名空间模块的方法getModuleByNamespace，它定义在VUEX源码的917 ~ 923 行：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function getModuleByNamespace (store, helper, namespace) {\n  var module = store._modulesNamespaceMap[namespace];\n  if (\x26quot;development\x26quot; !== \x27production\x27 \x26amp;\x26amp; !module) {\n    console.error((\x26quot;[vuex] module namespace not found in \x26quot; \x2b helper \x2b \x26quot;(): \x26quot; \x2b namespace));\n  }\n  return module\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetModuleByNamespace\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3estore, helper, namespace\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e = store._modulesNamespaceMap[namespace];\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x22development\x22\x3c\/span\x3e !== \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e \x26amp;\x26amp; !\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error((\x3cspan class=\x22hljs-string\x22\x3e\x22[vuex] module namespace not found in \x22\x3c\/span\x3e \x2b helper \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22(): \x22\x3c\/span\x3e \x2b namespace));\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e因为我们在实例化Store类的时候已经把所有模块以namespace的为key的形式挂载在了根store实例的_modulesNamespaceMap属性上，所以这个查询过程只是一个对象key的查找过程，实现起来比较简单。\x3c\/p\x3e\n\x3cp\x3e回过头来继续看mapState函数中“\x3ccode\x3enormalizeMap(states)函数执行完后会遍历，针对每一个对象元素的value做进一步的处理\x3c\/code\x3e”的最后的执行，它会根据原始的value是否是function而进一步处理：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e如果是不是function，则直接拿对应模块的state中key对应的value。\x3c\/li\x3e\n\x3cli\x3e如果是function，那么将会执行该function，并且会将state, getters分别暴露给该function作为第一个和第二个参数。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e第二种情况在前述官方文档的例子中也有所体现：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 为了能够使用 `this` 获取局部状态，必须使用常规函数\ncountPlusLocalState (state) {\n  return state.count \x2b this.localCount\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3e\/\/ 为了能够使用 `this` 获取局部状态，必须使用常规函数\ncountPlusLocalState (\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e) {\n  return \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.count \x2b this.localCount\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e但这个官方文档例子并不完整，它并没有体现出还会暴露出getters参数\x3c\/strong\x3e，实际上，上述例子的完整形式应该是这样子的：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 为了能够使用 `this` 获取局部状态，必须使用常规函数\ncountPlusLocalState (state, getters) {\n  return state.count \x2b this.localCount \x2b getters.somegetter\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3e\/\/ 为了能够使用 `this` 获取局部状态，必须使用常规函数\ncountPlusLocalState (\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e, getters) {\n  return \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.count \x2b this.localCount \x2b getters.somegetter\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e5.1.2 mapMutations\x3c\/h3\x3e\n\x3cp\x3e与mapState可以映射模块的state为计算属性类似，mapMutations也可以将模块的mutations映射为methods，我们来看看官方文档的介绍：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { mapMutations } from \x27vuex\x27\n\nexport default {\n  \/\/ ...\n  methods: {\n    ...mapMutations([\n      \/\/ 将 `this.increment()` 映射为 `this.$store.commit(\x27increment\x27)`\n      \x27increment\x27,\n\n      \/\/ `mapMutations` 也支持载荷：\n      \/\/ 将 `this.incrementBy(amount)` 映射为 `this.$store.commit(\x27incrementBy\x27, amount)`\n      \x27incrementBy\x27 \n    ]),\n    ...mapMutations({\n      add: \x27increment\x27 \/\/ 将 `this.add()` 映射为 `this.$store.commit(\x27increment\x27)`\n    })\n  }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { mapMutations } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vuex\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e ...\n  methods: {\n    ...mapMutations([\n      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.increment()\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.commit(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e)\x3c\/span\x3e`\n      \x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e,\n\n      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e `\x3cspan class=\x22javascript\x22\x3emapMutations\x3c\/span\x3e` 也支持载荷：\n      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.incrementBy(amount)\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.commit(\x3cspan class=\x22hljs-string\x22\x3e\x27incrementBy\x27\x3c\/span\x3e, amount)\x3c\/span\x3e`\n      \x3cspan class=\x22hljs-string\x22\x3e\x27incrementBy\x27\x3c\/span\x3e \n    ]),\n    ...mapMutations({\n      add: \x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.add()\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.commit(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e)\x3c\/span\x3e`\n    })\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e同样我们来看看它是如何实现的，它的实现定义在VUEX源码中的817 ~ 841 行：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var mapMutations = normalizeNamespace(function (namespace, mutations) {\n  var res = {};\n  normalizeMap(mutations).forEach(function (ref) {\n    var key = ref.key;\n    var val = ref.val;\n\n    res[key] = function mappedMutation () {\n      var args = [], len = arguments.length;\n      while ( len-- ) args[ len ] = arguments[ len ];\n\n      var commit = this.$store.commit;\n      if (namespace) {\n        var module = getModuleByNamespace(this.$store, \x27mapMutations\x27, namespace);\n        if (!module) {\n          return\n        }\n        commit = module.context.commit;\n      }\n      return typeof val === \x27function\x27\n        ? val.apply(this, [commit].concat(args))\n        : commit.apply(this.$store, [val].concat(args))\n    };\n  });\n  return res\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e mapMutations = normalizeNamespace(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3enamespace, mutations\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e res = {};\n  normalizeMap(mutations).forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eref\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e key = ref.key;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e val = ref.val;\n\n    res[key] = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emappedMutation\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e args = [], len = \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e.length;\n      \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e ( len-- ) args[ len ] = \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e[ len ];\n\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e commit = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.commit;\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (namespace) {\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e = getModuleByNamespace(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store, \x3cspan class=\x22hljs-string\x22\x3e\x27mapMutations\x27\x3c\/span\x3e, namespace);\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e) {\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n        }\n        commit = \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.context.commit;\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e val === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e\n        ? val.apply(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, [commit].concat(args))\n        : commit.apply(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store, [val].concat(args))\n    };\n  });\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e res\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e和mapState的实现几乎完全一样，唯一的差别只有两点：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e提交mutaion时可以传递载荷，所以这里有一步是拷贝载荷。\x3c\/li\x3e\n\x3cli\x3emutation是用来提交的，所以这里拿的是commit。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e我们来具体分析一下代码的执行：\x3c\/p\x3e\n\x3cp\x3e首先是拷贝载荷：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var args = [], len = arguments.length;\nwhile ( len-- ) args[ len ] = arguments[ len ];\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs excel\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e args = [], \x3cspan class=\x22hljs-built_in\x22\x3elen\x3c\/span\x3e = arguments.length;\nwhile ( \x3cspan class=\x22hljs-built_in\x22\x3elen\x3c\/span\x3e-- ) args[ \x3cspan class=\x22hljs-built_in\x22\x3elen\x3c\/span\x3e ] = arguments[ \x3cspan class=\x22hljs-built_in\x22\x3elen\x3c\/span\x3e ];\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后是拿commit，如果mapMutations函数提供了命名空间参数（即模块名），则会拿带命名空间模块的commit:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var commit = this.$store.commit;\nif (namespace) {\n  var module = getModuleByNamespace(this.$store, \x27mapMutations\x27, namespace);\n  if (!module) {\n    return\n  }\n  commit = module.context.commit;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs arduino\x22\x3e\x3ccode\x3evar commit = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.commit;\n\x3cspan class=\x22hljs-built_in\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e) {\n  var \x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e = getModuleByNamespace(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store, \x3cspan class=\x22hljs-string\x22\x3e\x27mapMutations\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-built_in\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-built_in\x22\x3ereturn\x3c\/span\x3e\n  }\n  commit = \x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e.context.commit;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最后则会看对应mutation的value是不是函数：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e如果不是函数，则直接执行commit，参数是value和载荷组成的数组。\x3c\/li\x3e\n\x3cli\x3e如果是函数，则直接执行该函数，并将comit作为其第一个参数，arg仍然作为后续参数。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e也就是说，\x3cstrong\x3e官方文档例子并不完整，它并没有体现第二种情况\x3c\/strong\x3e，实际上，官方文档例子的完整形式还应当包括：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { mapMutations } from \x27vuex\x27\n\nexport default {\n  \/\/ ...\n  methods: {\n    ...mapMutations(\x27moduleName\x27, {\n       addAlias: function(commit, playload) {\n           \/\/将 `this.addAlias()` 映射为 `this.$store.commit(\x27increment\x27, amount)`\n           commit(\x27increment\x27) \n           \/\/将 `this.addAlias(playload)` 映射为 `this.$store.commit(\x27increment\x27, playload)`\n           commit(\x27increment\x27, playload)\n       }\n     })\n  }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { mapMutations } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vuex\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e ...\n  methods: {\n    ...mapMutations(\x3cspan class=\x22hljs-string\x22\x3e\x27moduleName\x27\x3c\/span\x3e, {\n       addAlias: function(commit, playload) {\n           \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.addAlias()\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.commit(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e, amount)\x3c\/span\x3e`\n           commit(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e) \n           \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.addAlias(playload)\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.commit(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e, playload)\x3c\/span\x3e`\n           commit(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e, playload)\n       }\n     })\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e同样，mapMutations上述映射方式都支持传递一个模块名作为命名空间参数，这个在官方文档也没有体现：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { mapMutations } from \x27vuex\x27\n\nexport default {\n  \/\/ ...\n  methods: {\n    ...mapMutations(\x27moduleName\x27, [\n      \/\/ 将 `this.increment()` 映射为 `this.$store.commit(\x27increment\x27)`\n      \x27increment\x27,\n\n      \/\/ `mapMutations` 也支持载荷：\n      \/\/ 将 `this.incrementBy(amount)` 映射为 `this.$store.commit(\x27incrementBy\x27, amount)`\n      \x27incrementBy\x27 \n    ]),\n    ...mapMutations(\x27moduleName\x27, {\n      \/\/ 将 `this.add()` 映射为 `this.$store.commit(\x27increment\x27)`\n      add: \x27increment\x27 \n    }),\n    ...mapMutations(\x27moduleName\x27, {\n      addAlias: function(commit) {\n          \/\/将 `this.addAlias()` 映射为 `this.$store.commit(\x27increment\x27)`\n          commit(\x27increment\x27) \n      }\n    })\n  }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { mapMutations } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vuex\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e ...\n  methods: {\n    ...mapMutations(\x3cspan class=\x22hljs-string\x22\x3e\x27moduleName\x27\x3c\/span\x3e, [\n      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.increment()\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.commit(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e)\x3c\/span\x3e`\n      \x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e,\n\n      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e `\x3cspan class=\x22javascript\x22\x3emapMutations\x3c\/span\x3e` 也支持载荷：\n      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.incrementBy(amount)\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.commit(\x3cspan class=\x22hljs-string\x22\x3e\x27incrementBy\x27\x3c\/span\x3e, amount)\x3c\/span\x3e`\n      \x3cspan class=\x22hljs-string\x22\x3e\x27incrementBy\x27\x3c\/span\x3e \n    ]),\n    ...mapMutations(\x3cspan class=\x22hljs-string\x22\x3e\x27moduleName\x27\x3c\/span\x3e, {\n      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.add()\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.commit(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e)\x3c\/span\x3e`\n      add: \x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e \n    }),\n    ...mapMutations(\x3cspan class=\x22hljs-string\x22\x3e\x27moduleName\x27\x3c\/span\x3e, {\n      addAlias: function(commit) {\n          \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.addAlias()\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.commit(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e)\x3c\/span\x3e`\n          commit(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e) \n      }\n    })\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们可以举个例子证明一下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const moduleA = {\n  namespaced: true,\n  state: { source: \x27moduleA\x27 },\n  mutations: {\n    increment (state, playload) {\n      \/\/ 这里的 `state` 对象是模块的局部状态\n      state.source \x2b= playload\n    }\n  }\n}\nconst store = new Vuex.Store({\n  state() {\n    return {\n        source: \x27root\x27\n    }\n  },\n  mutations: {\n    increment (state, playload) {\n      state.source \x2b= playload\n    }\n  },\n  modules: {\n    a: moduleA\n  }\n})\nvar vm = new Vue({\n  el: \x27#example\x27,\n  store,\n  mounted() {\n    console.log(this.source)\n    this.localeincrement(\x27testdata\x27)\n    console.log(this.source)\n  },\n    computed: Vuex.mapState([\n      \x27source\x27\n    ]\n  ),\n  methods: {\n    ...Vuex.mapMutations({\n      localeincrement (commit, args) {\n        commit(\x27increment\x27, args)\n      }\n    })\n  }\n})\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3econst moduleA = {\n  namespaced: true,\n  \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e: { source: \x27moduleA\x27 },\n  mutations: {\n    increment (\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e, playload) {\n      \/\/ 这里的 `\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e` 对象是模块的局部状态\n      \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.source \x2b= playload\n    }\n  }\n}\nconst store = new Vuex.Store({\n  \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e() {\n    return {\n        source: \x27root\x27\n    }\n  },\n  mutations: {\n    increment (\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e, playload) {\n      \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.source \x2b= playload\n    }\n  },\n  modules: {\n    a: moduleA\n  }\n})\nvar vm = new Vue({\n  el: \x27\x3cspan class=\x22hljs-comment\x22\x3e#example\x27,\x3c\/span\x3e\n  store,\n  mounted() {\n    console.\x3cspan class=\x22hljs-keyword\x22\x3elog\x3c\/span\x3e(this.source)\n    this.localeincrement(\x27testdata\x27)\n    console.\x3cspan class=\x22hljs-keyword\x22\x3elog\x3c\/span\x3e(this.source)\n  },\n    computed: Vuex.mapState([\n      \x27source\x27\n    ]\n  ),\n  methods: {\n    ...Vuex.mapMutations({\n      localeincrement (commit, args) {\n        commit(\x27increment\x27, args)\n      }\n    })\n  }\n})\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e输出结果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22root\ntest.html:139 roottestdata\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3eroot\x3c\/span\x3e\n\x3cspan class=\x22hljs-selector-tag\x22\x3etest\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.html\x3c\/span\x3e\x3cspan class=\x22hljs-selector-pseudo\x22\x3e:139\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3eroottestdata\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e另外一个例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const moduleA = {\n  namespaced: true,\n  state: { source: \x27moduleA\x27 },\n  mutations: {\n    increment (state, playload) {\n      \/\/ 这里的 `state` 对象是模块的局部状态\n      state.source \x2b= playload\n    }\n  }\n}\nconst store = new Vuex.Store({\n  state() {\n    return {\n        source: \x27root\x27\n    }\n  },\n  mutations: {\n    increment (state, playload) {\n      state.source \x2b= playload\n    }\n  },\n  modules: {\n    a: moduleA\n  }\n})\nvar vm = new Vue({\n  el: \x27#example\x27,\n  store,\n  mounted() {\n    console.log(this.source)\n    this.localeincrement(\x27testdata\x27)\n    console.log(this.source)\n  },\n    computed: Vuex.mapState(\x27a\x27, [\n      \x27source\x27\n    ]\n  ),\n  methods: {\n    ...Vuex.mapMutations(\x27a\x27, {\n      localeincrement (commit, args) {\n        commit(\x27increment\x27, args)\n      }\n    })\n  }\n})\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3econst moduleA = {\n  namespaced: true,\n  \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e: { source: \x27moduleA\x27 },\n  mutations: {\n    increment (\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e, playload) {\n      \/\/ 这里的 `\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e` 对象是模块的局部状态\n      \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.source \x2b= playload\n    }\n  }\n}\nconst store = new Vuex.Store({\n  \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e() {\n    return {\n        source: \x27root\x27\n    }\n  },\n  mutations: {\n    increment (\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e, playload) {\n      \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.source \x2b= playload\n    }\n  },\n  modules: {\n    a: moduleA\n  }\n})\nvar vm = new Vue({\n  el: \x27\x3cspan class=\x22hljs-comment\x22\x3e#example\x27,\x3c\/span\x3e\n  store,\n  mounted() {\n    console.\x3cspan class=\x22hljs-keyword\x22\x3elog\x3c\/span\x3e(this.source)\n    this.localeincrement(\x27testdata\x27)\n    console.\x3cspan class=\x22hljs-keyword\x22\x3elog\x3c\/span\x3e(this.source)\n  },\n    computed: Vuex.mapState(\x27a\x27, [\n      \x27source\x27\n    ]\n  ),\n  methods: {\n    ...Vuex.mapMutations(\x27a\x27, {\n      localeincrement (commit, args) {\n        commit(\x27increment\x27, args)\n      }\n    })\n  }\n})\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e输出结果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22moduleA\ntest.html:139 moduleAtestdata\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3emoduleA\x3c\/span\x3e\n\x3cspan class=\x22hljs-selector-tag\x22\x3etest\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.html\x3c\/span\x3e\x3cspan class=\x22hljs-selector-pseudo\x22\x3e:139\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3emoduleAtestdata\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e5.1.3 mapGetters\x3c\/h3\x3e\n\x3cp\x3e与mapState可以映射模块的state为计算属性类似，mapGetters也可以将模块的getters映射为计算属性，我们来看看官方文档的介绍：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVW7KO?w=777\x26amp;h=605\x22 src=\x22https:\/\/static.alili.tech\/img\/bVW7KO?w=777\x26amp;h=605\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3emapGetters辅助函数定义在VUEX源码中的843 ~ 864 行，我们来看看它的源码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var mapGetters = normalizeNamespace(function (namespace, getters) {\n  var res = {};\n  normalizeMap(getters).forEach(function (ref) {\n    var key = ref.key;\n    var val = ref.val;\n\n    val = namespace \x2b val;\n    res[key] = function mappedGetter () {\n      if (namespace \x26amp;\x26amp; !getModuleByNamespace(this.$store, \x27mapGetters\x27, namespace)) {\n        return\n      }\n      if (\x26quot;development\x26quot; !== \x27production\x27 \x26amp;\x26amp; !(val in this.$store.getters)) {\n        console.error((\x26quot;[vuex] unknown getter: \x26quot; \x2b val));\n        return\n      }\n      return this.$store.getters[val]\n    };\n    \/\/ mark vuex getter for devtools\n    res[key].vuex = true;\n  });\n  return res\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e mapGetters = normalizeNamespace(function (namespace, getters) {\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e res = {};\n  normalizeMap(getters).forEach(function (ref) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e key = ref.key;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e = ref.\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e;\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e = namespace \x2b \x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e;\n    res[key] = function mappedGetter () {\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (namespace \x26amp;\x26amp; !getModuleByNamespace(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store, \x3cspan class=\x22hljs-string\x22\x3e\x27mapGetters\x27\x3c\/span\x3e, namespace)) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x22development\x22\x3c\/span\x3e !== \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e \x26amp;\x26amp; !(\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.getters)) {\n        console.error((\x3cspan class=\x22hljs-string\x22\x3e\x22[vuex] unknown getter: \x22\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e));\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.getters[\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e]\n    };\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ mark vuex getter for devtools\x3c\/span\x3e\n    res[key].vuex = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n  });\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e res\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e和mapState的实现几乎完全一样，唯一的差别只有1点：就是最后不会出现value为函数的情况。直接拿的是对应模块上的getters:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22return this.$store.getters[val]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.getters[\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e]\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e5.1.4 mapActions\x3c\/h3\x3e\n\x3cp\x3e与mapMutations可以映射模块的mutation为methods类似，mapActions也可以将模块的actions映射为methods，我们来看看官方文档的介绍：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { mapActions } from \x27vuex\x27\n\nexport default {\n  \/\/ ...\n  methods: {\n    ...mapActions([\n      \/\/ 将 `this.increment()` 映射为 `this.$store.dispatch(\x27increment\x27)`\n      \x27increment\x27,\n\n      \/\/ `mapActions` 也支持载荷：\n      \/\/ 将 `this.incrementBy(amount)` 映射为 `this.$store.dispatch(\x27incrementBy\x27, amount)`\n      \x27incrementBy\x27 \n    ]),\n    ...mapActions({\n      \/\/ 将 `this.add()` 映射为 `this.$store.dispatch(\x27increment\x27)`\n      add: \x27increment\x27 \n    })\n  }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { mapActions } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vuex\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e ...\n  methods: {\n    ...mapActions([\n      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.increment()\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.dispatch(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e)\x3c\/span\x3e`\n      \x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e,\n\n      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e `\x3cspan class=\x22javascript\x22\x3emapActions\x3c\/span\x3e` 也支持载荷：\n      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.incrementBy(amount)\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.dispatch(\x3cspan class=\x22hljs-string\x22\x3e\x27incrementBy\x27\x3c\/span\x3e, amount)\x3c\/span\x3e`\n      \x3cspan class=\x22hljs-string\x22\x3e\x27incrementBy\x27\x3c\/span\x3e \n    ]),\n    ...mapActions({\n      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.add()\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.dispatch(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e)\x3c\/span\x3e`\n      add: \x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e \n    })\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e同样我们来看看它是如何实现的，它的实现定义在VUEX源码中的866 ~ 890 行：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var mapActions = normalizeNamespace(function (namespace, actions) {\n  var res = {};\n  normalizeMap(actions).forEach(function (ref) {\n    var key = ref.key;\n    var val = ref.val;\n\n    res[key] = function mappedAction () {\n      var args = [], len = arguments.length;\n      while ( len-- ) args[ len ] = arguments[ len ];\n\n      var dispatch = this.$store.dispatch;\n      if (namespace) {\n        var module = getModuleByNamespace(this.$store, \x27mapActions\x27, namespace);\n        if (!module) {\n          return\n        }\n        dispatch = module.context.dispatch;\n      }\n      return typeof val === \x27function\x27\n        ? val.apply(this, [dispatch].concat(args))\n        : dispatch.apply(this.$store, [val].concat(args))\n    };\n  });\n  return res\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e mapActions = normalizeNamespace(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3enamespace, actions\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e res = {};\n  normalizeMap(actions).forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eref\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e key = ref.key;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e val = ref.val;\n\n    res[key] = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emappedAction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e args = [], len = \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e.length;\n      \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e ( len-- ) args[ len ] = \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e[ len ];\n\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e dispatch = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.dispatch;\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (namespace) {\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e = getModuleByNamespace(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store, \x3cspan class=\x22hljs-string\x22\x3e\x27mapActions\x27\x3c\/span\x3e, namespace);\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e) {\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n        }\n        dispatch = \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.context.dispatch;\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e val === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e\n        ? val.apply(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, [dispatch].concat(args))\n        : dispatch.apply(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store, [val].concat(args))\n    };\n  });\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e res\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e和mapMutations的实现几乎完全一样，唯一的差别只有1点：\x3c\/p\x3e\n\x3col\x3e\x3cli\x3eaction是用来分派的，所以这里拿的是dispatch。\x3c\/li\x3e\x3c\/ol\x3e\n\x3cp\x3e我们来具体分析一下代码的执行：\x3c\/p\x3e\n\x3cp\x3e首先是拷贝载荷：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var args = [], len = arguments.length;\nwhile ( len-- ) args[ len ] = arguments[ len ];\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs excel\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e args = [], \x3cspan class=\x22hljs-built_in\x22\x3elen\x3c\/span\x3e = arguments.length;\nwhile ( \x3cspan class=\x22hljs-built_in\x22\x3elen\x3c\/span\x3e-- ) args[ \x3cspan class=\x22hljs-built_in\x22\x3elen\x3c\/span\x3e ] = arguments[ \x3cspan class=\x22hljs-built_in\x22\x3elen\x3c\/span\x3e ];\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后是拿dispatch，如果mapActions函数提供了命名空间参数（即模块名），则会拿带命名空间模块的dispatch:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var dispatch = this.$store.dispatch;\nif (namespace) {\n  var module = getModuleByNamespace(this.$store, \x27mapActions\x27, namespace);\n  if (!module) {\n    return\n  }\n  dispatch = module.context.dispatch;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs arduino\x22\x3e\x3ccode\x3evar dispatch = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.dispatch;\n\x3cspan class=\x22hljs-built_in\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e) {\n  var \x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e = getModuleByNamespace(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store, \x3cspan class=\x22hljs-string\x22\x3e\x27mapActions\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-built_in\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-built_in\x22\x3ereturn\x3c\/span\x3e\n  }\n  dispatch = \x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e.context.dispatch;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最后则会看对应action的value是不是函数：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e如果不是函数，则直接执行dispatch，参数是value和载荷组成的数组。\x3c\/li\x3e\n\x3cli\x3e如果是函数，则直接执行该函数，并将dispatch作为其第一个参数，arg仍然作为后续参数。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e也就是说，\x3cstrong\x3e官方文档例子并不完整，它并没有体现第二种情况\x3c\/strong\x3e，实际上，官方文档例子的完整形式还应当包括：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { mapActions } from \x27vuex\x27\n\nexport default {\n  \/\/ ...\n  methods: {\n    ...mapActions (\x27moduleName\x27, {\n       addAlias: function(dispatch, playload) {\n           \/\/将 `this.addAlias()` 映射为 `this.$store.dispatch(\x27increment\x27, amount)`\n           dispatch(\x27increment\x27) \n           \/\/将 `this.addAlias(playload)` 映射为 `this.$store.dispatch(\x27increment\x27, playload)`\n           dispatch(\x27increment\x27, playload)\n       }\n     })\n  }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { mapActions } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vuex\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e ...\n  methods: {\n    ...mapActions (\x3cspan class=\x22hljs-string\x22\x3e\x27moduleName\x27\x3c\/span\x3e, {\n       addAlias: function(dispatch, playload) {\n           \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.addAlias()\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.dispatch(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e, amount)\x3c\/span\x3e`\n           dispatch(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e) \n           \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.addAlias(playload)\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.dispatch(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e, playload)\x3c\/span\x3e`\n           dispatch(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e, playload)\n       }\n     })\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e同样，mapActions上述映射方式都支持传递一个模块名作为命名空间参数，这个在官方文档也没有体现：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { mapActions } from \x27vuex\x27\n\nexport default {\n  \/\/ ...\n  methods: {\n    ...mapActions(\x27moduleName\x27, [\n      \/\/ 将 `this.increment()` 映射为 `this.$store.dispatch(\x27increment\x27)`\n      \x27increment\x27, \n\n      \/\/ `mapActions` 也支持载荷：\n      \/\/ 将 `this.incrementBy(amount)` 映射为 `this.$store.dispatch(\x27incrementBy\x27, amount)`\n      \x27incrementBy\x27 \n    ]),\n    ...mapActions(\x27moduleName\x27, {\n      \/\/ 将 `this.add()` 映射为 `this.$store.dispatch(\x27increment\x27)`\n      add: \x27increment\x27 \n    }),\n    ...mapActions(\x27moduleName\x27, {\n      addAlias: function (dispatch) {\n        \/\/ 将 `this.addAlias()` 映射为 `this.$store.dispatch(\x27increment\x27)`\n        dispatch(\x27increment\x27) \n      }\n    })\n  }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { mapActions } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vuex\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e ...\n  methods: {\n    ...mapActions(\x3cspan class=\x22hljs-string\x22\x3e\x27moduleName\x27\x3c\/span\x3e, [\n      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.increment()\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.dispatch(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e)\x3c\/span\x3e`\n      \x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e, \n\n      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e `\x3cspan class=\x22javascript\x22\x3emapActions\x3c\/span\x3e` 也支持载荷：\n      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.incrementBy(amount)\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.dispatch(\x3cspan class=\x22hljs-string\x22\x3e\x27incrementBy\x27\x3c\/span\x3e, amount)\x3c\/span\x3e`\n      \x3cspan class=\x22hljs-string\x22\x3e\x27incrementBy\x27\x3c\/span\x3e \n    ]),\n    ...mapActions(\x3cspan class=\x22hljs-string\x22\x3e\x27moduleName\x27\x3c\/span\x3e, {\n      \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.add()\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.dispatch(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e)\x3c\/span\x3e`\n      add: \x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e \n    }),\n    ...mapActions(\x3cspan class=\x22hljs-string\x22\x3e\x27moduleName\x27\x3c\/span\x3e, {\n      addAlias: function (dispatch) {\n        \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 将 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.addAlias()\x3c\/span\x3e` 映射为 `\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.dispatch(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e)\x3c\/span\x3e`\n        dispatch(\x3cspan class=\x22hljs-string\x22\x3e\x27increment\x27\x3c\/span\x3e) \n      }\n    })\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们可以举个例子证明一下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const moduleA = {\n  namespaced: true,\n  state: { source: \x27moduleA\x27 },\n  mutations: {\n    increment (state, playload) {\n      \/\/ 这里的 `state` 对象是模块的局部状态\n      state.source \x2b= playload\n    }\n  },\n  actions: {\n    increment (context) {\n      context.commit(\x27increment\x27, \x27testdata\x27)\n    }\n  }\n}\nconst store = new Vuex.Store({\n  state() {\n    return {\n        source: \x27root\x27\n    }\n  },\n  mutations: {\n    increment (state, playload) {\n      state.source \x2b= playload\n    }\n  },\n  actions: {\n    increment (context) {\n      context.commit(\x27increment\x27, \x27testdata\x27)\n    }\n  },\n  modules: {\n    a: moduleA\n  }\n})\nvar vm = new Vue({\n  el: \x27#example\x27,\n  store,\n  mounted() {\n    console.log(this.source)\n    this.localeincrement()\n    console.log(this.source)\n  },\n    computed: Vuex.mapState([\n      \x27source\x27\n    ]\n  ),\n  methods: {\n    ...Vuex.mapActions( {\n      localeincrement (dispatch) {\n        dispatch(\x27increment\x27)\n      }\n    })\n  }\n})\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3econst moduleA = {\n  namespaced: true,\n  \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e: { source: \x27moduleA\x27 },\n  mutations: {\n    increment (\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e, playload) {\n      \/\/ 这里的 `\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e` 对象是模块的局部状态\n      \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.source \x2b= playload\n    }\n  },\n  actions: {\n    increment (context) {\n      context.commit(\x27increment\x27, \x27testdata\x27)\n    }\n  }\n}\nconst store = new Vuex.Store({\n  \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e() {\n    return {\n        source: \x27root\x27\n    }\n  },\n  mutations: {\n    increment (\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e, playload) {\n      \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.source \x2b= playload\n    }\n  },\n  actions: {\n    increment (context) {\n      context.commit(\x27increment\x27, \x27testdata\x27)\n    }\n  },\n  modules: {\n    a: moduleA\n  }\n})\nvar vm = new Vue({\n  el: \x27\x3cspan class=\x22hljs-comment\x22\x3e#example\x27,\x3c\/span\x3e\n  store,\n  mounted() {\n    console.\x3cspan class=\x22hljs-keyword\x22\x3elog\x3c\/span\x3e(this.source)\n    this.localeincrement()\n    console.\x3cspan class=\x22hljs-keyword\x22\x3elog\x3c\/span\x3e(this.source)\n  },\n    computed: Vuex.mapState([\n      \x27source\x27\n    ]\n  ),\n  methods: {\n    ...Vuex.mapActions( {\n      localeincrement (dispatch) {\n        dispatch(\x27increment\x27)\n      }\n    })\n  }\n})\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e输出结果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22root\nroottestdata\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ebnf\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attribute\x22\x3eroot\nroottestdata\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e另外一个例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const moduleA = {\n  namespaced: true,\n  state: { source: \x27moduleA\x27 },\n  mutations: {\n    increment (state, playload) {\n      \/\/ 这里的 `state` 对象是模块的局部状态\n      state.source \x2b= playload\n    }\n  },\n  actions: {\n    increment (context) {\n      context.commit(\x27increment\x27, \x27testdata\x27)\n    }\n  }\n}\nconst store = new Vuex.Store({\n  state() {\n    return {\n        source: \x27root\x27\n    }\n  },\n  mutations: {\n    increment (state, playload) {\n      state.source \x2b= playload\n    }\n  },\n  actions: {\n    increment (context) {\n      context.commit(\x27increment\x27, \x27testdata\x27)\n    }\n  },\n  modules: {\n    a: moduleA\n  }\n})\nvar vm = new Vue({\n  el: \x27#example\x27,\n  store,\n  mounted() {\n    console.log(this.source)\n    this.localeincrement()\n    console.log(this.source)\n  },\n    computed: Vuex.mapState(\x27a\x27, [\n      \x27source\x27\n    ]\n  ),\n  methods: {\n    ...Vuex.mapActions(\x27a\x27, {\n      localeincrement (dispatch) {\n        dispatch(\x27increment\x27)\n      }\n    })\n  }\n})\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3econst moduleA = {\n  namespaced: true,\n  \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e: { source: \x27moduleA\x27 },\n  mutations: {\n    increment (\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e, playload) {\n      \/\/ 这里的 `\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e` 对象是模块的局部状态\n      \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.source \x2b= playload\n    }\n  },\n  actions: {\n    increment (context) {\n      context.commit(\x27increment\x27, \x27testdata\x27)\n    }\n  }\n}\nconst store = new Vuex.Store({\n  \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e() {\n    return {\n        source: \x27root\x27\n    }\n  },\n  mutations: {\n    increment (\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e, playload) {\n      \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.source \x2b= playload\n    }\n  },\n  actions: {\n    increment (context) {\n      context.commit(\x27increment\x27, \x27testdata\x27)\n    }\n  },\n  modules: {\n    a: moduleA\n  }\n})\nvar vm = new Vue({\n  el: \x27\x3cspan class=\x22hljs-comment\x22\x3e#example\x27,\x3c\/span\x3e\n  store,\n  mounted() {\n    console.\x3cspan class=\x22hljs-keyword\x22\x3elog\x3c\/span\x3e(this.source)\n    this.localeincrement()\n    console.\x3cspan class=\x22hljs-keyword\x22\x3elog\x3c\/span\x3e(this.source)\n  },\n    computed: Vuex.mapState(\x27a\x27, [\n      \x27source\x27\n    ]\n  ),\n  methods: {\n    ...Vuex.mapActions(\x27a\x27, {\n      localeincrement (dispatch) {\n        dispatch(\x27increment\x27)\n      }\n    })\n  }\n})\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e输出结果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22moduleA\nmoduleAtestdata\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ebnf\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attribute\x22\x3emoduleA\nmoduleAtestdata\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e5.1.5 createNamespacedHelpers\x3c\/h3\x3e\n\x3cp\x3ecreateNamespacedHelpers主要是根据传递的命名空间产生对应模块的局部化mapState、mapGetters、mapMutations、mapActions映射函数，它定义在VUEX源码的892 ~ 897行：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var createNamespacedHelpers = function (namespace) { return ({\n  mapState: mapState.bind(null, namespace),\n  mapGetters: mapGetters.bind(null, namespace),\n  mapMutations: mapMutations.bind(null, namespace),\n  mapActions: mapActions.bind(null, namespace)\n}); };\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e createNamespacedHelpers = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(namespace)\x3c\/span\x3e \x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e ({\n  mapState: mapState.bind(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e),\n  mapGetters: mapGetters.bind(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e),\n  mapMutations: mapMutations.bind(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e),\n  mapActions: mapActions.bind(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3enamespace\x3c\/span\x3e)\n}); };\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e5.2 其它辅助函数\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e5.2.1 isObject\x3c\/h3\x3e\n\x3cp\x3eisObject定义在VUEX源码的94 ~ 96 行，主要判断目标是否是有效对象，其实现比较简单：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/判断是不是object\nfunction isObject (obj) {\n  return obj !== null \x26amp;\x26amp; typeof obj === \x27object\x27\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/判断是不是object\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eisObject\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(obj)\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e obj !== \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e \x26amp;\x26amp; \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e obj === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e5.2.2 isPromise\x3c\/h3\x3e\n\x3cp\x3eisPromise定义在VUEX源码的98 ~ 100 行，主要判断目标是否是promise，其实现比较简单：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function isPromise (val) {\n  return val \x26amp;\x26amp; typeof val.then === \x27function\x27\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eisPromise\x3c\/span\x3e (val) {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eval\x3c\/span\x3e \x26amp;\x26amp; typeof val.\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e === \x3cspan class=\x22hljs-symbol\x22\x3e\x27function\x3c\/span\x3e\x27\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e5.2.3 assert\x3c\/h3\x3e\n\x3cp\x3eassert定义在VUEX源码的102 ~ 104 行，主要用来断言，其实现比较简单：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function assert (condition, msg) {\n  if (!condition) { throw new Error((\x26quot;[vuex] \x26quot; \x2b msg)) }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eassert\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3econdition, msg\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!condition) { \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e((\x3cspan class=\x22hljs-string\x22\x3e\x22[vuex] \x22\x3c\/span\x3e \x2b msg)) }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader11\x22\x3e第六章 总结\x3c\/h1\x3e\n\x3cp\x3e到此这本VUEX学习笔记算是写完了，总体而言是对个人在学习VUEX源码过程中的理解、想法进行的记录和总结，这其中除了不可避免的主观视角外，自然还会存在一些理解上的偏差甚至错误，希望看到这本书的人能够指正。\x3c\/p\x3e\n\x3cp\x3e更多内容可查看\x3ca href=\x22http:\/\/www.dulinrain.top\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e本人博客\x3c\/a\x3e以及\x3ca href=\x22https:\/\/github.com\/DuLinRain\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3egithub\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>VUEX源码学习笔记（第5~6章 共6章）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011668825">https://segmentfault.com/a/1190000011668825</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/219ekj5pf8/" target="_blank">https://alili.tech/archive/219ekj5pf8/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>