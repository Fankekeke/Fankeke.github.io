<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Docker 及 GitLab CI 在前端工作流上的实践分享（一）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Docker 及 GitLab CI 在前端工作流上的实践分享（一） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/2st07fx7663/",
				"appid": "1613049289050283", 
				"title": "Docker 及 GitLab CI 在前端工作流上的实践分享（一） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-29T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/mg85p03nizo/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/rmfl78ohmm/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f2st07fx7663%2f&text=Docker%20%e5%8f%8a%20GitLab%20CI%20%e5%9c%a8%e5%89%8d%e7%ab%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e4%b8%8a%e7%9a%84%e5%ae%9e%e8%b7%b5%e5%88%86%e4%ba%ab%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f2st07fx7663%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f2st07fx7663%2f&text=Docker%20%e5%8f%8a%20GitLab%20CI%20%e5%9c%a8%e5%89%8d%e7%ab%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e4%b8%8a%e7%9a%84%e5%ae%9e%e8%b7%b5%e5%88%86%e4%ba%ab%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f2st07fx7663%2f&title=Docker%20%e5%8f%8a%20GitLab%20CI%20%e5%9c%a8%e5%89%8d%e7%ab%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e4%b8%8a%e7%9a%84%e5%ae%9e%e8%b7%b5%e5%88%86%e4%ba%ab%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f2st07fx7663%2f&is_video=false&description=Docker%20%e5%8f%8a%20GitLab%20CI%20%e5%9c%a8%e5%89%8d%e7%ab%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e4%b8%8a%e7%9a%84%e5%ae%9e%e8%b7%b5%e5%88%86%e4%ba%ab%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Docker%20%e5%8f%8a%20GitLab%20CI%20%e5%9c%a8%e5%89%8d%e7%ab%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e4%b8%8a%e7%9a%84%e5%ae%9e%e8%b7%b5%e5%88%86%e4%ba%ab%ef%bc%88%e4%b8%80%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f2st07fx7663%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f2st07fx7663%2f&title=Docker%20%e5%8f%8a%20GitLab%20CI%20%e5%9c%a8%e5%89%8d%e7%ab%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e4%b8%8a%e7%9a%84%e5%ae%9e%e8%b7%b5%e5%88%86%e4%ba%ab%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f2st07fx7663%2f&title=Docker%20%e5%8f%8a%20GitLab%20CI%20%e5%9c%a8%e5%89%8d%e7%ab%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e4%b8%8a%e7%9a%84%e5%ae%9e%e8%b7%b5%e5%88%86%e4%ba%ab%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f2st07fx7663%2f&title=Docker%20%e5%8f%8a%20GitLab%20CI%20%e5%9c%a8%e5%89%8d%e7%ab%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e4%b8%8a%e7%9a%84%e5%ae%9e%e8%b7%b5%e5%88%86%e4%ba%ab%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f2st07fx7663%2f&title=Docker%20%e5%8f%8a%20GitLab%20CI%20%e5%9c%a8%e5%89%8d%e7%ab%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e4%b8%8a%e7%9a%84%e5%ae%9e%e8%b7%b5%e5%88%86%e4%ba%ab%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Docker 及 GitLab CI 在前端工作流上的实践分享（一）</h1><div class="meta"><div class="postdate"><time datetime="2018-12-29" itemprop="datePublished">2018-12-29</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011553749?w=1100\x26amp;h=225\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011553749?w=1100\x26amp;h=225\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e如今前端工程越来越复杂，打造一个好用的工作流也显得越来越重要。\x3cbr\x3e本文讲分成二个部分，通过简单例子，来介绍上图中那条鱼和狐狸 ：）\x3c\/p\x3e\n\x3cp\x3epart1 : docker  \x3ca href=\x22https:\/\/github.com\/ccfnever\/docker-demo\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e本文的项目代码\x3c\/a\x3e\x3cbr\x3epart2 : gitlab-ci \x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000011553991\x22\x3e点我跳转\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3eok， 那么现在就开始第一部分\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader0\x22\x3e一、什么是 Docker ？\x3c\/h3\x3e\n\x3cp\x3eDocker是一个基于轻量级虚拟化技术的容器引擎开源项目，可以轻松的为任何应用创建一个\x3cstrong\x3e容器\x3c\/strong\x3e。\x3cbr\x3e具体做的就是\x3cstrong\x3e快速的帮助开发者搭建应用周期里所需的各种环境，快速地部署项目以缩短开发周期\x3c\/strong\x3e。\x3c\/p\x3e\n\x3ch5\x3edocker 具备以下几个优势：\x3c\/h5\x3e\n\x3cp\x3e1.配置简单\x3cbr\x3e2.可移植\x3cbr\x3e3.独立自给自足\x3cbr\x3e4.轻量级\x3c\/p\x3e\n\x3ch5\x3eDocker 的应用场景\x3c\/h5\x3e\n\x3cp\x3e1.web应用工作流中的各种环境快速搭建\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e\x3cp\x3e自动化测试和持续集成、发布\x3c\/p\x3e\x3c\/li\x3e\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e二、安装 docker\x3c\/h3\x3e\n\x3ch5\x3e首先下载安装包\x3c\/h5\x3e\n\x3cp\x3e这里以 mac 为例子\x3c\/p\x3e\n\x3cp\x3eMac 客户端：\x3ca href=\x22https:\/\/store.docker.com\/editions\/community\/docker-ce-desktop-mac\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/store.docker.com\/edit...\x3c\/a\x3e\x3cbr\x3e其他版本：\x3ca href=\x22https:\/\/www.docker.com\/get-docker\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/www.docker.com\/get-do...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011553750?w=1100\x26amp;h=564\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011553750?w=1100\x26amp;h=564\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e这时候打开终端，就可以使用docker命令了。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011553751?w=1100\x26amp;h=85\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011553751?w=1100\x26amp;h=85\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch5\x3e性能和网络设置\x3c\/h5\x3e\n\x3cp\x3e安装后，最好进行一些基本的性能和网络设置（在 docker app的设置菜单里，快捷键 commond \x2b ，）\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011553752?w=1100\x26amp;h=580\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011553752?w=1100\x26amp;h=580\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e设置镜像加速（很重要），这里利用阿里云的加速 \x3ca href=\x22https:\/\/cr.console.aliyun.com\/#\/accelerator\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/cr.console.aliyun.com...\x3c\/a\x3e\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011553753?w=1100\x26amp;h=597\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011553753?w=1100\x26amp;h=597\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e三、Docker 的几个核心概念\x3c\/h3\x3e\n\x3cp\x3e在使用 docker 之前，有必要先了解 docker 的几个核心概念。\x3c\/p\x3e\n\x3ch5\x3e1.镜像 images\x3c\/h5\x3e\n\x3cblockquote\x3e\x3cp\x3eImages 镜像是 Docker 容器的模板文件，用来创建和运行Docker容器。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e镜像可以从 \x3ca href=\x22https:\/\/hub.docker.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDocker Hub\x3c\/a\x3e 下载：\x3cbr\x3e我们可以先用 \x3ccode\x3edocker search\x3c\/code\x3e 命令来搜索 ubuntu 镜像\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011553754?w=1100\x26amp;h=393\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011553754?w=1100\x26amp;h=393\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e然后我们可以用 \x3ccode\x3edocker pull ubuntu\x3c\/code\x3e 来获取那个 \x3ccode\x3eimages\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011553755?w=1100\x26amp;h=257\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011553755?w=1100\x26amp;h=257\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e各个选项说明:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eREPOSTITORY：表示镜像的仓库源\x3c\/li\x3e\n\x3cli\x3eTAG：镜像的标签\x3c\/li\x3e\n\x3cli\x3eIMAGE ID：镜像ID\x3c\/li\x3e\n\x3cli\x3eCREATED：镜像创建时间\x3c\/li\x3e\n\x3cli\x3eSIZE：镜像大小\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch5\x3e2.容器 container\x3c\/h5\x3e\n\x3cp\x3eContainer 容器是 Docker 镜像的一个运行实例，一个实例相当于创建了一个独立的环境，我们可以在\x3cbr\x3e里面运行操作系统、程序应用、修改文件数据等等。\x3c\/p\x3e\n\x3cp\x3e当你用 \x3ccode\x3edocker run \x3c\/code\x3e运行 \x3ccode\x3eimages\x3c\/code\x3e 的时候，就会创建对应的容器:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22docker run -ti ubuntu:latest \/bin\/bash\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dockerfile\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3edocker \x3cspan class=\x22hljs-keyword\x22\x3erun\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e -ti ubuntu:latest \/bin\/bash\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011553756?w=1100\x26amp;h=112\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011553756?w=1100\x26amp;h=112\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e-ti参数可以让容器保持终端交互 （ 退出在容器内输入 exit ）\x3cbr\x3e\x3ccode\x3eubuntu:latest\x3c\/code\x3e就是镜像名，\x3ccode\x3e\/bin\/bash\x3c\/code\x3e 则是运行命令\x3c\/p\x3e\n\x3cp\x3e想查看运行中的容器：\x3ccode\x3edocker ps\x3c\/code\x3e\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011553757?w=1100\x26amp;h=71\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011553757?w=1100\x26amp;h=71\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e退出容器：\x3ccode\x3edocker stop \x3c\/code\x3e 或者 \x3ccode\x3edocker kill\x3c\/code\x3e 加上对应容器的ID (一般输入开头3~4个字母就行了)\x3cbr\x3e重新启动容器： \x3ccode\x3edocker start\x3c\/code\x3e加上对应容器的ID\x3cbr\x3e更多容器相关命令，请查看\x3ca href=\x22https:\/\/docs.docker.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e官网文档\x3c\/a\x3e，或者--help查看命令帮助\x3c\/p\x3e\n\x3ch5\x3e3.使用 Dockerfile 和 Docker-compose 定制镜像\x3c\/h5\x3e\n\x3cp\x3eDockerfile 是一个文本格式的配置文件，用于快速方便的创建自定义镜像。\x3cbr\x3eDocker-compose 则是用于组合多个镜像，创建一个模块化的容器集合。\x3c\/p\x3e\n\x3cp\x3eDockerfile 常用有以下指令选项:\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e- FROM\x3c\/strong\x3e\x3cbr\x3e  指定构建镜像的基础源镜像，如果本地没有指定的镜像，则会从 docker hub pull 镜像下来。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22FROM ubuntu\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dockerfile\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eFROM\x3c\/span\x3e ubuntu\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e- RUN\x3c\/strong\x3e\x3cbr\x3e创建镜像过程中，用来执行命令，通常用于安装程序（RUN 会被缓存，可以使用docker build --no-cache 清除缓存）\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22RUN apt-get update \x26amp;\x26amp; apt-get install git\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs q\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eRUN apt-\x3cspan class=\x22hljs-built_in\x22\x3eget\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eupdate\x3c\/span\x3e \x26amp;\x26amp; apt-\x3cspan class=\x22hljs-built_in\x22\x3eget\x3c\/span\x3e install git\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e- CMD\x3c\/strong\x3e\x3cbr\x3eCMD可以让容器在启动时默认执行一个命令。如果用户启动容器时指定了运行的命令，则会覆盖掉CMD指定的命令。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22CMD [\x26quot;\/bin\/bash\x26quot;,\x26quot;\/etc\/php.sh\x26quot;]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dockerfile\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eCMD\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e [\x3cspan class=\x22hljs-string\x22\x3e\x22\/bin\/bash\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22\/etc\/php.sh\x22\x3c\/span\x3e]\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e- EXPOSE\x3c\/strong\x3e\x3cbr\x3e容器对外映射的本地端口，需要在 docker run 的时候使用-p或者-P选项生效。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22EXPOSE 8080\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dockerfile\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eEXPOSE\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e8080\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e- ENV\x3c\/strong\x3e\x3cbr\x3e设置环境变量\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ENV \x3ckey\x3e \x3cvalue\x3e       # 只能设置一个变量\nENV \x3ckey\x3e=\x3cvalue\x3e ...   # 允许一次设置多个变量\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3eENV \x3cspan class=\x22hljs-params\x22\x3e\x26lt;key\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e\x26lt;value\x26gt;\x3c\/span\x3e       \x3cspan class=\x22hljs-meta\x22\x3e# 只能设置一个变量\x3c\/span\x3e\nENV \x3cspan class=\x22hljs-params\x22\x3e\x26lt;key\x26gt;\x3c\/span\x3e=\x3cspan class=\x22hljs-params\x22\x3e\x26lt;value\x26gt;\x3c\/span\x3e ...   \x3cspan class=\x22hljs-meta\x22\x3e# 允许一次设置多个变量\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e- ADD\x3c\/strong\x3e\x3cbr\x3e\x3cstrong\x3e- COPY\x3c\/strong\x3e\x3cbr\x3eADD 和 COPY 都是本地主机文件、目录到容器指定路径中 。，不同的是，ADD可以复制远程文件 URL，并且支持 Go 的正则模糊匹配，具体规则可参见 \x3ca href=\x22https:\/\/golang.org\/pkg\/path\/filepath\/#Match\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGo filepath.Match\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ADD hom* \/mydir\/        # adds all files starting with \x26quot;hom\x26quot;\nADD hom?.txt \/mydir\/    # ? is replaced with any single character\nCOPY \x3csrc\x3e... \x3cdest\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dockerfile\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eADD\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e hom* \/mydir\/        \x3cspan class=\x22hljs-comment\x22\x3e# adds all files starting with \x22hom\x22\x3c\/span\x3e\n\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3eADD\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e hom?.txt \/mydir\/    \x3cspan class=\x22hljs-comment\x22\x3e# ? is replaced with any single character\x3c\/span\x3e\n\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3eCOPY\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e \x26lt;src\x26gt;... \x26lt;dest\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e- VOLUME\x3c\/strong\x3e\x3cbr\x3e本地目录到容器的映射\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22VOLUME [\x26quot;\/src\x26quot;,\x26quot;\/www\x26quot;]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dockerfile\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eVOLUME\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e [\x3cspan class=\x22hljs-string\x22\x3e\x22\/src\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22\/www\x22\x3c\/span\x3e]\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e- WORKDIR\x3c\/strong\x3e\x3cbr\x3e初始执行命令的路径\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22WORKDIR \/www\/server\nRUN pwd # 打印\/www\/server\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dockerfile\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eWORKDIR\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e \/www\/server\n\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3eRUN\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e \x3cspan class=\x22hljs-built_in\x22\x3epwd\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e# 打印\/www\/server\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e以上配置  也可以在 Docker-compose 完成，只是关键字和值的写法不太一样，具体可以参考它们的文档：\x3cbr\x3e Dockerfile: \x3ca href=\x22https:\/\/docs.docker.com\/engine\/reference\/builder\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/docs.docker.com\/engin...\x3c\/a\x3e\x3cbr\x3e Docker-compose: \x3ca href=\x22https:\/\/docs.docker.com\/compose\/compose-file\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/docs.docker.com\/compo...\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e四、一个简单案例\x3c\/h3\x3e\n\x3cp\x3e使用 docker 为一个spa应用起一个开发环境\x2b测试环境\x3c\/p\x3e\n\x3cp\x3e简单说要做的是：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e在 docker 里起一个 node 服务热加载项目源码。\x3c\/li\x3e\n\x3cli\x3e用 docker 起一个 nginx 服务，代理项目编译后的 dist 目录。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e在这，我用 \x3ca href=\x22https:\/\/www.npmjs.com\/package\/vue-cli\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3evue-cli\x3c\/a\x3e 初始化了一个项目，然后新建了个 docker-compose 文件夹（用来配置docker）如下图:\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011553758?w=1704\x26amp;h=554\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011553758?w=1704\x26amp;h=554\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e上图是源码目录，\x3c\/p\x3e\n\x3cp\x3e另外，docker-compose 的目录结构如下\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cp\x3edocker-compose\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3edocker-compose.yml\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3enginx\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eDockerfile\x3c\/li\x3e\n\x3cli\x3enginx.conf\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3esites-enabled\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3ewww.docker-test.com.conf\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3enode\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eDockerfile\x3c\/li\x3e\n\x3cli\x3estart.sh\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\x3c\/ul\x3e\n\x3col\x3e\x3cli\x3e、node 文件夹下各有一份 Dockerfile 文件，可以创建两个 images 镜像，docker-compose.yml 则用于将两个镜像服务整合使用。\x3c\/li\x3e\x3c\/ol\x3e\n\x3cp\x3e我们先看 node 文件夹下的 \x3cbr\x3eDockerfile：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22# docker-compose\/php\/Dockerfile\n\n#基于 node 镜像\nFROM node  \n\n# 复制宿主机的 start.sh 到 容器 \/etc\/start.sh\nADD start.sh \/etc\/start.sh\n\n# 设置初始命令执行目录\nWORKDIR \/www\n\n# 通过 RUN 可以在容器里执行自定义命令\nRUN node -v\nRUN pwd\n\nCMD [\x26quot;\/bin\/bash\x26quot;,\x26quot;\/etc\/start.sh\x26quot;]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dockerfile\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e# docker-compose\/php\/Dockerfile\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e#基于 node 镜像\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eFROM\x3c\/span\x3e node  \n\n\x3cspan class=\x22hljs-comment\x22\x3e# 复制宿主机的 start.sh 到 容器 \/etc\/start.sh\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eADD\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e start.sh \/etc\/start.sh\n\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e# 设置初始命令执行目录\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eWORKDIR\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e \/www\n\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e# 通过 RUN 可以在容器里执行自定义命令\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eRUN\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e node -v\n\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3eRUN\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e \x3cspan class=\x22hljs-built_in\x22\x3epwd\x3c\/span\x3e\n\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eCMD\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e [\x3cspan class=\x22hljs-string\x22\x3e\x22\/bin\/bash\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22\/etc\/start.sh\x22\x3c\/span\x3e]\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3estart.sh:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22#!\/bin\/bash\n\n# 启动 php 服务\nnpm run dev \n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs bash\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-meta\x22\x3e#!\/bin\/bash\n\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e# 启动 php 服务\x3c\/span\x3e\nnpm run dev \n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e再来看 nginx 下的\x3cbr\x3eDockerfile:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22# docker-compose\/nginx\/Dockerfile\n\n#基于 nginx 镜像\nFROM nginx  \n\n#基于 nginx 相关配置复制到容器\nADD nginx.conf \/etc\/nginx\/nginx.conf\nADD sites-enabled\/* \/etc\/nginx\/conf.d\/\n\n#创建 nginx log 和用户相关路径\nRUN mkdir \/opt\/htdocs \x26amp;\x26amp; mkdir \/opt\/log \x26amp;\x26amp; mkdir \/opt\/log\/nginx\nRUN chown -R www-data.www-data \/opt\/htdocs \/opt\/log\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dockerfile\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e# docker-compose\/nginx\/Dockerfile\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e#基于 nginx 镜像\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eFROM\x3c\/span\x3e nginx  \n\n\x3cspan class=\x22hljs-comment\x22\x3e#基于 nginx 相关配置复制到容器\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eADD\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e nginx.conf \/etc\/nginx\/nginx.conf\n\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3eADD\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e sites-enabled\/* \/etc\/nginx\/conf.d\/\n\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e#创建 nginx log 和用户相关路径\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eRUN\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e mkdir \/opt\/htdocs \x26amp;\x26amp; mkdir \/opt\/\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e \x26amp;\x26amp; mkdir \/opt\/\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e\/nginx\n\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3eRUN\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e chown -R www-data.www-data \/opt\/htdocs \/opt\/\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e\n\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样，两个服务的 Dockerfile 都创建完成了，但是我们还没暴露端口，也没配置 volumes 映射，这里我们可以在 docker-compose.yml 中设置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22nginx:\n  build: .\/nginx\n  ports:\n    - \x26quot;80:80\x26quot; #映射到本地的端口\n  volumes: \n    - \/Users\/mr.yun\/docker-test\/docker-demo\/dist:\/www\n\nnode:\n  build: .\/node\n  ports: \n    - \x26quot;8085:8080\x26quot;   #映射到本地的端口 本地访问8085，即访问容器内的8080\n  volumes:\n    - \/Users\/mr.yun\/docker-test\/docker-demo:\/www\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-symbol\x22\x3enginx:\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  build:\x3c\/span\x3e .\/nginx\n\x3cspan class=\x22hljs-symbol\x22\x3e  ports:\x3c\/span\x3e\n    - \x3cspan class=\x22hljs-string\x22\x3e\x2280:80\x22\x3c\/span\x3e \x3cspan class=\x22hljs-meta\x22\x3e#映射到本地的端口\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  volumes:\x3c\/span\x3e \n    - \/Users\/mr.yun\x3cspan class=\x22hljs-meta-keyword\x22\x3e\/docker-test\/\x3c\/span\x3edocker-demo\/dist:\/www\n\x3cspan class=\x22hljs-symbol\x22\x3e\nnode:\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  build:\x3c\/span\x3e .\/node\n\x3cspan class=\x22hljs-symbol\x22\x3e  ports:\x3c\/span\x3e \n    - \x3cspan class=\x22hljs-string\x22\x3e\x228085:8080\x22\x3c\/span\x3e   \x3cspan class=\x22hljs-meta\x22\x3e#映射到本地的端口 本地访问8085，即访问容器内的8080\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  volumes:\x3c\/span\x3e\n    - \/Users\/mr.yun\x3cspan class=\x22hljs-meta-keyword\x22\x3e\/docker-test\/\x3c\/span\x3edocker-demo:\/www\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e注意，上面代码中，volumes 的值，要根据你自己的实际项目目录来配置。\x3c\/p\x3e\n\x3cp\x3e配置完以上变量后，cd 进入 docker-compose 文件目录\x3c\/p\x3e\n\x3cp\x3e直接运行命令\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22# 启动容器集合，会同时创建两个image，并启动两个容器，也可以加 -d 在后台运行\n# 运行后可以通过 docker images,docker ps查看生成的镜像和容器\ndocker-compose up --biuld\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs vala\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-meta\x22\x3e# 启动容器集合，会同时创建两个image，并启动两个容器，也可以加 -d 在后台运行\x3c\/span\x3e\n\x3cspan class=\x22hljs-meta\x22\x3e# 运行后可以通过 docker images,docker ps查看生成的镜像和容器\x3c\/span\x3e\ndocker-compose up --biuld\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e等待下载完成，并自动运行\x3c\/p\x3e\n\x3cp\x3e然后在浏览器输入 127.0.0.1:8050 ,就能看到 vue项目,并且修改源码能热加载。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011553759?w=600\x26amp;h=579\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011553759?w=600\x26amp;h=579\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e输入 127.0.0.1，则可以看到静态资源 hash 过的项目。（别忘了在本地先 npm run build）\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011553760?w=600\x26amp;h=399\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011553760?w=600\x26amp;h=399\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e哦了，以上就是 docker 的基本使用介绍，更多玩法和技巧，到实际项目中探索。\x3cbr\x3e个人感觉在项目多、协作人数多的情况下，docker 还是很方便的。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Docker 及 GitLab CI 在前端工作流上的实践分享（一）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011553744">https://segmentfault.com/a/1190000011553744</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/2st07fx7663/" target="_blank">https://alili.tech/archive/2st07fx7663/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>