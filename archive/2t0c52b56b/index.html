<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="走进Vue-cli源码，自己动手搭建前端脚手架工具"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>走进Vue-cli源码，自己动手搭建前端脚手架工具 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/2t0c52b56b/",
				"appid": "1613049289050283", 
				"title": "走进Vue-cli源码，自己动手搭建前端脚手架工具 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-09T02:30:08"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/tciy7hpvbwa/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/5dgy9o9cvqf/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f2t0c52b56b%2f&text=%e8%b5%b0%e8%bf%9bVue-cli%e6%ba%90%e7%a0%81%ef%bc%8c%e8%87%aa%e5%b7%b1%e5%8a%a8%e6%89%8b%e6%90%ad%e5%bb%ba%e5%89%8d%e7%ab%af%e8%84%9a%e6%89%8b%e6%9e%b6%e5%b7%a5%e5%85%b7"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f2t0c52b56b%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f2t0c52b56b%2f&text=%e8%b5%b0%e8%bf%9bVue-cli%e6%ba%90%e7%a0%81%ef%bc%8c%e8%87%aa%e5%b7%b1%e5%8a%a8%e6%89%8b%e6%90%ad%e5%bb%ba%e5%89%8d%e7%ab%af%e8%84%9a%e6%89%8b%e6%9e%b6%e5%b7%a5%e5%85%b7"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f2t0c52b56b%2f&title=%e8%b5%b0%e8%bf%9bVue-cli%e6%ba%90%e7%a0%81%ef%bc%8c%e8%87%aa%e5%b7%b1%e5%8a%a8%e6%89%8b%e6%90%ad%e5%bb%ba%e5%89%8d%e7%ab%af%e8%84%9a%e6%89%8b%e6%9e%b6%e5%b7%a5%e5%85%b7"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f2t0c52b56b%2f&is_video=false&description=%e8%b5%b0%e8%bf%9bVue-cli%e6%ba%90%e7%a0%81%ef%bc%8c%e8%87%aa%e5%b7%b1%e5%8a%a8%e6%89%8b%e6%90%ad%e5%bb%ba%e5%89%8d%e7%ab%af%e8%84%9a%e6%89%8b%e6%9e%b6%e5%b7%a5%e5%85%b7"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e8%b5%b0%e8%bf%9bVue-cli%e6%ba%90%e7%a0%81%ef%bc%8c%e8%87%aa%e5%b7%b1%e5%8a%a8%e6%89%8b%e6%90%ad%e5%bb%ba%e5%89%8d%e7%ab%af%e8%84%9a%e6%89%8b%e6%9e%b6%e5%b7%a5%e5%85%b7&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f2t0c52b56b%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f2t0c52b56b%2f&title=%e8%b5%b0%e8%bf%9bVue-cli%e6%ba%90%e7%a0%81%ef%bc%8c%e8%87%aa%e5%b7%b1%e5%8a%a8%e6%89%8b%e6%90%ad%e5%bb%ba%e5%89%8d%e7%ab%af%e8%84%9a%e6%89%8b%e6%9e%b6%e5%b7%a5%e5%85%b7"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f2t0c52b56b%2f&title=%e8%b5%b0%e8%bf%9bVue-cli%e6%ba%90%e7%a0%81%ef%bc%8c%e8%87%aa%e5%b7%b1%e5%8a%a8%e6%89%8b%e6%90%ad%e5%bb%ba%e5%89%8d%e7%ab%af%e8%84%9a%e6%89%8b%e6%9e%b6%e5%b7%a5%e5%85%b7"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f2t0c52b56b%2f&title=%e8%b5%b0%e8%bf%9bVue-cli%e6%ba%90%e7%a0%81%ef%bc%8c%e8%87%aa%e5%b7%b1%e5%8a%a8%e6%89%8b%e6%90%ad%e5%bb%ba%e5%89%8d%e7%ab%af%e8%84%9a%e6%89%8b%e6%9e%b6%e5%b7%a5%e5%85%b7"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f2t0c52b56b%2f&title=%e8%b5%b0%e8%bf%9bVue-cli%e6%ba%90%e7%a0%81%ef%bc%8c%e8%87%aa%e5%b7%b1%e5%8a%a8%e6%89%8b%e6%90%ad%e5%bb%ba%e5%89%8d%e7%ab%af%e8%84%9a%e6%89%8b%e6%9e%b6%e5%b7%a5%e5%85%b7"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">走进Vue-cli源码，自己动手搭建前端脚手架工具</h1><div class="meta"><div class="postdate"><time datetime="2018-12-09" itemprop="datePublished">2018-12-09</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e前言\x3c\/h1\x3e\n\x3cp\x3e前段时间看了一些vue-cli的源码，收获颇深。本想找个时间更新一篇文章，但是最近事情比较多，没有时间去整理这些东西。趁这两天闲了下来，便整理了一下，然后跟大家分享一下。如果小伙伴们读完之后，跟我一样收获很多的话，还望各位小伙伴们多多点赞收藏支持一下哦。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3eVue-cli介绍\x3c\/h1\x3e\n\x3cp\x3eVue-cli是一款非常优秀的用于迅速构建基于Vue的Web应用工具。他不同于creat-react-app这样的工具，开发者只需要关注项目逻辑的代码，而不需要关心webpack打包、启动Node服务等等诸如此类的这些问题。Vue-cli是一款基于模板化的开发工具，等于就是把别人的项目结构给照搬过来，所有的配置都是暴露出来的，你可以根据实际情况去做一些配置的修改，更加灵活自由一点。当然这对前端工程师提出更高的要求，考虑的东西也变多了。不过Vue-cli即将发布3.0的版本，整个Vue-cli发生了翻天覆地的变化，它采用跟creat-react-app这类工具的模式，开发者只需要关注项目逻辑的代码即可。不过目前3.0还没有出来，所以\x3cstrong\x3e这次源码分析我采用的v2.9.3的源码，也就是2.0的代码\x3c\/strong\x3e。后面小伙们在阅读的时候要注意以下。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3eVue-cli项目结构\x3c\/h1\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV6MuO?w=403\x26amp;h=670\x22 src=\x22https:\/\/static.alili.tech\/img\/bV6MuO?w=403\x26amp;h=670\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e整个项目的目录结构如上图所示，下面我大概介绍每个文件夹的东西大致都是干嘛的。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3ebin\x3c\/strong\x3e \/\/这里放的vue的一些命令文件，比如\x3cstrong\x3evue init\x3c\/strong\x3e这样的命令都是从由这里控制的\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3edocs\x3c\/strong\x3e \/\/一些注意事项啥的，不重要的目录，可以直接忽略\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3elib\x3c\/strong\x3e  \/\/这里存放着一些vue-cli需要的一些自定义方法\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3enode_modules\x3c\/strong\x3e  \/\/这里就不用我多说了\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3etest\x3c\/strong\x3e  \/\/ 单元测试 开会vue-cli工具时会用到，我们读源码的时候可以直接忽略掉\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3e一些杂七杂八的东西\x3c\/strong\x3e \/\/比如eslint配置、.gitignore、LICENSE等等诸如此类这些东西。不影响阅读源码，直接忽略掉。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3epackage.json\/README.md\x3c\/strong\x3e \/\/这个也不用我多说了，大家都知道的\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cblockquote\x3e\x3cstrong\x3e综合来说，我们阅读源码所要关注的只有bin和lib下面即可，其他的都可忽略。下面开始阅读之旅吧\x3c\/strong\x3e\x3c\/blockquote\x3e\n\x3ch1 id=\x22articleHeader3\x22\x3eVue-cli源码阅读之旅\x3c\/h1\x3e\n\x3cp\x3e在开始读源码之前，首先我要介绍一个工具（\x3cstrong\x3ecommander\x3c\/strong\x3e），这是用来处理命令行的工具。具体的使用方法可查看github的README.md  \x3ca href=\x22https:\/\/github.com\/tj\/commander.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/tj\/command...\x3c\/a\x3e 。小伙伴们再阅读后面的内容之前，建议先去了解一下\x3cstrong\x3ecommander\x3c\/strong\x3e，方便后续的理解。这里我们对\x3cstrong\x3ecommander\x3c\/strong\x3e就不做详细介绍了。这里vue-cli采用了\x3cstrong\x3ecommander\x3c\/strong\x3e的git风格的写法。vue文件处理vue命令，vue-init处理vue init命令以此类推。接着我们一个一个命令看过去。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3evue\x3c\/h2\x3e\n\x3cp\x3e\x3cstrong\x3e引入的包：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cstrong\x3ecommander\x3c\/strong\x3e    \/\/用于处理命令行\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e作用：\x3c\/strong\x3e vue这个文件代码很少，我就直接贴出来了。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22#!\/usr\/bin\/env node\n\nrequire(\x27commander\x27)\n  .version(require(\x27..\/package\x27).version)\n  .usage(\x27\x3ccommand\x3e [options]\x27)\n  .command(\x27init\x27, \x27generate a new project from a template\x27)\n  .command(\x27list\x27, \x27list available official templates\x27)\n  .command(\x27build\x27, \x27prototype a new project\x27)\n  .parse(process.argv)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e#!\/\x3cspan class=\x22hljs-selector-tag\x22\x3eusr\x3c\/span\x3e\/\x3cspan class=\x22hljs-selector-tag\x22\x3ebin\x3c\/span\x3e\/\x3cspan class=\x22hljs-selector-tag\x22\x3eenv\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3enode\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-selector-tag\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27commander\x27\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-selector-class\x22\x3e.version\x3c\/span\x3e(require(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/package\x27\x3c\/span\x3e).version)\n  \x3cspan class=\x22hljs-selector-class\x22\x3e.usage\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;command\x26gt; [options]\x27\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-selector-class\x22\x3e.command\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27init\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27generate a new project from a template\x27\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-selector-class\x22\x3e.command\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27list\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27list available official templates\x27\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-selector-class\x22\x3e.command\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27build\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27prototype a new project\x27\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-selector-class\x22\x3e.parse\x3c\/span\x3e(process.argv)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个文件主要是在用户输入“\x3cstrong\x3evue\x3c\/strong\x3e”时，终端上显示参数的使用说明。具体的写法可参考 \x3ca href=\x22https:\/\/github.com\/tj\/commander.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/tj\/command...\x3c\/a\x3e 上面的说明。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3evue build\x3c\/h2\x3e\n\x3cp\x3e\x3cstrong\x3e引入的包：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cstrong\x3echalk\x3c\/strong\x3e    \/\/用于高亮终端打印出来的信息\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e作用：\x3c\/strong\x3e \x3cstrong\x3evue build\x3c\/strong\x3e命令在vue-cli之中已经删除了，源码上做了一定的说明。代码不多，我就直接贴出来。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\nconst chalk = require(\x27chalk\x27)\n\nconsole.log(chalk.yellow(\n  \x27\\n\x27 \x2b\n  \x27  We are slimming down vue-cli to optimize the initial installation by \x27 \x2b\n  \x27removing the `vue build` command.\\n\x27 \x2b\n  \x27  Check out Poi (https:\/\/github.com\/egoist\/poi) which offers the same functionality!\x27 \x2b\n  \x27\\n\x27\n))\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs vbnet\x22\x3e\x3ccode\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e chalk = require(\x3cspan class=\x22hljs-comment\x22\x3e\x27chalk\x27)\x3c\/span\x3e\n\nconsole.log(chalk.yellow(\n  \x3cspan class=\x22hljs-comment\x22\x3e\x27\\n\x27 \x2b\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\x27  We are slimming down vue-cli to optimize the initial installation by \x27 \x2b\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\x27removing the `vue build` command.\\n\x27 \x2b\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\x27  Check out Poi (https:\/\/github.com\/egoist\/poi) which offers the same functionality!\x27 \x2b\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\x27\\n\x27\x3c\/span\x3e\n))\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3evue list\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22#!\/usr\/bin\/env node\nconst logger = require(\x27..\/lib\/logger\x27)\nconst request = require(\x27request\x27)\nconst chalk = require(\x27chalk\x27)\n\n\/**\n * Padding.\n *\/\n\nconsole.log()\nprocess.on(\x27exit\x27, () =\x3e {\n  console.log()\n})\n\n\/**\n * List repos.\n *\/\n\nrequest({\n  url: \x27https:\/\/api.github.com\/users\/vuejs-templates\/repos\x27,\n  headers: {\n    \x27User-Agent\x27: \x27vue-cli\x27\n  }\n}, (err, res, body) =\x3e {\n  if (err) logger.fatal(err)\n  const requestBody = JSON.parse(body)\n  if (Array.isArray(requestBody)) {\n    console.log(\x27  Available official templates:\x27)\n    console.log()\n    requestBody.forEach(repo =\x3e {\n      console.log(\n        \x27  \x27 \x2b chalk.yellow(\x27★\x27) \x2b\n        \x27  \x27 \x2b chalk.blue(repo.name) \x2b\n        \x27 - \x27 \x2b repo.description)\n    })\n  } else {\n    console.error(requestBody.message)\n  }\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e#!\x3cspan class=\x22hljs-regexp\x22\x3e\/usr\/\x3c\/span\x3ebin\/env node\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e logger = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/lib\/logger\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e request = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27request\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e chalk = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27chalk\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Padding.\n *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log()\nprocess.on(\x3cspan class=\x22hljs-string\x22\x3e\x27exit\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log()\n})\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * List repos.\n *\/\x3c\/span\x3e\n\nrequest({\n  url: \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/api.github.com\/users\/vuejs-templates\/repos\x27\x3c\/span\x3e,\n  headers: {\n    \x3cspan class=\x22hljs-string\x22\x3e\x27User-Agent\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27vue-cli\x27\x3c\/span\x3e\n  }\n}, \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr, res, body\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (err) logger.fatal(err)\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e requestBody = \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.parse(body)\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e.isArray(requestBody)) {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27  Available official templates:\x27\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log()\n    requestBody.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3erepo\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\n        \x3cspan class=\x22hljs-string\x22\x3e\x27  \x27\x3c\/span\x3e \x2b chalk.yellow(\x3cspan class=\x22hljs-string\x22\x3e\x27★\x27\x3c\/span\x3e) \x2b\n        \x3cspan class=\x22hljs-string\x22\x3e\x27  \x27\x3c\/span\x3e \x2b chalk.blue(repo.name) \x2b\n        \x3cspan class=\x22hljs-string\x22\x3e\x27 - \x27\x3c\/span\x3e \x2b repo.description)\n    })\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error(requestBody.message)\n  }\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e引入的包：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3erequest\x3c\/strong\x3e  \/\/发送http请求的工具。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3echalk\x3c\/strong\x3e    \/\/用于高亮console.log打印出来的信息。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3elogger\x3c\/strong\x3e   \/\/自定义工具-用于日志打印。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e作用：\x3c\/strong\x3e当输入\x22\x3cstrong\x3evue list\x3c\/strong\x3e\x22时（\x3cstrong\x3e我们测试时，可以直接在当前源码文件目录下的终端上输入“bin\/vue-list”\x3c\/strong\x3e），vue-cli会请求接口，获取官方模板的信息，然后做了一定处理，在终端上显示出来模板名称和对应的说明。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e效果如下：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  Available official templates:\n\n  ★  browserify - A full-featured Browserify \x2b vueify setup with hot-reload, linting \x26amp; unit testing.\n  ★  browserify-simple - A simple Browserify \x2b vueify setup for quick prototyping.\n  ★  pwa - PWA template for vue-cli based on the webpack template\n  ★  simple - The simplest possible Vue setup in a single HTML file\n  ★  webpack - A full-featured Webpack \x2b vue-loader setup with hot reload, linting, testing \x26amp; css extraction.\n  ★  webpack-simple - A simple Webpack \x2b vue-loader setup for quick prototyping.\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coq\x22\x3e\x3ccode\x3e  Available official templates:\n\n  ★  browserify - A full-featured Browserify \x2b vueify setup \x3cspan class=\x22hljs-built_in\x22\x3ewith\x3c\/span\x3e hot-reload, linting \x26amp; unit testing.\n  ★  browserify-\x3cspan class=\x22hljs-built_in\x22\x3esimple\x3c\/span\x3e - A \x3cspan class=\x22hljs-built_in\x22\x3esimple\x3c\/span\x3e Browserify \x2b vueify setup \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e quick prototyping.\n  ★  pwa - PWA template \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e vue-cli based on the webpack template\n  ★  \x3cspan class=\x22hljs-built_in\x22\x3esimple\x3c\/span\x3e - The simplest possible Vue setup \x3cspan class=\x22hljs-built_in\x22\x3ein\x3c\/span\x3e a single HTML file\n  ★  webpack - A full-featured Webpack \x2b vue-loader setup \x3cspan class=\x22hljs-built_in\x22\x3ewith\x3c\/span\x3e hot reload, linting, testing \x26amp; css extraction.\n  ★  webpack-\x3cspan class=\x22hljs-built_in\x22\x3esimple\x3c\/span\x3e - A \x3cspan class=\x22hljs-built_in\x22\x3esimple\x3c\/span\x3e Webpack \x2b vue-loader setup \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e quick prototyping.\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3evue init\x3c\/h2\x3e\n\x3cp\x3e“\x3cstrong\x3evue init\x3c\/strong\x3e”是用来构建项目的命令，也是vue-cli的核心文件，上面的三个都是非常简单的命令，算是我们阅读源码的开胃菜，真正的大餐在这里。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e工作流程\x3c\/h3\x3e\n\x3cp\x3e在讲代码之前，首先我们要讲一下整个vue-cli初始项目的流程，然后我们沿着流程一步一步走下去。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV6yO4?w=1259\x26amp;h=667\x22 src=\x22https:\/\/static.alili.tech\/img\/bV6yO4?w=1259\x26amp;h=667\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e整个\x3cstrong\x3evue init\x3c\/strong\x3e大致流程如我上图所示，应该还是比较好理解的。这里我大致阐述一下大致的流程。\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cstrong\x3evue-cli会先判断你的模板在远程github仓库上还是在你的本地某个文件里面，若是本地文件夹则会立即跳到第3步，反之则走第2步。\x3c\/strong\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cstrong\x3e第2步会判断是否为官方模板，官方模板则会从官方github仓库中下载模板到本地的默认仓库下，即根目录下.vue-templates文件夹下。\x3c\/strong\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cstrong\x3e第3步则读取模板目录下meta.js或者meta.json文件，根据里面的内容会询问开发者，根据开发者的回答，确定一些修改。\x3c\/strong\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cstrong\x3e根据模板内容以及开发者的回答，渲染出项目结构并生成到指定目录。\x3c\/strong\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e源码内容\x3c\/h3\x3e\n\x3cp\x3e这里\x3cstrong\x3evue-init\x3c\/strong\x3e文件的代码比较多，我这里就拆分几块来看。首先我先把整个文件的结构列出来，方便后续的阅读。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  \/**\n   * 引入一大堆包\n   *\/\n    const program = require(\x27commander\x27)\n    ...\n  \n   \n   \/**\n    * 配置commander的使用方法\n    *\/     \n    \n    program\n      .usage(\x27\x3ctemplate-name\x3e [project-name]\x27)\n      .option(\x27-c, --clone\x27, \x27use git clone\x27)\n      .option(\x27--offline\x27, \x27use cached template\x27)\n      \n  \/**\n    * 定义commander的help方法\n    *\/  \n    program.on(\x27--help\x27, () =\x3e {\n      console.log(\x27  Examples:\x27)\n      console.log()\n      console.log(chalk.gray(\x27    # create a new project with an official template\x27))\n      console.log(\x27    $ vue init webpack my-project\x27)\n      console.log()\n      console.log(chalk.gray(\x27    # create a new project straight from a github template\x27))\n      console.log(\x27    $ vue init username\/repo my-project\x27)\n      console.log()\n    })\n    \n    \n    function help () {\n      program.parse(process.argv)\n      if (program.args.length \x3c 1) return program.help() \/\/如果没有输入参数，终端显示帮助\n    }\n    help()\n    \n    \/**\n     * 定义一大堆变量\n     *\/\n     \n     let template = program.args[0]\n     ...\n     \n     \/**\n      * 判断是否输入项目名  是 - 直接执行run函数  否- 询问开发者是否在当前目录下生成项目，开发者回答“是” 也执行run函数 否则不执行run函数\n      *\/\n     \n     \/**\n     * 定义主函数 run\n     *\/\n     function run (){\n         ...\n     }\n     \n     \/**\n      * 定义下载模板并生产项目的函数 downloadAndGenerate\n      *\/\n      function downloadAndGenerate(){\n          ...\n      }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/**\n   * 引入一大堆包\n   *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e program = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27commander\x27\x3c\/span\x3e)\n    ...\n  \n   \n   \x3cspan class=\x22hljs-comment\x22\x3e\/**\n    * 配置commander的使用方法\n    *\/\x3c\/span\x3e     \n    \n    program\n      .usage(\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;template-name\x26gt; [project-name]\x27\x3c\/span\x3e)\n      .option(\x3cspan class=\x22hljs-string\x22\x3e\x27-c, --clone\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27use git clone\x27\x3c\/span\x3e)\n      .option(\x3cspan class=\x22hljs-string\x22\x3e\x27--offline\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27use cached template\x27\x3c\/span\x3e)\n      \n  \x3cspan class=\x22hljs-comment\x22\x3e\/**\n    * 定义commander的help方法\n    *\/\x3c\/span\x3e  \n    program.on(\x3cspan class=\x22hljs-string\x22\x3e\x27--help\x27\x3c\/span\x3e, () =\x26gt; {\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27  Examples:\x27\x3c\/span\x3e)\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log()\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(chalk.gray(\x3cspan class=\x22hljs-string\x22\x3e\x27    # create a new project with an official template\x27\x3c\/span\x3e))\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27    $ vue init webpack my-project\x27\x3c\/span\x3e)\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log()\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(chalk.gray(\x3cspan class=\x22hljs-string\x22\x3e\x27    # create a new project straight from a github template\x27\x3c\/span\x3e))\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27    $ vue init username\/repo my-project\x27\x3c\/span\x3e)\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log()\n    })\n    \n    \n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ehelp\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      program.parse(process.argv)\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (program.args.length \x26lt; \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e program.help() \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果没有输入参数，终端显示帮助\x3c\/span\x3e\n    }\n    help()\n    \n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * 定义一大堆变量\n     *\/\x3c\/span\x3e\n     \n     \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e template = program.args[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]\n     ...\n     \n     \x3cspan class=\x22hljs-comment\x22\x3e\/**\n      * 判断是否输入项目名  是 - 直接执行run函数  否- 询问开发者是否在当前目录下生成项目，开发者回答“是” 也执行run函数 否则不执行run函数\n      *\/\x3c\/span\x3e\n     \n     \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * 定义主函数 run\n     *\/\x3c\/span\x3e\n     \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erun\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n         ...\n     }\n     \n     \x3cspan class=\x22hljs-comment\x22\x3e\/**\n      * 定义下载模板并生产项目的函数 downloadAndGenerate\n      *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edownloadAndGenerate\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n          ...\n      }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e整个文件大致的东西入上面所示，后面我们将一块一块内容来看。\x3c\/p\x3e\n\x3ch4\x3e引入的一堆包\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const download = require(\x27download-git-repo\x27)  \/\/用于下载远程仓库至本地 支持GitHub、GitLab、Bitbucket\nconst program = require(\x27commander\x27) \/\/命令行处理工具\nconst exists = require(\x27fs\x27).existsSync  \/\/node自带的fs模块下的existsSync方法，用于检测路径是否存在。（会阻塞）\nconst path = require(\x27path\x27) \/\/node自带的path模块，用于拼接路径\nconst ora = require(\x27ora\x27) \/\/用于命令行上的加载效果\nconst home = require(\x27user-home\x27)  \/\/用于获取用户的根目录\nconst tildify = require(\x27tildify\x27) \/\/将绝对路径转换成带波浪符的路径\nconst chalk = require(\x27chalk\x27)\/\/ 用于高亮终端打印出的信息\nconst inquirer = require(\x27inquirer\x27) \/\/用于命令行与开发者交互\nconst rm = require(\x27rimraf\x27).sync \/\/ 相当于UNIX的“rm -rf”命令\nconst logger = require(\x27..\/lib\/logger\x27) \/\/自定义工具-用于日志打印\nconst generate = require(\x27..\/lib\/generate\x27)  \/\/自定义工具-用于基于模板构建项目\nconst checkVersion = require(\x27..\/lib\/check-version\x27) \/\/自定义工具-用于检测vue-cli版本的工具\nconst warnings = require(\x27..\/lib\/warnings\x27) \/\/自定义工具-用于模板的警告\nconst localPath = require(\x27..\/lib\/local-path\x27) \/\/自定义工具-用于路径的处理\n\nconst isLocalPath = localPath.isLocalPath  \/\/判断是否是本地路径\nconst getTemplatePath = localPath.getTemplatePath  \/\/获取本地模板的绝对路径\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e download = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27download-git-repo\x27\x3c\/span\x3e)  \x3cspan class=\x22hljs-comment\x22\x3e\/\/用于下载远程仓库至本地 支持GitHub、GitLab、Bitbucket\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e program = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27commander\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/命令行处理工具\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e exists = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27fs\x27\x3c\/span\x3e).existsSync  \x3cspan class=\x22hljs-comment\x22\x3e\/\/node自带的fs模块下的existsSync方法，用于检测路径是否存在。（会阻塞）\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e path = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27path\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/node自带的path模块，用于拼接路径\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ora = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27ora\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/用于命令行上的加载效果\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e home = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27user-home\x27\x3c\/span\x3e)  \x3cspan class=\x22hljs-comment\x22\x3e\/\/用于获取用户的根目录\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e tildify = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27tildify\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/将绝对路径转换成带波浪符的路径\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e chalk = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27chalk\x27\x3c\/span\x3e)\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 用于高亮终端打印出的信息\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e inquirer = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27inquirer\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/用于命令行与开发者交互\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e rm = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27rimraf\x27\x3c\/span\x3e).sync \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 相当于UNIX的“rm -rf”命令\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e logger = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/lib\/logger\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/自定义工具-用于日志打印\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e generate = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/lib\/generate\x27\x3c\/span\x3e)  \x3cspan class=\x22hljs-comment\x22\x3e\/\/自定义工具-用于基于模板构建项目\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e checkVersion = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/lib\/check-version\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/自定义工具-用于检测vue-cli版本的工具\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e warnings = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/lib\/warnings\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/自定义工具-用于模板的警告\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e localPath = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/lib\/local-path\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/自定义工具-用于路径的处理\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e isLocalPath = localPath.isLocalPath  \x3cspan class=\x22hljs-comment\x22\x3e\/\/判断是否是本地路径\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e getTemplatePath = localPath.getTemplatePath  \x3cspan class=\x22hljs-comment\x22\x3e\/\/获取本地模板的绝对路径\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e定义的一堆变量\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let template = program.args[0]  \/\/模板名称\nconst hasSlash = template.indexOf(\x27\/\x27) \x3e -1   \/\/是否有斜杠，后面将会用来判定是否为官方模板   \nconst rawName = program.args[1]  \/\/项目构建目录名\nconst inPlace = !rawName || rawName === \x27.\x27  \/\/ 没写或者“.”，表示当前目录下构建项目\nconst name = inPlace ? path.relative(\x27..\/\x27, process.cwd()) : rawName  \/\/如果在当前目录下构建项目,当前目录名为项目构建目录名，否则是当前目录下的子目录【rawName】为项目构建目录名\nconst to = path.resolve(rawName || \x27.\x27) \/\/项目构建目录的绝对路径\nconst clone = program.clone || false  \/\/是否采用clone模式，提供给“download-git-repo”的参数\n\nconst tmp = path.join(home, \x27.vue-templates\x27, template.replace(\/[\\\/:]\/g, \x27-\x27))  \/\/远程模板下载到本地的路径\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs arduino\x22\x3e\x3ccode\x3elet \x3cspan class=\x22hljs-keyword\x22\x3etemplate\x3c\/span\x3e = program.args[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]  \x3cspan class=\x22hljs-comment\x22\x3e\/\/模板名称\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e hasSlash = \x3cspan class=\x22hljs-keyword\x22\x3etemplate\x3c\/span\x3e.indexOf(\x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e   \x3cspan class=\x22hljs-comment\x22\x3e\/\/是否有斜杠，后面将会用来判定是否为官方模板   \x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e rawName = program.args[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e]  \x3cspan class=\x22hljs-comment\x22\x3e\/\/项目构建目录名\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e inPlace = !rawName || rawName === \x3cspan class=\x22hljs-string\x22\x3e\x27.\x27\x3c\/span\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 没写或者“.”，表示当前目录下构建项目\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e name = inPlace ? path.relative(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3eprocess\x3c\/span\x3e.cwd()) : rawName  \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果在当前目录下构建项目,当前目录名为项目构建目录名，否则是当前目录下的子目录【rawName】为项目构建目录名\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e to = path.resolve(rawName || \x3cspan class=\x22hljs-string\x22\x3e\x27.\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/项目构建目录的绝对路径\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e clone = program.clone || false  \x3cspan class=\x22hljs-comment\x22\x3e\/\/是否采用clone模式，提供给“download-git-repo”的参数\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e tmp = path.join(\x3cspan class=\x22hljs-built_in\x22\x3ehome\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.vue-templates\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3etemplate\x3c\/span\x3e.replace(\/[\\\/:]\/g, \x3cspan class=\x22hljs-string\x22\x3e\x27-\x27\x3c\/span\x3e))  \x3cspan class=\x22hljs-comment\x22\x3e\/\/远程模板下载到本地的路径\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e主逻辑\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (inPlace || exists(to)) {\n  inquirer.prompt([{\n    type: \x27confirm\x27,\n    message: inPlace\n      ? \x27Generate project in current directory?\x27\n      : \x27Target directory exists. Continue?\x27,\n    name: \x27ok\x27\n  }]).then(answers =\x3e {\n    if (answers.ok) {\n      run()\n    }\n  }).catch(logger.fatal)\n} else {\n  run()\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3eif\x3c\/span\x3e (inPlace || exists(to)) {\n  \x3cspan class=\x22hljs-selector-tag\x22\x3einquirer\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.prompt\x3c\/span\x3e([{\n    \x3cspan class=\x22hljs-attribute\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27confirm\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attribute\x22\x3emessage\x3c\/span\x3e: inPlace\n      ? \x3cspan class=\x22hljs-string\x22\x3e\x27Generate project in current directory?\x27\x3c\/span\x3e\n      : \x3cspan class=\x22hljs-string\x22\x3e\x27Target directory exists. Continue?\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attribute\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27ok\x27\x3c\/span\x3e\n  }])\x3cspan class=\x22hljs-selector-class\x22\x3e.then\x3c\/span\x3e(answers =\x26gt; {\n    \x3cspan class=\x22hljs-selector-tag\x22\x3eif\x3c\/span\x3e (answers.ok) {\n      \x3cspan class=\x22hljs-selector-tag\x22\x3erun\x3c\/span\x3e()\n    }\n  })\x3cspan class=\x22hljs-selector-class\x22\x3e.catch\x3c\/span\x3e(logger.fatal)\n} \x3cspan class=\x22hljs-selector-tag\x22\x3eelse\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-selector-tag\x22\x3erun\x3c\/span\x3e()\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e对着上面代码，\x3cstrong\x3evue-cli\x3c\/strong\x3e会判断inPlace和\x3cstrong\x3eexists(to)\x3c\/strong\x3e,true则询问开发者，当开发者回答“yes”的时候执行\x3cstrong\x3erun函数\x3c\/strong\x3e，否则直接执行\x3cstrong\x3erun函数\x3c\/strong\x3e。这里询问开发者的问题有如下两个：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3eGenerate project in current directory?\x3c\/strong\x3e  \/\/是否在当前目录下构建项目\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eTarget directory exists. Continue?\x3c\/strong\x3e \/\/构建目录已存在,是否继续\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e这两个问题依靠\x3cstrong\x3e变量inPlace\x3c\/strong\x3e来选择，下面我看一下\x3cstrong\x3e变量inPlace\x3c\/strong\x3e是怎么得来的。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const rawName = program.args[1]  \/\/rawName为命令行的第二个参数（项目构建目录的相对目录）\nconst inPlace = !rawName || rawName === \x27.\x27  \/\/rawName存在或者为“.”的时候，视为在当前目录下构建\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stata\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e rawName = \x3cspan class=\x22hljs-keyword\x22\x3eprogram\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3eargs\x3c\/span\x3e[1]  \x3cspan class=\x22hljs-comment\x22\x3e\/\/rawName为命令行的第二个参数（项目构建目录的相对目录）\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e inPlace = !rawName || rawName === \x27.\x27  \x3cspan class=\x22hljs-comment\x22\x3e\/\/rawName存在或者为“.”的时候，视为在当前目录下构建\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e通过上面的描述可知，\x3cstrong\x3e变量inPlace\x3c\/strong\x3e用于判断是否在当前目录下构建，因此\x3cstrong\x3e变量inPlace\x3c\/strong\x3e为true时，则会提示\x3cstrong\x3eGenerate project in current directory?\x3c\/strong\x3e ，反之当\x3cstrong\x3e变量inPlace\x3c\/strong\x3e为false时，此时\x3cstrong\x3eexists(to)\x3c\/strong\x3e一定为true，便提示\x3cstrong\x3eTarget directory exists. Continue?\x3c\/strong\x3e。\x3c\/p\x3e\n\x3ch4\x3eRun函数\x3c\/h4\x3e\n\x3cp\x3e\x3cstrong\x3e逻辑：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV6GHD?w=1386\x26amp;h=784\x22 src=\x22https:\/\/static.alili.tech\/img\/bV6GHD?w=1386\x26amp;h=784\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e源码：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function run () {\n  \/\/ check if template is local\n  if (isLocalPath(template)) {    \/\/是否是本地模板\n    const templatePath = getTemplatePath(template)  \/\/获取绝对路径\n    if (exists(templatePath)) {  \/\/判断模板所在路径是否存在\n       \/\/渲染模板\n      generate(name, templatePath, to, err =\x3e {\n        if (err) logger.fatal(err)\n        console.log()\n        logger.success(\x27Generated \x26quot;%s\x26quot;.\x27, name)\n      })\n    } else {\n       \/\/打印错误日志，提示本地模板不存在\n      logger.fatal(\x27Local template \x26quot;%s\x26quot; not found.\x27, template)\n    }\n  } else {\n    checkVersion(() =\x3e {  \/\/检查版本号\n      if (!hasSlash) {  \/\/官方模板还是第三方模板\n        \/\/ use official templates\n        \/\/ 从这句话以及download-git-repo的用法，我们得知了vue的官方的模板库的地址：https:\/\/github.com\/vuejs-templates\n        const officialTemplate = \x27vuejs-templates\/\x27 \x2b template\n        if (template.indexOf(\x27#\x27) !== -1) {  \/\/模板名是否带\x26quot;#\x26quot;\n          downloadAndGenerate(officialTemplate) \/\/下载模板\n        } else {\n          if (template.indexOf(\x27-2.0\x27) !== -1) { \/\/是都带\x26quot;-2.0\x26quot;\n             \/\/发出警告\n            warnings.v2SuffixTemplatesDeprecated(template, inPlace ? \x27\x27 : name)\n            return\n          }\n\n          \/\/ warnings.v2BranchIsNowDefault(template, inPlace ? \x27\x27 : name)\n          downloadAndGenerate(officialTemplate)\/\/下载模板\n        }\n      } else {\n        downloadAndGenerate(template)\/\/下载模板\n      }\n    })\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs arduino\x22\x3e\x3ccode\x3efunction \x3cspan class=\x22hljs-built_in\x22\x3erun\x3c\/span\x3e () {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ check if template is local\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3eif\x3c\/span\x3e (isLocalPath(\x3cspan class=\x22hljs-keyword\x22\x3etemplate\x3c\/span\x3e)) {    \x3cspan class=\x22hljs-comment\x22\x3e\/\/是否是本地模板\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e templatePath = getTemplatePath(\x3cspan class=\x22hljs-keyword\x22\x3etemplate\x3c\/span\x3e)  \x3cspan class=\x22hljs-comment\x22\x3e\/\/获取绝对路径\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3eexists\x3c\/span\x3e(templatePath)) {  \x3cspan class=\x22hljs-comment\x22\x3e\/\/判断模板所在路径是否存在\x3c\/span\x3e\n       \x3cspan class=\x22hljs-comment\x22\x3e\/\/渲染模板\x3c\/span\x3e\n      generate(name, templatePath, to, err =\x26gt; {\n        \x3cspan class=\x22hljs-built_in\x22\x3eif\x3c\/span\x3e (err) logger.fatal(err)\n        console.log()\n        logger.success(\x3cspan class=\x22hljs-string\x22\x3e\x27Generated \x22%s\x22.\x27\x3c\/span\x3e, name)\n      })\n    } \x3cspan class=\x22hljs-built_in\x22\x3eelse\x3c\/span\x3e {\n       \x3cspan class=\x22hljs-comment\x22\x3e\/\/打印错误日志，提示本地模板不存在\x3c\/span\x3e\n      logger.fatal(\x3cspan class=\x22hljs-string\x22\x3e\x27Local template \x22%s\x22 not found.\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3etemplate\x3c\/span\x3e)\n    }\n  } \x3cspan class=\x22hljs-built_in\x22\x3eelse\x3c\/span\x3e {\n    checkVersion(() =\x26gt; {  \x3cspan class=\x22hljs-comment\x22\x3e\/\/检查版本号\x3c\/span\x3e\n      \x3cspan class=\x22hljs-built_in\x22\x3eif\x3c\/span\x3e (!hasSlash) {  \x3cspan class=\x22hljs-comment\x22\x3e\/\/官方模板还是第三方模板\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ use official templates\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 从这句话以及download-git-repo的用法，我们得知了vue的官方的模板库的地址：https:\/\/github.com\/vuejs-templates\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e officialTemplate = \x3cspan class=\x22hljs-string\x22\x3e\x27vuejs-templates\/\x27\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-keyword\x22\x3etemplate\x3c\/span\x3e\n        \x3cspan class=\x22hljs-built_in\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etemplate\x3c\/span\x3e.indexOf(\x3cspan class=\x22hljs-string\x22\x3e\x27#\x27\x3c\/span\x3e) !== \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e) {  \x3cspan class=\x22hljs-comment\x22\x3e\/\/模板名是否带\x22#\x22\x3c\/span\x3e\n          downloadAndGenerate(officialTemplate) \x3cspan class=\x22hljs-comment\x22\x3e\/\/下载模板\x3c\/span\x3e\n        } \x3cspan class=\x22hljs-built_in\x22\x3eelse\x3c\/span\x3e {\n          \x3cspan class=\x22hljs-built_in\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etemplate\x3c\/span\x3e.indexOf(\x3cspan class=\x22hljs-string\x22\x3e\x27-2.0\x27\x3c\/span\x3e) !== \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e) { \x3cspan class=\x22hljs-comment\x22\x3e\/\/是都带\x22-2.0\x22\x3c\/span\x3e\n             \x3cspan class=\x22hljs-comment\x22\x3e\/\/发出警告\x3c\/span\x3e\n            warnings.v2SuffixTemplatesDeprecated(\x3cspan class=\x22hljs-keyword\x22\x3etemplate\x3c\/span\x3e, inPlace ? \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e : name)\n            \x3cspan class=\x22hljs-built_in\x22\x3ereturn\x3c\/span\x3e\n          }\n\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ warnings.v2BranchIsNowDefault(template, inPlace ? \x27\x27 : name)\x3c\/span\x3e\n          downloadAndGenerate(officialTemplate)\x3cspan class=\x22hljs-comment\x22\x3e\/\/下载模板\x3c\/span\x3e\n        }\n      } \x3cspan class=\x22hljs-built_in\x22\x3eelse\x3c\/span\x3e {\n        downloadAndGenerate(\x3cspan class=\x22hljs-keyword\x22\x3etemplate\x3c\/span\x3e)\x3cspan class=\x22hljs-comment\x22\x3e\/\/下载模板\x3c\/span\x3e\n      }\n    })\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3edownloadAndGenerate函数\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function downloadAndGenerate (template) {\n  const spinner = ora(\x27downloading template\x27)  \n  spinner.start()\/\/显示加载状态\n  \/\/ Remove if local template exists\n  if (exists(tmp)) rm(tmp)  \/\/当前模板库是否存在该模板，存在就删除\n   \/\/下载模板  template-模板名    tmp- 模板路径   clone-是否采用git clone模板   err-错误短信\n    \n  download(template, tmp, { clone }, err =\x3e {\n    spinner.stop() \/\/隐藏加载状态\n    \/\/如果有错误，打印错误日志\n    if (err) logger.fatal(\x27Failed to download repo \x27 \x2b template \x2b \x27: \x27 \x2b err.message.trim())\n    \/\/渲染模板\n    generate(name, tmp, to, err =\x3e {\n      if (err) logger.fatal(err)\n      console.log()\n      logger.success(\x27Generated \x26quot;%s\x26quot;.\x27, name)\n    })\n  })\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stata\x22\x3e\x3ccode\x3efunction downloadAndGenerate (template) {\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e spinner = ora(\x27downloading template\x27)  \n  spinner.start()\x3cspan class=\x22hljs-comment\x22\x3e\/\/显示加载状态\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Remove if local template exists\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (exists(tmp)) \x3cspan class=\x22hljs-keyword\x22\x3erm\x3c\/span\x3e(tmp)  \x3cspan class=\x22hljs-comment\x22\x3e\/\/当前模板库是否存在该模板，存在就删除\x3c\/span\x3e\n   \x3cspan class=\x22hljs-comment\x22\x3e\/\/下载模板  template-模板名    tmp- 模板路径   clone-是否采用git clone模板   err-错误短信\x3c\/span\x3e\n    \n  download(template, tmp, { clone }, \x3cspan class=\x22hljs-keyword\x22\x3eerr\x3c\/span\x3e =\x26gt; {\n    spinner.stop() \x3cspan class=\x22hljs-comment\x22\x3e\/\/隐藏加载状态\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果有错误，打印错误日志\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3eerr\x3c\/span\x3e) logger.fatal(\x27Failed to download repo \x27 \x2b template \x2b \x27: \x27 \x2b \x3cspan class=\x22hljs-keyword\x22\x3eerr\x3c\/span\x3e.message.\x3cspan class=\x22hljs-built_in\x22\x3etrim\x3c\/span\x3e())\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/渲染模板\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3egenerate\x3c\/span\x3e(name, tmp, to, \x3cspan class=\x22hljs-keyword\x22\x3eerr\x3c\/span\x3e =\x26gt; {\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3eerr\x3c\/span\x3e) logger.fatal(\x3cspan class=\x22hljs-keyword\x22\x3eerr\x3c\/span\x3e)\n      console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e()\n      logger.success(\x27Generated \x3cspan class=\x22hljs-string\x22\x3e\x22%s\x22\x3c\/span\x3e.\x27, name)\n    })\n  })\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3elib\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3egenerate.js （★）\x3c\/h3\x3e\n\x3cp\x3elib文件下最重要的js文件，他是我们构建项目中最重要的一环，根据模板渲染成我们需要的项目。这块内容是需要我们重点关注的。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const chalk = require(\x27chalk\x27)\nconst Metalsmith = require(\x27metalsmith\x27)\nconst Handlebars = require(\x27handlebars\x27)\nconst async = require(\x27async\x27)\nconst render = require(\x27consolidate\x27).handlebars.render\nconst path = require(\x27path\x27)\nconst multimatch = require(\x27multimatch\x27)\nconst getOptions = require(\x27.\/options\x27)\nconst ask = require(\x27.\/ask\x27)\nconst filter = require(\x27.\/filter\x27)\nconst logger = require(\x27.\/logger\x27)\n\n\/\/ register handlebars helper  注册handlebars的helper\nHandlebars.registerHelper(\x27if_eq\x27, function (a, b, opts) {\n  return a === b\n    ? opts.fn(this)\n    : opts.inverse(this)\n})\n\nHandlebars.registerHelper(\x27unless_eq\x27, function (a, b, opts) {\n  return a === b\n    ? opts.inverse(this)\n    : opts.fn(this)\n})\n\n\/**\n * Generate a template given a `src` and `dest`.\n *\n * @param {String} name\n * @param {String} src\n * @param {String} dest\n * @param {Function} done\n *\/\n\nmodule.exports = function generate (name, src, dest, done) {\n  const opts = getOptions(name, src)  \/\/获取配置\n  const metalsmith = Metalsmith(path.join(src, \x27template\x27))  \/\/初始化Metalsmith对象\n  const data = Object.assign(metalsmith.metadata(), {\n    destDirName: name,\n    inPlace: dest === process.cwd(),\n    noEscape: true\n  })\/\/添加一些变量至metalsmith中，并获取metalsmith中全部变量\n  \n  \/\/注册配置对象中的helper\n  opts.helpers \x26amp;\x26amp; Object.keys(opts.helpers).map(key =\x3e {\n    Handlebars.registerHelper(key, opts.helpers[key])\n  })\n\n  const helpers = { chalk, logger }\n\n \/\/配置对象是否有before函数，是则执行\n  if (opts.metalsmith \x26amp;\x26amp; typeof opts.metalsmith.before === \x27function\x27) {\n    opts.metalsmith.before(metalsmith, opts, helpers)\n  }\n\n  metalsmith.use(askQuestions(opts.prompts))  \/\/询问问题\n    .use(filterFiles(opts.filters))  \/\/过滤文件\n    .use(renderTemplateFiles(opts.skipInterpolation)) \/\/渲染模板文件\n\n\n  \/\/配置对象是否有after函数，是则执行\n  if (typeof opts.metalsmith === \x27function\x27) {\n    opts.metalsmith(metalsmith, opts, helpers)\n  } else if (opts.metalsmith \x26amp;\x26amp; typeof opts.metalsmith.after === \x27function\x27) {\n    opts.metalsmith.after(metalsmith, opts, helpers)\n  }\n\n  metalsmith.clean(false) \n    .source(\x27.\x27) \/\/ start from template root instead of `.\/src` which is Metalsmith\x27s default for `source`\n    .destination(dest)\n    .build((err, files) =\x3e {\n      done(err)\n      if (typeof opts.complete === \x27function\x27) {\n      \/\/配置对象有complete函数则执行\n        const helpers = { chalk, logger, files }\n        opts.complete(data, helpers)\n      } else {\n      \/\/配置对象有completeMessage，执行logMessage函数\n        logMessage(opts.completeMessage, data)\n      }\n    })\n\n  return data\n}\n\n\/**\n * Create a middleware for asking questions.\n *\n * @param {Object} prompts\n * @return {Function}\n *\/\n\nfunction askQuestions (prompts) {\n  return (files, metalsmith, done) =\x3e {\n    ask(prompts, metalsmith.metadata(), done)\n  }\n}\n\n\/**\n * Create a middleware for filtering files.\n *\n * @param {Object} filters\n * @return {Function}\n *\/\n\nfunction filterFiles (filters) {\n  return (files, metalsmith, done) =\x3e {\n    filter(files, filters, metalsmith.metadata(), done)\n  }\n}\n\n\/**\n * Template in place plugin.\n *\n * @param {Object} files\n * @param {Metalsmith} metalsmith\n * @param {Function} done\n *\/\n\nfunction renderTemplateFiles (skipInterpolation) {\n  skipInterpolation = typeof skipInterpolation === \x27string\x27\n    ? [skipInterpolation]\n    : skipInterpolation    \/\/保证skipInterpolation是一个数组\n  return (files, metalsmith, done) =\x3e {\n    const keys = Object.keys(files) \/\/获取files的所有key\n    const metalsmithMetadata = metalsmith.metadata() \/\/获取metalsmith的所有变量\n    async.each(keys, (file, next) =\x3e { \/\/异步处理所有files\n      \/\/ skipping files with skipInterpolation option  \n      \/\/ 跳过符合skipInterpolation的要求的file\n      if (skipInterpolation \x26amp;\x26amp; multimatch([file], skipInterpolation, { dot: true }).length) {\n        return next()\n      }\n      \/\/获取文件的文本内容\n      const str = files[file].contents.toString()\n      \/\/ do not attempt to render files that do not have mustaches\n      \/\/跳过不符合handlebars语法的file\n      if (!\/\x22{{\x22([^{}]\x2b)\x22}}\x22\/g.test(str)) {  \n        return next()\n      }\n      \/\/渲染文件\n      render(str, metalsmithMetadata, (err, res) =\x3e {\n        if (err) {\n          err.message = `[${file}] ${err.message}`\n          return next(err)\n        }\n        files[file].contents = new Buffer(res)\n        next()\n      })\n    }, done)\n  }\n}\n\n\/**\n * Display template complete message.\n *\n * @param {String} message\n * @param {Object} data\n *\/\n\nfunction logMessage (message, data) {\n  if (!message) return  \/\/没有message直接退出函数\n  render(message, data, (err, res) =\x3e {\n    if (err) {\n      console.error(\x27\\n   Error when rendering template complete message: \x27 \x2b err.message.trim())  \/\/渲染错误打印错误信息\n    } else {\n      console.log(\x27\\n\x27 \x2b res.split(\/\\r?\\n\/g).map(line =\x3e \x27   \x27 \x2b line).join(\x27\\n\x27))\n      \/\/渲染成功打印最终渲染的结果\n    }\n  })\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e chalk = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27chalk\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e Metalsmith = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27metalsmith\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e Handlebars = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27handlebars\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3easync\x3c\/span\x3e = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27async\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e render = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27consolidate\x27\x3c\/span\x3e).handlebars.render\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e path = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27path\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e multimatch = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27multimatch\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e getOptions = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/options\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ask = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/ask\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e filter = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/filter\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e logger = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/logger\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ register handlebars helper  注册handlebars的helper\x3c\/span\x3e\nHandlebars.registerHelper(\x3cspan class=\x22hljs-string\x22\x3e\x27if_eq\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ea, b, opts\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e a === b\n    ? opts.fn(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e)\n    : opts.inverse(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e)\n})\n\nHandlebars.registerHelper(\x3cspan class=\x22hljs-string\x22\x3e\x27unless_eq\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ea, b, opts\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e a === b\n    ? opts.inverse(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e)\n    : opts.fn(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e)\n})\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Generate a template given a `src` and `dest`.\n *\n * @param {String} name\n * @param {String} src\n * @param {String} dest\n * @param {Function} done\n *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egenerate\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ename, src, dest, done\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e opts = getOptions(name, src)  \x3cspan class=\x22hljs-comment\x22\x3e\/\/获取配置\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e metalsmith = Metalsmith(path.join(src, \x3cspan class=\x22hljs-string\x22\x3e\x27template\x27\x3c\/span\x3e))  \x3cspan class=\x22hljs-comment\x22\x3e\/\/初始化Metalsmith对象\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e data = \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.assign(metalsmith.metadata(), {\n    \x3cspan class=\x22hljs-attr\x22\x3edestDirName\x3c\/span\x3e: name,\n    \x3cspan class=\x22hljs-attr\x22\x3einPlace\x3c\/span\x3e: dest === process.cwd(),\n    \x3cspan class=\x22hljs-attr\x22\x3enoEscape\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n  })\x3cspan class=\x22hljs-comment\x22\x3e\/\/添加一些变量至metalsmith中，并获取metalsmith中全部变量\x3c\/span\x3e\n  \n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/注册配置对象中的helper\x3c\/span\x3e\n  opts.helpers \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.keys(opts.helpers).map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ekey\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    Handlebars.registerHelper(key, opts.helpers[key])\n  })\n\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e helpers = { chalk, logger }\n\n \x3cspan class=\x22hljs-comment\x22\x3e\/\/配置对象是否有before函数，是则执行\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (opts.metalsmith \x26amp;\x26amp; \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e opts.metalsmith.before === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e) {\n    opts.metalsmith.before(metalsmith, opts, helpers)\n  }\n\n  metalsmith.use(askQuestions(opts.prompts))  \x3cspan class=\x22hljs-comment\x22\x3e\/\/询问问题\x3c\/span\x3e\n    .use(filterFiles(opts.filters))  \x3cspan class=\x22hljs-comment\x22\x3e\/\/过滤文件\x3c\/span\x3e\n    .use(renderTemplateFiles(opts.skipInterpolation)) \x3cspan class=\x22hljs-comment\x22\x3e\/\/渲染模板文件\x3c\/span\x3e\n\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/配置对象是否有after函数，是则执行\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e opts.metalsmith === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e) {\n    opts.metalsmith(metalsmith, opts, helpers)\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (opts.metalsmith \x26amp;\x26amp; \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e opts.metalsmith.after === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e) {\n    opts.metalsmith.after(metalsmith, opts, helpers)\n  }\n\n  metalsmith.clean(\x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e) \n    .source(\x3cspan class=\x22hljs-string\x22\x3e\x27.\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ start from template root instead of `.\/src` which is Metalsmith\x27s default for `source`\x3c\/span\x3e\n    .destination(dest)\n    .build(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr, files\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n      done(err)\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e opts.complete === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/配置对象有complete函数则执行\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e helpers = { chalk, logger, files }\n        opts.complete(data, helpers)\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/配置对象有completeMessage，执行logMessage函数\x3c\/span\x3e\n        logMessage(opts.completeMessage, data)\n      }\n    })\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e data\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Create a middleware for asking questions.\n *\n * @param {Object} prompts\n * @return {Function}\n *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3easkQuestions\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eprompts\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3efiles, metalsmith, done\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    ask(prompts, metalsmith.metadata(), done)\n  }\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Create a middleware for filtering files.\n *\n * @param {Object} filters\n * @return {Function}\n *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efilterFiles\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3efilters\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3efiles, metalsmith, done\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    filter(files, filters, metalsmith.metadata(), done)\n  }\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Template in place plugin.\n *\n * @param {Object} files\n * @param {Metalsmith} metalsmith\n * @param {Function} done\n *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erenderTemplateFiles\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eskipInterpolation\x3c\/span\x3e) \x3c\/span\x3e{\n  skipInterpolation = \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e skipInterpolation === \x3cspan class=\x22hljs-string\x22\x3e\x27string\x27\x3c\/span\x3e\n    ? [skipInterpolation]\n    : skipInterpolation    \x3cspan class=\x22hljs-comment\x22\x3e\/\/保证skipInterpolation是一个数组\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3efiles, metalsmith, done\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e keys = \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.keys(files) \x3cspan class=\x22hljs-comment\x22\x3e\/\/获取files的所有key\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e metalsmithMetadata = metalsmith.metadata() \x3cspan class=\x22hljs-comment\x22\x3e\/\/获取metalsmith的所有变量\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3easync\x3c\/span\x3e.each(keys, (file, next) =\x26gt; { \x3cspan class=\x22hljs-comment\x22\x3e\/\/异步处理所有files\x3c\/span\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ skipping files with skipInterpolation option  \x3c\/span\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 跳过符合skipInterpolation的要求的file\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (skipInterpolation \x26amp;\x26amp; multimatch([file], skipInterpolation, { \x3cspan class=\x22hljs-attr\x22\x3edot\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e }).length) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e next()\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/获取文件的文本内容\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e str = files[file].contents.toString()\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ do not attempt to render files that do not have mustaches\x3c\/span\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/跳过不符合handlebars语法的file\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-regexp\x22\x3e\/\x22{{\x22([^{}]\x2b)\x22}}\x22\/g\x3c\/span\x3e.test(str)) {  \n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e next()\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/渲染文件\x3c\/span\x3e\n      render(str, metalsmithMetadata, (err, res) =\x26gt; {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (err) {\n          err.message = \x3cspan class=\x22hljs-string\x22\x3e`[\x3cspan class=\x22hljs-subst\x22\x3e${file}\x3c\/span\x3e] \x3cspan class=\x22hljs-subst\x22\x3e${err.message}\x3c\/span\x3e`\x3c\/span\x3e\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e next(err)\n        }\n        files[file].contents = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Buffer(res)\n        next()\n      })\n    }, done)\n  }\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Display template complete message.\n *\n * @param {String} message\n * @param {Object} data\n *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3elogMessage\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3emessage, data\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!message) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/\/没有message直接退出函数\x3c\/span\x3e\n  render(message, data, (err, res) =\x26gt; {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (err) {\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error(\x3cspan class=\x22hljs-string\x22\x3e\x27\\n   Error when rendering template complete message: \x27\x3c\/span\x3e \x2b err.message.trim())  \x3cspan class=\x22hljs-comment\x22\x3e\/\/渲染错误打印错误信息\x3c\/span\x3e\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27\\n\x27\x3c\/span\x3e \x2b res.split(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\r?\\n\/g\x3c\/span\x3e).map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eline\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27   \x27\x3c\/span\x3e \x2b line).join(\x3cspan class=\x22hljs-string\x22\x3e\x27\\n\x27\x3c\/span\x3e))\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/渲染成功打印最终渲染的结果\x3c\/span\x3e\n    }\n  })\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e引入的包：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3echalk\x3c\/strong\x3e    \/\/用于高亮终端打印出来的信息。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3emetalsmith\x3c\/strong\x3e   \/\/静态网站生成器。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3ehandlebars\x3c\/strong\x3e  \/\/知名的模板引擎。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3easync\x3c\/strong\x3e  \/\/非常强大的异步处理工具。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3econsolidate\x3c\/strong\x3e  \/\/支持各种模板引擎的渲染。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3epath\x3c\/strong\x3e  \/\/node自带path模块，用于路径的处理。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3emultimatch\x3c\/strong\x3e  \/\/ 可以支持多个条件的匹配。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eoptions\x3c\/strong\x3e  \/\/自定义工具-用于获取模板配置。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eask\x3c\/strong\x3e  \/\/自定义工具-用于询问开发者。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3efilter\x3c\/strong\x3e  \/\/自定义工具-用于文件过滤。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3elogger\x3c\/strong\x3e  \/\/自定义工具-用于日志打印。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e主逻辑：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e获取模板配置\x3c\/strong\x3e --\x26gt;\x3cstrong\x3e初始化Metalsmith\x3c\/strong\x3e --\x26gt;\x3cstrong\x3e添加一些变量至Metalsmith\x3c\/strong\x3e --\x26gt;\x3cstrong\x3ehandlebars模板注册helper\x3c\/strong\x3e --\x26gt;\x3cstrong\x3e配置对象中是否有before函数，有则执行\x3c\/strong\x3e --\x26gt;\x3cstrong\x3e询问问题\x3c\/strong\x3e --\x26gt;\x3cstrong\x3e过滤文件\x3c\/strong\x3e --\x26gt;\x3cstrong\x3e渲染模板文件\x3c\/strong\x3e --\x26gt;\x3cstrong\x3e配置对象中是否有after函数，有则执行\x3c\/strong\x3e --\x26gt;\x3cstrong\x3e最后构建项目内容\x3c\/strong\x3e --\x26gt;\x3cstrong\x3e构建完成，成功若配置对象中有complete函数则执行，否则打印配置对象中的completeMessage信息，如果有错误，执行回调函数done(err)\x3c\/strong\x3e \x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e其他函数：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3easkQuestions:\x3c\/strong\x3e 询问问题\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3efilterFiles:\x3c\/strong\x3e 过滤文件\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3erenderTemplateFiles:\x3c\/strong\x3e 渲染模板文件\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3elogMessage:\x3c\/strong\x3e 用于构建成功时，打印信息\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3eMetalsmith插件格式：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function \x3cfunction name\x3e {\n  return (files,metalsmith,done)=\x3e{\n    \/\/逻辑代码\n    ...\n  }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs fortran\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3c\/span\x3e \x26lt;\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ename\x3c\/span\x3e\x26gt; {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (files,metalsmith,done)=\x26gt;{\n    \/\/逻辑代码\n    ...\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3eoptions.js\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const path = require(\x27path\x27)\nconst metadata = require(\x27read-metadata\x27)\nconst exists = require(\x27fs\x27).existsSync\nconst getGitUser = require(\x27.\/git-user\x27)\nconst validateName = require(\x27validate-npm-package-name\x27)\n\n\/**\n * Read prompts metadata.\n *\n * @param {String} dir\n * @return {Object}\n *\/\n\nmodule.exports = function options (name, dir) {\n  const opts = getMetadata(dir)\n\n  setDefault(opts, \x27name\x27, name)\n  setValidateName(opts)\n\n  const author = getGitUser()\n  if (author) {\n    setDefault(opts, \x27author\x27, author)\n  }\n\n  return opts\n}\n\n\/**\n * Gets the metadata from either a meta.json or meta.js file.\n *\n * @param  {String} dir\n * @return {Object}\n *\/\n\nfunction getMetadata (dir) {\n  const json = path.join(dir, \x27meta.json\x27)\n  const js = path.join(dir, \x27meta.js\x27)\n  let opts = {}\n\n  if (exists(json)) {\n    opts = metadata.sync(json)\n  } else if (exists(js)) {\n    const req = require(path.resolve(js))\n    if (req !== Object(req)) {\n      throw new Error(\x27meta.js needs to expose an object\x27)\n    }\n    opts = req\n  }\n\n  return opts\n}\n\n\/**\n * Set the default value for a prompt question\n *\n * @param {Object} opts\n * @param {String} key\n * @param {String} val\n *\/\n\nfunction setDefault (opts, key, val) {\n  if (opts.schema) {\n    opts.prompts = opts.schema\n    delete opts.schema\n  }\n  const prompts = opts.prompts || (opts.prompts = {})\n  if (!prompts[key] || typeof prompts[key] !== \x27object\x27) {\n    prompts[key] = {\n      \x27type\x27: \x27string\x27,\n      \x27default\x27: val\n    }\n  } else {\n    prompts[key][\x27default\x27] = val\n  }\n}\n\nfunction setValidateName (opts) {\n  const name = opts.prompts.name\n  const customValidate = name.validate\n  name.validate = name =\x3e {\n    const its = validateName(name)\n    if (!its.validForNewPackages) {\n      const errors = (its.errors || []).concat(its.warnings || [])\n      return \x27Sorry, \x27 \x2b errors.join(\x27 and \x27) \x2b \x27.\x27\n    }\n    if (typeof customValidate === \x27function\x27) return customValidate(name)\n    return true\n  }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e path = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27path\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e metadata = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27read-metadata\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e exists = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27fs\x27\x3c\/span\x3e).existsSync\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e getGitUser = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/git-user\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e validateName = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27validate-npm-package-name\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Read prompts metadata.\n *\n * @param {String} dir\n * @return {Object}\n *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eoptions\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ename, dir\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e opts = getMetadata(dir)\n\n  setDefault(opts, \x3cspan class=\x22hljs-string\x22\x3e\x27name\x27\x3c\/span\x3e, name)\n  setValidateName(opts)\n\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e author = getGitUser()\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (author) {\n    setDefault(opts, \x3cspan class=\x22hljs-string\x22\x3e\x27author\x27\x3c\/span\x3e, author)\n  }\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e opts\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Gets the metadata from either a meta.json or meta.js file.\n *\n * @param  {String} dir\n * @return {Object}\n *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetMetadata\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3edir\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e json = path.join(dir, \x3cspan class=\x22hljs-string\x22\x3e\x27meta.json\x27\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e js = path.join(dir, \x3cspan class=\x22hljs-string\x22\x3e\x27meta.js\x27\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e opts = {}\n\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (exists(json)) {\n    opts = metadata.sync(json)\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (exists(js)) {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e req = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(path.resolve(js))\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (req !== \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e(req)) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27meta.js needs to expose an object\x27\x3c\/span\x3e)\n    }\n    opts = req\n  }\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e opts\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Set the default value for a prompt question\n *\n * @param {Object} opts\n * @param {String} key\n * @param {String} val\n *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esetDefault\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eopts, key, val\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (opts.schema) {\n    opts.prompts = opts.schema\n    \x3cspan class=\x22hljs-keyword\x22\x3edelete\x3c\/span\x3e opts.schema\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e prompts = opts.prompts || (opts.prompts = {})\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!prompts[key] || \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e prompts[key] !== \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e) {\n    prompts[key] = {\n      \x3cspan class=\x22hljs-string\x22\x3e\x27type\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27string\x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x27default\x27\x3c\/span\x3e: val\n    }\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    prompts[key][\x3cspan class=\x22hljs-string\x22\x3e\x27default\x27\x3c\/span\x3e] = val\n  }\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esetValidateName\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eopts\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e name = opts.prompts.name\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e customValidate = name.validate\n  name.validate = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ename\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e its = validateName(name)\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!its.validForNewPackages) {\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e errors = (its.errors || []).concat(its.warnings || [])\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Sorry, \x27\x3c\/span\x3e \x2b errors.join(\x3cspan class=\x22hljs-string\x22\x3e\x27 and \x27\x3c\/span\x3e) \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27.\x27\x3c\/span\x3e\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e customValidate === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e customValidate(name)\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e引入的包：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3epath\x3c\/strong\x3e    \/\/node自带path模块，用于路径的处理\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eread-metadata\x3c\/strong\x3e    \/\/用于读取json或者yaml元数据文件并返回一个对象\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3efs.existsSync\x3c\/strong\x3e    \/\/node自带fs模块的existsSync方法，用于检测路径是否存在\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3egit-user\x3c\/strong\x3e    \/\/获取本地的git配置\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3evalidate-npm-package-name\x3c\/strong\x3e  \/\/用于npm包的名字是否是合法的\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e作用：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3e主方法:\x3c\/strong\x3e 第一步：先获取模板的配置文件信息；第二步：设置name字段并检测name是否合法；第三步：只是author字段。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3egetMetadata:\x3c\/strong\x3e 获取meta.js或则meta.json中的配置信息\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3esetDefault:\x3c\/strong\x3e 用于向配置对象中添加一下默认字段\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3esetValidateName:\x3c\/strong\x3e 用于检测配置对象中name字段是否合法\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch4\x3egit-user.js\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const exec = require(\x27child_process\x27).execSync\n\nmodule.exports = () =\x3e {\n  let name\n  let email\n\n  try {\n    name = exec(\x27git config --get user.name\x27)\n    email = exec(\x27git config --get user.email\x27)\n  } catch (e) {}\n\n  name = name \x26amp;\x26amp; JSON.stringify(name.toString().trim()).slice(1, -1)\n  email = email \x26amp;\x26amp; (\x27 \x3c\x27 \x2b email.toString().trim() \x2b \x27\x3e\x27)\n  return (name || \x27\x27) \x2b (email || \x27\x27)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs sqf\x22\x3e\x3ccode\x3econst \x3cspan class=\x22hljs-built_in\x22\x3eexec\x3c\/span\x3e = require(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e).execSync\n\nmodule.exports = () =\x26gt; {\n  let \x3cspan class=\x22hljs-built_in\x22\x3ename\x3c\/span\x3e\n  let email\n\n  \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3ename\x3c\/span\x3e = \x3cspan class=\x22hljs-built_in\x22\x3eexec\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27git config --get user.name\x27\x3c\/span\x3e)\n    email = \x3cspan class=\x22hljs-built_in\x22\x3eexec\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27git config --get user.email\x27\x3c\/span\x3e)\n  } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (e) {}\n\n  \x3cspan class=\x22hljs-built_in\x22\x3ename\x3c\/span\x3e = \x3cspan class=\x22hljs-built_in\x22\x3ename\x3c\/span\x3e \x26amp;\x26amp; JSON.stringify(\x3cspan class=\x22hljs-built_in\x22\x3ename\x3c\/span\x3e.\x3cspan class=\x22hljs-built_in\x22\x3etoString\x3c\/span\x3e().trim()).slice(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, -\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)\n  email = email \x26amp;\x26amp; (\x3cspan class=\x22hljs-string\x22\x3e\x27 \x26lt;\x27\x3c\/span\x3e \x2b email.\x3cspan class=\x22hljs-built_in\x22\x3etoString\x3c\/span\x3e().trim() \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x26gt;\x27\x3c\/span\x3e)\n  return (\x3cspan class=\x22hljs-built_in\x22\x3ename\x3c\/span\x3e || \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e) \x2b (email || \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e引入的包：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cstrong\x3echild_process.execSync\x3c\/strong\x3e    \/\/node自带模块child_process中的execSync方法用于新开一个shell并执行相应的command，并返回相应的输出。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e作用：\x3c\/strong\x3e 用于获取本地的git配置的用户名和邮件，并返回格式 \x3cstrong\x3e姓名\x26lt;邮箱\x26gt;\x3c\/strong\x3e 的字符串。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3eeval.js\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const chalk = require(\x27chalk\x27)\n\n\/**\n * Evaluate an expression in meta.json in the context of\n * prompt answers data.\n *\/\n\nmodule.exports = function evaluate (exp, data) {\n  \/* eslint-disable no-new-func *\/\n  const fn = new Function(\x27data\x27, \x27with (data) { return \x27 \x2b exp \x2b \x27}\x27)\n  try {\n    return fn(data)\n  } catch (e) {\n    console.error(chalk.red(\x27Error when evaluating filter condition: \x27 \x2b exp))\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e chalk = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27chalk\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Evaluate an expression in meta.json in the context of\n * prompt answers data.\n *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eevaluate\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eexp, data\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/* eslint-disable no-new-func *\/\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e fn = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eFunction\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27with (data) { return \x27\x3c\/span\x3e \x2b exp \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27}\x27\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e fn(data)\n  } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (e) {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error(chalk.red(\x3cspan class=\x22hljs-string\x22\x3e\x27Error when evaluating filter condition: \x27\x3c\/span\x3e \x2b exp))\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e引入的包：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cstrong\x3echalk\x3c\/strong\x3e    \/\/用于高亮终端打印出来的信息。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e作用：\x3c\/strong\x3e 在data的作用域执行exp表达式并返回其执行得到的值\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader14\x22\x3eask.js\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const async = require(\x27async\x27)\nconst inquirer = require(\x27inquirer\x27)\nconst evaluate = require(\x27.\/eval\x27)\n\n\/\/ Support types from prompt-for which was used before\nconst promptMapping = {\n  string: \x27input\x27,\n  boolean: \x27confirm\x27\n}\n\n\/**\n * Ask questions, return results.\n *\n * @param {Object} prompts\n * @param {Object} data\n * @param {Function} done\n *\/\n \n\/**\n * prompts meta.js或者meta.json中的prompts字段\n * data metalsmith.metadata()\n * done 交于下一个metalsmith插件处理\n *\/\nmodule.exports = function ask (prompts, data, done) {\n \/\/遍历处理prompts下的每一个字段\n  async.eachSeries(Object.keys(prompts), (key, next) =\x3e {\n    prompt(data, key, prompts[key], next)\n  }, done)\n}\n\n\/**\n * Inquirer prompt wrapper.\n *\n * @param {Object} data\n * @param {String} key\n * @param {Object} prompt\n * @param {Function} done\n *\/\n\nfunction prompt (data, key, prompt, done) {\n  \/\/ skip prompts whose when condition is not met\n  if (prompt.when \x26amp;\x26amp; !evaluate(prompt.when, data)) {\n    return done()\n  }\n\n  \/\/获取默认值\n  let promptDefault = prompt.default\n  if (typeof prompt.default === \x27function\x27) {\n    promptDefault = function () {\n      return prompt.default.bind(this)(data)\n    }\n  }\n  \/\/设置问题，具体使用方法可去https:\/\/github.com\/SBoudrias\/Inquirer.js上面查看\n  inquirer.prompt([{\n    type: promptMapping[prompt.type] || prompt.type,\n    name: key,\n    message: prompt.message || prompt.label || key,\n    default: promptDefault,\n    choices: prompt.choices || [],\n    validate: prompt.validate || (() =\x3e true)\n  }]).then(answers =\x3e {\n    if (Array.isArray(answers[key])) { \n      \/\/当答案是一个数组时\n      data[key] = {}\n      answers[key].forEach(multiChoiceAnswer =\x3e {\n        data[key][multiChoiceAnswer] = true\n      })\n    } else if (typeof answers[key] === \x27string\x27) {\n     \/\/当答案是一个字符串时\n      data[key] = answers[key].replace(\/\x26quot;\/g, \x27\\\\\x26quot;\x27)\n    } else {\n     \/\/其他情况\n      data[key] = answers[key]\n    }\n    done()\n  }).catch(done)\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3easync\x3c\/span\x3e = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27async\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e inquirer = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27inquirer\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e evaluate = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/eval\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Support types from prompt-for which was used before\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e promptMapping = {\n  \x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27input\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-built_in\x22\x3eboolean\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27confirm\x27\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Ask questions, return results.\n *\n * @param {Object} prompts\n * @param {Object} data\n * @param {Function} done\n *\/\x3c\/span\x3e\n \n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * prompts meta.js或者meta.json中的prompts字段\n * data metalsmith.metadata()\n * done 交于下一个metalsmith插件处理\n *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eask\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eprompts, data, done\x3c\/span\x3e) \x3c\/span\x3e{\n \x3cspan class=\x22hljs-comment\x22\x3e\/\/遍历处理prompts下的每一个字段\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3easync\x3c\/span\x3e.eachSeries(\x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.keys(prompts), \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3ekey, next\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    prompt(data, key, prompts[key], next)\n  }, done)\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Inquirer prompt wrapper.\n *\n * @param {Object} data\n * @param {String} key\n * @param {Object} prompt\n * @param {Function} done\n *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eprompt\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3edata, key, prompt, done\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ skip prompts whose when condition is not met\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (prompt.when \x26amp;\x26amp; !evaluate(prompt.when, data)) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e done()\n  }\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/获取默认值\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e promptDefault = prompt.default\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e prompt.default === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e) {\n    promptDefault = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e prompt.default.bind(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e)(data)\n    }\n  }\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/设置问题，具体使用方法可去https:\/\/github.com\/SBoudrias\/Inquirer.js上面查看\x3c\/span\x3e\n  inquirer.prompt([{\n    \x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e: promptMapping[prompt.type] || prompt.type,\n    name: key,\n    message: prompt.message || prompt.label || key,\n    \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e: promptDefault,\n    choices: prompt.choices || [],\n    validate: prompt.validate || \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) =\x26gt; \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\x3c\/span\x3e)\n  }]).\x3cspan class=\x22hljs-params\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eanswers =\x26gt; {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e.isArray(\x3cspan class=\x22hljs-params\x22\x3eanswers[key]\x3c\/span\x3e)\x3c\/span\x3e) { \n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/当答案是一个数组时\x3c\/span\x3e\n      data[key] = {}\n      answers[key].forEach(\x3cspan class=\x22hljs-params\x22\x3emultiChoiceAnswer =\x26gt; {\n        data[key][multiChoiceAnswer] = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n      }\x3c\/span\x3e)\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e answers[key] === \x27\x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e\x27\x3c\/span\x3e) {\n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/当答案是一个字符串时\x3c\/span\x3e\n      data[key] = answers[key].replace(\x3cspan class=\x22hljs-params\x22\x3e\/\x22\/g, \x27\\\\\x22\x27\x3c\/span\x3e)\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/其他情况\x3c\/span\x3e\n      data[key] = answers[key]\n    }\n    done(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\n  }\x3c\/span\x3e).\x3cspan class=\x22hljs-params\x22\x3ecatch\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edone\x3c\/span\x3e)\n}\n\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e引入的包：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3easync\x3c\/strong\x3e    \/\/异步处理工具。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3einquirer\x3c\/strong\x3e  \/\/命令行与用户之间的交互\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eeval\x3c\/strong\x3e      \/\/返回某作用下表达式的值\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e作用：\x3c\/strong\x3e 将meta.js或者meta.json中的prompts字段解析成对应的问题询问。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader15\x22\x3efilter.js\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const match = require(\x27minimatch\x27)\nconst evaluate = require(\x27.\/eval\x27)\n\/**\n * files 模板内的所有文件\n * filters meta.js或者meta.json的filters字段\n * data metalsmith.metadata()\n * done  交于下一个metalsmith插件处理\n *\/\nmodule.exports = (files, filters, data, done) =\x3e {\n  if (!filters) {\n    \/\/meta.js或者meta.json没有filters字段直接跳过交于下一个metalsmith插件处理\n    return done()\n  }\n  \/\/获取所有文件的名字\n  const fileNames = Object.keys(files)\n  \/\/遍历meta.js或者meta.json没有filters下的所有字段\n  Object.keys(filters).forEach(glob =\x3e {\n    \/\/遍历所有文件名\n    fileNames.forEach(file =\x3e {\n      \/\/如果有文件名跟filters下的某一个字段匹配上\n      if (match(file, glob, { dot: true })) {        \n        const condition = filters[glob]\n        if (!evaluate(condition, data)) {\n          \/\/如果metalsmith.metadata()下condition表达式不成立，删除该文件\n          delete files[file]\n        }\n      }\n    })\n  })\n  done()\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e match = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27minimatch\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e evaluate = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/eval\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * files 模板内的所有文件\n * filters meta.js或者meta.json的filters字段\n * data metalsmith.metadata()\n * done  交于下一个metalsmith插件处理\n *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3efiles, filters, data, done\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!filters) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/meta.js或者meta.json没有filters字段直接跳过交于下一个metalsmith插件处理\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e done()\n  }\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/获取所有文件的名字\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e fileNames = \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.keys(files)\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/遍历meta.js或者meta.json没有filters下的所有字段\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.keys(filters).forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eglob\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/遍历所有文件名\x3c\/span\x3e\n    fileNames.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3efile\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果有文件名跟filters下的某一个字段匹配上\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (match(file, glob, { \x3cspan class=\x22hljs-attr\x22\x3edot\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e })) {        \n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e condition = filters[glob]\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!evaluate(condition, data)) {\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果metalsmith.metadata()下condition表达式不成立，删除该文件\x3c\/span\x3e\n          \x3cspan class=\x22hljs-keyword\x22\x3edelete\x3c\/span\x3e files[file]\n        }\n      }\n    })\n  })\n  done()\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e引入的包：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3eminimatch\x3c\/strong\x3e  \/\/字符匹配工具\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eeval\x3c\/strong\x3e      \/\/返回某作用下表达式的值\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e作用：\x3c\/strong\x3e 根据metalsmith.metadata()删除一些不需要的模板文件，而metalsmith.metadata()主要在ask.js中改变的，也就是说ask.js中获取到用户的需求。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader16\x22\x3elogger.js\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const chalk = require(\x27chalk\x27)\nconst format = require(\x27util\x27).format\n\n\/**\n * Prefix.\n *\/\n\nconst prefix = \x27   vue-cli\x27\nconst sep = chalk.gray(\x27·\x27)\n\n\/**\n * Log a `message` to the console.\n *\n * @param {String} message\n *\/\n\nexports.log = function (...args) {\n  const msg = format.apply(format, args)\n  console.log(chalk.white(prefix), sep, msg)\n}\n\n\/**\n * Log an error `message` to the console and exit.\n *\n * @param {String} message\n *\/\n\nexports.fatal = function (...args) {\n  if (args[0] instanceof Error) args[0] = args[0].message.trim()\n  const msg = format.apply(format, args)\n  console.error(chalk.red(prefix), sep, msg)\n  process.exit(1)\n}\n\n\/**\n * Log a success `message` to the console and exit.\n *\n * @param {String} message\n *\/\n\nexports.success = function (...args) {\n  const msg = format.apply(format, args)\n  console.log(chalk.white(prefix), sep, msg)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e chalk = require(\x3cspan class=\x22hljs-string\x22\x3e\x27chalk\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e format = require(\x3cspan class=\x22hljs-string\x22\x3e\x27util\x27\x3c\/span\x3e).format\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Prefix.\n *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e prefix = \x3cspan class=\x22hljs-string\x22\x3e\x27   vue-cli\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e sep = chalk.gray(\x3cspan class=\x22hljs-string\x22\x3e\x27·\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Log a `message` to the console.\n *\n * @param {String} message\n *\/\x3c\/span\x3e\n\nexports.log = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-rest_arg\x22\x3e...args\x3c\/span\x3e)\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e msg = format.apply(format, args)\n  console.log(chalk.white(prefix), sep, msg)\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Log an error `message` to the console and exit.\n *\n * @param {String} message\n *\/\x3c\/span\x3e\n\nexports.fatal = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-rest_arg\x22\x3e...args\x3c\/span\x3e)\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (args[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e] \x3cspan class=\x22hljs-keyword\x22\x3einstanceof\x3c\/span\x3e Error) args[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e] = args[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].message.trim()\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e msg = format.apply(format, args)\n  console.error(chalk.red(prefix), sep, msg)\n  process.exit(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Log a success `message` to the console and exit.\n *\n * @param {String} message\n *\/\x3c\/span\x3e\n\nexports.success = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-rest_arg\x22\x3e...args\x3c\/span\x3e)\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e msg = format.apply(format, args)\n  console.log(chalk.white(prefix), sep, msg)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e引入的包：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3echalk\x3c\/strong\x3e    \/\/用于高亮终端打印出来的信息。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eformat\x3c\/strong\x3e   \/\/node自带的util模块中的format方法。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e作用：\x3c\/strong\x3e logger.js主要提供三个方法log（常规日志）、fatal（错误日志）、success（成功日志）。每个方法都挺简单的，我就不错过多的解释了。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader17\x22\x3elocal-path.js\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const path = require(\x27path\x27)\n\nmodule.exports = {\n  isLocalPath (templatePath) {\n    return \/^[.\/]|(^[a-zA-Z]:)\/.test(templatePath)\n  },\n\n  getTemplatePath (templatePath) {\n    return path.isAbsolute(templatePath)\n      ? templatePath\n      : path.normalize(path.join(process.cwd(), templatePath))\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs aspectj\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e path = require(\x3cspan class=\x22hljs-string\x22\x3e\x27path\x27\x3c\/span\x3e)\n\nmodule.exports = {\n  isLocalPath (templatePath) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \/^[.\/]|(^[a-zA-Z]:)\/.test(templatePath)\n  },\n\n  getTemplatePath (templatePath) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e path.isAbsolute(templatePath)\n      ? templatePath\n      : path.normalize(path.join(process.cwd(), templatePath))\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e引入的包：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cstrong\x3epath\x3c\/strong\x3e    \/\/node自带的路径处理工具。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e作用：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3eisLocalPath:\x3c\/strong\x3e  UNIX (以“.”或者\x22\/\x22开头)   WINDOWS(以形如：“C：”的方式开头)。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3egetTemplatePath:\x3c\/strong\x3e  templatePath是否为绝对路径，是则返回templatePath 否则转换成绝对路径并规范化。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader18\x22\x3echeck-version.js\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const request = require(\x27request\x27)\nconst semver = require(\x27semver\x27)\nconst chalk = require(\x27chalk\x27)\nconst packageConfig = require(\x27..\/package.json\x27)\n\nmodule.exports = done =\x3e {\n  \/\/ Ensure minimum supported node version is used\n  if (!semver.satisfies(process.version, packageConfig.engines.node)) {\n    return console.log(chalk.red(\n      \x27  You must upgrade node to \x3e=\x27 \x2b packageConfig.engines.node \x2b \x27.x to use vue-cli\x27\n    ))\n  }\n\n  request({\n    url: \x27https:\/\/registry.npmjs.org\/vue-cli\x27,\n    timeout: 1000\n  }, (err, res, body) =\x3e {\n    if (!err \x26amp;\x26amp; res.statusCode === 200) {\n      const latestVersion = JSON.parse(body)[\x27dist-tags\x27].latest\n      const localVersion = packageConfig.version\n      if (semver.lt(localVersion, latestVersion)) {\n        console.log(chalk.yellow(\x27  A newer version of vue-cli is available.\x27))\n        console.log()\n        console.log(\x27  latest:    \x27 \x2b chalk.green(latestVersion))\n        console.log(\x27  installed: \x27 \x2b chalk.red(localVersion))\n        console.log()\n      }\n    }\n    done()\n  })\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e request = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27request\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e semver = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27semver\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e chalk = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27chalk\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e packageConfig = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/package.json\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3edone\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Ensure minimum supported node version is used\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!semver.satisfies(process.version, packageConfig.engines.node)) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(chalk.red(\n      \x3cspan class=\x22hljs-string\x22\x3e\x27  You must upgrade node to \x26gt;=\x27\x3c\/span\x3e \x2b packageConfig.engines.node \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27.x to use vue-cli\x27\x3c\/span\x3e\n    ))\n  }\n\n  request({\n    url: \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/registry.npmjs.org\/vue-cli\x27\x3c\/span\x3e,\n    timeout: \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e\n  }, \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr, res, body\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!err \x26amp;\x26amp; res.statusCode === \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e latestVersion = \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.parse(body)[\x3cspan class=\x22hljs-string\x22\x3e\x27dist-tags\x27\x3c\/span\x3e].latest\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e localVersion = packageConfig.version\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (semver.lt(localVersion, latestVersion)) {\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(chalk.yellow(\x3cspan class=\x22hljs-string\x22\x3e\x27  A newer version of vue-cli is available.\x27\x3c\/span\x3e))\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log()\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27  latest:    \x27\x3c\/span\x3e \x2b chalk.green(latestVersion))\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27  installed: \x27\x3c\/span\x3e \x2b chalk.red(localVersion))\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log()\n      }\n    }\n    done()\n  })\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e引入的包：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3erequest\x3c\/strong\x3e    \/\/http请求工具。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3esemver\x3c\/strong\x3e    \/\/版本号处理工具。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3echalk\x3c\/strong\x3e    \/\/用于高亮终端打印出来的信息。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e作用：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e第一步：检查本地的node版本号，是否达到\x3cstrong\x3epackage.json\x3c\/strong\x3e文件中对node版本的要求，若低于node\x3cstrong\x3epackage.json\x3c\/strong\x3e文件中要求的版本，则直接要求开发者更新自己的node版本。反之，可开始第二步。\x3c\/li\x3e\n\x3cli\x3e第二步： 通过请求\x3cstrong\x3e\x3ca href=\x22https:\/\/registry.npmjs.org\/vue-cli\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/registry.npmjs.org\/vu...\x3c\/a\x3e\x3c\/strong\x3e来获取\x3cstrong\x3evue-cli\x3c\/strong\x3e的最新版本号，跟\x3cstrong\x3epackage.json\x3c\/strong\x3e中的\x3cstrong\x3eversion\x3c\/strong\x3e字段进行比较，若本地的版本号小于最新的版本号，则提示有最新版本可以更新。这里需要注意的是，这里检查版本号并不影响后续的流程，即便本地的\x3cstrong\x3evue-cli\x3c\/strong\x3e版本不是最新的，也不影响构建，仅仅提示一下。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader19\x22\x3ewarnings.js\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const chalk = require(\x27chalk\x27)\n\nmodule.exports = {\n  v2SuffixTemplatesDeprecated (template, name) {\n    const initCommand = \x27vue init \x27 \x2b template.replace(\x27-2.0\x27, \x27\x27) \x2b \x27 \x27 \x2b name\n\n    console.log(chalk.red(\x27  This template is deprecated, as the original template now uses Vue 2.0 by default.\x27))\n    console.log()\n    console.log(chalk.yellow(\x27  Please use this command instead: \x27) \x2b chalk.green(initCommand))\n    console.log()\n  },\n  v2BranchIsNowDefault (template, name) {\n    const vue1InitCommand = \x27vue init \x27 \x2b template \x2b \x27#1.0\x27 \x2b \x27 \x27 \x2b name\n\n    console.log(chalk.green(\x27  This will install Vue 2.x version of the template.\x27))\n    console.log()\n    console.log(chalk.yellow(\x27  For Vue 1.x use: \x27) \x2b chalk.green(vue1InitCommand))\n    console.log()\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs processing\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e chalk = require(\x3cspan class=\x22hljs-string\x22\x3e\x27chalk\x27\x3c\/span\x3e)\n\nmodule.exports = {\n  v2SuffixTemplatesDeprecated (template, name) {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e initCommand = \x3cspan class=\x22hljs-string\x22\x3e\x27vue init \x27\x3c\/span\x3e \x2b template.replace(\x3cspan class=\x22hljs-string\x22\x3e\x27-2.0\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e) \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27 \x27\x3c\/span\x3e \x2b name\n\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(chalk.\x3cspan class=\x22hljs-built_in\x22\x3ered\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27  This template is deprecated, as the original template now uses Vue 2.0 by default.\x27\x3c\/span\x3e))\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e()\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(chalk.yellow(\x3cspan class=\x22hljs-string\x22\x3e\x27  Please use this command instead: \x27\x3c\/span\x3e) \x2b chalk.\x3cspan class=\x22hljs-built_in\x22\x3egreen\x3c\/span\x3e(initCommand))\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e()\n  },\n  v2BranchIsNowDefault (template, name) {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e vue1InitCommand = \x3cspan class=\x22hljs-string\x22\x3e\x27vue init \x27\x3c\/span\x3e \x2b template \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27#1.0\x27\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27 \x27\x3c\/span\x3e \x2b name\n\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(chalk.\x3cspan class=\x22hljs-built_in\x22\x3egreen\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27  This will install Vue 2.x version of the template.\x27\x3c\/span\x3e))\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e()\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(chalk.yellow(\x3cspan class=\x22hljs-string\x22\x3e\x27  For Vue 1.x use: \x27\x3c\/span\x3e) \x2b chalk.\x3cspan class=\x22hljs-built_in\x22\x3egreen\x3c\/span\x3e(vue1InitCommand))\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e()\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e引入的包：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cstrong\x3echalk\x3c\/strong\x3e    \/\/用于高亮终端打印出来的信息。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e作用：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3ev2SuffixTemplatesDeprecated\x3c\/strong\x3e：提示带“-2.0”的模板已经弃用了，官方模板默认用2.0了。不需要用“-2.0”来区分vue1.0和vue2.0了。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3ev2BranchIsNowDefault：\x3c\/strong\x3e 这个方法在\x3cstrong\x3evue-init文件中\x3c\/strong\x3e已经被注释掉，不再使用了。在vue1.0向vue2.0过渡的时候用到过，现在都是默认2.0了，自然也就不用了。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader20\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e由于代码比较多，很多代码我就没有一一细讲了，一些比较简单或者不是很重要的js文件，我就单单说明了它的作用了。但是重点的js文件，我还是加了很多注解在上面。其中我个人认为比较重点的文件就是\x3cstrong\x3evue-init\x3c\/strong\x3e、\x3cstrong\x3egenerate.js\x3c\/strong\x3e、\x3cstrong\x3eoptions.js\x3c\/strong\x3e、\x3cstrong\x3eask.js\x3c\/strong\x3e、\x3cstrong\x3efilter.js\x3c\/strong\x3e,这五个文件构成了\x3cstrong\x3evue-cli\x3c\/strong\x3e构建项目的主流程，因此需要我们花更多的时间在上面。另外，我们在读源码的过程中，一定要理清楚整个构建流程是什么样子的，心里得有一个谱。读完源码之后，我个人是建议自己动手搭建一个构建工具，这样的话印象才会更加深刻，个人成长会更大点。我自己在读完整个\x3cstrong\x3evue-cli\x3c\/strong\x3e之后，我自己根据\x3cstrong\x3evue-cli\x3c\/strong\x3e的流程也动手搞了一个脚手架工具，仅供大家参考学习一下。地址如下：\x3c\/p\x3e\n\x3cblockquote\x3e\x3ca href=\x22https:\/\/github.com\/ruichengping\/asuna-cli\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/ruichengpi...\x3c\/a\x3e\x3c\/blockquote\x3e\n\x3cp\x3e最后祝愿大家可以在前端的道路上越走越好！如果喜欢我的文章，请记得关注我哦！后续会推出更多的优质的文章哦，敬请期待！\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>走进Vue-cli源码，自己动手搭建前端脚手架工具</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000013975247">https://segmentfault.com/a/1190000013975247</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/2t0c52b56b/" target="_blank">https://alili.tech/archive/2t0c52b56b/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>