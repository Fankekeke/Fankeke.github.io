<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="记一次低级并严重的开发失误"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>记一次低级并严重的开发失误 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/3gp8uwj4tkw/",
				"appid": "1613049289050283", 
				"title": "记一次低级并严重的开发失误 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-11T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/hz02a1jaqpp/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/q5urp95b7n/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f3gp8uwj4tkw%2f&text=%e8%ae%b0%e4%b8%80%e6%ac%a1%e4%bd%8e%e7%ba%a7%e5%b9%b6%e4%b8%a5%e9%87%8d%e7%9a%84%e5%bc%80%e5%8f%91%e5%a4%b1%e8%af%af"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f3gp8uwj4tkw%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f3gp8uwj4tkw%2f&text=%e8%ae%b0%e4%b8%80%e6%ac%a1%e4%bd%8e%e7%ba%a7%e5%b9%b6%e4%b8%a5%e9%87%8d%e7%9a%84%e5%bc%80%e5%8f%91%e5%a4%b1%e8%af%af"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f3gp8uwj4tkw%2f&title=%e8%ae%b0%e4%b8%80%e6%ac%a1%e4%bd%8e%e7%ba%a7%e5%b9%b6%e4%b8%a5%e9%87%8d%e7%9a%84%e5%bc%80%e5%8f%91%e5%a4%b1%e8%af%af"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f3gp8uwj4tkw%2f&is_video=false&description=%e8%ae%b0%e4%b8%80%e6%ac%a1%e4%bd%8e%e7%ba%a7%e5%b9%b6%e4%b8%a5%e9%87%8d%e7%9a%84%e5%bc%80%e5%8f%91%e5%a4%b1%e8%af%af"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e8%ae%b0%e4%b8%80%e6%ac%a1%e4%bd%8e%e7%ba%a7%e5%b9%b6%e4%b8%a5%e9%87%8d%e7%9a%84%e5%bc%80%e5%8f%91%e5%a4%b1%e8%af%af&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f3gp8uwj4tkw%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f3gp8uwj4tkw%2f&title=%e8%ae%b0%e4%b8%80%e6%ac%a1%e4%bd%8e%e7%ba%a7%e5%b9%b6%e4%b8%a5%e9%87%8d%e7%9a%84%e5%bc%80%e5%8f%91%e5%a4%b1%e8%af%af"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f3gp8uwj4tkw%2f&title=%e8%ae%b0%e4%b8%80%e6%ac%a1%e4%bd%8e%e7%ba%a7%e5%b9%b6%e4%b8%a5%e9%87%8d%e7%9a%84%e5%bc%80%e5%8f%91%e5%a4%b1%e8%af%af"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f3gp8uwj4tkw%2f&title=%e8%ae%b0%e4%b8%80%e6%ac%a1%e4%bd%8e%e7%ba%a7%e5%b9%b6%e4%b8%a5%e9%87%8d%e7%9a%84%e5%bc%80%e5%8f%91%e5%a4%b1%e8%af%af"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f3gp8uwj4tkw%2f&title=%e8%ae%b0%e4%b8%80%e6%ac%a1%e4%bd%8e%e7%ba%a7%e5%b9%b6%e4%b8%a5%e9%87%8d%e7%9a%84%e5%bc%80%e5%8f%91%e5%a4%b1%e8%af%af"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">记一次低级并严重的开发失误</h1><div class="meta"><div class="postdate"><time datetime="2018-12-11" itemprop="datePublished">2018-12-11</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e1.前言\x3c\/h2\x3e\n\x3cp\x3e前端从事了超过两年，修复了无数的bug，写了无数的bug；挖了很多次坑，填了很多次坑；犯了很多次错，弥补了很多次，学习了很多次。一般而言，对于bug、坑，都是修复完了或者填完了，并且记住为什么会产生bug，为什么有坑，为什么犯错，怎么解决的，下次怎么避免，就行了，就学习到了。而这一次的项目，原本以为开发挺顺利的，但是开发完了，才发现自己犯了一个低级而严重的错，这样的一个失误，我一直耿耿于怀。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e2.起因\x3c\/h2\x3e\n\x3cp\x3e在3月9号的这一天，公司有个活动，希望用答题活动推广自己的小程序。结果因为开发时间太紧，小程序在3月5号才提审。在3月8号早上，小程序还没有审核，在不得已的情况下，只能把答题活动以网页的形式进行，使用vue开发。由于在3月9号要用到这个答题活动，所以3月8号必须要完成开发，测试，验收。\x3c\/p\x3e\n\x3cp\x3e开发的过程，都挺顺利，只是把小程序的一些代码，改成vue开发移动端网站的方式，把标签换了，样式稍微重写一下，项目就跑起来了，至于一些交互逻辑，由于不能使用小程序的API，只能另找良方代替，但问题基本不大。\x3c\/p\x3e\n\x3cp\x3e麻烦的一个需求就是：当用户没答完题中途退出的时候，要记录用户的答题状态。比如答了哪些题目，哪些题目错了，哪些题目正确了，拿了多少分等数据。在小程序里面，很轻松可以利用生命周期函数 \x3ccode\x3eunload()\x3c\/code\x3e 进行监听。当用户没答完题退出页面的时候，把用户当前的答题数据，传给后台，让后台进行保存。在用户下次进入页面的时候，我可以根据后台返回的用户答题状态，进行信息的展示。如果用户没答过题目，就重新开始答题，如果用户上次退出的时候，没答完题目，就按照退出时的进度，让用户重新答题，如果答完了题目，直接显示答题结果页面。\x3c\/p\x3e\n\x3cp\x3e这个需求不难实现，小程序有 \x3ccode\x3eonload() \x3c\/code\x3e和 \x3ccode\x3eunload() \x3c\/code\x3e两个生命周期函数，只是在这两个函数里面，调两次接口而已。\x3c\/p\x3e\n\x3cp\x3e但在网页里面，监听用户进入页面简单。但是监听用户退出页面（微信浏览器上面的那个‘返回’或者‘关闭’按钮）却死活不行。网上最多的解决方案是这个，但是不知道是我使用方式有问题还是人品问题，压根没用，无论是微信开发者工具，还是安卓或者苹果真机。\x3c\/p\x3e\n\x3cp\x3e答案来自知乎：\x3ca href=\x22https:\/\/www.zhihu.com\/question\/40511430\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e微信自带浏览器环境内左上角返回、关闭按钮事件监控？\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22pushHistory(); \nwindow.addEventListener(\x26quot;popstate\x26quot;, function(e) { \n    alert(\x26quot;我监听到了浏览器的返回按钮事件啦\x26quot;);\/\/根据自己的需求实现自己的功能 \n}, false); \nfunction pushHistory() { \n    var state = { \n        title: \x26quot;title\x26quot;, \n        url: \x26quot;#\x26quot;\n    }; \n    window.history.pushState(state, \x26quot;title\x26quot;, \x26quot;#\x26quot;); \n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3epushHistory(); \n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x22popstate\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{ \n    alert(\x3cspan class=\x22hljs-string\x22\x3e\x22我监听到了浏览器的返回按钮事件啦\x22\x3c\/span\x3e);\x3cspan class=\x22hljs-comment\x22\x3e\/\/根据自己的需求实现自己的功能 \x3c\/span\x3e\n}, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e); \n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3epushHistory\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e state = { \n        \x3cspan class=\x22hljs-attr\x22\x3etitle\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22title\x22\x3c\/span\x3e, \n        \x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22#\x22\x3c\/span\x3e\n    }; \n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.history.pushState(state, \x3cspan class=\x22hljs-string\x22\x3e\x22title\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22#\x22\x3c\/span\x3e); \n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e根据网上的方案，试了几个（包括vue的生命周期函数），没一个可行的。最后无奈之下，只能用一个蠢方法，用户点击每一题选项的时候，就把用户当前的记录，通过接口发给后台，让后台记录。这个就是我该文章说的低级严重的失误，想必大家也知道是怎么回事了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e3.失误分析\x3c\/h2\x3e\n\x3cp\x3e这次的答题活动，一共有三轮，每轮10道题，现场大概有500人答题。本来使用小程序开发，不管用户是没答题就让用户可以开始答题，答题途中退出就记录状态，答完题就显示结果。在这个过程中，我跟后台交互的只有两次：一次是用户进来的时候获取用户答题进度，一次是用户答完了最后一题，发送用户成绩，让后台记录；或者中途退出，发送用户答题进度给后台，让后台记录。\x3c\/p\x3e\n\x3cp\x3e但是后来我在网页中，由于暂时没法监听用户是否退出，所以选择了用户回答完每一题的时候，把数据发给后台，让后台答题进度。这样请求数就多了N倍。服务器的压力就大了很多。\x3c\/p\x3e\n\x3cp\x3e由于用户进来，无论是小程序还是网站，都要请求接口，获取用户答题数据，这次不在对比范围。这样原本小程序只需要和后台进行一次握手，但是在网页中，采用了不合适的方式，和后台握手次数变成了10次。足足多了9倍。如果是500人，每一轮从原本的500次，变成了5000次，三轮就从原本的1500次，变成了15000次！一般而言，10道题选择题，是两分钟左右的回答时间，就相当于在2分钟内服务器要响应的次数多了9倍，这个担子突然重了很多。而已这些请求，基本都有没什么意义的，因为绝大部分的人，10道题，大概两分钟的答题时间里面，不会中途退出，相当于我做了一件没意义，又消耗服务器性能的事情。\x3c\/p\x3e\n\x3cp\x3e让我耿耿于怀的原因，我一向对请求数严格的控制，虽然现在公司不怎么考虑性能，服务器压力。但是这会引起我的强迫症。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e4.解压方案\x3c\/h2\x3e\n\x3cp\x3e由于答题活动，9号要使用，而我是8号晚上洗完澡的时候和同事聊天的时候才想起，所以我没时间改了，因为改了也是需要时间开发，测试。9号由于同事请假，他的项目也由我负责，也是比较赶的项目，我也没那么多时间改。只能委屈一下服务器了。\x3c\/p\x3e\n\x3cp\x3e说是这样说，但是关于其他的给服务器减轻负担的方案，还是有比较讲一下，算是给自己提个醒，也算是给大家提个醒。开发要注意一点：不要急，不要急，不要急。\x3c\/p\x3e\n\x3cp\x3ePS：当时就是看着时间差不多是下午四点半了，然后还有两个零散功能没做，又要测试。找了很久的解决方案（监听微信的‘返回’或者‘关闭按钮’）都没下落的情况下，一下急了，脑袋放空，就想了那个方法。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3ecookie或者localstore\x3c\/h3\x3e\n\x3cp\x3e记录用户的状态，这个应该是最好的解决方案了，也应该是最简单的解决方案。\x3c\/p\x3e\n\x3cp\x3e比如使用cookie记录用户的答题进度。在用户每答一题的时候，就把cookie记录到的数据，更新一次。这样只需要在用户答完了最后一题的时候再把用户的成绩发给后台就好，至于用户中途退出也没有，根据cookie判断就好，如果cookie有记录到用户的数据。就显示上次用户退出时候的题目，让用户继续答题。\x3c\/p\x3e\n\x3ch4\x3e原代码：\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/**\n* @dedependson 点击选项\n* @index 题目索引  number\n* @item 当前选项对象 object\n*\/\nchooseDo(index,item){\n    \/*其他代码略*\/\n    let _this=this;\n    let _data={\n        qid:_this.qid,\/\/答题轮次，如\x272\x27代表第二轮答题\n        questions:_this.questions,\/\/已答题目，\x271,2,3\x27这个表示id为1，2，3的题目已经回答了\n        totalScore:_this.totalScore\/\/当前得分\n    }\n    \/\/发送请求，让后台记录用户答题进度\n    this.$http.post(http_url.submit,_data,{emulateJSON:true}).then(res=\x3e{\n            \n    })\n}\n\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs sqf\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/**\n* @dedependson 点击选项\n* @index 题目索引  number\n* @item 当前选项对象 object\n*\/\x3c\/span\x3e\nchooseDo(index,item){\n    \x3cspan class=\x22hljs-comment\x22\x3e\/*其他代码略*\/\x3c\/span\x3e\n    let \x3cspan class=\x22hljs-variable\x22\x3e_this\x3c\/span\x3e=this;\n    let \x3cspan class=\x22hljs-variable\x22\x3e_data\x3c\/span\x3e={\n        qid:\x3cspan class=\x22hljs-variable\x22\x3e_this\x3c\/span\x3e.qid,\x3cspan class=\x22hljs-comment\x22\x3e\/\/答题轮次，如\x272\x27代表第二轮答题\x3c\/span\x3e\n        questions:\x3cspan class=\x22hljs-variable\x22\x3e_this\x3c\/span\x3e.questions,\x3cspan class=\x22hljs-comment\x22\x3e\/\/已答题目，\x271,2,3\x27这个表示id为1，2，3的题目已经回答了\x3c\/span\x3e\n        totalScore:\x3cspan class=\x22hljs-variable\x22\x3e_this\x3c\/span\x3e.totalScore\x3cspan class=\x22hljs-comment\x22\x3e\/\/当前得分\x3c\/span\x3e\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/发送请求，让后台记录用户答题进度\x3c\/span\x3e\n    this.$http.post(http_url.submit,\x3cspan class=\x22hljs-variable\x22\x3e_data\x3c\/span\x3e,{emulateJSON:\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e}).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(res=\x26gt;{\n            \n    })\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后再到页面加载的时候\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22mounted(){\n    this.$http.get(http_url.getQuestions,{\n        params:{\n            qid:this.qid\n        }\n    }).then(res=\x3e{\n        res=res.body;\n        \/\/如果请求成功\n        if(res.code===0){\n            \/\/如果用户没答完题 0-没开始答题 1-没答完题   2-答完题目\n            if(res.datas.status!==2){\n                \/\/获取答题的题目\n                this.questionList=res.datas.entryList;\n                \/\/如果题目小于10，就是开始答题了，但是没答完（中途退出的原因）\n                if(this.questionList.length\x3c10){\n                    \/\/显示答题页面，让用户答题\n                    this.questionListShow=true;\n                }\n                \/\/否则就是没答过题目，让用户答题\n                else{\n                    \/\/显示开始答题页面（答题首页，用户需要点击开始答题）\n                }\n            }\n            \/\/如果用户已经答完题，显示结果页\n            else{\n                \/\/代码略\n            }\n        }\n        else{\n            alert(res.msg)\n        }\n    })\n}\n       \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3emounted(){\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$http.\x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e(http_url.getQuestions,{\n        params:{\n            qid:\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.qid\n        }\n    }).then(res=\x26gt;{\n        res=res.body;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果请求成功\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(res.code===\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e){\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果用户没答完题 0-没开始答题 1-没答完题   2-答完题目\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(res.datas.status!==\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e){\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/获取答题的题目\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.questionList=res.datas.entryList;\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果题目小于10，就是开始答题了，但是没答完（中途退出的原因）\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.questionList.length\x26lt;\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e){\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/显示答题页面，让用户答题\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.questionListShow=\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n                }\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/否则就是没答过题目，让用户答题\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/显示开始答题页面（答题首页，用户需要点击开始答题）\x3c\/span\x3e\n                }\n            }\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果用户已经答完题，显示结果页\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/代码略\x3c\/span\x3e\n            }\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n            alert(res.msg)\n        }\n    })\n}\n       \x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3ecookie方案\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22chooseDo(index,item){\n    \/*其他代码略*\/\n    let _this=this;\n    let _data={\n        qid:_this.qid,\/\/答题轮次，如\x272\x27代表第二轮答题\n        questions:_this.questions,\/\/已答题目，\x271,2,3\x27这个表示id为1，2，3的题目已经回答了\n        totalScore:_this.totalScore\/\/当前得分\n    }\n    \/\/保存cookie一天\n    \/\/_this.qid作为答题轮次的标识\n    setCookie(\x27answer-qid\x27\x2b_this.qid,_this.qid,1);\n    setCookie(\x27answer-questions\x27\x2b_this.qid,_this.questions,1);\n    setCookie(\x27answer-totalScore\x27\x2b_this.qid,_this.totalScore,1);\n}    \n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ceylon\x22\x3e\x3ccode\x3echooseDo(index,item){\n    \x3cspan class=\x22hljs-comment\x22\x3e\/*其他代码略*\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e=\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3edata={\n        qid:\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.qid,\x3cspan class=\x22hljs-comment\x22\x3e\/\/答题轮次，如\x272\x27代表第二轮答题\x3c\/span\x3e\n        questions:\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.questions,\x3cspan class=\x22hljs-comment\x22\x3e\/\/已答题目，\x271,2,3\x27这个表示id为1，2，3的题目已经回答了\x3c\/span\x3e\n        totalScore:\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.totalScore\x3cspan class=\x22hljs-comment\x22\x3e\/\/当前得分\x3c\/span\x3e\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/保存cookie一天\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/_this.qid作为答题轮次的标识\x3c\/span\x3e\n    setCookie(\x3cspan class=\x22hljs-string\x22\x3e\x27answer-qid\x27\x3c\/span\x3e\x2b\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.qid,\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.qid,\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n    setCookie(\x3cspan class=\x22hljs-string\x22\x3e\x27answer-questions\x27\x3c\/span\x3e\x2b\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.qid,\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.questions,\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n    setCookie(\x3cspan class=\x22hljs-string\x22\x3e\x27answer-totalScore\x27\x3c\/span\x3e\x2b\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.qid,\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.totalScore,\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n}    \n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ecookie函数参考:\x3ca href=\x22https:\/\/github.com\/chenhuiYj\/ec-do\/blob\/master\/src\/ec-do-2.0.0.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eec-do\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/设置cookie\nsetCookie(name, value, iDay) {\n    let oDate = new Date();\n    oDate.setDate(oDate.getDate() \x2b iDay);\n    document.cookie = name \x2b \x27=\x27 \x2b value \x2b \x27;expires=\x27 \x2b oDate;\n},\n\/\/获取cookie\ngetCookie(name) {\n    let arr = document.cookie.split(\x27; \x27),arr2;\n    for (let i = 0; i \x3c arr.length; i\x2b\x2b) {\n        arr2 = arr[i].split(\x27=\x27);\n        if (arr2[0] == name) {\n            return arr2[1];\n        }\n    }\n    return \x27\x27;\n},\n\/\/删除cookie\nremoveCookie(name) {\n    this.setCookie(name, 1, -1);\n}, \n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/设置cookie\x3c\/span\x3e\nsetCookie(name, value, iDay) {\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e oDate = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e();\n    oDate.setDate(oDate.getDate() \x2b iDay);\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.cookie = name \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27=\x27\x3c\/span\x3e \x2b value \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27;expires=\x27\x3c\/span\x3e \x2b oDate;\n},\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/获取cookie\x3c\/span\x3e\ngetCookie(name) {\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e arr = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.cookie.split(\x3cspan class=\x22hljs-string\x22\x3e\x27; \x27\x3c\/span\x3e),arr2;\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; arr.length; i\x2b\x2b) {\n        arr2 = arr[i].split(\x3cspan class=\x22hljs-string\x22\x3e\x27=\x27\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (arr2[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e] == name) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e arr2[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e];\n        }\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n},\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/删除cookie\x3c\/span\x3e\nremoveCookie(name) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setCookie(name, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e);\n}, \n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后再到页面加载的时候，处理方式的改变。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\nmounted(){\n    this.$http.get(http_url.getQuestions,{\n        params:{\n            qid:this.qid\n        }\n    }).then(res=\x3e{\n        res=res.body;\n        \/\/如果请求成功\n        if(res.code===0){\n            \/\/如果用户没答完题 0-没开始答题 1-没答完题   2-答完题目\n            if(res.datas.status!==2){\n                \/\/记录答题轮次\n                this.qid=res.datas.qid; \n                \/\/获取答题的题目\n                this.questionList=res.datas.entryList; \n                \/\/如果用户中途退出，我们没有和后台对接口，后台无法记录用户答题进度，所以这次请求，返回的结果要么是没开始答题，要么是答完题了。\n                \/\/要还原用户答题记录，要使用cookie\n                \/\/如果存在cookie记录，那么用户肯定是至少答过一题，还原用户答题进度\n                let _answerQid=getCookie(\x27answer-qid\x27\x2bthis.qid)\n                _answerQuestions=getCookie(\x27answer-qid\x27\x2bthis.qid).split(\x27,\x27);\n                \/\/字符串转整数\n                _answerQuestions.map(item=\x3e\x2bitem);\n                \n                if(_answerQid\x26amp;\x26amp;_answerQuestions){\n                    this.questionList.fifler(item=\x3e{\n                        \/\/item.id是题目的id\n                        \/\/如果题目的id存在，就过滤掉\n                        _answerQuestions.indexOf(item.id)===-1\n                    });\n                    \/\/显示答题页面，让用户答题\n                    this.questionListShow=true;  \n                }\n                \/\/否则就是没答过题目，让用户答题\n                else{\n                    \/\/显示开始答题页面（答题首页，用户需要点击开始答题）\n                }\n            }\n            \/\/如果用户已经答完题，显示结果页\n            else{\n                \/\/代码略\n            }\n        }\n        else{\n            alert(res.msg)\n        }\n    })\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e\nmounted(){\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$http.\x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e(http_url.getQuestions,{\n        params:{\n            qid:\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.qid\n        }\n    }).then(res=\x26gt;{\n        res=res.body;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果请求成功\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(res.code===\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e){\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果用户没答完题 0-没开始答题 1-没答完题   2-答完题目\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(res.datas.status!==\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e){\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/记录答题轮次\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.qid=res.datas.qid; \n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/获取答题的题目\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.questionList=res.datas.entryList; \n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果用户中途退出，我们没有和后台对接口，后台无法记录用户答题进度，所以这次请求，返回的结果要么是没开始答题，要么是答完题了。\x3c\/span\x3e\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/要还原用户答题记录，要使用cookie\x3c\/span\x3e\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果存在cookie记录，那么用户肯定是至少答过一题，还原用户答题进度\x3c\/span\x3e\n                let _answerQid=getCookie(\x3cspan class=\x22hljs-string\x22\x3e\x27answer-qid\x27\x3c\/span\x3e\x2b\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.qid)\n                _answerQuestions=getCookie(\x3cspan class=\x22hljs-string\x22\x3e\x27answer-qid\x27\x3c\/span\x3e\x2b\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.qid).split(\x3cspan class=\x22hljs-string\x22\x3e\x27,\x27\x3c\/span\x3e);\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/字符串转整数\x3c\/span\x3e\n                _answerQuestions.map(item=\x26gt;\x2bitem);\n                \n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(_answerQid\x26amp;\x26amp;_answerQuestions){\n                    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.questionList.fifler(item=\x26gt;{\n                        \x3cspan class=\x22hljs-comment\x22\x3e\/\/item.id是题目的id\x3c\/span\x3e\n                        \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果题目的id存在，就过滤掉\x3c\/span\x3e\n                        _answerQuestions.indexOf(item.id)===\x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e\n                    });\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/显示答题页面，让用户答题\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.questionListShow=\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;  \n                }\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/否则就是没答过题目，让用户答题\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/显示开始答题页面（答题首页，用户需要点击开始答题）\x3c\/span\x3e\n                }\n            }\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果用户已经答完题，显示结果页\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/代码略\x3c\/span\x3e\n            }\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n            alert(res.msg)\n        }\n    })\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e代码上面，可能用了 cookie 会复杂些，但是就多了几行而已，差不了多少，反倒是减轻了很多请求。\x3c\/p\x3e\n\x3cblockquote\x3e在小程序没有使用这个方案，就是考虑到用户退出小程序，可能会清除缓存，虽然这个几率不大，所以使用生命周期函数进行\x3ccode\x3eunload()\x3c\/code\x3e进行监听，用户退出就把用户答题进度提交给后台，让后台记录，这样的情况不会很多，甚至没有，请求不会很多，所以当时就用了这个方案。没有使用cookie或者localstore。\x3c\/blockquote\x3e\n\x3cp\x3e注意几点：\x3c\/p\x3e\n\x3cp\x3e1.无论什么情况，开发都需要一个清醒的头脑，因为头脑不清醒，写的都是bug，那个活动是一个一次性的项目，如果是长期的，我肯定会重构的，因为当时写的代码太烂了。也容易犯一些低级的错误。\x3c\/p\x3e\n\x3cp\x3e2.不要为了小概率的事件想得太多，给自己，同事，服务器都带来麻烦，也影响项目进度。这次就是想得太多，结果提测的时间晚了，验收的时间晚了，自己也犯了错误。想太多的后果可能就是捡了芝麻，漏了西瓜，甚至是偷鸡不成蚀把米。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e小结\x3c\/h2\x3e\n\x3cp\x3e这次的的失误就告一段落了，我也总结了一下，自己为什么会对这次失误更更于怀。\x3c\/p\x3e\n\x3cp\x3e1.最近一直在看怎么优化代码，让代码更有可读性，可维护性。却犯了请求数过多的错。顾此失彼啊。\x3c\/p\x3e\n\x3cp\x3e2.第二个就是因为这次失误，导致的后果太严重了，直接多了90%的请求。以往失误导致的后果没怎么严重。\x3c\/p\x3e\n\x3cp\x3e3.以往犯错的时候，在项目上线之前能够发现，并且有时候改，这次不一样，这次是发现了，但是没时间改了。\x3c\/p\x3e\n\x3cp\x3e4.那些以为不会有，不应该犯的错。可能就在头脑不清醒的时候，就会犯这些错误，无论什么时候都得留个神，这次也算是我自己提醒自己了。\x3c\/p\x3e\n\x3cp\x3e不过结局是还算是好的，当天因为时间关系，答题活动没有进行，所以服务器没有受到考验。如果当天服务器承受不住压力，崩了，我也可能要引咎辞职了！\x3c\/p\x3e\n\x3cp\x3e好了，故事就是这样了，有点日记的感觉，希望大家谅解下。如果文章有什么地方写错了，也欢迎指点交流。\x3c\/p\x3e\n\x3cp\x3e--------------------华丽的分割线-------------------\x3c\/p\x3e\n\x3cp\x3e想了解更多，关注关注我的微信公众号：守候书阁\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV1Cv6?w=258\x26amp;h=258\x22 src=\x22https:\/\/static.alili.tech\/img\/bV1Cv6?w=258\x26amp;h=258\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>记一次低级并严重的开发失误</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000013662019">https://segmentfault.com/a/1190000013662019</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/3gp8uwj4tkw/" target="_blank">https://alili.tech/archive/3gp8uwj4tkw/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>