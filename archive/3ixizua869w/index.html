<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="重构 - 设计API的扩展机制"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>重构 - 设计API的扩展机制 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/3ixizua869w/",
				"appid": "1613049289050283", 
				"title": "重构 - 设计API的扩展机制 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-01T02:30:12"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/1479pecm0mbo/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/cmoed8y3hh/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f3ixizua869w%2f&text=%e9%87%8d%e6%9e%84%20-%20%e8%ae%be%e8%ae%a1API%e7%9a%84%e6%89%a9%e5%b1%95%e6%9c%ba%e5%88%b6"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f3ixizua869w%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f3ixizua869w%2f&text=%e9%87%8d%e6%9e%84%20-%20%e8%ae%be%e8%ae%a1API%e7%9a%84%e6%89%a9%e5%b1%95%e6%9c%ba%e5%88%b6"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f3ixizua869w%2f&title=%e9%87%8d%e6%9e%84%20-%20%e8%ae%be%e8%ae%a1API%e7%9a%84%e6%89%a9%e5%b1%95%e6%9c%ba%e5%88%b6"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f3ixizua869w%2f&is_video=false&description=%e9%87%8d%e6%9e%84%20-%20%e8%ae%be%e8%ae%a1API%e7%9a%84%e6%89%a9%e5%b1%95%e6%9c%ba%e5%88%b6"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e9%87%8d%e6%9e%84%20-%20%e8%ae%be%e8%ae%a1API%e7%9a%84%e6%89%a9%e5%b1%95%e6%9c%ba%e5%88%b6&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f3ixizua869w%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f3ixizua869w%2f&title=%e9%87%8d%e6%9e%84%20-%20%e8%ae%be%e8%ae%a1API%e7%9a%84%e6%89%a9%e5%b1%95%e6%9c%ba%e5%88%b6"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f3ixizua869w%2f&title=%e9%87%8d%e6%9e%84%20-%20%e8%ae%be%e8%ae%a1API%e7%9a%84%e6%89%a9%e5%b1%95%e6%9c%ba%e5%88%b6"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f3ixizua869w%2f&title=%e9%87%8d%e6%9e%84%20-%20%e8%ae%be%e8%ae%a1API%e7%9a%84%e6%89%a9%e5%b1%95%e6%9c%ba%e5%88%b6"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f3ixizua869w%2f&title=%e9%87%8d%e6%9e%84%20-%20%e8%ae%be%e8%ae%a1API%e7%9a%84%e6%89%a9%e5%b1%95%e6%9c%ba%e5%88%b6"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">重构 - 设计API的扩展机制</h1><div class="meta"><div class="postdate"><time datetime="2018-12-01" itemprop="datePublished">2018-12-01</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e1.前言\x3c\/h2\x3e\n\x3cp\x3e上篇文章，主要介绍了重构的一些概念和一些简单的实例。这一次，详细的说下项目中的一个重构场景--给API设计扩展机制。目的就是为了方便以后能灵活应对需求的改变。当然了，是否需要设计扩展性这个要看API的需求。如果大家有什么建议，欢迎评论留言。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e2.扩展性表现形式\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e2-1.prototype\x3c\/h3\x3e\n\x3cp\x3e这个可以说是JS里面最原的一个扩展。比如原生JS没有提供打乱数组顺序的API，但是开发者又想方便使用，这样的话，就只能扩展数组的prototype。代码如下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/扩展Array.prototype，增加打乱数组的方法。\nArray.prototype.upset=function(){\n    return this.sort((n1,n2)=\x3eMath.random() - 0.5);\n}\n\nlet arr=[1,2,3,4,5];\n\/\/调用\narr.upset();\n\/\/显示结果\nconsole.log(arr);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/扩展Array.prototype，增加打乱数组的方法。\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e.prototype.upset=\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.sort(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3en1,n2\x3c\/span\x3e)=\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.random() - \x3cspan class=\x22hljs-number\x22\x3e0.5\x3c\/span\x3e);\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e arr=[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e];\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/调用\x3c\/span\x3e\narr.upset();\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/显示结果\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(arr);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行结果\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV9BMM?w=239\x26amp;h=63\x22 src=\x22https:\/\/static.alili.tech\/img\/bV9BMM?w=239\x26amp;h=63\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e功能是实现了。但是上面的代码，只想借用例子讲解扩展性，大家看下就好。不要模仿，也不要在项目这样写。现在基本都禁止这样开发了。理由也很简单，之前的文章也有提到过。这里重复一下。\x3c\/p\x3e\n\x3cp\x3e这样就污染了原生对象Array，别人创建的Array也会被污染，造成不必要的开销。最可怕的是，万一自己命名的跟原生的方法重名了，就被覆盖原来的方法了。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Array.prototype.push=function(){console.log(\x27守候\x27)}  \nlet arrTest=[123]\narrTest.push()\n\/\/result:守候\n\/\/push方法有什么作用，大家应该知道，不知道的可以去w3c看下\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e.prototype.push=\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27守候\x27\x3c\/span\x3e)}  \n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e arrTest=[\x3cspan class=\x22hljs-number\x22\x3e123\x3c\/span\x3e]\narrTest.push()\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/result:守候\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/push方法有什么作用，大家应该知道，不知道的可以去w3c看下\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV9BMO?w=441\x26amp;h=73\x22 src=\x22https:\/\/static.alili.tech\/img\/bV9BMO?w=441\x26amp;h=73\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e2-2.jQuery\x3c\/h3\x3e\n\x3cp\x3e关于 jQuery 的扩展性，分别提供了三个API:$.extend()、$.fn和$.fn.extend()。分别对jQuery的本身，静态方法，原型对象进行扩展，基于jQuery写插件的时候，最离不开的应该就是$.fn.extend()。\x3c\/p\x3e\n\x3cp\x3e参考链接：\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/caibaojian.com\/jquery-extend-and-jquery-fn-extend.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e理解jquery的$.extend()、$.fn和$.fn.extend()\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22https:\/\/www.cnblogs.com\/shy1766IT\/p\/5762707.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJquery自定义插件之$.extend()、$.fn和$.fn.extend()\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e2-3.VUE\x3c\/h3\x3e\n\x3cp\x3e对VUE进行扩展，引用官网（\x3ca href=\x22https:\/\/cn.vuejs.org\/v2\/guide\/plugins.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e插件\x3c\/a\x3e）的说法，扩展的方式一般有以下几种：\x3c\/p\x3e\n\x3cp\x3e1.添加全局方法或者属性，如: vue-custom-element\x3c\/p\x3e\n\x3cp\x3e2.添加全局资源：指令\/过滤器\/过渡等，如 vue-touch\x3c\/p\x3e\n\x3cp\x3e3.通过全局 mixin 方法添加一些组件选项，如: vue-router\x3c\/p\x3e\n\x3cp\x3e4.添加 Vue 实例方法，通过把它们添加到 Vue.prototype 上实现。\x3c\/p\x3e\n\x3cp\x3e5.一个库，提供自己的 API，同时提供上面提到的一个或多个功能，如 vue-router\x3c\/p\x3e\n\x3cp\x3e基于VUE的扩展。在组件，插件的内容提供一个install方法。如下\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV9EeL?w=517\x26amp;h=399\x22 src=\x22https:\/\/static.alili.tech\/img\/bV9EeL?w=517\x26amp;h=399\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e使用组件\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV9Ee8?w=167\x26amp;h=35\x22 src=\x22https:\/\/static.alili.tech\/img\/bV9Ee8?w=167\x26amp;h=35\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e上面几个扩展性的实例分别是原生对象，库，框架的扩展，大家可能觉得有点夸夸而谈，那下面就分享一个日常开发常用的一个实例。\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e3.实例-表单验证\x3c\/h2\x3e\n\x3cp\x3e看了上面那些扩展性的实例，下面看下一个在日常开发使用得也很多的一个实例：表单验证。这块可以说很简单，但是做好，做通用不简单。看了《JavaScript设计模式与开发实践》，用策略模式对以前的表单验证函数进行了一个重构。下面进行一个简单的分析。\x3c\/p\x3e\n\x3cblockquote\x3e下面的内容，代码会偏多，虽然代码不难，但还是强烈建议大家不要只看，要边看，边写，边调试，不然作为读者，很可能不知道我的代码是什么意思，很容易懵。下面的代码回涉两个知识：开放-封闭原则和策略模式，大家可以自行了解。\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e3-1.原来方案\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/**\n * @description 字段检验\n * @param checkArr\n * @returns {boolean}\n *\/\nfunction validateForm(checkArr){\n    let _reg = null, ruleMsg, nullMsg, lenMsg;\n    for (let i = 0, len = checkArr.length; i \x3c len; i\x2b\x2b) {\n        \/\/如果没字段值是undefined，不再执行当前循环，执行下一次循环\n        if (checkArr[i].el === undefined) {\n            continue;\n        }\n        \/\/设置规则错误提示信息\n        ruleMsg = checkArr[i].msg || \x27字段格式错误\x27;\n        \/\/设置值为空则错误提示信息\n        nullMsg = checkArr[i].nullMsg || \x27字段不能为空\x27;\n        \/\/设置长度错误提示信息\n        lenMsg = checkArr[i].lenMsg || \x27字段长度范围\x27 \x2b checkArr[i].minLength \x2b \x26quot;至\x26quot; \x2b checkArr[i].maxLength;\n        \/\/如果该字段有空值校验\n        if (checkArr[i].noNull === true) {\n            \/\/如果字段为空，返回结果又提示信息\n            if (checkArr[i].el === \x26quot;\x26quot; || checkArr[i].el === null) {\n                return nullMsg;\n            }\n        }\n        \/\/如果有该字段有规则校验\n        if (checkArr[i].rule) {\n            \/\/设置规则\n            switch (checkArr[i].rule) {\n                case \x27mobile\x27:\n                    _reg = \/^1[3|4|5|7|8][0-9]\\d{8}$\/;\n                    break;\n                case \x27tel\x27:\n                    _reg = \/^\\d{3}-\\d{8}|\\d{4}-\\d{7}|\\d{11}$\/;\n                    break;\n            }\n            \/\/如果字段不为空，并且规则错误，返回错误信息\n            if (!_reg.test(checkArr[i].el) \x26amp;\x26amp; checkArr[i].el !== \x26quot;\x26quot; \x26amp;\x26amp; checkArr[i].el !== null) {\n                return ruleMsg;\n            }\n        }\n        \/\/如果字段不为空并且长度错误，返回错误信息\n        if (checkArr[i].el !== null \x26amp;\x26amp; checkArr[i].el !== \x27\x27 \x26amp;\x26amp; (checkArr[i].minLength || checkArr[i].maxLength)) {\n            if (checkArr[i].el.toString().length \x3c checkArr[i].minLength || checkArr[i].el.toString().length \x3e checkArr[i].maxLength) {\n                return lenMsg;\n            }\n        }\n    }\n    return false;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * @description 字段检验\n * @param checkArr\n * @returns {boolean}\n *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3evalidateForm\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3echeckArr\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e _reg = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, ruleMsg, nullMsg, lenMsg;\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, len = checkArr.length; i \x26lt; len; i\x2b\x2b) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果没字段值是undefined，不再执行当前循环，执行下一次循环\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (checkArr[i].el === \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-keyword\x22\x3econtinue\x3c\/span\x3e;\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/设置规则错误提示信息\x3c\/span\x3e\n        ruleMsg = checkArr[i].msg || \x3cspan class=\x22hljs-string\x22\x3e\x27字段格式错误\x27\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/设置值为空则错误提示信息\x3c\/span\x3e\n        nullMsg = checkArr[i].nullMsg || \x3cspan class=\x22hljs-string\x22\x3e\x27字段不能为空\x27\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/设置长度错误提示信息\x3c\/span\x3e\n        lenMsg = checkArr[i].lenMsg || \x3cspan class=\x22hljs-string\x22\x3e\x27字段长度范围\x27\x3c\/span\x3e \x2b checkArr[i].minLength \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22至\x22\x3c\/span\x3e \x2b checkArr[i].maxLength;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果该字段有空值校验\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (checkArr[i].noNull === \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果字段为空，返回结果又提示信息\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (checkArr[i].el === \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e || checkArr[i].el === \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e nullMsg;\n            }\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果有该字段有规则校验\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (checkArr[i].rule) {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/设置规则\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e (checkArr[i].rule) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27mobile\x27\x3c\/span\x3e:\n                    _reg = \x3cspan class=\x22hljs-regexp\x22\x3e\/^1[3|4|5|7|8][0-9]\\d{8}$\/\x3c\/span\x3e;\n                    \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n                \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27tel\x27\x3c\/span\x3e:\n                    _reg = \x3cspan class=\x22hljs-regexp\x22\x3e\/^\\d{3}-\\d{8}|\\d{4}-\\d{7}|\\d{11}$\/\x3c\/span\x3e;\n                    \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n            }\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果字段不为空，并且规则错误，返回错误信息\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!_reg.test(checkArr[i].el) \x26amp;\x26amp; checkArr[i].el !== \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e \x26amp;\x26amp; checkArr[i].el !== \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e ruleMsg;\n            }\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果字段不为空并且长度错误，返回错误信息\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (checkArr[i].el !== \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e \x26amp;\x26amp; checkArr[i].el !== \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e \x26amp;\x26amp; (checkArr[i].minLength || checkArr[i].maxLength)) {\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (checkArr[i].el.toString().length \x26lt; checkArr[i].minLength || checkArr[i].el.toString().length \x26gt; checkArr[i].maxLength) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e lenMsg;\n            }\n        }\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e函数调用方式\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    let testData={\n        phone:\x2718819323632\x27,\n        pwd:\x27112\x27\n    }\n\n    let _tips = validateForm([\n        {el: testData.phone, noNull: true, nullMsg: \x27电话号码不能为空\x27,rule: \x26quot;mobile\x26quot;, msg: \x27电话号码格式错误\x27},\n        {el: testData.pwd, noNull: true, nullMsg: \x27密码不能为空\x27,lenMsg:\x27密码长度不正确\x27,minLength:6,maxLength:18}\n    ]);\n    \/\/字段验证如果返回错误信息\n    if (_tips) {\n        alert(_tips);\n    }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3e    let testData={\n\x3cspan class=\x22hljs-symbol\x22\x3e        phone:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x2718819323632\x27\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e        pwd:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27112\x27\x3c\/span\x3e\n    }\n\n    let _tips = validateForm([\n        {\x3cspan class=\x22hljs-string\x22\x3eel:\x3c\/span\x3e testData.phone, \x3cspan class=\x22hljs-string\x22\x3enoNull:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3enullMsg:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27电话号码不能为空\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3erule:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22mobile\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3emsg:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27电话号码格式错误\x27\x3c\/span\x3e},\n        {\x3cspan class=\x22hljs-string\x22\x3eel:\x3c\/span\x3e testData.pwd, \x3cspan class=\x22hljs-string\x22\x3enoNull:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3enullMsg:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27密码不能为空\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3elenMsg:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27密码长度不正确\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3eminLength:\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3emaxLength:\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e18\x3c\/span\x3e}\n    ]);\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/字段验证如果返回错误信息\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (_tips) {\n        alert(_tips);\n    }\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e3-2.存在问题\x3c\/h3\x3e\n\x3cp\x3e这样方法，相信大家看的也难受，因为问题确实是比较多。\x3c\/p\x3e\n\x3cp\x3e1.一个字段进入，可能要经过三种判断（空值，规则，长度）。如果只是一个简单的电话号码规则校验，就要经过其他两种没必要的校验，造成不必要的开销。运行的流程就如同下面。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV93ux?w=508\x26amp;h=1023\x22 src=\x22https:\/\/static.alili.tech\/img\/bV93ux?w=508\x26amp;h=1023\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e2.规则校验里面，只有这几种校验，如果要增加其他校验，比如增加一个日期的规则，无法完成。如果一直修改源码，可能会导致函数巨大。\x3c\/p\x3e\n\x3cp\x3e3.写法不优雅，调用也不方便。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e3-3.代替方案\x3c\/h3\x3e\n\x3cp\x3e针对上面2-2的三个问题，逐个进行改善。\x3c\/p\x3e\n\x3cblockquote\x3e因为调用方式就不方便，很难在不改变validateForm调用方式的同时，优化重构内部的代码，又增加扩展性。重写这个方法又不可能，因为有个别的地方已经使用了这个API，自己一个一个的改不现实，所以就不修改这个validateForm，新建一个新的API:validate。在以后的项目上，也尽量引导同事放弃validateForm，使用新的API。\x3c\/blockquote\x3e\n\x3cp\x3e上面第一个，优化校验规则，每次校验（比如空值，长度，规则），都是一个简单的校验，不再执行其他没必要的校验。运行流程如同下面。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV93uz?w=414\x26amp;h=486\x22 src=\x22https:\/\/static.alili.tech\/img\/bV93uz?w=414\x26amp;h=486\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let validate = function (arr) {\n    let ruleData = {\n        \/**\n         * @description 不能为空\n         * @param val\n         * @param msg\n         * @return {*}\n         *\/\n        isNoNull(val, msg){\n            if (!val) {\n                return msg\n            }\n        },\n        \/**\n         * @description 最小长度\n         * @param val\n         * @param length\n         * @param msg\n         * @return {*}\n         *\/\n        minLength(val, length, msg){\n            if (val.toString().length \x3c length) {\n                return msg\n            }\n        },\n        \/**\n         * @description 最大长度\n         * @param val\n         * @param length\n         * @param msg\n         * @return {*}\n         *\/\n        maxLength(val, length, msg){\n            if (val.toString().length \x3e length) {\n                return msg\n            }\n        },\n        \/**\n         * @description 是否是手机号码格式\n         * @param val\n         * @param msg\n         * @return {*}\n         *\/\n        isMobile(val, msg){\n            if (!\/^1[3-9]\\d{9}$\/.test(val)) {\n                return msg\n            }\n        }\n    }\n    let ruleMsg, checkRule, _rule;\n    for (let i = 0, len = arr.length; i \x3c len; i\x2b\x2b) {\n        \/\/如果字段找不到\n        if (arr[i].el === undefined) {\n            return \x27字段找不到！\x27\n        }\n        \/\/遍历规则\n        for (let j = 0; j \x3c arr[i].rules.length; j\x2b\x2b) {\n            \/\/提取规则\n            checkRule = arr[i].rules[j].rule.split(\x26quot;:\x26quot;);\n            _rule = checkRule.shift();\n            checkRule.unshift(arr[i].el);\n            checkRule.push(arr[i].rules[j].msg);\n            \/\/如果规则错误\n            ruleMsg = ruleData[_rule].apply(null, checkRule);\n            if (ruleMsg) {\n                \/\/返回错误信息\n                return ruleMsg;\n            }\n        }\n    }\n};\nlet testData = {\n    name: \x27\x27,\n    phone: \x2718819522663\x27,\n    pw: \x27asda\x27\n}\n\/\/校验函数调用\nconsole.log(validate([\n    {\n        \/\/校验的数据\n        el: testData.phone,\n        \/\/校验的规则\n        rules: [\n            {rule: \x27isNoNull\x27, msg: \x27电话不能为空\x27}, {rule: \x27isMobile\x27, msg: \x27手机号码格式不正确\x27}\n        ]\n    },\n    {\n        el: testData.pw,\n        rules: [\n            {rule: \x27isNoNull\x27, msg: \x27电话不能为空\x27},\n            {rule:\x27minLength:6\x27,msg:\x27密码长度不能小于6\x27}\n        ]\n    }\n]));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3elet validate = function (arr) {\n    let ruleData = {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/**\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@description\x3c\/span\x3e 不能为空\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e val\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e msg\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@return\x3c\/span\x3e {*}\n         *\/\x3c\/span\x3e\n        isNoNull(\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e, msg){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e msg\n            }\n        },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/**\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@description\x3c\/span\x3e 最小长度\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e val\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e length\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e msg\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@return\x3c\/span\x3e {*}\n         *\/\x3c\/span\x3e\n        minLength(\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e, length, msg){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e.toString().length \x26lt; length) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e msg\n            }\n        },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/**\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@description\x3c\/span\x3e 最大长度\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e val\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e length\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e msg\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@return\x3c\/span\x3e {*}\n         *\/\x3c\/span\x3e\n        maxLength(\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e, length, msg){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e.toString().length \x26gt; length) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e msg\n            }\n        },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/**\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@description\x3c\/span\x3e 是否是手机号码格式\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e val\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e msg\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@return\x3c\/span\x3e {*}\n         *\/\x3c\/span\x3e\n        isMobile(\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e, msg){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\/^\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e[\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e-9\x3c\/span\x3e]\\d{\x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3e}$\/.test(\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e)) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e msg\n            }\n        }\n    }\n    let ruleMsg, checkRule, _rule;\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (let i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, len = arr.length; i \x26lt; len; i\x2b\x2b) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果字段找不到\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (arr[i].el === undefined) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27字段找不到！\x27\x3c\/span\x3e\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/遍历规则\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (let j = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; j \x26lt; arr[i].rules.length; j\x2b\x2b) {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/提取规则\x3c\/span\x3e\n            checkRule = arr[i].rules[j].rule.split(\x3cspan class=\x22hljs-string\x22\x3e\x22:\x22\x3c\/span\x3e);\n            _rule = checkRule.shift();\n            checkRule.unshift(arr[i].el);\n            checkRule.push(arr[i].rules[j].msg);\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果规则错误\x3c\/span\x3e\n            ruleMsg = ruleData[_rule].apply(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, checkRule);\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ruleMsg) {\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/返回错误信息\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e ruleMsg;\n            }\n        }\n    }\n};\nlet testData = {\n    name: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e,\n    phone: \x3cspan class=\x22hljs-string\x22\x3e\x2718819522663\x27\x3c\/span\x3e,\n    pw: \x3cspan class=\x22hljs-string\x22\x3e\x27asda\x27\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/校验函数调用\x3c\/span\x3e\nconsole.log(validate([\n    {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/校验的数据\x3c\/span\x3e\n        el: testData.phone,\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/校验的规则\x3c\/span\x3e\n        rules: [\n            {rule: \x3cspan class=\x22hljs-string\x22\x3e\x27isNoNull\x27\x3c\/span\x3e, msg: \x3cspan class=\x22hljs-string\x22\x3e\x27电话不能为空\x27\x3c\/span\x3e}, {rule: \x3cspan class=\x22hljs-string\x22\x3e\x27isMobile\x27\x3c\/span\x3e, msg: \x3cspan class=\x22hljs-string\x22\x3e\x27手机号码格式不正确\x27\x3c\/span\x3e}\n        ]\n    },\n    {\n        el: testData.pw,\n        rules: [\n            {rule: \x3cspan class=\x22hljs-string\x22\x3e\x27isNoNull\x27\x3c\/span\x3e, msg: \x3cspan class=\x22hljs-string\x22\x3e\x27电话不能为空\x27\x3c\/span\x3e},\n            {rule:\x3cspan class=\x22hljs-string\x22\x3e\x27minLength:6\x27\x3c\/span\x3e,msg:\x3cspan class=\x22hljs-string\x22\x3e\x27密码长度不能小于6\x27\x3c\/span\x3e}\n        ]\n    }\n]));\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果又有其它的规则，又得改这个，这样就违反了开放-封闭原则。如果多人共用这个函数，规则可能会很多，ruleData会变的巨大，造成不必要的开销。比如A页面有金额的校验，但是只有A页面有。如果按照上面的方式改，在B页面也会加载金额的校验规则，但是根本不会用上，造成资源浪费。\x3c\/p\x3e\n\x3cp\x3e所以下面应用开放-封闭原则。给函数的校验规则增加扩展性。在实操之前，大家应该会懵，因为一个函数，可以进行校验的操作，又有增加校验规则的操作。一个函数做两件事，就违反了单一原则。到时候也难维护，所以推荐的做法就是分接口做。如下写法。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let validate = (function () {\n    let ruleData = {\n        \/**\n         * @description 不能为空\n         * @param val\n         * @param msg\n         * @return {*}\n         *\/\n        isNoNull(val, msg){\n            if (!val) {\n                return msg\n            }\n        },\n        \/**\n         * @description 最小长度\n         * @param val\n         * @param length\n         * @param msg\n         * @return {*}\n         *\/\n        minLength(val, length, msg){\n            if (val.toString().length \x3c length) {\n                return msg\n            }\n        },\n        \/**\n         * @description 最大长度\n         * @param val\n         * @param length\n         * @param msg\n         * @return {*}\n         *\/\n        maxLength(val, length, msg){\n            if (val.toString().length \x3e length) {\n                return msg\n            }\n        },\n        \/**\n         * @description 是否是手机号码格式\n         * @param val\n         * @param msg\n         * @return {*}\n         *\/\n        isMobile(val, msg){\n            if (!\/^1[3-9]\\d{9}$\/.test(val)) {\n                return msg\n            }\n        }\n    }\n    return {\n        \/**\n         * @description 查询接口\n         * @param arr\n         * @return {*}\n         *\/\n        check: function (arr) {\n            let ruleMsg, checkRule, _rule;\n            for (let i = 0, len = arr.length; i \x3c len; i\x2b\x2b) {\n                \/\/如果字段找不到\n                if (arr[i].el === undefined) {\n                    return \x27字段找不到！\x27\n                }\n                \/\/遍历规则\n                for (let j = 0; j \x3c arr[i].rules.length; j\x2b\x2b) {\n                    \/\/提取规则\n                    checkRule = arr[i].rules[j].rule.split(\x26quot;:\x26quot;);\n                    _rule = checkRule.shift();\n                    checkRule.unshift(arr[i].el);\n                    checkRule.push(arr[i].rules[j].msg);\n                    \/\/如果规则错误\n                    ruleMsg = ruleData[_rule].apply(null, checkRule);\n                    if (ruleMsg) {\n                        \/\/返回错误信息\n                        return ruleMsg;\n                    }\n                }\n            }\n        },\n        \/**\n         * @description 添加规则接口\n         * @param type\n         * @param fn\n         *\/\n        addRule:function (type,fn) {\n            ruleData[type]=fn;\n        }\n    }\n})();\n\/\/校验函数调用-测试用例\nconsole.log(validate.check([\n    {\n        \/\/校验的数据\n        el: testData.mobile,\n        \/\/校验的规则\n        rules: [\n            {rule: \x27isNoNull\x27, msg: \x27电话不能为空\x27}, {rule: \x27isMobile\x27, msg: \x27手机号码格式不正确\x27}\n        ]\n    },\n    {\n        el: testData.password,\n        rules: [\n            {rule: \x27isNoNull\x27, msg: \x27电话不能为空\x27},\n            {rule:\x27minLength:6\x27,msg:\x27密码长度不能小于6\x27}\n        ]\n    }\n]));\n\/\/扩展-添加日期范围校验\nvalidate.addRule(\x27isDateRank\x27,function (val,msg) {\n    if(new Date(val[0]).getTime()\x3e=new Date(val[1]).getTime()){\n        return msg;\n    }\n});\n\/\/测试新添加的规则-日期范围校验\nconsole.log(validate.check([\n    {\n        el:[\x272017-8-9 22:00:00\x27,\x272017-8-8 24:00:00\x27],\n        rules:[{\n            rule:\x27isDateRank\x27,msg:\x27日期范围不正确\x27\n        }]\n    }\n    \n]));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs zephir\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e validate = (\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e ruleData = {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/**\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@description\x3c\/span\x3e 不能为空\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e val\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e msg\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@return\x3c\/span\x3e {*}\n         *\/\x3c\/span\x3e\n        isNoNull(val, msg){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!val) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e msg\n            }\n        },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/**\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@description\x3c\/span\x3e 最小长度\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e val\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e length\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e msg\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@return\x3c\/span\x3e {*}\n         *\/\x3c\/span\x3e\n        minLength(val, length, msg){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (val.toString().length \x26lt; length) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e msg\n            }\n        },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/**\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@description\x3c\/span\x3e 最大长度\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e val\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e length\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e msg\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@return\x3c\/span\x3e {*}\n         *\/\x3c\/span\x3e\n        maxLength(val, length, msg){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (val.toString().length \x26gt; length) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e msg\n            }\n        },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/**\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@description\x3c\/span\x3e 是否是手机号码格式\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e val\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e msg\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@return\x3c\/span\x3e {*}\n         *\/\x3c\/span\x3e\n        isMobile(val, msg){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\/^\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e[\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e-9\x3c\/span\x3e]\\d{\x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3e}$\/.test(val)) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e msg\n            }\n        }\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/**\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@description\x3c\/span\x3e 查询接口\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e arr\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@return\x3c\/span\x3e {*}\n         *\/\x3c\/span\x3e\n        check: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(arr)\x3c\/span\x3e \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e ruleMsg, checkRule, _rule;\n            \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, len = arr.length; i \x26lt; len; i\x2b\x2b) {\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果字段找不到\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (arr[i].el === undefined) {\n                    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27字段找不到！\x27\x3c\/span\x3e\n                }\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/遍历规则\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e j = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; j \x26lt; arr[i].rules.length; j\x2b\x2b) {\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/提取规则\x3c\/span\x3e\n                    checkRule = arr[i].rules[j].rule.split(\x3cspan class=\x22hljs-string\x22\x3e\x22:\x22\x3c\/span\x3e);\n                    _rule = checkRule.shift();\n                    checkRule.unshift(arr[i].el);\n                    checkRule.push(arr[i].rules[j].msg);\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果规则错误\x3c\/span\x3e\n                    ruleMsg = ruleData[_rule].apply(\x3cspan class=\x22hljs-keyword\x22\x3enull\x3c\/span\x3e, checkRule);\n                    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ruleMsg) {\n                        \x3cspan class=\x22hljs-comment\x22\x3e\/\/返回错误信息\x3c\/span\x3e\n                        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e ruleMsg;\n                    }\n                }\n            }\n        },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/**\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@description\x3c\/span\x3e 添加规则接口\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e type\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e fn\n         *\/\x3c\/span\x3e\n        addRule:\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(type,fn)\x3c\/span\x3e \x3c\/span\x3e{\n            ruleData[type]=fn;\n        }\n    }\n})();\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/校验函数调用-测试用例\x3c\/span\x3e\nconsole.log(validate.check([\n    {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/校验的数据\x3c\/span\x3e\n        el: testData.mobile,\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/校验的规则\x3c\/span\x3e\n        rules: [\n            {rule: \x3cspan class=\x22hljs-string\x22\x3e\x27isNoNull\x27\x3c\/span\x3e, msg: \x3cspan class=\x22hljs-string\x22\x3e\x27电话不能为空\x27\x3c\/span\x3e}, {rule: \x3cspan class=\x22hljs-string\x22\x3e\x27isMobile\x27\x3c\/span\x3e, msg: \x3cspan class=\x22hljs-string\x22\x3e\x27手机号码格式不正确\x27\x3c\/span\x3e}\n        ]\n    },\n    {\n        el: testData.password,\n        rules: [\n            {rule: \x3cspan class=\x22hljs-string\x22\x3e\x27isNoNull\x27\x3c\/span\x3e, msg: \x3cspan class=\x22hljs-string\x22\x3e\x27电话不能为空\x27\x3c\/span\x3e},\n            {rule:\x3cspan class=\x22hljs-string\x22\x3e\x27minLength:6\x27\x3c\/span\x3e,msg:\x3cspan class=\x22hljs-string\x22\x3e\x27密码长度不能小于6\x27\x3c\/span\x3e}\n        ]\n    }\n]));\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/扩展-添加日期范围校验\x3c\/span\x3e\nvalidate.addRule(\x3cspan class=\x22hljs-string\x22\x3e\x27isDateRank\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(val,msg)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Date(val[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]).getTime()\x26gt;=\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Date(val[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e]).getTime()){\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e msg;\n    }\n});\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/测试新添加的规则-日期范围校验\x3c\/span\x3e\nconsole.log(validate.check([\n    {\n        el:[\x3cspan class=\x22hljs-string\x22\x3e\x272017-8-9 22:00:00\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x272017-8-8 24:00:00\x27\x3c\/span\x3e],\n        rules:[{\n            rule:\x3cspan class=\x22hljs-string\x22\x3e\x27isDateRank\x27\x3c\/span\x3e,msg:\x3cspan class=\x22hljs-string\x22\x3e\x27日期范围不正确\x27\x3c\/span\x3e\n        }]\n    }\n    \n]));\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如上代码所示，这里需要往ruleData添加日期范围的校验，这里可以添加。但是不能访问和修改ruleData的东西，有一个保护的作用。还有一个就是，比如在A页面添加日期的校验，只在A页面存在，不会影响其它页面。如果日期的校验在其它地方都可能用上，就可以考虑，在全局里面为ruleData添加日期的校验的规则。\x3c\/p\x3e\n\x3cp\x3e至于第三个问题，这样的想法，可能不算太优雅，调用也不是太方便，但是就我现在能想到的，这个就是最好方案啊了。\x3c\/p\x3e\n\x3cp\x3e这个看似是已经做完了，但是大家可能觉得有一种情况没能应对，比如下面这种，做不到。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV9ur6?w=471\x26amp;h=228\x22 src=\x22https:\/\/static.alili.tech\/img\/bV9ur6?w=471\x26amp;h=228\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e因为上面的check接口，只要有一个错误了，就立马跳出了，不会校验下一个。如果要实现下面的功能，就得实现，如果有一个值校验错误，就记录错误信息，继续校验下一个，等到所有的校验都执行完了之后，如下面的流程图。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV93uI?w=497\x26amp;h=768\x22 src=\x22https:\/\/static.alili.tech\/img\/bV93uI?w=497\x26amp;h=768\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e代码上面（大家先忽略alias这个属性）\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let validate= (function () {\n    let ruleData = {\n        \/**\n         * @description 不能为空\n         * @param val\n         * @param msg\n         * @return {*}\n         *\/\n        isNoNull(val, msg){\n            if (!val) {\n                return msg\n            }\n        },\n        \/**\n         * @description 最小长度\n         * @param val\n         * @param length\n         * @param msg\n         * @return {*}\n         *\/\n        minLength(val, length, msg){\n            if (val.toString().length \x3c length) {\n                return msg\n            }\n        },\n        \/**\n         * @description 最大长度\n         * @param val\n         * @param length\n         * @param msg\n         * @return {*}\n         *\/\n        maxLength(val, length, msg){\n            if (val.toString().length \x3e length) {\n                return msg\n            }\n        },\n        \/**\n         * @description 是否是手机号码格式\n         * @param val\n         * @param msg\n         * @return {*}\n         *\/\n        isMobile(val, msg){\n            if (!\/^1[3-9]\\d{9}$\/.test(val)) {\n                return msg\n            }\n        }\n    }\n    return {\n        check: function (arr) {\n            \/\/代码不重复展示，上面一部分\n        },\n        addRule:function (type,fn) {\n            \/\/代码不重复展示，上面一部分\n        },\n        \/**\n         * @description 校验所有接口\n         * @param arr\n         * @return {*}\n         *\/\n        checkAll: function (arr) {\n            let ruleMsg, checkRule, _rule,msgArr=[];\n            for (let i = 0, len = arr.length; i \x3c len; i\x2b\x2b) {\n                \/\/如果字段找不到\n                if (arr[i].el === undefined) {\n                    return \x27字段找不到！\x27\n                }\n                \/\/如果字段为空以及规则不是校验空的规则\n\n                \/\/遍历规则\n                for (let j = 0; j \x3c arr[i].rules.length; j\x2b\x2b) {\n                    \/\/提取规则\n                    checkRule = arr[i].rules[j].rule.split(\x26quot;:\x26quot;);\n                    _rule = checkRule.shift();\n                    checkRule.unshift(arr[i].el);\n                    checkRule.push(arr[i].rules[j].msg);\n                    \/\/如果规则错误\n                    ruleMsg = ruleData[_rule].apply(null, checkRule);\n                    if (ruleMsg) {\n                        \/\/记录错误信息\n                        msgArr.push({\n                            el:arr[i].el,\n                            alias:arr[i].alias,\n                            rules:_rule,\n                            msg:ruleMsg\n                        });\n                    }\n                }\n            }\n            \/\/返回错误信息\n            return msgArr.length\x3e0?msgArr:false;\n        }\n    }\n})();\nlet testData = {\n    name: \x27\x27,\n    phone: \x27188\x27,\n    pw: \x27asda\x27\n}\n\/\/扩展-添加日期范围校验\nvalidate.addRule(\x27isDateRank\x27,function (val,msg) {\n    if(new Date(val[0]).getTime()\x3e=new Date(val[1]).getTime()){\n        return msg;\n    }\n});\n\/\/校验函数调用\nconsole.log(validate.checkAll([\n    {\n        \/\/校验的数据\n        el: testData.phone,\n        alias:\x27mobile\x27,\n        \/\/校验的规则\n        rules: [\n            {rule: \x27isNoNull\x27, msg: \x27电话不能为空\x27}, {rule: \x27isMobile\x27, msg: \x27手机号码格式不正确\x27},{rule:\x27minLength:6\x27,msg: \x27手机号码不能少于6\x27}\n        ]\n    },\n    {\n        el: testData.pw,\n        alias:\x27pwd\x27,\n        rules: [\n            {rule: \x27isNoNull\x27, msg: \x27电话不能为空\x27},\n            {rule:\x27minLength:6\x27,msg:\x27密码长度不能小于6\x27}\n        ]\n    },\n    {\n        el:[\x272017-8-9 22:00:00\x27,\x272017-8-8 24:00:00\x27],\n        rules:[{\n            rule:\x27isDateRank\x27,msg:\x27日期范围不正确\x27\n        }]\n    }\n]));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs zephir\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e validate= (\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e ruleData = {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/**\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@description\x3c\/span\x3e 不能为空\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e val\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e msg\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@return\x3c\/span\x3e {*}\n         *\/\x3c\/span\x3e\n        isNoNull(val, msg){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!val) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e msg\n            }\n        },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/**\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@description\x3c\/span\x3e 最小长度\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e val\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e length\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e msg\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@return\x3c\/span\x3e {*}\n         *\/\x3c\/span\x3e\n        minLength(val, length, msg){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (val.toString().length \x26lt; length) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e msg\n            }\n        },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/**\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@description\x3c\/span\x3e 最大长度\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e val\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e length\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e msg\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@return\x3c\/span\x3e {*}\n         *\/\x3c\/span\x3e\n        maxLength(val, length, msg){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (val.toString().length \x26gt; length) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e msg\n            }\n        },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/**\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@description\x3c\/span\x3e 是否是手机号码格式\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e val\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e msg\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@return\x3c\/span\x3e {*}\n         *\/\x3c\/span\x3e\n        isMobile(val, msg){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\/^\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e[\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e-9\x3c\/span\x3e]\\d{\x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3e}$\/.test(val)) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e msg\n            }\n        }\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n        check: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(arr)\x3c\/span\x3e \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/代码不重复展示，上面一部分\x3c\/span\x3e\n        },\n        addRule:\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(type,fn)\x3c\/span\x3e \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/代码不重复展示，上面一部分\x3c\/span\x3e\n        },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/**\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@description\x3c\/span\x3e 校验所有接口\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e arr\n         * \x3cspan class=\x22hljs-doctag\x22\x3e@return\x3c\/span\x3e {*}\n         *\/\x3c\/span\x3e\n        checkAll: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(arr)\x3c\/span\x3e \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e ruleMsg, checkRule, _rule,msgArr=[];\n            \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, len = arr.length; i \x26lt; len; i\x2b\x2b) {\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果字段找不到\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (arr[i].el === undefined) {\n                    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27字段找不到！\x27\x3c\/span\x3e\n                }\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果字段为空以及规则不是校验空的规则\x3c\/span\x3e\n\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/遍历规则\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e j = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; j \x26lt; arr[i].rules.length; j\x2b\x2b) {\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/提取规则\x3c\/span\x3e\n                    checkRule = arr[i].rules[j].rule.split(\x3cspan class=\x22hljs-string\x22\x3e\x22:\x22\x3c\/span\x3e);\n                    _rule = checkRule.shift();\n                    checkRule.unshift(arr[i].el);\n                    checkRule.push(arr[i].rules[j].msg);\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果规则错误\x3c\/span\x3e\n                    ruleMsg = ruleData[_rule].apply(\x3cspan class=\x22hljs-keyword\x22\x3enull\x3c\/span\x3e, checkRule);\n                    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ruleMsg) {\n                        \x3cspan class=\x22hljs-comment\x22\x3e\/\/记录错误信息\x3c\/span\x3e\n                        msgArr.push({\n                            el:arr[i].el,\n                            alias:arr[i].alias,\n                            rules:_rule,\n                            msg:ruleMsg\n                        });\n                    }\n                }\n            }\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/返回错误信息\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e msgArr.length\x26gt;\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e?msgArr:\x3cspan class=\x22hljs-keyword\x22\x3efalse\x3c\/span\x3e;\n        }\n    }\n})();\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e testData = {\n    name: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e,\n    phone: \x3cspan class=\x22hljs-string\x22\x3e\x27188\x27\x3c\/span\x3e,\n    pw: \x3cspan class=\x22hljs-string\x22\x3e\x27asda\x27\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/扩展-添加日期范围校验\x3c\/span\x3e\nvalidate.addRule(\x3cspan class=\x22hljs-string\x22\x3e\x27isDateRank\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(val,msg)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Date(val[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]).getTime()\x26gt;=\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Date(val[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e]).getTime()){\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e msg;\n    }\n});\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/校验函数调用\x3c\/span\x3e\nconsole.log(validate.checkAll([\n    {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/校验的数据\x3c\/span\x3e\n        el: testData.phone,\n        alias:\x3cspan class=\x22hljs-string\x22\x3e\x27mobile\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/校验的规则\x3c\/span\x3e\n        rules: [\n            {rule: \x3cspan class=\x22hljs-string\x22\x3e\x27isNoNull\x27\x3c\/span\x3e, msg: \x3cspan class=\x22hljs-string\x22\x3e\x27电话不能为空\x27\x3c\/span\x3e}, {rule: \x3cspan class=\x22hljs-string\x22\x3e\x27isMobile\x27\x3c\/span\x3e, msg: \x3cspan class=\x22hljs-string\x22\x3e\x27手机号码格式不正确\x27\x3c\/span\x3e},{rule:\x3cspan class=\x22hljs-string\x22\x3e\x27minLength:6\x27\x3c\/span\x3e,msg: \x3cspan class=\x22hljs-string\x22\x3e\x27手机号码不能少于6\x27\x3c\/span\x3e}\n        ]\n    },\n    {\n        el: testData.pw,\n        alias:\x3cspan class=\x22hljs-string\x22\x3e\x27pwd\x27\x3c\/span\x3e,\n        rules: [\n            {rule: \x3cspan class=\x22hljs-string\x22\x3e\x27isNoNull\x27\x3c\/span\x3e, msg: \x3cspan class=\x22hljs-string\x22\x3e\x27电话不能为空\x27\x3c\/span\x3e},\n            {rule:\x3cspan class=\x22hljs-string\x22\x3e\x27minLength:6\x27\x3c\/span\x3e,msg:\x3cspan class=\x22hljs-string\x22\x3e\x27密码长度不能小于6\x27\x3c\/span\x3e}\n        ]\n    },\n    {\n        el:[\x3cspan class=\x22hljs-string\x22\x3e\x272017-8-9 22:00:00\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x272017-8-8 24:00:00\x27\x3c\/span\x3e],\n        rules:[{\n            rule:\x3cspan class=\x22hljs-string\x22\x3e\x27isDateRank\x27\x3c\/span\x3e,msg:\x3cspan class=\x22hljs-string\x22\x3e\x27日期范围不正确\x27\x3c\/span\x3e\n        }]\n    }\n]));\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e看到结果，现在所有的不合法的数据的记录都返回回来了。至于当时alias现在揭晓用处。\x3cbr\x3e比如页面是vue渲染的，根据alias可以这样处理。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV9uDk?w=695\x26amp;h=487\x22 src=\x22https:\/\/static.alili.tech\/img\/bV9uDk?w=695\x26amp;h=487\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV9Nij?w=1336\x26amp;h=1039\x22 src=\x22https:\/\/static.alili.tech\/img\/bV9Nij?w=1336\x26amp;h=1039\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e如果是jQuery渲染的，根据alias可以这样处理。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV9Nh1?w=503\x26amp;h=462\x22 src=\x22https:\/\/static.alili.tech\/img\/bV9Nh1?w=503\x26amp;h=462\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV9Nh2?w=1291\x26amp;h=874\x22 src=\x22https:\/\/static.alili.tech\/img\/bV9Nh2?w=1291\x26amp;h=874\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e3-4.向下兼容方案\x3c\/h3\x3e\n\x3cp\x3e因为项目之前有使用了以前的校验API，不能一道切，在以前的API没废弃之前，不能影响之前的使用。所以要重写以前的validateForm，使之兼容现在的新API:validate。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    let validateForm=function (arr) {\n        let _param=[],_single={};\n        for(let i=0;i\x3carr.length;i\x2b\x2b){\n            _single={};\n            _single.el=arr[i].el;\n            _single.rules=[];\n            \/\/如有有非空检验\n            if(arr[i].noNull){\n                _single.rules.push({\n                    rule: \x27isNoNull\x27,\n                    msg: arr[i].nullMsg||\x27字段不能为空\x27\n                })\n            }\n            \/\/如果有最小长度校验\n            if(arr[i].minLength){\n                _single.rules.push({\n                    rule: \x27minLength:\x27\x2barr[i].minLength,\n                    msg: arr[i].lenMsg ||\x27字段长度范围错误\x27\n                })\n            }\n            \/\/如果有最大长度校验\n            if(arr[i].maxLength){\n                _single.rules.push({\n                    rule: \x27maxLength:\x27\x2barr[i].maxLength,\n                    msg: arr[i].lenMsg ||\x27字段长度范围错误\x27\n                })\n            }\n            \/\/如果有规则校验\n            \/\/校验转换规则\n            let _ruleData={\n                mobile:\x27isMobile\x27\n            }\n            if(arr[i].rule){\n                _single.rules.push({\n                    rule: _ruleData[arr[i].rule],\n                    msg: arr[i].msg ||\x27字段格式错误\x27\n                })\n            }\n            _param.push(_single);\n        }\n        let _result=validate.check(_param);\n        return _result?_result:false;\n    }\n    let testData={\n        phone:\x2718819323632\x27,\n        pwd:\x27112\x27\n    }\n    let _tips = validateForm([\n        {el: testData.phone, noNull: true, nullMsg: \x27电话号码不能为空\x27,rule: \x26quot;mobile\x26quot;, msg: \x27电话号码格式错误\x27},\n        {el: testData.pwd, noNull: true, nullMsg: \x27密码不能为空\x27,lenMsg:\x27密码长度不正确\x27,minLength:6,maxLength:18}\n    ]);\n    console.log(_tips)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs sqf\x22\x3e\x3ccode\x3e    let validateForm=function (arr) {\n        let \x3cspan class=\x22hljs-variable\x22\x3e_param\x3c\/span\x3e=[],\x3cspan class=\x22hljs-variable\x22\x3e_single\x3c\/span\x3e={};\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(let i=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;i\x26lt;arr.length;i\x2b\x2b){\n            \x3cspan class=\x22hljs-variable\x22\x3e_single\x3c\/span\x3e={};\n            \x3cspan class=\x22hljs-variable\x22\x3e_single\x3c\/span\x3e.el=arr[i].el;\n            \x3cspan class=\x22hljs-variable\x22\x3e_single\x3c\/span\x3e.rules=[];\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/如有有非空检验\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(arr[i].noNull){\n                \x3cspan class=\x22hljs-variable\x22\x3e_single\x3c\/span\x3e.rules.push({\n                    rule: \x3cspan class=\x22hljs-string\x22\x3e\x27isNoNull\x27\x3c\/span\x3e,\n                    msg: arr[i].nullMsg||\x3cspan class=\x22hljs-string\x22\x3e\x27字段不能为空\x27\x3c\/span\x3e\n                })\n            }\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果有最小长度校验\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(arr[i].minLength){\n                \x3cspan class=\x22hljs-variable\x22\x3e_single\x3c\/span\x3e.rules.push({\n                    rule: \x3cspan class=\x22hljs-string\x22\x3e\x27minLength:\x27\x3c\/span\x3e\x2barr[i].minLength,\n                    msg: arr[i].lenMsg ||\x3cspan class=\x22hljs-string\x22\x3e\x27字段长度范围错误\x27\x3c\/span\x3e\n                })\n            }\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果有最大长度校验\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(arr[i].maxLength){\n                \x3cspan class=\x22hljs-variable\x22\x3e_single\x3c\/span\x3e.rules.push({\n                    rule: \x3cspan class=\x22hljs-string\x22\x3e\x27maxLength:\x27\x3c\/span\x3e\x2barr[i].maxLength,\n                    msg: arr[i].lenMsg ||\x3cspan class=\x22hljs-string\x22\x3e\x27字段长度范围错误\x27\x3c\/span\x3e\n                })\n            }\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果有规则校验\x3c\/span\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/校验转换规则\x3c\/span\x3e\n            let \x3cspan class=\x22hljs-variable\x22\x3e_ruleData\x3c\/span\x3e={\n                mobile:\x3cspan class=\x22hljs-string\x22\x3e\x27isMobile\x27\x3c\/span\x3e\n            }\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(arr[i].rule){\n                \x3cspan class=\x22hljs-variable\x22\x3e_single\x3c\/span\x3e.rules.push({\n                    rule: \x3cspan class=\x22hljs-variable\x22\x3e_ruleData\x3c\/span\x3e[arr[i].rule],\n                    msg: arr[i].msg ||\x3cspan class=\x22hljs-string\x22\x3e\x27字段格式错误\x27\x3c\/span\x3e\n                })\n            }\n            \x3cspan class=\x22hljs-variable\x22\x3e_param\x3c\/span\x3e.push(\x3cspan class=\x22hljs-variable\x22\x3e_single\x3c\/span\x3e);\n        }\n        let \x3cspan class=\x22hljs-variable\x22\x3e_result\x3c\/span\x3e=validate.check(\x3cspan class=\x22hljs-variable\x22\x3e_param\x3c\/span\x3e);\n        return \x3cspan class=\x22hljs-variable\x22\x3e_result\x3c\/span\x3e?\x3cspan class=\x22hljs-variable\x22\x3e_result\x3c\/span\x3e:\x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n    }\n    let testData={\n        phone:\x3cspan class=\x22hljs-string\x22\x3e\x2718819323632\x27\x3c\/span\x3e,\n        pwd:\x3cspan class=\x22hljs-string\x22\x3e\x27112\x27\x3c\/span\x3e\n    }\n    let \x3cspan class=\x22hljs-variable\x22\x3e_tips\x3c\/span\x3e = validateForm([\n        {el: testData.phone, noNull: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, nullMsg: \x3cspan class=\x22hljs-string\x22\x3e\x27电话号码不能为空\x27\x3c\/span\x3e,rule: \x3cspan class=\x22hljs-string\x22\x3e\x22mobile\x22\x3c\/span\x3e, msg: \x3cspan class=\x22hljs-string\x22\x3e\x27电话号码格式错误\x27\x3c\/span\x3e},\n        {el: testData.pwd, noNull: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, nullMsg: \x3cspan class=\x22hljs-string\x22\x3e\x27密码不能为空\x27\x3c\/span\x3e,lenMsg:\x3cspan class=\x22hljs-string\x22\x3e\x27密码长度不正确\x27\x3c\/span\x3e,minLength:\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e,maxLength:\x3cspan class=\x22hljs-number\x22\x3e18\x3c\/span\x3e}\n    ]);\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-variable\x22\x3e_tips\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e4.小结\x3c\/h2\x3e\n\x3cp\x3e今天的例子就到这里了，这个例子，无非就是给API增加扩展性。这个例子比较简单，不算难。大家用这个代码在浏览器上运行，就很好理解。如果大家对这个例子有什么更好的建议，或者代码上有什么问题，欢迎在评论区留言，大家多交流，相互学习。\x3c\/p\x3e\n\x3cp\x3e-------------------------华丽的分割线--------------------\x3c\/p\x3e\n\x3cp\x3e想了解更多，关注关注我的微信公众号：守候书阁\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV1Cv6?w=258\x26amp;h=258\x22 src=\x22https:\/\/static.alili.tech\/img\/bV1Cv6?w=258\x26amp;h=258\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>重构 - 设计API的扩展机制</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000014751582">https://segmentfault.com/a/1190000014751582</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/3ixizua869w/" target="_blank">https://alili.tech/archive/3ixizua869w/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>