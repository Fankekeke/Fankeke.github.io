<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="【30分钟学完】canvas动画|游戏基础(5)：重力加速度与模拟摩擦力"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>【30分钟学完】canvas动画|游戏基础(5)：重力加速度与模拟摩擦力 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/42ml7q7htu6/",
				"appid": "1613049289050283", 
				"title": "【30分钟学完】canvas动画|游戏基础(5)：重力加速度与模拟摩擦力 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-08T02:30:30"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/06gjuq492k49/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/dg954lcn8rg/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f42ml7q7htu6%2f&text=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%285%29%ef%bc%9a%e9%87%8d%e5%8a%9b%e5%8a%a0%e9%80%9f%e5%ba%a6%e4%b8%8e%e6%a8%a1%e6%8b%9f%e6%91%a9%e6%93%a6%e5%8a%9b"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f42ml7q7htu6%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f42ml7q7htu6%2f&text=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%285%29%ef%bc%9a%e9%87%8d%e5%8a%9b%e5%8a%a0%e9%80%9f%e5%ba%a6%e4%b8%8e%e6%a8%a1%e6%8b%9f%e6%91%a9%e6%93%a6%e5%8a%9b"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f42ml7q7htu6%2f&title=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%285%29%ef%bc%9a%e9%87%8d%e5%8a%9b%e5%8a%a0%e9%80%9f%e5%ba%a6%e4%b8%8e%e6%a8%a1%e6%8b%9f%e6%91%a9%e6%93%a6%e5%8a%9b"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f42ml7q7htu6%2f&is_video=false&description=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%285%29%ef%bc%9a%e9%87%8d%e5%8a%9b%e5%8a%a0%e9%80%9f%e5%ba%a6%e4%b8%8e%e6%a8%a1%e6%8b%9f%e6%91%a9%e6%93%a6%e5%8a%9b"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%285%29%ef%bc%9a%e9%87%8d%e5%8a%9b%e5%8a%a0%e9%80%9f%e5%ba%a6%e4%b8%8e%e6%a8%a1%e6%8b%9f%e6%91%a9%e6%93%a6%e5%8a%9b&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f42ml7q7htu6%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f42ml7q7htu6%2f&title=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%285%29%ef%bc%9a%e9%87%8d%e5%8a%9b%e5%8a%a0%e9%80%9f%e5%ba%a6%e4%b8%8e%e6%a8%a1%e6%8b%9f%e6%91%a9%e6%93%a6%e5%8a%9b"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f42ml7q7htu6%2f&title=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%285%29%ef%bc%9a%e9%87%8d%e5%8a%9b%e5%8a%a0%e9%80%9f%e5%ba%a6%e4%b8%8e%e6%a8%a1%e6%8b%9f%e6%91%a9%e6%93%a6%e5%8a%9b"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f42ml7q7htu6%2f&title=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%285%29%ef%bc%9a%e9%87%8d%e5%8a%9b%e5%8a%a0%e9%80%9f%e5%ba%a6%e4%b8%8e%e6%a8%a1%e6%8b%9f%e6%91%a9%e6%93%a6%e5%8a%9b"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f42ml7q7htu6%2f&title=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%285%29%ef%bc%9a%e9%87%8d%e5%8a%9b%e5%8a%a0%e9%80%9f%e5%ba%a6%e4%b8%8e%e6%a8%a1%e6%8b%9f%e6%91%a9%e6%93%a6%e5%8a%9b"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">【30分钟学完】canvas动画|游戏基础(5)：重力加速度与模拟摩擦力</h1><div class="meta"><div class="postdate"><time datetime="2018-12-08" itemprop="datePublished">2018-12-08</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e前言\x3c\/h2\x3e\n\x3cp\x3e解决运动和碰撞问题后，我们为了让运动环境更加自然，需要加入一些环境因子，比如常见的重力加速度和模拟摩擦力。  \x3cbr\x3e阅读本篇前请先打好前面的基础。  \x3cbr\x3e本人能力有限，欢迎牛人共同讨论，批评指正。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e重力加速度\x3c\/h2\x3e\n\x3cblockquote\x3e【科普】重力加速度是一个物体受重力作用的情况下所具有的加速度。也叫自由落体加速度，用g表示。方向竖直向下。通常指地面附近物体受地球引力作用在真空中下落的加速度，记为g。为了便于计算，其近似标准值通常取为980厘米\/秒的二次方或9.8米\/秒的二次方。\x3c\/blockquote\x3e\n\x3cp\x3e真实的物体是有质量的，所以其重力加速度是由于重力产生，而我们计算机中的抽象物体并没有质量，所有也不存在重力一说，我们这里说的重力加速度只是借用了物理上的概念，实际上是人为定义的一个\x3cstrong\x3e方向指向y轴正半轴的加速度\x3c\/strong\x3e。  \x3cbr\x3e其实实现起来很简单，就是设定一个为正的加速度，每次绘制都加到物体的y轴速度上。  \x3cbr\x3e下面的示例是一个ball，它会受重力加速度gravity而自动下落，你可以使用键盘的上、下、左、右改变其四个方向上的加速度。核心代码如下：  \x3cbr\x3e完整示例：\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part4\/09-gravity.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e重力加速度演示\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22(function drawFrame() {\n  window.requestAnimationFrame(drawFrame, canvas);\n  context.clearRect(0, 0, canvas.width, canvas.height);\n\n  vx \x2b= ax;\n  vy \x2b= ay;\n  vy \x2b= gravity;\n  ball.x \x2b= vx;\n  ball.y \x2b= vy;\n  ball.draw(context);\n}());\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs mipsasm\x22\x3e\x3ccode class=\x22javascipt\x22\x3e(function drawFrame() {\n  window.requestAnimationFrame(drawFrame, canvas)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3econtext\x3c\/span\x3e.clearRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, canvas.width, canvas.height)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n\n  vx \x2b= ax\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n  vy \x2b= ay\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n  vy \x2b= gravity\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eball.x \x3c\/span\x3e\x2b= vx\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eball.y \x3c\/span\x3e\x2b= vy\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eball.draw(context);\n\x3c\/span\x3e}())\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e模拟摩擦力\x3c\/h2\x3e\n\x3cblockquote\x3e【科普】阻碍物体相对运动（或相对运动趋势）的力叫做摩擦力。摩擦力的方向与物体相对运动（或相对运动趋势）的方向相反。一个物体在另一个物体表面发生滑动时，接触面间产生阻碍它们相对运动的摩擦，称为滑动摩擦。滑动摩擦力的大小与接触面的粗糙程度的大小和压力大小有关。压力越大，物体接触面越粗糙，产生的滑动摩擦力就越大。\x3c\/blockquote\x3e\n\x3cp\x3e之前的例子中有一些非常不自然的场景，比如\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part4\/04-follow-mouse.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e跟随鼠标的箭头\x3c\/a\x3e，由于加速度始终存在，导致运动永远不可能停止，而在现实中（太空例外），由于存在各种摩擦力的关系，这是不可能发生的情况。  \x3cbr\x3e计算机中没有摩擦力，我们只是借鉴物理中的概念模拟一个\x3cstrong\x3e模拟摩擦力\x3c\/strong\x3e，请记住这个并不是物理意义的力。\x3c\/p\x3e\n\x3cblockquote\x3e【定义】模拟摩擦力是人为规定的值，定义和滑动摩擦力相似都与运动方向相反的量，将物体速度削减到0为止，不会改变运动方向。\x3c\/blockquote\x3e\n\x3cp\x3e注意：根据定义只能将物体的速率减去与一定大小的值，而不能分别在x, y轴上减小速度向量。如果物体正沿着某个角度运动，就会出现物体在某条轴的速度降为零，而继续在另一条轴上运动的奇怪现象。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e正确做法\x3c\/h3\x3e\n\x3cp\x3e我们将模拟摩擦力用变量friction表示，示例会演示随机速度的ball从运动到停止的过程，核心代码如下，基本思路：\x3c\/p\x3e\n\x3cblockquote\x3e【科普】速度和速率是两个不同的概念。速度是矢量，具有大小和方向；速率则纯粹指物体运动的快慢，是标量，没有方向。\x3c\/blockquote\x3e\n\x3col\x3e\n\x3cli\x3e将vx与vy平方后求和，再开方求出速率；通过计算Math.atan2(vy, vx)获得角度；\x3c\/li\x3e\n\x3cli\x3e从速率减去模拟摩擦力，但不要让速率变为负数；\x3c\/li\x3e\n\x3cli\x3e通过正余弦函数将和速率分解为x轴和y轴上的速度。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e完整示例：\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part5\/06-friction-1.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e模拟摩擦力正确计算\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22(function drawFrame() {\n  window.requestAnimationFrame(drawFrame, canvas);\n  context.clearRect(0, 0, canvas.width, canvas.height);\n  \/\/ 先求速率\n  let speed = Math.sqrt(vx ** 2 \x2b vy ** 2);\n  \/\/ 算出角度\n  const angle = Math.atan2(vy, vx);\n  \/\/ 判断运动是否停止\n  if (speed \x3e friction) {\n    \/\/ 没有停止则减去模拟摩擦力\n    speed -= friction;\n  } else {\n    speed = 0;\n  }\n  \/\/ 重新分解为x轴和y轴上的速度\n  vx = Math.cos(angle) * speed;\n  vy = Math.sin(angle) * speed;\n  ball.x \x2b= vx;\n  ball.y \x2b= vy;\n  ball.draw(context);\n}());\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edrawFrame\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.requestAnimationFrame(drawFrame, canvas);\n  context.clearRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, canvas.width, canvas.height);\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 先求速率\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e speed = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sqrt(vx ** \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x2b vy ** \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 算出角度\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e angle = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.atan2(vy, vx);\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 判断运动是否停止\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (speed \x26gt; friction) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 没有停止则减去模拟摩擦力\x3c\/span\x3e\n    speed -= friction;\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    speed = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n  }\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 重新分解为x轴和y轴上的速度\x3c\/span\x3e\n  vx = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.cos(angle) * speed;\n  vy = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sin(angle) * speed;\n  ball.x \x2b= vx;\n  ball.y \x2b= vy;\n  ball.draw(context);\n}());\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e简便做法\x3c\/h3\x3e\n\x3cp\x3e正确的做法十分繁琐，是个合成分解再合成的过程，这样对计算资源的消耗是比较大的，但我们也许并不需要这么精确的做法，只要每次将各个方向的速度乘以一个0~1之间的数就能简单模拟出摩擦力的效果。因此我们定义了\x3cstrong\x3e模拟摩擦力系数\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cblockquote\x3e【定义】模拟摩擦力系数是人为规定的值，会在物体运动时不断比例减少各个方向上的速度，使各个方向的速度无限接近于0。\x3c\/blockquote\x3e\n\x3cp\x3e示例由上面的正确做法改造而来，friction被定义为模拟摩擦力系数，指为0.9，只要运动都将x轴和y轴方向的速度乘以这个值即可，减少了大量操作。核心代码如下：  \x3cbr\x3e完整示例：\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part5\/06-friction-1.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e模拟摩擦力正确计算\x3c\/a\x3e  \x3cbr\x3e注意：这里有一个细节，速度不断乘以系数会导致速度\x3cstrong\x3e无限接近但不等于0\x3c\/strong\x3e，为了避免做无意义的计算，可以先判断速度是否已经小到肉眼不可见的值，以提高性能。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22(function drawFrame() {\n  window.requestAnimationFrame(drawFrame, canvas);\n  context.clearRect(0, 0, canvas.width, canvas.height);\n  \/\/ 判断速度大小以减少不必要的计算\n  if (Math.abs(vx) \x3e 0.001) {\n    \/\/ 减少速度\n    vx *= friction;\n    ball.x \x2b= vx;\n  }\n  if (Math.abs(vy) \x3e 0.001) {\n    vy *= friction;\n    ball.y \x2b= vy;\n  }\n  ball.draw(context);\n}());\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edrawFrame\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.requestAnimationFrame(drawFrame, canvas);\n  context.clearRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, canvas.width, canvas.height);\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 判断速度大小以减少不必要的计算\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(vx) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0.001\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 减少速度\x3c\/span\x3e\n    vx *= friction;\n    ball.x \x2b= vx;\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(vy) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0.001\x3c\/span\x3e) {\n    vy *= friction;\n    ball.y \x2b= vy;\n  }\n  ball.draw(context);\n}());\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e回顾前面的示例\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part5\/02-fountain.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e彩色喷泉\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part7\/08-spring-4.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e往鼠标方向弹动的箭头\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>【30分钟学完】canvas动画|游戏基础(5)：重力加速度与模拟摩擦力</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000014019499">https://segmentfault.com/a/1190000014019499</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/42ml7q7htu6/" target="_blank">https://alili.tech/archive/42ml7q7htu6/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>