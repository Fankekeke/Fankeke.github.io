<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="PokemonGo：LBS游戏开发"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>PokemonGo：LBS游戏开发 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/46rkn7ff46/",
				"appid": "1613049289050283", 
				"title": "PokemonGo：LBS游戏开发 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-04T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/2eo5c30hcgm/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/4i8dhp48uv/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f46rkn7ff46%2f&text=PokemonGo%ef%bc%9aLBS%e6%b8%b8%e6%88%8f%e5%bc%80%e5%8f%91"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f46rkn7ff46%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f46rkn7ff46%2f&text=PokemonGo%ef%bc%9aLBS%e6%b8%b8%e6%88%8f%e5%bc%80%e5%8f%91"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f46rkn7ff46%2f&title=PokemonGo%ef%bc%9aLBS%e6%b8%b8%e6%88%8f%e5%bc%80%e5%8f%91"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f46rkn7ff46%2f&is_video=false&description=PokemonGo%ef%bc%9aLBS%e6%b8%b8%e6%88%8f%e5%bc%80%e5%8f%91"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=PokemonGo%ef%bc%9aLBS%e6%b8%b8%e6%88%8f%e5%bc%80%e5%8f%91&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f46rkn7ff46%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f46rkn7ff46%2f&title=PokemonGo%ef%bc%9aLBS%e6%b8%b8%e6%88%8f%e5%bc%80%e5%8f%91"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f46rkn7ff46%2f&title=PokemonGo%ef%bc%9aLBS%e6%b8%b8%e6%88%8f%e5%bc%80%e5%8f%91"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f46rkn7ff46%2f&title=PokemonGo%ef%bc%9aLBS%e6%b8%b8%e6%88%8f%e5%bc%80%e5%8f%91"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f46rkn7ff46%2f&title=PokemonGo%ef%bc%9aLBS%e6%b8%b8%e6%88%8f%e5%bc%80%e5%8f%91"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">PokemonGo：LBS游戏开发</h1><div class="meta"><div class="postdate"><time datetime="2019-01-04" itemprop="datePublished">2019-01-04</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e写在前面\x3c\/h2\x3e\n\x3cblockquote\x3e\x3cp\x3e去吧！皮卡丘！\x3cbr\x3e小时候拥有一台任天堂是多少熊孩子的梦想，每个夜晚被窝里透出的微弱光线，把小小的童年带入另一个世界，家门口的鸟和狗，森林里的虫和瀑布，山洞里的超音蝠，带着小小的梦，走过一个个城市，一路冒险，飞天潜水，攀瀑碎岩，所向披靡。\x3cbr\x3e每个醒来的清晨，都恍如出门冒险的那天~\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e要做什么\x3c\/h2\x3e\n\x3cp\x3e基于开放地图二次开发，完成简易像素版PokemonGo\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010687878\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010687878\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e准备工作\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e一、确定功能需求\x3c\/h3\x3e\n\x3ch4\x3e第一阶段\x3c\/h4\x3e\n\x3cp\x3e1、用户体系\x3cbr\x3e2、背包\x3cbr\x3e3、图鉴\x3cbr\x3e4、人物定位\x3cbr\x3e5、精灵分布\x3cbr\x3e6、精灵捕捉\x3cbr\x3e7、排行榜\x3cbr\x3e8、移动随机事件\x3cbr\x3e9、新手引导\x3c\/p\x3e\n\x3ch4\x3e第二阶段\x3c\/h4\x3e\n\x3cp\x3e1、地图增加道馆挑战\x3cbr\x3e2、日常任务系统\x3c\/p\x3e\n\x3ch4\x3e第三阶段\x3c\/h4\x3e\n\x3cp\x3e1、精灵交易\x3cbr\x3e2、玩家对战\x3cbr\x3e3、AR捕捉场景\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22*目前只完成第一阶段的功能   \n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stata\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e*目前只完成第一阶段的功能   \x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e二、开放地图选择\x3c\/h3\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth\x3e功能 \/ 厂商\x3c\/th\x3e\n\x3cth\x3e百度地图\x3c\/th\x3e\n\x3cth\x3e腾讯地图\x3c\/th\x3e\n\x3cth\x3e高德地图\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd\x3e自定义皮肤\x3c\/td\x3e\n\x3ctd\x3e支持\x3c\/td\x3e\n\x3ctd\x3e不支持\x3c\/td\x3e\n\x3ctd\x3e支持\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e实时定位\x3c\/td\x3e\n\x3ctd\x3e不支持\x3c\/td\x3e\n\x3ctd\x3e支持\x3c\/td\x3e\n\x3ctd\x3e支持\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e开发文档\x3c\/td\x3e\n\x3ctd\x3e差\x3c\/td\x3e\n\x3ctd\x3e一般\x3c\/td\x3e\n\x3ctd\x3e友好\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3cp\x3e对比三个地图厂商，我们选择高德地图进行二次开发\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e三、申请高德地图SDK\x3c\/h3\x3e\n\x3cp\x3e登录\x3ca href=\x22http:\/\/lbs.amap.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/lbs.amap.com\/\x3c\/a\x3e\x3cbr\x3e控制台-应用管理-创建新应用-添加新KEY\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e四、接入微信授权\x3c\/h3\x3e\n\x3cp\x3e具体参考微信公众平台开发者文档\x3cbr\x3e\x3ca href=\x22https:\/\/mp.weixin.qq.com\/wiki?t=resource\/res_main\x26amp;id=mp1421140842\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/mp.weixin.qq.com\/wiki...\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e五、服务端接口\x3c\/h3\x3e\n\x3cp\x3e我们需要一些接口来保存用户数据，所以需要找一个服务端的同学配合完成几个简单的接口\x3cbr\x3e1、api\/login 判断登录状态，获取用户基本信息\x3cbr\x3e2、api\/getGlassPokemon 获取草地精灵\x3cbr\x3e3、api\/getMyPokemon 获取背包精灵\x3cbr\x3e4、api\/catchPokemon 捕捉精灵\x3cbr\x3e5、api\/getRank 获取排行榜信息\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e六、素材准备\x3c\/h3\x3e\n\x3cp\x3e1、简单设计主界面UI，确定功能布局、地图的配色方案：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671761\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671761\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e2、准备150只精灵的素材图片（大小各一套）\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671762\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671762\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671763\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671763\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e现在开始\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e一、接入高德地图\x3c\/h3\x3e\n\x3cp\x3e在\x3ccode\x3e\x26lt;head\x26gt;\x26lt;\/head\x26gt;\x3c\/code\x3e中引入高德地图js-sdk\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3chead\x3e\n    \x3cscript src=\x26quot;http:\/\/webapi.amap.com\/maps?v=1.3\x26amp;key=464e2c3addc64c5894994afe0bbdca21\x26quot;\x3e\n\x3c\/head\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/webapi.amap.com\/maps?v=1.3\x26amp;key=464e2c3addc64c5894994afe0bbdca21\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22handlebars\x22\x3e\x3cspan class=\x22xml\x22\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3ekey的值为高德地图开发者中心创建应用后获得的key\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e在html中创建地图容器\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv id=\x26quot;gomap\x26quot;\x3e\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs applescript\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22gomap\x22\x3c\/span\x3e\x26gt;\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在js中初始化地图\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var gomap;\ngomap = new AMap.Map(\x27gomap\x27, {\n    zoomEnable : false,              \/\/不允许缩放\n    zoom:18,                         \/\/默认缩放等级18\n    center: [118.18088, 24.4896],    \/\/初始定位坐标\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dart\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e gomap;\ngomap = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e AMap.\x3cspan class=\x22hljs-built_in\x22\x3eMap\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27gomap\x27\x3c\/span\x3e, {\n    zoomEnable : \x3cspan class=\x22hljs-keyword\x22\x3efalse\x3c\/span\x3e,              \x3cspan class=\x22hljs-comment\x22\x3e\/\/不允许缩放\x3c\/span\x3e\n    zoom:\x3cspan class=\x22hljs-number\x22\x3e18\x3c\/span\x3e,                         \x3cspan class=\x22hljs-comment\x22\x3e\/\/默认缩放等级18\x3c\/span\x3e\n    center: [\x3cspan class=\x22hljs-number\x22\x3e118.18088\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e24.4896\x3c\/span\x3e],    \x3cspan class=\x22hljs-comment\x22\x3e\/\/初始定位坐标\x3c\/span\x3e\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.guowc.cc\/go\/demo1.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e查看DEMO\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671764\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671764\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e二、地图美化\x3c\/h3\x3e\n\x3cp\x3e默认的地图样式不能满足我们的需求，高德地图提供了地图皮肤编辑器：\x3ca href=\x22http:\/\/lbs.amap.com\/dev\/mapstyle\/index\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e高德地图皮肤编辑器\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671765\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671765\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e在编辑器中修改道路，陆地，建筑，水域，绿地等颜色，同时在配置中隐藏了一些道路、建筑与标记，简化地图。\x3cbr\x3e编辑完成后点击发布，获得地图样式ID：e6fa21422698f8a28585158d9d075f1d\x3cbr\x3e在地图初始化中引入地图样式即可\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var gomap;\ngomap = new AMap.Map(\x27gomap\x27, {\n    zoomEnable : false,\n    zoom:18,\n    center: [118.18088, 24.4896],\n    mapStyle : \x27amap:\/\/styles\/e6fa21422698f8a28585158d9d075f1d\x27\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dart\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e gomap;\ngomap = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e AMap.\x3cspan class=\x22hljs-built_in\x22\x3eMap\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27gomap\x27\x3c\/span\x3e, {\n    zoomEnable : \x3cspan class=\x22hljs-keyword\x22\x3efalse\x3c\/span\x3e,\n    zoom:\x3cspan class=\x22hljs-number\x22\x3e18\x3c\/span\x3e,\n    center: [\x3cspan class=\x22hljs-number\x22\x3e118.18088\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e24.4896\x3c\/span\x3e],\n    mapStyle : \x3cspan class=\x22hljs-string\x22\x3e\x27amap:\/\/styles\/e6fa21422698f8a28585158d9d075f1d\x27\x3c\/span\x3e\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.guowc.cc\/go\/demo2.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e查看DEMO\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671766\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671766\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e这样看起来就有点游戏的样子了\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e三、地图定位\x3c\/h3\x3e\n\x3cp\x3e我们需要把地图和主角定位在当前位置，并且在移动时实时更新定位，这就需要借助AMap的geolocation插件\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22gomap.plugin(\x27AMap.Geolocation\x27,function(){\n    var geo = new AMap.Geolocation({\n        showButton: false,\n        showCircle: false,\n        showMarker : true,               \/\/显示定位图标\n        markerOptions : {\n            content : \x27\x3cdiv class=\x26quot;Symbol hero\x26quot;\x3e\x3c\/div\x3e\x27, \/\/设置marker自定义节点内容\n        }\n    });\n    gomap.addControl(geo);\n    geo.watchPosition();        \/\/实时获取定位\n    AMap.event.addListener(geolocation, \x27complete\x27, onComplete);\/\/返回定位成功信息\n    AMap.event.addListener(geolocation, \x27error\x27, onError);      \/\/返回定位出错信息\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3egomap.plugin(\x3cspan class=\x22hljs-string\x22\x3e\x27AMap.Geolocation\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e geo = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e AMap.Geolocation({\n        showButton: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n        showCircle: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n        showMarker : \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,               \x3cspan class=\x22hljs-comment\x22\x3e\/\/显示定位图标\x3c\/span\x3e\n        markerOptions : {\n            content : \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div class=\x22Symbol hero\x22\x26gt;\x26lt;\/div\x26gt;\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/设置marker自定义节点内容\x3c\/span\x3e\n        }\n    });\n    gomap.addControl(geo);\n    geo.watchPosition();        \x3cspan class=\x22hljs-comment\x22\x3e\/\/实时获取定位\x3c\/span\x3e\n    AMap.event.addListener(geolocation, \x3cspan class=\x22hljs-string\x22\x3e\x27complete\x27\x3c\/span\x3e, onComplete);\x3cspan class=\x22hljs-comment\x22\x3e\/\/返回定位成功信息\x3c\/span\x3e\n    AMap.event.addListener(geolocation, \x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e, onError);      \x3cspan class=\x22hljs-comment\x22\x3e\/\/返回定位出错信息\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671767\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671767\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e小智一个人站在地图上有点孤单，我们给他加一个光环放大的效果，看起来像是在发出检测信号：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22.Symbol.hero:after{\n    -webkit-animation:heroWave 2s ease infinite;\n    background:rgba(255,255,181,0.1);\n    content:\x27\x27;\n    width:100px;\n    height:100px;\n    display:block;\n    position:absolute;\n    left:-30px;\n    top:-30px;\n    border-radius:100%;\n    box-shadow:0 0 0 1px rgba(255,255,181,0.7);\n    opacity:0.7;\n}\n@-webkit-keyframes heroWave{\n    0%{ -webkit-transform:scale(0.2);opacity:0}\n    50%{ opacity:1}\n    100%{ -webkit-transform:scale(1);opacity:0}\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.Symbol\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.hero\x3c\/span\x3e\x3cspan class=\x22hljs-selector-pseudo\x22\x3e:after\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-attribute\x22\x3e-webkit-animation\x3c\/span\x3e:heroWave \x3cspan class=\x22hljs-number\x22\x3e2s\x3c\/span\x3e ease infinite;\n    \x3cspan class=\x22hljs-attribute\x22\x3ebackground\x3c\/span\x3e:\x3cspan class=\x22hljs-built_in\x22\x3ergba\x3c\/span\x3e(255,255,181,0.1);\n    \x3cspan class=\x22hljs-attribute\x22\x3econtent\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attribute\x22\x3ewidth\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e100px\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attribute\x22\x3eheight\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e100px\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attribute\x22\x3edisplay\x3c\/span\x3e:block;\n    \x3cspan class=\x22hljs-attribute\x22\x3eposition\x3c\/span\x3e:absolute;\n    \x3cspan class=\x22hljs-attribute\x22\x3eleft\x3c\/span\x3e:-\x3cspan class=\x22hljs-number\x22\x3e30px\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attribute\x22\x3etop\x3c\/span\x3e:-\x3cspan class=\x22hljs-number\x22\x3e30px\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attribute\x22\x3eborder-radius\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e100%\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attribute\x22\x3ebox-shadow\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1px\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ergba\x3c\/span\x3e(255,255,181,0.7);\n    \x3cspan class=\x22hljs-attribute\x22\x3eopacity\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e0.7\x3c\/span\x3e;\n}\n@-\x3cspan class=\x22hljs-keyword\x22\x3ewebkit\x3c\/span\x3e-\x3cspan class=\x22hljs-keyword\x22\x3ekeyframes\x3c\/span\x3e heroWave{\n    0%{ \x3cspan class=\x22hljs-attribute\x22\x3e-webkit-transform\x3c\/span\x3e:\x3cspan class=\x22hljs-built_in\x22\x3escale\x3c\/span\x3e(0.2);\x3cspan class=\x22hljs-attribute\x22\x3eopacity\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e}\n    50%{ \x3cspan class=\x22hljs-attribute\x22\x3eopacity\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e}\n    100%{ \x3cspan class=\x22hljs-attribute\x22\x3e-webkit-transform\x3c\/span\x3e:\x3cspan class=\x22hljs-built_in\x22\x3escale\x3c\/span\x3e(1);\x3cspan class=\x22hljs-attribute\x22\x3eopacity\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e}\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671768\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671768\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.guowc.cc\/go\/demo3.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e查看DEMO\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3e四、罗盘\x3c\/h3\x3e\n\x3cp\x3e有了定位，我们还需要知道自己移动的方向，方便接近目标，所以我们在界面右上角放置了一个虚拟罗盘\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671769\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671769\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e通过监听HTML5的deviceorientation获取指南针角度信息，改变罗盘旋转方向：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (window.DeviceOrientationEvent) {\n    window.addEventListener(\x26quot;deviceorientation\x26quot;, function(event){\n        var dir =  event.webkitCompassHeading;\n        $(\x26quot;#J_pin\x26quot;).css(\x26quot;-webkit-transform\x26quot;,\x27rotate(\x27\x2b (360-dir) \x2b\x27deg)\x27);\n    }, false);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.DeviceOrientationEvent) {\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x22deviceorientation\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e dir =  event.webkitCompassHeading;\n        $(\x3cspan class=\x22hljs-string\x22\x3e\x22#J_pin\x22\x3c\/span\x3e).css(\x3cspan class=\x22hljs-string\x22\x3e\x22-webkit-transform\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27rotate(\x27\x3c\/span\x3e\x2b (\x3cspan class=\x22hljs-number\x22\x3e360\x3c\/span\x3e-dir) \x2b\x3cspan class=\x22hljs-string\x22\x3e\x27deg)\x27\x3c\/span\x3e);\n    }, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.guowc.cc\/go\/demo4.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e查看DEMO\x3c\/a\x3e (罗盘只在移动端生效，扫码查看)\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671770\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671770\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader14\x22\x3e五、精灵数据\x3c\/h3\x3e\n\x3cp\x3e由于精灵的编号，属性，星级等数据是固定的，在前端创建一个保存精灵图鉴数据的JSON文件，以减少服务端返回数据的复杂度，通过编号在图鉴中索引对应精灵的相关数据\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var Pokedex = [\n    {\n        \x27number\x27:\x27001\x27,\n        \x27name\x27 :\x27妙蛙种子\x27,\n        \x27name_jp\x27 : \x27フシギダネ\x27,\n        \x27name_en\x27 : \x27Bulbasaur\x27,\n        \x27properties\x27 : [\x27草\x27,\x27毒\x27],\n        \x27star\x27 : 4,\n    },\n    {\n        \x27number\x27:\x27002\x27,\n        \x27name\x27 :\x27妙蛙草\x27,\n        \x27name_jp\x27 : \x27フシギソウ\x27,\n        \x27name_en\x27 : \x27Ivysaur\x27,\n        \x27properties\x27 : [\x27草\x27,\x27毒\x27],\n        \x27star\x27 : 4,\n    },\n    ...\n];\n\/\/精灵属性颜色配置\nvar Pokedexcolor = {\n    \x27草\x27 : \x27#1ba50e,#2ec920\x27,\n    \x27冰\x27 : \x27#13c6db,#57e9ff\x27,\n    \x27超能力\x27 :\x27#dd045b,#f7478d\x27,\n    \x27虫\x27 : \x27#889610,#b5b214\x27,\n    \x27地面\x27 : \x27#af8a19,#d8b343\x27,\n    \x27电\x27 : \x27#b28200,#ffd621\x27,\n    \x27毒\x27 : \x27#752464,#9e448c\x27,\n    \x27飞行\x27 : \x27#4381ff,#72aefc\x27,\n    \x27钢\x27 : \x27#6d6d8a,#aaaabb\x27,\n    \x27格斗\x27 : \x27#902918,#bb5544\x27,\n    \x27火\x27 : \x27#c72500,#f05526\x27,\n    \x27龙\x27 : \x27#2b1aa6,#7766ee\x27,\n    \x27水\x27 : \x27#2b1aa6,#3088e1\x27,\n    \x27岩石\x27 : \x27#907d2f,#a89755\x27,\n    \x27一般\x27 : \x27#969685,#bbbbaa\x27,\n    \x27幽灵\x27 : \x27#3d3d7c,#5f52a7\x27,\n    \x27妖精\x27 : \x27#3d3d7c,#5f52a7\x27,\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e Pokedex = [\n    {\n        \x3cspan class=\x22hljs-string\x22\x3e\x27number\x27\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x27001\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-string\x22\x3e\x27name\x27\x3c\/span\x3e :\x3cspan class=\x22hljs-string\x22\x3e\x27妙蛙种子\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-string\x22\x3e\x27name_jp\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27フシギダネ\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-string\x22\x3e\x27name_en\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27Bulbasaur\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-string\x22\x3e\x27properties\x27\x3c\/span\x3e : [\x3cspan class=\x22hljs-string\x22\x3e\x27草\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27毒\x27\x3c\/span\x3e],\n        \x3cspan class=\x22hljs-string\x22\x3e\x27star\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e,\n    },\n    {\n        \x3cspan class=\x22hljs-string\x22\x3e\x27number\x27\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x27002\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-string\x22\x3e\x27name\x27\x3c\/span\x3e :\x3cspan class=\x22hljs-string\x22\x3e\x27妙蛙草\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-string\x22\x3e\x27name_jp\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27フシギソウ\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-string\x22\x3e\x27name_en\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27Ivysaur\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-string\x22\x3e\x27properties\x27\x3c\/span\x3e : [\x3cspan class=\x22hljs-string\x22\x3e\x27草\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27毒\x27\x3c\/span\x3e],\n        \x3cspan class=\x22hljs-string\x22\x3e\x27star\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e,\n    },\n    ...\n];\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/精灵属性颜色配置\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e Pokedexcolor = {\n    \x3cspan class=\x22hljs-string\x22\x3e\x27草\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#1ba50e,#2ec920\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27冰\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#13c6db,#57e9ff\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27超能力\x27\x3c\/span\x3e :\x3cspan class=\x22hljs-string\x22\x3e\x27#dd045b,#f7478d\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27虫\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#889610,#b5b214\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27地面\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#af8a19,#d8b343\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27电\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#b28200,#ffd621\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27毒\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#752464,#9e448c\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27飞行\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#4381ff,#72aefc\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27钢\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#6d6d8a,#aaaabb\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27格斗\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#902918,#bb5544\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27火\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#c72500,#f05526\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27龙\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#2b1aa6,#7766ee\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27水\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#2b1aa6,#3088e1\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27岩石\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#907d2f,#a89755\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27一般\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#969685,#bbbbaa\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27幽灵\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#3d3d7c,#5f52a7\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27妖精\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27#3d3d7c,#5f52a7\x27\x3c\/span\x3e,\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader15\x22\x3e六、在地图上添加精灵\x3c\/h3\x3e\n\x3cp\x3e主角诞生了，现在开始在周围生成一些随机的精灵，调用getGlassPokemon接口，传递当前位置坐标，服务端在坐标半径1公里内生成一定个数的精灵，前端通过返回的坐标和精灵编号将对应精灵添加到地图上。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e由于后续接口需要验证微信授权信息，为了便于DEMO查看请先访问一次模拟登陆接口：\x3ca href=\x22http:\/\/www.guowc.cc\/api\/sysUser\/login?openid=o3aw6v1QLA6R7B0w6vPBfL9Ti8Mw\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3c\/a\x3e\x3ca href=\x22http:\/\/www.guowc.cc\/api\/sysUser\/login?openid=o3aw6v1QLA6R7B0w6vPBfL9Ti8Mw\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.guowc.cc\/api\/sysUs...\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e\x3ccode\x3egetGlassPokemon\x3c\/code\x3e接口返回数据格式：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22data : {\n    {\n        id : 231,     \/\/精灵唯一标识，用于捕捉成功后从数据库中精准删除地图对应精灵\n        number: \x26quot;77\x26quot;,          \/\/精灵编号，用于图鉴中获取更多精灵信息\n        lng : 118.094561807441    \/\/精灵经度\n        lat : 24.4805797983452    \/\/精灵纬度\n    },\n    ...\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attribute\x22\x3edata \x3c\/span\x3e: {\n    {\n        \x3cspan class=\x22hljs-attribute\x22\x3eid \x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e231\x3c\/span\x3e,     \x3cspan class=\x22hljs-comment\x22\x3e\/\/精灵唯一标识，用于捕捉成功后从数据库中精准删除地图对应精灵\x3c\/span\x3e\n        \x3cspan class=\x22hljs-attribute\x22\x3enumber\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2277\x22\x3c\/span\x3e,          \x3cspan class=\x22hljs-comment\x22\x3e\/\/精灵编号，用于图鉴中获取更多精灵信息\x3c\/span\x3e\n        \x3cspan class=\x22hljs-attribute\x22\x3elng \x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e118.094561807441\x3c\/span\x3e    \x3cspan class=\x22hljs-comment\x22\x3e\/\/精灵经度\x3c\/span\x3e\n        \x3cspan class=\x22hljs-attribute\x22\x3elat \x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e24.4805797983452\x3c\/span\x3e    \x3cspan class=\x22hljs-comment\x22\x3e\/\/精灵纬度\x3c\/span\x3e\n    },\n    ...\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e首先在前面的geolocation插件中调用\x3ccode\x3egetCurrentPosition()\x3c\/code\x3e方法，获取一次初始定位坐标，\x3cbr\x3e将坐标传给\x3ccode\x3egetPokemons\x3c\/code\x3e接口拉取草地精灵数据\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var self = this\ngomap.plugin(\x27AMap.Geolocation\x27,function(){\n    var geo = new AMap.Geolocation({\n        ...\n    });\n    ...\n    \/\/首次定位\n    geo.getCurrentPosition(function( status, result ){\n        heroPoint.lng = result.position.lng;\n        heroPoint.lat = result.position.lat;\n        self.getPokemon(heroPoint)\n    });\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eself\x3c\/span\x3e = this\ngomap.plugin(\x3cspan class=\x22hljs-string\x22\x3e\x27AMap.Geolocation\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e geo = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e AMap.Geolocation({\n        ...\n    });\n    ...\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/首次定位\x3c\/span\x3e\n    geo.getCurrentPosition(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e( status, result )\x3c\/span\x3e\x3c\/span\x3e{\n        heroPoint.lng = result.position.lng;\n        heroPoint.lat = result.position.lat;\n        \x3cspan class=\x22hljs-keyword\x22\x3eself\x3c\/span\x3e.getPokemon(heroPoint)\n    });\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e请求接口数据：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22getPokemon : function(point) {\n    var self = this\n    Method.fetch(Api.getGlassPokemons,{ lng:point.lng,lat:point.lat },function(data){\n        var res = data.data;\n        for(var i = 0; i \x3c res.length; i\x2b\x2b){\n            self.addPokemon(res[i]);\n        }\n    });\n},\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3egetPokemon : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(point)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eself\x3c\/span\x3e = this\n    Method.fetch(Api.getGlassPokemons,{ lng:point.lng,lat:point.lat },\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(data)\x3c\/span\x3e\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e res = data.data;\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; res.length; i\x2b\x2b){\n            \x3cspan class=\x22hljs-keyword\x22\x3eself\x3c\/span\x3e.addPokemon(res[i]);\n        }\n    });\n},\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3eMethod.fetch为封装的ajax方法，只贴出关键流程代码，具体详见DEMO\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e获取到数据后，循环调用addPokemon方法，将精灵添加到地图上：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22addPokemon : function(data) {\n    var pid = Method.getPid(data.number); \/\/获取精灵编号（格式化\x2712\x27=\x3e\x27012\x27）\n    var marker =  new AMap.Marker({\n        map: Common.gomap,\n        position: [data.position_x, data.position_y],\n        icon: new AMap.Icon({\n            size: new AMap.Size(40, 40),\n            imageSize : new AMap.Size(40, 40),\n            image: \x26quot;images\/pokemon\/PM_icon_\x26quot;\x2b pid \x2b\x26quot;.png\x26quot;,\n        }),\n    });\n},\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haskell\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-title\x22\x3eaddPokemon\x3c\/span\x3e : function(\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-title\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3epid\x3c\/span\x3e = \x3cspan class=\x22hljs-type\x22\x3eMethod\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3egetPid\x3c\/span\x3e(\x3cspan class=\x22hljs-title\x22\x3edata\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3enumber\x3c\/span\x3e); \/\/获取精灵编号（格式化\x2712\x27=\x26gt;\x27012\x27）\n    \x3cspan class=\x22hljs-title\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emarker\x3c\/span\x3e =  \x3cspan class=\x22hljs-title\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eAMap\x3c\/span\x3e.\x3cspan class=\x22hljs-type\x22\x3eMarker\x3c\/span\x3e({\n        \x3cspan class=\x22hljs-title\x22\x3emap\x3c\/span\x3e: \x3cspan class=\x22hljs-type\x22\x3eCommon\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3egomap\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-title\x22\x3eposition\x3c\/span\x3e: [\x3cspan class=\x22hljs-title\x22\x3edata\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3eposition_x\x3c\/span\x3e, \x3cspan class=\x22hljs-title\x22\x3edata\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3eposition_y\x3c\/span\x3e],\n        \x3cspan class=\x22hljs-title\x22\x3eicon\x3c\/span\x3e: \x3cspan class=\x22hljs-title\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eAMap\x3c\/span\x3e.\x3cspan class=\x22hljs-type\x22\x3eIcon\x3c\/span\x3e({\n            \x3cspan class=\x22hljs-title\x22\x3esize\x3c\/span\x3e: \x3cspan class=\x22hljs-title\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eAMap\x3c\/span\x3e.\x3cspan class=\x22hljs-type\x22\x3eSize\x3c\/span\x3e(40, 40),\n            \x3cspan class=\x22hljs-title\x22\x3eimageSize\x3c\/span\x3e : \x3cspan class=\x22hljs-title\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eAMap\x3c\/span\x3e.\x3cspan class=\x22hljs-type\x22\x3eSize\x3c\/span\x3e(40, 40),\n            \x3cspan class=\x22hljs-title\x22\x3eimage\x3c\/span\x3e: \x22\x3cspan class=\x22hljs-title\x22\x3eimages\x3c\/span\x3e\/\x3cspan class=\x22hljs-title\x22\x3epokemon\x3c\/span\x3e\/\x3cspan class=\x22hljs-type\x22\x3ePM_icon_\x3c\/span\x3e\x22\x2b \x3cspan class=\x22hljs-title\x22\x3epid\x3c\/span\x3e \x2b\x22.\x3cspan class=\x22hljs-title\x22\x3epng\x3c\/span\x3e\x22,\n        }),\x3c\/span\x3e\n    });\n},\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.guowc.cc\/go\/demo5.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e查看DEMO\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671771\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671771\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e现在我们就能在地图上看到精灵了～\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader16\x22\x3e七、获取背包精灵\x3c\/h3\x3e\n\x3cp\x3e这一步我们先把已捕捉到的精灵列表保存起来，以便后续使用：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22getMyPokemons : function(){\n    Method.fetch(API.getMyPokemons,{},function(data){\n        for(var i = 0 ;i \x3c data.data.length; i\x2b\x2b){\n            State.bag.push(Method.getPid(data.data[i].number));   \/\/将已获得精灵编号保存在全局State.bag数组中\n        }\n    });\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs fortran\x22\x3e\x3ccode\x3egetMyPokemons : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n    Method.fetch(API.getMyPokemons,{},\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(data)\x3c\/span\x3e\x3c\/span\x3e{\n        for(var i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e ;i \x26lt; \x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e.length; i\x2b\x2b){\n            State.bag.push(Method.getPid(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e[i].\x3cspan class=\x22hljs-keyword\x22\x3enumber\x3c\/span\x3e));   \/\/将已获得精灵编号保存在全局State.bag数组中\n        }\n    });\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader17\x22\x3e八、精灵收集\x3c\/h3\x3e\n\x3ch4\x3e操作优化\x3c\/h4\x3e\n\x3cp\x3e精灵收集是整个游戏的核心功能，原版pokemonGo精灵捕捉过程为AR实景捕捉形式，我们把精灵的捕捉形式简化了，保留街机时代的像素风格。最早在实现这个功能时，采用的策略是当玩家坐标与地图精灵小于一定距离时，自动进入精灵捕捉场景，这种方式存在几个问题：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e用户位置发生变化时，需要不断计算用户坐标与地图上所有精灵的距离，计算量较大\x3c\/li\x3e\n\x3cli\x3e可能存在同时与两个精灵距离符合捕捉条件，而一次只能捕捉一只精灵\x3c\/li\x3e\n\x3cli\x3e用户如果不移动，基本很难捕捉到精灵\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e经过优化，将捕捉规则修改为：直接点击地图精灵即可捕捉，半径500米外提示用户超过捕捉范围。\x3cbr\x3e优化后的方案降低了捕捉门槛，也鼓励用户走动去发现和捕捉更多精灵。\x3c\/p\x3e\n\x3ch4\x3e数据传递\x3c\/h4\x3e\n\x3cp\x3e上一步的addPokemon方法中，我们已经向地图中添加了精灵点标记（marker），但此时地图上的精灵唯一区分只是图片不同而已，我们还需为每个marker绑定对应的精灵信息，并为每个marker绑定点击事件，下面完善一下addPokemon方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22addPokemon : function(data) {\n    var self = this;\n    var nid = parseInt(data.number);\n    var pid = Method.getPid(data.number); \/\/获取精灵编号（格式化\x2712\x27=\x3e\x27012\x27）;\n    var id = data.id;\n    var marker =  new AMap.Marker({\n        map: Common.gomap,\n        position: [data.position_x, data.position_y],\n        icon: new AMap.Icon({\n            size: new AMap.Size(40, 40),\n            imageSize : new AMap.Size(40, 40),\n            image: \x26quot;images\/pokemon\/PM_icon_\x26quot;\x2b pid \x2b\x26quot;.png\x26quot;,\n        }),\n        extData : {\n            nid : nid,\n            id  : id,\n        }\n    });\n    marker.on(\x27click\x27,function(e){\n        self.clickPokemon(e)\n    })\n},\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attribute\x22\x3eaddPokemon\x3c\/span\x3e : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e self = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e nid = \x3cspan class=\x22hljs-built_in\x22\x3eparseInt\x3c\/span\x3e(data.number);\n    \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e pid = Method.getPid(data.number); \x3cspan class=\x22hljs-comment\x22\x3e\/\/获取精灵编号（格式化\x2712\x27=\x26gt;\x27012\x27）;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e id = data.id;\n    \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e marker =  \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e AMap.Marker({\n        \x3cspan class=\x22hljs-attribute\x22\x3emap\x3c\/span\x3e: Common.gomap,\n        \x3cspan class=\x22hljs-attribute\x22\x3eposition\x3c\/span\x3e: [data.position_x, data.position_y],\n        \x3cspan class=\x22hljs-attribute\x22\x3eicon\x3c\/span\x3e: \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e AMap.Icon({\n            \x3cspan class=\x22hljs-attribute\x22\x3esize\x3c\/span\x3e: \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e AMap.Size(\x3cspan class=\x22hljs-number\x22\x3e40\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e40\x3c\/span\x3e),\n            \x3cspan class=\x22hljs-attribute\x22\x3eimageSize\x3c\/span\x3e : \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e AMap.Size(\x3cspan class=\x22hljs-number\x22\x3e40\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e40\x3c\/span\x3e),\n            \x3cspan class=\x22hljs-attribute\x22\x3eimage\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22images\/pokemon\/PM_icon_\x22\x3c\/span\x3e\x2b pid \x2b\x3cspan class=\x22hljs-string\x22\x3e\x22.png\x22\x3c\/span\x3e,\n        }),\n        \x3cspan class=\x22hljs-attribute\x22\x3eextData\x3c\/span\x3e : {\n            \x3cspan class=\x22hljs-attribute\x22\x3enid\x3c\/span\x3e : nid,\n            \x3cspan class=\x22hljs-attribute\x22\x3eid  :\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e id\x3c\/span\x3e,\n        }\n    });\n    marker.on(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n        self.clickPokemon(e)\n    })\n},\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e由于地图上显示精灵图标过小，无法展示更多信息，所以点击精灵后，不直接进入战斗，先弹出对应精灵的卡牌：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22clickPokemon : function(e){\n    var self = this;\n    var data = e.target.getExtData();\n    self.initPokecard(data.nid,e.target);\n},\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs fortran\x22\x3e\x3ccode\x3eclickPokemon : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(e)\x3c\/span\x3e\x3c\/span\x3e{\n    var self = this;\n    var \x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e = e.\x3cspan class=\x22hljs-keyword\x22\x3etarget\x3c\/span\x3e.getExtData();\n    self.initPokecard(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e.nid,e.\x3cspan class=\x22hljs-keyword\x22\x3etarget\x3c\/span\x3e);\n},\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671772\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671772\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e初始化卡牌弹窗：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv class=\x26quot;Modal pokedex\x26quot; id=\x26quot;js-modal-pokedex\x26quot;\x3e\n    \x3cdiv class=\x26quot;card\x26quot;\x3e\n        \x3cdiv class=\x26quot;namebox\x26quot;\x3e\n            \x3cp class=\x26quot;name_cn\x26quot;\x3e\x3c\/p\x3e\n            \x3cp class=\x26quot;name_jp\x26quot;\x3e\x3c\/p\x3e\n        \x3c\/div\x3e\n        \x3cdiv class=\x26quot;pokebox\x26quot;\x3e\n            \x3cimg class=\x26quot;pokeimg\x26quot; src=\x26quot;\x26quot; alt=\x26quot;\x26quot;\x3e\n            \x3cdiv class=\x26quot;Widget stars\x26quot;\x3e\n                \x3cdiv class=\x26quot;star\x26quot;\x3e\x3c\/div\x3e\n            \x3c\/div\x3e\n        \x3c\/div\x3e\n        \x3cdiv class=\x26quot;propbox\x26quot;\x3e\n            \x3cdiv class=\x26quot;num\x26quot;\x3e\x3c\/div\x3e\n            \x3cdiv class=\x26quot;prop\x26quot;\x3e\x3c\/div\x3e\n        \x3c\/div\x3e\n        \x3cp class=\x26quot;Widget timer tips\x26quot;\x3e\x3cb class=\x26quot;t\x26quot;\x3eTIPS \x3c\/b\x3e捕捉半径\x3cspan class=\x26quot;t\x26quot;\x3e500\x3c\/span\x3e米 当前距离\x3cspan class=\x26quot;t dist\x26quot;\x3e0\x3c\/span\x3e米\x3c\/p\x3e\n        \x3cspan id=\x26quot;js-btn-catch\x26quot; class=\x26quot;catchbtn\x26quot;\x3e捕捉\x3c\/span\x3e\n    \x3c\/div\x3e\n\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs applescript\x22\x3e\x3ccode\x3e\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22Modal pokedex\x22\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22js-modal-pokedex\x22\x3c\/span\x3e\x26gt;\n    \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22card\x22\x3c\/span\x3e\x26gt;\n        \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22namebox\x22\x3c\/span\x3e\x26gt;\n            \x26lt;p \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22name_cn\x22\x3c\/span\x3e\x26gt;\x26lt;\/p\x26gt;\n            \x26lt;p \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22name_jp\x22\x3c\/span\x3e\x26gt;\x26lt;\/p\x26gt;\n        \x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n        \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22pokebox\x22\x3c\/span\x3e\x26gt;\n            \x26lt;img \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22pokeimg\x22\x3c\/span\x3e src=\x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e alt=\x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e\x26gt;\n            \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22Widget stars\x22\x3c\/span\x3e\x26gt;\n                \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22star\x22\x3c\/span\x3e\x26gt;\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n            \x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n        \x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n        \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22propbox\x22\x3c\/span\x3e\x26gt;\n            \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22num\x22\x3c\/span\x3e\x26gt;\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n            \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22prop\x22\x3c\/span\x3e\x26gt;\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n        \x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n        \x26lt;p \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22Widget timer tips\x22\x3c\/span\x3e\x26gt;\x26lt;b \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22t\x22\x3c\/span\x3e\x26gt;TIPS \x26lt;\/b\x26gt;捕捉半径\x26lt;span \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22t\x22\x3c\/span\x3e\x26gt;\x3cspan class=\x22hljs-number\x22\x3e500\x3c\/span\x3e\x26lt;\/span\x26gt;米 当前距离\x26lt;span \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22t dist\x22\x3c\/span\x3e\x26gt;\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\x26lt;\/span\x26gt;米\x26lt;\/p\x26gt;\n        \x26lt;span \x3cspan class=\x22hljs-built_in\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22js-btn-catch\x22\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22catchbtn\x22\x3c\/span\x3e\x26gt;捕捉\x26lt;\/span\x26gt;\n    \x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22initPokecard : function(nid, target) {\n    var $card = Element.$pokedex，\n        $catch = Element.$catch;\n    var data = Pokedex[nid - 1];   \/\/从图鉴JSON中获取对应精灵详细图鉴数据\n    var props = \x27\x27, dist = 0;\n    var imgUrl = \x27images\/pokemon_big\/PM_animation_\x27\x2b data.number \x2b\x27.png\x27;\n\n    \/\/拼接属性节点\n    for(var i = 0; i\x3c data.properties.length; i\x2b\x2b){\n        var color = Pokedexcolor[data.properties[i]].split(\x27,\x27);\n        props \x2b= \x27\x3cdiv class=\x26quot;item\x26quot; style=\x26quot;background:\x27\x2b color[1] \x2b\x27;border-color:\x27\x2b color[0] \x2b\x27\x26quot;\x3e\x27\x2b data.properties[i] \x2b\x27\x3c\/div\x3e\x27;\n    }\n    $card.find(\x27.name_cn\x27).text(data.name);  \/\/精灵中文名\n    $card.find(\x27.name_jp\x27).text(data.name_jp \x2b data.name_en);  \/\/精灵外文名\n    $card.find(\x27.star\x27)[0].className = \x27star star_\x27 \x2b data.star;   \/\/精灵星级\n    $card.find(\x27.num\x27).text(\x27No.\x27 \x2b data.number);  \/\/精灵编号\n    $card.find(\x27.prop\x27).html(props);   \/\/精灵属性\n    \/\/预加载精灵大图\n    $card.find(\x27.pokebox\x27).removeClass(\x27loaded\x27);\n    Method.loadImg(imgUrl, function() {\n        $card.find(\x27.pokeimg\x27).attr(\x27src\x27,imgUrl);\n        $card.find(\x27.pokebox\x27).addClass(\x27loaded\x27);\n    });\n    $card.addClass(\x27show\x27);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3einitPokecard : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(nid, target)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e $card = Element.$pokedex，\n        $catch = Element.$catch;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e data = Pokedex[nid - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e];   \x3cspan class=\x22hljs-comment\x22\x3e\/\/从图鉴JSON中获取对应精灵详细图鉴数据\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e props = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e, dist = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e imgUrl = \x3cspan class=\x22hljs-string\x22\x3e\x27images\/pokemon_big\/PM_animation_\x27\x3c\/span\x3e\x2b data.number \x2b\x3cspan class=\x22hljs-string\x22\x3e\x27.png\x27\x3c\/span\x3e;\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/拼接属性节点\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i\x26lt; data.properties.length; i\x2b\x2b){\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e color = Pokedexcolor[data.properties[i]].split(\x3cspan class=\x22hljs-string\x22\x3e\x27,\x27\x3c\/span\x3e);\n        props \x2b= \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div class=\x22item\x22 style=\x22background:\x27\x3c\/span\x3e\x2b color[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e] \x2b\x3cspan class=\x22hljs-string\x22\x3e\x27;border-color:\x27\x3c\/span\x3e\x2b color[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e] \x2b\x3cspan class=\x22hljs-string\x22\x3e\x27\x22\x26gt;\x27\x3c\/span\x3e\x2b data.properties[i] \x2b\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;\/div\x26gt;\x27\x3c\/span\x3e;\n    }\n    $card.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.name_cn\x27\x3c\/span\x3e).text(data.name);  \x3cspan class=\x22hljs-comment\x22\x3e\/\/精灵中文名\x3c\/span\x3e\n    $card.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.name_jp\x27\x3c\/span\x3e).text(data.name_jp \x2b data.name_en);  \x3cspan class=\x22hljs-comment\x22\x3e\/\/精灵外文名\x3c\/span\x3e\n    $card.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.star\x27\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].className = \x3cspan class=\x22hljs-string\x22\x3e\x27star star_\x27\x3c\/span\x3e \x2b data.star;   \x3cspan class=\x22hljs-comment\x22\x3e\/\/精灵星级\x3c\/span\x3e\n    $card.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.num\x27\x3c\/span\x3e).text(\x3cspan class=\x22hljs-string\x22\x3e\x27No.\x27\x3c\/span\x3e \x2b data.number);  \x3cspan class=\x22hljs-comment\x22\x3e\/\/精灵编号\x3c\/span\x3e\n    $card.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.prop\x27\x3c\/span\x3e).html(props);   \x3cspan class=\x22hljs-comment\x22\x3e\/\/精灵属性\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/预加载精灵大图\x3c\/span\x3e\n    $card.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.pokebox\x27\x3c\/span\x3e).removeClass(\x3cspan class=\x22hljs-string\x22\x3e\x27loaded\x27\x3c\/span\x3e);\n    Method.loadImg(imgUrl, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n        $card.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.pokeimg\x27\x3c\/span\x3e).attr(\x3cspan class=\x22hljs-string\x22\x3e\x27src\x27\x3c\/span\x3e,imgUrl);\n        $card.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.pokebox\x27\x3c\/span\x3e).addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27loaded\x27\x3c\/span\x3e);\n    });\n    $card.addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27show\x27\x3c\/span\x3e);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e到这里就完成了精灵卡片的初始化（与背包图鉴共用），然而卡片只带有固定数据，需要跟单纯的图鉴查看器做区分，我们在卡片下方加上操作区，操作区有3种状态：精灵可捕捉，精灵已获得，精灵超出捕捉范围：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671773\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671773\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22initPokecard : function(nid, target) {\n    ...\n    \/\/判断点击精灵行为来自地图还是图鉴\n    if(target) {\n        var pa = target.getPosition(),\n            pb = [State.heroPoint.lng,State.heroPoint.lat];\n        var dist = parseInt(pa.distance(pb));  \/\/计算主角与点击精灵距离\n\n        $card.addClass(\x27catch\x27);\n        $card.off().on(\x27touchend\x27,function(e){\n            $(this).removeClass(\x27show\x27);\n            e.preventDefault();\n        })\n        if( dist \x3c 500 ) {\n            $card.find(\x27.tips\x27).hide();\n            if(State.bag.indexOf(data.number) != -1){\n                $catch.removeClass().addClass(\x27ownbtn\x27).text(\x27已获得\x27);\n            }else{\n                $catch.removeClass().addClass(\x27catchbtn\x27).text(\x27捕捉\x27);\n            }\n        }else{\n            $card.find(\x27.dist\x27).text(dist);\n            $card.find(\x27.tips\x27).show();\n            $catch.removeClass().addClass(\x27overbtn\x27).text(\x27走近点啊亲\x27);\n        }\n    }else{\n        $card.removeClass(\x27catch\x27);\n        $card.find(\x27.tips\x27).hide();\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3einitPokecard : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(nid, target)\x3c\/span\x3e \x3c\/span\x3e{\n    ...\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/判断点击精灵行为来自地图还是图鉴\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(target) {\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e pa = target.getPosition(),\n            pb = [State.heroPoint.lng,State.heroPoint.lat];\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e dist = parseInt(pa.distance(pb));  \x3cspan class=\x22hljs-comment\x22\x3e\/\/计算主角与点击精灵距离\x3c\/span\x3e\n\n        $card.addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27catch\x27\x3c\/span\x3e);\n        $card.off().on(\x3cspan class=\x22hljs-string\x22\x3e\x27touchend\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(e)\x3c\/span\x3e\x3c\/span\x3e{\n            $(this).removeClass(\x3cspan class=\x22hljs-string\x22\x3e\x27show\x27\x3c\/span\x3e);\n            e.preventDefault();\n        })\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e( dist \x26lt; \x3cspan class=\x22hljs-number\x22\x3e500\x3c\/span\x3e ) {\n            $card.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.tips\x27\x3c\/span\x3e).hide();\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(State.bag.indexOf(data.number) != \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e){\n                $catch.removeClass().addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27ownbtn\x27\x3c\/span\x3e).text(\x3cspan class=\x22hljs-string\x22\x3e\x27已获得\x27\x3c\/span\x3e);\n            }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n                $catch.removeClass().addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27catchbtn\x27\x3c\/span\x3e).text(\x3cspan class=\x22hljs-string\x22\x3e\x27捕捉\x27\x3c\/span\x3e);\n            }\n        }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n            $card.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.dist\x27\x3c\/span\x3e).text(dist);\n            $card.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.tips\x27\x3c\/span\x3e).show();\n            $catch.removeClass().addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27overbtn\x27\x3c\/span\x3e).text(\x3cspan class=\x22hljs-string\x22\x3e\x27走近点啊亲\x27\x3c\/span\x3e);\n        }\n    }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n        $card.removeClass(\x3cspan class=\x22hljs-string\x22\x3e\x27catch\x27\x3c\/span\x3e);\n        $card.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.tips\x27\x3c\/span\x3e).hide();\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671774\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671774\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671775\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671775\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.guowc.cc\/go\/demo6.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e查看DEMO\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader18\x22\x3e九、精灵捕捉场景\x3c\/h3\x3e\n\x3cp\x3e首先为卡片下方的捕捉按钮绑定事件，将点击的精灵数据传递到meetPokemon方法中（初始化精灵捕捉场景方法）：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22initPokecard : function(nid, target) {\n    ...\n    if(target) {\n        var ext = target.getExtData()\n        $catch.off();  \/\/解除捕捉按钮绑定事件\n        ...\n        if( dist \x3c 500 ){\n            if(State.bag.indexOf(\x27data.number) != -1){\n                ...\n            }else{\n                $catch.on(\x27touchend\x27, self.meetPokemon(ext.nid,ext.id));\n                target.setMap(null);  \/\/开始捕捉后将地图上对应小精灵移除（捕捉成功or失败小精灵都会消失）\n            }\n        }\n    }else{\n\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs scala\x22\x3e\x3ccode\x3einitPokecard : function(nid, target) {\n    ...\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(target) {\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ext = target.getExtData()\n        $\x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e.off();  \x3cspan class=\x22hljs-comment\x22\x3e\/\/解除捕捉按钮绑定事件\x3c\/span\x3e\n        ...\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e( dist \x26lt; \x3cspan class=\x22hljs-number\x22\x3e500\x3c\/span\x3e ){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-type\x22\x3eState\x3c\/span\x3e.bag.indexOf(\x3cspan class=\x22hljs-symbol\x22\x3e\x27data\x3c\/span\x3e.number) != \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e){\n                ...\n            }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n                $\x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e.on(\x3cspan class=\x22hljs-symbol\x22\x3e\x27touchen\x3c\/span\x3ed\x27, self.meetPokemon(ext.nid,ext.id));\n                target.setMap(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e);  \x3cspan class=\x22hljs-comment\x22\x3e\/\/开始捕捉后将地图上对应小精灵移除（捕捉成功or失败小精灵都会消失）\x3c\/span\x3e\n            }\n        }\n    }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后初始化捕捉场景：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22meetPokemon : function(nid,id){\n    Element.$modal.removeClass(\x27show\x27);\n    Element.$body.addClass(\x27State catching\x27);  \/\/进入捕捉场景需要控制界面多处UI，所以把状态class放到body上\n    Element.$catchBox.find(\x27.texture\x27).attr(\x27src\x27,\x27images\/pokemon_big\/PM_animation_\x27 \x2b Pokedex[nid].number \x2b \x27.png\x27);\n    Element.$catchBox.find(\x27.pname\x27).text(Pokedex[nid].name);\n    Element.$catchBox.find(\x27.star\x27)[0].className = \x27star star_\x27 \x2b Pokedex[nid].star;\n},\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3emeetPokemon : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(nid,id)\x3c\/span\x3e\x3c\/span\x3e{\n    Element.$modal.removeClass(\x3cspan class=\x22hljs-string\x22\x3e\x27show\x27\x3c\/span\x3e);\n    Element.$body.addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27State catching\x27\x3c\/span\x3e);  \x3cspan class=\x22hljs-comment\x22\x3e\/\/进入捕捉场景需要控制界面多处UI，所以把状态class放到body上\x3c\/span\x3e\n    Element.$catchBox.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.texture\x27\x3c\/span\x3e).attr(\x3cspan class=\x22hljs-string\x22\x3e\x27src\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27images\/pokemon_big\/PM_animation_\x27\x3c\/span\x3e \x2b Pokedex[nid].number \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27.png\x27\x3c\/span\x3e);\n    Element.$catchBox.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.pname\x27\x3c\/span\x3e).text(Pokedex[nid].name);\n    Element.$catchBox.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.star\x27\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].className = \x3cspan class=\x22hljs-string\x22\x3e\x27star star_\x27\x3c\/span\x3e \x2b Pokedex[nid].star;\n},\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671776\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671776\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.guowc.cc\/go\/demo7.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e查看DEMO\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader19\x22\x3e十、去吧精灵球！\x3c\/h3\x3e\n\x3cp\x3e现在点击丢出精灵球开始捕捉精灵，首先在meetPokemon中绑定精灵球的点击事件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22meetPokemon : function(nid,id){\n    ...\n    Element.$catchBox.find(\x27.ballbox\x27).off().on(\x27touchend\x27,function(){\n        self.catchPokemon(nid,id)\n    })\n},\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3emeetPokemon : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(nid,id)\x3c\/span\x3e\x3c\/span\x3e{\n    ...\n    Element.$catchBox.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.ballbox\x27\x3c\/span\x3e).off().on(\x3cspan class=\x22hljs-string\x22\x3e\x27touchend\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eself\x3c\/span\x3e.catchPokemon(nid,id)\n    })\n},\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e接下来实现catchPokemon方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22catchPokemon : function(nid,id){\n    var self = this;\n    var name = Pokedex[nid].name,\n        pid = Pokedex[nid].number,\n        star = Pokedex[nid].star,\n        rate = 0.8 -  star \/ 10;   \/\/根据星级决定捕捉成功概率\n\n    if(State.catching) return;\n\n    if(Method.random(rate)){\n        \/\/捕捉成功\n        Element.$catchBox.addClass(\x27catchwin\x27);    \/\/在catchbox上增加catchwin控制捕捉成功动画（动画具体实现参照DEMO）\n        Method.fetch(API.catchPokemon,{ id : id },function(){\n            console.log(\x27捕捉成功！\x27)   \/\/向服务端发送捕捉成功请求，移除getGlassPokemon返回的对应位置精灵，同时加入用户背包\n        });\n        setTimeout(function(){\n            \/\/动画播放结束后调用捕捉成功弹窗\n            self.awardBox(\x27images\/pokemon_big\/PM_animation_\x27 \x2b pid \x2b \x27.png\x27,name,function(){\n                \/\/弹窗关闭后回到主界面\n                $body.removeClass();\n                Element.$catchBox.removeClass(\x27catchwin\x27);\n                State.catching = false;\n            });\n        },3200);\n    }else{\n        \/\/捕捉失败\n        Element.$catchBox.addClass(\x27catchfail\x27);  \/\/在catchbox上增加catchfail控制捕捉失败动画\n        Method.fetch(API.catchPokemon,{ id : id , flag : true},function(){\n            console.log(\x27捕捉失败！\x27)   \/\/向服务端发送捕捉失败请求，仅移除getGlassPokemon返回的对应位置精灵\n        });\n        setTimeout(function(){\n            \/\/动画播放失败后调用捕捉失败弹窗\n            self.alertBox(name \x2b \x27 逃跑了!\x27,function(){\n                \/\/弹窗关闭后回到主界面\n                Element.$body.removeClass();\n                Element.$catchBox.removeClass(\x27catchfail\x27);\n                State.catching = false;\n            });\n        },1500);\n    }\n    State.catching = true;\n},\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3ecatchPokemon : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(nid,id)\x3c\/span\x3e\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eself\x3c\/span\x3e = this;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e name = Pokedex[nid].name,\n        pid = Pokedex[nid].number,\n        star = Pokedex[nid].star,\n        rate = \x3cspan class=\x22hljs-number\x22\x3e0.8\x3c\/span\x3e -  star \/ \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;   \x3cspan class=\x22hljs-comment\x22\x3e\/\/根据星级决定捕捉成功概率\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(State.catching) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(Method.random(rate)){\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/捕捉成功\x3c\/span\x3e\n        Element.$catchBox.addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27catchwin\x27\x3c\/span\x3e);    \x3cspan class=\x22hljs-comment\x22\x3e\/\/在catchbox上增加catchwin控制捕捉成功动画（动画具体实现参照DEMO）\x3c\/span\x3e\n        Method.fetch(API.catchPokemon,{ id : id },\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n            console.log(\x3cspan class=\x22hljs-string\x22\x3e\x27捕捉成功！\x27\x3c\/span\x3e)   \x3cspan class=\x22hljs-comment\x22\x3e\/\/向服务端发送捕捉成功请求，移除getGlassPokemon返回的对应位置精灵，同时加入用户背包\x3c\/span\x3e\n        });\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/动画播放结束后调用捕捉成功弹窗\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eself\x3c\/span\x3e.awardBox(\x3cspan class=\x22hljs-string\x22\x3e\x27images\/pokemon_big\/PM_animation_\x27\x3c\/span\x3e \x2b pid \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27.png\x27\x3c\/span\x3e,name,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/弹窗关闭后回到主界面\x3c\/span\x3e\n                $body.removeClass();\n                Element.$catchBox.removeClass(\x3cspan class=\x22hljs-string\x22\x3e\x27catchwin\x27\x3c\/span\x3e);\n                State.catching = \x3cspan class=\x22hljs-keyword\x22\x3efalse\x3c\/span\x3e;\n            });\n        },\x3cspan class=\x22hljs-number\x22\x3e3200\x3c\/span\x3e);\n    }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/捕捉失败\x3c\/span\x3e\n        Element.$catchBox.addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27catchfail\x27\x3c\/span\x3e);  \x3cspan class=\x22hljs-comment\x22\x3e\/\/在catchbox上增加catchfail控制捕捉失败动画\x3c\/span\x3e\n        Method.fetch(API.catchPokemon,{ id : id , flag : \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e},\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n            console.log(\x3cspan class=\x22hljs-string\x22\x3e\x27捕捉失败！\x27\x3c\/span\x3e)   \x3cspan class=\x22hljs-comment\x22\x3e\/\/向服务端发送捕捉失败请求，仅移除getGlassPokemon返回的对应位置精灵\x3c\/span\x3e\n        });\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/动画播放失败后调用捕捉失败弹窗\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eself\x3c\/span\x3e.alertBox(name \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27 逃跑了!\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/弹窗关闭后回到主界面\x3c\/span\x3e\n                Element.$body.removeClass();\n                Element.$catchBox.removeClass(\x3cspan class=\x22hljs-string\x22\x3e\x27catchfail\x27\x3c\/span\x3e);\n                State.catching = \x3cspan class=\x22hljs-keyword\x22\x3efalse\x3c\/span\x3e;\n            });\n        },\x3cspan class=\x22hljs-number\x22\x3e1500\x3c\/span\x3e);\n    }\n    State.catching = \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e;\n},\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e捕捉成功与失败：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22awardBox : function(img,name,callback){\n    var cbk = callback || function(){};\n    Element.$award.addClass(\x27show\x27);\n    Element.$award.find(\x27.img\x27).attr(\x27src\x27,img);\n    Element.$award.find(\x27.pname\x27).text(name);\n    Element.$award.find(\x27.confirm\x27).off().on(\x27tap\x27,function(){\n        Element.$award.removeClass(\x27show\x27);\n        cbk();\n    });\n},\nalertBox : function(title,callback){\n    var cbk = callback || function(){};\n    Element.$alert.addClass(\x27show\x27);\n    Element.$alert.find(\x27.heading\x27).text(title);\n    Element.$alert.find(\x27.confirm\x27).off().on(\x27tap\x27,function(){\n        Element.$alert.removeClass(\x27show\x27);\n        cbk();\n    });\n},\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3eawardBox : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(img,name,callback)\x3c\/span\x3e\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cbk = callback || \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{};\n    Element.$award.addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27show\x27\x3c\/span\x3e);\n    Element.$award.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.img\x27\x3c\/span\x3e).attr(\x3cspan class=\x22hljs-string\x22\x3e\x27src\x27\x3c\/span\x3e,img);\n    Element.$award.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.pname\x27\x3c\/span\x3e).text(name);\n    Element.$award.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.confirm\x27\x3c\/span\x3e).off().on(\x3cspan class=\x22hljs-string\x22\x3e\x27tap\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n        Element.$award.removeClass(\x3cspan class=\x22hljs-string\x22\x3e\x27show\x27\x3c\/span\x3e);\n        cbk();\n    });\n},\nalertBox : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(title,callback)\x3c\/span\x3e\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cbk = callback || \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{};\n    Element.$alert.addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27show\x27\x3c\/span\x3e);\n    Element.$alert.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.heading\x27\x3c\/span\x3e).text(title);\n    Element.$alert.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.confirm\x27\x3c\/span\x3e).off().on(\x3cspan class=\x22hljs-string\x22\x3e\x27tap\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n        Element.$alert.removeClass(\x3cspan class=\x22hljs-string\x22\x3e\x27show\x27\x3c\/span\x3e);\n        cbk();\n    });\n},\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e捕捉失败过程：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671777\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671777\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e捕捉成功过程：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671778\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671778\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.guowc.cc\/go\/demo8.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e查看DEMO\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader20\x22\x3e十一、大木博士\x3c\/h3\x3e\n\x3cp\x3e还原经典，我们加入一个简单的新手引导，通过与大木博士的对话，确定玩家性别，第一个伙伴，和简单的游戏玩法介绍。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671779\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671779\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e首先实现一个简单的打字效果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22typing(char,delay){\n    var chars = char.split(\x27\x27);\n    var index = 0,\n        delay = 0;\n\n    Element.$typeText.html(\x27\x27);\n    Element.$typeNext.hide();   \/\/打字过程隐藏下一步箭头\n    State.typeOver = false;\n    var timer = setInterval(function(){\n        if(delay == delay){\n            if(index == chars.length){\n                clearInterval(timer);\n                State.typeOver = true;\n                Element.$typeNext.show();\n                return;\n            }\n            if(chars[index] == \x27\/\x27){\n                Element.$typeText.append(\x27\x3cbr\x3e\x27);  \/\/判断换行位置\n            }else{\n                Element.$typeText.append(chars[index]);\n            }\n            index \x2b\x2b;\n        }else{\n            delay \x2b\x2b ;\n        }\n    },50);\n},\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3etyping(char,delay){\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e chars = char.split(\x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e index = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n        delay = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\n    Element.$typeText.html(\x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e);\n    Element.$typeNext.hide();   \x3cspan class=\x22hljs-comment\x22\x3e\/\/打字过程隐藏下一步箭头\x3c\/span\x3e\n    State.typeOver = \x3cspan class=\x22hljs-keyword\x22\x3efalse\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e timer = setInterval(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(delay == delay){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(index == chars.length){\n                clearInterval(timer);\n                State.typeOver = \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e;\n                Element.$typeNext.show();\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n            }\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(chars[index] == \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e){\n                Element.$typeText.append(\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;br\x26gt;\x27\x3c\/span\x3e);  \x3cspan class=\x22hljs-comment\x22\x3e\/\/判断换行位置\x3c\/span\x3e\n            }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n                Element.$typeText.append(chars[index]);\n            }\n            index \x2b\x2b;\n        }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n            delay \x2b\x2b ;\n        }\n    },\x3cspan class=\x22hljs-number\x22\x3e50\x3c\/span\x3e);\n},\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后初始化新手引导：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22initGuide : function(){\n    var self = this;\n    var sex = 1, pokenum = \x27001\x27, typeIndex = 0;\n\n    Method.typing(\x27欢迎来到精灵世界\/我是大木博士\x27,10);\n\n    Element.$modal.removeClass(\x27show\x27);  \/\/隐藏所有弹窗\n    Element.$modalGuide.addClass(\x27show\x27); \/\/显示新手引导弹窗\n    Element.$body.addClass(\x27blur\x27);  \/\/背景模糊\n\n    Element.$typeBox.bind(\x27tap\x27,function(){\n        \/\/开始对话\n        if(!State.typeOver) return;\n        typeIndex \x2b\x2b;    \n        switch (typeIndex) {\n            case 1:\n                Method.typing(\x27这个世界到处都有精灵的存在\/许多人把精灵当做伙伴\x27,0);\n                break;\n            case 2:\n                Method.typing(\x27那么你是男孩还是女孩？\/(选择角色)\x27,0);\n                Element.$modalGuide.addClass(\x27setrole\x27);  \/\/进入选择角色界面\n                Element.$setRole.bind(\x27tap\x27,function(){\n                    $(this).addClass(\x27selected\x27).siblings().removeClass(\x27selected\x27);\n                    sex = $(this).data(\x27sex\x27);\n                });\n                break;\n            case 3:\n                Method.typing(\x27选择一只精灵作为你的伙伴吧\/(选择精灵)\x27,0);\n                Element.$modalGuide.removeClass(\x27setrole\x27).addClass(\x27setpoke\x27);  \/\/进入选择精灵界面\n                Element.$setPoke.bind(\x27tap\x27,function(){\n                    $(this).addClass(\x27selected\x27).siblings().removeClass(\x27selected\x27);\n                    pokenum = $(this).data(\x27number\x27);\n                    Element.$setFigure[0].className = \x27img-\x27 \x2b pokenum;\n                });\n                Method.setItem(\x27sex\x27,sex);\n                break;\n            case 4:\n                Method.typing(\x27点击周围的小精灵即可抓捕!\/(操作方式)\x27,0);\n                Element.$modalGuide.removeClass(\x27setpoke\x27);\n                break;\n            case 5:\n                Method.typing(\x27移动可能遇到随机出现的稀有精灵哦!\/(随机事件)\x27,0);\n                break;\n            case 6:\n                Method.typing(\x27请带上你的伙伴去冒险吧!\x27,0);\n                break;\n            case 7:\n                Element.$modalGuide.removeClass(\x27show\x27);\n                Element.$body.removeClass(\x27blur\x27);\n                self.ready();\n                break;\n            default:\n        }\n    });\n},\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3einitGuide : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eself\x3c\/span\x3e = this;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e sex = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, pokenum = \x3cspan class=\x22hljs-string\x22\x3e\x27001\x27\x3c\/span\x3e, typeIndex = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\n    Method.typing(\x3cspan class=\x22hljs-string\x22\x3e\x27欢迎来到精灵世界\/我是大木博士\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n\n    Element.$modal.removeClass(\x3cspan class=\x22hljs-string\x22\x3e\x27show\x27\x3c\/span\x3e);  \x3cspan class=\x22hljs-comment\x22\x3e\/\/隐藏所有弹窗\x3c\/span\x3e\n    Element.$modalGuide.addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27show\x27\x3c\/span\x3e); \x3cspan class=\x22hljs-comment\x22\x3e\/\/显示新手引导弹窗\x3c\/span\x3e\n    Element.$body.addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27blur\x27\x3c\/span\x3e);  \x3cspan class=\x22hljs-comment\x22\x3e\/\/背景模糊\x3c\/span\x3e\n\n    Element.$typeBox.bind(\x3cspan class=\x22hljs-string\x22\x3e\x27tap\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/开始对话\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(!State.typeOver) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n        typeIndex \x2b\x2b;    \n        \x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e (typeIndex) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e:\n                Method.typing(\x3cspan class=\x22hljs-string\x22\x3e\x27这个世界到处都有精灵的存在\/许多人把精灵当做伙伴\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n                \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e:\n                Method.typing(\x3cspan class=\x22hljs-string\x22\x3e\x27那么你是男孩还是女孩？\/(选择角色)\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n                Element.$modalGuide.addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27setrole\x27\x3c\/span\x3e);  \x3cspan class=\x22hljs-comment\x22\x3e\/\/进入选择角色界面\x3c\/span\x3e\n                Element.$setRole.bind(\x3cspan class=\x22hljs-string\x22\x3e\x27tap\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n                    $(this).addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27selected\x27\x3c\/span\x3e).siblings().removeClass(\x3cspan class=\x22hljs-string\x22\x3e\x27selected\x27\x3c\/span\x3e);\n                    sex = $(this).data(\x3cspan class=\x22hljs-string\x22\x3e\x27sex\x27\x3c\/span\x3e);\n                });\n                \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e:\n                Method.typing(\x3cspan class=\x22hljs-string\x22\x3e\x27选择一只精灵作为你的伙伴吧\/(选择精灵)\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n                Element.$modalGuide.removeClass(\x3cspan class=\x22hljs-string\x22\x3e\x27setrole\x27\x3c\/span\x3e).addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27setpoke\x27\x3c\/span\x3e);  \x3cspan class=\x22hljs-comment\x22\x3e\/\/进入选择精灵界面\x3c\/span\x3e\n                Element.$setPoke.bind(\x3cspan class=\x22hljs-string\x22\x3e\x27tap\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n                    $(this).addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27selected\x27\x3c\/span\x3e).siblings().removeClass(\x3cspan class=\x22hljs-string\x22\x3e\x27selected\x27\x3c\/span\x3e);\n                    pokenum = $(this).data(\x3cspan class=\x22hljs-string\x22\x3e\x27number\x27\x3c\/span\x3e);\n                    Element.$setFigure[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].className = \x3cspan class=\x22hljs-string\x22\x3e\x27img-\x27\x3c\/span\x3e \x2b pokenum;\n                });\n                Method.setItem(\x3cspan class=\x22hljs-string\x22\x3e\x27sex\x27\x3c\/span\x3e,sex);\n                \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e:\n                Method.typing(\x3cspan class=\x22hljs-string\x22\x3e\x27点击周围的小精灵即可抓捕!\/(操作方式)\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n                Element.$modalGuide.removeClass(\x3cspan class=\x22hljs-string\x22\x3e\x27setpoke\x27\x3c\/span\x3e);\n                \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e:\n                Method.typing(\x3cspan class=\x22hljs-string\x22\x3e\x27移动可能遇到随机出现的稀有精灵哦!\/(随机事件)\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n                \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e:\n                Method.typing(\x3cspan class=\x22hljs-string\x22\x3e\x27请带上你的伙伴去冒险吧!\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n                \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e:\n                Element.$modalGuide.removeClass(\x3cspan class=\x22hljs-string\x22\x3e\x27show\x27\x3c\/span\x3e);\n                Element.$body.removeClass(\x3cspan class=\x22hljs-string\x22\x3e\x27blur\x27\x3c\/span\x3e);\n                \x3cspan class=\x22hljs-keyword\x22\x3eself\x3c\/span\x3e.ready();\n                \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e:\n        }\n    });\n},\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.guowc.cc\/go\/demo9.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e查看DEMO\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader21\x22\x3e十二、完善细节\x3c\/h3\x3e\n\x3ch4\x3e页面加载\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671780\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671780\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e精灵刷新倒计时\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671781\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671781\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e系统公告\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671782\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671782\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3eToast提示\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671783\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671783\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e训练师信息\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671784\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671784\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e精灵背包\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671785\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671785\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e精灵图鉴\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671786\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671786\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e精灵大师榜\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010671787\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010671787\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader22\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e这个项目是去年6月份开始的，从零开始策划、设计、到程序实现，断断续续写了2个月，期间深度分析对比了几个地图厂商的开发文档，推翻了数次方案，不断对游戏细节，性能，交互，功能取舍做优化，总结了LBS游戏开发的一些经验与建议：\x3cbr\x3e1、文档与社区活跃度很重要（这点高德地图做的更好）\x3cbr\x3e2、作为练手，不依赖框架库开发游戏，更能锻炼逻辑能力，了解底层实现\x3cbr\x3e3、作为落地项目，轻量休闲游戏开发仍然需要借助成熟的游戏开发框架（Phaser、Pixel），或Vue、React（大量状态管理）\x3cbr\x3e4、交互动画部分尽可能交给css3，js负责数据与状态控制\x3cbr\x3e5、用户体验、性能、游戏性同等重要\x3c\/p\x3e\n\x3cp\x3e最后再附上完整版：（完整版仍为百度地图开发，体验相差不大）\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010687878\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010687878\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3ehave a fun！\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>PokemonGo：LBS游戏开发</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010671755">https://segmentfault.com/a/1190000010671755</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/46rkn7ff46/" target="_blank">https://alili.tech/archive/46rkn7ff46/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>