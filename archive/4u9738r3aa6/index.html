<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="一行代码实现一个简单的模板字符串替换"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>一行代码实现一个简单的模板字符串替换 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/4u9738r3aa6/",
				"appid": "1613049289050283", 
				"title": "一行代码实现一个简单的模板字符串替换 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-12T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/yabu1mwxhho/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/o140ok3ry4i/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f4u9738r3aa6%2f&text=%e4%b8%80%e8%a1%8c%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aa%e7%ae%80%e5%8d%95%e7%9a%84%e6%a8%a1%e6%9d%bf%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%9b%bf%e6%8d%a2"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f4u9738r3aa6%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f4u9738r3aa6%2f&text=%e4%b8%80%e8%a1%8c%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aa%e7%ae%80%e5%8d%95%e7%9a%84%e6%a8%a1%e6%9d%bf%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%9b%bf%e6%8d%a2"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f4u9738r3aa6%2f&title=%e4%b8%80%e8%a1%8c%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aa%e7%ae%80%e5%8d%95%e7%9a%84%e6%a8%a1%e6%9d%bf%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%9b%bf%e6%8d%a2"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f4u9738r3aa6%2f&is_video=false&description=%e4%b8%80%e8%a1%8c%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aa%e7%ae%80%e5%8d%95%e7%9a%84%e6%a8%a1%e6%9d%bf%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%9b%bf%e6%8d%a2"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%b8%80%e8%a1%8c%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aa%e7%ae%80%e5%8d%95%e7%9a%84%e6%a8%a1%e6%9d%bf%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%9b%bf%e6%8d%a2&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f4u9738r3aa6%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f4u9738r3aa6%2f&title=%e4%b8%80%e8%a1%8c%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aa%e7%ae%80%e5%8d%95%e7%9a%84%e6%a8%a1%e6%9d%bf%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%9b%bf%e6%8d%a2"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f4u9738r3aa6%2f&title=%e4%b8%80%e8%a1%8c%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aa%e7%ae%80%e5%8d%95%e7%9a%84%e6%a8%a1%e6%9d%bf%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%9b%bf%e6%8d%a2"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f4u9738r3aa6%2f&title=%e4%b8%80%e8%a1%8c%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aa%e7%ae%80%e5%8d%95%e7%9a%84%e6%a8%a1%e6%9d%bf%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%9b%bf%e6%8d%a2"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f4u9738r3aa6%2f&title=%e4%b8%80%e8%a1%8c%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aa%e7%ae%80%e5%8d%95%e7%9a%84%e6%a8%a1%e6%9d%bf%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%9b%bf%e6%8d%a2"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">一行代码实现一个简单的模板字符串替换</h1><div class="meta"><div class="postdate"><time datetime="2018-12-12" itemprop="datePublished">2018-12-12</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch3 id=\x22articleHeader0\x22\x3e起始\x3c\/h3\x3e\n\x3cp\x3e同许多初学 \x3ccode\x3eJavascript\x3c\/code\x3e 的菜鸟一样，起初，我也是采用拼接字符串的形式，将 \x3ccode\x3eJSON\x3c\/code\x3e 数据嵌入 \x3ccode\x3eHTML\x3c\/code\x3e 中。开始时代码量较少，暂时还可以接受。但当页面结构复杂起来后，其弱点开始变得无法忍受起来：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e书写不连贯。每写一个变量就要断一下，插入一个 \x2b 和 \x22。十分容易出错。\x3c\/li\x3e\n\x3cli\x3e无法重用。\x3ccode\x3eHTML\x3c\/code\x3e 片段都是离散化的数据，难以对其中重复的部分进行提取。\x3c\/li\x3e\n\x3cli\x3e无法很好地利用 \x3ca href=\x22http:\/\/www.zhangxinxu.com\/wordpress\/2014\/07\/hello-html5-template-tag\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3e\x26lt;template\x26gt;\x3c\/code\x3e\x3c\/a\x3e 标签。这是 \x3ccode\x3eHTML5\x3c\/code\x3e 中新增的一个标签，标准极力推荐将 \x3ccode\x3eHTML\x3c\/code\x3e 模板放入 \x3ca href=\x22http:\/\/www.zhangxinxu.com\/wordpress\/2014\/07\/hello-html5-template-tag\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3e\x26lt;template\x26gt;\x3c\/code\x3e\x3c\/a\x3e  标签中，使代码更简洁。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e当时我的心情就是这样的：\x3cbr\x3e这TMD是在逗我吗。\x3c\/p\x3e\n\x3cp\x3e于是出来了后来的 \x3ccode\x3eES6\x3c\/code\x3e，\x3ca href=\x22http:\/\/es6.ruanyifeng.com\/#docs\/string#%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eES6的模板字符串\x3c\/a\x3e用起来着实方便，对于比较老的项目，项目没\x3ccode\x3ewebpack\x3c\/code\x3e，\x3ccode\x3egulp\x3c\/code\x3e 等构建工具，无法使用 \x3ccode\x3eES6\x3c\/code\x3e 的语法，但是想也借鉴这种优秀的处理字符串拼接的方式，我们不妨可以试着自己写一个，主要是思路，可以使用 \x3ccode\x3eES6\x3c\/code\x3e 语法模拟 \x3ca href=\x22http:\/\/es6.ruanyifeng.com\/#docs\/string#%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eES6的模板字符串\x3c\/a\x3e的这个功能。\x3c\/p\x3e\n\x3cp\x3e后端返回的一般都是 \x3ca href=\x22http:\/\/www.json.org\/json-zh.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eJSON\x3c\/code\x3e\x3c\/a\x3e 的数据格式，所以我们按照下面的规则进行模拟。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e需求描述\x3c\/h3\x3e\n\x3cblockquote\x3e实现一个 render(template, context) 方法，将 template 中的占位符用 context 填充。\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e要求：\x3c\/h3\x3e\n\x3cblockquote\x3e不需要有控制流成分（如 循环、条件 等等），只要有变量替换功能即可\x3cbr\x3e级联的变量也可以展开\x3cbr\x3e被转义的的分隔符 { 和 } 不应该被渲染，分隔符与变量之间允许有空白字符\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var obj = {name:\x26quot;二月\x26quot;,age:\x26quot;15\x26quot;};\nvar str = \x26quot;\x22{{\x22name\x22}}\x22很厉害，才\x22{{\x22age\x22}}\x22岁\x26quot;;\n输出：二月很厉害，才15岁。\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e obj = {\x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22二月\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3eage\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x2215\x22\x3c\/span\x3e};\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e str = \x3cspan class=\x22hljs-string\x22\x3e\x22\x22{{\x22name\x22}}\x22很厉害，才\x22{{\x22age\x22}}\x22岁\x22\x3c\/span\x3e;\n输出：二月很厉害，才\x3cspan class=\x22hljs-number\x22\x3e15\x3c\/span\x3e岁。\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3ePS：本文需要对\x3ca href=\x22https:\/\/github.com\/jawil\/blog\/issues\/20\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e正则表达式\x3c\/a\x3e有一定的了解，如果还不了解\x3ca href=\x22https:\/\/github.com\/jawil\/blog\/issues\/20\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e正则表达式\x3c\/a\x3e，建议先去学习一下，正则也是面试笔试必备的技能，上面链接末尾有不少正则学习的链接。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e如果是你，你会怎么实现？可以先尝试自己写写，实现也不难。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e先不说我的实现，我把这个题给其他好友做的时候，实现的不尽相同，我们先看几位童鞋的实现，然后在他们的基础上找到常见的误区以及实现不够优雅的地方。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e二月童鞋：\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let str = \x26quot;\x22{{\x22name\x22}}\x22很厉害，才\x22{{\x22age\x22}}\x22岁\x26quot;\nlet obj = {name: \x27二月\x27, age: 15}\nfunction test(str, obj){\n    let _s = str.replace(\/\\{\\{(\\w\x2b)\\}\\}\/g, \x27$1\x27)\n    let result\n    for(let k in obj) {\n      _s = _s.replace(new RegExp(k, \x27g\x27), obj[k])\n    }\n  return _s\n}\nconst s = test(str, obj)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e str = \x3cspan class=\x22hljs-string\x22\x3e\x22\x22{{\x22name\x22}}\x22很厉害，才\x22{{\x22age\x22}}\x22岁\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e obj = {\x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27二月\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3eage\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e15\x3c\/span\x3e}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etest\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3estr, obj\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e _s = str.replace(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\{\\{(\\w\x2b)\\}\\}\/g\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27$1\x27\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e result\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e k \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e obj) {\n      _s = _s.replace(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eRegExp\x3c\/span\x3e(k, \x3cspan class=\x22hljs-string\x22\x3e\x27g\x27\x3c\/span\x3e), obj[k])\n    }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e _s\n}\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e s = test(str, obj)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最基本的是实现了，但是代码还是有很多问题没考虑到，首先 Object 的 key 值不一定只是 w，\x3cbr\x3e还有就是如果字符串是这种的：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let str = \x26quot;\x22{{\x22name\x22}}\x22很name厉害，才\x22{{\x22age\x22}}\x22岁\x26quot;`\n会输出 ：二月很厉害二月害，才15岁\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e str = \x3cspan class=\x22hljs-string\x22\x3e\x22\x22{{\x22name\x22}}\x22很name厉害，才\x22{{\x22age\x22}}\x22岁\x22\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e`\n会输出 ：二月很厉害二月害，才15岁\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e此处你需要了解正则的分组才会明白 \x3ccode\x3e$1\x3c\/code\x3e 的含义，错误很明显，把本来就是字符串不要替换的 \x3ccode\x3ename\x3c\/code\x3e 也给替换了，从代码我们可以看出二月的思路。\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e代码的作用目标是 \x3ccode\x3estr\x3c\/code\x3e，先用正则匹配出 \x3ccode\x3e\x22{{\x22name\x22}}\x22\x3c\/code\x3e 和 \x3ccode\x3e\x22{{\x22age\x22}}\x22\x3c\/code\x3e，然后用分组获取括号的 \x3ccode\x3ename\x3c\/code\x3e,\x3ccode\x3eage\x3c\/code\x3e,最后用 \x3ccode\x3ereplace\x3c\/code\x3e 方法把 \x3ccode\x3e\x22{{\x22name\x22}}\x22\x3c\/code\x3e 和 \x3ccode\x3e\x22{{\x22age\x22}}\x22\x3c\/code\x3e 替换成 \x3ccode\x3ename\x3c\/code\x3e 和 \x3ccode\x3eage\x3c\/code\x3e，最后字符串就成了 \x3cstrong\x3ename很name厉害，才age岁\x3c\/strong\x3e，最后 \x3ccode\x3efor in\x3c\/code\x3e 循环的时候才导致一起都被替换掉了。\x3c\/li\x3e\n\x3cli\x3e用 \x3ccode\x3efor in\x3c\/code\x3e 循环完全没必要，能不用 \x3ccode\x3efor in\x3c\/code\x3e 尽量不要用 \x3ccode\x3efor in\x3c\/code\x3e，\x3ccode\x3efor in\x3c\/code\x3e 会遍历自身以及原型链所有的属性。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e志钦童鞋：\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var str = \x26quot;\x22{{\x22name\x22}}\x22很厉害，才\x22{{\x22age\x22}}\x22岁\x26quot;;\nvar str2 = \x26quot;\x22{{\x22name\x22}}\x22很厉name害，才\x22{{\x22age\x22}}\x22岁\x22{{\x22name\x22}}\x22\x26quot;;\n\nvar obj = {name: \x27周杰伦\x27, age: 15};\nfunction fun(str, obj) {\n    var arr;\n    arr = str.match(\/\x22{{\x22[a-zA-Z\\d]\x2b\x22}}\x22\/g);\n    for(var i=0;i\x3carr.length;i\x2b\x2b){\n        arr[i] = arr[i].replace(\/\x22{{\x22|\x22}}\x22\/g,\x27\x27);\n        str = str.replace(\x27\x22{{\x22\x27\x2barr[i]\x2b\x27\x22}}\x22\x27,obj[arr[i]]);\n    }\n    return str;\n}\nconsole.log(fun(str,obj));\nconsole.log(fun(str2,obj));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e str = \x3cspan class=\x22hljs-string\x22\x3e\x22\x22{{\x22name\x22}}\x22很厉害，才\x22{{\x22age\x22}}\x22岁\x22\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e str2 = \x3cspan class=\x22hljs-string\x22\x3e\x22\x22{{\x22name\x22}}\x22很厉name害，才\x22{{\x22age\x22}}\x22岁\x22{{\x22name\x22}}\x22\x22\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e obj = {\x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27周杰伦\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3eage\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e15\x3c\/span\x3e};\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efun\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3estr, obj\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e arr;\n    arr = str.match(\x3cspan class=\x22hljs-regexp\x22\x3e\/\x22{{\x22[a-zA-Z\\d]\x2b\x22}}\x22\/g\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;i\x26lt;arr.length;i\x2b\x2b){\n        arr[i] = arr[i].replace(\x3cspan class=\x22hljs-regexp\x22\x3e\/\x22{{\x22|\x22}}\x22\/g\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e);\n        str = str.replace(\x3cspan class=\x22hljs-string\x22\x3e\x27\x22{{\x22\x27\x3c\/span\x3e\x2barr[i]\x2b\x3cspan class=\x22hljs-string\x22\x3e\x27\x22}}\x22\x27\x3c\/span\x3e,obj[arr[i]]);\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e str;\n}\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(fun(str,obj));\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(fun(str2,obj));\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e思路是正确的，知道最后要替换的是 \x3ccode\x3e\x22{{\x22name\x22}}\x22\x3c\/code\x3e 和 \x3ccode\x3e\x22{{\x22age\x22}}\x22\x3c\/code\x3e 整体，而不是像二月童鞋那样最后去替换 \x3ccode\x3ename\x3c\/code\x3e，所有跑起来肯定没问题，实现是实现了但是感觉有点那个，我们要探讨的是一行代码也就是代码越少越好。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e小维童鞋：\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function a(str, obj) {\n  var str1 = str;\n  for (var key in obj) {\n    var re = new RegExp(\x26quot;\x22{{\x22\x26quot; \x2b key \x2b \x26quot;\x22}}\x22\x26quot;, \x26quot;g\x26quot;);\n    str1 = str1.replace(re, obj[key]);\n  }\n  console.log(str1);\n}\nconst str = \x26quot;\x22{{\x22name\x22}}\x22很厉name害\x22{{\x22name\x22}}\x22，才\x22{{\x22age\x22}}\x22岁\x26quot;;\nconst obj = { name: \x26quot;jawil\x26quot;, age: \x26quot;15\x26quot; };\na(str, obj);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ea\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3estr, obj\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e str1 = str;\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e key \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e obj) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e re = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eRegExp\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22\x22{{\x22\x22\x3c\/span\x3e \x2b key \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22\x22}}\x22\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22g\x22\x3c\/span\x3e);\n    str1 = str1.replace(re, obj[key]);\n  }\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(str1);\n}\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e str = \x3cspan class=\x22hljs-string\x22\x3e\x22\x22{{\x22name\x22}}\x22很厉name害\x22{{\x22name\x22}}\x22，才\x22{{\x22age\x22}}\x22岁\x22\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e obj = { \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22jawil\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3eage\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2215\x22\x3c\/span\x3e };\na(str, obj);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e实现的已经简单明了了，就是把 \x3ccode\x3eobj\x3c\/code\x3e 的 \x3ccode\x3ekey\x3c\/code\x3e 值遍历，然后拼成 \x3ccode\x3e\x22{{\x22key\x22}}\x22\x3c\/code\x3e，最后用 \x3ccode\x3eobj[key]\x3c\/code\x3e 也就是 \x3ccode\x3evalue\x3c\/code\x3e 把 \x3ccode\x3e\x22{{\x22key\x22}}\x22\x3c\/code\x3e 整个给替换了，思路很好，跟我最初的版本一个样。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e我的实现：\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function parseString(str, obj) {\n  Object.keys(obj).forEach(key =\x3e {\n    str = str.replace(new RegExp(`\x22{{\x22${key\x22}}\x22}`,\x27g\x27), obj[key]);\n  });\n  return str;\n}\nconst str = \x26quot;\x22{{\x22name\x22}}\x22很厉name害\x22{{\x22name\x22}}\x22，才\x22{{\x22age\x22}}\x22岁\x26quot;;\nconst obj = { name: \x26quot;jawil\x26quot;, age: \x26quot;15\x26quot; };\nconsole.log(parseString(str, obj));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eparseString\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3estr, obj\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.keys(obj).forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ekey\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    str = str.replace(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eRegExp\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e`\x22{{\x22\x3cspan class=\x22hljs-subst\x22\x3e${key}\x3c\/span\x3e\x22}}\x22`\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27g\x27\x3c\/span\x3e), obj[key]);\n  });\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e str;\n}\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e str = \x3cspan class=\x22hljs-string\x22\x3e\x22\x22{{\x22name\x22}}\x22很厉name害\x22{{\x22name\x22}}\x22，才\x22{{\x22age\x22}}\x22岁\x22\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e obj = { \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22jawil\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3eage\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2215\x22\x3c\/span\x3e };\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(parseString(str, obj));\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其实这里还是有些问题的，首先我没用 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Statements\/for...in\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3efor...in\x3c\/code\x3e\x3c\/a\x3e 循环就是为了考虑不必要的循环，因为 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Statements\/for...in\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3efor...in\x3c\/code\x3e\x3c\/a\x3e 循环会遍历原型链所有的可枚举属性，造成不必要的循环。\x3c\/p\x3e\n\x3cp\x3e我们可以简单看一个例子，看看 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Statements\/for...in\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3efor...in\x3c\/code\x3e\x3c\/a\x3e的可怕性。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Chrome v63\nconst div = document.createElement(\x27div\x27);\nlet m = 0;\nfor (let k in div) {\n  m\x2b\x2b;\n}\nlet n = 0;\nconsole.log(m); \/\/ 231\nconsole.log(Object.keys(div).length); \/\/ 0\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Chrome v63\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e div = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e m = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e k \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e div) {\n  m\x2b\x2b;\n}\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e n = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(m); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 231\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.keys(div).length); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 0\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e一个 DOM 节点属性竟然有这么多的属性，列举这个例子只是让大家看到 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Statements\/for...in\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3efor in\x3c\/code\x3e\x3c\/a\x3e 遍历的效率问题，不要轻易用 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Statements\/for...in\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3efor in\x3c\/code\x3e\x3c\/a\x3e循环，通过这个 \x3ccode\x3eDOM\x3c\/code\x3e 节点之多也可以一定程度了解到 \x3ccode\x3eReact \x3c\/code\x3e的 \x3ccode\x3eVirtual DOM\x3c\/code\x3e 的思想和优越性。\x3c\/p\x3e\n\x3cp\x3e除了用 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Statements\/for...in\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3efor in\x3c\/code\x3e\x3c\/a\x3e 循环获取 \x3ccode\x3eobj\x3c\/code\x3e 的 \x3ccode\x3ekey\x3c\/code\x3e 值，还可以用 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Object\/keys\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eObject.key()\x3c\/code\x3e\x3c\/a\x3e 获取，\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Object\/getOwnPropertyNames\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eObject.getOwnPropertyNames()\x3c\/code\x3e\x3c\/a\x3e 以及 \x3ccode\x3eReflect.ownKeys()\x3c\/code\x3e也可以获取，那么这几种有啥区别呢？这里就简单说一下他们的一些区别。\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Statements\/for...in\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3efor...in\x3c\/code\x3e\x3c\/a\x3e循环：会遍历对象自身的属性，以及原型属性，\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Statements\/for...in\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3efor...in\x3c\/code\x3e\x3c\/a\x3e 循环只遍历可枚举(不包括 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Object\/defineProperty\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eenumerable\x3c\/code\x3e\x3c\/a\x3e为 \x3ccode\x3efalse\x3c\/code\x3e )属性。像 \x3ccode\x3eArray\x3c\/code\x3e 和 \x3ccode\x3eObject\x3c\/code\x3e 使用内置构造函数所创建的对象都会继承自 \x3ccode\x3eObject.prototype\x3c\/code\x3e 和 \x3ccode\x3eString.prototype\x3c\/code\x3e 的不可枚举属性;\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Object\/keys\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eObject.key()\x3c\/code\x3e\x3c\/a\x3e：可以得到自身可枚举的属性,但得不到原型链上的属性;\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Object\/getOwnPropertyNames\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eObject.getOwnPropertyNames()\x3c\/code\x3e\x3c\/a\x3e：可以得到自身所有的属性(包括不可枚举),但得不到原型链上的属性, Symbols 属性也得不到.\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Reflect\/ownKeys\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eReflect.ownKeys\x3c\/code\x3e\x3c\/a\x3e：该方法用于返回对象的所有属性，基本等同于 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Object\/getOwnPropertyNames\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eObject.getOwnPropertyNames()\x3c\/code\x3e\x3c\/a\x3e 与 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Object\/getOwnPropertySymbols\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eObject.getOwnPropertySymbols\x3c\/code\x3e\x3c\/a\x3e 之和。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e上面说的可能比较抽象，不够直观。可以看个我写的 \x3ccode\x3eDEMO\x3c\/code\x3e，一切简单明鸟。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const parent = {\n  a: 1,\n  b: 2,\n  c: 3\n};\nconst child = {\n  d: 4,\n  e: 5,\n  [Symbol()]: 6\n};\nchild.__proto__ = parent;\nObject.defineProperty(child, \x26quot;d\x26quot;, { enumerable: false });\n\nfor (var attr in child) {\n  console.log(\x26quot;for...in:\x26quot;, attr);\/\/ a,b,c,e\n}\nconsole.log(\x26quot;Object.keys:\x26quot;, Object.keys(child));\/\/ [ \x27e\x27 ]\nconsole.log(\x26quot;Object.getOwnPropertyNames:\x26quot;, Object.getOwnPropertyNames(child)); \/\/ [ \x27d\x27, \x27e\x27 ]\nconsole.log(\x26quot;Reflect.ownKeys:\x26quot;, Reflect.ownKeys(child)); \/\/  [ \x27d\x27, \x27e\x27, Symbol() ]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e parent = {\n  \x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eb\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ec\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\n};\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e child = {\n  \x3cspan class=\x22hljs-attr\x22\x3ed\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ee\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e,\n  [\x3cspan class=\x22hljs-built_in\x22\x3eSymbol\x3c\/span\x3e()]: \x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e\n};\nchild.__proto__ = parent;\n\x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.defineProperty(child, \x3cspan class=\x22hljs-string\x22\x3e\x22d\x22\x3c\/span\x3e, { \x3cspan class=\x22hljs-attr\x22\x3eenumerable\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e });\n\n\x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e attr \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e child) {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22for...in:\x22\x3c\/span\x3e, attr);\x3cspan class=\x22hljs-comment\x22\x3e\/\/ a,b,c,e\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22Object.keys:\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.keys(child));\x3cspan class=\x22hljs-comment\x22\x3e\/\/ [ \x27e\x27 ]\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22Object.getOwnPropertyNames:\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.getOwnPropertyNames(child)); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ [ \x27d\x27, \x27e\x27 ]\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22Reflect.ownKeys:\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3eReflect\x3c\/span\x3e.ownKeys(child)); \x3cspan class=\x22hljs-comment\x22\x3e\/\/  [ \x27d\x27, \x27e\x27, Symbol() ]\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e最后实现\x3c\/h3\x3e\n\x3cp\x3e上面的实现其实已经很简洁了，但是还是有些不完美的地方，通过 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMDN\x3c\/a\x3e 首先我们先了解一下 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/String\/replace\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereplace\x3c\/a\x3e 的用法。\x3c\/p\x3e\n\x3cp\x3e通过文档里面写的 \x3ccode\x3estr.replace(regexp|substr, newSubStr|function)\x3c\/code\x3e ，我们可以发现  \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/String\/replace\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereplace\x3c\/a\x3e 方法可以传入 \x3ccode\x3efunction\x3c\/code\x3e 回调函数，\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3efunction (replacement)\x3c\/code\x3e 一个用来创建新子字符串的函数，该函数的返回值将替换掉第一个参数匹配到的结果。参考这个\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/String\/replace#%E6%8C%87%E5%AE%9A%E4%B8%80%E4%B8%AA%E5%87%BD%E6%95%B0%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e指定一个函数作为参数\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e有了这句话，其实就很好实现了，先看看具体代码再做下一步分析。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function render(template, context) {\n  return template.replace(\/\\{\\{(.*?)\\}\\}\/g, (match, key) =\x3e context[key]);\n}\nconst template = \x26quot;\x22{{\x22name\x22}}\x22很厉name害，才\x22{{\x22age\x22}}\x22岁\x26quot;;\nconst context = { name: \x26quot;jawil\x26quot;, age: \x26quot;15\x26quot; };\nconsole.log(render(template, context));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erender\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etemplate, context\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e template.replace(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\{\\{(.*?)\\}\\}\/g\x3c\/span\x3e, (match, key) =\x26gt; context[key]);\n}\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e template = \x3cspan class=\x22hljs-string\x22\x3e\x22\x22{{\x22name\x22}}\x22很厉name害，才\x22{{\x22age\x22}}\x22岁\x22\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e context = { \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22jawil\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3eage\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2215\x22\x3c\/span\x3e };\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(render(template, context));\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以对照上面文档的话来做分析：\x3cstrong\x3e该函数的返回值(\x3ccode\x3eobj[key]=jawil\x3c\/code\x3e)将替换掉第一个参数(\x3ccode\x3ematch==\x22{{\x22name\x22}}\x22\x3c\/code\x3e)匹配到的结果。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e简单分析一下：\x3ccode\x3e.*?\x3c\/code\x3e 是正则固定搭配用法，表示\x3ca href=\x22http:\/\/blog.csdn.net\/lxcnn\/article\/details\/4756030\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e非贪婪匹配\x3c\/a\x3e模式，尽可能匹配少的，什么意思呢？举个简单的例子。\x3c\/p\x3e\n\x3cp\x3e先看一个例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22源字符串：aa\x3cdiv\x3etest1\x3c\/div\x3ebb\x3cdiv\x3etest2\x3c\/div\x3ecc\n\n正则表达式一：\x3cdiv\x3e.*\x3c\/div\x3e\n\n匹配结果一：\x3cdiv\x3etest1\x3c\/div\x3ebb\x3cdiv\x3etest2\x3c\/div\x3e\n\n正则表达式二：\x3cdiv\x3e.*?\x3c\/div\x3e\n\n匹配结果二：\x3cdiv\x3etest1\x3c\/div\x3e（这里指的是一次匹配结果，不使用\/g，所以没包括\x3cdiv\x3etest2\x3c\/div\x3e）\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs applescript\x22\x3e\x3ccode\x3e源字符串：aa\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;test1\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;bb\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;test2\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;cc\n\n正则表达式一：\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;.*\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n\n匹配结果一：\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;test1\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;bb\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;test2\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n\n正则表达式二：\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;.*?\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n\n匹配结果二：\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;test1\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;（这里指的是一次匹配结果，不使用\/g，所以没包括\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;test2\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;）\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e根据上面的例子，从匹配行为上分析一下，什是\x3ca href=\x22http:\/\/blog.csdn.net\/lxcnn\/article\/details\/4756030\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e贪婪与非贪婪匹配\x3c\/a\x3e模式。\x3c\/p\x3e\n\x3cp\x3e利用\x3ca href=\x22http:\/\/blog.csdn.net\/lxcnn\/article\/details\/4756030\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e非贪婪匹配\x3c\/a\x3e模就能匹配到所有的\x3ccode\x3e\x22{{\x22name\x22}}\x22\x3c\/code\x3e，\x3ccode\x3e\x22{{\x22age\x22}}\x22\x3c\/code\x3e，上面的也说到过\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000004429477\x22\x3e正则分组\x3c\/a\x3e，分组匹配到的就是 \x3ccode\x3ename\x3c\/code\x3e，也就是 \x3ccode\x3efunction\x3c\/code\x3e 的第二个参数 \x3ccode\x3ekey\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e所以这行代码的意思就很清楚，正则匹配到\x3ccode\x3e\x22{{\x22name\x22}}\x22\x3c\/code\x3e，分组获取 \x3ccode\x3ename\x3c\/code\x3e，然后把 \x3ccode\x3e\x22{{\x22name\x22}}\x22\x3c\/code\x3e 替换成  \x3ccode\x3eobj[name](jawil)\x3c\/code\x3e。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e当然后来发现还有一个小问题，如果有空格的话就会匹配失败，类似这种写法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const template = \x26quot;\x22{{\x22name   \x22}}\x22很厉name害，才\x22{{\x22age   \x22}}\x22岁\x26quot;;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e template = \x3cspan class=\x22hljs-string\x22\x3e\x22\x22{{\x22name   \x22}}\x22很厉name害，才\x22{{\x22age   \x22}}\x22岁\x22\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e所以在上面的基础上还要去掉空格，其实也很简单，用正则或者 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/String\/Trim\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eString.prototype.trim()\x3c\/code\x3e\x3c\/a\x3e 方法都行。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function render(template, context) {\n  return template.replace(\/\\{\\{(.*?)\\}\\}\/g, (match, key) =\x3e context[key.trim()]);\n}\nconst template = \x26quot;\x22{{\x22name   \x22}}\x22很厉name害，才\x22{{\x22age   \x22}}\x22岁\x26quot;;\nconst context = { name: \x26quot;jawil\x26quot;, age: \x26quot;15\x26quot; };\nconsole.log(render(template, context));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erender\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etemplate, context\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e template.replace(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\{\\{(.*?)\\}\\}\/g\x3c\/span\x3e, (match, key) =\x26gt; context[key.trim()]);\n}\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e template = \x3cspan class=\x22hljs-string\x22\x3e\x22\x22{{\x22name   \x22}}\x22很厉name害，才\x22{{\x22age   \x22}}\x22岁\x22\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e context = { \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22jawil\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3eage\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2215\x22\x3c\/span\x3e };\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(render(template, context));\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e将函数挂到 String 的原型链，得到最终版本\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e甚至，我们可以通过修改原型链，实现一些很酷的效果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22String.prototype.render = function (context) {\n  return this.replace(\/\\{\\{(.*?)\\}\\}\/g, (match, key) =\x3e context[key.trim()]);\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e.prototype.render = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3econtext\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.replace(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\{\\{(.*?)\\}\\}\/g\x3c\/span\x3e, (match, key) =\x26gt; context[key.trim()]);\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果{}中间不是数字，则{}本身不需要转义，所以最终最简洁的代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22String.prototype.render = function (context) {\n  return this.replace(\/\x22{{\x22(.*?)\x22}}\x22\/g, (match, key) =\x3e context[key.trim()]);\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e.prototype.render = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3econtext\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.replace(\x3cspan class=\x22hljs-regexp\x22\x3e\/\x22{{\x22(.*?)\x22}}\x22\/g\x3c\/span\x3e, (match, key) =\x26gt; context[key.trim()]);\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e之后，我们便可以这样调用啦：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;\x22{{\x22name\x22}}\x22很厉name害，才\x22{{\x22 age  \x22}}\x22岁\x26quot;.render({ name: \x26quot;jawil\x26quot;, age: \x26quot;15\x26quot; });\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22\x22{{\x22name\x22}}\x22很厉name害，才\x22{{\x22 age  \x22}}\x22岁\x22\x3c\/span\x3e.render({ \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22jawil\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3eage\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2215\x22\x3c\/span\x3e });\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e收获\x3c\/h3\x3e\n\x3cp\x3e通过一个小小的模板字符串的实现，领悟到要把一个功能实现不难，要把做到完美真是难上加难，需要对基础掌握牢固，有一定的沉淀，然后不断地打磨才能比较优雅的实现，通过由一个很小的点往往可以拓展出很多的知识点。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e一张图快速入门正则表达式：\x3c\/h3\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000013516227\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000013516227\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>一行代码实现一个简单的模板字符串替换</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000013516128">https://segmentfault.com/a/1190000013516128</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/4u9738r3aa6/" target="_blank">https://alili.tech/archive/4u9738r3aa6/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>