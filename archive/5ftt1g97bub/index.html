<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="谈一谈移动端1px的问题"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>谈一谈移动端1px的问题 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/5ftt1g97bub/",
				"appid": "1613049289050283", 
				"title": "谈一谈移动端1px的问题 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-29T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/3hj8boa8qn4/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/que666q2z7/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f5ftt1g97bub%2f&text=%e8%b0%88%e4%b8%80%e8%b0%88%e7%a7%bb%e5%8a%a8%e7%ab%af1px%e7%9a%84%e9%97%ae%e9%a2%98"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f5ftt1g97bub%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f5ftt1g97bub%2f&text=%e8%b0%88%e4%b8%80%e8%b0%88%e7%a7%bb%e5%8a%a8%e7%ab%af1px%e7%9a%84%e9%97%ae%e9%a2%98"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f5ftt1g97bub%2f&title=%e8%b0%88%e4%b8%80%e8%b0%88%e7%a7%bb%e5%8a%a8%e7%ab%af1px%e7%9a%84%e9%97%ae%e9%a2%98"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f5ftt1g97bub%2f&is_video=false&description=%e8%b0%88%e4%b8%80%e8%b0%88%e7%a7%bb%e5%8a%a8%e7%ab%af1px%e7%9a%84%e9%97%ae%e9%a2%98"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e8%b0%88%e4%b8%80%e8%b0%88%e7%a7%bb%e5%8a%a8%e7%ab%af1px%e7%9a%84%e9%97%ae%e9%a2%98&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f5ftt1g97bub%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f5ftt1g97bub%2f&title=%e8%b0%88%e4%b8%80%e8%b0%88%e7%a7%bb%e5%8a%a8%e7%ab%af1px%e7%9a%84%e9%97%ae%e9%a2%98"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f5ftt1g97bub%2f&title=%e8%b0%88%e4%b8%80%e8%b0%88%e7%a7%bb%e5%8a%a8%e7%ab%af1px%e7%9a%84%e9%97%ae%e9%a2%98"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f5ftt1g97bub%2f&title=%e8%b0%88%e4%b8%80%e8%b0%88%e7%a7%bb%e5%8a%a8%e7%ab%af1px%e7%9a%84%e9%97%ae%e9%a2%98"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f5ftt1g97bub%2f&title=%e8%b0%88%e4%b8%80%e8%b0%88%e7%a7%bb%e5%8a%a8%e7%ab%af1px%e7%9a%84%e9%97%ae%e9%a2%98"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">谈一谈移动端1px的问题</h1><div class="meta"><div class="postdate"><time datetime="2018-12-29" itemprop="datePublished">2018-12-29</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2\x3e起因\x3c\/h2\x3e\n\x3cp\x3e最近一个月都在准备校招，所以没什么时间写博客。今天想写的问题来自于网易一面的时候，面试官问我如何在移动端的页面上画一条1px的线。这个问题我模糊地记得之前看过相关文章，但是我清楚地记得当时自己脑子一片空白。是的，一面挂了，但是这个问题一直在我回来的路上不断想起，所以今天我就要解决这个问题，来看看有什么解决方案吧～\x3c\/p\x3e\n\x3ch2\x3e动态改变viewport的缩放\x3c\/h2\x3e\n\x3cp\x3e这是淘宝的flexible提出的解决方案，其核心就是根据window.devicePixelRatio（dpr）的值动态改变viewport的缩放，核心代码如下（有删减）：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22javascript\x22\x3eif (!dpr \x26amp;\x26amp; !scale) {\n    var isAndroid = win.navigator.appVersion.match(\/android\/gi);\n    var isIPhone = win.navigator.appVersion.match(\/iphone\/gi);\n    var devicePixelRatio = win.devicePixelRatio;\n    if (isIPhone) {\n        \/\/ iOS下，对于2和3的屏，用2倍的方案，其余的用1倍方案\n        if (devicePixelRatio \x26gt;= 3 \x26amp;\x26amp; (!dpr || dpr \x26gt;= 3)) {                \n            dpr = 3;\n        } else if (devicePixelRatio \x26gt;= 2 \x26amp;\x26amp; (!dpr || dpr \x26gt;= 2)){\n            dpr = 2;\n        } else {\n            dpr = 1;\n        }\n    } else {\n        \/\/ 其他设备下，仍旧使用1倍的方案\n        dpr = 1;\n    }\n    scale = 1 \/ dpr;\n}\n\nif (!metaEl) {\n    metaEl = doc.createElement(\x27meta\x27);\n    metaEl.setAttribute(\x27name\x27, \x27viewport\x27);\n    metaEl.setAttribute(\x27content\x27, \x27initial-scale=\x27 \x2b scale \x2b \x27, maximum-scale=\x27 \x2b scale \x2b \x27, minimum-scale=\x27 \x2b scale \x2b \x27, user-scalable=no\x27);\n    if (docEl.firstElementChild) {\n        docEl.firstElementChild.appendChild(metaEl);\n    } else {\n        var wrap = doc.createElement(\x27div\x27);\n        wrap.appendChild(metaEl);\n        doc.write(wrap.innerHTML);\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个方案只对iOS的Retina屏幕做了处理，而没有管安卓的Retina屏幕，原因可以看《\x3ca href=\x22https:\/\/www.w3cplus.com\/css\/fix-1px-for-retina.html\x22 rel=\x22nofollow noreferrer\x22\x3e再谈Retina下1px的解决方案\x3c\/a\x3e》这篇文章。使用了flexible之后直接写1px就能实现效果，但是最新的2.0好像放弃了这种缩放的方案，对于1px的处理则变成了border-image或者background-image，详细的可以看《\x3ca href=\x22https:\/\/www.w3cplus.com\/css\/vw-for-layout.html\x22 rel=\x22nofollow noreferrer\x22\x3e再聊移动端页面的适配\x3c\/a\x3e》。\x3c\/p\x3e\n\x3cp\x3e这里再简单谈一下这种viewport缩放的原理：\x3c\/p\x3e\n\x3cp\x3e首先一开始写移动端的时候，我是直接加一个meta标签\x3ccode\x3e \x26lt;meta name=viewport content=\x22width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no\x22\x26gt;\x3c\/code\x3e，这个meta标签使得页面宽度等于设备宽度，页面的缩放默认为1，且用户不能缩放，后来看到一篇文章讲viewport计算是这样的：\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eviewport的默认宽度是980px；设置了initial-scale则宽度是device-width\/initial-scale；设置了width则宽度等于width的值；同时设置了initial-scale和width则宽度取两者中较大的一个。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e上面的结论我在PC端谷歌浏览器的设备模拟器里证实了有效，但是安卓和iOS真机并没有试过。\x3c\/p\x3e\n\x3ch2\x3etransform: scale(0.5)\x3c\/h2\x3e\n\x3cp\x3e这个方案也是WeUI正在用的，核心思想是使用transform的scale来整体缩放，如果你想画一条1px的线，就可以直接用\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22css\x22\x3ediv {\n    height: 1px;\n      background: #000;\n      transform: scaleY(0.5);\n      transform-origin: 0 0;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e理论上在dpr为2时就是scaleY(0.5)，在dpr为3时就是scaleY(0.333)，但是我注意到WeUI并没有针对其他dpr的做特殊处理，可能是因为在iPhone6（dpr=2）和iPhone6 Plus（dpr=3）中看起来差别不大吧。\x3c\/p\x3e\n\x3cp\x3e如果你想给一个元素加一个1px的边框可以利用到伪元素，在这个方案下边框加圆角也很容易实现，具体代码如下：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22css\x22\x3ediv:after {\n  content: \x22 \x22;\n  width: 78px;\n  height: 38px;\n  border-radius: 4px;\n  border: 1px solid #000;\n  transform: scale(0.5, 0.5);\n  transform-origin: 0 0;\n  position: absolute;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2\x3e其他方案\x3c\/h2\x3e\n\x3ch3\x3eborder-image\x3c\/h3\x3e\n\x3cp\x3e这种是AlloyTeam的《\x3ca href=\x22https:\/\/github.com\/AlloyTeam\/Mars\/blob\/master\/solutions\/border-1px.md\x22 rel=\x22nofollow noreferrer\x22\x3eCSS 实现类似原生效果的 1px 边框\x3c\/a\x3e》这篇文章上看到的，代码写起来挺简单，但是要自己制作图片，而且圆角也不好弄，如果改了颜色就要对图片处理，所以不是很好的方案。\x3c\/p\x3e\n\x3ch3\x3ebox-shadow\x3c\/h3\x3e\n\x3cp\x3e这个颜色不好弄，所以效果也不是很好。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22css\x22\x3ediv {\n  border: none;\n  box-shadow: 0 1px 1px -1px rgba(0, 0, 0, 0.5);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3\x3e0.5px解决方案\x3c\/h3\x3e\n\x3cpre\x3e\x3ccode class=\x22css\x22\x3ediv {\n    border: 1px solid #000;\n}\n\n@media (-webkit-min-device-pixel-ratio: 2) {\n  div {\n    border: .5px solid #000;\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e安卓和iOS7之前版本碰到0.5px直接就解析成0px了，但是这一特性也是可以利用的，在最新的flexible中就有对0.5px进行判断的代码：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22javascript\x22\x3e\/\/ detect 0.5px supports\nif (dpr \x26gt;= 2) {\n  var fakeBody = document.createElement(\x27body\x27)\n  var testElement = document.createElement(\x27div\x27)\n  testElement.style.border = \x27.5px solid transparent\x27\n  fakeBody.appendChild(testElement)\n  docEl.appendChild(fakeBody)\n  if (testElement.offsetHeight === 1) {\n    docEl.classList.add(\x27hairlines\x27)\n  }\n  docEl.removeChild(fakeBody)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2\x3e小结\x3c\/h2\x3e\n\x3cp\x3e这篇文章从国庆开始断断续续地写，到最后一天总算是写完了，这段时间整个人心态经历了一些变化，主要表现在对待技术比以前更加踏实了，无论如何希望自己能坚持写博客，坚持学习前端，相信总能找到一个理想的工作的，加油！\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>谈一谈移动端1px的问题</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011466832">https://segmentfault.com/a/1190000011466832</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/5ftt1g97bub/" target="_blank">https://alili.tech/archive/5ftt1g97bub/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>