<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="IoT实时数据可视化方案：Grafana&#43;InfluxDB&#43;Telegraf&#43;MQTT协议&#43;Windows 10"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>IoT实时数据可视化方案：Grafana&#43;InfluxDB&#43;Telegraf&#43;MQTT协议&#43;Windows 10 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/5rtixjjwexw/",
				"appid": "1613049289050283", 
				"title": "IoT实时数据可视化方案：Grafana&#43;InfluxDB&#43;Telegraf&#43;MQTT协议&#43;Windows 10 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-21T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/5fxzcoakai2/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/fvy8sdh94e/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f5rtixjjwexw%2f&text=IoT%e5%ae%9e%e6%97%b6%e6%95%b0%e6%8d%ae%e5%8f%af%e8%a7%86%e5%8c%96%e6%96%b9%e6%a1%88%ef%bc%9aGrafana%2bInfluxDB%2bTelegraf%2bMQTT%e5%8d%8f%e8%ae%ae%2bWindows%2010"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f5rtixjjwexw%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f5rtixjjwexw%2f&text=IoT%e5%ae%9e%e6%97%b6%e6%95%b0%e6%8d%ae%e5%8f%af%e8%a7%86%e5%8c%96%e6%96%b9%e6%a1%88%ef%bc%9aGrafana%2bInfluxDB%2bTelegraf%2bMQTT%e5%8d%8f%e8%ae%ae%2bWindows%2010"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f5rtixjjwexw%2f&title=IoT%e5%ae%9e%e6%97%b6%e6%95%b0%e6%8d%ae%e5%8f%af%e8%a7%86%e5%8c%96%e6%96%b9%e6%a1%88%ef%bc%9aGrafana%2bInfluxDB%2bTelegraf%2bMQTT%e5%8d%8f%e8%ae%ae%2bWindows%2010"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f5rtixjjwexw%2f&is_video=false&description=IoT%e5%ae%9e%e6%97%b6%e6%95%b0%e6%8d%ae%e5%8f%af%e8%a7%86%e5%8c%96%e6%96%b9%e6%a1%88%ef%bc%9aGrafana%2bInfluxDB%2bTelegraf%2bMQTT%e5%8d%8f%e8%ae%ae%2bWindows%2010"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=IoT%e5%ae%9e%e6%97%b6%e6%95%b0%e6%8d%ae%e5%8f%af%e8%a7%86%e5%8c%96%e6%96%b9%e6%a1%88%ef%bc%9aGrafana%2bInfluxDB%2bTelegraf%2bMQTT%e5%8d%8f%e8%ae%ae%2bWindows%2010&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f5rtixjjwexw%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f5rtixjjwexw%2f&title=IoT%e5%ae%9e%e6%97%b6%e6%95%b0%e6%8d%ae%e5%8f%af%e8%a7%86%e5%8c%96%e6%96%b9%e6%a1%88%ef%bc%9aGrafana%2bInfluxDB%2bTelegraf%2bMQTT%e5%8d%8f%e8%ae%ae%2bWindows%2010"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f5rtixjjwexw%2f&title=IoT%e5%ae%9e%e6%97%b6%e6%95%b0%e6%8d%ae%e5%8f%af%e8%a7%86%e5%8c%96%e6%96%b9%e6%a1%88%ef%bc%9aGrafana%2bInfluxDB%2bTelegraf%2bMQTT%e5%8d%8f%e8%ae%ae%2bWindows%2010"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f5rtixjjwexw%2f&title=IoT%e5%ae%9e%e6%97%b6%e6%95%b0%e6%8d%ae%e5%8f%af%e8%a7%86%e5%8c%96%e6%96%b9%e6%a1%88%ef%bc%9aGrafana%2bInfluxDB%2bTelegraf%2bMQTT%e5%8d%8f%e8%ae%ae%2bWindows%2010"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f5rtixjjwexw%2f&title=IoT%e5%ae%9e%e6%97%b6%e6%95%b0%e6%8d%ae%e5%8f%af%e8%a7%86%e5%8c%96%e6%96%b9%e6%a1%88%ef%bc%9aGrafana%2bInfluxDB%2bTelegraf%2bMQTT%e5%8d%8f%e8%ae%ae%2bWindows%2010"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">IoT实时数据可视化方案：Grafana&#43;InfluxDB&#43;Telegraf&#43;MQTT协议&#43;Windows 10</h1><div class="meta"><div class="postdate"><time datetime="2018-12-21" itemprop="datePublished">2018-12-21</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e为什么写这篇博客？\x3c\/h1\x3e\n\x3cul\x3e\n\x3cli\x3e最近被论文折磨的死去活来，实时数据可视化方案是我论文的题目。 每天都被这些技术玩弄于股掌之间，靠看文档延续生命和出成果。不得不说，做完这个论文可能以后不敢乱写readme了。 由此大胆推测大家的发量问题有都是看文档时产生的， 可见一个好的文档对开发人员有多么重要！！！ \x26nbsp;\x3c\/li\x3e\n\x3cli\x3e网络上关于windows系统下搭建从数据源到前端可视化工具Grafana的解决方案甚少，且适合我自己本身开发所需情况的方案就更加少了。 在翻阅大量官方文档，github issues以及英文博客后，终于得到了可运行的demo。把相关详细的配置过程记录下来，方便以后学习或工作复用并造福于有相似需求的朋友。 \x26nbsp;\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3e服务构架\x3c\/h1\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22IoT Simulator(publisher)----\x3e MQTT broker----\x3eTelegraf(subscriber)----\x3eInfluxDB----\x3eHosted Grafana(Cloud)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xl\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eI\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3eoT\x3c\/span\x3e Simulator(publisher)----\x26gt;\x3c\/span\x3e MQTT \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3ebroker\x3c\/span\x3e----\x26gt;\x3c\/span\x3eT\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3eelegraf\x3c\/span\x3e(subscriber)----\x26gt;\x3c\/span\x3eI\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3enfluxDB\x3c\/span\x3e----\x26gt;\x3c\/span\x3eHosted Grafana(Cloud)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012655664?w=862\x26amp;h=552\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012655664?w=862\x26amp;h=552\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3e配置安装流程\x3c\/h1\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e数据来源\x3c\/h2\x3e\n\x3cp\x3e数据来源在IoT Case下一般来自各个传感设备。 因为身边没有可用的传感器设备，于是在github上搜了个\x3ca href=\x22https:\/\/github.com\/acesinc\/json-data-generator\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e小工具\x3c\/a\x3e来模拟数据发射器。该工具可输出自定义的json格式数据，并且支持MQTT，HTTP（s)，Azure IoT hub, Kafka等主流协议\/工具，应用范围和场景广泛是我选择该工具的主要原因。 \x26nbsp; \x3cbr\x3e唯一的缺点是输出的json默认为object, 不支持对array of object json的扩展，在API config的时候可能会遇到一些工具只能识别array of json object 的情况（比如power bi的rest api)。   \x3cbr\x3e如果你的case中有使用真实的iot设备和通讯协议可自动忽略此part。   \x3cbr\x3e\x3cstrong\x3e安装和配置相关请参照readme\x3c\/strong\x3e \x26nbsp;\x3cbr\x3e在mySimConfigjson中对MQTT进行配置，语法参见[配置中使用的MQTT]\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 {\n            \x26quot;type\x26quot;: \x26quot;mqtt\x26quot;,\n            \x26quot;broker.server\x26quot;: \x26quot;tcp:\/\/localhost\x26quot;,\n            \x26quot;broker.port\x26quot;: 1883,\n            \x26quot;topic\x26quot;: \x26quot;sensors\/iot_simulator\x26quot;,\n            \x26quot;clientId\x26quot;: \x26quot;iot_simulator\x26quot;,\n            \x26quot;qos\x26quot;: 2\n        }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs json\x22\x3e\x3ccode\x3e {\n            \x3cspan class=\x22hljs-attr\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22mqtt\x22\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3e\x22broker.server\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22tcp:\/\/localhost\x22\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3e\x22broker.port\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1883\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3e\x22topic\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22sensors\/iot_simulator\x22\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3e\x22clientId\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22iot_simulator\x22\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3e\x22qos\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n        }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e使用以下命令开始模拟数据  \x3cbr\x3e\x3ccode\x3ejava -jar json-data-generator-1.3.1-SNAPSHOT.jar mySimConfig.json\x3c\/code\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e使用MQTT协议\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e什么是MQTT协议？\x3c\/h3\x3e\n\x3cp\x3eMQTT为MQ Telemetry Transport的缩写，该协议定义了在机器对机器或物联网环境下的通信规则。它采用发布\/订阅的模式传输数据，设计思想是在尽力保证一定程度的数据可达性及稳定性的同时，减少对网络带宽和设备资源的依赖。MQTT协议简洁且轻量，适用于低带宽，高延迟或不稳定的网络环境中的设备，同时也适用于带宽和电源受限的移动应用.  \x3cbr\x3eref:\x3ca href=\x22http:\/\/mqtt.org\/faq\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/mqtt.org\/faq\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e为什么使用MQTT协议？\x3c\/h3\x3e\n\x3cp\x3e在使用Power BI作为可视化方案时，曾成功使用REST API直接将数据源通过HTTP推送到POWER BI所提供的endpoint。因此在架构这套服务之初，我并没有打算使用MQTT作为数据传输协议。但经过一番研究后，在我的案例当中，发现使用HTTP协议有以下局限性：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e在Telegraf的input plugins中，和HTTP相关的插件有两个：一个是HTTP JSON，另一个是HTTP Listener（HTTP Response由于不符合个体案例没有做研究）； HTTP JSON主要通过向拥有数据的HTTP URLs发送请求，并从对应响应中的json中获取数据。由于我的IoT设备仅仅是一个模拟的数据发送器且并没有为其部署本地服务器或云端服务器，因此无法分配到URL地址和端口，同时另一个考虑是希望减少在部署服务器上花费的成本，更好的集中在可视化工具上的研究上。 因此这个插件并不适合我的情况；HTTP Listener主要监听HTTP POST上的消息。Telegraf可以作为代理服务器来处理原本通过InfluxDB HTTP API 上 \/write 写入的数据。听起来这个似乎深得我心，没有多余的学习成本---与使用POWER　BI时情景类似，可以将数据直接推入InfluxDB的API终端，然后设置Telegraf作为代理在写入数据库之前对数据流做process或aggregation的工作，使得数据变得更加具有可读性（meaningful）。简单粗暴快捷。唯一也是致命的缺点是如果使用HTTP Listener将仅支持\x3ca href=\x22https:\/\/docs.influxdata.com\/telegraf\/v1.5\/concepts\/data_formats_input\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eInfluxDB line protocol format\x3c\/a\x3e 作为数据写入格式。这就使得数据源的格式大大受限，数据输入格式解析的功能也相当于无法使用了，那么使用telegraf的意义就变得不那么大（对数据流进行格式解析和聚合）；\x3c\/li\x3e\n\x3cli\x3e我使用的IoT Simulator对MQTT协议有较为全面的支持，无需二次开发接口；\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3eref:\x3ca href=\x22https:\/\/docs.influxdata.com\/telegraf\/v1.5\/plugins\/inputs\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/docs.influxdata.com\/t...\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e配置中使用的MQTT\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e如何安装MQTT Broker: 参见\x3ca href=\x22http:\/\/www.steves-internet-guide.com\/install-mosquitto-broker\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这里\x3c\/a\x3e，以及\x3ca href=\x22https:\/\/sivatechworld.wordpress.com\/2015\/06\/11\/step-by-step-installing-and-configuring-mosquitto-with-windows-7\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这里\x3c\/a\x3e\n\x3c\/li\x3e\n\x3cli\x3ePublish\/Subscribe:The MQTT protocol is based on the principle of publishing messages and subscribing to topics, or \x22pub\/sub\x22. Multiple clients connect to a broker and subscribe to topics that they are interested in. Clients also connect to the broker and publish messages to topics. Many clients may subscribe to the same topics and do with the information as they please. The broker and MQTT act as a simple, common interface for everything to connect to. This means that you if you have clients that dump subscribed messages to a database, to Twitter, Cosm or even a simple text file, then it becomes very simple to add new sensors or other data input to a database, Twitter or so on.\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22                          \nMQTT client1(sub)---\x3eMQTT broker\x3c----MQTT Client2(pub)  \n                   (message center)   \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp;\n \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp;  ^\n                          |  \n                    MQTT client2(pub)  \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gcode\x22\x3e\x3ccode\x3e                          \nMQTT clie\x3cspan class=\x22hljs-symbol\x22\x3ent1\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e(sub)\x3c\/span\x3e---\x26gt;MQTT broker\x26lt;----MQTT Clie\x3cspan class=\x22hljs-symbol\x22\x3ent2\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e(pub)\x3c\/span\x3e  \n                   \x3cspan class=\x22hljs-comment\x22\x3e(message center)\x3c\/span\x3e   \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp;\n \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp; \x26nbsp;  ^\n                          |  \n                    MQTT clie\x3cspan class=\x22hljs-symbol\x22\x3ent2\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e(pub)\x3c\/span\x3e  \x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3eTopic setting: 话题可以被划分层级，用\/来表示具体层级结构。 例如： sensors\/COMPUTER_NAME\/temperature\/HARDDRIVE_NAME\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3etwo wildcards: # and \x2b  \x3cbr\x3e\x22\x2b\x22 for a single level of hierarchy，\x2b\/\x2b\/\x2b\/HARDDRIVE_NAME表示了包含上述例子的一个父集  \x3cbr\x3e\x22#\x22 for all remaining levels of hierarchy，sensors\/COMPUTER_NAME\/temperature\/# 表示了包含上述例子的一个父集\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3eQuality of Service: \x3cstrong\x3eHigher levels of QoS are more reliable, but involve higher latency and have higher bandwidth requirements.\x3c\/strong\x3e\n\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e0: The broker\/client will deliver the message once, with no confirmation.  \x3cbr\x3e1: The broker\/client will deliver the message at least once, with confirmation required.  \x3cbr\x3e2: The broker\/client will deliver the message exactly once by using a four-step handshake. \x26nbsp;\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3eDowngrade for QoS\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e消息订阅者允许在消息发布者制定的QoS级别上进行降级；例如mqtt_pub规定qos=2， 则mqtt_sub可以使qos=2 or 1 or 0；    \x3cbr\x3eref: \x3ca href=\x22https:\/\/mosquitto.org\/man\/mqtt-7.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/mosquitto.org\/man\/mqt...\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e配置Telegraf\x3c\/h2\x3e\n\x3cp\x3estep 1: 安装并解压telegraf （如果没有wget请自行下载（恕在下直言，windows简直就是个辣鸡）） \x26nbsp; \x26nbsp; \x26nbsp;\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012655665?w=885\x26amp;h=121\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012655665?w=885\x26amp;h=121\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3estep 2: 修改配置文件telegraf.conf（主要配置input，output\x26amp;processor plugins)       \x3cbr\x3e配置主要参见：[InfluxDB HTTP API和Hosted Grafana HTTPS 通讯的冲突问题]及[配置中使用的MQTT]   \x3cbr\x3eprocessor plugin的功能主要是打印从mqtt broker订阅的数据并显示在console中\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22[[outputs.influxdb]]\n  urls = [\x26quot;https:\/\/localhost:8086\x26quot;] # required\n  # The target database for metrics (telegraf will create it if not exists)\n  database = \x26quot;telegraf\x26quot; # required\n  precision = \x26quot;s\x26quot;\n ## Name of existing retention policy to write to.  Empty string writes to\n  ## the default retention policy.\n  retention_policy = \x26quot;\x26quot;\n  ## Write consistency (clusters only), can be: \x26quot;any\x26quot;, \x26quot;one\x26quot;, \x26quot;quorum\x26quot;, \x26quot;all\x26quot;\n  write_consistency = \x26quot;any\x26quot;\n\n  ## Write timeout (for the InfluxDB client), formatted as a string.\n  ## If not provided, will default to 5s. 0s means no timeout (not recommended).\n  timeout = \x26quot;5s\x26quot;\n  \n  [[inputs.mqtt_consumer]]\n  ## MQTT broker URLs to be used. The format should be scheme:\/\/host:port,\n  ## schema can be tcp, ssl, or ws.\n  servers = [\x26quot;tcp:\/\/localhost:1883\x26quot;]\n  ## MQTT QoS, must be 0, 1, or 2\n  qos = 2\n  ## Connection timeout for initial connection in seconds\n  connection_timeout = \x26quot;30s\x26quot;\n\n  ## Topics to subscribe to\n  topics = [\n    \x26quot;sensors\/iot_simulator\x26quot;\n  ]\n\n  # if true, messages that can\x27t be delivered while the subscriber is offline\n  # will be delivered when it comes back (such as on service restart).\n  # NOTE: if true, client_id MUST be set\n  persistent_session = false\n  # If empty, a random client ID will be generated.\n  client_id = \x26quot;\x26quot;\n\n  ## Optional SSL Config\n  # ssl_ca = \x26quot;\/etc\/telegraf\/ca.pem\x26quot;\n  # ssl_cert = \x26quot;\/etc\/telegraf\/cert.pem\x26quot;\n  # ssl_key = \x26quot;\/etc\/telegraf\/key.pem\x26quot;\n  ## Use SSL but skip chain \x26amp; host verification\n  insecure_skip_verify = true\n\n  ## Data format to consume.\n  ## Each data format has its own unique set of configuration options, read\n  ## more about them here:\n  ## https:\/\/github.com\/influxdata\/telegraf\/blob\/master\/docs\/DATA_FORMATS_INPUT.md\n  data_format = \x26quot;json\x26quot;\n  ## List of tag names to extract from top-level of JSON server response\n  tag_keys = [\n    \x26quot;equippment name\x26quot;,\n    \x26quot;timestamp\x26quot;\n  ]\n  \n[[inputs.exec]]\n  ## Commands array\n  commands = []\n#\x26quot;\/tmp\/test.sh\x26quot;, \x26quot;\/usr\/bin\/mycollector --foo=bar\x26quot;\n  ## measurement name suffix (for separating different commands)\n  name_suffix = \x26quot;mqtt_consumer\x26quot;\n\n  ## Data format to consume.\n  ## Each data format has its own unique set of configuration options, read\n  ## more about them here:\n  ## https:\/\/github.com\/influxdata\/telegraf\/blob\/master\/docs\/DATA_FORMATS_INPUT.md\n  data_format = \x26quot;json\x26quot;\n  \n  [[processors.printer]]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs nix\x22\x3e\x3ccode\x3e[[outputs.influxdb]]\n  \x3cspan class=\x22hljs-attr\x22\x3eurls\x3c\/span\x3e = [\x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/localhost:8086\x22\x3c\/span\x3e] \x3cspan class=\x22hljs-comment\x22\x3e# required\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e# The target database for metrics (telegraf will create it if not exists)\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3edatabase\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x22telegraf\x22\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e# required\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3eprecision\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x22s\x22\x3c\/span\x3e\n \x3cspan class=\x22hljs-comment\x22\x3e## Name of existing retention policy to write to.  Empty string writes to\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e## the default retention policy.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3eretention_policy\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e## Write consistency (clusters only), can be: \x22any\x22, \x22one\x22, \x22quorum\x22, \x22all\x22\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3ewrite_consistency\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x22any\x22\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-comment\x22\x3e## Write timeout (for the InfluxDB client), formatted as a string.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e## If not provided, will default to 5s. 0s means no timeout (not recommended).\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3etimeout\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x225s\x22\x3c\/span\x3e\n  \n  [[inputs.mqtt_consumer]]\n  \x3cspan class=\x22hljs-comment\x22\x3e## MQTT broker URLs to be used. The format should be scheme:\/\/host:port,\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e## schema can be tcp, ssl, or ws.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3eservers\x3c\/span\x3e = [\x3cspan class=\x22hljs-string\x22\x3e\x22tcp:\/\/localhost:1883\x22\x3c\/span\x3e]\n  \x3cspan class=\x22hljs-comment\x22\x3e## MQTT QoS, must be 0, 1, or 2\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3eqos\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e## Connection timeout for initial connection in seconds\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3econnection_timeout\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x2230s\x22\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-comment\x22\x3e## Topics to subscribe to\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3etopics\x3c\/span\x3e = [\n    \x3cspan class=\x22hljs-string\x22\x3e\x22sensors\/iot_simulator\x22\x3c\/span\x3e\n  ]\n\n  \x3cspan class=\x22hljs-comment\x22\x3e# if true, messages that can\x27t be delivered while the subscriber is offline\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e# will be delivered when it comes back (such as on service restart).\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e# \x3cspan class=\x22hljs-doctag\x22\x3eNOTE:\x3c\/span\x3e if true, client_id MUST be set\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3epersistent_session\x3c\/span\x3e = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e# If empty, a random client ID will be generated.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3eclient_id\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-comment\x22\x3e## Optional SSL Config\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e# ssl_ca = \x22\/etc\/telegraf\/ca.pem\x22\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e# ssl_cert = \x22\/etc\/telegraf\/cert.pem\x22\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e# ssl_key = \x22\/etc\/telegraf\/key.pem\x22\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e## Use SSL but skip chain \x26amp; host verification\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3einsecure_skip_verify\x3c\/span\x3e = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-comment\x22\x3e## Data format to consume.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e## Each data format has its own unique set of configuration options, read\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e## more about them here:\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e## https:\/\/github.com\/influxdata\/telegraf\/blob\/master\/docs\/DATA_FORMATS_INPUT.md\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3edata_format\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x22json\x22\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e## List of tag names to extract from top-level of JSON server response\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3etag_keys\x3c\/span\x3e = [\n    \x3cspan class=\x22hljs-string\x22\x3e\x22equippment name\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22timestamp\x22\x3c\/span\x3e\n  ]\n  \n[[inputs.exec]]\n  \x3cspan class=\x22hljs-comment\x22\x3e## Commands array\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3ecommands\x3c\/span\x3e = []\n\x3cspan class=\x22hljs-comment\x22\x3e#\x22\/tmp\/test.sh\x22, \x22\/usr\/bin\/mycollector --foo=bar\x22\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e## measurement name suffix (for separating different commands)\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3ename_suffix\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x22mqtt_consumer\x22\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-comment\x22\x3e## Data format to consume.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e## Each data format has its own unique set of configuration options, read\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e## more about them here:\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e## https:\/\/github.com\/influxdata\/telegraf\/blob\/master\/docs\/DATA_FORMATS_INPUT.md\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attr\x22\x3edata_format\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x22json\x22\x3c\/span\x3e\n  \n  [[processors.printer]]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3estep 3: 运行telegraf，运行前先开启数据模拟发射器和MQTT broker确保influxdb能订阅到稳定的数据流，否则influxdb有可能会报错监听不到数据写入。    \x3cbr\x3e\x3ccode\x3eto\\your\\dir: telegraf --config telegraf.conf\x3c\/code\x3e \x26nbsp;   \x3cbr\x3e由于配置了printer plugin，在telegraf正常运行的情况下可以看到数据流打印在console中  \x3cbr\x3estep 4: 检查数据是否已写入数据库 \x26nbsp; \x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012655679?w=1436\x26amp;h=826\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012655679?w=1436\x26amp;h=826\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3eref: \x3ca href=\x22https:\/\/docs.influxdata.com\/telegraf\/v1.5\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/docs.influxdata.com\/t...\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e配置InfluxDB\x3c\/h2\x3e\n\x3cp\x3einfluxDB作为数据和终端可视化工具之间的桥梁，角色尤为重要。influxDB作为一个time-series database非常适合实时IoT数据的存储。 配置influxdb的过程较为简单，主要解决的问题集中在从http到https协议转换问题。  \x3cbr\x3estep 1: 按照官网文档下载并解压influxdb   \x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012655666?w=848\x26amp;h=116\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012655666?w=848\x26amp;h=116\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e \x26nbsp; \x3cbr\x3estep 2: 运行influxdb(如果不需要修改任何influxdb的config文件)   \x3cbr\x3e\x3ccode\x3eto\\your\\dir：influxd\x3c\/code\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3eInfluxDB HTTP API和Hosted Grafana HTTPS 通讯的冲突问题\x3c\/h3\x3e\n\x3cp\x3eInflux DB默认采用HTTP协议进行Client和Server端的通信，而云端的Grafana服务则强制采用HTTPS确保数据传输的安全性。 众所周知，HTTPS协议是HTTP协议的安全版本，其安全性能的实现主要依靠在Transport Layer之上增加的TLS\/SSL层实现文本及数据的加密。HTTPS与HTTP一个重要的区别在于HTTPS增加了对身份的验证功能，因此第三方无法伪造服务端或客户端身份，引入的证书认证机制就是用来确保这一功能的实现。\x3cbr\x3e为了确保网络间通讯的安全，我将InfluxDB的接口也进行了相关配置，让其利用TLS层使用HTTPS协议进行数据的传输。\x3cbr\x3e在配置过程中我使用的证书是self-signed-certificate,使用windows系统的配置过程稍有不同（windows真是伤不起，连个配置说明都没有）\x3cbr\x3estep 1:使用openssl（没有的朋友要安装一下）生成证书和密钥；\x3cbr\x3e\x3ccode\x3esudo openssl req -x509 -nodes -newkey rsa:2048 -keyout \/route\/to\/your\/dir\/influxdb-selfsigned.key -out \/route\/to\/your\/route\/influxdb-selfsigned.crt -days \x26lt;NUMBER_OF_DAYS\x26gt;\x3c\/code\x3e  \x3cbr\x3e进入文件所在目录，双击证书文件并安装证书（注意！要安装在受信任的根目录下） \x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012655667?w=408\x26amp;h=512\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012655667?w=408\x26amp;h=512\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3estep 2:配置influxDB;\x3cbr\x3e和官方文档一致，点[这里](\x3ca href=\x22https:\/\/docs.influxdata.com\/influxdb\/v1.4\/administration\/https_setup\/#setup-https-with-a-self-signed-certificate\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/docs.influxdata.com\/i...\x3c\/a\x3e\x3cbr\x3e)  \x3cbr\x3estep 3:重启influxdb  \x3cbr\x3e\x3ccode\x3e\/influxdb\/folder: influxd --config influxdb.conf\x3c\/code\x3e  \x3cbr\x3estep 4:测试  \x3cbr\x3e和官方文档一致，点\x3ca href=\x22https:\/\/docs.influxdata.com\/influxdb\/v1.4\/administration\/https_setup\/#setup-https-with-a-self-signed-certificate\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这里\x3c\/a\x3e  \x3cbr\x3estep 5：如果有使用telegraf，记得要将telegraf中output plugin的相关API也改成https！\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader11\x22\x3e配置grafana datasource\x3c\/h2\x3e\n\x3cp\x3e这一步也是卡了很久，grafana的错误提示基本形同虚设，最好inpect一下页面看看dev tool的错误提示。（这点是不是太不程序员友好了，疯狂diss ）\x3cbr\x3e在没有使用https之前grafana报错（谁能知道这个undefined是什么鬼意思！！  \x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012655668?w=1086\x26amp;h=716\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012655668?w=1086\x26amp;h=716\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3einspect后终于在console看到了错误详细情况： \x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012655669?w=1580\x26amp;h=70\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012655669?w=1580\x26amp;h=70\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e使用之后！Bang！ \x26nbsp; \x26nbsp;\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012655670?w=1005\x26amp;h=914\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012655670?w=1005\x26amp;h=914\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e注意此处不要选择proxy模式，让grafana的后端服务代理请求，这样处于本地服务器的influxdb无法接受到grafana的请求；\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader12\x22\x3eDEMO\x3c\/h2\x3e\n\x3cp\x3e最后一个折腾了我很久才得到的一个很粗略的demo。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012655671?w=1600\x26amp;h=730\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012655671?w=1600\x26amp;h=730\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader13\x22\x3e心得\x3c\/h1\x3e\n\x3col\x3e\n\x3cli\x3e作为开源产品Grafana和InfluxDB,两者的documentation和error hint做的都不是特别好，在开发过程中，我花了大量时间理解文档内容和错误提示。可以说是非常心累了，作为开源产品应该更加注重文档撰写和错误提示开发不是吗？ \x26nbsp;\x3c\/li\x3e\n\x3cli\x3e要提前熟悉一下SQL,对数据处理会比较有帮助（该捡起来的捡，该跪着学的学）；\x3c\/li\x3e\n\x3cli\x3e操着卖白粉的心，拿着擦皮鞋的钱。 从技术选型到实操不知道看了多少文档，配置过程中也是一堆的bug亟待解决。有些时候也搜不出来个什么正经的解决方案，做的过程中也是一边摸索一边前进，再次感叹一个好的文档能节省相当多的开发时间以及扼杀脱发！！\x3c\/li\x3e\n\x3c\/ol\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>IoT实时数据可视化方案：Grafana+InfluxDB+Telegraf+MQTT协议+Windows 10</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000012514865">https://segmentfault.com/a/1190000012514865</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/5rtixjjwexw/" target="_blank">https://alili.tech/archive/5rtixjjwexw/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>