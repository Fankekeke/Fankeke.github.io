<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="React ⚛️ 新的 Context API"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>React ⚛️ 新的 Context API | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/694f7aisawv/",
				"appid": "1613049289050283", 
				"title": "React ⚛️ 新的 Context API | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-15T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/j90m1zq86oc/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/l9sa0yu1yi/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f694f7aisawv%2f&text=React%20%e2%9a%9b%ef%b8%8f%20%e6%96%b0%e7%9a%84%20Context%20API"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f694f7aisawv%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f694f7aisawv%2f&text=React%20%e2%9a%9b%ef%b8%8f%20%e6%96%b0%e7%9a%84%20Context%20API"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f694f7aisawv%2f&title=React%20%e2%9a%9b%ef%b8%8f%20%e6%96%b0%e7%9a%84%20Context%20API"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f694f7aisawv%2f&is_video=false&description=React%20%e2%9a%9b%ef%b8%8f%20%e6%96%b0%e7%9a%84%20Context%20API"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=React%20%e2%9a%9b%ef%b8%8f%20%e6%96%b0%e7%9a%84%20Context%20API&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f694f7aisawv%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f694f7aisawv%2f&title=React%20%e2%9a%9b%ef%b8%8f%20%e6%96%b0%e7%9a%84%20Context%20API"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f694f7aisawv%2f&title=React%20%e2%9a%9b%ef%b8%8f%20%e6%96%b0%e7%9a%84%20Context%20API"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f694f7aisawv%2f&title=React%20%e2%9a%9b%ef%b8%8f%20%e6%96%b0%e7%9a%84%20Context%20API"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f694f7aisawv%2f&title=React%20%e2%9a%9b%ef%b8%8f%20%e6%96%b0%e7%9a%84%20Context%20API"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">React ⚛️ 新的 Context API</h1><div class="meta"><div class="postdate"><time datetime="2018-12-15" itemprop="datePublished">2018-12-15</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e原文地址：\x3ca href=\x22https:\/\/blog.kentcdodds.com\/reacts-%EF%B8%8F-new-context-api-70c9fe01596b\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eReact\x27s ⚛️ new Context API\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e作者：\x3ca href=\x22https:\/\/twitter.com\/kentcdodds\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ekentcdodds\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e这不再是一个 \x3ccode\x3e实验性的 API\x3c\/code\x3e，并且它更符合 \x3ccode\x3e工程化\x3c\/code\x3e 的理念，目前它已成为 \x3ccode\x3eReact 一级棒的 API\x3c\/code\x3e。\x3c\/p\x3e\n\x3cblockquote\x3e⚠️ ：大家可以通过 \x3ca href=\x22https:\/\/tinyletter.com\/kentcdodds\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3enewsletter\x3c\/a\x3e 获取我最新的资讯，我一般每两周通过邮件发送一次，大家可以通过自己的收件箱获取更多的内容。\x3c\/blockquote\x3e\n\x3cp\x3e\x3ccode\x3eReact\x3c\/code\x3e 中的 \x3ccode\x3econtext API\x3c\/code\x3e 相信大家都知道吧，可能跟大伙一样，当看到 \x3ccode\x3eReact\x3c\/code\x3e 的官方文档是这样时，都不敢直接使用它。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV21ST?w=748\x26amp;h=603\x22 src=\x22https:\/\/static.alili.tech\/img\/bV21ST?w=748\x26amp;h=603\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e第一条搜索结果显示的就是 \x3ca href=\x22https:\/\/reactjs.org\/docs\/context.html#why-not-to-use-context\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e为什么不建议使用 context\x3c\/a\x3e，让大家瞬间产生忧虑，该章节是这么描述 \x3ccode\x3econtext\x3c\/code\x3e 的：\x3c\/p\x3e\n\x3cblockquote\x3e如果你想让你的应用更加稳定，就别使用 \x3ccode\x3econtext\x3c\/code\x3e，因为这是一个实验性的 \x3ccode\x3eAPI\x3c\/code\x3e，在未来的 \x3ccode\x3eReact\x3c\/code\x3e 版本中可能会发生改变。\x3c\/blockquote\x3e\n\x3cp\x3e⚠️ 注意，这里的改变包括 \x3ccode\x3e中断\x3c\/code\x3e，\x3ccode\x3e终止\x3c\/code\x3e，\x3ccode\x3e不再使用\x3c\/code\x3e 的含义。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e那么，为什么还要使用 context 呢\x3c\/h2\x3e\n\x3cp\x3e你曾经历过尝试在一个 \x3ccode\x3e层级很深的组件\x3c\/code\x3e 中获取 \x3ccode\x3e最外层组件\x3c\/code\x3e 的 \x3ccode\x3estate\x3c\/code\x3e 的痛苦么，这种痛苦叫 \x3ccode\x3eprop drilling\x3c\/code\x3e，可谓让人接近崩溃的。当遇到这种情形时，你肯定不会喜欢用 \x3ccode\x3eprops\x3c\/code\x3e 来传递数据，因为如果中间有个组件发生改变，这个代价将是几何 \x3cimg src=\x22https:\/\/static.alili.techundefined\x22 class=\x22emoji\x22 alt=\x22joy\x22 title=\x22joy\x22\x3e。\x3c\/p\x3e\n\x3cp\x3e实际上，你可以通过使用常规的 \x3ccode\x3eJavaScript module\x3c\/code\x3e 来规避以上的问题，将数据存放在某个 \x3ccode\x3emodule\x3c\/code\x3e 中，就可以实现在任何地方 \x3ccode\x3e访问\/导入\x3c\/code\x3e，但这么做想要 \x3ccode\x3e更新\x3c\/code\x3e 却很麻烦（你必须实现一个 \x3ccode\x3eevent\x3c\/code\x3e 在数据更新时触发，通知用户数据发生改变），并且，\x3ccode\x3e服务端渲染\x3c\/code\x3e 对 \x3ccode\x3emodule\x3c\/code\x3e 也会有 \x3ca href=\x22https:\/\/stackoverflow.com\/questions\/40935571\/why-singleton-store-in-flux-can-cause-issue-for-server-side-rendering\/40974748#40974748\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e影响\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e因此，像 \x3ca href=\x22https:\/\/redux.js.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eredux\x3c\/a\x3e 这样的负责 \x3ccode\x3e状态管理\x3c\/code\x3e 的第三方库进入了大家的视野。它允许你在任何地方从 \x3ccode\x3estore\x3c\/code\x3e 获取数据，你需要做的只是使用 \x3ccode\x3e \x26lt;Provider \/\x26gt;\x3c\/code\x3e 包装一下，然后就可以神奇地在 \x3ccode\x3econnected\x3c\/code\x3e 的组件中轻松地获取想要的数据了。\x3c\/p\x3e\n\x3cp\x3e然而，如果我告诉你 \x3ccode\x3e\x26lt;Provider \/\x26gt;\x3c\/code\x3e 就是在使用 \x3ccode\x3econtext\x3c\/code\x3e 这个 \x3ccode\x3e实验性 API\x3c\/code\x3e 呢？? 事实上也是这样的！\x3ccode\x3eprovider\x3c\/code\x3e 组件将数据存进 \x3ccode\x3econtext\x3c\/code\x3e 中，\x3ccode\x3econnect\x3c\/code\x3e 高阶组件从 \x3ccode\x3econtext\x3c\/code\x3e 获取数据，所以，\x3ccode\x3eredux\x3c\/code\x3e 并不允许你的数据可以在任何地方访问，\x3ccode\x3econtext\x3c\/code\x3e 就是这样。\x3c\/p\x3e\n\x3cp\x3e所以，为什么还要使用 \x3ccode\x3econtext\x3c\/code\x3e 呢？可能是大家已经深深地爱上它了吧！即使你没有直接使用 \x3ccode\x3econtext\x3c\/code\x3e，你的应用程序也会通过引用像 \x3ca href=\x22https:\/\/github.com\/reactjs\/react-redux\/blob\/76dd7faa90981dd2f9efa76f3e2f26ecf2c12cf7\/src\/components\/connectAdvanced.js#L136-L143\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-redux\x3c\/a\x3e， \x3ca href=\x22https:\/\/github.com\/mobxjs\/mobx-react\/blob\/dc249910c74c1b2e988a879be07f10aeaea90936\/src\/Provider.js#L19-L34\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMobX-react\x3c\/a\x3e， \x3ca href=\x22https:\/\/github.com\/ReactTraining\/react-router\/blob\/e6f9017c947b3ae49affa24cc320d0a86f765b55\/packages\/react-router\/modules\/Router.js#L23-L34\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-router\x3c\/a\x3e， \x3ca href=\x22https:\/\/github.com\/paypal\/glamorous\/blob\/7468bfc76f46783cac841e20973ed119c771f3b7\/src\/theme-provider.js#L33-L37\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eglamorous\x3c\/a\x3e 这样的第三方库间接用到它。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3eContext 重生啦\x3c\/h2\x3e\n\x3cp\x3e现在清楚了，我们是如此地热爱 \x3ccode\x3econtext\x3c\/code\x3e，但官方文档的警告依然还在：\x3ccode\x3e在 React 的未来版本中，可能不再使用它\x3c\/code\x3e，好消息是，\x3ccode\x3econtext\x3c\/code\x3e 要正式跟大家打招呼了，大家极有可能比之前更爱它。\x3c\/p\x3e\n\x3cp\x3e一个月前，\x3ccode\x3eReact 团队\x3c\/code\x3e 从 \x3ca href=\x22https:\/\/github.com\/yarnpkg\/rfcs\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eyarn\x3c\/a\x3e，\x3ca href=\x22https:\/\/github.com\/rust-lang\/rfcs\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3erust\x3c\/a\x3e 和 \x3ca href=\x22https:\/\/github.com\/emberjs\/rfcs\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eEmber\x3c\/a\x3e 的 \x3ccode\x3erfcs 仓库\x3c\/code\x3e 受到启发，建立了一个自己的 \x3ca href=\x22https:\/\/github.com\/reactjs\/rfcs\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3erfcs\x3c\/a\x3e 仓库。仓库第一个 \x3ccode\x3ePR\x3c\/code\x3e 来自 \x3ca href=\x22https:\/\/twitter.com\/acdlite\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAndrew Clark\x3c\/a\x3e（React 团队核心成员），\x3ccode\x3ePR\x3c\/code\x3e 标题为 \x3ca href=\x22https:\/\/github.com\/reactjs\/rfcs\/pull\/2\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eNew version of context\x3c\/a\x3e，其中 \x3ccode\x3eAndrew Clark\x3c\/code\x3e 概述了未来新版本的 \x3ccode\x3econtext\x3c\/code\x3e 是怎样的，之后还存在一些有趣的讨论，几天后，\x3ccode\x3eAndrew Clark\x3c\/code\x3e 就向 \x3ccode\x3eReact\x3c\/code\x3e 仓库提了一个 \x3ca href=\x22https:\/\/github.com\/facebook\/react\/pull\/11818\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eNew context API\x3c\/a\x3e 的 \x3ccode\x3ePR\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e那么，到底有什么改变呢？肉眼估计新的 \x3ccode\x3eAPI\x3c\/code\x3e 与之前的 \x3ccode\x3eAPI\x3c\/code\x3e 存在百万级别的差异。这是我做的一个简单的 \x3ca href=\x22https:\/\/codesandbox.io\/s\/n4r0qq898j?from-embed\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e示例\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const ThemeContext = React.createContext(\x27light\x27)\nclass ThemeProvider extends React.Component {\n  state = {theme: \x27light\x27}\n  render() {\n    return ThemeContext.provide(this.state.theme, this.props.children)\n  }\n}\n\nconst ThemeConsumer = ({children}) =\x3e ThemeContext.consume(children)\n\nclass App extends React.Component {\n  render() {\n    \x3cThemeProvider\x3e\n      \x3cThemeConsumer\x3e{val =\x3e \x3cdiv\x3e{val}\x3c\/div\x3e}\x3c\/ThemeConsumer\x3e\n    \x3c\/ThemeProvider\x3e\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ThemeContext = React.createContext(\x3cspan class=\x22hljs-string\x22\x3e\x27light\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eThemeProvider\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eReact\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n  state = {\x3cspan class=\x22hljs-attr\x22\x3etheme\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27light\x27\x3c\/span\x3e}\n  render() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e ThemeContext.provide(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state.theme, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props.children)\n  }\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ThemeConsumer = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e{children}\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e ThemeContext.consume(children)\n\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eApp\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eReact\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n  render() {\n    \x26lt;ThemeProvider\x26gt;\n      \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eThemeConsumer\x3c\/span\x3e\x26gt;\x3c\/span\x3e{val =\x26gt; \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e{val}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eThemeConsumer\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n    \x26lt;\x3cspan class=\x22hljs-regexp\x22\x3e\/ThemeProvider\x26gt;\n  }\n}\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e你可能注意到示例中使用到一个 \x3ccode\x3erender prop\x3c\/code\x3e，但实际上并没有任何关于需要使用 \x3ccode\x3erender prop\x3c\/code\x3e 的 \x3ccode\x3econtext API\x3c\/code\x3e，你可以使用 \x3ccode\x3econtext API\x3c\/code\x3e 轻松实现 \x3ccode\x3e高阶组件\x3c\/code\x3e 或其他功能。\x3c\/blockquote\x3e\n\x3cp\x3e新的 \x3ccode\x3econtext API\x3c\/code\x3e 主要由以下三部分组成\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ccode\x3eReact.createContext\x3c\/code\x3e 用于传递 \x3ccode\x3e初始值\x3c\/code\x3e（可选择 \x3ca href=\x22https:\/\/twitter.com\/acdlite\/status\/957446433656864768\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e使用 bitmask 的一个奇妙的选择性退出函数\x3c\/a\x3e），返回一个包含 \x3ccode\x3eprovider\x3c\/code\x3e 和 \x3ccode\x3econsumer\x3c\/code\x3e 的对象\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eprovide\x3c\/code\x3e 函数使用 \x3ccode\x3ehigher\x3c\/code\x3e，并可以接收任何值\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3econsume\x3c\/code\x3e 函数在 \x3ccode\x3eprovider\x3c\/code\x3e 之后任何地方使用，并传递一个返回 \x3ccode\x3eJSX\x3c\/code\x3e 的函数（这有点像 \x3ccode\x3erender prop\x3c\/code\x3e 组件，但 \x3ccode\x3econsume\x3c\/code\x3e 不是组件）。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e我对这个 \x3ccode\x3eAPI\x3c\/code\x3e 充满了期待，\x3ccode\x3eReact 团队\x3c\/code\x3e 也将会移除 \x3ccode\x3econtext 是实验性 API\x3c\/code\x3e 的警告，因为它现在是框架 \x3ca href=\x22https:\/\/twitter.com\/acdlite\/status\/957445801302618112\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e一级棒的特性\x3c\/a\x3e。这也意味着大家将不再那么担心使用 \x3ccode\x3econtext\x3c\/code\x3e 来解决应用中 \x3ccode\x3eprop-drilling\x3c\/code\x3e 的问题了，对 \x3ccode\x3eRedux\x3c\/code\x3e 也将不再那么依赖，对 \x3ccode\x3eReact\x3c\/code\x3e 将更加喜欢。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/twitter.com\/kentcdodds\/status\/911276059051438082\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e我最近看到的\x3c\/a\x3e，大概意思是：\x3c\/p\x3e\n\x3cblockquote\x3e大家不是很愿意保持使用提倡的 \x3ccode\x3erender\x3c\/code\x3e 方法，加重了 \x3ccode\x3eprop drilling\x3c\/code\x3e 问题，所以，最终想通过 \x3ccode\x3eredux\x3c\/code\x3e 来缓解\x3c\/blockquote\x3e\n\x3cp\x3e所以，我认为如果我们不过早或武断地去破坏 \x3ccode\x3erender\x3c\/code\x3e 方法，我们可能就不会那么痛苦，即便最终我们实在没有办法避免，我们也可以通过核心的 \x3ccode\x3eReact API\x3c\/code\x3e 来解决。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3eContext 实践\x3c\/h2\x3e\n\x3cp\x3e我看到了一个关于 \x3ccode\x3econtext API\x3c\/code\x3e（或普通的 \x3ccode\x3erender prop pattern\x3c\/code\x3e）的问题很多次，就是如何组合 \x3ccode\x3eproviders\x3c\/code\x3e 和 \x3ccode\x3econsumers\x3c\/code\x3e，当在一个 \x3ccode\x3erender\x3c\/code\x3e 方法中把一堆 \x3ccode\x3erender prop\x3c\/code\x3e 组件放在一起时，就会像这样 \x3ca href=\x22https:\/\/twitter.com\/acdlite\/status\/955955121979969537\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e嵌套\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV3sq9?w=499\x26amp;h=989\x22 src=\x22https:\/\/static.alili.tech\/img\/bV3sq9?w=499\x26amp;h=989\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e那么，我们可以做点什么来避免呢？其实，个人觉得没有那么糟糕，如果你觉得这样并不好，那么可以使用常规的方法来解决它：\x3ccode\x3eutility\x3c\/code\x3e 函数\/组件，下面是一个示例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const ThemeContext = React.createContext(\x27light\x27)\nclass ThemeProvider extends React.Component {\/* code *\/}\nconst ThemeConsumer = ({children}) =\x3e ThemeContext.consume(children)\nconst LanguageContext = React.createContext(\x27en\x27)\nclass LanguageProvider extends React.Component {\/* code *\/}\nconst LanguageConsumer = ({children}) =\x3e LanguageContext.consume(children)\n\nfunction AppProviders({children}) {\n  return (\n    \x3cLanguageProvider\x3e\n      \x3cThemeProvider\x3e\n        {children}\n      \x3c\/ThemeProvider\x3e\n    \x3c\/LanguageProvider\x3e\n  )\n}\n\nfunction ThemeAndLanguageConsumer({children}) {\n  return (\n    \x3cLanguageConsumer\x3e\n      {language =\x3e (\n        \x3cThemeConsumer\x3e\n          {theme =\x3e children({language, theme})}\n        \x3c\/ThemeConsumer\x3e\n      )}\n    \x3c\/LanguageConsumer\x3e\n  )\n}\n\nclass App extends React.Component {\n  render() {\n    \x3cAppProviders\x3e\n      \x3cThemeAndLanguageConsumer\x3e\n        {({theme, language}) =\x3e \x3cdiv\x3e{theme} and {language}\x3c\/div\x3e}\n      \x3c\/ThemeAndLanguageConsumer\x3e\n    \x3c\/AppProviders\x3e\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ThemeContext = React.createContext(\x3cspan class=\x22hljs-string\x22\x3e\x27light\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eThemeProvider\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eReact\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\x3cspan class=\x22hljs-comment\x22\x3e\/* code *\/\x3c\/span\x3e}\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ThemeConsumer = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e{children}\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e ThemeContext.consume(children)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e LanguageContext = React.createContext(\x3cspan class=\x22hljs-string\x22\x3e\x27en\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eLanguageProvider\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eReact\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\x3cspan class=\x22hljs-comment\x22\x3e\/* code *\/\x3c\/span\x3e}\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e LanguageConsumer = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e{children}\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e LanguageContext.consume(children)\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eAppProviders\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e{children}\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n    \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eLanguageProvider\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eThemeProvider\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        {children}\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eThemeProvider\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eLanguageProvider\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n  )\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eThemeAndLanguageConsumer\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e{children}\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n    \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eLanguageConsumer\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      {language =\x26gt; (\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eThemeConsumer\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n          {theme =\x26gt; children({language, theme})}\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eThemeConsumer\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      )}\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eLanguageConsumer\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n  )\n}\n\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eApp\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eReact\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n  render() {\n    \x26lt;AppProviders\x26gt;\n      \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eThemeAndLanguageConsumer\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        {({theme, language}) =\x26gt; \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e{theme} and {language}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e}\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eThemeAndLanguageConsumer\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n    \x26lt;\x3cspan class=\x22hljs-regexp\x22\x3e\/AppProviders\x26gt;\n  }\n}\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里的目标是使用常见的案例，结合特殊功能的函数\/组件，使案例更加 \x3ccode\x3e工程化\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e除此之外，大家还可以参考 \x3ca href=\x22https:\/\/medium.com\/@jmeas\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ejmeas\x3c\/a\x3e 的 \x3ca href=\x22https:\/\/codesandbox.io\/s\/92pj14134y?from-embed\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-composer\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e但需要提及的是，在实践中，我并不建议大家嵌套渲染 \x3ccode\x3eprops components\x3c\/code\x3e，无论什么时候，都可以选择创建多个简单易用的组件，然后组合使用。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e正如上面所说的，我对这个 \x3ccode\x3eAPI\x3c\/code\x3e 充满了期待。目前暂未发布，但应该会包含在下一个 \x3ccode\x3eminor\x3c\/code\x3e 版本中。不同担心，之前的 \x3ccode\x3eAPI\x3c\/code\x3e 会继续正常工作，直到下一个 \x3ccode\x3emajor\x3c\/code\x3e 版本发布，所以，每个人都有时间迁移。还有不要忘了，\x3ccode\x3eReact\x3c\/code\x3e 团队在 \x3ccode\x3eFacebook\x3c\/code\x3e 有超过 \x3ccode\x3e50,000\x3c\/code\x3e 个 \x3ccode\x3eReact components\x3c\/code\x3e 需要维护，所以，将来很有可能会发布一个 \x3ccode\x3ecodemod\x3c\/code\x3e 去自动更新大多数人的代码（就像以往一样）。\x3c\/p\x3e\n\x3cp\x3e我很高兴这个 \x3ccode\x3e新 API\x3c\/code\x3e 能够提供，正如我在 \x3ca href=\x22https:\/\/twitter.com\/kentcdodds\/status\/956675313966239745\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etwitter\x3c\/a\x3e 中提及的。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV3sra?w=499\x26amp;h=242\x22 src=\x22https:\/\/static.alili.tech\/img\/bV3sra?w=499\x26amp;h=242\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>React ⚛️ 新的 Context API</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000013076221">https://segmentfault.com/a/1190000013076221</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/694f7aisawv/" target="_blank">https://alili.tech/archive/694f7aisawv/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>