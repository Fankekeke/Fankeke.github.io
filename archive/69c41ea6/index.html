<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="前端浏览器跨域深度解析"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>前端浏览器跨域深度解析 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/69c41ea6/",
				"appid": "1613049289050283", 
				"title": "前端浏览器跨域深度解析 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-10-23T00:00:00"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/b2887750/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/dc87d28f/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f69c41ea6%2f&text=%e5%89%8d%e7%ab%af%e6%b5%8f%e8%a7%88%e5%99%a8%e8%b7%a8%e5%9f%9f%e6%b7%b1%e5%ba%a6%e8%a7%a3%e6%9e%90"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f69c41ea6%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f69c41ea6%2f&text=%e5%89%8d%e7%ab%af%e6%b5%8f%e8%a7%88%e5%99%a8%e8%b7%a8%e5%9f%9f%e6%b7%b1%e5%ba%a6%e8%a7%a3%e6%9e%90"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f69c41ea6%2f&title=%e5%89%8d%e7%ab%af%e6%b5%8f%e8%a7%88%e5%99%a8%e8%b7%a8%e5%9f%9f%e6%b7%b1%e5%ba%a6%e8%a7%a3%e6%9e%90"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f69c41ea6%2f&is_video=false&description=%e5%89%8d%e7%ab%af%e6%b5%8f%e8%a7%88%e5%99%a8%e8%b7%a8%e5%9f%9f%e6%b7%b1%e5%ba%a6%e8%a7%a3%e6%9e%90"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%89%8d%e7%ab%af%e6%b5%8f%e8%a7%88%e5%99%a8%e8%b7%a8%e5%9f%9f%e6%b7%b1%e5%ba%a6%e8%a7%a3%e6%9e%90&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f69c41ea6%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f69c41ea6%2f&title=%e5%89%8d%e7%ab%af%e6%b5%8f%e8%a7%88%e5%99%a8%e8%b7%a8%e5%9f%9f%e6%b7%b1%e5%ba%a6%e8%a7%a3%e6%9e%90"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f69c41ea6%2f&title=%e5%89%8d%e7%ab%af%e6%b5%8f%e8%a7%88%e5%99%a8%e8%b7%a8%e5%9f%9f%e6%b7%b1%e5%ba%a6%e8%a7%a3%e6%9e%90"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f69c41ea6%2f&title=%e5%89%8d%e7%ab%af%e6%b5%8f%e8%a7%88%e5%99%a8%e8%b7%a8%e5%9f%9f%e6%b7%b1%e5%ba%a6%e8%a7%a3%e6%9e%90"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f69c41ea6%2f&title=%e5%89%8d%e7%ab%af%e6%b5%8f%e8%a7%88%e5%99%a8%e8%b7%a8%e5%9f%9f%e6%b7%b1%e5%ba%a6%e8%a7%a3%e6%9e%90"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文链接">原文链接</a></li><li><a href="#原文标题">原文标题</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">前端浏览器跨域深度解析</h1><div class="meta"><div class="postdate"><time datetime="2018-10-23" itemprop="datePublished">2018-10-23</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n\x3ch3 id=\x22articleHeader1\x22\x3e正文\x3c\/h3\x3e\n\x3ch4\x3e1. 什么是跨域？\x3c\/h4\x3e\n\x3cblockquote\x3e\x3cp\x3e跨域一词从字面意思看，就是跨域名嘛，但实际上跨域的范围绝对不止那么狭隘。具体概念如下：只要协议、域名、端口有任何一个不同，都被当作是不同的域。之所以会产生跨域这个问题呢，其实也很容易想明白，要是随便引用外部文件，不同标签下的页面引用类似的彼此的文件，浏览器很容易懵逼的，安全也得不到保障了就。什么事，都是安全第一嘛。但在安全限制的同时也给注入iframe或是ajax应用上带来了不少麻烦。所以我们要通过一些方法使本域的js能够操作其他域的页面对象或者使其他域的js能操作本域的页面对象（iframe之间）。下面是具体的跨域情况详解：\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22URL                      说明       是否允许通信\nhttp:\/\/www.a.com\/a.js\nhttp:\/\/www.a.com\/b.js     同一域名下   允许\n\nhttp:\/\/www.a.com\/lab\/a.js\nhttp:\/\/www.a.com\/script\/b.js 同一域名下不同文件夹 允许\n\nhttp:\/\/www.a.com:8000\/a.js\nhttp:\/\/www.a.com\/b.js     同一域名，不同端口  不允许\n\nhttp:\/\/www.a.com\/a.js\nhttps:\/\/www.a.com\/b.js 同一域名，不同协议 不允许\n\nhttp:\/\/www.a.com\/a.js\nhttp:\/\/70.32.92.74\/b.js 域名和域名对应ip 不允许\n\nhttp:\/\/www.a.com\/a.js\nhttp:\/\/script.a.com\/b.js 主域相同，子域不同 不允许（cookie这种情况下也不允许访问）\n\nhttp:\/\/www.a.com\/a.js\nhttp:\/\/a.com\/b.js 同一域名，不同二级域名（同上） 不允许（cookie这种情况下也不允许访问）\n\nhttp:\/\/www.cnblogs.com\/a.js\nhttp:\/\/www.a.com\/b.js 不同域名 不允许\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3eURL                      说明       是否允许通信\n\x3cspan class=\x22hljs-symbol\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.a.com\/a.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.a.com\/b.js     同一域名下   允许\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e\nhttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.a.com\/lab\/a.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.a.com\/script\/b.js 同一域名下不同文件夹 允许\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e\nhttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.a.com:8000\/a.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.a.com\/b.js     同一域名，不同端口  不允许\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e\nhttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.a.com\/a.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3ehttps:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.a.com\/b.js 同一域名，不同协议 不允许\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e\nhttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.a.com\/a.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/70.32.92.74\/b.js 域名和域名对应ip 不允许\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e\nhttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.a.com\/a.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/script.a.com\/b.js 主域相同，子域不同 不允许（cookie这种情况下也不允许访问）\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e\nhttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.a.com\/a.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/a.com\/b.js 同一域名，不同二级域名（同上） 不允许（cookie这种情况下也不允许访问）\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e\nhttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.cnblogs.com\/a.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.a.com\/b.js 不同域名 不允许\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e这里我们需要注意两点:\x3c\/strong\x3e\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e如果是协议和端口造成的跨域问题“前台”是无能为力的；\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e在跨域问题上，域仅仅是通过“URL的首部”来识别而不会去尝试判断相同的ip地址对应着两个域或两个域是否在同一个ip上。\x3cbr\x3e(“URL的首部”指window.location.protocol \x2bwindow.location.host，也可以理解为“Domains, protocols and ports must match”。)\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch4\x3e2. 通过document.domain跨域\x3c\/h4\x3e\n\x3cblockquote\x3e\x3cp\x3e前面说过了，浏览器有一个同源策略，其限制之一是不能通过ajax的方法去请求不同源中的文档。 第二个限制是浏览器中不同域的框架之间是不能进行js的交互操作的。不同的框架之间是可以获取window对象的，但却无法获取相应的属性和方法。比如，有一个页面，它的地址是\x3ca href=\x22http:\/\/www.damonare.cn\/a.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.damonare.cn\/a.html\x3c\/a\x3e ， 在这个页面里面有一个iframe，它的src是\x3ca href=\x22http:\/\/damonare.cn\/b.html,\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/damonare.cn\/b.html,\x3c\/a\x3e 很显然，这个页面与它里面的iframe框架是不同域的，所以我们是无法通过在页面中书写js代码来获取iframe中的东西的：\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n    function test(){\n        var iframe = document.getElementById(\x27￼ifame\x27);\n        var win = document.contentWindow;\/\/可以获取到iframe里的window对象，但该window对象的属性和方法几乎是不可用的\n        var doc = win.document;\/\/这里获取不到iframe里的document对象\n        var name = win.name;\/\/这里同样获取不到window对象的name属性\n    }\n\x3c\/script\x3e\n\x3ciframe id = \x26quot;iframe\x26quot; src=\x26quot;http:\/\/damonare.cn\/b.html\x26quot; onload = \x26quot;test()\x26quot;\x3e\x3c\/iframe\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etest\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e iframe = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27￼ifame\x27\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e win = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.contentWindow;\x3cspan class=\x22hljs-comment\x22\x3e\/\/可以获取到iframe里的window对象，但该window对象的属性和方法几乎是不可用的\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e doc = win.document;\x3cspan class=\x22hljs-comment\x22\x3e\/\/这里获取不到iframe里的document对象\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e name = win.name;\x3cspan class=\x22hljs-comment\x22\x3e\/\/这里同样获取不到window对象的name属性\x3c\/span\x3e\n    }\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x22iframe\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/damonare.cn\/b.html\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonload\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x22test()\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3e这个时候，document.domain就可以派上用场了，我们只要把\x3ca href=\x22http:\/\/www.damonare.cn\/a.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.damonare.cn\/a.html\x3c\/a\x3e和\x3ca href=\x22http:\/\/damonare.cn\/b.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/damonare.cn\/b.html\x3c\/a\x3e这两个页面的document.domain都设成相同的域名就可以了。但要注意的是，document.domain的设置是有限制的，我们只能把document.domain设置成自身或更高一级的父域，且主域必须相同。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e在页面\x3ca href=\x22http:\/\/www.damonare.cn\/a.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.damonare.cn\/a.html\x3c\/a\x3e 中设置document.domain:\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3ciframe id = \x26quot;iframe\x26quot; src=\x26quot;http:\/\/damonare.cn\/b.html\x26quot; onload = \x26quot;test()\x26quot;\x3e\x3c\/iframe\x3e\n\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n    document.domain = \x27damonare.cn\x27;\/\/设置成主域\n    function test(){\n        alert(document.getElementById(\x27￼iframe\x27).contentWindow);\/\/contentWindow 可取得子窗口的 window 对象\n    }\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x22iframe\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/damonare.cn\/b.html\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonload\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x22test()\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.domain = \x3cspan class=\x22hljs-string\x22\x3e\x27damonare.cn\x27\x3c\/span\x3e;\x3cspan class=\x22hljs-comment\x22\x3e\/\/设置成主域\x3c\/span\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etest\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        alert(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27￼iframe\x27\x3c\/span\x3e).contentWindow);\x3cspan class=\x22hljs-comment\x22\x3e\/\/contentWindow 可取得子窗口的 window 对象\x3c\/span\x3e\n    }\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e在页面\x3ca href=\x22http:\/\/damonare.cn\/b.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/damonare.cn\/b.html\x3c\/a\x3e 中也设置document.domain:\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n    document.domain = \x27damonare.cn\x27;\/\/在iframe载入这个页面也设置document.domain，使之与主页面的document.domain相同\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.domain = \x3cspan class=\x22hljs-string\x22\x3e\x27damonare.cn\x27\x3c\/span\x3e;\x3cspan class=\x22hljs-comment\x22\x3e\/\/在iframe载入这个页面也设置document.domain，使之与主页面的document.domain相同\x3c\/span\x3e\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e修改document.domain的方法只适用于不同子域的框架间的交互。\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch4\x3e3. 通过location.hash跨域\x3c\/h4\x3e\n\x3cblockquote\x3e\x3cp\x3e因为父窗口可以对iframe进行URL读写，iframe也可以读写父窗口的URL，URL有一部分被称为hash，就是#号及其后面的字符，它一般用于浏览器锚点定位，Server端并不关心这部分，应该说HTTP请求过程中不会携带hash，所以这部分的修改不会产生HTTP请求，但是会产生浏览器历史记录。此方法的原理就是改变URL的hash部分来进行双向通信。每个window通过改变其他 window的location来发送消息（由于两个页面不在同一个域下IE、Chrome不允许修改parent.location.hash的值，所以要借助于父窗口域名下的一个代理iframe），并通过监听自己的URL的变化来接收消息。这个方式的通信会造成一些不必要的浏览器历史记录，而且有些浏览器不支持onhashchange事件，需要轮询来获知URL的改变，最后，这样做也存在缺点，诸如数据直接暴露在了url中，数据容量和类型都有限等。下面举例说明：\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e假如父页面是baidu.com\/a.html,iframe嵌入的页面为google.com\/b.html（此处省略了域名等url属性），要实现此两个页面间的通信可以通过以下方法。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3ea.html传送数据到b.html\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3ea.html下修改iframe的src为google.com\/b.html#paco\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eb.html监听到url发生变化，触发相应操作\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3eb.html传送数据到a.html，由于两个页面不在同一个域下IE、Chrome不允许修改parent.location.hash的值，所以要借助于父窗口域名下的一个代理iframe\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eb.html下创建一个隐藏的iframe，此iframe的src是baidu.com域下的，并挂上要传送的hash数据，如src=\x22http:\/\/www.baidu.com\/proxy.html#data\x22\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eproxy.html监听到url发生变化，修改a.html的url（因为a.html和proxy.html同域，所以proxy.html可修改a.html的url hash）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ea.html监听到url发生变化，触发相应操作\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3eb.html页面的关键代码如下:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22try {  \n    parent.location.hash = \x27data\x27;  \n} catch (e) {  \n    \/\/ ie、chrome的安全机制无法修改parent.location.hash，  \n    var ifrproxy = document.createElement(\x27iframe\x27);  \n    ifrproxy.style.display = \x27none\x27;  \n    ifrproxy.src = \x26quot;http:\/\/www.baidu.com\/proxy.html#data\x26quot;;  \n    document.body.appendChild(ifrproxy);  \n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dart\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {  \n    parent.location.hash = \x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e;  \n} \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (e) {  \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ie、chrome的安全机制无法修改parent.location.hash，  \x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ifrproxy = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27iframe\x27\x3c\/span\x3e);  \n    ifrproxy.style.display = \x3cspan class=\x22hljs-string\x22\x3e\x27none\x27\x3c\/span\x3e;  \n    ifrproxy.src = \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/www.baidu.com\/proxy.html#data\x22\x3c\/span\x3e;  \n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(ifrproxy);  \n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eproxy.html页面的关键代码如下 :\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/因为parent.parent（即baidu.com\/a.html）和baidu.com\/proxy.html属于同一个域，所以可以改变其location.hash的值  \nparent.parent.location.hash = self.location.hash.substring(1);  \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lasso\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/因为parent.parent（即baidu.com\/a.html）和baidu.com\/proxy.html属于同一个域，所以可以改变其location.hash的值  \x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eparent\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3eparent\x3c\/span\x3e.location.hash = \x3cspan class=\x22hljs-built_in\x22\x3eself\x3c\/span\x3e.location.hash.substring(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);  \x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e4. 通过HTML5的postMessage方法跨域\x3c\/h4\x3e\n\x3cblockquote\x3e\x3cp\x3e高级浏览器Internet Explorer 8\x2b, chrome，Firefox , Opera  和 Safari 都将支持这个功能。这个功能主要包括接受信息的\x22message\x22事件和发送消息的\x22postMessage\x22方法。比如damonare.cn域的A页面通过iframe嵌入了一个google.com域的B页面，可以通过以下方法实现A和B的通信\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3eA页面通过postMessage方法发送消息：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22window.onload = function() {  \n    var ifr = document.getElementById(\x27ifr\x27);  \n    var targetOrigin = \x26quot;http:\/\/www.google.com\x26quot;;  \n    ifr.contentWindow.postMessage(\x27hello world!\x27, targetOrigin);  \n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{  \n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ifr = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27ifr\x27\x3c\/span\x3e);  \n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e targetOrigin = \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/www.google.com\x22\x3c\/span\x3e;  \n    ifr.contentWindow.postMessage(\x3cspan class=\x22hljs-string\x22\x3e\x27hello world!\x27\x3c\/span\x3e, targetOrigin);  \n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3epostMessage的使用方法：\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cp\x3eotherWindow.postMessage(message, targetOrigin);\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eotherWindow:指目标窗口，也就是给哪个window发消息，是 window.frames 属性的成员或者由 window.open 方法创建的窗口\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3emessage:   是要发送的消息，类型为 String、Object (IE8、9 不支持)\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3etargetOrigin:   是限定消息接收范围，不限制请使用 \x27*\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3eB页面通过message事件监听并接受消息:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var onmessage = function (event) {  \n  var data = event.data;\/\/消息  \n  var origin = event.origin;\/\/消息来源地址  \n  var source = event.source;\/\/源Window对象  \n  if(origin==\x26quot;http:\/\/www.baidu.com\x26quot;){  \nconsole.log(data);\/\/hello world!  \n  }  \n};  \nif (typeof window.addEventListener != \x27undefined\x27) {  \n  window.addEventListener(\x27message\x27, onmessage, false);  \n} else if (typeof window.attachEvent != \x27undefined\x27) {  \n  \/\/for ie  \n  window.attachEvent(\x27onmessage\x27, onmessage);  \n}  \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e onmessage = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{  \n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e data = event.data;\x3cspan class=\x22hljs-comment\x22\x3e\/\/消息  \x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e origin = event.origin;\x3cspan class=\x22hljs-comment\x22\x3e\/\/消息来源地址  \x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e source = event.source;\x3cspan class=\x22hljs-comment\x22\x3e\/\/源Window对象  \x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(origin==\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/www.baidu.com\x22\x3c\/span\x3e){  \n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(data);\x3cspan class=\x22hljs-comment\x22\x3e\/\/hello world!  \x3c\/span\x3e\n  }  \n};  \n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.addEventListener != \x3cspan class=\x22hljs-string\x22\x3e\x27undefined\x27\x3c\/span\x3e) {  \n  \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27message\x27\x3c\/span\x3e, onmessage, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);  \n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.attachEvent != \x3cspan class=\x22hljs-string\x22\x3e\x27undefined\x27\x3c\/span\x3e) {  \n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/for ie  \x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.attachEvent(\x3cspan class=\x22hljs-string\x22\x3e\x27onmessage\x27\x3c\/span\x3e, onmessage);  \n}  \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e同理，也可以B页面发送消息，然后A页面监听并接受消息。\x3c\/p\x3e\n\x3ch4\x3e5.通过jsonp跨域\x3c\/h4\x3e\n\x3cblockquote\x3e\x3cp\x3e刚才说的这几种都是双向通信的，即两个iframe，页面与iframe或是页面与页面之间的，下面说几种单项跨域的（一般用来获取数据），因为通过script标签引入的js是不受同源策略的限制的。所以我们可以通过script标签引入一个js或者是一个其他后缀形式（如php，jsp等）的文件，此文件返回一个js函数的调用。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e比如，有个a.html页面，它里面的代码需要利用ajax获取一个不同域上的json数据，假设这个json数据地址是\x3ca href=\x22http:\/\/damonare.cn\/data.php,\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/damonare.cn\/data.php,\x3c\/a\x3e那么a.html中的代码就可以这样：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n    function dosomething(jsondata){\n        \/\/处理获得的json数据\n    }\n\x3c\/script\x3e\n\x3cscript src=\x26quot;http:\/\/example.com\/data.php?callback=dosomething\x26quot;\x3e\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22actionscript\x22\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edosomething\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(jsondata)\x3c\/span\x3e\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/处理获得的json数据\x3c\/span\x3e\n    }\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/example.com\/data.php?callback=dosomething\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们看到获取数据的地址后面还有一个callback参数，按惯例是用这个参数名，但是你用其他的也一样。当然如果获取数据的jsonp地址页面不是你自己能控制的，就得按照提供数据的那一方的规定格式来操作了。\x3c\/p\x3e\n\x3cp\x3e因为是当做一个js文件来引入的，所以\x3ca href=\x22http:\/\/damonare.cn\/data.php\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/damonare.cn\/data.php\x3c\/a\x3e返回的必须是一个能执行的js文件，所以这个页面的php代码可能是这样的(一定要和后端约定好哦):\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c?php\n$callback = $_GET[\x27callback\x27];\/\/得到回调函数名\n$data = array(\x27a\x27,\x27b\x27,\x27c\x27);\/\/要返回的数据\necho $callback.\x27(\x27.json_encode($data).\x27)\x27;\/\/输出\n?\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22php\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;?php\x3c\/span\x3e\n$callback = $_GET[\x3cspan class=\x22hljs-string\x22\x3e\x27callback\x27\x3c\/span\x3e];\x3cspan class=\x22hljs-comment\x22\x3e\/\/得到回调函数名\x3c\/span\x3e\n$data = \x3cspan class=\x22hljs-keyword\x22\x3earray\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27b\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27c\x27\x3c\/span\x3e);\x3cspan class=\x22hljs-comment\x22\x3e\/\/要返回的数据\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eecho\x3c\/span\x3e $callback.\x3cspan class=\x22hljs-string\x22\x3e\x27(\x27\x3c\/span\x3e.json_encode($data).\x3cspan class=\x22hljs-string\x22\x3e\x27)\x27\x3c\/span\x3e;\x3cspan class=\x22hljs-comment\x22\x3e\/\/输出\x3c\/span\x3e\n\x3cspan class=\x22hljs-meta\x22\x3e?\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最终，输出结果为：dosomething([\x27a\x27,\x27b\x27,\x27c\x27]);\x3c\/p\x3e\n\x3cp\x3e如果你的页面使用jquery，那么通过它封装的方法就能很方便的来进行jsonp操作了。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n    $.getJSON(\x27http:\/\/example.com\/data.php?callback=?,function(jsondata)\x27){\n        \/\/处理获得的json数据\n    });\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    $.getJSON(\x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/example.com\/data.php?callback=?,function(jsondata)\x27\x3c\/span\x3e){\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/处理获得的json数据\x3c\/span\x3e\n    });\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ejquery会自动生成一个全局函数来替换callback=?中的问号，之后获取到数据后又会自动销毁，实际上就是起一个临时代理函数的作用。$.getJSON方法会自动判断是否跨域，不跨域的话，就调用普通的ajax方法；跨域的话，则会以异步加载js文件的形式来调用jsonp的回调函数。\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cp\x3eJSONP的优缺点\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eJSONP的优点是：它不像XMLHttpRequest对象实现的Ajax请求那样受到同源策略的限制；它的兼容性更好，在更加古老的浏览器中都可以运行，不需要XMLHttpRequest或ActiveX的支持；并且在请求完毕后可以通过调用callback的方式回传结果。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eJSONP的缺点则是：它只支持GET请求而不支持POST等其它类型的HTTP请求；它只支持跨域HTTP请求这种情况，不能解决不同域的两个页面之间如何进行JavaScript调用的问题。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\x3c\/ul\x3e\n\x3ch4\x3e6. 通过CORS跨域\x3c\/h4\x3e\n\x3cblockquote\x3e\x3cp\x3eCORS（Cross-Origin Resource Sharing）跨域资源共享，定义了必须在访问跨域资源时，浏览器与服务器应该如何沟通。CORS背后的基本思想就是使用自定义的HTTP头部让浏览器与服务器进行沟通，从而决定请求或响应是应该成功还是失败。目前，所有浏览器都支持该功能，IE浏览器不能低于IE10。整个CORS通信过程，都是浏览器自动完成，不需要用户参与。对于开发者来说，CORS通信与同源的AJAX通信没有差别，代码完全一样。浏览器一旦发现AJAX请求跨源，就会自动添加一些附加的头信息，有时还会多出一次附加的请求，但用户不会有感觉。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e\x3cstrong\x3e因此，实现CORS通信的关键是服务器。只要服务器实现了CORS接口，就可以跨源通信。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e平时的ajax请求可能是这样的:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n    var xhr = new XMLHttpRequest();\n    xhr.open(\x26quot;POST\x26quot;, \x26quot;\/damonare\x26quot;,true);\n    xhr.send();\n\x3c\/script\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs accesslog\x22\x3e\x3ccode\x3e\x26lt;script type=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\n    var xhr = new XMLHttpRequest();\n    xhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x22\x3cspan class=\x22hljs-keyword\x22\x3ePOST\x3c\/span\x3e\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22\/damonare\x22\x3c\/span\x3e,true);\n    xhr.send();\n\x26lt;\/script\x26gt;\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e以上damonare部分是相对路径，如果我们要使用CORS，相关Ajax代码可能如下所示：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n    var xhr = new XMLHttpRequest();\n    xhr.open(\x26quot;￼GET\x26quot;, \x26quot;http:\/\/segmentfault.com\/u\/trigkit4\/\x26quot;,true);\n    xhr.send();\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22actionscript\x22\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n    xhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x22￼GET\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/segmentfault.com\/u\/trigkit4\/\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\n    xhr.send();\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e代码与之前的区别就在于相对路径换成了其他域的绝对路径，也就是你要跨域访问的接口地址。\x3c\/p\x3e\n\x3cp\x3e服务器端对于CORS的支持，主要就是通过设置Access-Control-Allow-Origin来进行的。如果浏览器检测到相应的设置，就可以允许Ajax进行跨域的访问。关于CORS更多了解可以看下阮一峰老师的这一篇文章：\x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2016\/04\/cors.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e跨域资源共享 CORS 详解\x3c\/a\x3e\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cp\x3eCORS和JSONP对比\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eJSONP只能实现GET请求，而CORS支持所有类型的HTTP请求。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e使用CORS，开发者可以使用普通的XMLHttpRequest发起请求和获得数据，比起JSONP有更好的错误处理。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eJSONP主要被老的浏览器支持，它们往往不支持CORS，而绝大多数现代浏览器都已经支持了CORS）。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3eCORS与JSONP相比，无疑更为先进、方便和可靠。\x3c\/p\x3e\n\x3ch4\x3e7. 通过window.name跨域\x3c\/h4\x3e\n\x3cblockquote\x3e\x3cp\x3ewindow对象有个name属性，该属性有个特征：即在一个窗口(window)的生命周期内,窗口载入的所有的页面都是共享一个window.name的，每个页面对window.name都有读写的权限，window.name是持久存在一个窗口载入过的所有页面中的，并不会因新页面的载入而进行重置。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e比如：我们在任意一个页面输入\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22window.name = \x26quot;My window\x27s name\x26quot;;\nsetTimeout(function(){\n    window.location.href = \x26quot;http:\/\/damonare.cn\/\x26quot;;\n},1000)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.name = \x3cspan class=\x22hljs-string\x22\x3e\x22My window\x27s name\x22\x3c\/span\x3e;\nsetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.location.href = \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/damonare.cn\/\x22\x3c\/span\x3e;\n},\x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e进入damonare.cn页面后我们再检测再检测 window.name :\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22window.name; \/\/ My window\x27s name\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.name; \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e My \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27s name\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看到，如果在一个标签里面跳转网页的话，我们的 window.name 是不会改变的。\x3cbr\x3e基于这个思想，我们可以在某个页面设置好 window.name 的值，然后跳转到另外一个页面。在这个页面中就可以获取到我们刚刚设置的 window.name 了。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e由于安全原因，浏览器始终会保持 window.name 是string 类型。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e同样这个方法也可以应用到和iframe的交互来：\x3cbr\x3e比如：我的页面(\x3ca href=\x22http:\/\/damonare.cn\/index.html)\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/damonare.cn\/index.html)\x3c\/a\x3e中内嵌了一个iframe：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3ciframe id=\x26quot;iframe\x26quot; src=\x26quot;http:\/\/www.google.com\/iframe.html\x26quot;\x3e\x3c\/iframe\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22iframe\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/www.google.com\/iframe.html\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在 iframe.html 中设置好了 window.name 为我们要传递的字符串。\x3cbr\x3e我们在 index.html 中写了下面的代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var iframe = document.getElementById(\x27iframe\x27);\nvar data = \x27\x27;\n\niframe.onload = function() {\n    data = iframe.contentWindow.name;\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e iframe = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27iframe\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e data = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n\niframe.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    data = iframe.contentWindow.name;\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eBoom!报错！肯定的，因为两个页面不同源嘛，想要解决这个问题可以这样干：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var iframe = document.getElementById(\x27iframe\x27);\nvar data = \x27\x27;\n\niframe.onload = function() {\n    iframe.onload = function(){\n        data = iframe.contentWindow.name;\n    }\n    iframe.src = \x27about:blank\x27;\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e iframe = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27iframe\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e data = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n\niframe.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    iframe.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        data = iframe.contentWindow.name;\n    }\n    iframe.src = \x3cspan class=\x22hljs-string\x22\x3e\x27about:blank\x27\x3c\/span\x3e;\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e或者将里面的 about:blank 替换成某个同源页面（about:blank，javascript: 和 data: 中的内容，继承了载入他们的页面的源。）\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e这种方法与 document.domain 方法相比，放宽了域名后缀要相同的限制，可以从任意页面获取 string 类型的数据。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e后记\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e其它诸如中间件跨域，服务器代理跨域，Flash URLLoader跨域，动态创建script标签（简化版本的jsonp）不作讨论。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e\x3cstrong\x3e参考文章：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000000718840#articleHeader1\x22\x3e详解js跨域问题\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/blog.csdn.net\/joyhen\/article\/details\/21631833\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e前端解决跨域问题的8种方案（最新最全）\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\n\x3cp\x3e原文地址：\x3ca href=\x22http:\/\/damonare.github.io\/2016\/10\/30\/%E5%89%8D%E7%AB%AF%E8%B7%A8%E5%9F%9F%E6%95%B4%E7%90%86\/#more\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e前端跨域总结\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e博主博客地址：\x3ca href=\x22http:\/\/damonare.cn\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDamonare的个人博客\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e相信每一个前端er对于跨域这两个字都不会陌生，在实际项目中应用也是比较多的。但跨域方法的多种多样实在让人目不暇接。老规矩，碰到这种情况，就只能自己总结一篇博客，作为记录。\x3c\/strong\x3e\x3c\/p\x3e\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007326671">https://segmentfault.com/a/1190000007326671</a></p><h2 id="原文标题">原文标题</h2><p>前端跨域整理</p><h2>本文链接：</h2><a href="https://alili.tech/archive/69c41ea6/" target="_blank">https://alili.tech/archive/69c41ea6/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>