<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="用两种不同的姿势来实现拖动排序"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>用两种不同的姿势来实现拖动排序 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/6o4jajwwzt/",
				"appid": "1613049289050283", 
				"title": "用两种不同的姿势来实现拖动排序 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-23T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/ieb727ehnvj/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/swmx5a8118/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f6o4jajwwzt%2f&text=%e7%94%a8%e4%b8%a4%e7%a7%8d%e4%b8%8d%e5%90%8c%e7%9a%84%e5%a7%bf%e5%8a%bf%e6%9d%a5%e5%ae%9e%e7%8e%b0%e6%8b%96%e5%8a%a8%e6%8e%92%e5%ba%8f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f6o4jajwwzt%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f6o4jajwwzt%2f&text=%e7%94%a8%e4%b8%a4%e7%a7%8d%e4%b8%8d%e5%90%8c%e7%9a%84%e5%a7%bf%e5%8a%bf%e6%9d%a5%e5%ae%9e%e7%8e%b0%e6%8b%96%e5%8a%a8%e6%8e%92%e5%ba%8f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f6o4jajwwzt%2f&title=%e7%94%a8%e4%b8%a4%e7%a7%8d%e4%b8%8d%e5%90%8c%e7%9a%84%e5%a7%bf%e5%8a%bf%e6%9d%a5%e5%ae%9e%e7%8e%b0%e6%8b%96%e5%8a%a8%e6%8e%92%e5%ba%8f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f6o4jajwwzt%2f&is_video=false&description=%e7%94%a8%e4%b8%a4%e7%a7%8d%e4%b8%8d%e5%90%8c%e7%9a%84%e5%a7%bf%e5%8a%bf%e6%9d%a5%e5%ae%9e%e7%8e%b0%e6%8b%96%e5%8a%a8%e6%8e%92%e5%ba%8f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e7%94%a8%e4%b8%a4%e7%a7%8d%e4%b8%8d%e5%90%8c%e7%9a%84%e5%a7%bf%e5%8a%bf%e6%9d%a5%e5%ae%9e%e7%8e%b0%e6%8b%96%e5%8a%a8%e6%8e%92%e5%ba%8f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f6o4jajwwzt%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f6o4jajwwzt%2f&title=%e7%94%a8%e4%b8%a4%e7%a7%8d%e4%b8%8d%e5%90%8c%e7%9a%84%e5%a7%bf%e5%8a%bf%e6%9d%a5%e5%ae%9e%e7%8e%b0%e6%8b%96%e5%8a%a8%e6%8e%92%e5%ba%8f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f6o4jajwwzt%2f&title=%e7%94%a8%e4%b8%a4%e7%a7%8d%e4%b8%8d%e5%90%8c%e7%9a%84%e5%a7%bf%e5%8a%bf%e6%9d%a5%e5%ae%9e%e7%8e%b0%e6%8b%96%e5%8a%a8%e6%8e%92%e5%ba%8f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f6o4jajwwzt%2f&title=%e7%94%a8%e4%b8%a4%e7%a7%8d%e4%b8%8d%e5%90%8c%e7%9a%84%e5%a7%bf%e5%8a%bf%e6%9d%a5%e5%ae%9e%e7%8e%b0%e6%8b%96%e5%8a%a8%e6%8e%92%e5%ba%8f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f6o4jajwwzt%2f&title=%e7%94%a8%e4%b8%a4%e7%a7%8d%e4%b8%8d%e5%90%8c%e7%9a%84%e5%a7%bf%e5%8a%bf%e6%9d%a5%e5%ae%9e%e7%8e%b0%e6%8b%96%e5%8a%a8%e6%8e%92%e5%ba%8f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">用两种不同的姿势来实现拖动排序</h1><div class="meta"><div class="postdate"><time datetime="2018-12-23" itemprop="datePublished">2018-12-23</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e前言\x3c\/h2\x3e\n\x3cblockquote\x3e\x3cp\x3e鲁迅说过：\x3cem\x3e“如果你的技术不好，那么你的姿势要多。”\x3c\/em\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVZSnT?w=500\x26amp;h=463\x22 src=\x22https:\/\/static.alili.tech\/img\/bVZSnT?w=500\x26amp;h=463\x22 alt=\x22鲁迅\x22 title=\x22鲁迅\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e公司的项目最近给侧边栏加了拖动排序的效果，类似于下面这种效果（鲁迅：不是我的下面），是下面的图?：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVZSo2?w=320\x26amp;h=481\x22 src=\x22https:\/\/static.alili.tech\/img\/bVZSo2?w=320\x26amp;h=481\x22 alt=\x22动画\x22 title=\x22动画\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3edrag拖动排序\x3c\/h2\x3e\n\x3cp\x3e说来惭愧，上图不是我写的，不然我还能吹一波，没有看代码，但闭着眼就能猜到用的是html5的drag系列的api，相关的API可以看MDN上的\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/Events\/dragstart\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e介绍\x3c\/a\x3e，我把文档拷一下做个介绍吧==\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3ccode\x3edrag\x3c\/code\x3e: 当元素或者选择的文本被拖动时触发\x3ccode\x3edrag\x3c\/code\x3e事件 (每几百毫秒)。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3edragstart\x3c\/code\x3e: 当用户开始拖动一个元素或者一个选择文本的时候\x3ccode\x3edragstart\x3c\/code\x3e事件就会触发。一般在这个动作里面处理被拖动元素的样式。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3edragend\x3c\/code\x3e: 拖动操作结束时触发,即松开鼠标操作。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3edragenter\x3c\/code\x3e: a拖到b中的时候触发。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3edragover\x3c\/code\x3e: 拖动过程不断触发。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3edragexit\x3c\/code\x3e: 元素不是被拖动目标时。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3edragleave\x3c\/code\x3e: a拖到b，不释放鼠标，再拖到c，离开b的时候触发。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3edrop\x3c\/code\x3e: 当一个元素或是选中的文字被拖拽释放到一个有效的释放目标位置时\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e上面的大部分都是对样式之类的处理，官方也给了例子，排除掉\x3ccode\x3edrag\x3c\/code\x3e和\x3ccode\x3edragover\x3c\/code\x3e这两个触发大户，大概的顺序是这样的：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVZS2q?w=276\x26amp;h=344\x22 src=\x22https:\/\/static.alili.tech\/img\/bVZS2q?w=276\x26amp;h=344\x22 alt=\x22顺序\x22 title=\x22顺序\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e首先，我肯定是实现了效果的，如下图所示的：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVZS3t?w=320\x26amp;h=554\x22 src=\x22https:\/\/static.alili.tech\/img\/bVZS3t?w=320\x26amp;h=554\x22 alt=\x22jijiDE\x22 title=\x22jijiDE\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e粗略介绍下流程吧，首先需要确定的是应该是什么效果，打个比方，我把a拖到了b上，b能很明显的感觉到，“啊，有什么奇怪的东西进入我的体内了”。但是b并不知道a是想在前面还是想在后面...这时候你就发现问题了吧，对！提问：“a和b到底谁在上面谁在下面？”所以我们刚开始要约定一个规范，把上面的a拖向下面的b，那么就把a排在b的下面，反之，把下面的a拖向上面的b，那么就把a放在b的上面～首先我需要这四个对象：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let dragObj, enterObj, dragIndex, enterIndex;\n\/\/ dragObj 被拖动的对象a，整个拖动过程它是不会变的\n\/\/ enterObj 最终进入的对象b，在drop里可以获取到\n\/\/ dragIndex a在列表中的下标\n\/\/ enterIndex b在列表的下标\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e dragObj, enterObj, dragIndex, enterIndex;\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ dragObj 被拖动的对象a，整个拖动过程它是不会变的\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ enterObj 最终进入的对象b，在drop里可以获取到\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ dragIndex a在列表中的下标\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ enterIndex b在列表的下标\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e通过比较\x3ccode\x3edragIndex\x3c\/code\x3e和\x3ccode\x3eenterIndex\x3c\/code\x3e的大小来决定a和b的关系，剩下的就是对dom进行操作了：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (dragIndex \x3c enterIndex) {\n  dragObj.remove();\n  enterObj.after(dragObj);\n} else if (dragIndex \x3e enterIndex) {\n  dragObj.remove();\n  enterObj.before(dragObj);\n}\x26nbsp;\x26nbsp;\x26nbsp;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (dragIndex \x26lt; enterIndex) {\n  dragObj.remove();\n  enterObj.after(dragObj);\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (dragIndex \x26gt; enterIndex) {\n  dragObj.remove();\n  enterObj.before(dragObj);\n}\x26nbsp;\x26nbsp;\x26nbsp;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e是不是相当简单了\x3ca href=\x22https:\/\/shiyangzhaoa.github.io\/sort-drag\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e效果预览\x3c\/a\x3e (chrome下观看)\x3cbr\x3e\x3cb\x3e\x3ca href=\x22https:\/\/github.com\/shiyangzhaoa\/sort-drag\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e源码\x3c\/a\x3e\x3c\/b\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e更好的实现--mouse\x3c\/h2\x3e\n\x3cp\x3e直接看看效果吧，也可以做个比较：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVZVED?w=320\x26amp;h=814\x22 src=\x22https:\/\/static.alili.tech\/img\/bVZVED?w=320\x26amp;h=814\x22 alt=\x22效果\x22 title=\x22效果\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/shiyangzhaoa.github.io\/sort-mouse\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e预览效果\x3c\/a\x3e\x3cbr\x3e使用到的api:\x3ccode\x3eonmousedown\x3c\/code\x3e, \x3ccode\x3eonmousemove\x3c\/code\x3e, \x3ccode\x3eonmouseup\x3c\/code\x3e,其实这些大家多多少少应该会用过，但我还是在这里粗略介绍下：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3ccode\x3eonmousedown\x3c\/code\x3e: 在当前元素上点击鼠标按键时会触发\x3ccode\x3emousedown\x3c\/code\x3e事件，有人问了，那这个和\x3ccode\x3eclick\x3c\/code\x3e有什么区别呢，区别是 click = mousedown \x2b mouseup，然后是，click鼠标左键触发，mousedown鼠标点击即会触发。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eonmousemove\x3c\/code\x3e: 当用户在当前元素上移动鼠标时会触发mousemove事件,就是“拖动元素。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eonmouseup\x3c\/code\x3e： 当用户在当前元素上放开鼠标某个按键时会触发mouseup事件。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e整个实现过程也比上面的那一种要复杂的多，不同与\x3ccode\x3edrag\x3c\/code\x3e,\x3ccode\x3edrag\x3c\/code\x3e自己能感知元素从a移动到了b中或者从b中离开，而鼠标事件不行。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e拖动注意点\x3c\/h3\x3e\n\x3cp\x3e这样一个列表：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVZU0X?w=352\x26amp;h=472\x22 src=\x22https:\/\/static.alili.tech\/img\/bVZU0X?w=352\x26amp;h=472\x22 alt=\x22还是他们\x22 title=\x22还是他们\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e假设我点了“小强”，“小强”被我选中，我怎么去实现拖动的效果呢？元素本身是没有拖动这个说法的，我能做到的就是动态的改变它的位置，那就是在\x3ccode\x3eonmousemove\x3c\/code\x3e的时候动态的去改变了，改变元素位置且不影响到其他元素排布的，那就是\x3ccode\x3eabsolute\x3c\/code\x3e了。先实现拖动的效果，大概就是这样：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/在onmousedown的时候记下必要的信息,将小强的position改成absolute\nconst startY = event.clientY;\n\/\/在onmousemove记录下鼠标在y轴上移动的距离，横行的话就是x\nconst currentTop = parseInt(startTop) \x2b (moveY - startY);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/在onmousedown的时候记下必要的信息,将小强的position改成absolute\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e startY = event.clientY;\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/在onmousemove记录下鼠标在y轴上移动的距离，横行的话就是x\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e currentTop = \x3cspan class=\x22hljs-built_in\x22\x3eparseInt\x3c\/span\x3e(startTop) \x2b (moveY - startY);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样基本的拖动问题是解决了，元素最起码是可以拖动起来了。这里需要注意的是，只有“小强”的位置是\x3ccode\x3eabsolute\x3c\/code\x3e，这时候“小明”就会被小强遮住，所以我们这里需要一个元素“占位”：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv class=\x26quot;item hold\x26quot;\x3e\x3cdiv\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22item hold\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e--“进来了吗？”  --“不是早就进来了”\x3c\/h3\x3e\n\x3cp\x3e各位乘客系好安全带，我要开车了...\x3cbr\x3e理想的效果应该是这样的，“小强”向下拖动，距离“小明”底部小于一半时，“小明”就应该给“小强”让路，“小明”要知道小强什么时候进来了，然后\x3ccode\x3ehold\x3c\/code\x3e元素向下移动一格，说明小强“此时”已经在“小明”下面了：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22currentTop \x3e itemHeight \x2b itemHeight \/ 2;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3ecurrentTop \x26gt; itemHeight \x2b itemHeight \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e记录高度实在是没必要，我只需要记录“小强” \x3cb\x3e当前\x3c\/b\x3e 被拖动到“第几位”就可以了：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22currentIndex = Math.ceil((currentTop - itemHeight \/ 2) \/ itemHeight);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3ecurrentIndex = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.ceil((currentTop - itemHeight \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e) \/ itemHeight);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e只要拿到\x3ccode\x3eonmousedown\x3c\/code\x3e时的“小强”的“index”，与当前的比较，只要两者不相同，就需要移动\x3ccode\x3ehold\x3c\/code\x3e的位置，\x3ccode\x3ehold\x3c\/code\x3e元素的位置受当前index的影响：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (previousIndex !== currentIndex) { \/\/... }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (previousIndex !== currentIndex) { \x3cspan class=\x22hljs-comment\x22\x3e\/\/... }\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e此处省略的代码都是dom的操作，不做太多说明。此时我们并没有对拖动的元素做限制，元素能够被拖到盒子的外面，这样肯定是不可以的，做一个限制：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (currentIndex \x3c 0) {\n  currentIndex = 0;\n} else if (currentIndex \x3e listLength - 1) {\n  currentIndex = listLength - 1;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (currentIndex \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n  currentIndex = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (currentIndex \x26gt; listLength - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) {\n  currentIndex = listLength - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样不会限制的用户拖动的操作，我们只需要控制住index就好了，这样处理也方便的多。\x3cbr\x3e在用户\x3ccode\x3eonmouseup\x3c\/code\x3e的时候需要对监听器进行销毁：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22document.onmousemove = null;\ndocument.onmouseup = null;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.onmousemove = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.onmouseup = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e注意事项\x3c\/h3\x3e\n\x3cp\x3e类似于\x3ccode\x3e$$\x3c\/code\x3e和\x3ccode\x3equerySelectorAll\x3c\/code\x3e获取到的\x22数组\x22并不是“数组”，它有数组的部分特性，通过下图我们可以知道它是一个\x3ccode\x3eNodeList\x3c\/code\x3e，并不是\x3ccode\x3eArray\x3c\/code\x3e，它是有\x3ccode\x3eforEach\x3c\/code\x3e方法的，但是它并没有\x3ccode\x3emap\x3c\/code\x3e、\x3ccode\x3efind\x3c\/code\x3e等一系列方法，使用的时候还需注意。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVZU48?w=2098\x26amp;h=296\x22 src=\x22https:\/\/static.alili.tech\/img\/bVZU48?w=2098\x26amp;h=296\x22 alt=\x22list\x22 title=\x22list\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e源码\x3c\/h3\x3e\n\x3cp\x3e\x3cb\x3e\x3ca href=\x22https:\/\/github.com\/shiyangzhaoa\/sort-mouse\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e细节还是看源码吧\x3c\/a\x3e\x3c\/b\x3e 我在刚开始写的时候碰到很多坑，dom操作的时候更是，尤其在上下来回拖动的时候，具体的不再多讲，因为实在有点晚了。对不起，我今晚玩游戏玩到十一点半，我有罪==，洗个澡啥的，弄的很晚。\x3cbr\x3e享受coding，热爱生活，拜～\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVZU5Z?w=880\x26amp;h=788\x22 src=\x22https:\/\/static.alili.tech\/img\/bVZU5Z?w=880\x26amp;h=788\x22 alt=\x22coding\x22 title=\x22coding\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>用两种不同的姿势来实现拖动排序</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000012335153">https://segmentfault.com/a/1190000012335153</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/6o4jajwwzt/" target="_blank">https://alili.tech/archive/6o4jajwwzt/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>