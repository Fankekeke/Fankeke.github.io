<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="前端魔法堂——调用栈，异常实例中的宝藏"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>前端魔法堂——调用栈，异常实例中的宝藏 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/6z895b4c92n/",
				"appid": "1613049289050283", 
				"title": "前端魔法堂——调用栈，异常实例中的宝藏 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-27T02:30:13"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/hlqngruevbg/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/jaxn415ekj/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f6z895b4c92n%2f&text=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e8%b0%83%e7%94%a8%e6%a0%88%ef%bc%8c%e5%bc%82%e5%b8%b8%e5%ae%9e%e4%be%8b%e4%b8%ad%e7%9a%84%e5%ae%9d%e8%97%8f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f6z895b4c92n%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f6z895b4c92n%2f&text=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e8%b0%83%e7%94%a8%e6%a0%88%ef%bc%8c%e5%bc%82%e5%b8%b8%e5%ae%9e%e4%be%8b%e4%b8%ad%e7%9a%84%e5%ae%9d%e8%97%8f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f6z895b4c92n%2f&title=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e8%b0%83%e7%94%a8%e6%a0%88%ef%bc%8c%e5%bc%82%e5%b8%b8%e5%ae%9e%e4%be%8b%e4%b8%ad%e7%9a%84%e5%ae%9d%e8%97%8f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f6z895b4c92n%2f&is_video=false&description=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e8%b0%83%e7%94%a8%e6%a0%88%ef%bc%8c%e5%bc%82%e5%b8%b8%e5%ae%9e%e4%be%8b%e4%b8%ad%e7%9a%84%e5%ae%9d%e8%97%8f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e8%b0%83%e7%94%a8%e6%a0%88%ef%bc%8c%e5%bc%82%e5%b8%b8%e5%ae%9e%e4%be%8b%e4%b8%ad%e7%9a%84%e5%ae%9d%e8%97%8f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f6z895b4c92n%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f6z895b4c92n%2f&title=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e8%b0%83%e7%94%a8%e6%a0%88%ef%bc%8c%e5%bc%82%e5%b8%b8%e5%ae%9e%e4%be%8b%e4%b8%ad%e7%9a%84%e5%ae%9d%e8%97%8f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f6z895b4c92n%2f&title=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e8%b0%83%e7%94%a8%e6%a0%88%ef%bc%8c%e5%bc%82%e5%b8%b8%e5%ae%9e%e4%be%8b%e4%b8%ad%e7%9a%84%e5%ae%9d%e8%97%8f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f6z895b4c92n%2f&title=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e8%b0%83%e7%94%a8%e6%a0%88%ef%bc%8c%e5%bc%82%e5%b8%b8%e5%ae%9e%e4%be%8b%e4%b8%ad%e7%9a%84%e5%ae%9d%e8%97%8f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f6z895b4c92n%2f&title=%e5%89%8d%e7%ab%af%e9%ad%94%e6%b3%95%e5%a0%82%e2%80%94%e2%80%94%e8%b0%83%e7%94%a8%e6%a0%88%ef%bc%8c%e5%bc%82%e5%b8%b8%e5%ae%9e%e4%be%8b%e4%b8%ad%e7%9a%84%e5%ae%9d%e8%97%8f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">前端魔法堂——调用栈，异常实例中的宝藏</h1><div class="meta"><div class="postdate"><time datetime="2018-12-27" itemprop="datePublished">2018-12-27</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e前言\x3c\/h2\x3e\n\x3cp\x3e 在上一篇\x3ca href=\x22http:\/\/www.cnblogs.com\/fsjohnhuang\/p\/7685144.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e《前端魔法堂——异常不仅仅是try\/catch》\x3c\/a\x3e中我们描述出一副异常及如何捕获异常的画像，但仅仅如此而已。试想一下，我们穷尽一切捕获异常实例，然后仅仅为告诉用户,运维和开发人员页面报了一个哪个哪个类型的错误吗？答案是否定的。我们的目的是收集\x3cstrong\x3e刚刚足够\x3c\/strong\x3e的现场证据，好让我们能马上重现问题，快速修复，提供更优质的用户体验。那么问题就落在\x3cstrong\x3e“收集足够的现场证据”\x3c\/strong\x3e，那么我们又需要哪些现场证据呢？那就是\x3cstrong\x3e异常信息\x3c\/strong\x3e，\x3cstrong\x3e调用栈\x3c\/strong\x3e和\x3cstrong\x3e栈帧局部状态\x3c\/strong\x3e。（\x3cstrong\x3e异常信息\x3c\/strong\x3e我们已经获取了）\x3cbr\x3e 本文将围绕上\x3cstrong\x3e调用栈\x3c\/strong\x3e和\x3cstrong\x3e栈帧局部状态\x3c\/strong\x3e叙述，准开开车^_^\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e概要\x3c\/h2\x3e\n\x3cp\x3e 本篇将叙述如下内容：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3ca href=\x22#\x22\x3e什么是调用栈？\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22#\x22\x3e如何获取调用栈？\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22#\x22\x3e什么是栈帧局部状态？又如何获取呢？\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e一.什么是调用栈？\x3c\/h2\x3e\n\x3cp\x3e 既然我们要获取调用栈信息，那么起码要弄清楚什么是调用栈吧！下面我们分别从两个层次来理解～\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e印象派\x3c\/h3\x3e\n\x3cp\x3e 倘若主要工作内容为应用开发，那么我们对调用栈的印象如下就差不多了：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function funcA (a, b){\n  return a \x2b b\n}\n\nfunction funcB (a){\n  let b = 3\n  return funcA(a, b)\n}\n\nfunction main(){\n  let a = 5\n  funcB(a)\n}\n\nmain()\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3efunction funcA (\x3cspan class=\x22hljs-selector-tag\x22\x3ea\x3c\/span\x3e, b){\n  return \x3cspan class=\x22hljs-selector-tag\x22\x3ea\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-selector-tag\x22\x3eb\x3c\/span\x3e\n}\n\nfunction funcB (a){\n  let \x3cspan class=\x22hljs-selector-tag\x22\x3eb\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\n  return funcA(\x3cspan class=\x22hljs-selector-tag\x22\x3ea\x3c\/span\x3e, b)\n}\n\nfunction main(){\n  let \x3cspan class=\x22hljs-selector-tag\x22\x3ea\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e\n  funcB(a)\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 那么每次调用函数时就会生成一个栈帧，并压入调用栈，栈帧中存储对应函数的局部变量；当该函数执行完成后，其对应的栈帧就会弹出调用栈。\x3cbr\x3e 因此调用\x3ccode\x3emain()\x3c\/code\x3e时，调用栈如下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22----------------\x3c--栈顶\n|function: main|\n|let a = 5     |\n|return void(0)|\n----------------\x3c--栈底\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs livecodeserver\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e----------------\x26lt;--栈顶\x3c\/span\x3e\n|\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e: \x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e|\x3c\/span\x3e\n|let \x3cspan class=\x22hljs-keyword\x22\x3ea\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e     |\n|\x3cspan class=\x22hljs-literal\x22\x3ereturn\x3c\/span\x3e void(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)|\n\x3cspan class=\x22hljs-comment\x22\x3e----------------\x26lt;--栈底\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 调用\x3ccode\x3efuncB()\x3c\/code\x3e时，调用栈如下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22----------------\x3c--栈顶\n|function:funcB|\n|let b = 3     |\n|return funcA()|\n----------------\n|function: main|\n|let a = 5     |\n|return void(0)|\n----------------\x3c--栈底\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs asciidoc\x22\x3e\x3ccode\x3e----------------\x26lt;--栈顶\n|function:funcB|\n|let b = 3     |\n\x3cspan class=\x22hljs-section\x22\x3e|return funcA()|\n----------------\x3c\/span\x3e\n|function: main|\n|let a = 5     |\n|return void(0)|\n----------------\x26lt;--栈底\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 调用\x3ccode\x3efuncA()\x3c\/code\x3e时，调用栈如下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22----------------\x3c--栈顶\n|function:funcA|\n|return a \x2b b  |\n----------------\n|function:funcB|\n|let b = 3     |\n|return funcA()|\n----------------\n|function: main|\n|let a = 5     |\n|return void(0)|\n----------------\x3c--栈底\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs asciidoc\x22\x3e\x3ccode\x3e----------------\x26lt;--栈顶\n|function:funcA|\n\x3cspan class=\x22hljs-section\x22\x3e|return a \x2b b  |\n----------------\x3c\/span\x3e\n|function:funcB|\n|let b = 3     |\n\x3cspan class=\x22hljs-section\x22\x3e|return funcA()|\n----------------\x3c\/span\x3e\n|function: main|\n|let a = 5     |\n|return void(0)|\n----------------\x26lt;--栈底\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e \x3ccode\x3efuncA()\x3c\/code\x3e执行完成后，调用栈如下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22----------------\x3c--栈顶\n|function:funcB|\n|let b = 3     |\n|return funcA()|\n----------------\n|function: main|\n|let a = 5     |\n|return void(0)|\n----------------\x3c--栈底\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs asciidoc\x22\x3e\x3ccode\x3e----------------\x26lt;--栈顶\n|function:funcB|\n|let b = 3     |\n\x3cspan class=\x22hljs-section\x22\x3e|return funcA()|\n----------------\x3c\/span\x3e\n|function: main|\n|let a = 5     |\n|return void(0)|\n----------------\x26lt;--栈底\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e \x3ccode\x3efuncB()\x3c\/code\x3e执行完成后，调用栈如下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22----------------\x3c--栈顶\n|function: main|\n|let a = 5     |\n|return void(0)|\n----------------\x3c--栈底\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs livecodeserver\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e----------------\x26lt;--栈顶\x3c\/span\x3e\n|\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e: \x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e|\x3c\/span\x3e\n|let \x3cspan class=\x22hljs-keyword\x22\x3ea\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e     |\n|\x3cspan class=\x22hljs-literal\x22\x3ereturn\x3c\/span\x3e void(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)|\n\x3cspan class=\x22hljs-comment\x22\x3e----------------\x26lt;--栈底\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e \x3ccode\x3emain()\x3c\/code\x3e执行完成后，调用栈如下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22----------------\x3c--栈顶\n----------------\x3c--栈底\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs brainfuck\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e栈顶\x3c\/span\x3e\n\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26lt;\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e栈底\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 现在我们对调用栈有了大概的印象了，但大家有没有留意上面记录\x22栈帧中存储对应函数的局部变量\x22，栈帧中仅仅存储对应函数的局部变量，那么入参呢？难道会作为局部变量吗？这个我们要从理论的层面才能得到解答呢。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e理论派\x3c\/h3\x3e\n\x3cp\x3e 这里我们要引入一个简单的C程序，透过其对应的汇编指令来讲解了。我会尽我所能用通俗易懂的语言描述这一切的，若有错误请各位指正！！\x3c\/p\x3e\n\x3ch4\x3e前提知识\x3c\/h4\x3e\n\x3col\x3e\n\x3cli\x3eIntel X86架构中调用栈的栈底位于高位地址，而栈顶位于低位地址。(和印象派中示意图的方向刚好相反)\x3c\/li\x3e\n\x3cli\x3e调用栈涉及的寄存器有\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ESP\/RSP, 暂存栈顶地址\nEBP\/RBP, 暂存栈帧起始地址\nEIP, 暂存下一个CPU指令的内存地址，当CPU执行完当前指令后，从EIP读取下一条指令的内存地址，然后继续执行\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs x86asm\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3eESP\x3c\/span\x3e\/\x3cspan class=\x22hljs-built_in\x22\x3eRSP\x3c\/span\x3e, 暂存栈顶地址\n\x3cspan class=\x22hljs-built_in\x22\x3eEBP\x3c\/span\x3e\/\x3cspan class=\x22hljs-built_in\x22\x3eRBP\x3c\/span\x3e, 暂存栈帧起始地址\n\x3cspan class=\x22hljs-built_in\x22\x3eEIP\x3c\/span\x3e, 暂存下一个\x3cspan class=\x22hljs-meta\x22\x3eCPU\x3c\/span\x3e指令的内存地址，当\x3cspan class=\x22hljs-meta\x22\x3eCPU\x3c\/span\x3e执行完当前指令后，从\x3cspan class=\x22hljs-built_in\x22\x3eEIP\x3c\/span\x3e读取下一条指令的内存地址，然后继续执行\x3c\/code\x3e\x3c\/pre\x3e\n\x3col\x3e\x3cli\x3e操作指令\x3c\/li\x3e\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22PUSH \x3cOPRD\x3e，将ESP向低位地址移动操作数所需的空间，然后将操作数压入调用栈中\nPOP \x3cOPRD\x3e，从调用栈中读取数据暂存到操作数指定的寄存器或内存空间中，然后向高位地址移动操作数对应的空间字节数\nMOV \x3cSRC\x3e,\x3cDST\x3e，数据传送指令。用于将一个数据从源地址传送到目标地址，且不破坏源地址的内容\nADD \x3cOPRD1\x3e,\x3cOPRD2\x3e，两数相加不带进位，然后将结果保存到目标地址上\nRET，相当于POP EIP。就是从堆栈中出栈，然后将值保存到EIP寄存器中\nLEAVE，相当于MOV EBP ESP，然后再POP EBP。就是将栈顶指向当前栈帧地址，然后将调用者的栈帧地址暂存到EBP中\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs x86asm\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3ePUSH\x3c\/span\x3e \x26lt;OPRD\x26gt;，将\x3cspan class=\x22hljs-built_in\x22\x3eESP\x3c\/span\x3e向低位地址移动操作数所需的空间，然后将操作数压入调用栈中\n\x3cspan class=\x22hljs-keyword\x22\x3ePOP\x3c\/span\x3e \x26lt;OPRD\x26gt;，从调用栈中读取数据暂存到操作数指定的寄存器或内存空间中，然后向高位地址移动操作数对应的空间字节数\n\x3cspan class=\x22hljs-keyword\x22\x3eMOV\x3c\/span\x3e \x26lt;SRC\x26gt;,\x26lt;DST\x26gt;，数据传送指令。用于将一个数据从源地址传送到目标地址，且不破坏源地址的内容\n\x3cspan class=\x22hljs-keyword\x22\x3eADD\x3c\/span\x3e \x26lt;OPRD1\x26gt;,\x26lt;OPRD2\x26gt;，两数相加不带进位，然后将结果保存到目标地址上\n\x3cspan class=\x22hljs-keyword\x22\x3eRET\x3c\/span\x3e，相当于\x3cspan class=\x22hljs-keyword\x22\x3ePOP\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eEIP\x3c\/span\x3e。就是从堆栈中出栈，然后将值保存到\x3cspan class=\x22hljs-built_in\x22\x3eEIP\x3c\/span\x3e寄存器中\n\x3cspan class=\x22hljs-keyword\x22\x3eLEAVE\x3c\/span\x3e，相当于\x3cspan class=\x22hljs-keyword\x22\x3eMOV\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eEBP\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eESP\x3c\/span\x3e，然后再\x3cspan class=\x22hljs-keyword\x22\x3ePOP\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eEBP\x3c\/span\x3e。就是将栈顶指向当前栈帧地址，然后将调用者的栈帧地址暂存到\x3cspan class=\x22hljs-built_in\x22\x3eEBP\x3c\/span\x3e中\x3c\/code\x3e\x3c\/pre\x3e\n\x3col\x3e\x3cli\x3e每个函数调用前汇编器都会加入以下前言(Prolog)，用于保存栈帧和返回地址\x3c\/li\x3e\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22push   %rbp      ;将调用者的栈帧指针压入调用栈\nmov    %rsp,%rbp ;现在栈顶指向刚入栈的RBP内容，要将其设置为栈帧的起始位置\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs perl\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3epush\x3c\/span\x3e   %rbp      ;将调用者的栈帧指针压入调用栈\nmov    %rsp,%rbp ;现在栈顶指向刚入栈的RBP内容，要将其设置为栈帧的起始位置\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 现在们结合实例来理解吧！\x3cbr\x3eC语言\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22#include \x3cstdio.h\x3e\n\nint add(int a, int b){\n  return a \x2b b;\n}\nint add2(int a){\n  int sum = add(0, a);\n  return sum \x2b 2;\n}\n\nvoid main(){\n  add2(2);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cpp\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-meta\x22\x3e#\x3cspan class=\x22hljs-meta-keyword\x22\x3einclude\x3c\/span\x3e \x3cspan class=\x22hljs-meta-string\x22\x3e\x26lt;stdio.h\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eint\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-keyword\x22\x3eint\x3c\/span\x3e a, \x3cspan class=\x22hljs-keyword\x22\x3eint\x3c\/span\x3e b)\x3c\/span\x3e\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e a \x2b b;\n}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eint\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd2\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-keyword\x22\x3eint\x3c\/span\x3e a)\x3c\/span\x3e\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eint\x3c\/span\x3e sum = add(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, a);\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e sum \x2b \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n  add2(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后执行以下命令编译带调试信息的可执行文件，和dump文件\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$ gcc -g -o main main.c\n$ objdump -d main \x3e main.dump\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs elixir\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-variable\x22\x3e$ \x3c\/span\x3egcc -g -o main main.c\n\x3cspan class=\x22hljs-variable\x22\x3e$ \x3c\/span\x3eobjdump -d main \x26gt; main.dump\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e下面我们截取main、add2和add对应的汇编指令来讲解\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3emain函数对应的汇编指令\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x220x40050f \x3cmain\x3e                 push   %rbp\n0x400510 \x3cmain\x2b1\x3e               mov    %rsp,%rbp\n;将2暂存到寄存器EDI中\n0x400513 \x3cmain\x2b4\x3e               mov    $0x2,%edi\n;执行call指令前，EIP寄存器已经存储下一条指令的地址0x40051d了\n;首先将EIP寄存器的值入栈，当函数返回时用于恢复之前的执行序列\n;然后才是执行JUMP指令跳转到add2函数中开始执行其第一条指令\n0x400518 \x3cmain\x2b9\x3e               callq  0x4004ea \x3cadd2\x3e\n;什么都不做\n0x40051d \x3cmain\x2b14\x3e              nop\n;设置RBP为指向main函数调用方的栈帧地址\n0x40051e \x3cmain\x2b15\x3e              pop    %rbp\n;设置EIP指向main函数返回后将要执行的指令的地址\n0x40051f \x3cmain\x2b16\x3e              retq\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lsl\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-number\x22\x3e0x40050f\x3c\/span\x3e \x26lt;main\x26gt;                 push   %rbp\n\x3cspan class=\x22hljs-number\x22\x3e0x400510\x3c\/span\x3e \x26lt;main\x2b\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\x26gt;               mov    %rsp,%rbp\n;将\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e暂存到寄存器EDI中\n\x3cspan class=\x22hljs-number\x22\x3e0x400513\x3c\/span\x3e \x26lt;main\x2b\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e\x26gt;               mov    $\x3cspan class=\x22hljs-number\x22\x3e0x2\x3c\/span\x3e,%edi\n;执行call指令前，EIP寄存器已经存储下一条指令的地址\x3cspan class=\x22hljs-number\x22\x3e0x40051d\x3c\/span\x3e了\n;首先将EIP寄存器的值入栈，当函数返回时用于恢复之前的执行序列\n;然后才是执行JUMP指令跳转到add2函数中开始执行其第一条指令\n\x3cspan class=\x22hljs-number\x22\x3e0x400518\x3c\/span\x3e \x26lt;main\x2b\x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3e\x26gt;               callq  \x3cspan class=\x22hljs-number\x22\x3e0x4004ea\x3c\/span\x3e \x26lt;add2\x26gt;\n;什么都不做\n\x3cspan class=\x22hljs-number\x22\x3e0x40051d\x3c\/span\x3e \x26lt;main\x2b\x3cspan class=\x22hljs-number\x22\x3e14\x3c\/span\x3e\x26gt;              nop\n;设置RBP为指向main函数调用方的栈帧地址\n\x3cspan class=\x22hljs-number\x22\x3e0x40051e\x3c\/span\x3e \x26lt;main\x2b\x3cspan class=\x22hljs-number\x22\x3e15\x3c\/span\x3e\x26gt;              pop    %rbp\n;设置EIP指向main函数返回后将要执行的指令的地址\n\x3cspan class=\x22hljs-number\x22\x3e0x40051f\x3c\/span\x3e \x26lt;main\x2b\x3cspan class=\x22hljs-number\x22\x3e16\x3c\/span\x3e\x26gt;              retq\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e下面是执行add2函数第一条指令前的调用栈快照\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b 高位地址\n99 |   110    | -- 存放main函数调用方的栈帧地址 \x3c-- EBP\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n98 | 0x40051d | -- EIP的值，存放add2返回后将执行的指令的地址 \x3c-- ESP\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b 低位地址\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs asciidoc\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x2b\x2b 高位地址\n\x3cspan class=\x22hljs-section\x22\x3e99 |   110    | -- 存放main函数调用方的栈帧地址 \x26lt;-- EBP\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n98 | 0x40051d | -- EIP的值，存放add2返回后将执行的指令的地址 \x26lt;-- ESP\n\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x2b\x2b 低位地址\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3eadd2函数对应的汇编指令\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x220x4004ea \x3cadd2\x3e                 push   %rbp\n0x4004eb \x3cadd2\x2b1\x3e               mov    %rsp,%rbp\n0x4004ee \x3cadd2\x2b4\x3e               sub    $0x18,%rsp      ;栈顶向低位移动24个字节，为后续操作预留堆栈空间\n0x4004f2 \x3cadd2\x2b8\x3e               mov    %edi,-0x14(%rbp);从EDI寄存器中读取参数，并存放到堆栈空间中\n0x4004f5 \x3cadd2\x2b11\x3e              mov    -0x14(%rbp),%eax;从堆栈空间中读取参数，放进EAX寄存器中\n0x4004f8 \x3cadd2\x2b14\x3e              mov    %eax,%esi       ;从EAX寄存器中读取参数，存放到ESI寄存器中\n0x4004fa \x3cadd2\x2b16\x3e              mov    $0x0,%edi       ;将0存放到EDI寄存器中\n;执行call指令前，EIP寄存器已经存储下一条指令的地址0x400504了\n;首先将EIP寄存器的值入栈，当函数返回时用于恢复之前的执行序列\n;然后才是执行JUMP指令跳转到add函数中开始执行其第一条指令\n0x4004ff \x3cadd2\x2b21\x3e              callq  0x4004d6 \x3cadd\x3e\n0x400504 \x3cadd2\x2b26\x3e              mov    %eax,-0x4(%rbp) ;读取add的返回值(存储在EAX寄存器中)，存放到堆栈空间中\n0x400507 \x3cadd2\x2b29\x3e              mov    -0x4(%rbp),%eax ;又将add的返回值存放到EAX寄存器中(这是有多无聊啊～～)\n0x40050a \x3cadd2\x2b32\x3e              add    $0x2,%eax       ;读取EAX寄存器的值与2相加，结果存放到EAX寄存器中\n0x40050d \x3cadd2\x2b35\x3e              leaveq                 ;让栈顶指针指向main函数的栈帧地址，然后让EBP指向main函数的栈帧地址\n0x40050e \x3cadd2\x2b36\x3e              retq                   ;让EIP指向add2返回后将执行的指令的地址\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lsl\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-number\x22\x3e0x4004ea\x3c\/span\x3e \x26lt;add2\x26gt;                 push   %rbp\n\x3cspan class=\x22hljs-number\x22\x3e0x4004eb\x3c\/span\x3e \x26lt;add2\x2b\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\x26gt;               mov    %rsp,%rbp\n\x3cspan class=\x22hljs-number\x22\x3e0x4004ee\x3c\/span\x3e \x26lt;add2\x2b\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e\x26gt;               sub    $\x3cspan class=\x22hljs-number\x22\x3e0x18\x3c\/span\x3e,%rsp      ;栈顶向低位移动\x3cspan class=\x22hljs-number\x22\x3e24\x3c\/span\x3e个字节，为后续操作预留堆栈空间\n\x3cspan class=\x22hljs-number\x22\x3e0x4004f2\x3c\/span\x3e \x26lt;add2\x2b\x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e\x26gt;               mov    %edi,\x3cspan class=\x22hljs-number\x22\x3e-0x14\x3c\/span\x3e(%rbp);从EDI寄存器中读取参数，并存放到堆栈空间中\n\x3cspan class=\x22hljs-number\x22\x3e0x4004f5\x3c\/span\x3e \x26lt;add2\x2b\x3cspan class=\x22hljs-number\x22\x3e11\x3c\/span\x3e\x26gt;              mov    \x3cspan class=\x22hljs-number\x22\x3e-0x14\x3c\/span\x3e(%rbp),%eax;从堆栈空间中读取参数，放进EAX寄存器中\n\x3cspan class=\x22hljs-number\x22\x3e0x4004f8\x3c\/span\x3e \x26lt;add2\x2b\x3cspan class=\x22hljs-number\x22\x3e14\x3c\/span\x3e\x26gt;              mov    %eax,%esi       ;从EAX寄存器中读取参数，存放到ESI寄存器中\n\x3cspan class=\x22hljs-number\x22\x3e0x4004fa\x3c\/span\x3e \x26lt;add2\x2b\x3cspan class=\x22hljs-number\x22\x3e16\x3c\/span\x3e\x26gt;              mov    $\x3cspan class=\x22hljs-number\x22\x3e0x0\x3c\/span\x3e,%edi       ;将\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e存放到EDI寄存器中\n;执行call指令前，EIP寄存器已经存储下一条指令的地址\x3cspan class=\x22hljs-number\x22\x3e0x400504\x3c\/span\x3e了\n;首先将EIP寄存器的值入栈，当函数返回时用于恢复之前的执行序列\n;然后才是执行JUMP指令跳转到add函数中开始执行其第一条指令\n\x3cspan class=\x22hljs-number\x22\x3e0x4004ff\x3c\/span\x3e \x26lt;add2\x2b\x3cspan class=\x22hljs-number\x22\x3e21\x3c\/span\x3e\x26gt;              callq  \x3cspan class=\x22hljs-number\x22\x3e0x4004d6\x3c\/span\x3e \x26lt;add\x26gt;\n\x3cspan class=\x22hljs-number\x22\x3e0x400504\x3c\/span\x3e \x26lt;add2\x2b\x3cspan class=\x22hljs-number\x22\x3e26\x3c\/span\x3e\x26gt;              mov    %eax,\x3cspan class=\x22hljs-number\x22\x3e-0x4\x3c\/span\x3e(%rbp) ;读取add的返回值(存储在EAX寄存器中)，存放到堆栈空间中\n\x3cspan class=\x22hljs-number\x22\x3e0x400507\x3c\/span\x3e \x26lt;add2\x2b\x3cspan class=\x22hljs-number\x22\x3e29\x3c\/span\x3e\x26gt;              mov    \x3cspan class=\x22hljs-number\x22\x3e-0x4\x3c\/span\x3e(%rbp),%eax ;又将add的返回值存放到EAX寄存器中(这是有多无聊啊～～)\n\x3cspan class=\x22hljs-number\x22\x3e0x40050a\x3c\/span\x3e \x26lt;add2\x2b\x3cspan class=\x22hljs-number\x22\x3e32\x3c\/span\x3e\x26gt;              add    $\x3cspan class=\x22hljs-number\x22\x3e0x2\x3c\/span\x3e,%eax       ;读取EAX寄存器的值与\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e相加，结果存放到EAX寄存器中\n\x3cspan class=\x22hljs-number\x22\x3e0x40050d\x3c\/span\x3e \x26lt;add2\x2b\x3cspan class=\x22hljs-number\x22\x3e35\x3c\/span\x3e\x26gt;              leaveq                 ;让栈顶指针指向main函数的栈帧地址，然后让EBP指向main函数的栈帧地址\n\x3cspan class=\x22hljs-number\x22\x3e0x40050e\x3c\/span\x3e \x26lt;add2\x2b\x3cspan class=\x22hljs-number\x22\x3e36\x3c\/span\x3e\x26gt;              retq                   ;让EIP指向add2返回后将执行的指令的地址\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e下面是执行完add2函数中\x3ccode\x3emov %rsp,%rbp\x3c\/code\x3e的调用栈快照\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b 高位地址\n99 |    110   | -- 存放main函数调用方的栈帧地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n98 | 0x40051d | -- 存放EIP的值，add2返回后将执行的指令的地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n97 |    99    | -- 存放add2函数调用方(即main函数)的栈帧地址\x3c-- ESP,EBP\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b 低位地址\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs asciidoc\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x2b\x2b 高位地址\n\x3cspan class=\x22hljs-section\x22\x3e99 |    110   | -- 存放main函数调用方的栈帧地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n\x3cspan class=\x22hljs-section\x22\x3e98 | 0x40051d | -- 存放EIP的值，add2返回后将执行的指令的地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n97 |    99    | -- 存放add2函数调用方(即main函数)的栈帧地址\x26lt;-- ESP,EBP\n\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x2b\x2b 低位地址\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e下面是执行add函数第一条指令前的调用栈快照\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b 高位地址\n99 |    110   | -- 存放main函数调用方的栈帧地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n98 | 0x40051d | -- 存放EIP的值，add2返回后将执行的指令的地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n97 |    99    | -- 存放add2函数调用方(即main函数)的栈帧地址\x3c-- EBP\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n96 |   0xXX   |\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n.................\n76 |   0x02   | -- 这是`mov %edi,-0x14(%rbp)`的执行结果\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n.................\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n73 |   0xXX   |\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n72 | 0x400504 | -- EIP的值，存放add返回后将执行的指令的地址 \x3c-- ESP\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b 低位地址\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs asciidoc\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x2b\x2b 高位地址\n\x3cspan class=\x22hljs-section\x22\x3e99 |    110   | -- 存放main函数调用方的栈帧地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n\x3cspan class=\x22hljs-section\x22\x3e98 | 0x40051d | -- 存放EIP的值，add2返回后将执行的指令的地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n\x3cspan class=\x22hljs-section\x22\x3e97 |    99    | -- 存放add2函数调用方(即main函数)的栈帧地址\x26lt;-- EBP\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n\x3cspan class=\x22hljs-section\x22\x3e96 |   0xXX   |\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n\x3cspan class=\x22hljs-code\x22\x3e.................\n76 |   0x02   | -- 这是`mov %edi,-0x14(%rbp)`的执行结果\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n.................\x3c\/span\x3e\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n73 |   0xXX   |\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n72 | 0x400504 | -- EIP的值，存放add返回后将执行的指令的地址 \x26lt;-- ESP\n\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x2b\x2b 低位地址\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eadd函数对应的汇编指令\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x220x4004d6 \x3cadd\x3e                  push   %rbp\n0x4004d7 \x3cadd\x2b1\x3e                mov    %rsp,%rbp\n0x4004da \x3cadd\x2b4\x3e                mov    %edi,-0x4(%rbp)\n0x4004dd \x3cadd\x2b7\x3e                mov    %esi,-0x8(%rbp)\n0x4004e0 \x3cadd\x2b10\x3e               mov    -0x4(%rbp),%edx\n0x4004e3 \x3cadd\x2b13\x3e               mov    -0x8(%rbp),%eax\n0x4004e6 \x3cadd\x2b16\x3e               add    %edx,%eax\n0x4004e8 \x3cadd\x2b18\x3e               pop    %rbp\n0x4004e9 \x3cadd\x2b19\x3e               retq\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs llvm\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-number\x22\x3e0x4004d6\x3c\/span\x3e \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e\x26gt;                  push   \x3cspan class=\x22hljs-symbol\x22\x3e%rbp\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e0x4004d7\x3c\/span\x3e \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e\x2b\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\x26gt;                mov    \x3cspan class=\x22hljs-symbol\x22\x3e%rsp\x3c\/span\x3e,\x3cspan class=\x22hljs-symbol\x22\x3e%rbp\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e0x4004da\x3c\/span\x3e \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e\x2b\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e\x26gt;                mov    \x3cspan class=\x22hljs-symbol\x22\x3e%edi\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e-0\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ex\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e(\x3cspan class=\x22hljs-symbol\x22\x3e%rbp\x3c\/span\x3e)\n\x3cspan class=\x22hljs-number\x22\x3e0x4004dd\x3c\/span\x3e \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e\x2b\x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e\x26gt;                mov    \x3cspan class=\x22hljs-symbol\x22\x3e%esi\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e-0\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ex\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e(\x3cspan class=\x22hljs-symbol\x22\x3e%rbp\x3c\/span\x3e)\n\x3cspan class=\x22hljs-number\x22\x3e0x4004e0\x3c\/span\x3e \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e\x2b\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e\x26gt;               mov    \x3cspan class=\x22hljs-number\x22\x3e-0\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ex\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e(\x3cspan class=\x22hljs-symbol\x22\x3e%rbp\x3c\/span\x3e),\x3cspan class=\x22hljs-symbol\x22\x3e%edx\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e0x4004e3\x3c\/span\x3e \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e\x2b\x3cspan class=\x22hljs-number\x22\x3e13\x3c\/span\x3e\x26gt;               mov    \x3cspan class=\x22hljs-number\x22\x3e-0\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ex\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e(\x3cspan class=\x22hljs-symbol\x22\x3e%rbp\x3c\/span\x3e),\x3cspan class=\x22hljs-symbol\x22\x3e%eax\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e0x4004e6\x3c\/span\x3e \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e\x2b\x3cspan class=\x22hljs-number\x22\x3e16\x3c\/span\x3e\x26gt;               \x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e    \x3cspan class=\x22hljs-symbol\x22\x3e%edx\x3c\/span\x3e,\x3cspan class=\x22hljs-symbol\x22\x3e%eax\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e0x4004e8\x3c\/span\x3e \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e\x2b\x3cspan class=\x22hljs-number\x22\x3e18\x3c\/span\x3e\x26gt;               pop    \x3cspan class=\x22hljs-symbol\x22\x3e%rbp\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e0x4004e9\x3c\/span\x3e \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e\x2b\x3cspan class=\x22hljs-number\x22\x3e19\x3c\/span\x3e\x26gt;               retq\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e下面是add函数执行完\x3ccode\x3emov %rsp,%rbp\x3c\/code\x3e的调用栈快照\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b 高位地址\n99 |    110   | -- 存放main函数调用方的栈帧地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n98 | 0x40051d | -- 存放EIP的值，add2返回后将执行的指令的地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n97 |    99    | -- 存放add2函数调用方(即main函数)的栈帧地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n96 |   0xXX   |\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n.................\n76 |   0x02   | -- 这是`mov %edi,-0x14(%rbp)`的执行结果\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n.................\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n73 |   0xXX   |\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n72 | 0x400504 | -- EIP的值，存放add返回后将执行的指令的地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n71 |    97    | -- 存放add函数调用方(即add函数)的栈帧地址\x3c-- EBP,ESP\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b 低位地址\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs asciidoc\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x2b\x2b 高位地址\n\x3cspan class=\x22hljs-section\x22\x3e99 |    110   | -- 存放main函数调用方的栈帧地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n\x3cspan class=\x22hljs-section\x22\x3e98 | 0x40051d | -- 存放EIP的值，add2返回后将执行的指令的地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n\x3cspan class=\x22hljs-section\x22\x3e97 |    99    | -- 存放add2函数调用方(即main函数)的栈帧地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n\x3cspan class=\x22hljs-section\x22\x3e96 |   0xXX   |\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n\x3cspan class=\x22hljs-code\x22\x3e.................\n76 |   0x02   | -- 这是`mov %edi,-0x14(%rbp)`的执行结果\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n.................\x3c\/span\x3e\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n73 |   0xXX   |\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n\x3cspan class=\x22hljs-section\x22\x3e72 | 0x400504 | -- EIP的值，存放add返回后将执行的指令的地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n71 |    97    | -- 存放add函数调用方(即add函数)的栈帧地址\x26lt;-- EBP,ESP\n\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x2b\x2b 低位地址\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e下面就是一系列弹出栈帧的过程了\x3cbr\x3e当add函数执行完\x3ccode\x3eretq\x3c\/code\x3e的调用栈快照\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b 高位地址\n99 |    110   | -- 存放main函数调用方的栈帧地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n98 | 0x40051d | -- 存放EIP的值，add2返回后将执行的指令的地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n97 |    99    | -- 存放add2函数调用方(即main函数)的栈帧地址 \x3c-- EBP\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n96 |   0xXX   |\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n.................\n76 |   0x02   | -- 这是`mov %edi,-0x14(%rbp)`的执行结果\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n.................\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n73 |   0xXX   | \x3c-- ESP\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b 低位地址\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs asciidoc\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x3cspan class=\x22hljs-code\x22\x3e\x2b\x2b\x2b\x3c\/span\x3e\x2b\x2b 高位地址\n\x3cspan class=\x22hljs-section\x22\x3e99 |    110   | -- 存放main函数调用方的栈帧地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n\x3cspan class=\x22hljs-section\x22\x3e98 | 0x40051d | -- 存放EIP的值，add2返回后将执行的指令的地址\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n\x3cspan class=\x22hljs-section\x22\x3e97 |    99    | -- 存放add2函数调用方(即main函数)的栈帧地址 \x26lt;-- EBP\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n\x3cspan class=\x22hljs-section\x22\x3e96 |   0xXX   |\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x3c\/span\x3e\n\x3cspan class=\x22hljs-code\x22\x3e.................\n76 |   0x02   | -- 这是`mov %edi,-0x14(%rbp)`的执行结果\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n.................\x3c\/span\x3e\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\n73 |   0xXX   | \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3e--\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eESP\x3c\/span\x3e\n\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b\x2b 低位地址\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后就不断弹出栈帧了～～～\x3cbr\x3e 从上面看到函数入参是先存储到寄存器中，然后在函数体内读取到栈帧所在空间中（局部变量、临时变量）。那么从调用栈中我们能获取函数的调用流和入参信息，从而恢复案发现场^_^\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e插播:函数的调用方式\x3c\/h3\x3e\n\x3cp\x3e 其实函数入参的传递方式不止上述这种，还有以下3种\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3ecdecl调用约定\x3cbr\x3e 调用方从右到左的顺序将参数压入栈中，在被调用方执行完成后，由调用方负责清理栈中的参数（也称为栈平衡）。\x3c\/li\x3e\n\x3cli\x3estdcall调用约定\x3cbr\x3e 巨硬自称的一种调用约定，并不是实际上的标准调用约定。调用方从右到左的顺序将参数压入栈中，在被调用方执行完成后，由被调用方负责清理栈中的参数（也称为栈平衡）。\x3c\/li\x3e\n\x3cli\x3efastcall调用约定\x3cbr\x3e 是stdcall的变体，调用方从右到左的顺序将参数压入栈中，最右边的两个参数则不压入栈中，而是分别存储在ECX和EDX寄存器中，在被调用方执行完成后，由被调用方负责清理栈中的参数（也称为栈平衡）。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e 但不管哪种，最终还是会在函数体内读取到当前栈帧空间中。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e二. 如何获取调用栈？\x3c\/h2\x3e\n\x3cp\x3e 上面写的这么多，可是我们现在写的是JavaScript哦，那到底怎么才能读取调用栈的信息呢？\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e抛个异常看看\x3c\/h3\x3e\n\x3cp\x3e IE10\x2b的Error实例中包含一个\x3ccode\x3estack\x3c\/code\x3e属性\x3cbr\x3e示例\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function add(a, b){\n  let sum = a \x2b b\n  throw Error(\x26quot;Capture Call Stack!\x26quot;)\n  return sum\n}\n\nfunction add2(a){\n  return 2 \x2b add(0, a)\n}\n\nfunction main(){\n  add2(2)\n}\n\ntry{\n  main()\n} catch (e){\n  console.log(e.stack)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea, b\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e sum = a \x2b b\n  \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22Capture Call Stack!\x22\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e sum\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd2\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x2b add(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, a)\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  add2(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e)\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e{\n  main()\n} \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (e){\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(e.stack)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eChrome回显\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Error: Capture Call Stack!\n    at add (index.html:16)\n    at add2 (index.html:21)\n    at main (index.html:25)\n    at index.html:29\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs subunit\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eError: \x3c\/span\x3eCapture Call Stack!\n    at add (index.html:16)\n    at add2 (index.html:21)\n    at main (index.html:25)\n    at index.html:29\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eFireFox回显\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22add@file:\/\/\/home\/john\/index.html:16:9\nadd2@file:\/\/\/home\/john\/index.html:21:14\nmain@file:\/\/\/home\/john\/index.html:25:3\n@file:\/\/\/home\/john\/index.html:29:3\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs elixir\x22\x3e\x3ccode\x3eadd\x3cspan class=\x22hljs-variable\x22\x3e@file\x3c\/span\x3e\x3cspan class=\x22hljs-symbol\x22\x3e:\/\/\/home\/john\/index\x3c\/span\x3e.\x3cspan class=\x22hljs-symbol\x22\x3ehtml:\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e16\x3c\/span\x3e\x3cspan class=\x22hljs-symbol\x22\x3e:\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3e\nadd2\x3cspan class=\x22hljs-variable\x22\x3e@file\x3c\/span\x3e\x3cspan class=\x22hljs-symbol\x22\x3e:\/\/\/home\/john\/index\x3c\/span\x3e.\x3cspan class=\x22hljs-symbol\x22\x3ehtml:\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e21\x3c\/span\x3e\x3cspan class=\x22hljs-symbol\x22\x3e:\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e14\x3c\/span\x3e\nmain\x3cspan class=\x22hljs-variable\x22\x3e@file\x3c\/span\x3e\x3cspan class=\x22hljs-symbol\x22\x3e:\/\/\/home\/john\/index\x3c\/span\x3e.\x3cspan class=\x22hljs-symbol\x22\x3ehtml:\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e25\x3c\/span\x3e\x3cspan class=\x22hljs-symbol\x22\x3e:\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\n\x3cspan class=\x22hljs-variable\x22\x3e@file\x3c\/span\x3e\x3cspan class=\x22hljs-symbol\x22\x3e:\/\/\/home\/john\/index\x3c\/span\x3e.\x3cspan class=\x22hljs-symbol\x22\x3ehtml:\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e29\x3c\/span\x3e\x3cspan class=\x22hljs-symbol\x22\x3e:\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3eV8的\x3ccode\x3eError.captureStackTrace\x3c\/code\x3e函数\x3c\/h3\x3e\n\x3cp\x3e V8引擎向JavaScript提供了其Stack Trace API中的\x3ccode\x3ecaptureStackTrace\x3c\/code\x3e函数，用于获取调用\x3ccode\x3eError.captureStackTrace\x3c\/code\x3e时的调用栈快照。函数签名如下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@static\n@method captureStackTrace(targetObject, constructorOpt)\n@param {Object} targetObject - 为targetObject添加.stack属性，该属性保存调用Error.captureStackTrace时的调用栈快照\n@param {Function} constructorOpt= - 调用栈快照不断作出栈操作，直到constructorOpt所指向的函数刚好出栈为止，然后保存到targetObject的stack属性中\n@return {undefined}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs oxygene\x22\x3e\x3ccode\x3e@\x3cspan class=\x22hljs-keyword\x22\x3estatic\x3c\/span\x3e\n@\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3emethod\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecaptureStackTrace\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(targetObject, constructorOpt)\x3c\/span\x3e\n@\x3cspan class=\x22hljs-title\x22\x3eparam\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e{Object}\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etargetObject\x3c\/span\x3e - 为\x3cspan class=\x22hljs-title\x22\x3etargetObject\x3c\/span\x3e添加.\x3cspan class=\x22hljs-title\x22\x3estack\x3c\/span\x3e属性，该属性保存调用\x3cspan class=\x22hljs-title\x22\x3eError\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3ecaptureStackTrace\x3c\/span\x3e时的调用栈快照\n@\x3cspan class=\x22hljs-title\x22\x3eparam\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e{Function}\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3econstructorOpt\x3c\/span\x3e= - 调用栈快照不断作出栈操作，直到\x3cspan class=\x22hljs-title\x22\x3econstructorOpt\x3c\/span\x3e所指向的函数刚好出栈为止，然后保存到\x3cspan class=\x22hljs-title\x22\x3etargetObject\x3c\/span\x3e的\x3cspan class=\x22hljs-title\x22\x3estack\x3c\/span\x3e属性中\n@\x3cspan class=\x22hljs-title\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e{undefined}\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e示例\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function add(a, b){\n  let sum = a \x2b b\n  let targetObj = {}\n\n  Error.captureStackTrace(targetObj)\n  console.log(targetObj.stack)\n\n  Error.captureStackTrace(targetObj, add)\n  console.log(targetObj.stack)\n\n  return sum\n}\n\nfunction add2(a){\n  return 2 \x2b add(0, a)\n}\n\nfunction main(){\n  add2(2)\n}\n\nmain()\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea, b\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e sum = a \x2b b\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e targetObj = {}\n\n  \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e.captureStackTrace(targetObj)\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(targetObj.stack)\n\n  \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e.captureStackTrace(targetObj, add)\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(targetObj.stack)\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e sum\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd2\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x2b add(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, a)\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  add2(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e)\n}\n\nmain()\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eChrome回显\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Error\n    at add (index.html:18)\n    at add2 (index.html:28)\n    at main (index.html:32)\n    at index.html:35\nError\n    at add2 (index.html:28)\n    at main (index.html:32)\n    at index.html:35\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs subunit\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eError\n    \x3c\/span\x3eat add (index.html:18)\n    at add2 (index.html:28)\n    at main (index.html:32)\n    at index.html:35\n\x3cspan class=\x22hljs-keyword\x22\x3eError\n    \x3c\/span\x3eat add2 (index.html:28)\n    at main (index.html:32)\n    at index.html:35\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e控制台的\x3ccode\x3econsole.trace\x3c\/code\x3e函数\x3c\/h3\x3e\n\x3cp\x3e 还有最后一招\x3ccode\x3econsole.trace\x3c\/code\x3e，不过实际用处不大\x3cbr\x3e示例\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function add(a, b){\n  let sum = a \x2b b\n  console.trace()\n\n  return sum\n}\n\nfunction add2(a){\n  return 2 \x2b add(0, a)\n}\n\nfunction main(){\n  add2(2)\n}\n\nmain()\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea, b\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e sum = a \x2b b\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.trace()\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e sum\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd2\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x2b add(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, a)\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  add2(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e)\n}\n\nmain()\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eChrome回显\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22add    @    index.html:16\nadd2    @    index.html:22\nmain    @    index.html:26\n(anonymous)    @    index.html:29\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs vim\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3eadd\x3c\/span\x3e    @    \x3cspan class=\x22hljs-built_in\x22\x3eindex\x3c\/span\x3e.htm\x3cspan class=\x22hljs-variable\x22\x3el:16\x3c\/span\x3e\nadd2    @    \x3cspan class=\x22hljs-built_in\x22\x3eindex\x3c\/span\x3e.htm\x3cspan class=\x22hljs-variable\x22\x3el:22\x3c\/span\x3e\nmain    @    \x3cspan class=\x22hljs-built_in\x22\x3eindex\x3c\/span\x3e.htm\x3cspan class=\x22hljs-variable\x22\x3el:26\x3c\/span\x3e\n(anonymous)    @    \x3cspan class=\x22hljs-built_in\x22\x3eindex\x3c\/span\x3e.htm\x3cspan class=\x22hljs-variable\x22\x3el:29\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 上述三种方式（实际就两种可用啦）都只能获取函数调用流，函数入参、局部变量等信息全都灰飞烟灭了？上面不是说好这些信息调用栈都有嘛，干嘛不给我呢？其实想想都知道调用栈中有这么多信息，其实我们只需一小部分，全盘托出并不是什么好设计。其实我们只要再获取\x3cstrong\x3e栈帧局部状态\x3c\/strong\x3e就好了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e三. 什么是栈帧局部状态？又如何获取呢？\x3c\/h2\x3e\n\x3cp\x3e 所谓栈帧局部状态其实就是函数入参和局部变量，试想如果我们得到\x3ccode\x3eadd\x3c\/code\x3e函数调用时的入参是\x3ccode\x3ea=0\x3c\/code\x3e、\x3ccode\x3eb=2\x3c\/code\x3e和\x3ccode\x3esum=2\x3c\/code\x3e，那么不就得到完整案发现场了吗？那问题就是如何获得了。要不我们做个Monkey Patch\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e自定义一个异常类来承载栈帧局部状态\x3c\/li\x3e\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function StackTraceError(e, env){\n  if (this instanceof StackTraceError);else return new StackTraceError(e, env)\n  this.e = e\n  this.env = env\n}\nlet proto = StackTraceError.prototype = Object.create(Error.prototype)\nproto.name = \x26quot;StackTraceError\x26quot;\nproto.message = \x26quot;Internal error.\x26quot;\nproto.constructor = StackTraceError\nproto.valueOf = proto.toString = function(){\n  let curr = this, q = [], files = []\n  do {\n    if (curr.stack){\n      let stack = String(curr.stack)\n      let segs = stack.split(\x27\\n\x27).map(seg =\x3e seg.trim())\n      files = segs.filter(seg =\x3e seg != \x26quot;Error\x26quot;)\n    }\n    else{\n      q.unshift({name: curr.name,\n                 msg: curr.message,\n                 env: curr.env})\n    }\n  } while (curr = curr.e)\n\n  let frames = []\n  let c = files.length, i = 0\n  while (i \x3c c){\n    let file = files[i]\n    let e = q[i]\n    let frame = {\n      name: e \x26amp;\x26amp; e.name,\n      msg: e \x26amp;\x26amp; e.msg,\n      env: e \x26amp;\x26amp; e.env,\n      file: file\n    }\n    frames.push(JSON.stringify(frame))\n    i \x2b= 1\n  }\n  return frames.join(\x26quot;\\n\x26quot;)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eStackTraceError\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee, env\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3einstanceof\x3c\/span\x3e StackTraceError);\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e StackTraceError(e, env)\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.e = e\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.env = env\n}\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e proto = StackTraceError.prototype = \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.create(\x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e.prototype)\nproto.name = \x3cspan class=\x22hljs-string\x22\x3e\x22StackTraceError\x22\x3c\/span\x3e\nproto.message = \x3cspan class=\x22hljs-string\x22\x3e\x22Internal error.\x22\x3c\/span\x3e\nproto.constructor = StackTraceError\nproto.valueOf = proto.toString = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e curr = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, q = [], files = []\n  \x3cspan class=\x22hljs-keyword\x22\x3edo\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (curr.stack){\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e stack = \x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e(curr.stack)\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e segs = stack.split(\x3cspan class=\x22hljs-string\x22\x3e\x27\\n\x27\x3c\/span\x3e).map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eseg\x3c\/span\x3e =\x26gt;\x3c\/span\x3e seg.trim())\n      files = segs.filter(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eseg\x3c\/span\x3e =\x26gt;\x3c\/span\x3e seg != \x3cspan class=\x22hljs-string\x22\x3e\x22Error\x22\x3c\/span\x3e)\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n      q.unshift({\x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: curr.name,\n                 \x3cspan class=\x22hljs-attr\x22\x3emsg\x3c\/span\x3e: curr.message,\n                 \x3cspan class=\x22hljs-attr\x22\x3eenv\x3c\/span\x3e: curr.env})\n    }\n  } \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (curr = curr.e)\n\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e frames = []\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e c = files.length, i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (i \x26lt; c){\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e file = files[i]\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e e = q[i]\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e frame = {\n      \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: e \x26amp;\x26amp; e.name,\n      \x3cspan class=\x22hljs-attr\x22\x3emsg\x3c\/span\x3e: e \x26amp;\x26amp; e.msg,\n      \x3cspan class=\x22hljs-attr\x22\x3eenv\x3c\/span\x3e: e \x26amp;\x26amp; e.env,\n      \x3cspan class=\x22hljs-attr\x22\x3efile\x3c\/span\x3e: file\n    }\n    frames.push(\x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(frame))\n    i \x2b= \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e frames.join(\x3cspan class=\x22hljs-string\x22\x3e\x22\\n\x22\x3c\/span\x3e)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3col\x3e\x3cli\x3e每个函数定义都通过\x3ccode\x3etry\/catch\x3c\/code\x3e捕获栈帧局部状态\x3c\/li\x3e\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function add(a, b){\n  try{\n    var sum = a \x2b b\n    throw Error()\n  }\n  catch(e){\n    throw StackTraceError(e, [\x26quot;a:\x26quot;, a, \x26quot;b\x26quot;, b, \x26quot;sum\x26quot;, sum].join(\x26quot;::\x26quot;))\n  }\n  return sum\n}\n\nfunction add2(a){\n  try{\n    return 2 \x2b add(0, a)\n  }\n  catch(e){\n    throw StackTraceError(e, [\x26quot;a\x26quot;, a].join(\x26quot;::\x26quot;))\n  }\n}\n\nfunction main(){\n  try{\n    add2(2)\n  }\n  catch(e){\n    throw StackTraceError(e, \x26quot;\x26quot;)\n  }\n}\n\ntry{\n  main()\n} catch(e){\n  console.log(e\x2b\x27\x27)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea, b\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e sum = a \x2b b\n    \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e()\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(e){\n    \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e StackTraceError(e, [\x3cspan class=\x22hljs-string\x22\x3e\x22a:\x22\x3c\/span\x3e, a, \x3cspan class=\x22hljs-string\x22\x3e\x22b\x22\x3c\/span\x3e, b, \x3cspan class=\x22hljs-string\x22\x3e\x22sum\x22\x3c\/span\x3e, sum].join(\x3cspan class=\x22hljs-string\x22\x3e\x22::\x22\x3c\/span\x3e))\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e sum\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd2\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x2b add(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, a)\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(e){\n    \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e StackTraceError(e, [\x3cspan class=\x22hljs-string\x22\x3e\x22a\x22\x3c\/span\x3e, a].join(\x3cspan class=\x22hljs-string\x22\x3e\x22::\x22\x3c\/span\x3e))\n  }\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e{\n    add2(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e)\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(e){\n    \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e StackTraceError(e, \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e)\n  }\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e{\n  main()\n} \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(e){\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(e\x2b\x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3echrome下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\x26quot;name\x26quot;:\x26quot;StackTraceError\x26quot;,\x26quot;msg\x26quot;:\x26quot;Internal error.\x26quot;,\x26quot;env\x26quot;:\x26quot;a::0::b::2::sum::2\x26quot;,\x26quot;file\x26quot;:\x26quot;at add (file:\/\/\/home\/john\/index.html:57:11)\x26quot;}\n{\x26quot;name\x26quot;:\x26quot;StackTraceError\x26quot;,\x26quot;msg\x26quot;:\x26quot;Internal error.\x26quot;,\x26quot;env\x26quot;:\x26quot;a:;2\x26quot;,\x26quot;file\x26quot;:\x26quot;at add2 (file:\/\/\/home\/john\/index.html:67:16)\x26quot;}\n{\x26quot;name\x26quot;:\x26quot;StackTraceError\x26quot;,\x26quot;msg\x26quot;:\x26quot;Internal error.\x26quot;,\x26quot;env\x26quot;:\x26quot;\x26quot;,\x26quot;file\x26quot;:\x26quot;at main (file:\/\/\/home\/john\/index.html:76:5)\x26quot;}\n{\x26quot;file\x26quot;:\x26quot;at file:\/\/\/home\/john\/index.html:84:3\x26quot;}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs json\x22\x3e\x3ccode\x3e{\x3cspan class=\x22hljs-attr\x22\x3e\x22name\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22StackTraceError\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3e\x22msg\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22Internal error.\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3e\x22env\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22a::0::b::2::sum::2\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3e\x22file\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22at add (file:\/\/\/home\/john\/index.html:57:11)\x22\x3c\/span\x3e}\n{\x3cspan class=\x22hljs-attr\x22\x3e\x22name\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22StackTraceError\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3e\x22msg\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22Internal error.\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3e\x22env\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22a:;2\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3e\x22file\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22at add2 (file:\/\/\/home\/john\/index.html:67:16)\x22\x3c\/span\x3e}\n{\x3cspan class=\x22hljs-attr\x22\x3e\x22name\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22StackTraceError\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3e\x22msg\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22Internal error.\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3e\x22env\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3e\x22file\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22at main (file:\/\/\/home\/john\/index.html:76:5)\x22\x3c\/span\x3e}\n{\x3cspan class=\x22hljs-attr\x22\x3e\x22file\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22at file:\/\/\/home\/john\/index.html:84:3\x22\x3c\/span\x3e}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 上面这种做法有三个问题\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3eV8引擎不会对包含\x3ccode\x3etry\/catch\x3c\/code\x3e的函数进行优化，如果每个函数都包含\x3ccode\x3etry\/catch\x3c\/code\x3e那会严重影响执行效率。\x3c\/li\x3e\n\x3cli\x3e这种方式显然不能让每个开发人员手写，必须通过预编译器来静态织入，开发难度有点大哦。\x3c\/li\x3e\n\x3cli\x3e像\x3ccode\x3esum\x3c\/code\x3e这种临时变量其实并不用记录，因为它可以被运算出来，只要记录\x3ccode\x3ea\x3c\/code\x3e和\x3ccode\x3eb\x3c\/code\x3e即可。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e 假如我们写的全是纯函数（就是相同入参必定得到相同的返回值，函数内部不依赖外部状态，如加法一样，1\x2b1永远等于2），那么我们只需捕获入口\/公用函数的入参即可恢复整个案发现场了。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function add(a, b){\n  var sum = a \x2b b\n  throw Error()\n  return sum\n}\n\nfunction add2(a){\n  try{\n    return 2 \x2b add(0, a)\n  }\n  catch(e){\n    throw {error:e, env:[\x26quot;a:\x26quot;, a].join(\x26quot;::\x26quot;)})\n  }\n}\n\nfunction main(){\n  add2(2)\n}\n\ntry{\n  main()\n} catch(e){\n  console.log(e\x2b\x27\x27)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea, b\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e sum = a \x2b b\n  \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e()\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e sum\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd2\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x2b add(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, a)\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(e){\n    \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e {\x3cspan class=\x22hljs-attr\x22\x3eerror\x3c\/span\x3e:e, \x3cspan class=\x22hljs-attr\x22\x3eenv\x3c\/span\x3e:[\x3cspan class=\x22hljs-string\x22\x3e\x22a:\x22\x3c\/span\x3e, a].join(\x3cspan class=\x22hljs-string\x22\x3e\x22::\x22\x3c\/span\x3e)})\n  }\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  add2(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e)\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e{\n  main()\n} \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(e){\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(e\x2b\x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e 然后我们就可以拿着报错信息从\x3ccode\x3eadd2\x3c\/code\x3e逐步调试到\x3ccode\x3eadd\x3c\/code\x3e中了。假如用ClojureScript我们还可以定义个macro简化一下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22;; 私有函数\n(defn- add [a b]\n  (let [sum (\x2b a b)]\n    (throw (Error.))\n    sum))\n;; 入口\/公用函数\n(defn-pub add2 [a]\n  (\x2b 2 (add 0 a)))\n\n(defn main []\n  (add2 2))\n\n(try\n (main)\n (catch e\n  (println e)))\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs clojure\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e;; 私有函数\x3c\/span\x3e\n(\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3edefn-\x3c\/span\x3e\x3c\/span\x3e add [a b]\n  (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3elet\x3c\/span\x3e\x3c\/span\x3e [sum (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3e\x2b\x3c\/span\x3e\x3c\/span\x3e a b)]\n    (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3ethrow\x3c\/span\x3e\x3c\/span\x3e (\x3cspan class=\x22hljs-name\x22\x3eError.\x3c\/span\x3e))\n    sum))\n\x3cspan class=\x22hljs-comment\x22\x3e;; 入口\/公用函数\x3c\/span\x3e\n(\x3cspan class=\x22hljs-name\x22\x3edefn-pub\x3c\/span\x3e add2 [a]\n  (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3e\x2b\x3c\/span\x3e\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e (\x3cspan class=\x22hljs-name\x22\x3eadd\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e a)))\n\n(\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3edefn\x3c\/span\x3e\x3c\/span\x3e main []\n  (\x3cspan class=\x22hljs-name\x22\x3eadd2\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e))\n\n(\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3etry\x3c\/span\x3e\x3c\/span\x3e\n (\x3cspan class=\x22hljs-name\x22\x3emain\x3c\/span\x3e)\n (\x3cspan class=\x22hljs-name\x22\x3ecatch\x3c\/span\x3e e\n  (\x3cspan class=\x22hljs-name\x22\x3eprintln\x3c\/span\x3e e)))\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3edefn-pub macro的定义\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22(defmacro defn-pub [name args \x26amp; body]\n  (let [e (gensym)\n        arg-names (mapv str args)]\n    `(def ~name\n       (fn ~args\n         (try ~@body\n           (catch js\/Object ~e\n             (throw (clj-\x3ejs {:e ~e, :env (zipmap ~arg-names ~args)}))))))))\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs clojure\x22\x3e\x3ccode\x3e(\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3edefmacro\x3c\/span\x3e\x3c\/span\x3e defn-pub [name args \x26amp; body]\n  (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3elet\x3c\/span\x3e\x3c\/span\x3e [e (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3egensym\x3c\/span\x3e\x3c\/span\x3e)\n        arg-names (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3emapv\x3c\/span\x3e\x3c\/span\x3e str args)]\n    `(\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3edef\x3c\/span\x3e\x3c\/span\x3e ~name\n       (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3efn\x3c\/span\x3e\x3c\/span\x3e ~args\n         (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3etry\x3c\/span\x3e\x3c\/span\x3e ~@body\n           (\x3cspan class=\x22hljs-name\x22\x3ecatch\x3c\/span\x3e js\/Object ~e\n             (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3ethrow\x3c\/span\x3e\x3c\/span\x3e (\x3cspan class=\x22hljs-name\x22\x3eclj-\x26gt;js\x3c\/span\x3e {\x3cspan class=\x22hljs-symbol\x22\x3e:e\x3c\/span\x3e ~e, \x3cspan class=\x22hljs-symbol\x22\x3e:env\x3c\/span\x3e (\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3ezipmap\x3c\/span\x3e\x3c\/span\x3e ~arg-names ~args)}))))))))\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader11\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e 写到这里其实也没有一个很好的方式去捕获案发现场证据，在入口\/公用函数中加入\x3ccode\x3etry\/catch\x3c\/code\x3e是我现阶段能想到比较可行的方式，请各位多多指点。\x3cbr\x3e尊重原创，转载请注明转自：\x3ca href=\x22http:\/\/www.cnblogs.com\/fsjohnhuang\/p\/7729527.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.cnblogs.com\/fsjohn...\x3c\/a\x3e  ^_^肥仔John\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader12\x22\x3e参考\x3c\/h2\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/exiahan\/p\/4310010.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.cnblogs.com\/exiaha...\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22http:\/\/blog.csdn.net\/qiu265843468\/article\/details\/17844419\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/blog.csdn.net\/qiu26584...\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22http:\/\/lucasfcosta.com\/2017\/02\/17\/JavaScript-Errors-and-Stack-Traces.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/lucasfcosta.com\/2017\/0...\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22http:\/\/blog.shaochuancs.com\/about-error-capturestacktrace\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/blog.shaochuancs.com\/a...\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>前端魔法堂——调用栈，异常实例中的宝藏</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011717178">https://segmentfault.com/a/1190000011717178</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/6z895b4c92n/" target="_blank">https://alili.tech/archive/6z895b4c92n/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>