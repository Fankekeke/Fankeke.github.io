<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="浅谈前后端分离与实践 之 nodejs 中间层服务（二）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>浅谈前后端分离与实践 之 nodejs 中间层服务（二） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/7v0zhpnqnmh/",
				"appid": "1613049289050283", 
				"title": "浅谈前后端分离与实践 之 nodejs 中间层服务（二） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-28T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/wbi66fqacyp/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/j04k6czqw7f/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f7v0zhpnqnmh%2f&text=%e6%b5%85%e8%b0%88%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e4%b8%8e%e5%ae%9e%e8%b7%b5%20%e4%b9%8b%20nodejs%20%e4%b8%ad%e9%97%b4%e5%b1%82%e6%9c%8d%e5%8a%a1%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f7v0zhpnqnmh%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f7v0zhpnqnmh%2f&text=%e6%b5%85%e8%b0%88%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e4%b8%8e%e5%ae%9e%e8%b7%b5%20%e4%b9%8b%20nodejs%20%e4%b8%ad%e9%97%b4%e5%b1%82%e6%9c%8d%e5%8a%a1%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f7v0zhpnqnmh%2f&title=%e6%b5%85%e8%b0%88%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e4%b8%8e%e5%ae%9e%e8%b7%b5%20%e4%b9%8b%20nodejs%20%e4%b8%ad%e9%97%b4%e5%b1%82%e6%9c%8d%e5%8a%a1%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f7v0zhpnqnmh%2f&is_video=false&description=%e6%b5%85%e8%b0%88%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e4%b8%8e%e5%ae%9e%e8%b7%b5%20%e4%b9%8b%20nodejs%20%e4%b8%ad%e9%97%b4%e5%b1%82%e6%9c%8d%e5%8a%a1%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e6%b5%85%e8%b0%88%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e4%b8%8e%e5%ae%9e%e8%b7%b5%20%e4%b9%8b%20nodejs%20%e4%b8%ad%e9%97%b4%e5%b1%82%e6%9c%8d%e5%8a%a1%ef%bc%88%e4%ba%8c%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f7v0zhpnqnmh%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f7v0zhpnqnmh%2f&title=%e6%b5%85%e8%b0%88%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e4%b8%8e%e5%ae%9e%e8%b7%b5%20%e4%b9%8b%20nodejs%20%e4%b8%ad%e9%97%b4%e5%b1%82%e6%9c%8d%e5%8a%a1%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f7v0zhpnqnmh%2f&title=%e6%b5%85%e8%b0%88%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e4%b8%8e%e5%ae%9e%e8%b7%b5%20%e4%b9%8b%20nodejs%20%e4%b8%ad%e9%97%b4%e5%b1%82%e6%9c%8d%e5%8a%a1%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f7v0zhpnqnmh%2f&title=%e6%b5%85%e8%b0%88%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e4%b8%8e%e5%ae%9e%e8%b7%b5%20%e4%b9%8b%20nodejs%20%e4%b8%ad%e9%97%b4%e5%b1%82%e6%9c%8d%e5%8a%a1%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f7v0zhpnqnmh%2f&title=%e6%b5%85%e8%b0%88%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e4%b8%8e%e5%ae%9e%e8%b7%b5%20%e4%b9%8b%20nodejs%20%e4%b8%ad%e9%97%b4%e5%b1%82%e6%9c%8d%e5%8a%a1%ef%bc%88%e4%ba%8c%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">浅谈前后端分离与实践 之 nodejs 中间层服务（二）</h1><div class="meta"><div class="postdate"><time datetime="2018-12-28" itemprop="datePublished">2018-12-28</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e一、背景\x3c\/h1\x3e\n\x3cp\x3e书接上文，\x3ca href=\x22https:\/\/zhuanlan.zhihu.com\/p\/29996622\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e浅谈前后端分离与实践(一)\x3c\/a\x3e 我们用mock服务器搭建起来了自己的前端数据模拟服务，前后端开发过程中只需定义好接口规范，便可以相互进行各自的开发任务。联调的时候，按照之前定义的开发规范进行数据联调便可以了。前后端的职能更加清晰：\x3c\/p\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth align=\x22left\x22\x3e后端\x3c\/th\x3e\n\x3cth align=\x22left\x22\x3e前端\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e提供数据\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3e接收数据，返回数据\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e处理业务逻辑\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3e处理渲染逻辑\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3eServer-side MVC架构\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3eClient-side MV* 架构\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e代码跑在服务器上\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3e代码跑在浏览器上\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3cp\x3e这里分离干净了，分工也很明确了，看似一切都那么美好，but...我们也很容易发现问题的所在：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3eClient-side Model 是 Server-side Model 的加工\x3c\/li\x3e\n\x3cli\x3eClient-side View 跟 Server-side是 不同层次的东西\x3c\/li\x3e\n\x3cli\x3eClient-side的Controller 跟 Sever-side的Controller 各搞各的\x3c\/li\x3e\n\x3cli\x3eClient-side的Route 但是 Server-side 可能没有\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e也就是说服务端和客户端各层职责重叠，大家各搞各的，很难统一具体要做的事情。并且可能会伴随着一些性能上的问题。最具体的表现就是我们常用的SPA应用：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e渲染，取值都在客户端进行，有性能的问题\x3c\/li\x3e\n\x3cli\x3e需要等待资源到齐才能进行，会有短暂白屏与闪动\x3c\/li\x3e\n\x3cli\x3e在移动设备低速网路的体验奇差无比\x3c\/li\x3e\n\x3cli\x3e渲染都在客户端，模版无法重用，SEO实现 麻烦\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e紧接着，我们代码量越来越大，我们需要校验的表单也会越来越多，有时候，前端提交需要校验一次表单。\x3cbr\x3e服务端任需要进行校验来达到数据的可靠性；前端的路由可能在服务端并不存在....等等这一系列重用性的问题。所以我们之前的重构可能需要更深层次的思考。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3e二、开始重构\x3c\/h1\x3e\n\x3cp\x3e在开始重构之前，我们需要对前后端界线做一个划分，也就是说什么是属于前端的范畴，什么是属于后端的范畴，最传统的前后端划分可能是这样的：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011685253?w=754\x26amp;h=345\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011685253?w=754\x26amp;h=345\x22 alt=\x22前后端定义\x22 title=\x22前后端定义\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e那么问题来了：我们前后端划分的接线，是依照工作职责来划分的前后端；还是依照硬体环境划分的前后端？自从了nodejs之后，我们可以从工作职能上重新定义前后端的范畴：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011685254?w=872\x26amp;h=375\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011685254?w=872\x26amp;h=375\x22 alt=\x22前后端定义\x22 title=\x22前后端定义\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e可以看到，这里的前端比之前多了个nodejs，也就是在前后端之间我们构建了一个 nodejs 服务作为中间层！\x3cbr\x3e为什么我们选择的中间层是nodejs呢？因为我们把中间层归在了前端的范畴，那么对前端小伙伴来说，nodejs毕竟还是个js，那么从语法角度来说，上收起来应该没有什么问题。其次开发转移成本也想对较低，不必来回切换语言的逻辑和语法：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e前端熟悉的语言，学习成本低\x3c\/li\x3e\n\x3cli\x3e都是JS，可以前后端复用\x3c\/li\x3e\n\x3cli\x3e体质适合：事件驱动、非阻塞I\/O\x3c\/li\x3e\n\x3cli\x3e适合IO密集型业务\x3c\/li\x3e\n\x3cli\x3e执行速度也不差\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e好了，提前说了这么多东西，那么这个中间层能给我们带来什么了？要知道引入nodejs的开发成本也是很大的，首先就是多了一层服务，多的不说，单凭传输时间，就多了一层的传输时间啊！下面我们来研究一下什么应用场景下的nodejs能给我们带来利大于弊的东西。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3e三、开始中间层之旅\x3c\/h1\x3e\n\x3cp\x3e引入nodejs之后，我们来重新划分一下前后端的职能：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011685255?w=859\x26amp;h=469\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011685255?w=859\x26amp;h=469\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e这个就是中间层nodejs的主要思路，下面我们来看一下常见的业务场景：\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e1. 接口数据可靠性修复\x3c\/h3\x3e\n\x3cp\x3e有的时候服务端返回给我们的数据可能并不是前端想要的结构，所有用到的展现数据都是后端通过异步接口(AJAX\/JSONP)的方式提供的，前端只管展现。但是后端经常提供后端的数据逻辑，在前端还需要去处理这些数据逻辑。比如我再开发一个功能的时候，有时候会碰到这样的问题：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011685256?w=347\x26amp;h=211\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011685256?w=347\x26amp;h=211\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011685257?w=595\x26amp;h=168\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011685257?w=595\x26amp;h=168\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e服务端返回的某个字段为 null 或者服务端返回的数据结构太深，前端需要不断写这样的代码去判断数据结构是否真的返回了正确的东西，而不是个null 或者undefined：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (params.items \x26amp;\x26amp; params.items.type \x26amp;\x26amp; ...) {\n   \/\/ todo\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (params.items \x26amp;\x26amp; params.items.type \x26amp;\x26amp; ...) {\n   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ todo\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e对于这种情况，我们前端其实不应该去重复校验数据的格式，这也本不应该是浏览器端js需要做的事情。我们可以在中间层做接口转发，在转发的过程中做数据处理。而不用担心数据返回的问题：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22router.get(\x27\/buyer\/product\/detail\x27, (req, res, next) =\x3e {\n  httpRequest.get(\x27\/buyer\/product\/detail\x27, (data) =\x3e {\n    \/\/ todo 处理数据\n    res.send(data);\n  })\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3erouter.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/buyer\/product\/detail\x27\x3c\/span\x3e, (req, res, next) =\x26gt; {\n  httpRequest.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/buyer\/product\/detail\x27\x3c\/span\x3e, (data) =\x26gt; {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ todo 处理数据\x3c\/span\x3e\n    res.send(data);\n  })\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e2. 页面性能优化 和 SEO\x3c\/h3\x3e\n\x3cp\x3e有点时候我们做单页面应用，经常会碰到首屏加载性能问题，这个时候如果我们接了中间层nodejs的话，那么我们可以把首屏渲染的任务交给nodejs去做，次屏的渲染依然走之前的浏览器渲染。（前端换页，浏览器端渲染，直接输入网址，服务器渲染）服务端渲染对页面进行拼接直出html字符串，可以大幅提高首屏渲染的时间，减少用户的等待时间。这种形式应用最广的比如 Vue 的服务端渲染，里面也有相关的介绍。\x3cbr\x3e其次对于单页面的SEO优化也是很好地处理方式，由于目前的ajax并不被搜索百度等搜索引擎支持，所以如果想要得到爬虫的支持，那么服务端渲染也是一种解决方法。（PS：如果觉得服务端渲染太麻烦，我这里还有一篇介绍处理SEO的另一种思路\x3ca href=\x22https:\/\/zhuanlan.zhihu.com\/p\/29148760\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e处理 Vue 单页面 Meta SEO的另一种思路\x3c\/a\x3e可以参考）\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e3. 淘宝常见的需求解决方案\x3c\/h3\x3e\n\x3cp\x3e需求：在淘宝，单日四亿PV，页面数据来自各个不同接口，为了不影响体验，先产生页面框架后，在发起多个异步请求取数据更新页面，这些多出来的请求带来的影响不小，尤其在无线端。\x3c\/p\x3e\n\x3cp\x3e解决方案：在NodeJS端使用 Bigpiper 技术，合并请求，降低负担，分批输出，不影响体验。同时可以拆分大接口为独立小接口，并发请求。串行 =\x26gt; 并行，大幅缩短请求时间。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e4. 更多可能\x3c\/h3\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011685258?w=720\x26amp;h=405\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011685258?w=720\x26amp;h=405\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader7\x22\x3e结语\x3c\/h1\x3e\n\x3cp\x3e这里只是提供问题的一种解决思路，还是那句话：一切看应用场景。如果你对本文内容有别的意见也欢迎一起交流探讨。\x3c\/p\x3e\n\x3ch5\x3e关于\x3c\/h5\x3e\n\x3cp\x3e作者：monkeyWang\x3c\/p\x3e\n\x3cp\x3e本人主页：\x3ca href=\x22https:\/\/link.zhihu.com\/?target=https%3A\/\/monkeywangs.github.io\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3emonkeyWang\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e本文部分图片段落参考文章： \x3ca href=\x22https:\/\/link.zhihu.com\/?target=http%3A\/\/2014.jsconf.cn\/slides\/herman-taobaoweb\/index.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e淘宝前后端分离实践\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e微信公众号：会不定期推送前端技术文章，欢迎关注\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011685259\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011685259\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>浅谈前后端分离与实践 之 nodejs 中间层服务（二）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011685248">https://segmentfault.com/a/1190000011685248</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/7v0zhpnqnmh/" target="_blank">https://alili.tech/archive/7v0zhpnqnmh/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>