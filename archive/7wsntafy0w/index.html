<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="使用React进行组件库开发"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>使用React进行组件库开发 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/7wsntafy0w/",
				"appid": "1613049289050283", 
				"title": "使用React进行组件库开发 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-14T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/h3k0kvayvyf/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/ahd2oyjmoe/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f7wsntafy0w%2f&text=%e4%bd%bf%e7%94%a8React%e8%bf%9b%e8%a1%8c%e7%bb%84%e4%bb%b6%e5%ba%93%e5%bc%80%e5%8f%91"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f7wsntafy0w%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f7wsntafy0w%2f&text=%e4%bd%bf%e7%94%a8React%e8%bf%9b%e8%a1%8c%e7%bb%84%e4%bb%b6%e5%ba%93%e5%bc%80%e5%8f%91"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f7wsntafy0w%2f&title=%e4%bd%bf%e7%94%a8React%e8%bf%9b%e8%a1%8c%e7%bb%84%e4%bb%b6%e5%ba%93%e5%bc%80%e5%8f%91"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f7wsntafy0w%2f&is_video=false&description=%e4%bd%bf%e7%94%a8React%e8%bf%9b%e8%a1%8c%e7%bb%84%e4%bb%b6%e5%ba%93%e5%bc%80%e5%8f%91"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%bd%bf%e7%94%a8React%e8%bf%9b%e8%a1%8c%e7%bb%84%e4%bb%b6%e5%ba%93%e5%bc%80%e5%8f%91&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f7wsntafy0w%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f7wsntafy0w%2f&title=%e4%bd%bf%e7%94%a8React%e8%bf%9b%e8%a1%8c%e7%bb%84%e4%bb%b6%e5%ba%93%e5%bc%80%e5%8f%91"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f7wsntafy0w%2f&title=%e4%bd%bf%e7%94%a8React%e8%bf%9b%e8%a1%8c%e7%bb%84%e4%bb%b6%e5%ba%93%e5%bc%80%e5%8f%91"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f7wsntafy0w%2f&title=%e4%bd%bf%e7%94%a8React%e8%bf%9b%e8%a1%8c%e7%bb%84%e4%bb%b6%e5%ba%93%e5%bc%80%e5%8f%91"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f7wsntafy0w%2f&title=%e4%bd%bf%e7%94%a8React%e8%bf%9b%e8%a1%8c%e7%bb%84%e4%bb%b6%e5%ba%93%e5%bc%80%e5%8f%91"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">使用React进行组件库开发</h1><div class="meta"><div class="postdate"><time datetime="2018-12-14" itemprop="datePublished">2018-12-14</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e最近针对日常业务需求使用react封装了一套[组件库], 大概记录下整个开发过程中的心得。由于篇幅原因，在这里只对开发过程中比较纠结的选型和打包等进行讨论，后续再对具体组件的封装进行讨论。\x3cbr\x3e文章首发于\x3ca href=\x22http:\/\/helloathon.club\/2018\/02\/05\/develop-component-library-with-react\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e个人博客\x3c\/a\x3e\n\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e概述\x3c\/h2\x3e\n\x3cp\x3e我们都知道，组件化的开发模式对于我们的开发效率有着极大的提升，针对我们日常使用的基本组件进行封装，可以大量的简化我们对于基本UI的关注度，让我们的工作聚焦在业务逻辑上，很好的分离业务与基础UI的代码，使得整个项目更有调理，这也是我们要进行本组件库开发的原因。\x3c\/p\x3e\n\x3cp\x3e然而现有React开源组件有很多，像ant-design和material-ui等等，是否需要花费精力打造适合自身团队的组件库往往需要酌情考虑。我们来看下我现有团队及业务的几个特点：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e前端人员较多，需要相互协作，且有余力对组件进行开发\x3c\/li\x3e\n\x3cli\x3e产品业务相对复杂，需对某些组件进行定制化开发\x3c\/li\x3e\n\x3cli\x3e已经有成熟的设计规范，针对各种基础组件、基础样式等进行定义\x3c\/li\x3e\n\x3cli\x3e目前的项目较为凌乱，第三方组件引用杂乱无章\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e可以看出，我们拥有封装自己组件的精力和基础，并且拥有通过基础组件封装改变目前开发现状的需求。所以，这件事情是我们应该并且需要尽快完成的事情。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e技术选型\x3c\/h2\x3e\n\x3cp\x3e针对组件库的封装，我们首先面对的是技术选型以及方案的规划。大概包括以下两点：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e最基本的技术方案\x3c\/li\x3e\n\x3cli\x3e开发流程和规范\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e技术方案选择\x3c\/h3\x3e\n\x3cp\x3eWebpack \x2b React \x2b Sass\x3c\/p\x3e\n\x3cp\x3e由于团队现有的项目都是基于React\x2bRedux进行开发的，那我们选择的开发语言无疑是React。\x3c\/p\x3e\n\x3ch4\x3eSASS\x3c\/h4\x3e\n\x3cp\x3e针对css选择，虽然现在针对组件化开发，比较流行CSS Modules\x3cbr\x3e和CSS-IN-JS两中模块化解决方案，我们更希望我们的组件是可进行定制的。因此针对组件，我们以Sass作为预编译语言，提搞效率和规范性。配合css-modules，我们可以很方便的进行针对实际需求进行样式更改。例如我们有一个Tab组件，我们已经定义好了其通用的样式：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22.tip-tab {\n  border: 1px solid #ccc;\n}\n.tip-tab-item {\n  border: 1px solid #ccc;\n  \n  \x26amp;.active {\n    border-color: red;\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22css hljs\x22\x3e\x3ccode class=\x22css\x22\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.tip-tab\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3eborder\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1px\x3c\/span\x3e solid \x3cspan class=\x22hljs-number\x22\x3e#ccc\x3c\/span\x3e;\n}\n\x3cspan class=\x22hljs-selector-class\x22\x3e.tip-tab-item\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3eborder\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1px\x3c\/span\x3e solid \x3cspan class=\x22hljs-number\x22\x3e#ccc\x3c\/span\x3e;\n  \n  \x26amp;.active {\n    \x3cspan class=\x22hljs-attribute\x22\x3eborder-color\x3c\/span\x3e: red;\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e而在业务中，针对某一个需求，我们需要针对Tab组件的样式进行微调。让其在激活(active)状态下border-color是蓝色的。你当然可以说，我们可以让我们的组件暴露出一些props，针对这些修改进行配置，传入不同的props对应不同的风格。但是我们往往无法满足所有的业务需求，不可能针对组件把各种样式都封装进去。针对这种方案，我们采用css-modules为其添加唯一的模块样式：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cTab styleName=\x26quot;unique-tab\x26quot; \/\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x26lt;Tab styleName=\x3cspan class=\x22hljs-string\x22\x3e\x22unique-tab\x22\x3c\/span\x3e \/\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e针对该模块，对其进行基本样式的修改:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22.unique-tab {\n  :global {\n      .tip-tab-item {\n        border-color: #eee;\n        \n        \x26amp;.active {\n          border-color: blue;\n        }\n      }\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22css hljs\x22\x3e\x3ccode class=\x22css\x22\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.unique-tab\x3c\/span\x3e {\n  :global {\n      .tip-tab-item {\n        \x3cspan class=\x22hljs-attribute\x22\x3eborder-color\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e#eee\x3c\/span\x3e;\n        \n        \x26amp;.active {\n          \x3cspan class=\x22hljs-attribute\x22\x3eborder-color\x3c\/span\x3e: blue;\n        }\n      }\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样，针对该模块的定制样式，能很好的进行针对需求的样式定制，同时不对全局样式进行污染。\x3c\/p\x3e\n\x3ch4\x3eIcon\x3c\/h4\x3e\n\x3cp\x3e针对项目图标，计划使用svg-sprite方案。但是由于产品处于在不断迭代的过程中，新的图标不断在增加。目前我们并不会对图标统一进行打包，而是在每次进行组件打包的过程中，从项目中导入所有的图标。用以下方式进行引入：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import Icon from \x27@common\/lib\x27\nimport errorIcon from \x27@images\/error.svg\x27\n\n\x3cIcon link={errorIcon} \/\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs clean\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Icon \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27@common\/lib\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e errorIcon \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27@images\/error.svg\x27\x3c\/span\x3e\n\n\x26lt;Icon link={errorIcon} \/\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其实更好的方式是针对所有的图标进行统一打包，生成svg-spirte文件(具体原理可以查询svg-sprite,在此不再赘述)。当我们进行使用时，只需直接引用即可，避免每次都进行打包，减少webpack处理依赖的时间：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cIcon type=\x26quot;error\x26quot; \/\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs fsharp\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x26lt;Icon \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22error\x22\x3c\/span\x3e \/\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e开发流程和规范\x3c\/h3\x3e\n\x3cp\x3e针对开发流程和规范，我们遵循以下几个原则：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e组件库完全独立于项目进行开发，便于后续多个项目进行使用等\x3c\/li\x3e\n\x3cli\x3e组件库包含三种模式：开发，测试，打包，文档案例，区分不同的入口及状态\x3c\/li\x3e\n\x3cli\x3e使用pure-renderautobind等尽可能保证组件的性能及效率\x3c\/li\x3e\n\x3cli\x3e保证props和回调的语义性，如回调统一使用handleXXX进行处理\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e为了便于后续的扩展，我们更希望整个组件库完全脱离于项目进行开发。保证组件库仅对于最基本的组件进行封装，将项目UI代码与业务逻辑进行分离。\x3c\/p\x3e\n\x3cp\x3e针对不同的模式下，我们有不同的文件入口，针对开发模式，我们启动一个dev-server, 在里面对组件进行基本的封装，并进行调试。打包时，我们只需对组件内容进行封装，暴露统一的接口。在文档中，我们需要进行案例和说明的展示。所以我们在利用webpack的特性进行各种环境的配置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm run dev  \/\/ 开发\nnpm run test  \/\/ 测试\nnpm run build  \/\/ 构建\nnpm run styleguide  \/\/ 文档开发\nnpm run styleguide:build \/\/ 文档打包\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dockerfile\x22\x3e\x3ccode\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3erun\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e dev  \/\/ 开发\n\x3c\/span\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3erun\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e \x3cspan class=\x22hljs-built_in\x22\x3etest\x3c\/span\x3e  \/\/ 测试\n\x3c\/span\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3erun\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e build  \/\/ 构建\n\x3c\/span\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3erun\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e styleguide  \/\/ 文档开发\n\x3c\/span\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3erun\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e styleguide:build \/\/ 文档打包\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e组件库作为项目的最小力度支持，我们需要保证其最基本的渲染效率，因此我们采用pure-render\/autobind等对其进行基本的优化。React有很多优化方式，在此不进行赘述。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e打包\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e基础\x3c\/h3\x3e\n\x3cp\x3e针对组件库的打包，我们以UMD格式对其进行打包。webpack可以针对输出进行格式设置：（引自\x3ca href=\x22https:\/\/cnodejs.org\/topic\/5833e104bde2b59e06141e16\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ecnode\x3c\/a\x3e)\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e“var” 以变量方式输出\x3c\/li\x3e\n\x3cli\x3e“this” 以 this 的一个属性输出： this[“Library”] = xxx；\x3c\/li\x3e\n\x3cli\x3e“commonjs” 以 exports 的一个属性输出：exports[“Library”] = xxx；\x3c\/li\x3e\n\x3cli\x3e“commonjs2” 以 module.exports 形式输出：module.exports = xxx；\x3c\/li\x3e\n\x3cli\x3e“amd” 以 AMD 格式输出；\x3c\/li\x3e\n\x3cli\x3e“umd” 同时以 AMD、CommonJS2 和全局属性形式输出。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e配置如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22output: {\n  path: config.build.assetsRoot,\n  filename: utils.assetsPath(\x27js\/[name].js\x27),\n  chunkFilename: utils.assetsPath(\x27js\/[id].js\x27),\n  library: \x27TipUi\x27,\n  libraryTarget: \x27umd\x27\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3eoutput\x3c\/span\x3e: {\n  \x3cspan class=\x22hljs-attribute\x22\x3epath\x3c\/span\x3e: config.build.assetsRoot,\n  filename: utils.\x3cspan class=\x22hljs-built_in\x22\x3eassetsPath\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27js\/[name].js\x27\x3c\/span\x3e),\n  chunkFilename: utils.\x3cspan class=\x22hljs-built_in\x22\x3eassetsPath\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27js\/[id].js\x27\x3c\/span\x3e),\n  library: \x3cspan class=\x22hljs-string\x22\x3e\x27TipUi\x27\x3c\/span\x3e,\n  libraryTarget: \x3cspan class=\x22hljs-string\x22\x3e\x27umd\x27\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e依赖\x3c\/h3\x3e\n\x3cp\x3e很明显，我们封装的是一个针对React的组件库，并不应该把React引用进去。一般我们可以采用externals的方式对其进行处理。\x3c\/p\x3e\n\x3cp\x3e在这里, 我们采用dll方式将其与其他第三方依赖统一进行打包，并将manifest.json和三方依赖的输出文件输出到项目中去，在项目中也使用dllReference进行引用。避免在项目中使用到这些依赖时重复进行打包。\x3c\/p\x3e\n\x3cp\x3e同时，由于我们的组件库处于一个不断维护的状态。这就需要我们维持好项目库和项目之间的打包关系，具体的流程如图所示：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV3kZu?w=1750\x26amp;h=1366\x22 src=\x22https:\/\/static.alili.tech\/img\/bV3kZu?w=1750\x26amp;h=1366\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e在每次进行项目打包的时候，首先检测UI库是否有更新，若没有更新，则直接进行打包。反之继续检测dll的依赖是否有变化，若有，则打包dll,否则直接打包组件库内容。然后将输出结果同步到项目中，再进行最终打包。\x3c\/p\x3e\n\x3cp\x3e当然，以上的这些流程都是\x3cstrong\x3e\x3cem\x3e自动\x3c\/em\x3e\x3c\/strong\x3e进行的。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e文档和示例\x3c\/h2\x3e\n\x3cp\x3e一个完善的文档对于一个组件库是及其重要的，每个组件有什么样的配置参数，拥有哪些事件回调，对应的Demo和展示效果。假设没有这些，除了封装组件的人，没有人知道它该如何使用。但是写文档的过程往往是痛苦的，在这里推荐几个文档生成库，可以极大的简化文档工作：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/docsify.js.org\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3edocsify\x3c\/a\x3e 基于Vue的组件生成器，轻量好用\x3c\/li\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/react-styleguidist.js.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-styleguidist\x3c\/a\x3e 基于React的组件库文档生成器，自动根据注释生成文档，支持Demo展示。\x3cstrong\x3e\x3cem\x3e超好用\x3c\/em\x3e\x3c\/strong\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/github.com\/benjycui\/bisheng\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ebisheng\x3c\/a\x3e ant design自己写的文档生成器\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e我们使用的styleguidist, 可以将md自动转化为文档，支持在md内直接调用你封装好的组件并进行展示，简单好用。最后封装的文档大概长这样：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV3kZD?w=1560\x26amp;h=957\x22 src=\x22https:\/\/static.alili.tech\/img\/bV3kZD?w=1560\x26amp;h=957\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e其实封装组件库这种工作有很多的东西值得琢磨和钻研，由于篇幅原因，在这里只对开发过程中比较纠结的选型和打包等进行讨论，后续再对具体组件的封装进行讨论。在书写的同时，不断参考下ant design这种优秀的组件库，能学到很多的东西。更深刻的理解封装组件的思想，是一个很好的过程。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>使用React进行组件库开发</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000013149710">https://segmentfault.com/a/1190000013149710</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/7wsntafy0w/" target="_blank">https://alili.tech/archive/7wsntafy0w/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>