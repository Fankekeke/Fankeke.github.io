<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="浅谈使用 Vue 构建前端 10w&#43; 代码量的单页面应用开发底层"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>浅谈使用 Vue 构建前端 10w&#43; 代码量的单页面应用开发底层 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/9a0ea8f2/",
				"appid": "1613049289050283", 
				"title": "浅谈使用 Vue 构建前端 10w&#43; 代码量的单页面应用开发底层 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-10-23T00:00:00"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/f2752c38/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/665d92b6/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f9a0ea8f2%2f&text=%e6%b5%85%e8%b0%88%e4%bd%bf%e7%94%a8%20Vue%20%e6%9e%84%e5%bb%ba%e5%89%8d%e7%ab%af%2010w%2b%20%e4%bb%a3%e7%a0%81%e9%87%8f%e7%9a%84%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8%e5%bc%80%e5%8f%91%e5%ba%95%e5%b1%82"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f9a0ea8f2%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f9a0ea8f2%2f&text=%e6%b5%85%e8%b0%88%e4%bd%bf%e7%94%a8%20Vue%20%e6%9e%84%e5%bb%ba%e5%89%8d%e7%ab%af%2010w%2b%20%e4%bb%a3%e7%a0%81%e9%87%8f%e7%9a%84%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8%e5%bc%80%e5%8f%91%e5%ba%95%e5%b1%82"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f9a0ea8f2%2f&title=%e6%b5%85%e8%b0%88%e4%bd%bf%e7%94%a8%20Vue%20%e6%9e%84%e5%bb%ba%e5%89%8d%e7%ab%af%2010w%2b%20%e4%bb%a3%e7%a0%81%e9%87%8f%e7%9a%84%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8%e5%bc%80%e5%8f%91%e5%ba%95%e5%b1%82"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f9a0ea8f2%2f&is_video=false&description=%e6%b5%85%e8%b0%88%e4%bd%bf%e7%94%a8%20Vue%20%e6%9e%84%e5%bb%ba%e5%89%8d%e7%ab%af%2010w%2b%20%e4%bb%a3%e7%a0%81%e9%87%8f%e7%9a%84%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8%e5%bc%80%e5%8f%91%e5%ba%95%e5%b1%82"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e6%b5%85%e8%b0%88%e4%bd%bf%e7%94%a8%20Vue%20%e6%9e%84%e5%bb%ba%e5%89%8d%e7%ab%af%2010w%2b%20%e4%bb%a3%e7%a0%81%e9%87%8f%e7%9a%84%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8%e5%bc%80%e5%8f%91%e5%ba%95%e5%b1%82&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f9a0ea8f2%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f9a0ea8f2%2f&title=%e6%b5%85%e8%b0%88%e4%bd%bf%e7%94%a8%20Vue%20%e6%9e%84%e5%bb%ba%e5%89%8d%e7%ab%af%2010w%2b%20%e4%bb%a3%e7%a0%81%e9%87%8f%e7%9a%84%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8%e5%bc%80%e5%8f%91%e5%ba%95%e5%b1%82"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f9a0ea8f2%2f&title=%e6%b5%85%e8%b0%88%e4%bd%bf%e7%94%a8%20Vue%20%e6%9e%84%e5%bb%ba%e5%89%8d%e7%ab%af%2010w%2b%20%e4%bb%a3%e7%a0%81%e9%87%8f%e7%9a%84%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8%e5%bc%80%e5%8f%91%e5%ba%95%e5%b1%82"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f9a0ea8f2%2f&title=%e6%b5%85%e8%b0%88%e4%bd%bf%e7%94%a8%20Vue%20%e6%9e%84%e5%bb%ba%e5%89%8d%e7%ab%af%2010w%2b%20%e4%bb%a3%e7%a0%81%e9%87%8f%e7%9a%84%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8%e5%bc%80%e5%8f%91%e5%ba%95%e5%b1%82"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f9a0ea8f2%2f&title=%e6%b5%85%e8%b0%88%e4%bd%bf%e7%94%a8%20Vue%20%e6%9e%84%e5%bb%ba%e5%89%8d%e7%ab%af%2010w%2b%20%e4%bb%a3%e7%a0%81%e9%87%8f%e7%9a%84%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%ba%94%e7%94%a8%e5%bc%80%e5%8f%91%e5%ba%95%e5%b1%82"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文链接">原文链接</a></li><li><a href="#原文标题">原文标题</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">浅谈使用 Vue 构建前端 10w&#43; 代码量的单页面应用开发底层</h1><div class="meta"><div class="postdate"><time datetime="2018-10-23" itemprop="datePublished">2018-10-23</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000015472616?w=845\x26amp;h=622\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000015472616?w=845\x26amp;h=622\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e开始之前\x3c\/h2\x3e\n\x3cp\x3e随着业务的不断累积，目前我们 \x3ccode\x3eToC 端\x3c\/code\x3e主要项目，除去 \x3ccode\x3enode_modules\x3c\/code\x3e， \x3ccode\x3ebuild 配置文件\x3c\/code\x3e，\x3ccode\x3edist 静态资源文件\x3c\/code\x3e的代码量为 \x3ccode\x3e137521\x3c\/code\x3e 行，后台管理系统下各个子应用代码，除去依赖等文件的总行数也达到 \x3ccode\x3e100万\x3c\/code\x3e 多一点。\x3c\/p\x3e\n\x3cblockquote\x3e代码量意味不了什么，只能证明模块很多，但相同两个项目，在\x3ccode\x3e运行时性能相同\x3c\/code\x3e情况下，\x3cstrong\x3e你的 \x3ccode\x3e10 万\x3c\/code\x3e行代码能容纳并维护 \x3ccode\x3e150\x3c\/code\x3e 个模块，并且开发顺畅，我的项目中 \x3ccode\x3e10 万\x3c\/code\x3e行代码却只能容纳 \x3ccode\x3e100\x3c\/code\x3e 个模块，添加功能也好，维护起来也较为繁琐，这就很值得思考\x3c\/strong\x3e。\x3c\/blockquote\x3e\n\x3cp\x3e本文会在主要描述以 \x3ccode\x3eVue 技术栈\x3c\/code\x3e为\x3ccode\x3e技术主体\x3c\/code\x3e，\x3ccode\x3eToC 端\x3c\/code\x3e项目\x3ccode\x3e业务主体\x3c\/code\x3e，在构建过程中，遇到或者总结的点（也会提及一些 ToB 项目的场景），\x3cstrong\x3e可能并不适合你的业务场景（仅供参考），我会尽可能多的描述问题与其中的思考，最大可能的帮助到需要的同学\x3c\/strong\x3e，也辛苦开发者发现问题或者不合理\/不正确的地方及时向我反馈，会尽快修改，欢迎有更好的实现方式来 \x3ccode\x3epr\x3c\/code\x3e。\x3c\/p\x3e\n\x3ch5\x3eGit 地址\x3c\/h5\x3e\n\x3cul\x3e\x3cli\x3e\n\x3ca href=\x22https:\/\/github.com\/PerseveranceZ\/vue-develop-template\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3evue-develop-template\x3c\/a\x3e 完善中，可以运行\x3c\/li\x3e\x3c\/ul\x3e\n\x3ch5\x3eReact 项目\x3c\/h5\x3e\n\x3cp\x3e可以参考\x3ccode\x3e蚂蚁金服数据体验技术团队\x3c\/code\x3e编写的文章：\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3ca href=\x22https:\/\/juejin.im\/post\/59cb0d0b5188257e876a2d27\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e如何管理好10万行代码的前端单页面应用\x3c\/a\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e本文并不是基于上面文章写的，不过当时在看到他们文章之后觉得有相似的地方，相较于这篇文章，本文可能会枯燥些，会有大量代码，同学可以直接用上仓库看。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e① 单页面，多页面\x3c\/h2\x3e\n\x3cp\x3e首先要思考我们的项目最终的\x3ccode\x3e构建主体\x3c\/code\x3e是\x3ccode\x3e单页面\x3c\/code\x3e，还是\x3ccode\x3e多页面\x3c\/code\x3e，还是\x3ccode\x3e单页 \x2b 多页\x3c\/code\x3e，通过他们的优缺点来分析：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3e\x3cstrong\x3e单页面（SPA）\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e优点：体验好，路由之间跳转流程，可定制转场动画，使用了\x3ccode\x3e懒加载\x3c\/code\x3e可有效减少首页白屏时间，相较于\x3ccode\x3e多页面\x3c\/code\x3e减少了用户访问静态资源服务器的次数等。\x3c\/li\x3e\n\x3cli\x3e缺点：初始会加载较大的静态资源，并且随着业务增长会越来越大，\x3ccode\x3e懒加载\x3c\/code\x3e也有他的弊端，不做特殊处理不利于 SEO 等。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e\x3cstrong\x3e多页面（MPA）\x3c\/strong\x3e：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e优点：对搜索引擎友好，开发难度较低。\x3c\/li\x3e\n\x3cli\x3e缺点：资源请求较多，整页刷新体验较差，页面间传递数据只能依赖 \x3ccode\x3eURL\x3c\/code\x3e，\x3ccode\x3ecookie\x3c\/code\x3e，\x3ccode\x3estorage\x3c\/code\x3e 等方式，较为局限。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e\x3cstrong\x3eSPA \x2b MPA\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e这种方式常见于较\x3ccode\x3e老 MPA 项目迁移至 SPA 的情况\x3c\/code\x3e，缺点结合两者，两种主体通信方式也只能以兼容\x3ccode\x3eMPA 为准\x3c\/code\x3e\n\x3c\/li\x3e\n\x3cli\x3e不过这种方式也有他的好处，假如你的 SPA 中，有类似文章分享这样（没有后端直出，后端返 \x3ccode\x3eHTML 串\x3c\/code\x3e的情况下），想保证用户体验在 SPA 中开发一个页面，在 MPA 中也开发一个页面，去掉没用的依赖，或者直接用原生 JS 来开发，分享出去是 MPA 的文章页面，这样可以\x3cstrong\x3e加快分享出去的打开速度，同时也能减少静态资源服务器的压力\x3c\/strong\x3e，因为如果分享出去的是 SPA 的文章页面，那 SPA 所需的静态资源\x3ccode\x3e至少都需要去进行协商请求\x3c\/code\x3e,当然如果服务配置了强缓存就忽略以上所说。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e我们首先根据业务所需，来最终确定\x3ccode\x3e构建主体\x3c\/code\x3e，而我们选择了\x3ccode\x3e体验至上的 SPA\x3c\/code\x3e，并选用 \x3ccode\x3eVue\x3c\/code\x3e 技术栈。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e② 目录结构\x3c\/h2\x3e\n\x3cp\x3e其实我们看开源的绝大部分项目中，目录结构都会差不太多，我们可以综合一下来个通用的 \x3ccode\x3esrc\x3c\/code\x3e 目录：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22src\n├── assets          \/\/ 资源目录 图片，样式，iconfont\n├── components      \/\/ 全局通用组件目录\n├── config          \/\/ 项目配置，拦截器，开关\n├── plugins         \/\/ 插件相关，生成路由、请求、store 等实例，并挂载 Vue 实例\n├── directives      \/\/ 拓展指令集合\n├── routes          \/\/ 路由配置\n├── service         \/\/ 服务层\n├── utils           \/\/ 工具类\n└── views           \/\/ 视图层\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs arduino\x22\x3e\x3ccode\x3esrc\n├── assets          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 资源目录 图片，样式，iconfont\x3c\/span\x3e\n├── components      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 全局通用组件目录\x3c\/span\x3e\n├── \x3cspan class=\x22hljs-built_in\x22\x3econfig\x3c\/span\x3e          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 项目配置，拦截器，开关\x3c\/span\x3e\n├── plugins         \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 插件相关，生成路由、请求、store 等实例，并挂载 Vue 实例\x3c\/span\x3e\n├── directives      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 拓展指令集合\x3c\/span\x3e\n├── routes          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 路由配置\x3c\/span\x3e\n├── service         \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 服务层\x3c\/span\x3e\n├── utils           \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 工具类\x3c\/span\x3e\n└── views           \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 视图层\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e③ 通用组件\x3c\/h2\x3e\n\x3cp\x3e\x3ccode\x3ecomponents\x3c\/code\x3e 中我们会存放 UI 组件库中的那些常见通用组件了，在项目中直接通过设置\x3ccode\x3e别名\x3c\/code\x3e来使用，如果其他项目需要使用，就发到 \x3ccode\x3enpm\x3c\/code\x3e 上。\x3c\/p\x3e\n\x3ch4\x3e结构\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ components 简易结构\ncomponents\n├── dist\n├── build\n├── src      \n    ├── modal\n    ├── toast\n    └── ...\n├── index.js             \n└── package.json        \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ components 简易结构\x3c\/span\x3e\ncomponents\n├── dist\n├── build\n├── src      \n    ├── modal\n    ├── toast\n    └── ...\n├── index\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e             \n└── package\x3cspan class=\x22hljs-selector-class\x22\x3e.json\x3c\/span\x3e        \x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e项目中使用\x3c\/h4\x3e\n\x3cp\x3e如果想最终编译成 \x3ccode\x3ees5\x3c\/code\x3e，直接在 html 中使用或者部署 CDN 上，在 \x3ccode\x3ebuild\x3c\/code\x3e 配置简单的打包逻辑，搭配着 \x3ccode\x3epackage.json\x3c\/code\x3e 构建 UI组件 的自动化打包发布，最终部署 \x3ccode\x3edist\x3c\/code\x3e 下的内容，并发布到 \x3ccode\x3enpm\x3c\/code\x3e 上即可。\x3c\/p\x3e\n\x3cp\x3e而我们也可直接使用 \x3ccode\x3ees6\x3c\/code\x3e 的代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import \x27Components\/src\/modal\x27\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Components\/src\/modal\x27\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e其他项目使用\x3c\/h4\x3e\n\x3cp\x3e假设我们发布的 \x3ccode\x3enpm 包\x3c\/code\x3e叫 \x3ccode\x3ebm-ui\x3c\/code\x3e，并且下载到了本地 \x3ccode\x3enpm i bm-ui -S\x3c\/code\x3e:\x3c\/p\x3e\n\x3cp\x3e修改项目的最外层打包配置，在 rules 里 \x3ccode\x3ebabel-loader\x3c\/code\x3e 或 \x3ccode\x3ehappypack\x3c\/code\x3e 中添加 \x3ccode\x3einclude\x3c\/code\x3e，\x3ccode\x3enode_modules\/bm-ui\x3c\/code\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ webpack.base.conf\n...\n    rules: [{\n        test: \/\\.vue$\/,\n        loader: \x27vue-loader\x27,\n        options: vueLoaderConfig\n    },\n    {\n        test: \/\\.js$\/,\n        loader: \x27babel-loader\x27,\n        \/\/ 这里添加\n        include: [resolve(\x27src\x27), resolve(\x27test\x27), resolve(\x27node_modules\/bm-ui\x27)]\n    },{\n    ...\n    }]\n...\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ webpack.base.conf\x3c\/span\x3e\n...\n    rules: [{\n        \x3cspan class=\x22hljs-attr\x22\x3etest\x3c\/span\x3e: \x3cspan class=\x22hljs-regexp\x22\x3e\/\\.vue$\/\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eloader\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27vue-loader\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eoptions\x3c\/span\x3e: vueLoaderConfig\n    },\n    {\n        \x3cspan class=\x22hljs-attr\x22\x3etest\x3c\/span\x3e: \x3cspan class=\x22hljs-regexp\x22\x3e\/\\.js$\/\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eloader\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27babel-loader\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这里添加\x3c\/span\x3e\n        include: [resolve(\x3cspan class=\x22hljs-string\x22\x3e\x27src\x27\x3c\/span\x3e), resolve(\x3cspan class=\x22hljs-string\x22\x3e\x27test\x27\x3c\/span\x3e), resolve(\x3cspan class=\x22hljs-string\x22\x3e\x27node_modules\/bm-ui\x27\x3c\/span\x3e)]\n    },{\n    ...\n    }]\n...\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后搭配着 \x3ccode\x3ebabel-plugin-import\x3c\/code\x3e 直接在项目中使用即可：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { modal } from \x27bm-ui\x27\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs clean\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { modal } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27bm-ui\x27\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e多个组件库\x3c\/h4\x3e\n\x3cp\x3e同时有多个组件库的话，又或者有同学专门进行组件开发的话，把 `components\x3cbr\x3e内部细分`一下，多一个文件分层。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22components\n├── bm-ui-1 \n├── bm-ui-2\n└── ...\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs armasm\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-symbol\x22\x3ecomponents\x3c\/span\x3e\n├── \x3cspan class=\x22hljs-keyword\x22\x3ebm-ui-1 \x3c\/span\x3e\n├── \x3cspan class=\x22hljs-keyword\x22\x3ebm-ui-2\n\x3c\/span\x3e└── ...\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e你的打包配置文件可以放在 \x3ccode\x3ecomponents\x3c\/code\x3e 下，进行统一打包，当然如果要开源出去还是放在对应库下。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e④ 全局配置，插件与拦截器\x3c\/h2\x3e\n\x3cp\x3e这个点其实会是项目中经常被忽略的，或者说很少聚合到一起，但同时我认为是\x3cstrong\x3e整个项目中的重要之一\x3c\/strong\x3e，后续会有例子说道。\x3c\/p\x3e\n\x3ch4\x3e全局配置，拦截器目录结构\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22config\n├── index.js             \/\/ 全局配置\/开关\n├── interceptors        \/\/ 拦截器\n    ├── index.js        \/\/ 入口文件\n    ├── axios.js        \/\/ 请求\/响应拦截\n    ├── router.js       \/\/ 路由拦截\n    └── ...\n└── ...\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3econfig\n├── index\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e             \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 全局配置\/开关\x3c\/span\x3e\n├── interceptors        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 拦截器\x3c\/span\x3e\n    ├── index\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 入口文件\x3c\/span\x3e\n    ├── axios\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 请求\/响应拦截\x3c\/span\x3e\n    ├── router\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e       \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 路由拦截\x3c\/span\x3e\n    └── ...\n└── ...\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e全局配置\x3c\/h4\x3e\n\x3cp\x3e我们在 \x3ccode\x3econfig\/index.js\x3c\/code\x3e 可能会有如下配置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ config\/index.js\n\n\/\/ 当前宿主平台 兼容多平台应该通过一些特定函数来取得\nexport const HOST_PLATFORM = \x27WEB\x27\n\/\/ 这个就不多说了\nexport const NODE_ENV = process.env.NODE_ENV || \x27prod\x27\n\n\/\/ 是否强制所有请求访问本地 MOCK，看到这里同学不难猜到，每个请求也可以单独控制是否请求 MOCK\nexport const AJAX_LOCALLY_ENABLE = false\n\/\/ 是否开启监控\nexport const MONITOR_ENABLE = true\n\/\/ 路由默认配置，路由表并不从此注入\nexport const ROUTER_DEFAULT_CONFIG = {\n    waitForData: true,\n    transitionOnLoad: true\n}\n\n\/\/ axios 默认配置\nexport const AXIOS_DEFAULT_CONFIG = {\n    timeout: 20000,\n    maxContentLength: 2000,\n    headers: {}\n}\n\n\/\/ vuex 默认配置\nexport const VUEX_DEFAULT_CONFIG = {\n    strict: process.env.NODE_ENV !== \x27production\x27\n}\n\n\/\/ API 默认配置\nexport const API_DEFAULT_CONFIG = {\n    mockBaseURL: \x27\x27,\n    mock: true,\n    debug: false,\n    sep: \x27\/\x27\n}\n\n\/\/ CONST 默认配置\nexport const CONST_DEFAULT_CONFIG = {\n    sep: \x27\/\x27\n}\n\n\/\/ 还有一些业务相关的配置\n\/\/ ...\n\n\n\/\/ 还有一些方便开发的配置\nexport const CONSOLE_REQUEST_ENABLE = true      \/\/ 开启请求参数打印\nexport const CONSOLE_RESPONSE_ENABLE = true     \/\/ 开启响应参数打印\nexport const CONSOLE_MONITOR_ENABLE = true      \/\/ 监控记录打印\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ config\/index.js\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 当前宿主平台 兼容多平台应该通过一些特定函数来取得\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e HOST_PLATFORM = \x3cspan class=\x22hljs-string\x22\x3e\x27WEB\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这个就不多说了\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e NODE_ENV = process.env.NODE_ENV || \x3cspan class=\x22hljs-string\x22\x3e\x27prod\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 是否强制所有请求访问本地 MOCK，看到这里同学不难猜到，每个请求也可以单独控制是否请求 MOCK\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e AJAX_LOCALLY_ENABLE = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 是否开启监控\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e MONITOR_ENABLE = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 路由默认配置，路由表并不从此注入\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ROUTER_DEFAULT_CONFIG = {\n    \x3cspan class=\x22hljs-attr\x22\x3ewaitForData\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3etransitionOnLoad\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ axios 默认配置\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e AXIOS_DEFAULT_CONFIG = {\n    \x3cspan class=\x22hljs-attr\x22\x3etimeout\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e20000\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3emaxContentLength\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e2000\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eheaders\x3c\/span\x3e: {}\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ vuex 默认配置\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e VUEX_DEFAULT_CONFIG = {\n    \x3cspan class=\x22hljs-attr\x22\x3estrict\x3c\/span\x3e: process.env.NODE_ENV !== \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ API 默认配置\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e API_DEFAULT_CONFIG = {\n    \x3cspan class=\x22hljs-attr\x22\x3emockBaseURL\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3emock\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3edebug\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3esep\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ CONST 默认配置\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e CONST_DEFAULT_CONFIG = {\n    \x3cspan class=\x22hljs-attr\x22\x3esep\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 还有一些业务相关的配置\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 还有一些方便开发的配置\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e CONSOLE_REQUEST_ENABLE = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 开启请求参数打印\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e CONSOLE_RESPONSE_ENABLE = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 开启响应参数打印\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e CONSOLE_MONITOR_ENABLE = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 监控记录打印\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看出这里汇集了项目中\x3cstrong\x3e所有用到的配置\x3c\/strong\x3e，下面我们在 \x3ccode\x3eplugins\x3c\/code\x3e 中实例化插件，注入对应配置，目录如下:\x3c\/p\x3e\n\x3ch4\x3e插件目录结构\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22plugins\n├── api.js              \/\/ 服务层 api 插件\n├── axios.js            \/\/ 请求实例插件\n├── const.js            \/\/ 服务层 const 插件\n├── store.js            \/\/ vuex 实例插件\n├── inject.js           \/\/ 注入 Vue 原型插件\n└── router.js           \/\/ 路由实例插件\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3eplugins\n├── api\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e              \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 服务层 api 插件\x3c\/span\x3e\n├── axios\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 请求实例插件\x3c\/span\x3e\n├── const\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 服务层 const 插件\x3c\/span\x3e\n├── store\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ vuex 实例插件\x3c\/span\x3e\n├── inject\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e           \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 注入 Vue 原型插件\x3c\/span\x3e\n└── router\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e           \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 路由实例插件\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e实例化插件并注入配置\x3c\/h4\x3e\n\x3cp\x3e这里先举出两个例子，看我们是如何注入配置，拦截器并实例化的\x3c\/p\x3e\n\x3cp\x3e实例化 \x3ccode\x3erouter\x3c\/code\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import Vue from \x27vue\x27\nimport Router from \x27vue-router\x27\nimport ROUTES from \x27Routes\x27\nimport {ROUTER_DEFAULT_CONFIG} from \x27Config\/index\x27\nimport {routerBeforeEachFunc} from \x27Config\/interceptors\/router\x27\n\nVue.use(Router)\n\n\/\/ 注入默认配置和路由表\nlet routerInstance = new Router({\n    ...ROUTER_DEFAULT_CONFIG,\n    routes: ROUTES\n})\n\/\/ 注入拦截器\nrouterInstance.beforeEach(routerBeforeEachFunc)\n\nexport default routerInstance\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Vue \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vue\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Router \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vue-router\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e ROUTES \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Routes\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {ROUTER_DEFAULT_CONFIG} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Config\/index\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {routerBeforeEachFunc} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Config\/interceptors\/router\x27\x3c\/span\x3e\n\nVue.use(Router)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 注入默认配置和路由表\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e routerInstance = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Router({\n    ...ROUTER_DEFAULT_CONFIG,\n    \x3cspan class=\x22hljs-attr\x22\x3eroutes\x3c\/span\x3e: ROUTES\n})\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 注入拦截器\x3c\/span\x3e\nrouterInstance.beforeEach(routerBeforeEachFunc)\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e routerInstance\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e实例化 \x3ccode\x3eaxios\x3c\/code\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import axios from \x27axios\x27\nimport {AXIOS_DEFAULT_CONFIG} from \x27Config\/index\x27\nimport {requestSuccessFunc, requestFailFunc, responseSuccessFunc, responseFailFunc} from \x27Config\/interceptors\/axios\x27\n\nlet axiosInstance = {}\n\naxiosInstance = axios.create(AXIOS_DEFAULT_CONFIG)\n\n\/\/ 注入请求拦截\naxiosInstance\n    .interceptors.request.use(requestSuccessFunc, requestFailFunc)\n\/\/ 注入响应拦截\naxiosInstance\n    .interceptors.response.use(responseSuccessFunc, responseFailFunc)\n\nexport default axiosInstance\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e axios \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27axios\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {AXIOS_DEFAULT_CONFIG} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Config\/index\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {requestSuccessFunc, requestFailFunc, responseSuccessFunc, responseFailFunc} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Config\/interceptors\/axios\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e axiosInstance = {}\n\naxiosInstance = axios.create(AXIOS_DEFAULT_CONFIG)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 注入请求拦截\x3c\/span\x3e\naxiosInstance\n    .interceptors.request.use(requestSuccessFunc, requestFailFunc)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 注入响应拦截\x3c\/span\x3e\naxiosInstance\n    .interceptors.response.use(responseSuccessFunc, responseFailFunc)\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e axiosInstance\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们在 \x3ccode\x3emain.js\x3c\/code\x3e \x3cstrong\x3e注入插件\x3c\/strong\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ main.js\nimport Vue from \x27vue\x27\n\nGLOBAL.vbus = new Vue()\n\n\/\/ import \x27Components\x27\/\/ 全局组件注册\nimport \x27Directives\x27 \/\/ 指令\n\n\/\/ 引入插件\nimport router from \x27Plugins\/router\x27\nimport inject from \x27Plugins\/inject\x27\nimport store from \x27Plugins\/store\x27\n\/\/ 引入组件库及其组件库样式 \n\/\/ 不需要配置的库就在这里引入 \n\/\/ 如果需要配置都放入 plugin 即可\nimport VueOnsen from \x27vue-onsenui\x27\nimport \x27onsenui\/css\/onsenui.css\x27\nimport \x27onsenui\/css\/onsen-css-components.css\x27\n\/\/ 引入根组件\nimport App from \x27.\/App\x27\n\nVue.use(inject)\nVue.use(VueOnsen)\n\n\/\/ render\nnew Vue({\n    el: \x27#app\x27,\n    router,\n    store,\n    template: \x27\x3cApp\/\x3e\x27,\n    components: { App }\n})\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ main.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Vue \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vue\x27\x3c\/span\x3e\n\nGLOBAL.vbus = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Vue()\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ import \x27Components\x27\/\/ 全局组件注册\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Directives\x27\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 指令\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 引入插件\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e router \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Plugins\/router\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e inject \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Plugins\/inject\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e store \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Plugins\/store\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 引入组件库及其组件库样式 \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 不需要配置的库就在这里引入 \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果需要配置都放入 plugin 即可\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e VueOnsen \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vue-onsenui\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27onsenui\/css\/onsenui.css\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27onsenui\/css\/onsen-css-components.css\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 引入根组件\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e App \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/App\x27\x3c\/span\x3e\n\nVue.use(inject)\nVue.use(VueOnsen)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ render\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Vue({\n    \x3cspan class=\x22hljs-attr\x22\x3eel\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27#app\x27\x3c\/span\x3e,\n    router,\n    store,\n    \x3cspan class=\x22hljs-attr\x22\x3etemplate\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;App\/\x26gt;\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ecomponents\x3c\/span\x3e: { App }\n})\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3eaxios\x3c\/code\x3e 实例我们并没有直接引用，相信你也猜到他是通过 \x3ccode\x3einject\x3c\/code\x3e 插件引用的，我们看下 \x3ccode\x3einject\x3c\/code\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import axios from \x27.\/axios\x27\nimport api from \x27.\/api\x27\nimport consts from \x27.\/const\x27\nGLOBAL.ajax = axios\n \nexport default {\n    install: (Vue, options) =\x3e {\n        Vue.prototype.$api = api\n        Vue.prototype.$ajax = axios\n        Vue.prototype.$const = consts\n        \/\/ 需要挂载的都放在这里\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e axios \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/axios\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e api \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/api\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e consts \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/const\x27\x3c\/span\x3e\nGLOBAL.ajax = axios\n \n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3einstall\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eVue, options\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        Vue.prototype.$api = api\n        Vue.prototype.$ajax = axios\n        Vue.prototype.$\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e = consts\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 需要挂载的都放在这里\x3c\/span\x3e\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里可以挂载你想在业务中( \x3ccode\x3evue\x3c\/code\x3e 实例中)便捷访问的 \x3ccode\x3eapi\x3c\/code\x3e，除了 \x3ccode\x3e$ajax\x3c\/code\x3e 之外，\x3ccode\x3eapi\x3c\/code\x3e 和 \x3ccode\x3econst\x3c\/code\x3e 两个插件是我们\x3cstrong\x3e服务层中主要的功能\x3c\/strong\x3e，后续会介绍，这样我们插件流程大致运转起来，下面写对应拦截器的方法。\x3c\/p\x3e\n\x3ch4\x3e请求，路由拦截器\x3c\/h4\x3e\n\x3cp\x3e在\x3ccode\x3eajax 拦截器\x3c\/code\x3e中(\x3ccode\x3econfig\/interceptors\/axios.js\x3c\/code\x3e)：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ config\/interceptors\/axios.js\n\nimport {CONSOLE_REQUEST_ENABLE, CONSOLE_RESPONSE_ENABLE} from \x27..\/index.js\x27\n\nexport function requestSuccessFunc (requestObj) {\n    CONSOLE_REQUEST_ENABLE \x26amp;\x26amp; console.info(\x27requestInterceptorFunc\x27, `url: ${requestObj.url}`, requestObj)\n    \/\/ 自定义请求拦截逻辑，可以处理权限，请求发送监控等\n    \/\/ ...\n    \n    return requestObj\n}\n\nexport function requestFailFunc (requestError) {\n    \/\/ 自定义发送请求失败逻辑，断网，请求发送监控等\n    \/\/ ...\n    \n    return Promise.reject(requestError);\n}\n\nexport function responseSuccessFunc (responseObj) {\n    \/\/ 自定义响应成功逻辑，全局拦截接口，根据不同业务做不同处理，响应成功监控等\n    \/\/ ...\n    \/\/ 假设我们请求体为\n    \/\/ {\n    \/\/     code: 1010,\n    \/\/     msg: \x27this is a msg\x27,\n    \/\/     data: null\n    \/\/ }\n    \n    let resData =  responseObj.data\n    let {code} = resData\n    \n    switch(code) {\n        case 0: \/\/ 如果业务成功，直接进成功回调  \n            return resData.data;\n        case 1111: \n            \/\/ 如果业务失败，根据不同 code 做不同处理\n            \/\/ 比如最常见的授权过期跳登录\n            \/\/ 特定弹窗\n            \/\/ 跳转特定页面等\n            \n            location.href = xxx \/\/ 这里的路径也可以放到全局配置里\n            return;\n        default:\n            \/\/ 业务中还会有一些特殊 code 逻辑，我们可以在这里做统一处理，也可以下方它们到业务层\n            !responseObj.config.noShowDefaultError \x26amp;\x26amp; GLOBAL.vbus.$emit(\x27global.$dialog.show\x27, resData.msg);\n            return Promise.reject(resData);\n    }\n}\n\nexport function responseFailFunc (responseError) {\n    \/\/ 响应失败，可根据 responseError.message 和 responseError.response.status 来做监控处理\n    \/\/ ...\n    return Promise.reject(responseError);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ config\/interceptors\/axios.js\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {CONSOLE_REQUEST_ENABLE, CONSOLE_RESPONSE_ENABLE} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/index.js\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erequestSuccessFunc\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3erequestObj\x3c\/span\x3e) \x3c\/span\x3e{\n    CONSOLE_REQUEST_ENABLE \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.info(\x3cspan class=\x22hljs-string\x22\x3e\x27requestInterceptorFunc\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`url: \x3cspan class=\x22hljs-subst\x22\x3e${requestObj.url}\x3c\/span\x3e`\x3c\/span\x3e, requestObj)\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 自定义请求拦截逻辑，可以处理权限，请求发送监控等\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    \n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e requestObj\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erequestFailFunc\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3erequestError\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 自定义发送请求失败逻辑，断网，请求发送监控等\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    \n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(requestError);\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eresponseSuccessFunc\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eresponseObj\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 自定义响应成功逻辑，全局拦截接口，根据不同业务做不同处理，响应成功监控等\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 假设我们请求体为\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ {\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/     code: 1010,\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/     msg: \x27this is a msg\x27,\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/     data: null\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ }\x3c\/span\x3e\n    \n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e resData =  responseObj.data\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e {code} = resData\n    \n    \x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e(code) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e: \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果业务成功，直接进成功回调  \x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e resData.data;\n        \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1111\x3c\/span\x3e: \n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果业务失败，根据不同 code 做不同处理\x3c\/span\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 比如最常见的授权过期跳登录\x3c\/span\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 特定弹窗\x3c\/span\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 跳转特定页面等\x3c\/span\x3e\n            \n            location.href = xxx \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这里的路径也可以放到全局配置里\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e:\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 业务中还会有一些特殊 code 逻辑，我们可以在这里做统一处理，也可以下方它们到业务层\x3c\/span\x3e\n            !responseObj.config.noShowDefaultError \x26amp;\x26amp; GLOBAL.vbus.$emit(\x3cspan class=\x22hljs-string\x22\x3e\x27global.$dialog.show\x27\x3c\/span\x3e, resData.msg);\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(resData);\n    }\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eresponseFailFunc\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eresponseError\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 响应失败，可根据 responseError.message 和 responseError.response.status 来做监控处理\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(responseError);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e定义\x3ccode\x3e路由拦截器\x3c\/code\x3e(\x3ccode\x3econfig\/interceptors\/router.js\x3c\/code\x3e)：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ config\/interceptors\/router.js\n\nexport function routerBeforeFunc (to, from, next) {\n    \/\/ 这里可以做页面拦截，很多后台系统中也非常喜欢在这里面做权限处理\n    \n    \/\/ next(...)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ config\/interceptors\/router.js\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erouterBeforeFunc\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eto, from, next\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这里可以做页面拦截，很多后台系统中也非常喜欢在这里面做权限处理\x3c\/span\x3e\n    \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ next(...)\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最后在\x3ccode\x3e入口文件(config\/interceptors\/index.js)\x3c\/code\x3e中引入并暴露出来即可:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import {requestSuccessFunc, requestFailFunc, responseSuccessFunc, responseFailFunc} from \x27.\/ajax\x27\nimport {routerBeforeEachFunc} from \x27.\/router\x27\n\nlet interceptors = {\n    requestSuccessFunc,\n    requestFailFunc,\n    responseSuccessFunc,\n    responseFailFunc,\n    routerBeforeEachFunc\n}\n\nexport default interceptors\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {requestSuccessFunc, requestFailFunc, responseSuccessFunc, responseFailFunc} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/ajax\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {routerBeforeEachFunc} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/router\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e interceptors = {\n    requestSuccessFunc,\n    requestFailFunc,\n    responseSuccessFunc,\n    responseFailFunc,\n    routerBeforeEachFunc\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e interceptors\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e请求拦截这里代码都很简单，对于 \x3ccode\x3eresponseSuccessFunc\x3c\/code\x3e 中 switch \x3ccode\x3edefault\x3c\/code\x3e 逻辑做下简单说明：\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e\n\x3ccode\x3eresponseObj.config.noShowDefaultError\x3c\/code\x3e 这里可能不太好理解\x3c\/li\x3e\x3c\/ol\x3e\n\x3cp\x3e我们在请求的时候，可以传入一个 axios 中并没有意义的 \x3ccode\x3enoShowDefaultError\x3c\/code\x3e 参数为我们业务所用，当值为 false 或者不存在时，我们会触发全局事件 \x3ccode\x3eglobal.dialog.show\x3c\/code\x3e，\x3ccode\x3eglobal.dialog.show\x3c\/code\x3e我们会注册在 \x3ccode\x3eapp.vue\x3c\/code\x3e 中：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ app.vue\n\nexport default {\n    ...\n    created() {\n        this.bindEvents\n    },\n    methods: {\n        bindEvents() {\n            GLOBAL.vbus.$on(\x27global.dialog.show\x27, (msg) =\x3e {\n                if(msg) return\n                \/\/ 我们会在这里注册全局需要操控试图层的事件，方便在非业务代码中通过发布订阅调用\n                this.$dialog.popup({\n                    content: msg \n                });\n            })\n        }\n        ...\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ app.vue\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n    ...\n    created() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.bindEvents\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3emethods\x3c\/span\x3e: {\n        bindEvents() {\n            GLOBAL.vbus.$on(\x3cspan class=\x22hljs-string\x22\x3e\x27global.dialog.show\x27\x3c\/span\x3e, (msg) =\x26gt; {\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(msg) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 我们会在这里注册全局需要操控试图层的事件，方便在非业务代码中通过发布订阅调用\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$dialog.popup({\n                    \x3cspan class=\x22hljs-attr\x22\x3econtent\x3c\/span\x3e: msg \n                });\n            })\n        }\n        ...\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e这里也可以把弹窗状态放入 \x3ccode\x3eStore\x3c\/code\x3e 中，按团队喜好，我们习惯把\x3cstrong\x3e公共的涉及视图逻辑的公共状态在这里注册，和业务区分开来\x3c\/strong\x3e。\x3c\/blockquote\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3ccode\x3eGLOBAL\x3c\/code\x3e 是我们挂载 \x3ccode\x3ewindow\x3c\/code\x3e 上的\x3ccode\x3e全局对象\x3c\/code\x3e，我们把需要挂载的东西都放在 \x3ccode\x3ewindow.GLOBAL\x3c\/code\x3e 里，减少命名空间冲突的可能。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3evbus\x3c\/code\x3e 其实就是我们开始 \x3ccode\x3enew Vue()\x3c\/code\x3e 挂载上去的\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22GLOBAL.vbus = new Vue()\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eGLOBAL.vbus = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eVue\x3c\/span\x3e()\x3c\/code\x3e\x3c\/pre\x3e\n\x3col\x3e\x3cli\x3e我们在这里 \x3ccode\x3ePromise.reject\x3c\/code\x3e 出去，我们就可以在 \x3ccode\x3eerror\x3c\/code\x3e 回调里面只处理我们的业务逻辑，而其他如\x3ccode\x3e断网\x3c\/code\x3e、\x3ccode\x3e超时\x3c\/code\x3e、\x3ccode\x3e服务器出错\x3c\/code\x3e等均通过拦截器进行统一处理。\x3c\/li\x3e\x3c\/ol\x3e\n\x3ch4\x3e拦截器处理前后对比\x3c\/h4\x3e\n\x3cp\x3e对比下\x3ccode\x3e处理前后在业务中的发送请求的代码\x3c\/code\x3e：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e拦截器处理前\x3c\/strong\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22this.$axios.get(\x27test_url\x27).then(({code, data}) =\x3e {\n    if( code === 0 ) {\n        \/\/ 业务成功\n    } else if () {}\n        \/\/ em... 各种业务不成功处理，如果遇到通用的处理，还需要抽离出来\n    \n    \n}, error =\x3e {\n   \/\/ 需要根据 error 做各种抽离好的处理逻辑，断网，超时等等...\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$axios.get(\x3cspan class=\x22hljs-string\x22\x3e\x27test_url\x27\x3c\/span\x3e).then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e{code, data}\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e( code === \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e ) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 业务成功\x3c\/span\x3e\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e () {}\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ em... 各种业务不成功处理，如果遇到通用的处理，还需要抽离出来\x3c\/span\x3e\n    \n    \n}, error =\x26gt; {\n   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 需要根据 error 做各种抽离好的处理逻辑，断网，超时等等...\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e拦截器处理后\x3c\/strong\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 业务失败走默认弹窗逻辑的情况\nthis.$axios.get(\x27test_url\x27).then(({data}) =\x3e {\n    \/\/ 业务成功，直接操作 data 即可\n})\n\n\/\/ 业务失败自定义\nthis.$axios.get(\x27test_url\x27, {\n    noShowDefaultError: true \/\/ 可选\n}).then(({data}) =\x3e {\n    \/\/ 业务成功，直接操作 data 即可\n    \n}, (code, msg) =\x3e {\n    \/\/ 当有特定 code 需要特殊处理，传入 noShowDefaultError:true，在这个回调处理就行\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 业务失败走默认弹窗逻辑的情况\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$axios.get(\x3cspan class=\x22hljs-string\x22\x3e\x27test_url\x27\x3c\/span\x3e).then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e{data}\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 业务成功，直接操作 data 即可\x3c\/span\x3e\n})\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 业务失败自定义\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$axios.get(\x3cspan class=\x22hljs-string\x22\x3e\x27test_url\x27\x3c\/span\x3e, {\n    \x3cspan class=\x22hljs-attr\x22\x3enoShowDefaultError\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 可选\x3c\/span\x3e\n}).then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e{data}\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 业务成功，直接操作 data 即可\x3c\/span\x3e\n    \n}, (code, msg) =\x26gt; {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 当有特定 code 需要特殊处理，传入 noShowDefaultError:true，在这个回调处理就行\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e\x3cstrong\x3e为什么要如此配置与拦截器？\x3c\/strong\x3e\x3c\/h4\x3e\n\x3cblockquote\x3e在应对项目开发过程中需求的不可预见性时，让我们能处理的更快更好\x3c\/blockquote\x3e\n\x3cp\x3e到这里很多同学会觉得，就这么简单的引入判断，可有可无，\x3cbr\x3e就如我们最近做的一个需求来说，我们 ToC 端项目之前一直是在微信公众号中打开的，而我们需要在小程序中通过 webview 打开大部分流程，而我们也\x3ccode\x3e没有时间，没有空间\x3c\/code\x3e在小程序中重写近 100 \x2b 的页面流程，\x3cstrong\x3e这是我们开发之初并没有想到的\x3c\/strong\x3e。这时候必须把项目兼容到小程序端，在兼容过程中可能需要解决以下问题：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e请求路径完全不同。\x3c\/li\x3e\n\x3cli\x3e需要兼容两套不同的权限系统。\x3c\/li\x3e\n\x3cli\x3e有些流程在小程序端需要做改动，跳转到特定页面。\x3c\/li\x3e\n\x3cli\x3e有些公众号的 \x3ccode\x3eapi\x3c\/code\x3e ，在小程序中无用，需要调用小程序的逻辑，需要做兼容。\x3c\/li\x3e\n\x3cli\x3e很多也页面上的元素，小程序端不做展示等。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cblockquote\x3e可以看出，稍微不慎，会影响公众号现有逻辑。\x3c\/blockquote\x3e\n\x3cul\x3e\n\x3cli\x3e添加请求拦截 \x3ccode\x3einterceptors\/minaAjax.js\x3c\/code\x3e， \x3ccode\x3einterceptors\/minaRouter.js\x3c\/code\x3e，原有的换更为 \x3ccode\x3einterceptors\/officalAjax.js\x3c\/code\x3e，\x3ccode\x3einterceptors\/officalRouter.js\x3c\/code\x3e，在入口文件\x3ccode\x3einterceptors\/index.js\x3c\/code\x3e，\x3cstrong\x3e根据当前\x3ccode\x3e宿主平台\x3c\/code\x3e，也就是全局配置 \x3ccode\x3eHOST_PLATFORM\x3c\/code\x3e，通过\x3ccode\x3e代理模式\x3c\/code\x3e和\x3ccode\x3e策略模式\x3c\/code\x3e，注入对应平台的拦截器\x3c\/strong\x3e，\x3cstrong\x3e在\x3ccode\x3eminaAjax.js\x3c\/code\x3e中重写请求路径和权限处理，在 \x3ccode\x3eminaRouter.js\x3c\/code\x3e 中添加页面拦截配置，跳转到特定页面\x3c\/strong\x3e，这样一并解决了上面的\x3ccode\x3e问题 1，2，3\x3c\/code\x3e。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3e问题 4\x3c\/code\x3e 其实也比较好处理了，拷贝需要兼容 \x3ccode\x3eapi\x3c\/code\x3e 的页面，重写里面的逻辑，通过\x3ccode\x3e路由拦截器一并做跳转处理\x3c\/code\x3e。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3e问题 5\x3c\/code\x3e 也很简单，拓展两个\x3cstrong\x3e自定义指令 v-mina-show 和 v-mina-hide\x3c\/strong\x3e ，在展示不同步的地方可以直接使用指令。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e最终用最少的代码，最快的时间完美上线，丝毫没影响到现有 toC 端业务，而且\x3cstrong\x3e这样把所有兼容逻辑绝大部分聚合到了一起，方便二次拓展和修改。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e虽然这只是根据自身业务结合来说明，可能没什么说服力，不过不难看出全局配置\/拦截器 虽然代码不多，但却是整个项目的核心之一，我们可以在里面做更多 \x3ccode\x3eawesome\x3c\/code\x3e 的事情。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e⑤ 路由配置与懒加载\x3c\/h2\x3e\n\x3cp\x3e\x3ccode\x3edirectives\x3c\/code\x3e 里面没什么可说的，不过很多难题都可以通过他来解决，要时刻记住，我们可以再指令里面\x3cstrong\x3e操作虚拟 DOM。\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch4\x3e路由配置\x3c\/h4\x3e\n\x3cp\x3e而我们根据自己的业务性质，最终根据业务流程来拆分配置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22routes\n├── index.js            \/\/ 入口文件\n├── common.js           \/\/ 公共路由，登录，提示页等\n├── account.js          \/\/ 账户流程\n├── register.js         \/\/ 挂号流程\n└── ...\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3eroutes\n├── index\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 入口文件\x3c\/span\x3e\n├── common\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e           \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 公共路由，登录，提示页等\x3c\/span\x3e\n├── account\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 账户流程\x3c\/span\x3e\n├── register\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e         \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 挂号流程\x3c\/span\x3e\n└── ...\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最终通过 index.js 暴露出去给 \x3ccode\x3eplugins\/router\x3c\/code\x3e 实例使用，这里的拆分配置有两个注意的地方：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e需要根据自己业务性质来决定，有的项目可能适合\x3ccode\x3e业务线\x3c\/code\x3e划分，有的项目更适合以 \x3ccode\x3e功能\x3c\/code\x3e 划分。\x3c\/li\x3e\n\x3cli\x3e在多人协作过程中，尽可能避免冲突，或者减少冲突。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch4\x3e懒加载\x3c\/h4\x3e\n\x3cp\x3e文章开头说到单页面静态资源过大，\x3ccode\x3e首次打开\/每次版本升级\x3c\/code\x3e后都会较慢，可以用\x3ccode\x3e懒加载\x3c\/code\x3e来拆分静态资源，减少白屏时间，但开头也说到\x3ccode\x3e懒加载\x3c\/code\x3e也有待商榷的地方：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e如果异步加载较多的组件，会给静态资源服务器\/ CDN 带来更大的访问压力的同时，如果当多个异步组件都被修改，造成版本号的变动，发布的时候会大大增加 CDN 被击穿的风险。\x3c\/li\x3e\n\x3cli\x3e懒加载首次加载未被缓存的异步组件白屏的问题，造成用户体验不好。\x3c\/li\x3e\n\x3cli\x3e异步加载通用组件，会在页面可能会在网络延时的情况下参差不齐的展示出来等。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e这就需要我们根据项目情况在\x3ccode\x3e空间和时间\x3c\/code\x3e上做一些权衡。\x3c\/p\x3e\n\x3cp\x3e以下几点可以作为简单的参考：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e对于访问量可控的项目，如\x3ccode\x3e公司后台管理系统\x3c\/code\x3e中，可以以操作 view 为单位进行异步加载，通用组件全部同步加载的方式。\x3c\/li\x3e\n\x3cli\x3e对于一些复杂度较高，实时度较高的应用类型，可采用按\x3ccode\x3e功能模块拆分\x3c\/code\x3e进行异步组件加载。\x3c\/li\x3e\n\x3cli\x3e如果项目想保证比较高的完整性和体验，迭代频率可控，不太关心首次加载时间的话，可按需使用异步加载或者直接不使用。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cblockquote\x3e打包出来的 main.js 的大小，绝大部分都是在路由中引入的并注册的视图组件。\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e⑥ Service 服务层\x3c\/h2\x3e\n\x3cp\x3e服务层作为项目中的另一个核心之一，“自古以来”都是大家比较关心的地方。\x3c\/p\x3e\n\x3cp\x3e不知道你是否看到过如下组织代码方式：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22views\/\n    pay\/\n        index.vue\n        service.js\n        components\/\n            a.vue\n            b.vue\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3eviews\/\n    pay\/\n        index\x3cspan class=\x22hljs-selector-class\x22\x3e.vue\x3c\/span\x3e\n        service\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n        components\/\n            \x3cspan class=\x22hljs-selector-tag\x22\x3ea\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.vue\x3c\/span\x3e\n            \x3cspan class=\x22hljs-selector-tag\x22\x3eb\x3c\/span\x3e.vue\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在 \x3ccode\x3eservice.js\x3c\/code\x3e 中写入编写数据来源\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export const CONFIAG = {\n    apple: \x27苹果\x27,\n    banana: \x27香蕉\x27\n}\n\/\/ ...\n\n\/\/ ① 处理业务逻辑，还弹窗\nexport function getBInfo ({name = \x27\x27, id = \x27\x27}) {\n    return this.$ajax.get(\x27\/api\/info\x27, {\n        name, \n        id\n    }).then({age} =\x3e {\n        this.$modal.show({\n            content: age\n        })\n    })\n}\n\n\/\/ ② 不处理业务，仅仅写请求方法\nexport function getAInfo ({name = \x27\x27, id = \x27\x27}) {\n    return this.$ajax.get(\x27\/api\/info\x27, {\n        name, \n        id\n    })\n}\n\n...\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e CONFIAG = {\n    \x3cspan class=\x22hljs-attr\x22\x3eapple\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27苹果\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ebanana\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27香蕉\x27\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ ① 处理业务逻辑，还弹窗\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetBInfo\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e{name = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e, id = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e}\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$ajax.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/api\/info\x27\x3c\/span\x3e, {\n        name, \n        id\n    }).then({age} =\x26gt; {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$modal.show({\n            \x3cspan class=\x22hljs-attr\x22\x3econtent\x3c\/span\x3e: age\n        })\n    })\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ ② 不处理业务，仅仅写请求方法\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetAInfo\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e{name = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e, id = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e}\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$ajax.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/api\/info\x27\x3c\/span\x3e, {\n        name, \n        id\n    })\n}\n\n...\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e简单分析：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e① 就不多说了，拆分的不够单纯，当做二次开发的时候，你还得去找这弹窗到底哪里出来的。\x3c\/li\x3e\n\x3cli\x3e② 看起来很美好，不掺杂业务逻辑，但不知道你与没遇到过这样情况，\x3cstrong\x3e经常会有其他业务需要用到一样的枚举，请求一样的接口，而开发其他业务的同学并不知道你在这里有一份数据源，最终造成的结果就是数据源的代码到处冗余\x3c\/strong\x3e。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e我相信②在绝大多数项目中都能看到。\x3c\/p\x3e\n\x3cp\x3e那么我们的目的就很明显了，\x3cstrong\x3e解决冗余，方便使用\x3c\/strong\x3e，我们把枚举和请求接口的方法，通过插件，挂载到一个大对象上，注入 Vue 原型，方面业务使用即可。\x3c\/p\x3e\n\x3ch4\x3e目录层级（仅供参考）\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22service\n├── api\n    ├── index.js             \/\/ 入口文件\n    ├── order.js             \/\/ 订单相关接口配置\n    └── ...\n├── const                   \n    ├── index.js             \/\/ 入口文件\n    ├── order.js             \/\/ 订单常量接口配置\n    └── ...\n├── store                    \/\/ vuex 状态管理\n├── expands                  \/\/ 拓展\n    ├── monitor.js           \/\/ 监控\n    ├── beacon.js            \/\/ 打点\n    ├── localstorage.js      \/\/ 本地存储\n    └── ...                  \/\/ 按需拓展\n└── ...\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lasso\x22\x3e\x3ccode\x3eservice\n├── api\n    ├── index.js             \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 入口文件\x3c\/span\x3e\n    ├── \x3cspan class=\x22hljs-keyword\x22\x3eorder\x3c\/span\x3e.js             \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 订单相关接口配置\x3c\/span\x3e\n    └── \x3cspan class=\x22hljs-params\x22\x3e...\x3c\/span\x3e\n├── const                   \n    ├── index.js             \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 入口文件\x3c\/span\x3e\n    ├── \x3cspan class=\x22hljs-keyword\x22\x3eorder\x3c\/span\x3e.js             \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 订单常量接口配置\x3c\/span\x3e\n    └── \x3cspan class=\x22hljs-params\x22\x3e...\x3c\/span\x3e\n├── store                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ vuex 状态管理\x3c\/span\x3e\n├── expands                  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 拓展\x3c\/span\x3e\n    ├── monitor.js           \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 监控\x3c\/span\x3e\n    ├── beacon.js            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 打点\x3c\/span\x3e\n    ├── localstorage.js      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 本地存储\x3c\/span\x3e\n    └── \x3cspan class=\x22hljs-params\x22\x3e...\x3c\/span\x3e                  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 按需拓展\x3c\/span\x3e\n└── \x3cspan class=\x22hljs-params\x22\x3e...\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e抽离模型\x3c\/h4\x3e\n\x3cp\x3e首先抽离请求接口模型，可按照\x3ccode\x3e领域模型抽离\x3c\/code\x3e (\x3ccode\x3eservice\/api\/index.js\x3c\/code\x3e):\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n    user: [{\n        name: \x27info\x27,\n        method: \x27GET\x27,\n        desc: \x27测试接口1\x27,\n        path: \x27\/api\/info\x27,\n        mockPath: \x27\/api\/info\x27,\n        params: {\n            a: 1,\n            b: 2\n        }\n    }, {\n        name: \x27info2\x27,\n        method: \x27GET\x27,\n        desc: \x27测试接口2\x27,\n        path: \x27\/api\/info2\x27,\n        mockPath: \x27\/api\/info2\x27,\n        params: {\n            a: 1,\n            b: 2,\n            b: 3\n        }\n    }],\n    order: [{\n        name: \x27change\x27,\n        method: \x27POST\x27,\n        desc: \x27订单变更\x27,\n        path: \x27\/api\/order\/change\x27,\n        mockPath: \x27\/api\/order\/change\x27,\n        params: {\n            type: \x27SUCCESS\x27\n        }\n    }]\n    ...\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e{\n    \x3cspan class=\x22hljs-attr\x22\x3euser\x3c\/span\x3e: [{\n        \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27info\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3emethod\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3edesc\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27测试接口1\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/api\/info\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3emockPath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/api\/info\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eparams\x3c\/span\x3e: {\n            \x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3eb\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n        }\n    }, {\n        \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27info2\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3emethod\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3edesc\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27测试接口2\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/api\/info2\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3emockPath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/api\/info2\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eparams\x3c\/span\x3e: {\n            \x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3eb\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3eb\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\n        }\n    }],\n    \x3cspan class=\x22hljs-attr\x22\x3eorder\x3c\/span\x3e: [{\n        \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27change\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3emethod\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3edesc\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27订单变更\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/api\/order\/change\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3emockPath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/api\/order\/change\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eparams\x3c\/span\x3e: {\n            \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27SUCCESS\x27\x3c\/span\x3e\n        }\n    }]\n    ...\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e定制下需要的几个功能：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e请求参数自动截取。\x3c\/li\x3e\n\x3cli\x3e请求参数不传，则发送默认配置参数。\x3c\/li\x3e\n\x3cli\x3e得需要命名空间。\x3c\/li\x3e\n\x3cli\x3e通过全局配置开启调试模式。\x3c\/li\x3e\n\x3cli\x3e通过全局配置来控制走本地 mock 还是线上接口等。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch4\x3e插件编写\x3c\/h4\x3e\n\x3cp\x3e定制好功能，开始编写简单的 \x3ccode\x3eplugins\/api.js\x3c\/code\x3e 插件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import axios from \x27.\/axios\x27\nimport _pick from \x27lodash\/pick\x27\nimport _assign from \x27lodash\/assign\x27\nimport _isEmpty from \x27lodash\/isEmpty\x27\n\nimport { assert } from \x27Utils\/tools\x27\nimport { API_DEFAULT_CONFIG } from \x27Config\x27\nimport API_CONFIG from \x27Service\/api\x27\n\n\nclass MakeApi {\n    constructor(options) {\n        this.api = {}\n        this.apiBuilder(options)\n    }\n\n\n    apiBuilder({\n        sep = \x27|\x27,\n        config = {},\n        mock = false, \n        debug = false,\n        mockBaseURL = \x27\x27\n    }) {\n        Object.keys(config).map(namespace =\x3e {\n            this._apiSingleBuilder({\n                namespace, \n                mock, \n                mockBaseURL, \n                sep, \n                debug, \n                config: config[namespace]\n            })\n        })\n    }\n    _apiSingleBuilder({\n        namespace, \n        sep = \x27|\x27,\n        config = {},\n        mock = false, \n        debug = false,\n        mockBaseURL = \x27\x27\n    }) {\n        config.forEach( api =\x3e {\n            const {name, desc, params, method, path, mockPath } = api\n            let apiname = `${namespace}${sep}${name}`,\/\/ 命名空间\n                url = mock ? mockPath : path,\/\/控制走 mock 还是线上\n                baseURL = mock \x26amp;\x26amp; mockBaseURL\n            \n            \/\/ 通过全局配置开启调试模式。\n            debug \x26amp;\x26amp; console.info(`调用服务层接口${apiname}，接口描述为${desc}`)\n            debug \x26amp;\x26amp; assert(name, `${apiUrl} :接口name属性不能为空`)\n            debug \x26amp;\x26amp; assert(apiUrl.indexOf(\x27\/\x27) === 0, `${apiUrl} :接口路径path，首字符应为\/`)\n\n            Object.defineProperty(this.api, `${namespace}${sep}${name}`, {\n                value(outerParams, outerOptions) {\n                \n                    \/\/ 请求参数自动截取。\n                    \/\/ 请求参数不穿则发送默认配置参数。\n                    let _data = _isEmpty(outerParams) ? params : _pick(_assign({}, params, outerParams), Object.keys(params))\n                    return axios(_normoalize(_assign({\n                        url,\n                        desc,\n                        baseURL,\n                        method\n                    }, outerOptions), _data))\n                }\n            })      \n        })\n    }       \n}\n\nfunction _normoalize(options, data) {\n    \/\/ 这里可以做大小写转换，也可以做其他类型 RESTFUl 的兼容\n    if (options.method === \x27POST\x27) {\n        options.data = data\n    } else if (options.method === \x27GET\x27) {\n        options.params = data\n    }\n    return options\n} \n\/\/ 注入模型和全局配置，并暴露出去\nexport default new MakeApi({\n    config: API_CONFIG,\n    ...API_DEFAULT_CONFIG\n})[\x27api\x27]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e axios \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/axios\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e _pick \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27lodash\/pick\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e _assign \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27lodash\/assign\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e _isEmpty \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27lodash\/isEmpty\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { assert } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Utils\/tools\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { API_DEFAULT_CONFIG } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Config\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e API_CONFIG \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Service\/api\x27\x3c\/span\x3e\n\n\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eMakeApi\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e(options) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.api = {}\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.apiBuilder(options)\n    }\n\n\n    apiBuilder({\n        sep = \x3cspan class=\x22hljs-string\x22\x3e\x27|\x27\x3c\/span\x3e,\n        config = {},\n        mock = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e, \n        debug = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n        mockBaseURL = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\n    }) {\n        \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.keys(config).map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3enamespace\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._apiSingleBuilder({\n                namespace, \n                mock, \n                mockBaseURL, \n                sep, \n                debug, \n                \x3cspan class=\x22hljs-attr\x22\x3econfig\x3c\/span\x3e: config[namespace]\n            })\n        })\n    }\n    _apiSingleBuilder({\n        namespace, \n        sep = \x3cspan class=\x22hljs-string\x22\x3e\x27|\x27\x3c\/span\x3e,\n        config = {},\n        mock = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e, \n        debug = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n        mockBaseURL = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\n    }) {\n        config.forEach( \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eapi\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e {name, desc, params, method, path, mockPath } = api\n            \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e apiname = \x3cspan class=\x22hljs-string\x22\x3e`\x3cspan class=\x22hljs-subst\x22\x3e${namespace}\x3c\/span\x3e\x3cspan class=\x22hljs-subst\x22\x3e${sep}\x3c\/span\x3e\x3cspan class=\x22hljs-subst\x22\x3e${name}\x3c\/span\x3e`\x3c\/span\x3e,\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 命名空间\x3c\/span\x3e\n                url = mock ? mockPath : path,\x3cspan class=\x22hljs-comment\x22\x3e\/\/控制走 mock 还是线上\x3c\/span\x3e\n                baseURL = mock \x26amp;\x26amp; mockBaseURL\n            \n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 通过全局配置开启调试模式。\x3c\/span\x3e\n            debug \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.info(\x3cspan class=\x22hljs-string\x22\x3e`调用服务层接口\x3cspan class=\x22hljs-subst\x22\x3e${apiname}\x3c\/span\x3e，接口描述为\x3cspan class=\x22hljs-subst\x22\x3e${desc}\x3c\/span\x3e`\x3c\/span\x3e)\n            debug \x26amp;\x26amp; assert(name, \x3cspan class=\x22hljs-string\x22\x3e`\x3cspan class=\x22hljs-subst\x22\x3e${apiUrl}\x3c\/span\x3e :接口name属性不能为空`\x3c\/span\x3e)\n            debug \x26amp;\x26amp; assert(apiUrl.indexOf(\x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e) === \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`\x3cspan class=\x22hljs-subst\x22\x3e${apiUrl}\x3c\/span\x3e :接口路径path，首字符应为\/`\x3c\/span\x3e)\n\n            \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.defineProperty(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.api, \x3cspan class=\x22hljs-string\x22\x3e`\x3cspan class=\x22hljs-subst\x22\x3e${namespace}\x3c\/span\x3e\x3cspan class=\x22hljs-subst\x22\x3e${sep}\x3c\/span\x3e\x3cspan class=\x22hljs-subst\x22\x3e${name}\x3c\/span\x3e`\x3c\/span\x3e, {\n                value(outerParams, outerOptions) {\n                \n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 请求参数自动截取。\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 请求参数不穿则发送默认配置参数。\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e _data = _isEmpty(outerParams) ? params : _pick(_assign({}, params, outerParams), \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.keys(params))\n                    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e axios(_normoalize(_assign({\n                        url,\n                        desc,\n                        baseURL,\n                        method\n                    }, outerOptions), _data))\n                }\n            })      \n        })\n    }       \n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3e_normoalize\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eoptions, data\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这里可以做大小写转换，也可以做其他类型 RESTFUl 的兼容\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (options.method === \x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e) {\n        options.data = data\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (options.method === \x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e) {\n        options.params = data\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e options\n} \n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 注入模型和全局配置，并暴露出去\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e MakeApi({\n    \x3cspan class=\x22hljs-attr\x22\x3econfig\x3c\/span\x3e: API_CONFIG,\n    ...API_DEFAULT_CONFIG\n})[\x3cspan class=\x22hljs-string\x22\x3e\x27api\x27\x3c\/span\x3e]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e挂载到 \x3ccode\x3eVue 原型\x3c\/code\x3e上，上文有说到，通过 \x3ccode\x3eplugins\/inject.js\x3c\/code\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import api from \x27.\/api\x27\n \nexport default {\n    install: (Vue, options) =\x3e {\n        Vue.prototype.$api = api\n        \/\/ 需要挂载的都放在这里\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e api \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/api\x27\x3c\/span\x3e\n \n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3einstall\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eVue, options\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        Vue.prototype.$api = api\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 需要挂载的都放在这里\x3c\/span\x3e\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e使用\x3c\/h4\x3e\n\x3cp\x3e这样我们可以在\x3ccode\x3e业务中\x3c\/code\x3e愉快的使用业务层代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ .vue 中\nexport default {\n    methods: {\n        test() {\n            this.$api[\x27order\/info\x27]({\n                a: 1,\n                b: 2\n            })\n        }\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ .vue 中\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3emethods\x3c\/span\x3e: {\n        test() {\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$api[\x3cspan class=\x22hljs-string\x22\x3e\x27order\/info\x27\x3c\/span\x3e]({\n                \x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\n                \x3cspan class=\x22hljs-attr\x22\x3eb\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n            })\n        }\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e即使在\x3ccode\x3e业务之外\x3c\/code\x3e也可以使用：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import api from \x27Plugins\/api\x27\n\napi[\x27order\/info\x27]({\n    a: 1,\n    b: 2\n})\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e api \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Plugins\/api\x27\x3c\/span\x3e\n\napi[\x3cspan class=\x22hljs-string\x22\x3e\x27order\/info\x27\x3c\/span\x3e]({\n    \x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eb\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n})\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当然对于\x3ccode\x3e运行效率要求高\x3c\/code\x3e的项目中，\x3ccode\x3e避免内存使用率过大\x3c\/code\x3e，我们需要改造 API，用解构的方式引入使用，最终利用 \x3ccode\x3ewebpack\x3c\/code\x3e 的 \x3ccode\x3etree-shaking\x3c\/code\x3e 减少打包体积。\x3ca href=\x22https:\/\/github.com\/PerseveranceZ\/vue-develop-template\/issues\/4\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e几个简单的思路\x3c\/a\x3e\x3c\/p\x3e\n\x3cblockquote\x3e一般来说，多人协作时候大家都可以先看 \x3ccode\x3eapi\x3c\/code\x3e 是否有对应接口，当业务量上来的时候，也肯定会有人出现找不到，或者找起来比较费劲，这时候我们完全可以在 请求拦截器中，把当前请求的 \x3ccode\x3eurl\x3c\/code\x3e 和 \x3ccode\x3eapi\x3c\/code\x3e 中的请求做下判断，如果有重复接口请求路径，则提醒开发者已经配置相关请求，根据情况是否进行二次配置即可。\x3c\/blockquote\x3e\n\x3cp\x3e最终我们可以拓展 Service 层的各个功能：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e基础\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3eapi\x3c\/strong\x3e：\x3ccode\x3e异步与后端交互\x3c\/code\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3econst\x3c\/strong\x3e：\x3ccode\x3e常量枚举\x3c\/code\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3estore\x3c\/strong\x3e：\x3ccode\x3eVuex\x3c\/code\x3e 状态管理\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e拓展\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3elocalStorage\x3c\/strong\x3e：本地数据，稍微封装下，支持存取对象即可\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3emonitor\x3c\/strong\x3e：\x3ccode\x3e监控\x3c\/code\x3e功能，自定义搜集策略，调用 \x3ccode\x3eapi\x3c\/code\x3e 中的接口发送\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3ebeacon\x3c\/strong\x3e：\x3ccode\x3e打点\x3c\/code\x3e功能，自定义搜集策略，调用 \x3ccode\x3eapi\x3c\/code\x3e 中的接口发送\x3c\/li\x3e\n\x3cli\x3e...\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3ccode\x3econst\x3c\/code\x3e，\x3ccode\x3elocalStorage\x3c\/code\x3e，\x3ccode\x3emonitor\x3c\/code\x3e 和 \x3ccode\x3ebeacon\x3c\/code\x3e 根据业务自行拓展暴露给业务使用即可，思想也是一样的，下面着重说下 \x3ccode\x3estore(Vuex)\x3c\/code\x3e。\x3c\/p\x3e\n\x3cblockquote\x3e插一句：如果看到这里没感觉不妥的话，想想上面 \x3ccode\x3eplugins\/api.js\x3c\/code\x3e 有没有用\x3ccode\x3e单例模式\x3c\/code\x3e？该不该用？\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e⑦ 状态管理与视图拆分\x3c\/h2\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/PerseveranceZ\/zero-blog\/issues\/2\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eVuex 源码分析可以看我之前写的文章\x3c\/a\x3e。\x3c\/p\x3e\n\x3ch4\x3e我们是不是真的需要状态管理？\x3c\/h4\x3e\n\x3cblockquote\x3e答案是否定的，就算你的项目达到 10 万行代码，那也并不意味着你必须使用 Vuex，应该由\x3cstrong\x3e业务场景\x3c\/strong\x3e决定。\x3c\/blockquote\x3e\n\x3ch4\x3e业务场景\x3c\/h4\x3e\n\x3col\x3e\x3cli\x3e第一类项目：\x3cstrong\x3e业务\/视图复杂度不高，不建议使用 Vuex，会带来开发与维护的成本\x3c\/strong\x3e，使用简单的 \x3ccode\x3evbus\x3c\/code\x3e 做好\x3cstrong\x3e命名空间\x3c\/strong\x3e，来解耦即可。\x3c\/li\x3e\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let vbus = new Vue()\nvbus.$on(\x27print.hello\x27, () =\x3e {\n    console.log(\x27hello\x27)\n})\n\nvbus.$emit(\x27print.hello\x27)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e vbus = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Vue()\nvbus.$on(\x3cspan class=\x22hljs-string\x22\x3e\x27print.hello\x27\x3c\/span\x3e, () =\x26gt; {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27hello\x27\x3c\/span\x3e)\n})\n\nvbus.$emit(\x3cspan class=\x22hljs-string\x22\x3e\x27print.hello\x27\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3col\x3e\x3cli\x3e第二类项目：类似\x3ccode\x3e多人协作项目管理\x3c\/code\x3e，\x3ccode\x3e有道云笔记\x3c\/code\x3e，\x3ccode\x3e网易云音乐\x3c\/code\x3e，\x3ccode\x3e微信网页版\/桌面版\x3c\/code\x3e等\x3cstrong\x3e应用\x3c\/strong\x3e，功能集中，空间利用率高，实时交互的项目，无疑 \x3ccode\x3eVuex 是较好的选择\x3c\/code\x3e。这类应用中我们可以直接\x3ccode\x3e抽离业务领域模型\x3c\/code\x3e：\x3c\/li\x3e\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22store\n├── index.js          \n├── actions.js        \/\/ 根级别 action\n├── mutations.js      \/\/ 根级别 mutation\n└── modules\n    ├── user.js       \/\/ 用户模块\n    ├── products.js   \/\/ 产品模块\n    ├── order.js      \/\/ 订单模块\n    └── ...\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs axapta\x22\x3e\x3ccode\x3estore\n├── \x3cspan class=\x22hljs-keyword\x22\x3eindex\x3c\/span\x3e.js          \n├── actions.js        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 根级别 action\x3c\/span\x3e\n├── mutations.js      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 根级别 mutation\x3c\/span\x3e\n└── modules\n    ├── user.js       \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 用户模块\x3c\/span\x3e\n    ├── products.js   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 产品模块\x3c\/span\x3e\n    ├── \x3cspan class=\x22hljs-keyword\x22\x3eorder\x3c\/span\x3e.js      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 订单模块\x3c\/span\x3e\n    └── ...\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当然对于这类项目，\x3ccode\x3evuex\x3c\/code\x3e 或许不是最好的选择，有兴趣的同学可以学习下 \x3ccode\x3erxjs\x3c\/code\x3e。\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e第三类项目：\x3ccode\x3e后台系统\x3c\/code\x3e或者\x3ccode\x3e页面之间业务耦合不高的项目\x3c\/code\x3e，这类项目是占比应该是很大的，我们思考下这类项目：\x3c\/li\x3e\x3c\/ol\x3e\n\x3cp\x3e全局共享状态不多，但是难免在某个模块中会有复杂度较高的功能(客服系统，实时聊天，多人协作功能等)，这时候如果为了项目的可管理性，我们也在 \x3ccode\x3estore\x3c\/code\x3e 中进行管理，随着项目的迭代我们不难遇到这样的情况：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22store\/\n    ...\n    modules\/\n        b.js\n        ...\nviews\/\n    ...\n    a\/\n        b.js\n        ...\n        \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3estore\/\n    ...\n    modules\/\n        \x3cspan class=\x22hljs-selector-tag\x22\x3eb\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n        ...\nviews\/\n    ...\n    a\/\n        \x3cspan class=\x22hljs-selector-tag\x22\x3eb\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n        ...\n        \x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\n\x3cli\x3e试想下有几十个 module，对应这边上百个业务模块，开发者在两个平级目录之间调试与开发的成本是巨大的。\x3c\/li\x3e\n\x3cli\x3e这些 module 可以在项目中任一一个地方被访问，但往往他们都是冗余的，除了引用的功能模块之外，基本不会再有其他模块引用他。\x3c\/li\x3e\n\x3cli\x3e项目的可维护程度会随着项目增大而增大。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch4\x3e如何解决第三类项目的 store 使用问题？\x3c\/h4\x3e\n\x3cp\x3e先梳理我们的目标：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e项目中模块可以自定决定是否使用 Vuex。（渐进增强）\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3e从有状态管理的模块，跳转没有的模块，我们不想把之前的状态挂载到 \x3ccode\x3estore\x3c\/code\x3e 上，想提高运行效率\x3c\/strong\x3e。（冗余）\x3c\/li\x3e\n\x3cli\x3e让这类项目的状态管理变的更加可维护。（开发成本\/沟通成本）\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch4\x3e实现\x3c\/h4\x3e\n\x3cp\x3e我们借助 Vuex 提供的 \x3ccode\x3eregisterModule\x3c\/code\x3e 和 \x3ccode\x3eunregisterModule\x3c\/code\x3e 一并解决这些问题，我们在 \x3ccode\x3eservice\/store\x3c\/code\x3e 中放入全局共享的状态：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22service\/\n    store\/\n        index.js\n        actions.js\n        mutations.js\n        getters.js\n        state.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3eservice\/\n    store\/\n        index\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n        actions\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n        mutations\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n        getters\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n        state.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e一般这类项目全局状态不多，如果多了拆分 module 即可。\x3c\/blockquote\x3e\n\x3cp\x3e编写插件生成 \x3ccode\x3estore 实例\x3c\/code\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import Vue from \x27vue\x27\nimport Vuex from \x27vuex\x27\nimport {VUEX_DEFAULT_CONFIG} from \x27Config\x27\nimport commonStore from \x27Service\/store\x27\n\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n    ...commonStore,\n    ...VUEX_DEFAULT_CONFIG\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Vue \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vue\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Vuex \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vuex\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {VUEX_DEFAULT_CONFIG} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Config\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e commonStore \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Service\/store\x27\x3c\/span\x3e\n\nVue.use(Vuex)\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Vuex.Store({\n    ...commonStore,\n    ...VUEX_DEFAULT_CONFIG\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e对一个需要状态管理页面或者模块进行分层：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22views\/\n    pageA\/\n        index.vue\n        components\/\n            a.vue\n            b.vue\n            ...\n        children\/\n            childrenA.vue\n            childrenB.vue\n            ...\n        store\/\n            index.js\n            actions.js\n            moduleA.js  \n            moduleB.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3eviews\/\n    pageA\/\n        index\x3cspan class=\x22hljs-selector-class\x22\x3e.vue\x3c\/span\x3e\n        components\/\n            \x3cspan class=\x22hljs-selector-tag\x22\x3ea\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.vue\x3c\/span\x3e\n            \x3cspan class=\x22hljs-selector-tag\x22\x3eb\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.vue\x3c\/span\x3e\n            ...\n        children\/\n            childrenA\x3cspan class=\x22hljs-selector-class\x22\x3e.vue\x3c\/span\x3e\n            childrenB\x3cspan class=\x22hljs-selector-class\x22\x3e.vue\x3c\/span\x3e\n            ...\n        store\/\n            index\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n            actions\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n            moduleA\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e  \n            moduleB.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3emodule 中直接包含了 \x3ccode\x3egetters\x3c\/code\x3e，\x3ccode\x3emutations\x3c\/code\x3e，\x3ccode\x3estate\x3c\/code\x3e，我们在 \x3ccode\x3estore\/index.js\x3c\/code\x3e 中做文章：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import Store from \x27Plugins\/store\x27\nimport actions from \x27.\/actions.js\x27\nimport moduleA from \x27.\/moduleA.js\x27\nimport moduleB from \x27.\/moduleB.js\x27\n\nexport default {\n    install() {\n        Store.registerModule([\x27pageA\x27], {\n            actions,\n            modules: {\n                moduleA,\n                moduleB\n            },\n            namespaced: true\n        })\n    },\n    uninstall() {\n        Store.unregisterModule([\x27pageA\x27])\n    }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Store \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Plugins\/store\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e actions \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/actions.js\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e moduleA \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/moduleA.js\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e moduleB \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/moduleB.js\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n    install() {\n        Store.registerModule([\x3cspan class=\x22hljs-string\x22\x3e\x27pageA\x27\x3c\/span\x3e], {\n            actions,\n            \x3cspan class=\x22hljs-attr\x22\x3emodules\x3c\/span\x3e: {\n                moduleA,\n                moduleB\n            },\n            \x3cspan class=\x22hljs-attr\x22\x3enamespaced\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n        })\n    },\n    uninstall() {\n        Store.unregisterModule([\x3cspan class=\x22hljs-string\x22\x3e\x27pageA\x27\x3c\/span\x3e])\n    }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最终在 \x3ccode\x3eindex.vue\x3c\/code\x3e 中引入使用， \x3cstrong\x3e在页面跳转之前注册这些状态和管理状态的规则，在路由离开之前，先卸载这些状态和管理状态的规则\x3c\/strong\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import store from \x27.\/store\x27\nimport {mapGetters} from \x27vuex\x27\nexport default {\n    computed: {\n        ...mapGetters(\x27pageA\x27, [\x27aaa\x27, \x27bbb\x27, \x27ccc\x27])\n    },\n    beforeRouterEnter(to, from, next) {\n        store.install()\n        next()\n    },\n    beforeRouterLeave(to, from, next) {\n        store.uninstall()\n        next()\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e store \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/store\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {mapGetters} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vuex\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3ecomputed\x3c\/span\x3e: {\n        ...mapGetters(\x3cspan class=\x22hljs-string\x22\x3e\x27pageA\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27aaa\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27bbb\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27ccc\x27\x3c\/span\x3e])\n    },\n    beforeRouterEnter(to, \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e, next) {\n        store.install()\n        next()\n    },\n    beforeRouterLeave(to, \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e, next) {\n        store.uninstall()\n        next()\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当然如果你的状态要共享到全局，就不执行 \x3ccode\x3euninstall\x3c\/code\x3e。\x3c\/p\x3e\n\x3cblockquote\x3e这样就解决了开头的三个问题，不同开发者在开发页面的时候，可以根据页面特性，渐进增强的选择某种开发形式。\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e其他\x3c\/h2\x3e\n\x3cp\x3e这里简单列举下其他方面，需要自行根据项目深入和使用。\x3c\/p\x3e\n\x3ch4\x3e打包，构建\x3c\/h4\x3e\n\x3cp\x3e这里网上已经有很多优化方法：\x3ccode\x3edll\x3c\/code\x3e，\x3ccode\x3ehappypack\x3c\/code\x3e，\x3ccode\x3e多线程打包\x3c\/code\x3e等，但随着项目的代码量级，每次 dev 保存的时候编译的速度也是会愈来愈慢的，而一过慢的时候我们就不得不进行拆分，这是肯定的，而在拆分之前尽可能容纳更多的可维护的代码，有几个可以尝试和规避的点：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e优化项目流程：这个点看起来好像没什么用，但改变却是最直观的，页面\/业务上的化简为繁会直接体现到代码上，同时也会增大项目的可维护，可拓展性等。\x3c\/li\x3e\n\x3cli\x3e减少项目文件层级纵向深度。\x3c\/li\x3e\n\x3cli\x3e减少无用业务代码，避免使用无用或者过大依赖（类似 \x3ccode\x3emoment.js\x3c\/code\x3e 这样的库）等。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch4\x3e样式\x3c\/h4\x3e\n\x3cul\x3e\n\x3cli\x3e尽可能抽离各个模块，让整个样式底层更加灵活，同时也应该尽可能的减少冗余。\x3c\/li\x3e\n\x3cli\x3e如果使用的 \x3ccode\x3esass\x3c\/code\x3e 的话，善用 \x3ccode\x3e%placeholder\x3c\/code\x3e 减少无用代码打包进来。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cblockquote\x3e\n\x3ccode\x3eMPA 应用\x3c\/code\x3e中样式冗余过大，\x3ccode\x3e%placeholder\x3c\/code\x3e 也会给你带来帮助。\x3c\/blockquote\x3e\n\x3ch4\x3eMock\x3c\/h4\x3e\n\x3cp\x3e很多大公司都有自己的 \x3ccode\x3emock 平台\x3c\/code\x3e，当前后端定好接口格式，放入生成对应 \x3ccode\x3emock api\x3c\/code\x3e，如果没有 mock 平台，那就找相对好用的工具如 \x3ccode\x3ejson-server\x3c\/code\x3e 等。\x3c\/p\x3e\n\x3ch4\x3e代码规范\x3c\/h4\x3e\n\x3cp\x3e请强制使用 \x3ccode\x3eeslint\x3c\/code\x3e，挂在 git 的钩子上。定期 diff 代码，定期培训等。\x3c\/p\x3e\n\x3ch4\x3eTypeScript\x3c\/h4\x3e\n\x3cp\x3e非常建议用 TS 编写项目，可能写 .vue 有些别扭，这样前端的大部分错误在编译时解决，同时也能提高浏览器运行时效率，可能减少 \x3ccode\x3ere-optimize\x3c\/code\x3e 阶段时间等。\x3c\/p\x3e\n\x3ch4\x3e测试\x3c\/h4\x3e\n\x3cp\x3e这也是项目非常重要的一点，如果你的项目还未使用一些测试工具，请尽快接入，这里不过多赘述。\x3c\/p\x3e\n\x3ch4\x3e拆分系统\x3c\/h4\x3e\n\x3cp\x3e当项目到达到一定业务量级时，由于项目中的模块过多，新同学维护成本，开发成本都会直线上升，不得不拆分项目，后续会分享出来我们 \x3ccode\x3eToB\x3c\/code\x3e 项目在拆分系统中的简单实践。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e最后\x3c\/h3\x3e\n\x3cp\x3e时下有各种成熟的方案，这里只是一个简单的构建分享，里面依赖的版本都是我们稳定下来的版本，需要根据自己实际情况进行升级。\x3c\/p\x3e\n\x3cp\x3e项目底层构建往往会成为前端忽略的地方，我们既要从一个大局观来看待一个项目或者整条业务线，又要对每一行代码精益求精，对开发体验不断优化，慢慢累积后才能更好的应对未知的变化。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/PerseveranceZ\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e关于我，可以叫我 Zero，附上 Git 地址\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/www.zcool.com.cn\/article\/ZNDI0NTgw.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e文章标题图片地址\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e最后请允许我打一波小小的广告\x3c\/h2\x3e\n\x3ch4\x3eEROS\x3c\/h4\x3e\n\x3cp\x3e如果\x3cstrong\x3e前端同学想尝试使用 \x3ccode\x3eVue\x3c\/code\x3e 开发 \x3ccode\x3eApp\x3c\/code\x3e\x3c\/strong\x3e，或者熟悉  \x3ccode\x3eweex\x3c\/code\x3e 开发的同学，可以来尝试使用我们的开源解决方案 \x3cstrong\x3e\x3ccode\x3eeros\x3c\/code\x3e\x3c\/strong\x3e，虽然没做过什么广告，但不完全统计，\x3ccode\x3e50 个在线 APP 还是有的\x3c\/code\x3e，期待你的加入。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e[[文章] 浅谈混合应用演进](\x3ca href=\x22https:\/\/juejin.im\/post\/5b189fc9f265da6e326c5104)\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/juejin.im\/post\/5b189f...\x3c\/a\x3e\n\x3c\/li\x3e\n\x3cli\x3e[[文章] 深入了解 weex](\x3ca href=\x22https:\/\/juejin.im\/post\/5b18a03ce51d45069d2263e3)\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/juejin.im\/post\/5b18a0...\x3c\/a\x3e\n\x3c\/li\x3e\n\x3cli\x3e[[文章] weex-eros 入门指南](\x3ca href=\x22https:\/\/bmfe.github.io\/eros-docs\/#\/zh-cn\/tutorial_newcomer)\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/bmfe.github.io\/eros-d...\x3c\/a\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/bmfe\/eros\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e项目地址\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/bmfe.github.io\/eros-docs\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e文档地址\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e最后附上部分产品截图~\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000015472617?w=970\x26amp;h=3648\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000015472617?w=970\x26amp;h=3648\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e(逃~)\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000015472744">https://segmentfault.com/a/1190000015472744</a></p><h2 id="原文标题">原文标题</h2><p>浅谈使用 Vue 构建前端 10w+ 代码量的单页面应用开发底层</p><h2>本文链接：</h2><a href="https://alili.tech/archive/9a0ea8f2/" target="_blank">https://alili.tech/archive/9a0ea8f2/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>