<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="更多关于渐进式图片加载的实现"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>更多关于渐进式图片加载的实现 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/a84436ee/",
				"appid": "1613049289050283", 
				"title": "更多关于渐进式图片加载的实现 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-10-18T00:00:00"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/6d6bc9dc/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/f878f4ae/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fa84436ee%2f&text=%e6%9b%b4%e5%a4%9a%e5%85%b3%e4%ba%8e%e6%b8%90%e8%bf%9b%e5%bc%8f%e5%9b%be%e7%89%87%e5%8a%a0%e8%bd%bd%e7%9a%84%e5%ae%9e%e7%8e%b0"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fa84436ee%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fa84436ee%2f&text=%e6%9b%b4%e5%a4%9a%e5%85%b3%e4%ba%8e%e6%b8%90%e8%bf%9b%e5%bc%8f%e5%9b%be%e7%89%87%e5%8a%a0%e8%bd%bd%e7%9a%84%e5%ae%9e%e7%8e%b0"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fa84436ee%2f&title=%e6%9b%b4%e5%a4%9a%e5%85%b3%e4%ba%8e%e6%b8%90%e8%bf%9b%e5%bc%8f%e5%9b%be%e7%89%87%e5%8a%a0%e8%bd%bd%e7%9a%84%e5%ae%9e%e7%8e%b0"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fa84436ee%2f&is_video=false&description=%e6%9b%b4%e5%a4%9a%e5%85%b3%e4%ba%8e%e6%b8%90%e8%bf%9b%e5%bc%8f%e5%9b%be%e7%89%87%e5%8a%a0%e8%bd%bd%e7%9a%84%e5%ae%9e%e7%8e%b0"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e6%9b%b4%e5%a4%9a%e5%85%b3%e4%ba%8e%e6%b8%90%e8%bf%9b%e5%bc%8f%e5%9b%be%e7%89%87%e5%8a%a0%e8%bd%bd%e7%9a%84%e5%ae%9e%e7%8e%b0&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fa84436ee%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fa84436ee%2f&title=%e6%9b%b4%e5%a4%9a%e5%85%b3%e4%ba%8e%e6%b8%90%e8%bf%9b%e5%bc%8f%e5%9b%be%e7%89%87%e5%8a%a0%e8%bd%bd%e7%9a%84%e5%ae%9e%e7%8e%b0"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fa84436ee%2f&title=%e6%9b%b4%e5%a4%9a%e5%85%b3%e4%ba%8e%e6%b8%90%e8%bf%9b%e5%bc%8f%e5%9b%be%e7%89%87%e5%8a%a0%e8%bd%bd%e7%9a%84%e5%ae%9e%e7%8e%b0"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fa84436ee%2f&title=%e6%9b%b4%e5%a4%9a%e5%85%b3%e4%ba%8e%e6%b8%90%e8%bf%9b%e5%bc%8f%e5%9b%be%e7%89%87%e5%8a%a0%e8%bd%bd%e7%9a%84%e5%ae%9e%e7%8e%b0"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fa84436ee%2f&title=%e6%9b%b4%e5%a4%9a%e5%85%b3%e4%ba%8e%e6%b8%90%e8%bf%9b%e5%bc%8f%e5%9b%be%e7%89%87%e5%8a%a0%e8%bd%bd%e7%9a%84%e5%ae%9e%e7%8e%b0"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">更多关于渐进式图片加载的实现</h1><div class="meta"><div class="postdate"><time datetime="2018-10-18" itemprop="datePublished">2018-10-18</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3cp\x3e在\x3ca href=\x22https:\/\/medium.com\/@jmperezperez\/how-medium-does-progressive-image-loading-fd1e4dc1ee3d\x22\x3e以前的一篇文章\x3c\/a\x3e中，我仔细分析了Medium.com用来展示图片的技术，这种技术可以在展示图片的时候让图片从一张模糊的图片过渡到一张清晰的图片。从那以后，我找到了其他一些同样采用相似方式展示图片的网站。下面让我们来看一下Quora, Quartz 以及 Clicktorelease 是如何实现的。\x3c\/p\x3e\n\x3ch3\x3e快速导读\x3c\/h3\x3e\n\x3cp\x3e图片是网页中最大的静态资源，他们通常会占据三分之二的空间。图片优化和选择正确的图片格式是至关重要的。另外，有些网站会在图片没有加载的时候，使用小的缩略图当作占位符。这种技术通常也被称作“\x3ca href=\x22https:\/\/css-tricks.com\/the-blur-up-technique-for-loading-background-images\/\x22\x3e\x3cem\x3eblur-up\x3c\/em\x3e\x3c\/a\x3e“。这种技术主要是为了提升用户感知性能，如果搭配懒加载使用，还可以达到节省流量的效果。\x3c\/p\x3e\n\x3cp\x3e当然这项技术还是有其他可替代的技术的。其中一种是使用一张单独的JPEG图片，调整它的扫描脚本使得可以快速渲染出一个原始的像素化的版本，并且在后续扫描中逐步渲染出最终清晰的图片。我推荐你通读\x3ca href=\x22http:\/\/cloudinary.com\/blog\/progressive_jpegs_and_green_martians\x22\x3eProgressive JPEGs and green Martians\x3c\/a\x3e 去更了解这项技术。\x3c\/p\x3e\n\x3cp\x3e还有一点，如果你喜欢图片加载优化这方面的内容，可以关注\x3ca href=\x22http:\/\/cloudinary.com\/blog\x22\x3eCloudinary’s Blog\x3c\/a\x3e，里面有很多关于这方面话题的博文。\x3c\/p\x3e\n\x3ch3\x3eQuartz\x3c\/h3\x3e\n\x3cp\x3eTake a look at the following video, recorded when accessing \x3ca href=\x22https:\/\/qz.com\/894001\/theres-a-wrong-and-a-right-way-to-talk-to-your-dog-according-to-science\/\x22\x3ea page on QZ.com\x3c\/a\x3e with a throttled connection:\x3c\/p\x3e\n\x3cp\x3e看一下下面的这个视频，它记录着当使用慢速的网络访问QZ.com的网页时，Quartz\x27s 的方式按照下面的步骤实现：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3eRequest a small \x3ccode\x3e\x26lt;img \/\x26gt;\x3c\/code\x3e that will be blurred. In their case, they use 50px width images, with a 80% quality.\x3c\/li\x3e\n\x3cli\x3e请求一个小的用于被模糊的\x3ccode\x3e\x26lt;img \/\x26gt;\x3c\/code\x3e。在这种情况下，他们使用宽度为50px，质量为80%的图片。\x3c\/li\x3e\n\x3cli\x3e通过CSS filter应用模糊效果。\x3c\/li\x3e\n\x3cli\x3e请求一个大的图片。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e关于Quartz的一个有趣的地方在于，他们使用响应式图片的语法去标记指定大图片。最大的不同点在于他们使用\x3ccode\x3edata-srcset\x3c\/code\x3e属性，这样他们就可以控制何时发起请求并且防止浏览器在标记被解析之后去请求大尺寸的图片。\x3c\/p\x3e\n\x3cp\x3e我发现这种方式非常优雅，因为他们尝试遵循“标准”的方式去处理图片，就是通过增加额外的字段以实现懒加载和实现过度动画。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3efigure\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22progressive-image featured-image size-extra-large\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3epicture\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3estyle\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22padding-bottom: 56.1875%; background-image: url(https:\/\/qzprod.files.wordpress.com\/2017\/01\/fish.jpg?quality=80\x26amp;strip=all\x26amp;w=50);\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eimg\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/qzprod.files.wordpress.com\/2017\/01\/fish.jpg?quality=80\x26amp;strip=all\x26amp;w=50\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eimg\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ealt\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22INDIA-fishermen\x22\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3enoscript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eimg\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/qzprod.files.wordpress.com\/2017\/01\/fish.jpg?quality=80\x26amp;strip=all\x26amp;w=320\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ealt\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22INDIA-fishermen\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3enoscript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3epicture\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3efigcaption\x3c\/span\x3e\x26gt;\x3c\/span\x3e...\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3efigcaption\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3efigure\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch3\x3eQuora\x3c\/h3\x3e\n\x3cp\x3eQuora也是在他们的po文里面实现了图片blur-up技术。例子详见\x3ca href=\x22https:\/\/www.quora.com\/How-does-Quora-pre-load-images\x22\x3ehead to this page\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e这里我们可以看到当显示模糊占位图片的时候页面的样子。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t01d15cfe42bf2b63fb.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e让我们深入代码来看看到底时如何实现的。首先，让我们来看看HTML标记：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stylus\x22\x3e\x26lt;div\x26gt;\n\n\n    \x26lt;\x3cspan class=\x22hljs-selector-tag\x22\x3ecanvas\x3c\/span\x3e class=\x3cspan class=\x22hljs-string\x22\x3e\x22qtext_image_placeholder portrait qtext_image zoomable_in zoomable_in_feed\x22\x3c\/span\x3e\n        \x3cspan class=\x22hljs-attribute\x22\x3ewidth\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22499\x22\x3c\/span\x3e\n        \x3cspan class=\x22hljs-attribute\x22\x3eheight\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22874\x22\x3c\/span\x3e\n        data-src=\x3cspan class=\x22hljs-string\x22\x3e\x22data:image\/PNG;base64,UklGRmgAAABXRUJQVlA4IFwAAADwAQCdASoGAAoAAUAmJYgCdEf\/g…iD0z\/yA\/5ipcuk5xHSdrS38j8CkH7s\x2bvKeZu9EwRy0f\/KPIlo\/\x2bUifdfcpiRcJiRnXXAAAAA==\x22\x3c\/span\x3e\x26gt;\n    \x26lt;\/canvas\x26gt;\n\n\n\n\n    \x26lt;\x3cspan class=\x22hljs-selector-tag\x22\x3eimg\x3c\/span\x3e src \/\x26gt;\n\x26lt;\/div\x26gt;\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e为什么同时使用\x3ccode\x3edata-src\x3c\/code\x3e和\x3ccode\x3emaster-src\x3c\/code\x3e？\x3ccode\x3emaster_src\x3c\/code\x3e 图片是当点击图片获取更大尺寸时加载的那张图片。\x3c\/p\x3e\n\x3cp\x3eQuora没有使用模糊效果。他们使用\x3ccode\x3ecanvas.drawImage()\x3c\/code\x3e在canvas里渲染小的缩略图。你可以看到通过查看他们的代码发现这个方法，在捆绑在主要JS文件的\x3ccode\x3eshared\/lazy_load_images\x3c\/code\x3e模块中可以看到：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ draw the data-uri image on the canvas\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ea\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (e.getAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22data-src\x22\x3c\/span\x3e)) {\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e t = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Image;\n        t.src = e.getAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22data-src\x22\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = e.getAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22width\x22\x3c\/span\x3e)\n          , n = e.getAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22height\x22\x3c\/span\x3e)\n          , o = e.getContext(\x3cspan class=\x22hljs-string\x22\x3e\x222d\x22\x3c\/span\x3e);\n        t.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x22load\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            o.drawImage(t, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, i, n)\n        }, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e)\n    }\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ go through all canvas on the page with a data-src\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3er\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e e = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelectorAll(\x3cspan class=\x22hljs-string\x22\x3e\x22canvas[data-src]\x22\x3c\/span\x3e);\n    d.insertionQ(\x3cspan class=\x22hljs-string\x22\x3e\x22canvas[data-src]\x22\x3c\/span\x3e).every(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n        a(e)\n    }),\n    [].forEach.call(e, a)\n}\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e简单来说，Quora所使用的技术主要包括：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e在canvas中渲染一个内联的非常小的png。\x3c\/li\x3e\n\x3cli\x3e使用Webp（如果支持的话）或者其他格式请求大尺寸图片。\x3c\/li\x3e\n\x3cli\x3e将大尺寸图片设置为\x3ccode\x3e\x26lt;img \/\x26gt;\x3c\/code\x3e元素的资源，然后逐渐变化它的透明度并且隐藏canvas。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3\x3eClicktorelease\x3c\/h3\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.clicktorelease.com\/\x22\x3eClicktorelease.com\x3c\/a\x3e, \x3ca href=\x22https:\/\/twitter.com\/thespite\x22\x3e@thespite\x3c\/a\x3e，刚刚重新设计过，也为图片设置了懒加载。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t01289517093f2be7c5.gif\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e这里最重要的部分是缩略图并不是要加载的图片本身，而是缩略图\x3ca href=\x22https:\/\/twitter.com\/thespite\/status\/827110706642305024\x22\x3eDCT矩阵\x3c\/a\x3e的值，这使得负载非常非常小。\x3c\/p\x3e\n\x3cp\x3e加载图片的步骤具体如下：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e请求\x3ccode\x3ethumb-src\x3c\/code\x3e图片。这是一个16x4的PNG 缩略图，通常大小在300B左右。\x3c\/li\x3e\n\x3cli\x3e创建一个\x3ccode\x3e\x26lt;canvas \/\x26gt;\x3c\/code\x3e并且在上面绘制通过反向计算缩略图的\x3ca href=\x22https:\/\/en.wikipedia.org\/wiki\/Discrete_cosine_transform\x22\x3eDCT\x3c\/a\x3e得到的图片。\x3c\/li\x3e\n\x3cli\x3e使用\x3ccode\x3eoriginal-src\x3c\/code\x3e地址请求大尺寸的图片。如果浏览器支持webp格式，那么“.webp”就会被添加到src上，这样就会请求webp格式的图片。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e原始的标记大概是这样的:\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\n\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3enoscript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eimg\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/images\/graphical-web-2016.jpg\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3enoscript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e我认为这是一个非常好关于渐进增强的例子，提供了\x3ccode\x3e\x26lt;noscript\x26gt;\x3c\/code\x3e 作为替代，并且逐步叠加效果，从一个固定的背景图片，到一个模糊的图片，再到最后的支持webp的大尺寸的图片。\x3c\/p\x3e\n\x3ch3\x3e总结\x3c\/h3\x3e\n\x3cp\x3e看到实现渐进式图片加载的这些微小的变化非常有趣，其中有使用Javascript实现的，有基于响应式图片实现的，有使用CSS filters实现的，还有使用canvas实现的。\x3c\/p\x3e\n\x3cp\x3e如果你想要一个基础的例子，可以移步\x3ca href=\x22http:\/\/codepen.io\/jmperez\/pen\/yYjPER\x22\x3emy “Reproducing Medium loading image effect” pen\x3c\/a\x3e。如果你也看到其他的网站实现了同样的技术，请记得一定要告诉我。\x3c\/p\x3e\n\x3ch3\x3e相关内容\x3c\/h3\x3e\n\x3cp\x3e我在我的RenderConf 2017的演讲\x3ca href=\x22https:\/\/www.youtube.com\/watch?v=S70xyRYCNdY\x22\x3eProgressive Image Rendering\x3c\/a\x3e中涉及到这个话题，当然这中间还一并提到其他一些可以使得图片更高效加载的技术。\x3c\/p\x3e\n\x3cp\x3e我也写过关于使用SVG去创建占位符的方法，详见\x3ca href=\x22https:\/\/medium.com\/@jmperezperez\/using-svg-as-placeholders-more-image-loading-techniques-bed1b810ab2c\x22\x3eUsing SVG as placeholders — More Image Loading Techniques\x3c\/a\x3e。\x3c\/p\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>原文链接: <a href="https://www.zcfy.cc/article/more-examples-of-progressive-image-loading">https://www.zcfy.cc/article/more-examples-of-progressive-image-loading</a> 原文标题: 更多关于渐进式图片加载的实现 本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2>本文链接：</h2><a href="https://alili.tech/archive/a84436ee/" target="_blank">https://alili.tech/archive/a84436ee/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>