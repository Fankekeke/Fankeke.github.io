<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="使用offline-plugin搭配webpack轻松实现PWA"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>使用offline-plugin搭配webpack轻松实现PWA | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/am646c158s/",
				"appid": "1613049289050283", 
				"title": "使用offline-plugin搭配webpack轻松实现PWA | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-04T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/0bs2hpxc46pj/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/8jte0g0a1ta/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fam646c158s%2f&text=%e4%bd%bf%e7%94%a8offline-plugin%e6%90%ad%e9%85%8dwebpack%e8%bd%bb%e6%9d%be%e5%ae%9e%e7%8e%b0PWA"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fam646c158s%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fam646c158s%2f&text=%e4%bd%bf%e7%94%a8offline-plugin%e6%90%ad%e9%85%8dwebpack%e8%bd%bb%e6%9d%be%e5%ae%9e%e7%8e%b0PWA"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fam646c158s%2f&title=%e4%bd%bf%e7%94%a8offline-plugin%e6%90%ad%e9%85%8dwebpack%e8%bd%bb%e6%9d%be%e5%ae%9e%e7%8e%b0PWA"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fam646c158s%2f&is_video=false&description=%e4%bd%bf%e7%94%a8offline-plugin%e6%90%ad%e9%85%8dwebpack%e8%bd%bb%e6%9d%be%e5%ae%9e%e7%8e%b0PWA"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%bd%bf%e7%94%a8offline-plugin%e6%90%ad%e9%85%8dwebpack%e8%bd%bb%e6%9d%be%e5%ae%9e%e7%8e%b0PWA&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fam646c158s%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fam646c158s%2f&title=%e4%bd%bf%e7%94%a8offline-plugin%e6%90%ad%e9%85%8dwebpack%e8%bd%bb%e6%9d%be%e5%ae%9e%e7%8e%b0PWA"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fam646c158s%2f&title=%e4%bd%bf%e7%94%a8offline-plugin%e6%90%ad%e9%85%8dwebpack%e8%bd%bb%e6%9d%be%e5%ae%9e%e7%8e%b0PWA"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fam646c158s%2f&title=%e4%bd%bf%e7%94%a8offline-plugin%e6%90%ad%e9%85%8dwebpack%e8%bd%bb%e6%9d%be%e5%ae%9e%e7%8e%b0PWA"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fam646c158s%2f&title=%e4%bd%bf%e7%94%a8offline-plugin%e6%90%ad%e9%85%8dwebpack%e8%bd%bb%e6%9d%be%e5%ae%9e%e7%8e%b0PWA"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">使用offline-plugin搭配webpack轻松实现PWA</h1><div class="meta"><div class="postdate"><time datetime="2019-01-04" itemprop="datePublished">2019-01-04</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVSVG1?w=1178\x26amp;h=484\x22 src=\x22https:\/\/static.alili.tech\/img\/bVSVG1?w=1178\x26amp;h=484\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e谈起PWA，许多人可能还只停留在“了解”的层面，比较少在实践中真正地尝试过，更多的仅仅是对着网上的教程和例子大概玩过。然而，网络上的例子多是简单的demo，鲜有与真正的开发相结合，例如和webpack的工程化结合。这篇文章将会从一个webpack plugin出发，谈一谈如何使用这个名为\x3ccode\x3eoffline-plugin\x3c\/code\x3e的webpack插件轻松实现PWA。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e由于PWA相关的文章太多，所以本文不再对“什么是PWA”，“PWA的生命周期”等基础内容再次赘述。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e\x3ccode\x3eoffline-plugin\x3c\/code\x3e相关链接：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eoffline-plugin\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/offline-plugin.now.sh\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3edemo\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3e一、自动生成\x3ccode\x3eservice-worker.js\x3c\/code\x3e\n\x3c\/h1\x3e\n\x3cp\x3ePWA的核心可谓是\x3ccode\x3eservice-worker\x3c\/code\x3e（以后简称SW），任何一个PWA都有且只有一个\x3ccode\x3eservice-worker.js\x3c\/code\x3e文件，用于为SW添加资源列表，进行注册、激活等生命周期操作。但是在webpack构建的项目中，生成一个\x3ccode\x3eservice-worker.js\x3c\/code\x3e可能会面临两个较大的问题：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e1、webpack生成的资源多会生成一串hash，sw的资源列表里面需要同步更新这些带hash的资源；\x3c\/li\x3e\n\x3cli\x3e2、每次更新代码，都需要通过更新sw文件版本号来通知客户端对所缓存的资源进行更新。（其实只要这一次的sw代码和上一次的sw代码不一样即可触发更新，但使用明确的版本号会更加合适）。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e看到这你可能已经想到，万能的webpack社区是否已经提供了相应的plugin来帮我们自动处理这些事情呢？答案是肯定的。除了官方推荐的\x3ca href=\x22https:\/\/github.com\/goldhand\/sw-precache-webpack-plugin\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3esw-precache-webpack-plugin\x3c\/a\x3e之外，还有我们今天的主角\x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eoffline-plugin\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e相比与\x3ca href=\x22https:\/\/github.com\/goldhand\/sw-precache-webpack-plugin\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3esw-precache-webpack-plugin\x3c\/a\x3e，个人认为\x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eoffline-plugin\x3c\/a\x3e具有如下优点：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e1、更多的可选配置项，满足更加细致的配置要求；\x3c\/li\x3e\n\x3cli\x3e2、更为详细的文档和例子；\x3c\/li\x3e\n\x3cli\x3e3、更新频率相对更高，star数更多；\x3c\/li\x3e\n\x3cli\x3e4、自动处理生命周期，用户无需纠结生命周期的坑；\x3c\/li\x3e\n\x3cli\x3e*5、支持AppCache；\x3c\/li\x3e\n\x3cli\x3e6、自动生成\x3ccode\x3emanifest\x3c\/code\x3e文件。\x3c\/li\x3e\n\x3cli\x3e...\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3e二、基本使用\x3c\/h1\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e安装\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install offline-plugin [--save-dev]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs sql\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3einstall\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eoffline\x3c\/span\x3e-\x3cspan class=\x22hljs-keyword\x22\x3eplugin\x3c\/span\x3e [\x3cspan class=\x22hljs-comment\x22\x3e--save-dev]\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e初始化\x3c\/h3\x3e\n\x3cp\x3e第一步，进入\x3ccode\x3ewebpack.config\x3c\/code\x3e:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ webpack.config.js example\n\nvar OfflinePlugin = require(\x27offline-plugin\x27);\n\nmodule.exports = {\n  \/\/ ...\n\n  plugins: [\n    \/\/ ... other plugins\n    \/\/ it\x27s always better if OfflinePlugin is the last plugin added\n    new OfflinePlugin()\n  ]\n  \/\/ ...\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ webpack.config.js example\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e OfflinePlugin = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27offline-plugin\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n\n  plugins: [\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ... other plugins\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ it\x27s always better if OfflinePlugin is the last plugin added\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e OfflinePlugin()\n  ]\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e第二步，把\x3ccode\x3eruntime\x3c\/code\x3e添加到你的入口js文件当中：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22require(\x27offline-plugin\/runtime\x27).install();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27offline-plugin\/runtime\x27\x3c\/span\x3e)\x3cspan class=\x22hljs-selector-class\x22\x3e.install\x3c\/span\x3e();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eES6\/Babel\/TypeScript\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import * as OfflinePluginRuntime from \x27offline-plugin\/runtime\x27;\nOfflinePluginRuntime.install();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs clean\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e * \x3cspan class=\x22hljs-keyword\x22\x3eas\x3c\/span\x3e OfflinePluginRuntime \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27offline-plugin\/runtime\x27\x3c\/span\x3e;\nOfflinePluginRuntime.install();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e经过上面的步骤，\x3ccode\x3eoffline-plugin\x3c\/code\x3e已经集成到项目之中，通过webpack构建即可。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader4\x22\x3e三、配置\x3c\/h1\x3e\n\x3cp\x3e前面说过，\x3ccode\x3eoffline-plugin\x3c\/code\x3e支持细致的配置，以满足不同的需求。下面将介绍几个比较常用的配置项，方便大家进一步使用。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\/blob\/master\/docs\/caches.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCaches: \x27all\x27 | Object\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22告诉插件应该缓存什么东西，并以何种方式进行缓存\n`all`: 意味着所有webpack构建出来的资源，以及在`externals`选项中的资源都会被缓存。\n`Object`: 包含三个数组或正则的配置对象（`main`, `additional`, `optional`），它们都是可选的，且默认为空。\n默认：`all`。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs autohotkey\x22\x3e\x3ccode\x3e告诉插件应该缓存什么东西，并以何种方式进行缓存\n`all`: 意味着所有webpack构建出来的资源，以及在`externals`选项中的资源都会被缓存。\n`Object`: 包含三个数组或正则的配置对象（`main`, `additional`, `optional`），它们都是可选的，且默认为空。\n默认：`all`。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\/blob\/master\/docs\/options.md#externals-arraystring\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eexternals: Array\x26lt;string\x26gt;\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22允许开发者指定一些外部资源（比如CDN引用，或者不是通过webpack生成的资源）。配合`Caches`的`additional`项，能够实现缓存外部资源的功能。\n\n默认：`null`\n举例：`[\x27fonts\/roboto.woff\x27]`\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs clean\x22\x3e\x3ccode\x3e允许开发者指定一些外部资源（比如CDN引用，或者不是通过webpack生成的资源）。配合`Caches`的`additional`项，能够实现缓存外部资源的功能。\n\n默认：`null`\n举例：`[\x3cspan class=\x22hljs-string\x22\x3e\x27fonts\/roboto.woff\x27\x3c\/span\x3e]`\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\/blob\/master\/docs\/options.md#serviceworker-object--null--false\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eServiceWorker: Object | null | false\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22该对象包含多个配置项，这里仅列举最常用的。\n\n`events`：布尔值。允许runtime接受来自sw的消息，默认值为false。\n`navigateFallbackURL`：当一个URL请求从缓存或网络都无法被获取时，将会重定向到该选项所指向的URL。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs autohotkey\x22\x3e\x3ccode\x3e该对象包含多个配置项，这里仅列举最常用的。\n\n`events`：布尔值。允许runtime接受来自sw的消息，默认值为\x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e。\n`navigateFallbackURL`：当一个URL请求从缓存或网络都无法被获取时，将会重定向到该选项所指向的URL。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\/blob\/master\/docs\/options.md#appcache-object--null--false\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAppCache: Object | null | false\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22`offline-plugin`默认支持`AppCache`，但是`AppCache`草案已经被web标准所废弃，不建议使用。\n但是由于仍然有部分浏览器支持，所以插件默认提供这个功能。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs autohotkey\x22\x3e\x3ccode\x3e`offline-plugin`默认支持`AppCache`，但是`AppCache`草案已经被web标准所废弃，不建议使用。\n但是由于仍然有部分浏览器支持，所以插件默认提供这个功能。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch1 id=\x22articleHeader5\x22\x3e四、runtime\x3c\/h1\x3e\n\x3cp\x3e上一节介绍了\x3ccode\x3eoffline-plugin\x3c\/code\x3e在webpack当中的配置，这一节将介绍runtime的一些用法。\x3cbr\x3e若要使\x3ccode\x3eoffline-plugin\x3c\/code\x3e生效，用户必须在入口js文件中通过runtime进行初始化操作：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 通过AMD方式\nrequire(\x27offline-plugin\/runtime\x27).install();\n\n\/\/ 或者通过ES6\/Babel\/TypeScript方式\n\nimport * as OfflinePluginRuntime from \x27offline-plugin\/runtime\x27;\nOfflinePluginRuntime.install();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 通过AMD方式\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27offline-plugin\/runtime\x27\x3c\/span\x3e).install();\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 或者通过ES6\/Babel\/TypeScript方式\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e * \x3cspan class=\x22hljs-keyword\x22\x3eas\x3c\/span\x3e OfflinePluginRuntime \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27offline-plugin\/runtime\x27\x3c\/span\x3e;\nOfflinePluginRuntime.install();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3eOfflinePluginRuntime\x3c\/code\x3e对象提供了下列三个方法：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\/blob\/master\/docs\/runtime.md#installoptions-object\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3einstall(options: Object)\x3c\/a\x3e\x3cbr\x3e  开启ServiceWorker\/AppCache的安装流程。这个方法是安全的，并且必须在页面初始化的时候就被调用。另外请勿把它放在任何的条件语句之内。（这句话不全对，在后面的降级方案里面会详细介绍）\x3c\/li\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\/blob\/master\/docs\/runtime.md#applyupdate\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eapplyUpdate()\x3c\/a\x3e\x3cbr\x3e  接受当前所安装的sw的更新信息。\x3c\/li\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\/blob\/master\/docs\/runtime.md#update\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eupdate()\x3c\/a\x3e\x3cbr\x3e  检查新版本的ServiceWorker\/AppCache的更新信息。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3chr\x3e\n\x3cp\x3e\x3ccode\x3eruntime.install()\x3c\/code\x3e方法接受一个配置对象参数，用于处理sw各个生命周期里面的事件：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\/blob\/master\/docs\/runtime.md#oninstalled\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eonInstalled\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22当ServiceWorker\/AppCache被install时执行，可用于展示“APP已经支持离线访问”。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cmake\x22\x3e\x3ccode\x3e当ServiceWorker\/AppCache被\x3cspan class=\x22hljs-keyword\x22\x3einstall\x3c\/span\x3e时执行，可用于展示“APP已经支持离线访问”。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\/blob\/master\/docs\/runtime.md#onupdating\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eonUpdating\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22AppCache不支持该方法\n当更新信息被获取且浏览器正在进行资源更新时触发。在这个时刻，一些资源正在被下载。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs\x22\x3e\x3ccode\x3eAppCache不支持该方法\n当更新信息被获取且浏览器正在进行资源更新时触发。在这个时刻，一些资源正在被下载。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\/blob\/master\/docs\/runtime.md#onupdateready\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eonUpdateReady\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22当`onUpdating`事件完成时触发。这时，所有资源都已经下载完毕。\n通过调用`runtime.applyUpdate()`方法来触发更新。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs autohotkey\x22\x3e\x3ccode\x3e当`onUpdating`事件完成时触发。这时，所有资源都已经下载完毕。\n通过调用`runtime.applyUpdate()`方法来触发更新。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\/blob\/master\/docs\/runtime.md#onupdatefailed\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eonUpdateFailed\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22当`onUpdating`事件因为某些原因失败时触发。\n这时没有任何资源被下载，同时所有的资源更新进程都应该被取消或跳过。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs autohotkey\x22\x3e\x3ccode\x3e当`onUpdating`事件因为某些原因失败时触发。\n这时没有任何资源被下载，同时所有的资源更新进程都应该被取消或跳过。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\/blob\/master\/docs\/runtime.md#onupdated\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eonUpdated\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22当更新被接受时触发。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs\x22\x3e\x3ccode\x3e当更新被接受时触发。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch1 id=\x22articleHeader6\x22\x3e五、降级方案\x3c\/h1\x3e\n\x3cp\x3e当某些时候我们需要撤掉sw进行降级的时候，我们需要主动注销sw。然而\x3ccode\x3eoffline-plugin\x3c\/code\x3e默认没有提供注销sw的\x3ccode\x3eunregister()\x3c\/code\x3e方法，所以我们需要自己实现。\x3c\/p\x3e\n\x3cp\x3e其实要主动注销sw非常简单，我们可以直接调用\x3ccode\x3eServiceWorkerContainer.getRegistrations()\x3c\/code\x3e方法来拿到\x3ccode\x3eregistration\x3c\/code\x3e实例，然后调用\x3ccode\x3eregistration.unregister()\x3c\/code\x3e方法即可，具体代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (\x27serviceWorker\x27 in navigator) {\n  navigator.serviceWorker.getRegistration().then((registration) =\x3e {\n    registration \x26amp;\x26amp; registration.unregister().then((boolean) =\x3e {\n      boolean ? alert(\x27注销成功\x27) : alert(\x27注销失败\x27)\n    });\n  })\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x27serviceWorker\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e navigator) {\n  navigator.serviceWorker.getRegistration().\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(registration)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    registration \x26amp;\x26amp; registration.unregister().\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(boolean)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      boolean ? alert(\x3cspan class=\x22hljs-string\x22\x3e\x27注销成功\x27\x3c\/span\x3e) : alert(\x3cspan class=\x22hljs-string\x22\x3e\x27注销失败\x27\x3c\/span\x3e)\n    });\n  })\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在调用该方法后，sw已经被注销，刷新一下页面就能看到资源是重新从网络获取的了。\x3c\/p\x3e\n\x3cp\x3e在真实的生产环境中，我们可以通过调用接口，来决定是否使用降级方案：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22fetch(URL).then((switch) =\x3e {\n  if (switch) {\n    OfflinePluginRuntime.install()\n  } else {\n    if (\x27serviceWorker\x27 in navigator) {\n      navigator.serviceWorker.getRegistration().then((registration) =\x3e {\n        registration \x26amp;\x26amp; registration.unregister().then((boolean) =\x3e {\n          boolean ? alert(\x27注销成功\x27) : alert(\x27注销失败\x27)\n        })\n      })\n    }\n  }\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3efetch(URL).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e) {\n    OfflinePluginRuntime.install()\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x27serviceWorker\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e navigator) {\n      navigator.serviceWorker.getRegistration().\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(registration)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        registration \x26amp;\x26amp; registration.unregister().\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(boolean)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n          boolean ? alert(\x3cspan class=\x22hljs-string\x22\x3e\x27注销成功\x27\x3c\/span\x3e) : alert(\x3cspan class=\x22hljs-string\x22\x3e\x27注销失败\x27\x3c\/span\x3e)\n        })\n      })\n    }\n  }\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader7\x22\x3e六、遇到的坑\x3c\/h1\x3e\n\x3cp\x3e在具体实践中，遇到一个比较大的坑，就是\x3ccode\x3esw.js\x3c\/code\x3e文件的更新。\x3c\/p\x3e\n\x3cp\x3e在service worker的设计中，浏览器每一次加载站点的URL，都会重新请求一遍\x3ccode\x3esw.js\x3c\/code\x3e。若发现这一次的\x3ccode\x3esw.js\x3c\/code\x3e内容和上一次的不一样，就会判定为资源更新，重新触发sw的生命周期。然而，\x3ccode\x3esw.js\x3c\/code\x3e也是一个普通的js资源文件，会默认使用服务器设置的expired时间，也就是它的\x3ccode\x3emax-age\x3c\/code\x3e。在理解了service worker的设计后，我们不难发现，\x3ccode\x3esw.js\x3c\/code\x3e的\x3ccode\x3emax-age\x3c\/code\x3e应该尽可能短，以便浏览器能够及时更新资源列表。\x3c\/p\x3e\n\x3cp\x3e这也是我在研究阶段直接使用\x3ccode\x3ehttp-server\x3c\/code\x3e时所发现的问题。后来在官方的例子中，我发现\x3ccode\x3enpm script\x3c\/code\x3e里面是这么写的：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;start\x26quot;: \x26quot;http-server .\/dist -p 7474 -c no-cache\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs sql\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x22\x3cspan class=\x22hljs-keyword\x22\x3estart\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22: \x22\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ehttp\x3c\/span\x3e-\x3cspan class=\x22hljs-keyword\x22\x3eserver\x3c\/span\x3e .\/dist -p \x3cspan class=\x22hljs-number\x22\x3e7474\x3c\/span\x3e -c \x3cspan class=\x22hljs-keyword\x22\x3eno\x3c\/span\x3e-\x3cspan class=\x22hljs-keyword\x22\x3ecache\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e直接指定了所有资源都不使用缓存，这一点值得我们注意。\x3c\/p\x3e\n\x3cp\x3e另外，\x3ccode\x3ewebpack-dev-server\x3c\/code\x3e里无法正常使用\x3ccode\x3eoffline-plugin\x3c\/code\x3e，因为它需要具体的文件去生成\x3ccode\x3esw.js\x3c\/code\x3e，但是通过\x3ccode\x3ewebpack-dev-server\x3c\/code\x3e构建的项目，其文件是存放在内存中的，所以无法和\x3ccode\x3eoffline-plugin\x3c\/code\x3e正常搭配使用。建议仅在\x3cstrong\x3e生产模式\x3c\/strong\x3e内使用\x3ccode\x3eoffline-plugin\x3c\/code\x3e。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader8\x22\x3e七、添加到主屏\x3c\/h1\x3e\n\x3cp\x3e手机浏览器都提供了“添加到主屏”的功能，但普通的网站添加到主屏，仅仅是把网站的书签放到桌面。如果要想把网站以PWA的形式添加到主屏，我们需要一个\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/Manifest\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3emanifest.json文件\x3c\/a\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;name\x26quot;: \x26quot;offline-plugin\x26quot;,\n  \x26quot;icons\x26quot;: [\n    {\n      \x26quot;src\x26quot;: \x26quot;\/android-chrome-192x192.png\x26quot;,\n      \x26quot;sizes\x26quot;: \x26quot;192x192\x26quot;,\n      \x26quot;type\x26quot;: \x26quot;image\/png\x26quot;\n    },\n    {\n      \x26quot;src\x26quot;: \x26quot;\/android-chrome-512x512.png\x26quot;,\n      \x26quot;sizes\x26quot;: \x26quot;512x512\x26quot;,\n      \x26quot;type\x26quot;: \x26quot;image\/png\x26quot;\n    }\n  ],\n  \x26quot;theme_color\x26quot;: \x26quot;#181743\x26quot;,\n  \x26quot;background_color\x26quot;: \x26quot;#181743\x26quot;,\n  \x26quot;start_url\x26quot;: \x26quot;\/\x26quot;,\n  \x26quot;display\x26quot;: \x26quot;standalone\x26quot;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs json\x22\x3e\x3ccode\x3e{\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22name\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22offline-plugin\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22icons\x22\x3c\/span\x3e: [\n    {\n      \x3cspan class=\x22hljs-attr\x22\x3e\x22src\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\/android-chrome-192x192.png\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3e\x22sizes\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22192x192\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22image\/png\x22\x3c\/span\x3e\n    },\n    {\n      \x3cspan class=\x22hljs-attr\x22\x3e\x22src\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\/android-chrome-512x512.png\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3e\x22sizes\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22512x512\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22image\/png\x22\x3c\/span\x3e\n    }\n  ],\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22theme_color\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22#181743\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22background_color\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22#181743\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22start_url\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\/\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22display\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22standalone\x22\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后，把这个\x3ccode\x3emanifest.json\x3c\/code\x3e和其他\x3cstrong\x3e静态资源\x3c\/strong\x3e一并打包到网站根目录即可：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVSWEV?w=307\x26amp;h=394\x22 src=\x22https:\/\/static.alili.tech\/img\/bVSWEV?w=307\x26amp;h=394\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e示例地址：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVSWNw?w=185\x26amp;h=183\x22 src=\x22https:\/\/static.alili.tech\/img\/bVSWNw?w=185\x26amp;h=183\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e打开chrome开发者工具，进入到\x3ccode\x3eApplication\x3c\/code\x3e一列，选择\x3ccode\x3eManifest\x3c\/code\x3e，就可以看到效果了：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVSWIf?w=1154\x26amp;h=870\x22 src=\x22https:\/\/static.alili.tech\/img\/bVSWIf?w=1154\x26amp;h=870\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cdel\x3e截止到\x3cstrong\x3e目前（2017年8月15日）\x3c\/strong\x3e，我所使用的\x3cstrong\x3eiOS10.3.2\x3c\/strong\x3e版本的iPhone7手机，已经支持PWA了，效果如下：\x3c\/del\x3e\x3cbr\x3e经过查阅大量的资料，到目前为止，iOS并不支持PWA，但是可以通过在html里面添加几个标签，实现web页面和原生APP相似的体验效果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22应用图标：\n\x3clink rel=\x26quot;apple-touch-icon\x26quot; href=“\/custom_icon.png\x26quot;\x3e\n\n启动画面：\n\x3clink rel=\x26quot;apple-touch-startup-image\x26quot; href=\x26quot;\/launch.png\x26quot;\x3e\n\n应用名称：\n\x3cmeta name=\x26quot;apple-mobile-web-app-title\x26quot; content=\x26quot;AppTitle\x26quot;\x3e\n\n全屏效果：\n\x3cmeta name=\x26quot;apple-mobile-web-app-capable\x26quot; content=\x26quot;yes\x26quot;\x3e\n\n设置状态栏颜色：\n\x3cmeta name=\x26quot;apple-mobile-web-app-status-bar-style\x26quot; content=\x26quot;black\x26quot;\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e应用图标：\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elink\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3erel\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22apple-touch-icon\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ehref\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e“\/custom_icon.png\x3c\/span\x3e\x22\x26gt;\x3c\/span\x3e\n\n启动画面：\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elink\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3erel\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22apple-touch-startup-image\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ehref\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/launch.png\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n应用名称：\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22apple-mobile-web-app-title\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3econtent\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22AppTitle\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n全屏效果：\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22apple-mobile-web-app-capable\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3econtent\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22yes\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n设置状态栏颜色：\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22apple-mobile-web-app-status-bar-style\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3econtent\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22black\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cem\x3e使用safari打开\x3c\/em\x3e\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVSWL8?w=308\x26amp;h=566\x22 src=\x22https:\/\/static.alili.tech\/img\/bVSWL8?w=308\x26amp;h=566\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cem\x3e添加到主屏后打开\x3c\/em\x3e\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVSWML?w=312\x26amp;h=570\x22 src=\x22https:\/\/static.alili.tech\/img\/bVSWML?w=312\x26amp;h=570\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cem\x3e离线后从主屏打开\x3c\/em\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVSWNc?w=308\x26amp;h=566\x22 src=\x22https:\/\/static.alili.tech\/img\/bVSWNc?w=308\x26amp;h=566\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cem\x3e打开任务管理器\x3c\/em\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVSWOf?w=304\x26amp;h=542\x22 src=\x22https:\/\/static.alili.tech\/img\/bVSWOf?w=304\x26amp;h=542\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e可以看到，PWA无论从表现还是功能，都像一个独立的APP那样存在。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader9\x22\x3e八、尾声\x3c\/h1\x3e\n\x3cp\x3e\x3cdel\x3e原来一直以为苹果对PWA支持不好，但通过这次实践，可以知道其实PWA也取得了极大的推进，开发者们可以开心地搭建自己的PWA啦！\x3c\/del\x3e\x3cbr\x3e结论不能下太早。。。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>使用offline-plugin搭配webpack轻松实现PWA</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010669126">https://segmentfault.com/a/1190000010669126</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/am646c158s/" target="_blank">https://alili.tech/archive/am646c158s/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>