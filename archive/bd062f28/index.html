<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="使用Vuex解决Vue中的身份验证"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>使用Vuex解决Vue中的身份验证 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/bd062f28/",
				"appid": "1613049289050283", 
				"title": "使用Vuex解决Vue中的身份验证 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-10-18T00:00:00"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/e14944ab/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/28b3438b/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fbd062f28%2f&text=%e4%bd%bf%e7%94%a8Vuex%e8%a7%a3%e5%86%b3Vue%e4%b8%ad%e7%9a%84%e8%ba%ab%e4%bb%bd%e9%aa%8c%e8%af%81"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fbd062f28%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fbd062f28%2f&text=%e4%bd%bf%e7%94%a8Vuex%e8%a7%a3%e5%86%b3Vue%e4%b8%ad%e7%9a%84%e8%ba%ab%e4%bb%bd%e9%aa%8c%e8%af%81"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fbd062f28%2f&title=%e4%bd%bf%e7%94%a8Vuex%e8%a7%a3%e5%86%b3Vue%e4%b8%ad%e7%9a%84%e8%ba%ab%e4%bb%bd%e9%aa%8c%e8%af%81"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fbd062f28%2f&is_video=false&description=%e4%bd%bf%e7%94%a8Vuex%e8%a7%a3%e5%86%b3Vue%e4%b8%ad%e7%9a%84%e8%ba%ab%e4%bb%bd%e9%aa%8c%e8%af%81"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%bd%bf%e7%94%a8Vuex%e8%a7%a3%e5%86%b3Vue%e4%b8%ad%e7%9a%84%e8%ba%ab%e4%bb%bd%e9%aa%8c%e8%af%81&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fbd062f28%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fbd062f28%2f&title=%e4%bd%bf%e7%94%a8Vuex%e8%a7%a3%e5%86%b3Vue%e4%b8%ad%e7%9a%84%e8%ba%ab%e4%bb%bd%e9%aa%8c%e8%af%81"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbd062f28%2f&title=%e4%bd%bf%e7%94%a8Vuex%e8%a7%a3%e5%86%b3Vue%e4%b8%ad%e7%9a%84%e8%ba%ab%e4%bb%bd%e9%aa%8c%e8%af%81"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbd062f28%2f&title=%e4%bd%bf%e7%94%a8Vuex%e8%a7%a3%e5%86%b3Vue%e4%b8%ad%e7%9a%84%e8%ba%ab%e4%bb%bd%e9%aa%8c%e8%af%81"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbd062f28%2f&title=%e4%bd%bf%e7%94%a8Vuex%e8%a7%a3%e5%86%b3Vue%e4%b8%ad%e7%9a%84%e8%ba%ab%e4%bb%bd%e9%aa%8c%e8%af%81"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">使用Vuex解决Vue中的身份验证</h1><div class="meta"><div class="postdate"><time datetime="2018-10-18" itemprop="datePublished">2018-10-18</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3cp\x3e传统方式中，许多人使用本地存储，来管理通过客户端验证生成的tokens。一个大问题是如何有更好的方式，来管理验证tokens，从而允许我们来存储更大的用户信息。\x3c\/p\x3e\n\x3cp\x3e这就是\x3ca href=\x22https:\/\/vuex.vuejs.org\x22\x3eVuex\x3c\/a\x3e的作用。 Vuex为\x3ca href=\x22https:\/\/vuejs.org\x22\x3eVue.js\x3c\/a\x3e应用管理状态.。对于应用中所有的组件来说，它被当做中央存储，并用规则确保状态只能以可预见的方式改变。\x3c\/p\x3e\n\x3cp\x3e对于经常检查本地存储来说，听起来是个更好的选择？让我们一起来探索下吧。\x3c\/p\x3e\n\x3ch2\x3e建立应用模块\x3c\/h2\x3e\n\x3cp\x3e对于这个项目，我们想创建一个使用vuex和\x3ca href=\x22https:\/\/router.vuejs.org\/\x22\x3evue-router\x3c\/a\x3e的vue应用。我们会使用vue cli 3.0 来创建一个vue项目，并从选项中选择路由和vuex。\x3c\/p\x3e\n\x3cp\x3e执行下面的命令开始创建:\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs shell\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e$\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e vue create vue-auth\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e按照对话框的提示，添加必要的信息，并选择我们需要的选项，完成安装。\x3c\/p\x3e\n\x3cp\x3e下一步, 安装\x3ca href=\x22https:\/\/github.com\/axios\/axios\x22\x3eaxios\x3c\/a\x3e:\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs shell\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e$\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e npm install axios --save\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch3\x3e配置Axios\x3c\/h3\x3e\n\x3cp\x3e我们在许多组件中都需要用到axios。让我们在全局整体来配置它，这样当我们需要它的时候，不用每次都去引入。\x3c\/p\x3e\n\x3cp\x3e打开 \x3ccode\x3e.\/src\/main.js\x3c\/code\x3e 文件，并且添加下面:\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs clean\x22\x3e[...]\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e store \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/store\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Axios \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27axios\x27\x3c\/span\x3e\n\nVue.prototype.$http = Axios;\nconst token = localStorage.getItem(\x3cspan class=\x22hljs-string\x22\x3e\x27token\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (token) {\n  Vue.prototype.$http.defaults.headers.common[\x3cspan class=\x22hljs-string\x22\x3e\x27Authorization\x27\x3c\/span\x3e] = token\n}\n[...]\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e现在，当我们想在组件内使用axios时, 我们可以用\x3ccode\x3ethis.$http\x3c\/code\x3e ，这样相当于直接是axios。我们也可以在axios头部给自己的token, 设置\x3ccode\x3e身份验证\x3c\/code\x3e，这样如果token是必需的，我们的请求将处于控制中。在这种方式下，当我们想要发送请求时，任何时候都不用设置token。\x3c\/p\x3e\n\x3cp\x3e相关课程: \x3ca href=\x22https:\/\/bit.ly\/2gCILn1\x22\x3eVue创建一个网上商店\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e完成之后，让我们使用服务器来处理身份验证。\x3c\/p\x3e\n\x3ch2\x3e创建身份验证服务\x3c\/h2\x3e\n\x3cp\x3e我已经写过关于这个，在我解释如何用vue-router来解决身份验证时。仔细看看\x3ca href=\x22https:\/\/scotch.io\/tutorials\/vue-authentication-and-route-handling-using-vue-router#toc-setup-nodejs-server\x22\x3eSetup Node.js Server\x3c\/a\x3e 这个章节。\x3c\/p\x3e\n\x3ch2\x3e创建组件\x3c\/h2\x3e\n\x3ch3\x3e登录组件\x3c\/h3\x3e\n\x3cp\x3e创建\x3ccode\x3eLogin.vue\x3c\/code\x3e 在 \x3ccode\x3e.\/src\/components\x3c\/code\x3e 目录下。 之后, 给登录页面添加模板:\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n   \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eform\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22login\x22\x3c\/span\x3e @\x3cspan class=\x22hljs-attr\x22\x3esubmit.prevent\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22login\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n     \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh1\x3c\/span\x3e\x26gt;\x3c\/span\x3eSign in\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh1\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n     \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e\x26gt;\x3c\/span\x3eEmail\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n     \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3erequired\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ev-model\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22email\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22email\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eplaceholder\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22Name\x22\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n     \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e\x26gt;\x3c\/span\x3ePassword\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n     \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3erequired\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ev-model\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22password\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22password\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eplaceholder\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22Password\x22\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n     \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehr\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n     \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22submit\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3eLogin\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n   \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eform\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e当你做完之后, 添加data属性，将其绑定到HTML表单中：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e[...]\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n    data(){\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-attr\x22\x3eemail\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3epassword\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e\n      }\n    },\n  }\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e现在, 让我们给登录添加方法：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e[...]\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n    [...]\n    methods: {\n      \x3cspan class=\x22hljs-attr\x22\x3elogin\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e email = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.email \n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e password = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.password\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.dispatch(\x3cspan class=\x22hljs-string\x22\x3e\x27login\x27\x3c\/span\x3e, { email, password })\n       .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$router.push(\x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e))\n       .catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(err))\n      }\n    }\n  }\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e我们正在使用vuex的action — \x3ccode\x3elogin\x3c\/code\x3e 来解决身份验证。我们可以在将actions细化到回调里面，这样就可以在自己的组件里面做一些很酷的事情了。\x3c\/p\x3e\n\x3ch3\x3e注册组件\x3c\/h3\x3e\n\x3cp\x3e跟login组件类似，那我们给注册用户弄一个了。在组件目录里面创建\x3ccode\x3eRegister.vue\x3c\/code\x3e ，并将下面的添加进去：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh4\x3c\/span\x3e\x26gt;\x3c\/span\x3eRegister\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh4\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eform\x3c\/span\x3e @\x3cspan class=\x22hljs-attr\x22\x3esubmit.prevent\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22register\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3efor\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3eName\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n          \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ev-model\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3erequired\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eautofocus\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3efor\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22email\x22\x3c\/span\x3e \x26gt;\x3c\/span\x3eE-Mail Address\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n          \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22email\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22email\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ev-model\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22email\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3erequired\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3efor\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22password\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3ePassword\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n          \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22password\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22password\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ev-model\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22password\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3erequired\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3efor\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22password-confirm\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3eConfirm Password\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n          \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22password-confirm\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22password\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ev-model\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22password_confirmation\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3erequired\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n          \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22submit\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3eRegister\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eform\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e让我们定义一下这些将绑定到表单里面的data属性:\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e[...]\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n    data(){\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eemail\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3epassword\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3epassword_confirmation\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eis_admin\x3c\/span\x3e : \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n      }\n    },\n  }\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e现在，让我们添加方法进去：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e[...]\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n    [...]\n    methods: {\n      \x3cspan class=\x22hljs-attr\x22\x3eregister\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e data = {\n          \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.name,\n          \x3cspan class=\x22hljs-attr\x22\x3eemail\x3c\/span\x3e: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.email,\n          \x3cspan class=\x22hljs-attr\x22\x3epassword\x3c\/span\x3e: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.password,\n          \x3cspan class=\x22hljs-attr\x22\x3eis_admin\x3c\/span\x3e: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.is_admin\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.dispatch(\x3cspan class=\x22hljs-string\x22\x3e\x27register\x27\x3c\/span\x3e, data)\n       .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$router.push(\x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e))\n       .catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(err))\n      }\n    }\n  }\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch3\x3e安全组件\x3c\/h3\x3e\n\x3cp\x3e让我们创建一个普通的组件，它在用户通过验证后会显示。文件命名为\x3ccode\x3eSecure.vue\x3c\/code\x3e，并添加下面的进去：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh1\x3c\/span\x3e\x26gt;\x3c\/span\x3eThis page is protected by auth\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh1\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch3\x3e更新App组件\x3c\/h3\x3e\n\x3cp\x3e打开\x3ccode\x3e.\/src\/App.vue\x3c\/code\x3e 文件，并添加下面的进去:\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22app\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22nav\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3erouter-link\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eto\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3eHome\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3erouter-link\x3c\/span\x3e\x26gt;\x3c\/span\x3e |\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3erouter-link\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eto\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/about\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3eAbout\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3erouter-link\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ev-if\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22isLoggedIn\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e | \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ea\x3c\/span\x3e @\x3cspan class=\x22hljs-attr\x22\x3eclick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22logout\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3eLogout\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ea\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3erouter-view\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e如果用户登录进去后，你能看到关联的\x3ccode\x3eLogout\x3c\/code\x3e了 吗？很好。\x3c\/p\x3e\n\x3cp\x3e现在，让我们给logout添加逻辑。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3ecomputed\x3c\/span\x3e : {\n      \x3cspan class=\x22hljs-attr\x22\x3eisLoggedIn\x3c\/span\x3e : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.getters.isLoggedIn}\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3emethods\x3c\/span\x3e: {\n      \x3cspan class=\x22hljs-attr\x22\x3elogout\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.dispatch(\x3cspan class=\x22hljs-string\x22\x3e\x27logout\x27\x3c\/span\x3e)\n        .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n          \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$router.push(\x3cspan class=\x22hljs-string\x22\x3e\x27\/login\x27\x3c\/span\x3e)\n        })\n      }\n    },\n  }\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e当用户点击退出按钮时，我们其实在做两件事 — 计算用户验证的状态和分发vuex store里面的退出事件。在退出之后，我们利用 \x3ccode\x3ethis.$router.push(\x27\/login\x27)\x3c\/code\x3e，切换用户到 \x3ccode\x3elogin\x3c\/code\x3e页面。当然你可以改变任何你想让用户跳转的地方。\x3c\/p\x3e\n\x3cp\x3e就是这样了。让我们用vuex构建权限模块。\x3c\/p\x3e\n\x3ch2\x3eVuex权限模块\x3c\/h2\x3e\n\x3cp\x3e如果你读过以前的\x3ca href=\x22https:\/\/scotch.io\/tutorials\/vue-authentication-and-route-handling-using-vue-router#toc-setup-nodejs-server\x22\x3e\x3cstrong\x3eSetup Node.js Server\x3c\/strong\x3e\x3c\/a\x3e **部分, 你应该注意到我们需要在本地存储用户权限token，同时，当用户被授予权限后，我们随时需要重新得到token以及用户信息。\x3c\/p\x3e\n\x3cp\x3e首先, 让我们给vuex创建 \x3ccode\x3estore.js\x3c\/code\x3e文件:\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xquery\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Vue from \x3cspan class=\x22hljs-string\x22\x3e\x27vue\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Vuex from \x3cspan class=\x22hljs-string\x22\x3e\x27vuex\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e axios from \x3cspan class=\x22hljs-string\x22\x3e\x27axios\x27\x3c\/span\x3e\n\nVue.use(Vuex)\n\nexport \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e new Vuex.Store({\n  state: {\n    status: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e,\n    token: localStorage.getItem(\x3cspan class=\x22hljs-string\x22\x3e\x27token\x27\x3c\/span\x3e) || \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e,\n    user : {}\n  },\n  mutations: {\n\n  },\n  actions: {\n\n  },\n  getters : {\n\n  }\n})\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e如果你注意到，我们同时引入了vue,vuex和axios，之后让vue使用vuex，这是因为它是很重要的一步。\x3c\/p\x3e\n\x3cp\x3e我们已经定义了state的属性。现在vuex的state能够支持验证状态， \x3ccode\x3ejwt\x3c\/code\x3e token以及用户信息。\x3c\/p\x3e\n\x3ch3\x3e创建Vuex登录事件\x3c\/h3\x3e\n\x3cp\x3eVuex actions里面主要是提交更改到vuex的store里面。我们将创建一个\x3ccode\x3elogin\x3c\/code\x3e 的action，它将使用服务器对用户进行身份验证，并向vuex存储提交用户凭据。打开\x3ccode\x3e.\/src\/store.js\x3c\/code\x3e文件，并添加下面到actions对象中：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stylus\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3elogin\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e({commit}, user)\x3c\/span\x3e\x3c\/span\x3e{\n    return new Promise((resolve, reject) =\x26gt; {\n      commit(\x3cspan class=\x22hljs-string\x22\x3e\x27auth_request\x27\x3c\/span\x3e)\n      axios({url: \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/localhost:3000\/login\x27\x3c\/span\x3e, data: user, method: \x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e })\n      .then(resp =\x26gt; {\n        const token = resp\x3cspan class=\x22hljs-selector-class\x22\x3e.data\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.token\x3c\/span\x3e\n        const user = resp\x3cspan class=\x22hljs-selector-class\x22\x3e.data\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.user\x3c\/span\x3e\n        localStorage.setItem(\x3cspan class=\x22hljs-string\x22\x3e\x27token\x27\x3c\/span\x3e, token)\n        axios\x3cspan class=\x22hljs-selector-class\x22\x3e.defaults\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.headers\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.common\x3c\/span\x3e[\x3cspan class=\x22hljs-string\x22\x3e\x27Authorization\x27\x3c\/span\x3e] = token\n        commit(\x3cspan class=\x22hljs-string\x22\x3e\x27auth_success\x27\x3c\/span\x3e, token, user)\n        resolve(resp)\n      })\n      .catch(err =\x26gt; {\n        commit(\x3cspan class=\x22hljs-string\x22\x3e\x27auth_error\x27\x3c\/span\x3e)\n        localStorage.removeItem(\x3cspan class=\x22hljs-string\x22\x3e\x27token\x27\x3c\/span\x3e)\n        reject(err)\n      })\n    })\n},\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e登录action通过vuex \x3ccode\x3ecommit\x3c\/code\x3e验证，我们将用它进行触发更改。vuex store里面能记录这些更改的变化。\x3c\/p\x3e\n\x3cp\x3e我们正在调用服务器的登录路径并返回必要的数据。我们在本地存储token，之后通过\x3ccode\x3eauth_success\x3c\/code\x3e来更新存储用户信息和token。在这一点上，我们也在头部设置了\x3ccode\x3eaxios\x3c\/code\x3e 。\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3e我们可以在vuex store中存储token，但是如果用户离开我们的应用，所有在vuex里面的存储都将消失。为了确保用户在有效时间内不用再重复登录，我们只能将token进行本地存储。\x3c\/p\x3e\n\x3cp\x3e重要的是你知道这些是如何工作的，这样你就能决定你到底想要实现什么。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e我们返回一个promise，这样我们能在用户登录完成后，做出响应。\x3c\/p\x3e\n\x3ch3\x3e创建Vuex\x3ccode\x3e注册\x3c\/code\x3e事件\x3c\/h3\x3e\n\x3cp\x3e像 \x3ccode\x3elogin\x3c\/code\x3e 事件, the \x3ccode\x3eregister\x3c\/code\x3e 事件是同一种工作方式。在相同的文件中，添加下面的到actions对象里面:\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stylus\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3eregister\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e({commit}, user)\x3c\/span\x3e\x3c\/span\x3e{\n  return new Promise((resolve, reject) =\x26gt; {\n    commit(\x3cspan class=\x22hljs-string\x22\x3e\x27auth_request\x27\x3c\/span\x3e)\n    axios({url: \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/localhost:3000\/register\x27\x3c\/span\x3e, data: user, method: \x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e })\n    .then(resp =\x26gt; {\n      const token = resp\x3cspan class=\x22hljs-selector-class\x22\x3e.data\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.token\x3c\/span\x3e\n      const user = resp\x3cspan class=\x22hljs-selector-class\x22\x3e.data\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.user\x3c\/span\x3e\n      localStorage.setItem(\x3cspan class=\x22hljs-string\x22\x3e\x27token\x27\x3c\/span\x3e, token)\n      axios\x3cspan class=\x22hljs-selector-class\x22\x3e.defaults\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.headers\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.common\x3c\/span\x3e[\x3cspan class=\x22hljs-string\x22\x3e\x27Authorization\x27\x3c\/span\x3e] = token\n      commit(\x3cspan class=\x22hljs-string\x22\x3e\x27auth_success\x27\x3c\/span\x3e, token, user)\n      resolve(resp)\n    })\n    .catch(err =\x26gt; {\n      commit(\x3cspan class=\x22hljs-string\x22\x3e\x27auth_error\x27\x3c\/span\x3e, err)\n      localStorage.removeItem(\x3cspan class=\x22hljs-string\x22\x3e\x27token\x27\x3c\/span\x3e)\n      reject(err)\n    })\n  })\n},\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e它与\x3ccode\x3elogin\x3c\/code\x3e 事件工作方式很像,。称之为有共同的mutators的 \x3ccode\x3elogin\x3c\/code\x3e 和\x3ccode\x3eregister\x3c\/code\x3e ，具有相同的目标——让用户进入系统。\x3c\/p\x3e\n\x3ch3\x3e创建Vuex\x3ccode\x3e退出\x3c\/code\x3e事件\x3c\/h3\x3e\n\x3cp\x3e我们希望用户能够退出系统，同时，我们希望销毁上一次验证的会话数据。在同一个\x3ccode\x3eactions\x3c\/code\x3e对象中，添加下面：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stylus\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3elogout\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e({commit})\x3c\/span\x3e\x3c\/span\x3e{\n  return new Promise((resolve, reject) =\x26gt; {\n    commit(\x3cspan class=\x22hljs-string\x22\x3e\x27logout\x27\x3c\/span\x3e)\n    localStorage.removeItem(\x3cspan class=\x22hljs-string\x22\x3e\x27token\x27\x3c\/span\x3e)\n    delete axios\x3cspan class=\x22hljs-selector-class\x22\x3e.defaults\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.headers\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.common\x3c\/span\x3e[\x3cspan class=\x22hljs-string\x22\x3e\x27Authorization\x27\x3c\/span\x3e]\n    resolve()\n  })\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e现在，当用户点击退出时，我们将移除之前在 \x3ccode\x3eaxios\x3c\/code\x3e头部设置的\x3ccode\x3ejwt\x3c\/code\x3e token 。他们现在将无法执行需要token的事务。\x3c\/p\x3e\n\x3ch3\x3e创建Mutations\x3c\/h3\x3e\n\x3cp\x3e像我之前提到的，mutators是被用来改变vuex store的状态。让我们在应用中给用过的mutators定义。在mutators对象中，添加下面的：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs pf\x22\x3emutations: {\n  auth_request(\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e){\n    \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.status = \x27loading\x27\n  },\n  auth_success(\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e, token, \x3cspan class=\x22hljs-keyword\x22\x3euser\x3c\/span\x3e){\n    \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.status = \x27success\x27\n    \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.token = token\n    \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3euser\x3c\/span\x3e = \x3cspan class=\x22hljs-keyword\x22\x3euser\x3c\/span\x3e\n  },\n  auth_error(\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e){\n    \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.status = \x27error\x27\n  },\n  logout(\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e){\n    \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.status = \x27\x27\n    \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.token = \x27\x27\n  },\n},\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch3\x3e创建Getters\x3c\/h3\x3e\n\x3cp\x3e我们使用getter来获取vuex状态中的属性值。在这种情况下，getter的作用是将应用程序数据与应用程序逻辑分离，并确保我们不会泄露敏感信息。\x3c\/p\x3e\n\x3cp\x3e添加下面的到\x3ccode\x3egetters\x3c\/code\x3e 对象中:\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs pf\x22\x3egetters : {\n  isLoggedIn: \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e =\x26gt; !!\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.token,\n  authStatus: \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e =\x26gt; \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.status,\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e你会同意我的观点，这是一种更简洁的访问存储数据的方式☺️.\x3c\/p\x3e\n\x3ch2\x3e在Auth后面隐藏页面\x3c\/h2\x3e\n\x3cp\x3e这篇文章的整个目的是实现身份验证，让没有权限的用户看不到某些页面。为了实现这个，我们需要知道用户想要访问的页面，以及当用户被授权时，我们有一定的方法来检验它。我们同时需要一定的方式，如果某些页面，授权或者未授权的用户可以单独或者同时访问的。这些都是很重要的考虑条件，幸运地是，我们可以通过vue-router来说实现。\x3c\/p\x3e\n\x3ch3\x3e定义路由给授权和未授权的页面\x3c\/h3\x3e\n\x3cp\x3e打开 \x3ccode\x3e.\/src\/router.js\x3c\/code\x3e 文件，并引入我们需要的这些:\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs clean\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Vue \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vue\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Router \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vue-router\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e store \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/store.js\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Home \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/views\/Home.vue\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e About \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/views\/About.vue\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Login \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/components\/Login.vue\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Secure \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/components\/Secure.vue\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Register \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/components\/Register.vue\x27\x3c\/span\x3e\n\nVue.use(Router)\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e正如你看到的这样，我们已经引入vue,vue-router和我们创建的vuex。我们同时还引入了定义的所有组件，并设置vue中使用路由。\x3c\/p\x3e\n\x3cp\x3e让我们定义路由:\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xl\x22\x3e[...]\nlet router = new Router({\n  mode: \x3cspan class=\x22hljs-string\x22\x3e\x27history\x27\x3c\/span\x3e,\n  routes: [\n    {\n      \x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-keyword\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27home\x27\x3c\/span\x3e,\n      component: Home\n    },\n    {\n      \x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/login\x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-keyword\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27login\x27\x3c\/span\x3e,\n      component: Login\n    },\n    {\n      \x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/register\x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-keyword\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27register\x27\x3c\/span\x3e,\n      component: Register\n    },\n    {\n      \x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/secure\x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-keyword\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27secure\x27\x3c\/span\x3e,\n      component: Secure,\n      meta: { \n        requiresAuth: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n      }\n    },\n    {\n      \x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/about\x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-keyword\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27about\x27\x3c\/span\x3e,\n      component: About\n    }\n  ]\n})\n\nexport default router\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e我们路由的定义是很普遍的。对于需要权限验证的路由，我们需要增加额外的数据，确保当用户访问它时，我们可以识别它。这是添加到路由定义中的元属性的本质。如果你想问\x3cstrong\x3e_”我可以添加更过的数据给\x3c\/strong\x3e元数据\x3cstrong\x3e并使用它吗?”\x3c\/strong\x3e，我很坚定的告诉你，这是绝对的😁。\x3c\/p\x3e\n\x3ch3\x3e解决未授权访问示例\x3c\/h3\x3e\n\x3cp\x3e我们有自己的路由定义。现在，让我们检验未授权访问并采取行动。在 \x3ccode\x3erouter.js\x3c\/code\x3e文件中，添加下面的在 \x3ccode\x3eexport default router\x3c\/code\x3e之前：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs moonscript\x22\x3erouter.beforeEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(to, \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3enext\x3c\/span\x3e)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(to.matched.some(record =\x26gt; record.meta.requiresAuth)) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (store.getters.isLoggedIn) {\n      \x3cspan class=\x22hljs-built_in\x22\x3enext\x3c\/span\x3e()\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3enext\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27\/login\x27\x3c\/span\x3e) \n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3enext\x3c\/span\x3e() \n  }\n})\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e从这篇文章，通过使用vue router来进行身份验证，你可以回想一下我们这里有一个非常复杂的机制，它变得非常大，变得非常混乱。vuex已经帮我们简化了它，我们可以继续给路由添加任何条件。在我们的vuex存储中，我们可以定义操作来检查这些条件并获取返回它们的值。\x3c\/p\x3e\n\x3ch3\x3e解决Token过期示例\x3c\/h3\x3e\n\x3cp\x3e因为我们在本地存储token,它可以一直保留着。这意味着无论何时，我们打开自己的应用，它可以自动的验证用户，即使token已经过期失效。最多的情况是，我们的请求会因为无效token而持续失败。这对于用户是个不好的体验。\x3c\/p\x3e\n\x3cp\x3e现在, 打开\x3ccode\x3e.\/src\/App.vue\x3c\/code\x3e 文件并在script里面，添加下面的：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  [...]\n  created: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$http.interceptors.response.use(\x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (err.status === \x3cspan class=\x22hljs-number\x22\x3e401\x3c\/span\x3e \x26amp;\x26amp; err.config \x26amp;\x26amp; !err.config.__isRetryRequest) {\n          \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$store.dispatch(logout)\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e err;\n      });\n    });\n  }\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e我们截获axios请求，已确定是否获取到\x3ccode\x3e401未授权\x3c\/code\x3e响应。如果这么做，我们分发 \x3ccode\x3elogout\x3c\/code\x3e 事件，那么用户获得退出应用。这会让用户跳转到之前设计的 \x3ccode\x3elogin\x3c\/code\x3e页面，这样他们可以再次登录。\x3c\/p\x3e\n\x3cp\x3e我赞同这样会提升用户体验 ☺️.\x3c\/p\x3e\n\x3ch2\x3e结束\x3c\/h2\x3e\n\x3cp\x3e从以前的文章来看，您可以看到，基于vuex的引入，我们目前的应用程序发生了重大变化。现在，我们不依赖于一直检查token，不管到哪里都有混乱的条件。我们可以简单地使用vuex存储来管理权限，并且只需使用几行代码检查应用程序中的状态。\x3c\/p\x3e\n\x3cp\x3e我希望这可以帮助您建立更好的应用。\x3c\/p\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>原文链接: <a href="https://www.zcfy.cc/article/handling-authentication-in-vue-using-vuex">https://www.zcfy.cc/article/handling-authentication-in-vue-using-vuex</a> 原文标题: 使用Vuex解决Vue中的身份验证 本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2>本文链接：</h2><a href="https://alili.tech/archive/bd062f28/" target="_blank">https://alili.tech/archive/bd062f28/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>