<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="像程序员一样思考：如何只使用 JavaScript，HTML 和 CSS 开发贪食蛇游戏"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>像程序员一样思考：如何只使用 JavaScript，HTML 和 CSS 开发贪食蛇游戏 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/bdd791ff/",
				"appid": "1613049289050283", 
				"title": "像程序员一样思考：如何只使用 JavaScript，HTML 和 CSS 开发贪食蛇游戏 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-10-18T00:00:00"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/389eef2b/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/e14944ab/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fbdd791ff%2f&text=%e5%83%8f%e7%a8%8b%e5%ba%8f%e5%91%98%e4%b8%80%e6%a0%b7%e6%80%9d%e8%80%83%ef%bc%9a%e5%a6%82%e4%bd%95%e5%8f%aa%e4%bd%bf%e7%94%a8%20JavaScript%ef%bc%8cHTML%20%e5%92%8c%20CSS%20%e5%bc%80%e5%8f%91%e8%b4%aa%e9%a3%9f%e8%9b%87%e6%b8%b8%e6%88%8f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fbdd791ff%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fbdd791ff%2f&text=%e5%83%8f%e7%a8%8b%e5%ba%8f%e5%91%98%e4%b8%80%e6%a0%b7%e6%80%9d%e8%80%83%ef%bc%9a%e5%a6%82%e4%bd%95%e5%8f%aa%e4%bd%bf%e7%94%a8%20JavaScript%ef%bc%8cHTML%20%e5%92%8c%20CSS%20%e5%bc%80%e5%8f%91%e8%b4%aa%e9%a3%9f%e8%9b%87%e6%b8%b8%e6%88%8f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fbdd791ff%2f&title=%e5%83%8f%e7%a8%8b%e5%ba%8f%e5%91%98%e4%b8%80%e6%a0%b7%e6%80%9d%e8%80%83%ef%bc%9a%e5%a6%82%e4%bd%95%e5%8f%aa%e4%bd%bf%e7%94%a8%20JavaScript%ef%bc%8cHTML%20%e5%92%8c%20CSS%20%e5%bc%80%e5%8f%91%e8%b4%aa%e9%a3%9f%e8%9b%87%e6%b8%b8%e6%88%8f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fbdd791ff%2f&is_video=false&description=%e5%83%8f%e7%a8%8b%e5%ba%8f%e5%91%98%e4%b8%80%e6%a0%b7%e6%80%9d%e8%80%83%ef%bc%9a%e5%a6%82%e4%bd%95%e5%8f%aa%e4%bd%bf%e7%94%a8%20JavaScript%ef%bc%8cHTML%20%e5%92%8c%20CSS%20%e5%bc%80%e5%8f%91%e8%b4%aa%e9%a3%9f%e8%9b%87%e6%b8%b8%e6%88%8f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%83%8f%e7%a8%8b%e5%ba%8f%e5%91%98%e4%b8%80%e6%a0%b7%e6%80%9d%e8%80%83%ef%bc%9a%e5%a6%82%e4%bd%95%e5%8f%aa%e4%bd%bf%e7%94%a8%20JavaScript%ef%bc%8cHTML%20%e5%92%8c%20CSS%20%e5%bc%80%e5%8f%91%e8%b4%aa%e9%a3%9f%e8%9b%87%e6%b8%b8%e6%88%8f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fbdd791ff%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fbdd791ff%2f&title=%e5%83%8f%e7%a8%8b%e5%ba%8f%e5%91%98%e4%b8%80%e6%a0%b7%e6%80%9d%e8%80%83%ef%bc%9a%e5%a6%82%e4%bd%95%e5%8f%aa%e4%bd%bf%e7%94%a8%20JavaScript%ef%bc%8cHTML%20%e5%92%8c%20CSS%20%e5%bc%80%e5%8f%91%e8%b4%aa%e9%a3%9f%e8%9b%87%e6%b8%b8%e6%88%8f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbdd791ff%2f&title=%e5%83%8f%e7%a8%8b%e5%ba%8f%e5%91%98%e4%b8%80%e6%a0%b7%e6%80%9d%e8%80%83%ef%bc%9a%e5%a6%82%e4%bd%95%e5%8f%aa%e4%bd%bf%e7%94%a8%20JavaScript%ef%bc%8cHTML%20%e5%92%8c%20CSS%20%e5%bc%80%e5%8f%91%e8%b4%aa%e9%a3%9f%e8%9b%87%e6%b8%b8%e6%88%8f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbdd791ff%2f&title=%e5%83%8f%e7%a8%8b%e5%ba%8f%e5%91%98%e4%b8%80%e6%a0%b7%e6%80%9d%e8%80%83%ef%bc%9a%e5%a6%82%e4%bd%95%e5%8f%aa%e4%bd%bf%e7%94%a8%20JavaScript%ef%bc%8cHTML%20%e5%92%8c%20CSS%20%e5%bc%80%e5%8f%91%e8%b4%aa%e9%a3%9f%e8%9b%87%e6%b8%b8%e6%88%8f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbdd791ff%2f&title=%e5%83%8f%e7%a8%8b%e5%ba%8f%e5%91%98%e4%b8%80%e6%a0%b7%e6%80%9d%e8%80%83%ef%bc%9a%e5%a6%82%e4%bd%95%e5%8f%aa%e4%bd%bf%e7%94%a8%20JavaScript%ef%bc%8cHTML%20%e5%92%8c%20CSS%20%e5%bc%80%e5%8f%91%e8%b4%aa%e9%a3%9f%e8%9b%87%e6%b8%b8%e6%88%8f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">像程序员一样思考：如何只使用 JavaScript，HTML 和 CSS 开发贪食蛇游戏</h1><div class="meta"><div class="postdate"><time datetime="2018-10-18" itemprop="datePublished">2018-10-18</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3cp\x3e大家好👋\x3c\/p\x3e\n\x3cp\x3e欢迎上车。今天我们将开始一场激动人心的冒险，在这里我们将开发属于我们自己的贪食蛇游戏🐍。通过将其分解为一个个简短的步骤来学习如何解决问题。在这段旅程结束时，你会学到一些新东西，并且有信心能独立探索更多。\x3c\/p\x3e\n\x3cp\x3e如果你是编程新手，\x3ca href=\x22https:\/\/www.freecodecamp.org\/\x22\x3efreeCodeCamp\x3c\/a\x3e 了解一下。这是一个很棒的学习网站…没错…完全免费。我就是从那儿入门的。\x3c\/p\x3e\n\x3cp\x3e好了，好了，言归正传 —— 要发车了，准备好了嘛？\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3e你可以在\x3ca href=\x22https:\/\/github.com\/supergoat\/snake\x22\x3e这里\x3c\/a\x3e找到完整代码，并且可以在\x3ca href=\x22https:\/\/snake-cdxejlircg.now.sh\x22\x3e这里\x3c\/a\x3e在线预览。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3ch3\x3e开始吧\x3c\/h3\x3e\n\x3cp\x3e首先新建一个文件“snake.html”，它将包含全部代码。\x3c\/p\x3e\n\x3cp\x3e因为这是一个 HTML 文件，所以要做的第一件事就是申明 \x3ccode\x3e\x26lt;!DOCTYPE\x26gt;\x3c\/code\x3e。请在 snake.html 文件中输入以下内容：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n   \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3eSnake Game\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    Welcome to Snake!\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e不错，接下来在你最喜欢的浏览器中打开 snake.html。你应该能够看到 \x3cstrong\x3eWelcome to Snake!\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t01fd229818a191527a.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e很好的开始！ 👊\x3c\/p\x3e\n\x3ch3\x3e创建画布\x3c\/h3\x3e\n\x3cp\x3e为了完成游戏，我们需要用到 \x3ccode\x3e\x26lt;canvas\x26gt;\x3c\/code\x3e 标签，并借助 JavaScript 绘制图像。\x3c\/p\x3e\n\x3cp\x3e用以下代码来替换 snake.html 里的欢迎语。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs routeros\x22\x3e\x26lt;canvas \x3cspan class=\x22hljs-attribute\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22gameCanvas\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attribute\x22\x3ewidth\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attribute\x22\x3eheight\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e\x26gt;\x26lt;canvas\x26gt;\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3eid 用于标识画布且始终应该被指定。稍后我们会用它来访问画布。width 和 height 分别是画布的宽和高，同样也需要被指定。在本例中，画布尺寸为 300 px * 300 px。\x3c\/p\x3e\n\x3cp\x3esnake.html 文件此时应该是这样的：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n   \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3eSnake Game\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ecanvas\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22gameCanvas\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ewidth\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eheight\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ecanvas\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e如果你刷新页面，你会发现页面一片空白。这是因为默认情况下，画布是空的并且没有背景。让我们来调整下。🔧\x3c\/p\x3e\n\x3ch4\x3e为画布添加背景色和边框\x3c\/h4\x3e\n\x3cp\x3e为了看到画布，我们可以写一段 JavaScript 代码给它加一个边框。为此，我们需要在 \x3ccode\x3e\x26lt;\/canvas\x26gt;\x3c\/code\x3e 后添加  \x3ccode\x3e\x26lt;script\x26gt;\x26lt;\/script\x26gt;\x3c\/code\x3e 标签，并在其中编写 JavaScript 代码。\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3e如果你把 \x3ccode\x3e\x26lt;script\x26gt;\x3c\/code\x3e 标签放在了 \x3ccode\x3e\x26lt;canvas\x26gt;\x3c\/code\x3e 标签前面，那么你的 JavaScript 代码将不会生效，因为此时 HTML 还未加载完。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e现在我们来写一些 JavaScript 代码，写在闭合的 \x3ccode\x3e\x26lt;script\x26gt;\x26lt;\/script\x26gt;\x3c\/code\x3e 标签之间。代码如下：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n   \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3eSnake Game\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ecanvas\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22gameCanvas\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ewidth\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eheight\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ecanvas\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/** 常量 **\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e CANVAS_BORDER_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27black\x27\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e CANVAS_BACKGROUND_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x22white\x22\x3c\/span\x3e;\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取 canvas 元素\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e gameCanvas = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x22gameCanvas\x22\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 返回一个二维绘图上下文\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ctx = gameCanvas.getContext(\x3cspan class=\x22hljs-string\x22\x3e\x222d\x22\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 选择画布的背景颜色\x3c\/span\x3e\n      ctx.fillStyle = CANVAS_BACKGROUND_COLOUR;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 选择画布的边框颜色\x3c\/span\x3e\n      ctx.strokestyle = CANVAS_BORDER_COLOUR;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制一个“实心的”长方形来覆盖整个画布\x3c\/span\x3e\n      ctx.fillRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.width, gameCanvas.height);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制画布的“边框”\x3c\/span\x3e\n      ctx.strokeRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.width, gameCanvas.height);\n    \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e首先，使用前面指定的 id（gameCanvas）获取 canvas 元素。然后获取画布的“2d”上下文，这意味着我们将在 2D 空间绘制图像。\x3c\/p\x3e\n\x3cp\x3e最后，我们画了一个 300 x 300 的白色矩形，边框为黑色。这个矩形从左上角（0，0）开始覆盖了整个画布。\x3c\/p\x3e\n\x3cp\x3e如果你在浏览器中重新加载 snake.html，你会看到一个带黑色边框的白块！干得漂亮，现在我们已经有了一个画布，可以用来创建我们的贪食蛇游戏了！ 👏迎接下一个挑战吧！\x3c\/p\x3e\n\x3ch3\x3e用坐标来表示贪食蛇\x3c\/h3\x3e\n\x3cp\x3e为了让游戏能玩，我们需要知道蛇在画布中的位置。为此，我们用一系列坐标来表示蛇。因此，要在画布中间（150,150）画一条横向的蛇，我们可以这样写：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs groovy\x22\x3elet snake = [\n  {\x3cspan class=\x22hljs-string\x22\x3ex:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3ey:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n  {\x3cspan class=\x22hljs-string\x22\x3ex:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e140\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3ey:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n  {\x3cspan class=\x22hljs-string\x22\x3ex:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e130\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3ey:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n  {\x3cspan class=\x22hljs-string\x22\x3ex:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e120\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3ey:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n  {\x3cspan class=\x22hljs-string\x22\x3ex:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e110\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3ey:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n];\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e注意蛇所有部位的 y 坐标都是 150。每一部位的 x 坐标比（左边）前一个部位多 10 px。数组中的第一对坐标 {x: 150, y: 150} 表示蛇头，位于蛇的最右边。\x3c\/p\x3e\n\x3cp\x3e别急，在下一步我们画蛇的时候，会对此有更清晰的认识。\x3c\/p\x3e\n\x3ch3\x3e开始画蛇\x3c\/h3\x3e\n\x3cp\x3e为了画蛇，我们可以写一个函数为蛇身上的\x3cstrong\x3e每一个\x3c\/strong\x3e部位画一个矩形。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs actionscript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edrawSnakePart\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(snakePart)\x3c\/span\x3e \x3c\/span\x3e{\n  ctx.fillStyle = \x3cspan class=\x22hljs-string\x22\x3e\x27lightgreen\x27\x3c\/span\x3e;\n  ctx.strokestyle = \x3cspan class=\x22hljs-string\x22\x3e\x27darkgreen\x27\x3c\/span\x3e;\n  ctx.fillRect(snakePart.x, snakePart.y, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n  ctx.strokeRect(snakePart.x, snakePart.y, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n}\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e接下来，我们用另一个函数在画布上把蛇展示出来。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs php\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edrawSnake\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n  snake.\x3cspan class=\x22hljs-keyword\x22\x3eforEach\x3c\/span\x3e(drawSnakePart);\n}\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e此时 snake.html 文件应该是这样的。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n   \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3eSnake Game\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ecanvas\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22gameCanvas\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ewidth\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eheight\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ecanvas\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/** 常量 **\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e CANVAS_BORDER_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27black\x27\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e CANVAS_BACKGROUND_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x22white\x22\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e SNAKE_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27lightgreen\x27\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e SNAKE_BORDER_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27darkgreen\x27\x3c\/span\x3e;\n\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e snake = [\n        {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n        {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e140\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n        {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e130\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n        {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e120\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n        {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e110\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e}\n      ]\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取 canvas 元素\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e gameCanvas = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x22gameCanvas\x22\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 返回一个二维绘制上下文\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ctx = gameCanvas.getContext(\x3cspan class=\x22hljs-string\x22\x3e\x222d\x22\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/  选择画布的背景颜色\x3c\/span\x3e\n      ctx.fillStyle = CANVAS_BACKGROUND_COLOUR;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/  选择画布的边框颜色\x3c\/span\x3e\n      ctx.strokestyle = CANVAS_BORDER_COLOUR;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制一个“实心的”长方形来覆盖整个画布\x3c\/span\x3e\n      ctx.fillRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.width, gameCanvas.height);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制画布的“边框”\x3c\/span\x3e\n      ctx.strokeRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.width, gameCanvas.height);\n      drawSnake();\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/**\n       * 在画布上画蛇\n       *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edrawSnake\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 循环遍历蛇的每一部分，并将其绘制到画布上\x3c\/span\x3e\n        snake.forEach(drawSnakePart)\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/**\n       * 在画布上画蛇的一个部分\n       * @param { object } snakePart —— 需要绘制的部位的所在坐标\n       *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edrawSnakePart\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3esnakePart\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置蛇身体的背景颜色\x3c\/span\x3e\n        ctx.fillStyle = SNAKE_COLOUR;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置蛇身的边框色\x3c\/span\x3e\n        ctx.strokestyle = SNAKE_BORDER_COLOUR;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在蛇身坐标所在的位置，绘制“实心”的矩形以表示蛇    \x3c\/span\x3e\n        ctx.fillRect(snakePart.x, snakePart.y, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制蛇身的边框\x3c\/span\x3e\n        ctx.strokeRect(snakePart.x, snakePart.y, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n      }\n    \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e刷新页面，你会发现画布中间有一条绿色的蛇。666！ 😎\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t0114f43f310d04d6d3.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3ch3\x3e让贪食蛇横向移动\x3c\/h3\x3e\n\x3cp\x3e接下来我们想要让蛇能动起来。不过我们该怎么做呢？🤔\x3c\/p\x3e\n\x3cp\x3e嗯，为了让蛇能够一步一步（10 px）移动到最右边，我们可以把蛇的\x3cstrong\x3e每个\x3c\/strong\x3e部位的 x 坐标，每次增加 10 px（dx = \x2b10 px）。同理，为了让蛇移动到最左边，每次把蛇的\x3cstrong\x3e每个\x3c\/strong\x3e部位的 x 坐标减少 10 px（dx = -10）。\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3e\x3cstrong\x3edx\x3c\/strong\x3e 是蛇的横向移动速度。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e蛇向右移动了 10 px 后，坐标如下图所示：\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t010a96ab728cf221e6.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e用 advanceSnake 函数来更新蛇的状态。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs actionscript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadvanceSnake\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e head = {x: snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x \x2b dx, y: snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y};\n  snake.unshift(head);\n  snake.pop();\n}\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e首先，我们为蛇画了个新头。然后使用 \x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Array\/unshift\x22\x3eunshift\x3c\/a\x3e 方法将新头放在\x3cstrong\x3e蛇\x3c\/strong\x3e的第一个部位，然后使用 \x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Array\/pop\x22\x3epop\x3c\/a\x3e 方法移除\x3cstrong\x3e蛇\x3c\/strong\x3e的最后一部分。这样以后，如上图所示，所有蛇身上其他部位都移动到了对应位置。\x3c\/p\x3e\n\x3cp\x3eBoom 💥，你已经找到窍门了吧。\x3c\/p\x3e\n\x3ch3\x3e让贪食蛇纵向移动\x3c\/h3\x3e\n\x3cp\x3e为了让蛇能够上下移动，我们不能直接将蛇的所有 y 坐标调整 10 px。那会让整条蛇上下移动。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t01f60003f8d1d05646.gif\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e相反，我们可以调整蛇头的 y 坐标。减少 10 px 蛇会向下移动，增加 10 px 蛇会向上移动。这样就能让蛇正确地移动了。\x3c\/p\x3e\n\x3cp\x3e幸运的是，因为我们编写的 advanceSnake 函数很棒，所以这很容易做到。在 advanceSnake 函数中，更新 head 让 y 坐标随着 \x3cstrong\x3edy\x3c\/strong\x3e 变化。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs roboconf\x22\x3econst head = {\x3cspan class=\x22hljs-attribute\x22\x3ex\x3c\/span\x3e: snake[0]\x3cspan class=\x22hljs-variable\x22\x3e.x\x3c\/span\x3e \x2b dx, y: snake[0]\x3cspan class=\x22hljs-variable\x22\x3e.y\x3c\/span\x3e \x2b dy};\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e为了验证 advanceSnake 函数是否正确，我们可以临时性地在 drawSnake 函数前调用它。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs lsl\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 向右走一步\x3c\/span\x3e\nadvanceSnake()\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 水平速度改为 0\x3c\/span\x3e\ndx = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 垂直速度改为 10\x3c\/span\x3e\ndy = \x3cspan class=\x22hljs-number\x22\x3e-10\x3c\/span\x3e;\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 向上走一步\x3c\/span\x3e\nadvanceSnake();\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在画布上画蛇\x3c\/span\x3e\ndrawSnake();\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e现在 snake.html 代码如下：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n   \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3eSnake Game\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ecanvas\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22gameCanvas\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ewidth\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eheight\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ecanvas\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/** 常量 **\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e CANVAS_BORDER_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27black\x27\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e CANVAS_BACKGROUND_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x22white\x22\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e SNAKE_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27lightgreen\x27\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e SNAKE_BORDER_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27darkgreen\x27\x3c\/span\x3e;\n\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e snake = [\n        {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n        {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e140\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n        {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e130\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n        {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e120\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n        {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e110\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e}\n      ]\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 横向移动速度\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e dx = \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 纵向移动速度\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e dy = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取 canvas 元素\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e gameCanvas = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x22gameCanvas\x22\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 返回一个二维绘制上下文\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ctx = gameCanvas.getContext(\x3cspan class=\x22hljs-string\x22\x3e\x222d\x22\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/  选择画布的背景颜色\x3c\/span\x3e\n      ctx.fillStyle = CANVAS_BACKGROUND_COLOUR;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/  选择画布的边框颜色\x3c\/span\x3e\n      ctx.strokestyle = CANVAS_BORDER_COLOUR;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制一个“实心的”长方形来覆盖整个画布\x3c\/span\x3e\n      ctx.fillRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.width, gameCanvas.height);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制画布的“边框”\x3c\/span\x3e\n      ctx.strokeRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.width, gameCanvas.height);\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 向右走一步\x3c\/span\x3e\n      advanceSnake()\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 水平速度改为 0\x3c\/span\x3e\n      dx = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 垂直速度改为 10\x3c\/span\x3e\n      dy = \x3cspan class=\x22hljs-number\x22\x3e-10\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 向上走一步\x3c\/span\x3e\n      advanceSnake();\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在画布上画蛇\x3c\/span\x3e\n      drawSnake();\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/**\n        * 根据蛇的水平移动速度改变蛇的 x 坐标，\n        * 根据蛇的垂直移动速度改变蛇的 y 坐标\n        *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadvanceSnake\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e head = {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x \x2b dx, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y \x2b dy};\n        snake.unshift(head);\n        snake.pop();\n      }\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/**\n       * 在画布上画蛇\n       *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edrawSnake\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 循环遍历蛇的每一部分，并将其绘制到画布上\x3c\/span\x3e\n        snake.forEach(drawSnakePart)\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/**\n       * 在画布上画蛇的一个部分\n       * @param { object } snakePart —— 需要绘制的部位的所在坐标\n       *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edrawSnakePart\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3esnakePart\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置蛇身体的背景颜色\x3c\/span\x3e\n        ctx.fillStyle = SNAKE_COLOUR;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置蛇身的边框色\x3c\/span\x3e\n        ctx.strokestyle = SNAKE_BORDER_COLOUR;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在蛇身坐标所在的位置，绘制“实心”的矩形以表示蛇    \x3c\/span\x3e\n        ctx.fillRect(snakePart.x, snakePart.y, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制蛇身的边框\x3c\/span\x3e\n        ctx.strokeRect(snakePart.x, snakePart.y, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n      }\n    \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e刷新页面，蛇动了。恭喜！\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t01058946718ea792e4.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3ch3\x3e重构代码\x3c\/h3\x3e\n\x3cp\x3e在继续下一步之前，让我们重构一下现有代码，将绘制画布的代码封装在一个函数中。这有助于完成下一步。\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3e\x3cstrong\x3e代码重构\x3c\/strong\x3e是重构现有计算机\x3cstrong\x3e代码\x3c\/strong\x3e的过程，同时不改变其外部行为。” —— \x3ca href=\x22https:\/\/en.wikipedia.org\/wiki\/Code_refactoring\x22\x3e维基百科\x3c\/a\x3e\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs arduino\x22\x3efunction clearCanvas() {\n  ctx.fillStyle = \x3cspan class=\x22hljs-string\x22\x3e\x22white\x22\x3c\/span\x3e;\n  ctx.strokeStyle = \x3cspan class=\x22hljs-string\x22\x3e\x22black\x22\x3c\/span\x3e;\n  ctx.fillRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.\x3cspan class=\x22hljs-built_in\x22\x3ewidth\x3c\/span\x3e, gameCanvas.\x3cspan class=\x22hljs-built_in\x22\x3eheight\x3c\/span\x3e);\n  ctx.strokeRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.\x3cspan class=\x22hljs-built_in\x22\x3ewidth\x3c\/span\x3e, gameCanvas.\x3cspan class=\x22hljs-built_in\x22\x3eheight\x3c\/span\x3e);\n}\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e我们正在大踏步前进！🐾\x3c\/p\x3e\n\x3ch3\x3e让贪食蛇自动移动\x3c\/h3\x3e\n\x3cp\x3e好的，既然我们已经成功地重构了代码，那么接下来让贪食蛇能够自动移动吧。\x3c\/p\x3e\n\x3cp\x3e之前为了测试 advanceSnake 函数是否正确，我们调用了它两次。一次为了让蛇向右移动，一次为了让它向上移动。\x3c\/p\x3e\n\x3cp\x3e因此如果想要让蛇右移五次，那么我们需要连续调用 advanceSnake() 函数五次。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs abnf\x22\x3eclearCanvas()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\nadvanceSnake()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\nadvanceSnake()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\nadvanceSnake()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\nadvanceSnake()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\nadvanceSnake()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\ndrawSnake()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e但是，如上所示连续五次调用 advanceSnake 函数会让蛇一下子向前跳 50 px。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t01e97ff3c91820df28.gif\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e相反，我们想让蛇看起来像是一步一步地前进。\x3c\/p\x3e\n\x3cp\x3e为此，我们用 \x3ca href=\x22https:\/\/www.w3schools.com\/Jsref\/met_win_settimeout.asp\x22\x3esetTimeout\x3c\/a\x3e 在每次调用之间添加一个短暂的延时。我们还需要确保每次调用 advanceSnake 函数时都调用 drawSnake 函数。如果我们不这样做，我们将无法看到蛇移动的中间步骤。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs mipsasm\x22\x3esetTimeout(function onTick() {\n  clearCanvas()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n  advanceSnake()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n  drawSnake()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n}, \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\nsetTimeout(function onTick() {\n  clearCanvas()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n  advanceSnake()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n  drawSnake()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n}, \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n...\ndrawSnake()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e注意我们同样在每个 setTimeout 中调用了 clearCanvas() 函数。这是为了移除蛇先前所有的位置，以免留下痕迹。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t0109fcd2ed761bc8b1.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e尽管如此，上述代码仍然有问题。没有任何代码告诉程序它必须等待一个 \x3cstrong\x3esetTimeout\x3c\/strong\x3e 完成后才能移动到下一个\x3cstrong\x3esetTimeout\x3c\/strong\x3e。也就是说蛇\x3cstrong\x3e仍然\x3c\/strong\x3e会在\x3cstrong\x3e一个短暂延迟\x3c\/strong\x3e后向前跳 50 px。\x3c\/p\x3e\n\x3cp\x3e要解决这个问题，我们必须将代码包装在函数中，每次只调用一个函数。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs actionscript\x22\x3estepOne();\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3estepOne\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n  setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonTick\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n    clearCanvas();\n    advanceSnake();\n    drawSnake();\n   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 调用第二个函数\x3c\/span\x3e\n   stepTwo();\n  }, \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e)\n}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3estepTwo\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n  setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonTick\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n    clearCanvas();\n    advanceSnake();\n    drawSnake();\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 调用第三个函数\x3c\/span\x3e\n    stepThree();\n  }, \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e)\n}\n...\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e如何让贪食蛇一直前进？我们可以改为创建一个 main 函数并递归调用它，而不是创建无数个相互调用的函数。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs actionscript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n  setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonTick\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n    clearCanvas();\n    advanceSnake();\n    drawSnake();\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 再次调用 main 函数\x3c\/span\x3e\n    main();\n  }, \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e)\n}\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e看啊！贪食蛇现在会一直向右移动。虽然一旦它到达画布的尽头，将继续其无尽的旅程并进入未知的地方😅。我们将在适当的时候解决这个问题，耐心点年轻的朋友们。🙏。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t0105917546eadd03c1.gif\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3ch3\x3e调整蛇的移动方向\x3c\/h3\x3e\n\x3cp\x3e我们的下一个任务是在按下任意方向键时更改蛇的移动方向。在 drawSnakePart 函数之后添加以下代码。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs nix\x22\x3efunction changeDirection(event) {\n  const \x3cspan class=\x22hljs-attr\x22\x3eLEFT_KEY\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e37\x3c\/span\x3e;\n  const \x3cspan class=\x22hljs-attr\x22\x3eRIGHT_KEY\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e39\x3c\/span\x3e;\n  const \x3cspan class=\x22hljs-attr\x22\x3eUP_KEY\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e38\x3c\/span\x3e;\n  const \x3cspan class=\x22hljs-attr\x22\x3eDOWN_KEY\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e40\x3c\/span\x3e;\n  const \x3cspan class=\x22hljs-attr\x22\x3ekeyPressed\x3c\/span\x3e = event.keyCode;\n  const \x3cspan class=\x22hljs-attr\x22\x3egoingUp\x3c\/span\x3e = \x3cspan class=\x22hljs-attr\x22\x3edy\x3c\/span\x3e === -\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n  const \x3cspan class=\x22hljs-attr\x22\x3egoingDown\x3c\/span\x3e = \x3cspan class=\x22hljs-attr\x22\x3edy\x3c\/span\x3e === \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n  const \x3cspan class=\x22hljs-attr\x22\x3egoingRight\x3c\/span\x3e = \x3cspan class=\x22hljs-attr\x22\x3edx\x3c\/span\x3e === \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n  const \x3cspan class=\x22hljs-attr\x22\x3egoingLeft\x3c\/span\x3e = \x3cspan class=\x22hljs-attr\x22\x3edx\x3c\/span\x3e === -\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-attr\x22\x3ekeyPressed\x3c\/span\x3e === LEFT_KEY \x26amp;\x26amp; !goingRight) {\n    \x3cspan class=\x22hljs-attr\x22\x3edx\x3c\/span\x3e = -\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attr\x22\x3edy\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-attr\x22\x3ekeyPressed\x3c\/span\x3e === UP_KEY \x26amp;\x26amp; !goingDown) {\n    \x3cspan class=\x22hljs-attr\x22\x3edx\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attr\x22\x3edy\x3c\/span\x3e = -\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-attr\x22\x3ekeyPressed\x3c\/span\x3e === RIGHT_KEY \x26amp;\x26amp; !goingLeft) {\n    \x3cspan class=\x22hljs-attr\x22\x3edx\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attr\x22\x3edy\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-attr\x22\x3ekeyPressed\x3c\/span\x3e === DOWN_KEY \x26amp;\x26amp; !goingDown) {\n    \x3cspan class=\x22hljs-attr\x22\x3edx\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attr\x22\x3edy\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e这没有什么特别的。我们检查按下的键是否与其中一个方向键匹配。如果匹配到，我们如上所述改变垂直和水平速度。\x3c\/p\x3e\n\x3cp\x3e请注意，我们还要检查蛇是否往新预期方向的相反方向上移动。这是为了防止我们的蛇掉头，例如当蛇向\x3cstrong\x3e左\x3c\/strong\x3e移动时按下\x3cstrong\x3e右\x3c\/strong\x3e键。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t0184be9b4be117a78f.gif\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e要将 changeDirection  加到游戏代码中，可以在 \x3ca href=\x22https:\/\/www.w3schools.com\/Jsref\/dom_obj_document.asp\x22\x3edocument\x3c\/a\x3e  上使用  \x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/EventTarget\/addEventListener\x22\x3eaddEventListener\x3c\/a\x3e  来“监听”是否有键被按下。然后我们随着 \x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/Events\/keydown\x22\x3ekeydown\x3c\/a\x3e  事件调用 changeDirection 方法。接着在 main 函数之后添加以下代码。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs coffeescript\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x22keydown\x22\x3c\/span\x3e, changeDirection)\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e你现在应该可以使用四个方向键更改蛇的方向。干得漂亮，你火了🔥！\x3c\/p\x3e\n\x3cp\x3e接下来让我们看看如何生成食物并让我们的蛇长大。\x3c\/p\x3e\n\x3ch3\x3e为蛇生成食物\x3c\/h3\x3e\n\x3cp\x3e为了生成蛇食，我们必须生成一组随机坐标。我们可以使用辅助函数 randomTen 来生成两个数字。一个用于 x 坐标，一个用于 y 坐标。\x3c\/p\x3e\n\x3cp\x3e我们还必须确保食物不与蛇的位置重叠。如果重叠了，我们必须生成一个新的食物位置。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs lua\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erandomTen\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(min, max)\x3c\/span\x3e\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e Math.round((Math.\x3cspan class=\x22hljs-built_in\x22\x3erandom\x3c\/span\x3e() * (\x3cspan class=\x22hljs-built_in\x22\x3emax\x3c\/span\x3e-\x3cspan class=\x22hljs-built_in\x22\x3emin\x3c\/span\x3e) \x2b \x3cspan class=\x22hljs-built_in\x22\x3emin\x3c\/span\x3e) \/ \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e) * \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecreateFood\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e {\n  foodX = randomTen(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.width - \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n  foodY = randomTen(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.height - \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n  snake.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eisFoodOnSnake\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(part)\x3c\/span\x3e\x3c\/span\x3e {\n    const foodIsOnSnake = part.x == foodX \x26amp;\x26amp; part.y == foodY\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (foodIsOnSnake)\n      createFood();\n  });\n}\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e然后我们需要写一个在画布上绘制食物的函数。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs actionscript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edrawFood\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n ctx.fillStyle = \x3cspan class=\x22hljs-string\x22\x3e\x27red\x27\x3c\/span\x3e;\n ctx.strokestyle = \x3cspan class=\x22hljs-string\x22\x3e\x27darkred\x27\x3c\/span\x3e;\n ctx.fillRect(foodX, foodY, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n ctx.strokeRect(foodX, foodY, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n}\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e最后我们可以在调用 main 之前调用 createFood。别忘了还要更新 main 函数以调用 drawFood 函数。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs actionscript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n  setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonTick\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n    clearCanvas();\n    drawFood()\n    advanceSnake();\n    drawSnake();\n    main();\n  }, \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e)\n}\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch3\x3e让蛇长大\x3c\/h3\x3e\n\x3cp\x3e让蛇长大很简单。更新 advanceSnake 函数，检查蛇头是否碰到了食物。如果碰到了，我们可以跳过移除蛇的最后部分这一操作，同时创建一个新的食物位置。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs actionscript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadvanceSnake\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e head = {x: snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x \x2b dx, y: snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y};\n  snake.unshift(head);\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e didEatFood = snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x === foodX \x26amp;\x26amp; snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y === foodY;\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (didEatFood) {\n    createFood();\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    snake.pop();\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch4\x3e记录游戏分数\x3c\/h4\x3e\n\x3cp\x3e为了让游戏更有乐趣，我们还可以添加一个分数，当蛇吃食物时分数增加。\x3c\/p\x3e\n\x3cp\x3e在声明了 snake 后，创建一个新的变量 score，并将其设为 0。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs ebnf\x22\x3e\x3cspan class=\x22hljs-attribute\x22\x3elet score\x3c\/span\x3e = 0;\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e接下来在画布前添加一个 id 为“score”的新 div，用于显示分数。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs routeros\x22\x3e\x26lt;div \x3cspan class=\x22hljs-attribute\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22score\x22\x3c\/span\x3e\x26gt;0\x26lt;\/div\x26gt;\n\x26lt;canvas \x3cspan class=\x22hljs-attribute\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22gameCanvas\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attribute\x22\x3ewidth\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attribute\x22\x3eheight\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e\x26gt;\x26lt;\/canvas\x26gt;\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e最后更新 advanceSnake， 当蛇吃食物时，增加并显示分数。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadvanceSnake\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  ...\n  if (didEatFood) {\n    score \x2b= \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27score\x27\x3c\/span\x3e).innerHTML = score;\n    createFood();\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    ...\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e呼…真不容易，不过胜利就在眼前了 😌\x3c\/p\x3e\n\x3ch3\x3e结束游戏\x3c\/h3\x3e\n\x3cp\x3e还剩下最后一部分，那就是结束游戏🖐。为此创建一个函数 didGameEnd，当游戏结束时返回 \x3cstrong\x3etrue\x3c\/strong\x3e，否则返回 \x3cstrong\x3efalse\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edidGameEnd\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e; i \x26lt; snake.length; i\x2b\x2b) {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e didCollide = snake[i].x === snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x \x26amp;\x26amp;\n      snake[i].y === snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (didCollide) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e hitLeftWall = snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e hitRightWall = snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x \x26gt; gameCanvas.width - \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e hitToptWall = snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e hitBottomWall = snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y \x26gt; gameCanvas.height - \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e hitLeftWall || \n         hitRightWall || \n         hitToptWall ||\n         hitBottomWall\n} \n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e首先，我们检查蛇的头部是否碰到蛇身上其他部分，如果碰到了那么返回 \x3cstrong\x3etrue\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3e请注意，我们从索引值 4 开始循环。这有两个原因：一个是如果索引为 0，\x3cstrong\x3edidCollide\x3c\/strong\x3e 则会立即判断为 true，导致游戏结束。另一个是，蛇的前三个部分不可能相互接触。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e接下来我们检查蛇是否在画布上撞墙了，如果是，那么返回 \x3cstrong\x3etrue\x3c\/strong\x3e，否则返回 \x3cstrong\x3efalse \x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e现在，如果 didEndGame 返回 true，我们可以在主函数中提前返回，从而结束游戏。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs actionscript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (didGameEnd()) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n  ...\n}\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3esnake.html 现在应该是这样的：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n   \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3eSnake Game\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22score\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e0\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ecanvas\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22gameCanvas\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ewidth\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eheight\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ecanvas\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/** 常量 **\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e CANVAS_BORDER_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27black\x27\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e CANVAS_BACKGROUND_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x22white\x22\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e SNAKE_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27lightgreen\x27\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e SNAKE_BORDER_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27darkgreen\x27\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e FOOD_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27red\x27\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e FOOD_BORDER_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27darkred\x27\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e snake = [\n        {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n        {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e140\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n        {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e130\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n        {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e120\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n        {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e110\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e}\n      ]\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 玩家的分数\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e score = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 横向移动速度\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e dx = \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 纵向移动速度\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e dy = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取 canvas 元素\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e gameCanvas = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x22gameCanvas\x22\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 返回一个二维绘制上下文\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ctx = gameCanvas.getContext(\x3cspan class=\x22hljs-string\x22\x3e\x222d\x22\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/  选择画布的背景颜色\x3c\/span\x3e\n      ctx.fillStyle = CANVAS_BACKGROUND_COLOUR;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/  选择画布的边框颜色\x3c\/span\x3e\n      ctx.strokestyle = CANVAS_BORDER_COLOUR;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制一个“实心的”长方形来覆盖整个画布\x3c\/span\x3e\n      ctx.fillRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.width, gameCanvas.height);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制画布的“边框”\x3c\/span\x3e\n      ctx.strokeRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.width, gameCanvas.height);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 开始游戏\x3c\/span\x3e\n      main();\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 生成第一个食物位置\x3c\/span\x3e\n      createFood();\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 按下任意一个键，都会调用 changeDirection\x3c\/span\x3e\n      \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x22keydown\x22\x3c\/span\x3e, changeDirection);\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (didGameEnd()) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonTick\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n          clearCanvas();\n          drawFood();\n          advanceSnake();\n          drawSnake();\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Call main again\x3c\/span\x3e\n          main();\n        }, \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e)\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/**\n      * 设置画布的背景色为 CANVAS_BACKGROUND_COLOUR \n      * 并绘制画布的边框\n      *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eclearCanvas\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/  选择画布的背景颜色\x3c\/span\x3e\n        ctx.fillStyle = CANVAS_BACKGROUND_COLOUR;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/  选择画布的边框颜色\x3c\/span\x3e\n        ctx.strokestyle = CANVAS_BORDER_COLOUR;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制一个“实心的”长方形来覆盖整个画布\x3c\/span\x3e\n        ctx.fillRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.width, gameCanvas.height);\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制画布的“边框”\x3c\/span\x3e\n        ctx.strokeRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.width, gameCanvas.height);\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/**\n       * 当蛇撞墙或者蛇头碰到蛇身的时候返回 true\n       *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edidGameEnd\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e; i \x26lt; snake.length; i\x2b\x2b) {\n          \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e didCollide = snake[i].x === snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x \x26amp;\x26amp; snake[i].y === snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (didCollide) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e hitLeftWall = snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e hitRightWall = snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x \x26gt; gameCanvas.width - \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e hitToptWall = snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e hitBottomWall = snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y \x26gt; gameCanvas.height - \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e hitLeftWall || hitRightWall || hitToptWall || hitBottomWall\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/**\n       * 在画布上画食物\n       *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edrawFood\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        ctx.fillStyle = FOOD_COLOUR;\n        ctx.strokestyle = FOOD_BORDER_COLOUR;\n        ctx.fillRect(foodX, foodY, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n        ctx.strokeRect(foodX, foodY, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/**\n       * 根据蛇的水平移动速度改变蛇的 x 坐标，\n       * 根据蛇的垂直移动速度改变蛇的 y 坐标\n       *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadvanceSnake\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制新的头部\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e head = {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x \x2b dx, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y \x2b dy};\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 将新的头部放到蛇身体的第一个部位\x3c\/span\x3e\n        snake.unshift(head);\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e didEatFood = snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x === foodX \x26amp;\x26amp; snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y === foodY;\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (didEatFood) {\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 增加分数\x3c\/span\x3e\n          score \x2b= \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在屏幕上显示分数\x3c\/span\x3e\n          \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27score\x27\x3c\/span\x3e).innerHTML = score;\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 生成新的食物\x3c\/span\x3e\n          createFood();\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 移除蛇的最后一个部分\x3c\/span\x3e\n          snake.pop();\n        }\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/**\n        * 给定一个最大值和最小值，生成一个 10 的倍数的随机数     \n        * @param { number } min —— 随机数的下限\n        * @param { number } max —— 随机数的上限\n       *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erandomTen\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3emin, max\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.round((\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.random() * (max-min) \x2b min) \/ \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e) * \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n      }\n     \x3cspan class=\x22hljs-comment\x22\x3e\/**     \n      * 随机生成食物坐标\n      *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecreateFood\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 随机生成食物的 x 坐标\x3c\/span\x3e\n        foodX = randomTen(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.width - \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 随机生成食物的 y 坐标\x3c\/span\x3e\n        foodY = randomTen(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.height - \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果新生成的食物与蛇当前位置重叠，重新为食物生成一个位置\x3c\/span\x3e\n        snake.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eisOnSnake\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3epart\x3c\/span\x3e) \x3c\/span\x3e{\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (part.x == foodX \x26amp;\x26amp; part.y == foodY) createFood();\n        });\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/**\n       * 在画布上画蛇\n       *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edrawSnake\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 循环遍历蛇的每一部分，并将其绘制到画布上\x3c\/span\x3e\n        snake.forEach(drawSnakePart)\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/**\n       * 在画布上画蛇的一个部分\n       * @param { object } snakePart  —— 需要绘制的部位的所在坐标\n       *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edrawSnakePart\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3esnakePart\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置蛇身体的背景颜色\x3c\/span\x3e\n        ctx.fillStyle = SNAKE_COLOUR;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置蛇身的边框色\x3c\/span\x3e\n        ctx.strokestyle = SNAKE_BORDER_COLOUR;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在蛇身坐标所在的位置，绘制“实心”的矩形以表示蛇      \x3c\/span\x3e\n        ctx.fillRect(snakePart.x, snakePart.y, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制蛇身的边框\x3c\/span\x3e\n        ctx.strokeRect(snakePart.x, snakePart.y, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/**     \n      * 根据按下的键，改变蛇的水平移动速度和垂直移动速度\n      * 为了避免蛇反转，蛇的移动方向不能直接变成相反的方向，\n      * 比如说，当前方向是“向右”，那么下一个方向不能是“向左”\n      * @param { object } event —— 键盘事件\n      *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3echangeDirection\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e LEFT_KEY = \x3cspan class=\x22hljs-number\x22\x3e37\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e RIGHT_KEY = \x3cspan class=\x22hljs-number\x22\x3e39\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e UP_KEY = \x3cspan class=\x22hljs-number\x22\x3e38\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e DOWN_KEY = \x3cspan class=\x22hljs-number\x22\x3e40\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e keyPressed = event.keyCode;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e goingUp = dy === \x3cspan class=\x22hljs-number\x22\x3e-10\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e goingDown = dy === \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e goingRight = dx === \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e goingLeft = dx === \x3cspan class=\x22hljs-number\x22\x3e-10\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (keyPressed === LEFT_KEY \x26amp;\x26amp; !goingRight) {\n          dx = \x3cspan class=\x22hljs-number\x22\x3e-10\x3c\/span\x3e;\n          dy = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (keyPressed === UP_KEY \x26amp;\x26amp; !goingDown) {\n          dx = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n          dy = \x3cspan class=\x22hljs-number\x22\x3e-10\x3c\/span\x3e;\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (keyPressed === RIGHT_KEY \x26amp;\x26amp; !goingLeft) {\n          dx = \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n          dy = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (keyPressed === DOWN_KEY \x26amp;\x26amp; !goingUp) {\n          dx = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n          dy = \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n        }\n      }\n    \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e现在贪食蛇游戏已经可以玩了，你可以独乐乐或者分享给你的朋友。不过在庆祝之前，我们还是来看看最后一个问题。我保证，这绝对是最后一个。\x3c\/p\x3e\n\x3ch3\x3e潜藏的 bugs 🐛\x3c\/h3\x3e\n\x3cp\x3e如果你玩了足够多次游戏，可能会注意到游戏有时会意外结束。这是一个很好的例子，展示了 bug 会潜入我们的程序并制造麻烦🙄。\x3c\/p\x3e\n\x3cp\x3e发现 bug 的时候，解决它的最好方法是首先找到可靠的方法来重现它。也就是说，找到导致意外行为的精确步骤。然后，需要了解它们导致意外行为的原因，最后寻求解决方案。\x3c\/p\x3e\n\x3ch4\x3e重现 bug\x3c\/h4\x3e\n\x3cp\x3e在我们的例子中，重现 bug 的步骤如下：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e蛇正向左移动\x3c\/li\x3e\n\x3cli\x3e玩家按下向下键\x3c\/li\x3e\n\x3cli\x3e玩家立即按下向右键（在 100 ms 内）\x3c\/li\x3e\n\x3cli\x3e游戏结束\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t01f5db14e92f238906.gif\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3ch4\x3e分析导致 bug 的原因\x3c\/h4\x3e\n\x3cp\x3e让我们一步步分解 bug 产生的过程。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e蛇正在向左移动\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e水平速度，dx 等于 -10\x3c\/li\x3e\n\x3cli\x3e调用 main 函数\x3c\/li\x3e\n\x3cli\x3e调用 advanceSnake 函数，蛇向左移动 10 px。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e玩家按下向下键\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e调用 changeDirection\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3ekeyPressed === DOWN_KEY \x26amp;\x26amp;  !goingUp\x3c\/code\x3e 的值为 true\x3c\/li\x3e\n\x3cli\x3edx 更改为 0\x3c\/li\x3e\n\x3cli\x3edy 更改为 \x2b10\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e玩家立即按下向右键（在 100 ms 内）\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e调用 changeDirection\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3ekeyPressed === RIGHT_KEY \x26amp;\x26amp; !goingLeft\x3c\/code\x3e 的值为 true\x3c\/li\x3e\n\x3cli\x3edx 更改为 \x2b10\x3c\/li\x3e\n\x3cli\x3edy 更改为 0\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e游戏结束\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3emain 函数\x3cstrong\x3e延时 100 ms 后\x3c\/strong\x3e被调用\x3c\/li\x3e\n\x3cli\x3e调用 advanceSnake，蛇向右移动 10 px。\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3econst didCollide = snake[i].x === snake[0].x \x26amp;\x26amp; snake[i].y === snake[0].y\x3c\/code\x3e 的值为true\x3c\/li\x3e\n\x3cli\x3edidGameEnd 返回 true\x3c\/li\x3e\n\x3cli\x3emain 函数提前返回\x3c\/li\x3e\n\x3cli\x3e游戏结束\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch4\x3e解决 bug\x3c\/h4\x3e\n\x3cp\x3e在分析了发生的事情之后，我们了解到游戏结束是因为蛇掉头了。\x3c\/p\x3e\n\x3cp\x3e这是因为当玩家按下向下键时，dx 被设置为 0。因此 \x3ccode\x3ekeyPressed === RIGHT_KEY \x26amp;\x26amp; !goingLeft\x3c\/code\x3e 值为 true，同时 dx 更改为 10。\x3c\/p\x3e\n\x3cp\x3e重要的是要注意，在 \x3cstrong\x3e100 ms 时间内\x3c\/strong\x3e，方向改变了。如果超过 100 ms，那么蛇首先会向下移而不会掉头。\x3c\/p\x3e\n\x3cp\x3e为了解决这个 bug，必须确保只有在 main 和 advanceSnake 被调用之后，才可以改变蛇的方向。可以创建一个变量 \x3cstrong\x3echangingDirection。\x3c\/strong\x3e当调用 changeDirection 时设置 changingDirection 为 true，并在调用 advanceSnake 时设置为 false。\x3c\/p\x3e\n\x3cp\x3e在 changeDirection 函数中，如果 \x3cstrong\x3echangingDirection\x3c\/strong\x3e 为 true，就提前返回。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs actionscript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3echangeDirection\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(event)\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e LEFT_KEY = \x3cspan class=\x22hljs-number\x22\x3e37\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e RIGHT_KEY = \x3cspan class=\x22hljs-number\x22\x3e39\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e UP_KEY = \x3cspan class=\x22hljs-number\x22\x3e38\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e DOWN_KEY = \x3cspan class=\x22hljs-number\x22\x3e40\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (changingDirection) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n  changingDirection = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n  ...\n}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n  setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonTick\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n    changingDirection = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n\n    ...\n  }, \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e)\n}\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e以下是 snake.html 的最终版本\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3e注意我还在 \x3ccode\x3e\x26lt;style\x26gt;\x26lt;\/style\x26gt;\x3c\/code\x3e 标签之间添加了一些样式🎨。这是为了让画布和分数显示在屏幕中间。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3eSnake Game\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elink\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ehref\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/fonts.googleapis.com\/css?family=Antic\x2bSlab\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3erel\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22stylesheet\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22score\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e0\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ecanvas\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22gameCanvas\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ewidth\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eheight\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ecanvas\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3estyle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22css\x22\x3e\n      \x3cspan class=\x22hljs-selector-id\x22\x3e#gameCanvas\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-attribute\x22\x3eposition\x3c\/span\x3e: absolute;\n        \x3cspan class=\x22hljs-attribute\x22\x3etop\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e50%\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-attribute\x22\x3eleft\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e50%\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-attribute\x22\x3etransform\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3etranslate\x3c\/span\x3e(-50%, -50%);\n      }\n      \x3cspan class=\x22hljs-selector-id\x22\x3e#score\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-attribute\x22\x3etext-align\x3c\/span\x3e: center;\n        \x3cspan class=\x22hljs-attribute\x22\x3efont-size\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e140px\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-attribute\x22\x3efont-family\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Antic Slab\x27\x3c\/span\x3e, serif;\n      }\n    \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3estyle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e GAME_SPEED = \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e CANVAS_BORDER_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27black\x27\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e CANVAS_BACKGROUND_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x22white\x22\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e SNAKE_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27lightgreen\x27\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e SNAKE_BORDER_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27darkgreen\x27\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e FOOD_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27red\x27\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e FOOD_BORDER_COLOUR = \x3cspan class=\x22hljs-string\x22\x3e\x27darkred\x27\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e snake = [\n      {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n      {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e140\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n      {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e130\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n      {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e120\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e},\n      {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e110\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e}\n    ]\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 玩家的分数\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e score = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ changingDirection 为 true 时表示蛇正在改变方向\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e changingDirection = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 食物的 x 坐标\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e foodX;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 食物的 y 坐标\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e foodY;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 横向移动速度\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e dx = \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 纵向移动速度\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e dy = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取 canvas 元素\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e gameCanvas = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x22gameCanvas\x22\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 返回一个二维绘制上下文\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ctx = gameCanvas.getContext(\x3cspan class=\x22hljs-string\x22\x3e\x222d\x22\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 开始游戏\x3c\/span\x3e\n    main();\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 生成第一个食物位置\x3c\/span\x3e\n    createFood();\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 按下任意一个键，都会调用 changeDirection\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x22keydown\x22\x3c\/span\x3e, changeDirection);\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * 游戏的主函数\n     * 递归调用以推进游戏  \n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 判定游戏结束时提前返回从而终止游戏\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (didGameEnd()) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n      setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonTick\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        changingDirection = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n        clearCanvas();\n        drawFood();\n        advanceSnake();\n        drawSnake();\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 再次调用 main\x3c\/span\x3e\n        main();\n      }, GAME_SPEED)\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * 设置画布的背景色为 CANVAS_BACKGROUND_COLOUR \n     * 并绘制画布的边框\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eclearCanvas\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/  选择画布的背景颜色\x3c\/span\x3e\n      ctx.fillStyle = CANVAS_BACKGROUND_COLOUR;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/  选择画布的边框颜色\x3c\/span\x3e\n      ctx.strokestyle = CANVAS_BORDER_COLOUR;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制一个“实心的”长方形来覆盖整个画布\x3c\/span\x3e\n      ctx.fillRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.width, gameCanvas.height);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制画布的“边框”\x3c\/span\x3e\n      ctx.strokeRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.width, gameCanvas.height);\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * 在画布上画食物\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edrawFood\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      ctx.fillStyle = FOOD_COLOUR;\n      ctx.strokestyle = FOOD_BORDER_COLOUR;\n      ctx.fillRect(foodX, foodY, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n      ctx.strokeRect(foodX, foodY, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * 根据蛇的水平移动速度改变蛇的 x 坐标，\n     * 根据蛇的垂直移动速度改变蛇的 y 坐标\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadvanceSnake\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制新的头部\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e head = {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x \x2b dx, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y \x2b dy};\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 将新的头部放到蛇身体的第一个部位\x3c\/span\x3e\n      snake.unshift(head);\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e didEatFood = snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x === foodX \x26amp;\x26amp; snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y === foodY;\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (didEatFood) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 增加分数\x3c\/span\x3e\n        score \x2b= \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在屏幕上显示分数\x3c\/span\x3e\n        \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27score\x27\x3c\/span\x3e).innerHTML = score;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 生成新的食物\x3c\/span\x3e\n        createFood();\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 移除蛇的最后一个部分\x3c\/span\x3e\n        snake.pop();\n      }\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * 当蛇撞墙或者蛇头碰到蛇身的时候返回 true\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edidGameEnd\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e; i \x26lt; snake.length; i\x2b\x2b) {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (snake[i].x === snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x \x26amp;\x26amp; snake[i].y === snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e hitLeftWall = snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e hitRightWall = snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].x \x26gt; gameCanvas.width - \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e hitToptWall = snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e hitBottomWall = snake[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].y \x26gt; gameCanvas.height - \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e hitLeftWall || hitRightWall || hitToptWall || hitBottomWall\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * 给定一个最大值和最小值，生成一个 10 的倍数的随机数     \n     * @param { number } min —— 随机数的下限\n     * @param { number } max —— 随机数的上限\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erandomTen\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3emin, max\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.round((\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.random() * (max-min) \x2b min) \/ \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e) * \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**     \n     * 随机生成食物坐标\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecreateFood\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 随机生成食物的 x 坐标\x3c\/span\x3e\n      foodX = randomTen(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.width - \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 随机生成食物的 y 坐标\x3c\/span\x3e\n      foodY = randomTen(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, gameCanvas.height - \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果新生成的食物与蛇当前位置重叠，重新为食物生成一个位置\x3c\/span\x3e\n      snake.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eisFoodOnSnake\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3epart\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e foodIsoNsnake = part.x == foodX \x26amp;\x26amp; part.y == foodY;\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (foodIsoNsnake) createFood();\n      });\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * 在画布上画蛇\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edrawSnake\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 循环遍历蛇的每一部分，并将其绘制到画布上\x3c\/span\x3e\n      snake.forEach(drawSnakePart)\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * 在画布上画蛇的一个部分\n     * @param { object } snakePart —— 需要绘制的部位的所在坐标\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edrawSnakePart\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3esnakePart\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置蛇身体的背景颜色\x3c\/span\x3e\n      ctx.fillStyle = SNAKE_COLOUR;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置蛇身的边框色\x3c\/span\x3e\n      ctx.strokestyle = SNAKE_BORDER_COLOUR;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在蛇身坐标所在的位置，绘制“实心”的矩形以表示蛇      \x3c\/span\x3e\n      ctx.fillRect(snakePart.x, snakePart.y, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制蛇身的边框\x3c\/span\x3e\n      ctx.strokeRect(snakePart.x, snakePart.y, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e);\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**     \n     * 根据按下的键，改变蛇的水平移动速度和垂直移动速度\n     * 为了避免蛇反转，蛇的移动方向不能直接变成相反的方向，\n     * 比如说，当前方向是“向右”，那么下一个方向不能是“向左”\n     * @param { object } event —— 键盘事件\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3echangeDirection\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e LEFT_KEY = \x3cspan class=\x22hljs-number\x22\x3e37\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e RIGHT_KEY = \x3cspan class=\x22hljs-number\x22\x3e39\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e UP_KEY = \x3cspan class=\x22hljs-number\x22\x3e38\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e DOWN_KEY = \x3cspan class=\x22hljs-number\x22\x3e40\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/**\n       * 避免贪食蛇掉头\n       * 举个例子：\n       * 蛇正在向右移动。玩家按下向下键然后迅速地按下向左键。\n       * 此时蛇不会先向下移动一步，而会马上改变方向\n       *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (changingDirection) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n      changingDirection = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e keyPressed = event.keyCode;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e goingUp = dy === \x3cspan class=\x22hljs-number\x22\x3e-10\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e goingDown = dy === \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e goingRight = dx === \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e goingLeft = dx === \x3cspan class=\x22hljs-number\x22\x3e-10\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (keyPressed === LEFT_KEY \x26amp;\x26amp; !goingRight) {\n        dx = \x3cspan class=\x22hljs-number\x22\x3e-10\x3c\/span\x3e;\n        dy = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n      }\n\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (keyPressed === UP_KEY \x26amp;\x26amp; !goingDown) {\n        dx = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n        dy = \x3cspan class=\x22hljs-number\x22\x3e-10\x3c\/span\x3e;\n      }\n\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (keyPressed === RIGHT_KEY \x26amp;\x26amp; !goingLeft) {\n        dx = \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n        dy = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n      }\n\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (keyPressed === DOWN_KEY \x26amp;\x26amp; !goingUp) {\n        dx = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n        dy = \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n      }\n    }\n  \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch3\x3e结尾\x3c\/h3\x3e\n\x3cp\x3e恭喜！🎉👏\x3c\/p\x3e\n\x3cp\x3e我们已经走完了这次旅程。希望你喜欢和我一起学习，并且有信心继续挑战下一次冒险。\x3c\/p\x3e\n\x3cp\x3e不过现在还不必告别。我的下一篇文章将重点介绍如何帮助您开启\x3cstrong\x3e非常\x3c\/strong\x3e令人兴奋的\x3cstrong\x3e开源\x3c\/strong\x3e世界。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/en.wikipedia.org\/wiki\/Open-source_software\x22\x3e开源\x3c\/a\x3e是学习\x3cstrong\x3e许多\x3c\/strong\x3e新知识、结识大佬的好方法。虽然最初未必敢于尝试，但这毫无疑问是非常有价值的。\x3c\/p\x3e\n\x3cp\x3e如果想要收到我下一篇文章的发布通知，可以关注我！📫\x3c\/p\x3e\n\x3cp\x3e很高兴能和你一起踏上这段旅程。\x3c\/p\x3e\n\x3cp\x3e期待下次再见。✨\x3c\/p\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>原文链接: <a href="https://www.zcfy.cc/article/think-like-a-programmer-how-to-build-snake-using-only-javascript-html-css">https://www.zcfy.cc/article/think-like-a-programmer-how-to-build-snake-using-only-javascript-html-css</a> 原文标题: 像程序员一样思考：如何只使用 JavaScript，HTML 和 CSS 开发贪食蛇游戏 本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2>本文链接：</h2><a href="https://alili.tech/archive/bdd791ff/" target="_blank">https://alili.tech/archive/bdd791ff/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>