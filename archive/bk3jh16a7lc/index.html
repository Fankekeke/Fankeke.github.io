<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="五分钟 -- 从零开始搭建属于自己的网页编辑器"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>五分钟 -- 从零开始搭建属于自己的网页编辑器 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/bk3jh16a7lc/",
				"appid": "1613049289050283", 
				"title": "五分钟 -- 从零开始搭建属于自己的网页编辑器 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-16T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/bgi7hmyz6gt/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/rm18e5h6k5g/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fbk3jh16a7lc%2f&text=%e4%ba%94%e5%88%86%e9%92%9f%20--%20%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%90%ad%e5%bb%ba%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84%e7%bd%91%e9%a1%b5%e7%bc%96%e8%be%91%e5%99%a8"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fbk3jh16a7lc%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fbk3jh16a7lc%2f&text=%e4%ba%94%e5%88%86%e9%92%9f%20--%20%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%90%ad%e5%bb%ba%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84%e7%bd%91%e9%a1%b5%e7%bc%96%e8%be%91%e5%99%a8"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fbk3jh16a7lc%2f&title=%e4%ba%94%e5%88%86%e9%92%9f%20--%20%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%90%ad%e5%bb%ba%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84%e7%bd%91%e9%a1%b5%e7%bc%96%e8%be%91%e5%99%a8"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fbk3jh16a7lc%2f&is_video=false&description=%e4%ba%94%e5%88%86%e9%92%9f%20--%20%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%90%ad%e5%bb%ba%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84%e7%bd%91%e9%a1%b5%e7%bc%96%e8%be%91%e5%99%a8"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%ba%94%e5%88%86%e9%92%9f%20--%20%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%90%ad%e5%bb%ba%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84%e7%bd%91%e9%a1%b5%e7%bc%96%e8%be%91%e5%99%a8&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fbk3jh16a7lc%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fbk3jh16a7lc%2f&title=%e4%ba%94%e5%88%86%e9%92%9f%20--%20%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%90%ad%e5%bb%ba%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84%e7%bd%91%e9%a1%b5%e7%bc%96%e8%be%91%e5%99%a8"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbk3jh16a7lc%2f&title=%e4%ba%94%e5%88%86%e9%92%9f%20--%20%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%90%ad%e5%bb%ba%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84%e7%bd%91%e9%a1%b5%e7%bc%96%e8%be%91%e5%99%a8"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbk3jh16a7lc%2f&title=%e4%ba%94%e5%88%86%e9%92%9f%20--%20%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%90%ad%e5%bb%ba%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84%e7%bd%91%e9%a1%b5%e7%bc%96%e8%be%91%e5%99%a8"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbk3jh16a7lc%2f&title=%e4%ba%94%e5%88%86%e9%92%9f%20--%20%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%90%ad%e5%bb%ba%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84%e7%bd%91%e9%a1%b5%e7%bc%96%e8%be%91%e5%99%a8"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">五分钟 -- 从零开始搭建属于自己的网页编辑器</h1><div class="meta"><div class="postdate"><time datetime="2018-12-16" itemprop="datePublished">2018-12-16</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e当然是不可能的。。。\x3cbr\x3e如果你还有兴趣继续看的话，想和大家交流一下我最近做的一个可以显示行数的textarea。只是一个不到300行代码的小玩具啦。\x3ca href=\x22https:\/\/shenmin-z.github.io\/lined-textarea\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e演示\x3c\/a\x3e和\x3ca href=\x22https:\/\/github.com\/Shenmin-Z\/lined-textarea\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e代码\x3c\/a\x3e\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV2o2g?w=643\x26amp;h=572\x22 src=\x22https:\/\/static.alili.tech\/img\/bV2o2g?w=643\x26amp;h=572\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e（专业的wysiwyg或者代码编辑器，请看\x3ca href=\x22https:\/\/quilljs.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3equilljs\x3c\/a\x3e, \x3ca href=\x22https:\/\/ace.c9.io\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eace editor\x3c\/a\x3e等）\x3c\/p\x3e\n\x3cp\x3e最近接到这么一个需求，要对一个textarea的数据进行格式验证。用户会输入几十个几百个IP地址，一行一个。验证是很容易，但是如果出错的话，用户并不知道是哪里出的错。textarea是不能加style的，所以我想能不能显示行数，这样就可以反馈给用户是哪里出错了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3eHTML 结构\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv\x3e\n  \x3cdiv\x3e\n    \x3cp\x3e1\x3c\/p\x3e\n    \x3cp\x3e2\x3c\/p\x3e\n    \x3cp\x3e3\x3c\/p\x3e\n    \x3cp\x3e4\x3c\/p\x3e\n  \x3c\/di\x3e\n  \x3ctextarea\x3e\x3c\/textarea\x3e\n\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22HTML\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e1\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e2\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e3\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e4\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3edi\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etextarea\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etextarea\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e几个实现上要考虑的问题\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e左边显示行数的DIV要和右边的textarea保持相同的高度。\x3c\/h3\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV2o3s?w=337\x26amp;h=184\x22 src=\x22https:\/\/static.alili.tech\/img\/bV2o3s?w=337\x26amp;h=184\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3ecss的flexbox可以很好的解决这个问题。（不用写js代码啦）\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e支持滚轮（scroll，两边要同步）\x3c\/h3\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV2o3t?w=337\x26amp;h=184\x22 src=\x22https:\/\/static.alili.tech\/img\/bV2o3t?w=337\x26amp;h=184\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e右边textarea如果滚动了，左边的div也要跟着滚。\x3c\/p\x3e\n\x3cp\x3e听scroll事件，更新左边div的\x3ccode\x3etransform: translateY()\x3c\/code\x3e值。这个据说是比\x3ccode\x3etop\x3c\/code\x3e，\x3ccode\x3ebottom\x3c\/code\x3e快。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e左边div宽度更新\x3c\/h3\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV2o3m?w=164\x26amp;h=67\x22 src=\x22https:\/\/static.alili.tech\/img\/bV2o3m?w=164\x26amp;h=67\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e因为用了\x3ccode\x3eposition: abosolute\x3c\/code\x3e，所以这一块要手动处理。首先算最长的长度，再更新div的\x3ccode\x3epadding-left\x3c\/code\x3e的值。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e检测什么时候换行了\x3c\/h3\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV2o3w?w=126\x26amp;h=220\x22 src=\x22https:\/\/static.alili.tech\/img\/bV2o3w?w=126\x26amp;h=220\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e图中红叉的地方是不该显示行数的，因为是在同一个句子内。这就需要计算一个句子会占多少行。这就麻烦了，这一块我写的不好。\x3c\/p\x3e\n\x3cp\x3e首先要算一行能放多少的字符。我用的方法是新建一个div，不断往里面加字符，测宽度，然后和textarea的宽度作比较。如果正好能被容纳，那么那个div里的字符数就是我们要求的值。这个方法不光听起来就蠢，还不准确。请看下图。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV2o3K?w=916\x26amp;h=950\x22 src=\x22https:\/\/static.alili.tech\/img\/bV2o3K?w=916\x26amp;h=950\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e实际可用宽度是36.534，实际文字宽度是36.6477,所以是放不下的。但是\x3ccode\x3eclientWidth\x3c\/code\x3e的精度只到整数，测下来是37，按这个结果看的话，那段文字是可以放得下的。[掀桌子]（为什么要用\x3ccode\x3eclientWidth\x3c\/code\x3e？因为滚动条会占空间。）这就麻烦了。\x3c\/p\x3e\n\x3cp\x3e然后就是要算每一个句子都占多少行。（在\x3ccode\x3ewhite-space: pre-wrap\x3c\/code\x3e的情况下）这也很麻烦，这个换不换行是浏览器决定的，要精确地还原似乎也不大容易。对空格，减号的处理都有特殊情况。这个我也就做了一个大概。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e更新可用宽度\x3c\/h3\x3e\n\x3cp\x3e三种情况需要更新textarea的可用宽度：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e左边div宽度改变\x3c\/li\x3e\n\x3cli\x3e滚动条的出现\/消失\x3c\/li\x3e\n\x3cli\x3e拖拽改变textarea的大小\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e对于1，我们之前就处理过，好改。\x3cbr\x3e对于2，听一下input事件，看textarea的clientHeight有没有变。滚动条是会占用clientHeight的。\x3cbr\x3e对于3，textarea没有resize事件，又要手动弄了。查了一下是要听鼠标点击和松开事件。于是我做了下面的试验：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV2o4i?w=308\x26amp;h=81\x22 src=\x22https:\/\/static.alili.tech\/img\/bV2o4i?w=308\x26amp;h=81\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV2o4j?w=121\x26amp;h=148\x22 src=\x22https:\/\/static.alili.tech\/img\/bV2o4j?w=121\x26amp;h=148\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV2o4k?w=207\x26amp;h=181\x22 src=\x22https:\/\/static.alili.tech\/img\/bV2o4k?w=207\x26amp;h=181\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV2o4l?w=213\x26amp;h=222\x22 src=\x22https:\/\/static.alili.tech\/img\/bV2o4l?w=213\x26amp;h=222\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e相同的操作：在textarea上按下鼠标，移开到textarea之外放开。结果三个浏览器的结果全不一样！不过至少都能听到mousedown事件，总算有切入的地方。具体实现可以看代码，文字叙述不大容易。要注意的是mousemove也要听，否则这样：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV2o4q?w=313\x26amp;h=250\x22 src=\x22https:\/\/static.alili.tech\/img\/bV2o4q?w=313\x26amp;h=250\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e还有一个写代码时我遇到的问题是如果把textarea缩到很小，浏览器就卡住了。直觉是遇到无限循环了。果然，是因为一行内一个字符也容不下的时候，那么就需要无限行。加了一个特殊条件处理的if之后解决了。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e不换行\x3c\/h3\x3e\n\x3cp\x3e这个firefox和edge还不一样（我只试了三个浏览器，外加chrome）。一个要用\x3ccode\x3ewhite-space: pre\x3c\/code\x3e，一个要用\x3ccode\x3ewhite-space: nowrap\x3c\/code\x3e。（chrome都可以）\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e结束\x3c\/h2\x3e\n\x3cp\x3e当然，真正要做网页编辑器的话是不可能用textarea的，我的这个东西在有限的场景里可能是会有用的。想了解实际的编辑器可以看这个\x3ca href=\x22https:\/\/medium.engineering\/why-contenteditable-is-terrible-122d8a40e480\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e文章\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e第一次发文章，不是教程，算是经验交流吧。欢迎大家讨论。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>五分钟 &ndash; 从零开始搭建属于自己的网页编辑器</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000012927038">https://segmentfault.com/a/1190000012927038</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/bk3jh16a7lc/" target="_blank">https://alili.tech/archive/bk3jh16a7lc/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>