<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Express 实战（六）：构建 API 接口"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Express 实战（六）：构建 API 接口 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/bv67m1nmtoq/",
				"appid": "1613049289050283", 
				"title": "Express 实战（六）：构建 API 接口 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-03T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/57kq0dslebo/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/bgzrztky2v/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fbv67m1nmtoq%2f&text=Express%20%e5%ae%9e%e6%88%98%ef%bc%88%e5%85%ad%ef%bc%89%ef%bc%9a%e6%9e%84%e5%bb%ba%20API%20%e6%8e%a5%e5%8f%a3"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fbv67m1nmtoq%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fbv67m1nmtoq%2f&text=Express%20%e5%ae%9e%e6%88%98%ef%bc%88%e5%85%ad%ef%bc%89%ef%bc%9a%e6%9e%84%e5%bb%ba%20API%20%e6%8e%a5%e5%8f%a3"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fbv67m1nmtoq%2f&title=Express%20%e5%ae%9e%e6%88%98%ef%bc%88%e5%85%ad%ef%bc%89%ef%bc%9a%e6%9e%84%e5%bb%ba%20API%20%e6%8e%a5%e5%8f%a3"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fbv67m1nmtoq%2f&is_video=false&description=Express%20%e5%ae%9e%e6%88%98%ef%bc%88%e5%85%ad%ef%bc%89%ef%bc%9a%e6%9e%84%e5%bb%ba%20API%20%e6%8e%a5%e5%8f%a3"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Express%20%e5%ae%9e%e6%88%98%ef%bc%88%e5%85%ad%ef%bc%89%ef%bc%9a%e6%9e%84%e5%bb%ba%20API%20%e6%8e%a5%e5%8f%a3&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fbv67m1nmtoq%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fbv67m1nmtoq%2f&title=Express%20%e5%ae%9e%e6%88%98%ef%bc%88%e5%85%ad%ef%bc%89%ef%bc%9a%e6%9e%84%e5%bb%ba%20API%20%e6%8e%a5%e5%8f%a3"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbv67m1nmtoq%2f&title=Express%20%e5%ae%9e%e6%88%98%ef%bc%88%e5%85%ad%ef%bc%89%ef%bc%9a%e6%9e%84%e5%bb%ba%20API%20%e6%8e%a5%e5%8f%a3"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbv67m1nmtoq%2f&title=Express%20%e5%ae%9e%e6%88%98%ef%bc%88%e5%85%ad%ef%bc%89%ef%bc%9a%e6%9e%84%e5%bb%ba%20API%20%e6%8e%a5%e5%8f%a3"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbv67m1nmtoq%2f&title=Express%20%e5%ae%9e%e6%88%98%ef%bc%88%e5%85%ad%ef%bc%89%ef%bc%9a%e6%9e%84%e5%bb%ba%20API%20%e6%8e%a5%e5%8f%a3"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Express 实战（六）：构建 API 接口</h1><div class="meta"><div class="postdate"><time datetime="2019-01-03" itemprop="datePublished">2019-01-03</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010820713\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010820713\x22 alt=\x22Cover\x22 title=\x22Cover\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e在介绍了那么多 Express 核心概念之后，接下来的文章将会把注意力放在如何构建一个真实的应用上。这里我们先从构建应用 API 接口开始。从某种程度上来说几乎所有的软件应用其背后都是由一组强大的 API 驱动。\x3c\/p\x3e\n\x3cp\x3e其实 API 就是一种代码之间交互的一种方式，它既可以是在程序内部也可以是通过网络的跨机器进行。例如，Express 中的 \x3cem\x3eapp.use\x3c\/em\x3e 和 \x3cem\x3eapp.get\x3c\/em\x3e 就属于在内部使用 API 。而通过 HTTP 或者 FTP 等协议发送 JSON、XML 数据的方式则属于后者。对于后一种方式需要注意的是，API 的提供者和使用者必须对数据格式做出约定。在本文示例中，我们将会讨论如何使用 Express 构建后一类型的 API 接口，同时所有 HTTP 接口返回的数据格式都将使用 JSON。\x3c\/p\x3e\n\x3cp\x3e\x26lt;!--more--\x26gt;\x3c\/p\x3e\n\x3cp\x3e另外，本章还会讨论如何设计一个优雅的 API   用于提升使用者的体验和效率，让 API 的含义一目了然而不用去阅读又臭又长的说明文档。就像“好代码”与“坏代码”一样，API 是否优雅其实更多的取决于实际情形。盲目遵循 API 设计的最佳实践有时会显得很迂腐，因为它有可能与使用者的期望不一致。\x3c\/p\x3e\n\x3cp\x3e接下来的内容包括：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e什么是 API 。\x3c\/li\x3e\n\x3cli\x3eExpress 中构建 API 的基础内容。\x3c\/li\x3e\n\x3cli\x3eHTTP 方法与应用逻辑的关联。\x3c\/li\x3e\n\x3cli\x3e多版本 API 的实现和管理。\x3c\/li\x3e\n\x3cli\x3eHTTP 状态码的正确使用。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e简单的 JSON 格式 API 示例\x3c\/h2\x3e\n\x3cp\x3e首先，我们需要明确该示例的功能以及 API 的使用方式，后面再写代码。\x3c\/p\x3e\n\x3cp\x3e假设，现在程序需要在接受到 \x3cem\x3eAmerica\/Los_Angeles\x3c\/em\x3e 或 \x3cem\x3eEurope\/London\x3c\/em\x3e 等代表时区的字符串后，返回该时区的当前时间信息（例如：\x3cem\x3e2015-04-07T20:09:58-07:00\x3c\/em\x3e ）。该返回信息与现实中易懂的时间格式是不一样的，因为它是为计算机设计的。\x3c\/p\x3e\n\x3cp\x3e通过类似下面格式的 URL 的 HTTP 请求来调用应用 API：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/timezone?tz=America\x2bLos_Angeles\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs fix\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-attr\x22\x3e\/timezone?tz\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3eAmerica\x2bLos_Angeles\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e而服务端 API 返回的 JSON 的数据格式，如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n    \x26quot;time\x26quot;: \x26quot;2015-06-09T16:20:00\x2b01:00\x26quot;,\n    \x26quot;zone\x26quot;: \x26quot;America\/Los_Angeles\x26quot;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22json hljs\x22\x3e\x3ccode class=\x22JSON\x22\x3e{\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22time\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x222015-06-09T16:20:00\x2b01:00\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22zone\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22America\/Los_Angeles\x22\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e只要能调用 API 并对 JSON 数据进行解析，你就可以在任意平台构建任意应用程序。如下图，你可以通过 AJAX  请求该 API  实现一个展示时区信息的单页应用。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010820714\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010820714\x22 alt=\x2206_01\x22 title=\x2206_01\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e你也可以利用该接口实现下图所示的移动应用。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010820715\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010820715\x22 alt=\x2206_02\x22 title=\x2206_02\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e你甚至可以利用该 API 实现下图一样的终端命令行工具：在终端中打印服务端 API 接口返回的数据。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010820716\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010820716\x22 alt=\x2206_03\x22 title=\x2206_03\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e像前一章的天气应用一样，我们可以利用这些 API 返回的冰冷数据构建更具表达力的 UI 。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3eExpress 驱动的 JSON API 服务\x3c\/h2\x3e\n\x3cp\x3e了解 API 概念之后，下面我们就动手实现一个 Express 驱动的 API 服务。实现的原理非常简单：通过中间件和内置函数解析网络请求并将 JSON 数据和 HTTP 状态码封装到响应对象并返回给客户端。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e从技术角度上说，API 服务除了使用 JSON 格式外，你还可以是使用 XML 或者纯文本。但是 Express 和 JavaScript 对 JSON 的支持是最好的，同时它也是当前最流行的格式，所以后面会一直使用 JSON 作为默认数据格式。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e下面我们编写一个为多平台提供随机数生成的服务，该 API 将拥有如下特性：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e在请求 API 时必须附带随机数最小值和最大值。\x3c\/li\x3e\n\x3cli\x3e解析请求获取随机数范围并将生产的结果以 JSON 格式返回。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e你可能认为这里完全可以使用纯文本来替换 JSON 格式。但是发送 JSON 数据是开发者的必备技能，而且 JSON 格式极易拓展。\x3c\/p\x3e\n\x3cp\x3e该工程的构建步骤如下：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e新建 \x3cem\x3epackage.json\x3c\/em\x3e 。\x3c\/li\x3e\n\x3cli\x3e创建工程主入口文件 \x3cem\x3eapp.js\x3c\/em\x3e 。\x3c\/li\x3e\n\x3cli\x3e在 \x3cem\x3eapp.js\x3c\/em\x3e 中创建应用和路由中间件。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e首先，在新建的 \x3cem\x3epackage.json\x3c\/em\x3e 中，复制下面的内容并按照依赖项：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n    \x26quot;name\x26quot;: \x26quot;random-number-api\x26quot;,\n    \x26quot;private\x26quot;: true,\n    \x26quot;scripts\x26quot;: {\n        \x26quot;start\x26quot;: \x26quot;node app\x26quot;\n    },\n    \x26quot;dependencies\x26quot;: {\n        \x26quot;express\x26quot;: \x26quot;^5.0.0\x26quot; \n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22json hljs\x22\x3e\x3ccode class=\x22JSON\x22\x3e{\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22name\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22random-number-api\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22private\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22scripts\x22\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3e\x22start\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22node app\x22\x3c\/span\x3e\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22dependencies\x22\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3e\x22express\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22^5.0.0\x22\x3c\/span\x3e \n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e接下来，将下面的代码复制到入口文件 \x3cem\x3eapp.js\x3c\/em\x3e 中：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var express = require(\x26quot;express\x26quot;);\nvar app = express();\n\napp.get(\x26quot;\/random\/:min\/:max\x26quot;, function(req, res) {\n    var min = parseInt(req.params.min);\n    var max = parseInt(req.params.max);\n    if (isNaN(min) || isNaN(max)) {\n        res.status(400);\n        res.json({ error: \x26quot;Bad request.\x26quot; });\n        return;\n    }\n   \n    var result = Math.round((Math.random() * (max - min)) \x2b min);\n    res.json({ result: result });\n});\n\napp.listen(3000, function() {\n    console.log(\x26quot;App started on port 3000\x26quot;);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22JavaScript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e express = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22express\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = express();\n\napp.get(\x3cspan class=\x22hljs-string\x22\x3e\x22\/random\/:min\/:max\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e min = \x3cspan class=\x22hljs-built_in\x22\x3eparseInt\x3c\/span\x3e(req.params.min);\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e max = \x3cspan class=\x22hljs-built_in\x22\x3eparseInt\x3c\/span\x3e(req.params.max);\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3eisNaN\x3c\/span\x3e(min) || \x3cspan class=\x22hljs-built_in\x22\x3eisNaN\x3c\/span\x3e(max)) {\n        res.status(\x3cspan class=\x22hljs-number\x22\x3e400\x3c\/span\x3e);\n        res.json({ \x3cspan class=\x22hljs-attr\x22\x3eerror\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Bad request.\x22\x3c\/span\x3e });\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n    }\n   \n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e result = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.round((\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.random() * (max - min)) \x2b min);\n    res.json({ \x3cspan class=\x22hljs-attr\x22\x3eresult\x3c\/span\x3e: result });\n});\n\napp.listen(\x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22App started on port 3000\x22\x3c\/span\x3e);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e现在启动应用并访问 \x3cem\x3e\x3ca href=\x22http:\/\/localhost:3000\/random\/10\/100\/em\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/localhost:3000\/random\/...\x3c\/a\x3e 的话，你将看到一个附带 10 ～ 100 范围内随机数的 JSON 数据。\x3c\/em\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010820717\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010820717\x22 alt=\x2206_04\x22 title=\x2206_04\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e接下来，我们来分析上面的代码。\x3c\/p\x3e\n\x3cp\x3e与之前一样，前两行代码引入了 Express 并创建了一个 Express 应用实例。\x3c\/p\x3e\n\x3cp\x3e然后，我们创建了一个路由中间件用于处理类似 \x3cem\x3e\/random\/10\/100\x3c\/em\x3e 这样的 API 请求。当然，这里还存在一些 bug ，例如，没有过滤掉 \x3cem\x3e\/random\/foo\/bar\x3c\/em\x3e 请求。所以，在调用 API 的时候请确保使用的参数是整型变量。\x3c\/p\x3e\n\x3cp\x3e在然后，我们使用内置的 \x3cem\x3eparseInt\x3c\/em\x3e 解析范围参数，而该函数的返回值只可能是整形数字或者 NaN。如果传入的参数有一个为 NaN 的话就会给客户端返回一个错误信息。下面这部分代码对于整个程序来说是非常重要的：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (isNaN(min) || isNaN(max)) {\n  res.status(400);\n  res.json({ error: \x26quot;Bad request.\x26quot; });\n  return;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22JavaScript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3eisNaN\x3c\/span\x3e(min) || \x3cspan class=\x22hljs-built_in\x22\x3eisNaN\x3c\/span\x3e(max)) {\n  res.status(\x3cspan class=\x22hljs-number\x22\x3e400\x3c\/span\x3e);\n  res.json({ \x3cspan class=\x22hljs-attr\x22\x3eerror\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Bad request.\x22\x3c\/span\x3e });\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果上面的参数检查的结果是最少有一个为 NaN ，程序就会进行如下处理：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e设置 HTTP 状态码为 400。常见的 404 错误就是它的一个具体变种，表示的含义是：用户请求的出现了问题。\x3c\/li\x3e\n\x3cli\x3e发送包含错误信息的 JSON 数据。\x3c\/li\x3e\n\x3cli\x3e结束请求处理并跳出中间件执行。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e在代码的最后，我们会在合法的参数返回内生成随机数并将结果返回给客户端。\x3c\/p\x3e\n\x3cp\x3e虽然示例很简单，但是它已经包含了使用 Express 构建 API 的基本流程：解析请求，设置 HTTP 状态码，返回响应数据。你可以在这个基础之上构建更为复杂优雅的 API 。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3eCURD  操作 API\x3c\/h2\x3e\n\x3cp\x3eCURD 是对程序中 Create、Read、Update、Delete 四种业务动作的一个简称。\x3c\/p\x3e\n\x3cp\x3e大多数的应用都会涉及到 CURD 操作。例如，对于一个图片分享应用来说，其中涉及图片的所有操作就是典型的 CRUD：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e用户上传照片的行为对应就是 \x3cem\x3ecreate\x3c\/em\x3e 操作。\x3c\/li\x3e\n\x3cli\x3e用户浏览照片的行为就是 \x3cem\x3eread\x3c\/em\x3e 操作。\x3c\/li\x3e\n\x3cli\x3e用户更新照片的行为就是 \x3cem\x3eupdate\x3c\/em\x3e 操作。\x3c\/li\x3e\n\x3cli\x3e用户删除照片的行为就是 \x3cem\x3edelete\x3c\/em\x3e 操作。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e无论是分享照片的社交应用还是文件存储服务，你生活中的使用的很多服务中都使用了这种模式。不过在开始讨论构建 CRUD 功能的 API 之前，我们先来看看被称为 HTTP 方法的内容。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3eHTTP 方法\x3c\/h3\x3e\n\x3cp\x3eHTTP 的规范中是这样定义其方法的：\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eHTTP 方法明确了对请求 URI 所标识资源进行的操作，而且方法是区分大小写的。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e一个更易理解的解释是：客户端在发送 HTTP 请求时需要指定一个 HTTP 方法，然后服务端回依据不同的 HTTP 方法做出不同的响应。虽然，可用的 HTTP 方法有很多，但是常用的其实并不多。其中在 Web 应用中常用是下面 4 个：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3eGET 是最常用的一个 HTTP 方法，它表示请求服务端资源。例如，加载网站首页、请求图片资源都使用的是 GET。虽然服务端的响应可能不同，但是GET 请求并不会改变服务器的资源。例如，对某图片资源的一次或者多次请求并不会导致图片本身出现任何差别。\x3c\/li\x3e\n\x3cli\x3ePOST 是另一个常用的 HTTP 方法。例如，创建新博客、上传照片、注册用户、清空购物车等业务都是使用 POST 。与 GET 不同的是：每次 POST 请求都会导致服务端发生修改。\x3c\/li\x3e\n\x3cli\x3ePUT 方法用于对已有记录的修改，所有我觉得它应该被称为 \x22UPDATE\x22 更为合适。例如，修改博客标题、修改用户昵称等操作都是 PUT 操作。另外，PUT 还具备 POST 的功能：就是当要修改的记录不存在时可以进行新建操作（非必需）。其次 PUT 还具有 GET 方法的特点：对同一 URL 的一次或多次 PUT 请求后的结果是一致的。\x3c\/li\x3e\n\x3cli\x3eDELETE 方法用于记录删除。例如，删除用户文章、删除网络照片。另外，与 PUT 一样同一删除请求无论是执行一次还是多次最终结果是一致的。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e虽然 HTTP 还有很多其他的方法，但是它们在现实开发过程中并不常见。理论上你甚至可以只使用 GET 和 POST 请求完成所有业务，但是这是错误实践毕竟它违反了 HTTP 规范也会给开发者造成困惑。另外，很多浏览器也是根据 HTTP 方法来明确所执行的操作类型。所以，即使并没有强制你也应该参照该规范来约束自己的行为。\x3c\/p\x3e\n\x3cp\x3e前面你已经见过 Express 中对部分方法的处理，不过下面的代码将一次涵盖上面所有的四个方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var express = express(\x26quot;express\x26quot;);\nvar app = express();\n\napp.get(\x26quot;\/\x26quot;, function(req, res) {\n  res.send(\x26quot;you just sent a GET request, friend\x26quot;);\n});\n\napp.post(\x26quot;\/\x26quot;, function(req, res) {\n  res.send(\x26quot;a POST request? nice\x26quot;);\n});\n\napp.put(\x26quot;\/\x26quot;, function(req, res) {\n  res.send(\x26quot;i don\x27t see a lot of PUT requests anymore\x26quot;);\n});\n\napp.delete(\x26quot;\/\x26quot;, function(req, res) {\n  res.send(\x26quot;oh my, a DELETE??\x26quot;);\n});\n\napp.listen(3000, function() {\n  console.log(\x26quot;App is listening on port 3000\x26quot;);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22JavaScript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e express = express(\x3cspan class=\x22hljs-string\x22\x3e\x22express\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = express();\n\napp.get(\x3cspan class=\x22hljs-string\x22\x3e\x22\/\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e) \x3c\/span\x3e{\n  res.send(\x3cspan class=\x22hljs-string\x22\x3e\x22you just sent a GET request, friend\x22\x3c\/span\x3e);\n});\n\napp.post(\x3cspan class=\x22hljs-string\x22\x3e\x22\/\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e) \x3c\/span\x3e{\n  res.send(\x3cspan class=\x22hljs-string\x22\x3e\x22a POST request? nice\x22\x3c\/span\x3e);\n});\n\napp.put(\x3cspan class=\x22hljs-string\x22\x3e\x22\/\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e) \x3c\/span\x3e{\n  res.send(\x3cspan class=\x22hljs-string\x22\x3e\x22i don\x27t see a lot of PUT requests anymore\x22\x3c\/span\x3e);\n});\n\napp.delete(\x3cspan class=\x22hljs-string\x22\x3e\x22\/\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e) \x3c\/span\x3e{\n  res.send(\x3cspan class=\x22hljs-string\x22\x3e\x22oh my, a DELETE??\x22\x3c\/span\x3e);\n});\n\napp.listen(\x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22App is listening on port 3000\x22\x3c\/span\x3e);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e将代码复制到入口文件 \x3cem\x3eapp.js\x3c\/em\x3e 中并启动服务，然后你就可以使用 cURL 命令测试不同的 HTTP 方法了。默认情况下 cURL 使用 GET 发送请求，但是你可以使用 -X 选项来指定其他的方法。例如，\x3cem\x3ecurl -X PUT \x3ca href=\x22http:\/\/localhost:3000\/em\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/localhost:3000\x3c\/a\x3e\x3c\/em\x3e 。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010820718\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010820718\x22 alt=\x2206_05\x22 title=\x2206_05\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e通过 HTTP 方法构建 CRUD 接口\x3c\/h3\x3e\n\x3cp\x3e回想以下之前的照片分享应用，下面是其中可能的 CRUD  操作：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e用户上传图片，此为 \x3cem\x3eCreate\x3c\/em\x3e。\x3c\/li\x3e\n\x3cli\x3e用户浏览图片，此为 \x3cem\x3eRead\x3c\/em\x3e。\x3c\/li\x3e\n\x3cli\x3e用户更新图片备注等信息，此为 \x3cem\x3eUpdate\x3c\/em\x3e。\x3c\/li\x3e\n\x3cli\x3e用户从站点删除图片，此为 \x3cem\x3eDelete\x3c\/em\x3e。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e不难看出 CRUD 操作与之前四种 HTTP 方法存在对应关系：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eCreate = POST\x3c\/li\x3e\n\x3cli\x3eRead = GET\x3c\/li\x3e\n\x3cli\x3eUpdate = PUT\x3c\/li\x3e\n\x3cli\x3eDelete = DELETE\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e因此通过这四个 HTTP 方法我们可以很好的实现最常见 CRUD 风格的 web 应用程序。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e实际上对于更新和创建动作与 HTTP 方法的对应关系，一些人有着自己的看法。它们认为 PUT 更应该对应创建动作而非 POST。另外，新的 PATCH 方法则对应更新操作。虽然本文将会使用上面那种更规范的对应关系，但是你完全可以按照自己的意愿选择。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3eAPI 版本控制\x3c\/h2\x3e\n\x3cp\x3e为了应对未来可能的 API 更新，对 API 进行版本控制是一件非常高效的方法。例如，前面获取指定时区当前时间的 API 在推出后就被很多的厂商和开发者使用。但是，几年几后由于某些原因必须对该 API 进行更新而与此同时你又不能影响之前的使用者。此时，我们就可以通过添加新版本来解决这个问题。其中原有的 API 请求可以通过：\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e\/v1\/timezone\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e而新版本 API 请求则可以使用：\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e\/v2\/timezone\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e这样不仅在进行 API 更新时防止了代码的破坏性更改。而且接口使用者也有了更灵活的选择，他们可以在必要的时候进行 API 切换。\x3c\/p\x3e\n\x3cp\x3e在 Express 中可以使用 Router 中间件来实现 API 版本管理。拷贝下面代码到文件 \x3cem\x3eapp1.js\x3c\/em\x3e 中，并讲其作为第一个版本 API 的实现：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var express = require(\x26quot;express\x26quot;);\nvar api = express.Router();\n\napi.get(\x26quot;\/timezone\x26quot;, function(req, res) {\n    res.send(\x26quot;Sample response for \/timezone\x26quot;);\n});\napi.get(\x26quot;\/all_timezones\x26quot;, function(req, res) {\n    res.send(\x26quot;Sample response for \/all_timezones\x26quot;);\n});\n\nmodule.exports = api;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22JavaScript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e express = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22express\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e api = express.Router();\n\napi.get(\x3cspan class=\x22hljs-string\x22\x3e\x22\/timezone\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e) \x3c\/span\x3e{\n    res.send(\x3cspan class=\x22hljs-string\x22\x3e\x22Sample response for \/timezone\x22\x3c\/span\x3e);\n});\napi.get(\x3cspan class=\x22hljs-string\x22\x3e\x22\/all_timezones\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e) \x3c\/span\x3e{\n    res.send(\x3cspan class=\x22hljs-string\x22\x3e\x22Sample response for \/all_timezones\x22\x3c\/span\x3e);\n});\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = api;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e请注意，上面的中间件代码在处理的 URL 并没有包含 \x3cem\x3e\/v1\x3c\/em\x3e 。下面在入口文件中引入这个 Router 中间件并进行路由映射。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var express = require(\x26quot;express\x26quot;);\nvar apiVersion1 = require(\x26quot;.\/api1.js\x26quot;);\nvar app = express();\napp.use(\x26quot;\/v1\x26quot;, apiVersion1);\napp.listen(3000, function() {\n    console.log(\x26quot;App started on port 3000\x26quot;);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22JavaScript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e express = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22express\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e apiVersion1 = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22.\/api1.js\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = express();\napp.use(\x3cspan class=\x22hljs-string\x22\x3e\x22\/v1\x22\x3c\/span\x3e, apiVersion1);\napp.listen(\x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22App started on port 3000\x22\x3c\/span\x3e);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后，你将最新版本的 API  实现放在 \x3cem\x3eapi2.js\x3c\/em\x3e 文件中：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var express = require(\x26quot;express\x26quot;);\nvar api = express.Router();\n\napi.get(\x26quot;\/timezone\x26quot;, function(req, res) {\n    res.send(\x26quot;API 2: super cool new response for \/timezone\x26quot;);\n});\nmodule.exports = api;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode class=\x22JavaScirpt\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e express = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22express\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e api = express.Router();\n\napi.get(\x3cspan class=\x22hljs-string\x22\x3e\x22\/timezone\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e) \x3c\/span\x3e{\n    res.send(\x3cspan class=\x22hljs-string\x22\x3e\x22API 2: super cool new response for \/timezone\x22\x3c\/span\x3e);\n});\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = api;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最后，通过 Router 将这两个版本的 API 同时添加到主入口中：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var express = require(\x26quot;express\x26quot;);\n\nvar apiVersion1 = require(\x26quot;.\/api1.js\x26quot;);\nvar apiVersion2 = require(\x26quot;.\/api2.js\x26quot;);\nvar app = express();\n\napp.use(\x26quot;\/v1\x26quot;, apiVersion1);\napp.use(\x26quot;\/v2\x26quot;, apiVersion2);\napp.listen(3000, function() {\n    console.log(\x26quot;App started on port 3000\x26quot;);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22JavaScript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e express = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22express\x22\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e apiVersion1 = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22.\/api1.js\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e apiVersion2 = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22.\/api2.js\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = express();\n\napp.use(\x3cspan class=\x22hljs-string\x22\x3e\x22\/v1\x22\x3c\/span\x3e, apiVersion1);\napp.use(\x3cspan class=\x22hljs-string\x22\x3e\x22\/v2\x22\x3c\/span\x3e, apiVersion2);\napp.listen(\x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22App started on port 3000\x22\x3c\/span\x3e);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e你可以通过浏览器验证这些版本化后的 API 是否正确工作，另外你也可以使用 cURL 命令进行测试。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010820719\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010820719\x22 alt=\x2206_07\x22 title=\x2206_07\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e就像前面章节介绍的那样，Router 可以让你将不同的路由存放在不同文件中进行管理。而版本化 API 就是最典型的应用实例。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e设置 HTTP 状态码\x3c\/h2\x3e\n\x3cp\x3e每一个 HTTP 响应都应该附带一个 HTTP 状态码，其中最有名的就是 \x3cem\x3e404 Not Found\x3c\/em\x3e 。\x3c\/p\x3e\n\x3cp\x3e虽然 404 是最出名的，但是 200 状态码确是最常见的。与 404 不同的是，虽然当网页成功加载或 JSON 数据成功返回后都会包含状态码 200，但它并不会被展示出来。\x3c\/p\x3e\n\x3cp\x3e当然，除了 404 和 200 之外，HTTP 中还定义了很多其他的状态码，包括 100、200、300、400 以及 500 系列。需要注意的是并不是每个系列中所有 100 个数字都有明确定义，例如，100 系列只有 100，101，102 三个有效码，紧跟其后就是 200 。\x3c\/p\x3e\n\x3cp\x3e每个状态码系列其实都有特定的含义和主题，总结就是：\x3c\/p\x3e\n\x3cp\x3e1xx: 成功接收到请求。\x3cbr\x3e2xx: 成功\x3cbr\x3e3xx: 重定向 \x3cbr\x3e4xx: 客户端错误  \x3cbr\x3e5xx: 服务端错误\x3c\/p\x3e\n\x3cp\x3e规范中只定义的大约 60 个\x3ca href=\x22https:\/\/en.wikipedia.org\/wiki\/List_of_HTTP_status_codes\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e状态码\x3c\/a\x3e。你可以在此基础上拓展自己的状态码，但是通常并不会这么做。因为优秀的 API 的首要设计原则就是确保不会对使用者造成任何歧义，所以应该最大程度遵循官方规范的指导。后面我们会对上面的每个区间的状态码进行讲解，但是在此之前先来看看如何在 Express 中设置状态码。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e少部分应用还在使用 HTTP 1.0 版本的协议，而大部分以及切换到了 1.1 版本。作为下一个版本的 HTTP 2.0 标准现在也逐渐在推广过程中。幸运的是，2.0 版本的协议大部分更新都在底层所以切换时并不会涉及太大的工作量。另外，2.0 版本还新增了一个 421 的状态码。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e设置 HTTP 状态码\x3c\/h3\x3e\n\x3cp\x3e默认情况下，HTTP 状态码是 200。如果用户访问的 URL 对应资源不存在的话，Express 会发送 404 错误。如果访问的服务器出现问题的话，Express 就会发送 500 错误。\x3c\/p\x3e\n\x3cp\x3e但是这些都是 Express 的默认行为，某些情形下可能会需要自行设置状态码。为此，Express 的 \x3cem\x3eresponse\x3c\/em\x3e 对象提供了一个 \x3cem\x3estatus\x3c\/em\x3e 方法，你需要在调用是传入对应状态码就能完成设置。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ ...\nres.status(404);\n\/\/ ...\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22JavaScript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\nres.status(\x3cspan class=\x22hljs-number\x22\x3e404\x3c\/span\x3e);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e该方法可以进行链式调用，所以你可以紧跟其后使用 \x3cem\x3ejson\x3c\/em\x3e 设置返回的数据。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22res.status(404).json({ error: \x26quot;Resource not found!\x26quot; });\n\/\/ 它等价于：\nres.status(404);\nres.json({ error: \x26quot;Resource not found!\x26quot; });\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22JavaScript\x22\x3eres.status(\x3cspan class=\x22hljs-number\x22\x3e404\x3c\/span\x3e).json({ \x3cspan class=\x22hljs-attr\x22\x3eerror\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Resource not found!\x22\x3c\/span\x3e });\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 它等价于：\x3c\/span\x3e\nres.status(\x3cspan class=\x22hljs-number\x22\x3e404\x3c\/span\x3e);\nres.json({ \x3cspan class=\x22hljs-attr\x22\x3eerror\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Resource not found!\x22\x3c\/span\x3e });\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e虽然 Express 对原生 Node 的 \x3cem\x3eresponse\x3c\/em\x3e 对象进行了拓展，并且在使用 Express 时也应遵循 Express 风格，但是你依旧可以使用原生方法来完成设置。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22res.statusCode = 404;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22JavaScript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eres.statusCode = \x3cspan class=\x22hljs-number\x22\x3e404\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e100 区间\x3c\/h3\x3e\n\x3cp\x3e100 区间的官方状态码只有两个：100（继续） 和 101 （切换协议），而且它们很少会被用到。如果你必须处理的话，可以去官网或者维基上查看。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e200 区间\x3c\/h3\x3e\n\x3cp\x3e200 区间状态码表示请求成功。虽然该区间状态码不少，但是常用的也就下面 4 个：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e200：作为最常见的状态码，它也被称为 \x22OK\x22。这意味着请求和响应都正确执行期间并没有出现任何错误或者重定向操作。\x3c\/li\x3e\n\x3cli\x3e201：与 200 十分类似，但是使用情形略有不同。它通常用于 POST 或者 PUT 请求成功创建记录后。例如，创建博文、上传图片等操作成功后就会发送 201。\x3c\/li\x3e\n\x3cli\x3e202：202 是 201 的一个变种。因为，资源的创建大多是异步进行的，而这些操作也是费时的。所以，你可以在此时给客户端响应 202 。它表示已经成功接收数据正在等待创建。\x3c\/li\x3e\n\x3cli\x3e204：它表示用户删除请求所对应的资源并不存在已经被删除过了。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e300区间\x3c\/h3\x3e\n\x3cp\x3e同样，在 300 区间，我们只介绍其中常用的三个，并且它们全都涉及重定向。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e301：它表示所访问资源位置已经发生修改，请访问最新的 URL 。通常它还会附带一个 Location 的头部信息指明重定向的位置。\x3c\/li\x3e\n\x3cli\x3e303：它表示请求的资源已经创建完成，现在你就会被重定位到一个新页面。\x3c\/li\x3e\n\x3cli\x3e307：与 301 类似都是提示当前 URL 不存在。不过区别是，301 的重定向是永久的而 307 可能重定向的只是一个临时性 URL 。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e400 区间\x3c\/h3\x3e\n\x3cp\x3e400 区间的状态码是最多的，而它通常都是表示由于客户端的错误导致请求失败。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e401 和 403：这两个状态码分别表示“未授权”和“禁止”。字面上看两者很类似，但是前者可能表示用户未登录而后者则可能是用户登录了但是权限不够。\x3c\/li\x3e\n\x3cli\x3e404：它表示用户 URL 请求的资源并不存在。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e至于该区间其他状态码，读者可以去\x3ca href=\x22https:\/\/en.wikipedia.org\/wiki\/List_of_HTTP_status_codes\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e维基\x3c\/a\x3e上自行查看，这里就不一一介绍了。另外，当你不确定应该使用哪种客户端错误状态码时，你可以直接使用 400 。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e500 区间\x3c\/h3\x3e\n\x3cp\x3e作为 HTTP 规范里的最后一个区间，500 区间状态码表示的是服务内部出现错误。例如，请求过载或者数据库连接中断。另外，理论上该区间的错误只能有服务内部自己触发。最后，为了防止黑客窥探太多内部信息，你可以对所有的内部错误仅仅返回一个抽象的“内部服务器错误”这样的信息。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader13\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e本章包含的内容有：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e使用 Express 构建 API 服务。\x3c\/li\x3e\n\x3cli\x3eHTTP 方法以及与 CRUD 操作之间的关系。\x3c\/li\x3e\n\x3cli\x3e如果对 API 进行版本控制，提示服务的兼容性和稳定性。\x3c\/li\x3e\n\x3cli\x3eHTTP 状态码的使用和其意义。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cblockquote\x3e\x3cp\x3e原文\x3ca href=\x22https:\/\/bignerdcoding.com\/archives\/47.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e地址\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Express 实战（六）：构建 API 接口</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010820708">https://segmentfault.com/a/1190000010820708</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/bv67m1nmtoq/" target="_blank">https://alili.tech/archive/bv67m1nmtoq/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>