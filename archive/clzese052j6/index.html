<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="js构建离线应用"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>js构建离线应用 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/clzese052j6/",
				"appid": "1613049289050283", 
				"title": "js构建离线应用 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-07T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/pz0oy2gxwu/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/d96eottr8y/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fclzese052j6%2f&text=js%e6%9e%84%e5%bb%ba%e7%a6%bb%e7%ba%bf%e5%ba%94%e7%94%a8"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fclzese052j6%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fclzese052j6%2f&text=js%e6%9e%84%e5%bb%ba%e7%a6%bb%e7%ba%bf%e5%ba%94%e7%94%a8"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fclzese052j6%2f&title=js%e6%9e%84%e5%bb%ba%e7%a6%bb%e7%ba%bf%e5%ba%94%e7%94%a8"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fclzese052j6%2f&is_video=false&description=js%e6%9e%84%e5%bb%ba%e7%a6%bb%e7%ba%bf%e5%ba%94%e7%94%a8"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=js%e6%9e%84%e5%bb%ba%e7%a6%bb%e7%ba%bf%e5%ba%94%e7%94%a8&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fclzese052j6%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fclzese052j6%2f&title=js%e6%9e%84%e5%bb%ba%e7%a6%bb%e7%ba%bf%e5%ba%94%e7%94%a8"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fclzese052j6%2f&title=js%e6%9e%84%e5%bb%ba%e7%a6%bb%e7%ba%bf%e5%ba%94%e7%94%a8"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fclzese052j6%2f&title=js%e6%9e%84%e5%bb%ba%e7%a6%bb%e7%ba%bf%e5%ba%94%e7%94%a8"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fclzese052j6%2f&title=js%e6%9e%84%e5%bb%ba%e7%a6%bb%e7%ba%bf%e5%ba%94%e7%94%a8"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">js构建离线应用</h1><div class="meta"><div class="postdate"><time datetime="2018-12-07" itemprop="datePublished">2018-12-07</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch4\x3e内容主要引用自吴浩麟著《webpack深入浅出》\x3c\/h4\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e离线应用\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22离线应用的优点：\n在没有网络的情况下能打开网页。\n由于部分缓存的资源直接从本地加载，所以对用户来说可以加快网页的加载速度，减少服务器压力。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs\x22\x3e\x3ccode\x3e离线应用的优点：\n在没有网络的情况下能打开网页。\n由于部分缓存的资源直接从本地加载，所以对用户来说可以加快网页的加载速度，减少服务器压力。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e技术实现：\x3c\/h3\x3e\n\x3cp\x3e离线应用的核心是离线缓存技术，历史上曾先后出现两种离线缓存技术。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eAppCache：又叫做Application Cache，目录已经从web标准中删除，尽量不要使用。\x3c\/li\x3e\n\x3cli\x3eService Workers：目前最新的离线缓存技术，是Web Worker的一部分，它通过拦截网络请求实现离线缓存，比                    AppCache更灵活。因为它可以通过js代码去控制缓存的逻辑。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cblockquote\x3e\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3eService Workers\x3c\/h3\x3e\n\x3cblockquote\x3eService Workers是一个在浏览器后台运行的脚本，它的生命周期完全独立于网页，它无法直接访问DOM。它可以通过postMessage接口发送消息来和UI进程通信。   \x3cp\x3e拦截网络功能是Service Workers的重要功能。通过Service Workers能完成离线缓存，编辑响应，过滤响应等功能。\x3c\/p\x3e\n\x3cp\x3e目前Chrome,Firefox,Opera都已经全面支持Service Workers。但只有高版本的Android支持移动端的浏览器。，由于Service Workers无法通过注入Polyfill实现兼容，所以在打算使用它前，请先确认自己的网页的运行场景。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e注：Polyfill：\x3cbr\x3e\x3cem\x3e垫片，就是帮你加一层东西来解决问题，不光是兼容性问题，pollyfill是个概念举个例子，有些旧浏览器不支持Number.isNaN方法，Polyfill就可以是这样的\x3c\/em\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22·if(!Number.isNaN) {\n    Number.isNaN = function(num) {\n        return(num !== num);\n    }\n}·\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e·\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(!\x3cspan class=\x22hljs-built_in\x22\x3eNumber\x3c\/span\x3e.isNaN) {\n    \x3cspan class=\x22hljs-built_in\x22\x3eNumber\x3c\/span\x3e.isNaN = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3enum\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e(num !== num);\n    }\n}·\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e啥意思呢，就是假如浏览器没有Number.isNaN方法，那咱们就给它添加上去，所谓Polyfill就是这样解决API的兼容问题的。\x3cbr\x3e判断浏览器是否支持Service Workers的最简单方法是通过以下代码：\x3cbr\x3eif(navigator.serviceWorker){alert(true)}\x3c\/p\x3e\n\x3cblockquote\x3e\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e注册Service Workers\x3c\/h3\x3e\n\x3cp\x3e要为网页接入Service Workers，需要在网页加载后注册一个描述Service Workers逻辑的脚本，代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22`if(navigator.serviceWorker)\n{\n    window.addEventListener(\x27DOMContentLoaded\x27,function(){\n        navigator.serviceWorker.register(\x27.\/sw.js\x27)\n    })\n}`\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e`\x3cspan class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(navigator.serviceWorker)\n{\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27DOMContentLoaded\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        navigator.serviceWorker.register(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/sw.js\x27\x3c\/span\x3e)\n    })\n}\x3c\/span\x3e`\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e一旦这个脚本文件被加载，Service Workers的安装就开始了，在这个脚本被安装到浏览器中后，\x3cbr\x3e就算是用户关闭了当前网页，它仍会存在，也就是第一次打开该网页时，Service Workers的逻辑不会生效。\x3cbr\x3e因为脚本还没有被加载和注册，但是以后再次打开该网页时脚本里的逻辑将会生效。\x3c\/p\x3e\n\x3cp\x3e在Chrome中可以通过打开网址chrome:\/\/inspect\/#service-workers来查看当前浏览器中所有已注册的Service Workers。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e更新缓存\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22浏览器针对Service Workers有如下机制：\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e浏览器针对Service Workers有如下机制：\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\n\x3cli\x3e每次打开接入了Service Workers的网页时，浏览器都会重新下载Service Workers脚本文件，所以要注意该脚本文件不要太大，如果发现和当前已经注册过的文件存在字节差异，就将其视为“新服务工作线程”。\x3c\/li\x3e\n\x3cli\x3e新的Service Workers线程将会启动，且将会触发其install事件。\x3c\/li\x3e\n\x3cli\x3e当网站上当前打开的页面关闭时，旧的Service Workers线程将会被终止，新的Service Workers线程将会取得控制权。\x3c\/li\x3e\n\x3cli\x3e新的Service Workers线程取得控制权后，将会触发其activate事件。\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e新的Service Workers线程中的activate事件就是清理旧缓存的最佳时间点\x3c\/p\x3e\n\x3cp\x3eService Workers在注册成功后会在其生命周期中派发一些事件，通过监听对应的事件，在特定的时间上做一些事情。\x3c\/p\x3e\n\x3cp\x3e在Service Workers脚本中引入了新的关键字self，代表当前的Service Workers实例。\x3c\/p\x3e\n\x3cp\x3e在Service Workers安装成功后会派发出install事件，需要在这个事件中执行缓存资源的逻辑。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e接入webpack\x3c\/h3\x3e\n\x3cp\x3e用webpack构建接入Service Workers的离线应用时，要解决的问题在于如何生成之前提到的sw.js文件。\x3cbr\x3e并且sw.js文件中的cacheFileList变量，代表需要被缓存文件的URL列表，需要根据输出文件列表所对应的URL来决定。而不是写成静态值。\x3c\/p\x3e\n\x3cp\x3ewebpack没有原生功能可以完成以上需求，可以使用插件serviceworker-webpack-plugin\x3cbr\x3e·\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const ServiceWorkerWebpackPlugin=require(\x27serviceworker-webpack-plugin\x27)\n    new ServiceWorkerWebpackPlugin({\n            \/\/ 自定义的 sw.js 文件所在路径\n            \/\/ ServiceWorkerWebpackPlugin 会把文件列表注入到生成的 sw.js 中\n            entry: path.join(__dirname, \x27sw.js\x27),\n        })\n    devServer: {\n        \/\/Service Workers依赖HTTPS，使用DevServer提供的HTTPS功能。\n        https:true\n    }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cs\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ServiceWorkerWebpackPlugin=require(\x3cspan class=\x22hljs-string\x22\x3e\x27serviceworker-webpack-plugin\x27\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e ServiceWorkerWebpackPlugin({\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 自定义的 sw.js 文件所在路径\x3c\/span\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ServiceWorkerWebpackPlugin 会把文件列表注入到生成的 sw.js 中\x3c\/span\x3e\n            entry: path.\x3cspan class=\x22hljs-keyword\x22\x3ejoin\x3c\/span\x3e(__dirname, \x3cspan class=\x22hljs-string\x22\x3e\x27sw.js\x27\x3c\/span\x3e),\n        })\n    devServer: {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/Service Workers依赖HTTPS，使用DevServer提供的HTTPS功能。\x3c\/span\x3e\n        https:\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n    }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e·\x3cbr\x3e在目录下新建sw.js文件，手动写手更新缓存里的代码，。\x3c\/p\x3e\n\x3cp\x3eserviceworker-webpack-plugin为了保证灵活性，允许使用都自定义sw.js，构建输出的sw.js文件中会在头部注入一个变量serviceWorkerOption.assets到全局，里面存放着所有需要被缓存的文件的URL列表。\x3c\/p\x3e\n\x3cp\x3e需要将sw.js里的文件列表变量写成动态的\x3cbr\x3e·\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var cacheFileList=global.serviceWorkerOption.assets\n\n在main.js代码中注册:\nif (navigator.serviceWorker) {\n    window.addEventListener(\x27DOMContentLoaded\x27,function() {\n        \/\/ 调用 serviceWorker.register 注册，参数 \/sw.js 为脚本文件所在的 URL 路径\n        navigator.serviceWorker.register(\x27sw.js\x27);\n    });\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cacheFileList=global.serviceWorkerOption.assets\n\n在main.js代码中注册:\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (navigator.serviceWorker) {\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27DOMContentLoaded\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 调用 serviceWorker.register 注册，参数 \/sw.js 为脚本文件所在的 URL 路径\x3c\/span\x3e\n        navigator.serviceWorker.register(\x3cspan class=\x22hljs-string\x22\x3e\x27sw.js\x27\x3c\/span\x3e);\n    });\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e·\x3c\/p\x3e\n\x3cp\x3e**\x3cbr\x3e注：使用Service Workers技术需要依赖HTTPS，可以使用DevServer提供的HTTPS功能。DevServer会自动生成一份HTTPS证书。\x3cbr\x3e**\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>js构建离线应用</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000014107047">https://segmentfault.com/a/1190000014107047</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/clzese052j6/" target="_blank">https://alili.tech/archive/clzese052j6/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>