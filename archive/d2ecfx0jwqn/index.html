<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="【前端工程师手册】JavaScript之闭包"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>【前端工程师手册】JavaScript之闭包 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/d2ecfx0jwqn/",
				"appid": "1613049289050283", 
				"title": "【前端工程师手册】JavaScript之闭包 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-01T02:30:12"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/mb1sm7b4gr/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/ai3pem6wrxi/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fd2ecfx0jwqn%2f&text=%e3%80%90%e5%89%8d%e7%ab%af%e5%b7%a5%e7%a8%8b%e5%b8%88%e6%89%8b%e5%86%8c%e3%80%91JavaScript%e4%b9%8b%e9%97%ad%e5%8c%85"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fd2ecfx0jwqn%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fd2ecfx0jwqn%2f&text=%e3%80%90%e5%89%8d%e7%ab%af%e5%b7%a5%e7%a8%8b%e5%b8%88%e6%89%8b%e5%86%8c%e3%80%91JavaScript%e4%b9%8b%e9%97%ad%e5%8c%85"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fd2ecfx0jwqn%2f&title=%e3%80%90%e5%89%8d%e7%ab%af%e5%b7%a5%e7%a8%8b%e5%b8%88%e6%89%8b%e5%86%8c%e3%80%91JavaScript%e4%b9%8b%e9%97%ad%e5%8c%85"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fd2ecfx0jwqn%2f&is_video=false&description=%e3%80%90%e5%89%8d%e7%ab%af%e5%b7%a5%e7%a8%8b%e5%b8%88%e6%89%8b%e5%86%8c%e3%80%91JavaScript%e4%b9%8b%e9%97%ad%e5%8c%85"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e3%80%90%e5%89%8d%e7%ab%af%e5%b7%a5%e7%a8%8b%e5%b8%88%e6%89%8b%e5%86%8c%e3%80%91JavaScript%e4%b9%8b%e9%97%ad%e5%8c%85&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fd2ecfx0jwqn%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fd2ecfx0jwqn%2f&title=%e3%80%90%e5%89%8d%e7%ab%af%e5%b7%a5%e7%a8%8b%e5%b8%88%e6%89%8b%e5%86%8c%e3%80%91JavaScript%e4%b9%8b%e9%97%ad%e5%8c%85"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fd2ecfx0jwqn%2f&title=%e3%80%90%e5%89%8d%e7%ab%af%e5%b7%a5%e7%a8%8b%e5%b8%88%e6%89%8b%e5%86%8c%e3%80%91JavaScript%e4%b9%8b%e9%97%ad%e5%8c%85"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fd2ecfx0jwqn%2f&title=%e3%80%90%e5%89%8d%e7%ab%af%e5%b7%a5%e7%a8%8b%e5%b8%88%e6%89%8b%e5%86%8c%e3%80%91JavaScript%e4%b9%8b%e9%97%ad%e5%8c%85"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fd2ecfx0jwqn%2f&title=%e3%80%90%e5%89%8d%e7%ab%af%e5%b7%a5%e7%a8%8b%e5%b8%88%e6%89%8b%e5%86%8c%e3%80%91JavaScript%e4%b9%8b%e9%97%ad%e5%8c%85"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">【前端工程师手册】JavaScript之闭包</h1><div class="meta"><div class="postdate"><time datetime="2018-12-01" itemprop="datePublished">2018-12-01</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e闭包确实是一个说烂了的概念，校招社招都会被问到，今天总结一番。\x3cbr\x3e先下定义，\x3cstrong\x3e闭包是函数和该函数的词法作用域的组合\x3c\/strong\x3e。其实这个定义是比较教条的，可以直白的理解为闭包是一个函数，且这个函数使用了既没在它内部声明且不是它的参数的变量。\x3cbr\x3e举个栗子，\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3efunction foo() { \n    var a = 2;\n    function bar() { \n        console.log( a );\n    }\n    return bar; \n}\nvar baz = foo();\nbaz(); \/\/ 2\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e按照常理，foo函数在执行完毕之后会销毁掉其内部的变量a，但是bar函数内部保持着对a的引用，所以通过调用foo()把bar的引用赋给了baz，运行baz()依然可以打印出a。在这个栗子里，函数bar以及它对变量a的引用就构成了闭包。\x3c\/p\x3e\n\x3ch2\x3e闭包和作用域\x3c\/h2\x3e\n\x3cp\x3e对于闭包和作用域的关系，我的理解是\x3cstrong\x3e闭包其实就是作用域的延伸\x3c\/strong\x3e。\x3cbr\x3e由于在JavaScript中函数内部可以使用函数外部的变量，所有有时候会不知不觉的产生闭包，假如在上面那个代码片段中，不允许函数内部使用函数外部的变量，闭包也就无从谈起了。\x3c\/p\x3e\n\x3ch2\x3e闭包有什么用？\x3c\/h2\x3e\n\x3cp\x3e\x3cstrong\x3e模拟私有变量和私有方法\x3c\/strong\x3e\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3evar Dog = (function(){\n    var privateVal = \x27dog\x27\n    function doing(val) {\n        console.log(privateVal \x2b \x27 \x27 \x2b val)\n    }\n\n    return {\n        run: function(){\n            doing(\x27run\x27)\n        },\n        bark: function(){\n            doing(\x27bark\x27)\n        }\n    }\n})()\n\nDog.run()    \/\/ dog run\nDog.bark()   \/\/  dog bark\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看到的是，run和bark这两个闭包分享了同一个词法作用域，且都引用了私有方法doing。这样，我们就可以只向外暴露run和bark两个公共接口而隐藏私有的变量和方法。\x3c\/p\x3e\n\x3ch2\x3e闭包与循环\x3c\/h2\x3e\n\x3cp\x3e或许这是面试中出现最多的问题...\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3efor(var i = 1;i \x26lt;= 5;i\x2b\x2b) {\n    setTimeout(function() {\n        console.log(i)\n    }, i*1000)\n}\n\/\/ 每隔一秒打印一个6，共打印5次\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e为什么事与愿违，而不是按照我们所想的依次的间隔1秒打印出1，2，3，4，5呢？首先，这段循环产生了5个\x3cstrong\x3e闭包\x3c\/strong\x3e，而且最重要的是这5个闭包都处在同一个作用域中，也就是说它们引用的是同一个i，当for循环结束时，i变成了6。所以，5个匿名函数执行时会依次的去打印那同一个i，所以就打印出了5个6。\x3cbr\x3e如何解决？\x3cbr\x3e之前也说了让这5个闭包处于不同的作用域且让它们在各自的作用域中拥有它们各自的i即可。\x3cbr\x3e可以使用自执行函数来创建一个新的作用域\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3efor(var i = 1;i \x26lt;= 5;i\x2b\x2b) {\n    (function(k){\n        setTimeout(function() {\n        console.log(k)\n    }, k*1000)\n    })(i)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在这个代码片段中，每一个setTimeout都处于一个独立的作用域中，且都引用了它们各自的k，并不是指向了外层作用域的i，所以就会打印出1，2，3，4，5\x3cbr\x3e也可以使用let\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3efor(let i = 1;i \x26lt;= 5;i\x2b\x2b) {\n    setTimeout(function() {\n        console.log(i)\n    }, i*1000)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3efor 循环头部的 let 不仅将 i 绑定到了 for 循环的块中，事实上它将其重新绑定到了循环的每一个迭代中，确保使用上一个循环迭代结束时的值重新进行赋值。\x3cbr\x3e其实使用let的本质是\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3efor(let i = 1;i \x26lt;= 5;i\x2b\x2b) {\n    let i = 上次迭代结束的i\n    setTimeout(function() {\n        console.log(i)\n    }, i*1000)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其实闭包就这么多东西，而且主要是作用域的概念，作用域明白了，闭包也就明白了。\x3cbr\x3ethat\x27s all, thank you.\x3c\/p\x3e\n\x3cp\x3e参考资料\x3cbr\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/TomXu\/archive\/2012\/01\/31\/2330252.html\x22 rel=\x22nofollow noreferrer\x22\x3e深入理解JavaScript系列-闭包\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Closures\x22 rel=\x22nofollow noreferrer\x22\x3eMDN-闭包\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22https:\/\/book.douban.com\/subject\/26351021\/\x22 rel=\x22nofollow noreferrer\x22\x3e《你不知道的JavaScript-上卷》\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22https:\/\/zhuanlan.zhihu.com\/p\/22486908\x22 rel=\x22nofollow noreferrer\x22\x3e「每日一题」JS 中的闭包是什么？\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>【前端工程师手册】JavaScript之闭包</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000014836484">https://segmentfault.com/a/1190000014836484</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/d2ecfx0jwqn/" target="_blank">https://alili.tech/archive/d2ecfx0jwqn/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>