<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="详解CommonsChunkPlugin的配置和用法"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>详解CommonsChunkPlugin的配置和用法 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/dd9l6mjzw0f/",
				"appid": "1613049289050283", 
				"title": "详解CommonsChunkPlugin的配置和用法 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-17T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/nonz9pxvjrs/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/0xvsbg11whl/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fdd9l6mjzw0f%2f&text=%e8%af%a6%e8%a7%a3CommonsChunkPlugin%e7%9a%84%e9%85%8d%e7%bd%ae%e5%92%8c%e7%94%a8%e6%b3%95"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fdd9l6mjzw0f%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fdd9l6mjzw0f%2f&text=%e8%af%a6%e8%a7%a3CommonsChunkPlugin%e7%9a%84%e9%85%8d%e7%bd%ae%e5%92%8c%e7%94%a8%e6%b3%95"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fdd9l6mjzw0f%2f&title=%e8%af%a6%e8%a7%a3CommonsChunkPlugin%e7%9a%84%e9%85%8d%e7%bd%ae%e5%92%8c%e7%94%a8%e6%b3%95"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fdd9l6mjzw0f%2f&is_video=false&description=%e8%af%a6%e8%a7%a3CommonsChunkPlugin%e7%9a%84%e9%85%8d%e7%bd%ae%e5%92%8c%e7%94%a8%e6%b3%95"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e8%af%a6%e8%a7%a3CommonsChunkPlugin%e7%9a%84%e9%85%8d%e7%bd%ae%e5%92%8c%e7%94%a8%e6%b3%95&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fdd9l6mjzw0f%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fdd9l6mjzw0f%2f&title=%e8%af%a6%e8%a7%a3CommonsChunkPlugin%e7%9a%84%e9%85%8d%e7%bd%ae%e5%92%8c%e7%94%a8%e6%b3%95"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fdd9l6mjzw0f%2f&title=%e8%af%a6%e8%a7%a3CommonsChunkPlugin%e7%9a%84%e9%85%8d%e7%bd%ae%e5%92%8c%e7%94%a8%e6%b3%95"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fdd9l6mjzw0f%2f&title=%e8%af%a6%e8%a7%a3CommonsChunkPlugin%e7%9a%84%e9%85%8d%e7%bd%ae%e5%92%8c%e7%94%a8%e6%b3%95"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fdd9l6mjzw0f%2f&title=%e8%af%a6%e8%a7%a3CommonsChunkPlugin%e7%9a%84%e9%85%8d%e7%bd%ae%e5%92%8c%e7%94%a8%e6%b3%95"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">详解CommonsChunkPlugin的配置和用法</h1><div class="meta"><div class="postdate"><time datetime="2018-12-17" itemprop="datePublished">2018-12-17</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e\x3cstrong\x3e简介\x3c\/strong\x3e\x3c\/h2\x3e\n\x3cp\x3eCommonsChunkPlugin主要是用来提取第三方库和公共模块，避免首屏加载的bundle文件或者按需加载的bundle文件体积过大，从而导致加载时间过长，着实是优化的一把利器。\x3c\/p\x3e\n\x3cp\x3e先来说一下各种教程以及文档中CommonsChunkPlugin提及到chunk有哪几种，主要有以下三种：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3ewebpack当中配置的入口文件（entry）是chunk，可以理解为entry chunk\x3c\/li\x3e\n\x3cli\x3e入口文件以及它的依赖文件通过code split（代码分割）出来的也是chunk，可以理解为children chunk\x3c\/li\x3e\n\x3cli\x3e通过CommonsChunkPlugin创建出来的文件也是chunk，可以理解为commons chunk\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e\n\x3cstrong\x3eCommonsChunkPlugin可配置的属性\x3c\/strong\x3e：\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3ename：可以是已经存在的chunk（一般指入口文件）对应的name，那么就会把公共模块代码合并到这个chunk上；否则，会创建名字为name的commons chunk进行合并\x3c\/li\x3e\n\x3cli\x3efilename：指定commons chunk的文件名\x3c\/li\x3e\n\x3cli\x3echunks：指定source chunk，即指定从哪些chunk当中去找公共模块，省略该选项的时候，默认就是entry chunks\x3c\/li\x3e\n\x3cli\x3eminChunks：既可以是数字，也可以是函数，还可以是Infinity，具体用法和区别下面会说\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3echildren和async属于异步中的应用，放在了最后讲解。\x3c\/p\x3e\n\x3cp\x3e可能这么说，大家会云里雾里，下面用demo来检验上面的属性。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e\x3cstrong\x3e实战应用\x3c\/strong\x3e\x3c\/h2\x3e\n\x3cp\x3e以下几个demo主要是测试以下几种情况：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e不分离出第三方库和自定义公共模块\x3c\/li\x3e\n\x3cli\x3e分离出第三方库、自定义公共模块、webpack运行文件，但它们在同一个文件中\x3c\/li\x3e\n\x3cli\x3e单独分离第三方库、自定义公共模块、webpack运行文件，各自在不同文件\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e\x3cstrong\x3e不分离出第三方库和自定义公共模块\x3c\/strong\x3e\x3c\/h3\x3e\n\x3cp\x3e项目初始结构，后面打包后会生成dist目录：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012828884?w=240\x26amp;h=175\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012828884?w=240\x26amp;h=175\x22 alt=\x22image\x22 title=\x22image\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3esrc目录下各个文件内容都很简洁的，如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22common.js\nexport const common = \x27common file\x27;\n\nfirst.js\nimport {common} from \x27.\/common\x27;\nimport $ from \x27jquery\x27;\nconsole.log($，`first  ${common}`);\n\nsecond.js\nimport {common} from \x27.\/common\x27;\nimport $ from \x27jquery\x27;\nconsole.log($，`second ${common}`);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3ecommon.js\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e common = \x3cspan class=\x22hljs-string\x22\x3e\x27common file\x27\x3c\/span\x3e;\n\nfirst.js\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {common} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/common\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e $ \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27jquery\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log($，\x3cspan class=\x22hljs-string\x22\x3e`first  \x3cspan class=\x22hljs-subst\x22\x3e${common}\x3c\/span\x3e`\x3c\/span\x3e);\n\nsecond.js\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {common} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/common\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e $ \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27jquery\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log($，\x3cspan class=\x22hljs-string\x22\x3e`second \x3cspan class=\x22hljs-subst\x22\x3e${common}\x3c\/span\x3e`\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3epackage.json文件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;name\x26quot;: \x26quot;test\x26quot;,\n  \x26quot;version\x26quot;: \x26quot;1.0.0\x26quot;,\n  \x26quot;description\x26quot;: \x26quot;\x26quot;,\n  \x26quot;main\x26quot;: \x26quot;index.js\x26quot;,\n  \x26quot;scripts\x26quot;: {\n    \x26quot;test\x26quot;: \x26quot;echo \\\x26quot;Error: no test specified\\\x26quot; \x26amp;\x26amp; exit 1\x26quot;,\n    \x26quot;build\x26quot;: \x26quot;rimraf dist \x26amp;\x26amp; webpack\x26quot;\n  },\n  \x26quot;author\x26quot;: \x26quot;\x26quot;,\n  \x26quot;license\x26quot;: \x26quot;ISC\x26quot;,\n  \x26quot;devDependencies\x26quot;: {\n    \x26quot;rimraf\x26quot;: \x26quot;^2.6.2\x26quot;,\n    \x26quot;webpack\x26quot;: \x26quot;^3.10.0\x26quot;,\n    \x26quot;webpack-dev-server\x26quot;: \x26quot;^2.10.1\x26quot;\n  },\n  \x26quot;dependencies\x26quot;: {\n    \x26quot;jquery\x26quot;: \x26quot;^3.2.1\x26quot;\n  }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs json\x22\x3e\x3ccode\x3e{\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22name\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22test\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22version\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x221.0.0\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22description\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22main\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22index.js\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22scripts\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22test\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22echo \\\x22Error: no test specified\\\x22 \x26amp;\x26amp; exit 1\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22build\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22rimraf dist \x26amp;\x26amp; webpack\x22\x3c\/span\x3e\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22author\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22license\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22ISC\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22devDependencies\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22rimraf\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22^2.6.2\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22webpack\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22^3.10.0\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22webpack-dev-server\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22^2.10.1\x22\x3c\/span\x3e\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22dependencies\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22jquery\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22^3.2.1\x22\x3c\/span\x3e\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ewebpack.config.js：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const path = require(\x26quot;path\x26quot;);\nconst webpack = require(\x26quot;webpack\x26quot;);\n\nconst config = {\n    entry: {\n        first: \x27.\/src\/first.js\x27,\n        second: \x27.\/src\/second.js\x27\n    },\n    output: {\n        path: path.resolve(__dirname,\x27.\/dist\x27),\n        filename: \x27[name].js\x27\n    },\n}\n\nmodule.exports = config;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs arduino\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e path = require(\x3cspan class=\x22hljs-string\x22\x3e\x22path\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e webpack = require(\x3cspan class=\x22hljs-string\x22\x3e\x22webpack\x22\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econfig\x3c\/span\x3e = {\n    entry: {\n        first: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/src\/first.js\x27\x3c\/span\x3e,\n        second: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/src\/second.js\x27\x3c\/span\x3e\n    },\n    output: {\n        path: path.resolve(__dirname,\x3cspan class=\x22hljs-string\x22\x3e\x27.\/dist\x27\x3c\/span\x3e),\n        filename: \x3cspan class=\x22hljs-string\x22\x3e\x27[name].js\x27\x3c\/span\x3e\n    },\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e.exports = \x3cspan class=\x22hljs-built_in\x22\x3econfig\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e接着在命令行npm run build，此时项目中多了dist目录：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012828885?w=243\x26amp;h=240\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012828885?w=243\x26amp;h=240\x22 alt=\x22image\x22 title=\x22image\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e再来查看一下命令行中webpack的打包信息：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012828886?w=525\x26amp;h=75\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012828886?w=525\x26amp;h=75\x22 alt=\x22image\x22 title=\x22image\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e查看first.js和second.js，会发现共同引用的common.js文件和jquery都被打包进去了，这肯定不合理，公共模块重复打包，体积过大。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e\x3cstrong\x3e分离出第三方库、自定义公共模块、webpack运行文件\x3c\/strong\x3e\x3c\/h3\x3e\n\x3cp\x3e这时候修改webpack.config.js新增一个入口文件vendor和CommonsChunkPlugin插件进行公共模块的提取：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const path = require(\x26quot;path\x26quot;);\nconst webpack = require(\x26quot;webpack\x26quot;);\nconst packagejson = require(\x26quot;.\/package.json\x26quot;);\n\nconst config = {\n    entry: {\n        first: \x27.\/src\/first.js\x27,\n        second: \x27.\/src\/second.js\x27,\n        vendor: Object.keys(packagejson.dependencies)\/\/获取生产环境依赖的库\n    },\n    output: {\n        path: path.resolve(__dirname,\x27.\/dist\x27),\n        filename: \x27[name].js\x27\n    },\n    plugins: [\n        new webpack.optimize.CommonsChunkPlugin({\n            name: \x27vendor\x27,\n            filename: \x27[name].js\x27\n        }),\n    ]\n}\n\nmodule.exports = config;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e path = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22path\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e webpack = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22webpack\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e packagejson = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22.\/package.json\x22\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e config = {\n    \x3cspan class=\x22hljs-attr\x22\x3eentry\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3efirst\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/src\/first.js\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3esecond\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/src\/second.js\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3evendor\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.keys(packagejson.dependencies)\x3cspan class=\x22hljs-comment\x22\x3e\/\/获取生产环境依赖的库\x3c\/span\x3e\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3eoutput\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: path.resolve(__dirname,\x3cspan class=\x22hljs-string\x22\x3e\x27.\/dist\x27\x3c\/span\x3e),\n        \x3cspan class=\x22hljs-attr\x22\x3efilename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27[name].js\x27\x3c\/span\x3e\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3eplugins\x3c\/span\x3e: [\n        \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.CommonsChunkPlugin({\n            \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27vendor\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3efilename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27[name].js\x27\x3c\/span\x3e\n        }),\n    ]\n}\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = config;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e查看dist目录下，新增了一个vendor.js的文件：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012828887?w=248\x26amp;h=256\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012828887?w=248\x26amp;h=256\x22 alt=\x22image\x22 title=\x22image\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e再来查看一下命令行中webpack的打包信息：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012828888?w=542\x26amp;h=97\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012828888?w=542\x26amp;h=97\x22 alt=\x22image\x22 title=\x22image\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e通过查看vendor.js文件，发现first.js和second.js文件中依赖的jquery和common.js都被打包进vendor.js中，同时还有webpack的运行文件。总的来说，我们初步的目的达到，提取公共模块，但是它们都在同一个文件中。\x3c\/p\x3e\n\x3cp\x3e到这里，肯定有人希望自家的vendor.js纯白无瑕，只包含第三方库，不包含自定义的公共模块和webpack运行文件，又或者希望包含第三方库和公共模块，不包含webpack运行文件。\x3c\/p\x3e\n\x3cp\x3e其实，这种想法是对，特别是分离出webpack运行文件，因为每次打包webpack运行文件都会变，如果你不分离出webpack运行文件，每次打包生成vendor.js对应的哈希值都会变化，导致vendor.js改变，但实际上你的第三方库其实是没有变，然而浏览器会认为你原来缓存的vendor.js就失效，要重新去服务器中获取，其实只是webpack运行文件变化而已，就要人家重新加载，好冤啊~\x3c\/p\x3e\n\x3cp\x3eOK，接下来就针对这种情况来测试。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e\x3cstrong\x3e单独分离出第三方库、自定义公共模块、webpack运行文件\x3c\/strong\x3e\x3c\/h3\x3e\n\x3cp\x3e这里我们分两步走：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e先单独抽离出webpack运行文件\x3c\/li\x3e\n\x3cli\x3e接着单独抽离第三方库和自定义公共模块，这里利用minChunks有两种方法可以完成，往后看就知道了\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch4\x3e\x3cstrong\x3e1、抽离webpack运行文件\x3c\/strong\x3e\x3c\/h4\x3e\n\x3cp\x3e先来抽离webpack运行文件，修改webpack配置文件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22plugins: [\n        new webpack.optimize.CommonsChunkPlugin({\n            name: [\x27vendor\x27,\x27runtime\x27],\n            filename: \x27[name].js\x27\n        }),\n    ]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attribute\x22\x3eplugins\x3c\/span\x3e: [\n        new webpack.optimize.CommonsChunkPlugin({\n            \x3cspan class=\x22hljs-attribute\x22\x3ename\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27vendor\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27runtime\x27\x3c\/span\x3e],\n            \x3cspan class=\x22hljs-attribute\x22\x3efilename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27[name].js\x27\x3c\/span\x3e\n        }),\n    ]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其实上面这段代码，等价于下面这段：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 plugins: [\n        new webpack.optimize.CommonsChunkPlugin({\n            name: \x27vendor\x27,\n            filename: \x27[name].js\x27\n        }),\n        new webpack.optimize.CommonsChunkPlugin({\n            name: \x27runtime\x27,\n            filename: \x27[name].js\x27,\n            chunks: [\x27vendor\x27]\n        }),\n    ]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e \x3cspan class=\x22hljs-attribute\x22\x3eplugins\x3c\/span\x3e: [\n        new webpack.optimize.CommonsChunkPlugin({\n            \x3cspan class=\x22hljs-attribute\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27vendor\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attribute\x22\x3efilename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27[name].js\x27\x3c\/span\x3e\n        }),\n        new webpack.optimize.CommonsChunkPlugin({\n            \x3cspan class=\x22hljs-attribute\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27runtime\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attribute\x22\x3efilename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27[name].js\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attribute\x22\x3echunks\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27vendor\x27\x3c\/span\x3e]\n        }),\n    ]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面两段抽离webpack运行文件代码的意思是创建一个名为runtime的commons chunk进行webpack运行文件的抽离，其中source chunks是vendor.js。\x3c\/p\x3e\n\x3cp\x3e查看dist目录下，新增了一个runtime.js的文件，其实就是webpack的运行文件：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012828889?w=231\x26amp;h=275\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012828889?w=231\x26amp;h=275\x22 alt=\x22image\x22 title=\x22image\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e再来查看一下命令行中webpack的打包信息，你会发现vendor.js的体积已经减小，说明已经把webpack运行文件提取出来了：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012828890?w=566\x26amp;h=112\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012828890?w=566\x26amp;h=112\x22 alt=\x22image\x22 title=\x22image\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e可是，vendor.js中还有自定义的公共模块common.js，人家只想vendor.js拥有项目依赖的第三方库而已（这里是jquery），这个时候把minChunks这个属性引进来。\x3c\/p\x3e\n\x3cp\x3eminChunks可以设置为数字、函数和Infinity，\x3cstrong\x3e默认值是2，并不是官方文档说的入口文件的数量\x3c\/strong\x3e，下面解释下minChunks含义：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e数字：模块被多少个chunk公共引用才被抽取出来成为commons chunk\x3c\/li\x3e\n\x3cli\x3e函数：接受 (module, count) 两个参数，返回一个布尔值，你可以在函数内进行你规定好的逻辑来决定某个模块是否提取成为commons chunk\x3c\/li\x3e\n\x3cli\x3eInfinity：\x3cstrong\x3e只有当入口文件（entry chunks） \x26gt;= 3 才生效，用来在第三方库中分离自定义的公共模块\x3c\/strong\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch4\x3e\x3cstrong\x3e2、抽离第三方库和自定义公共模块\x3c\/strong\x3e\x3c\/h4\x3e\n\x3cp\x3e要在vendor.js中把第三方库单独抽离出来，上面也说到了有两种方法。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e第一种方法\x3c\/strong\x3eminChunks设为Infinity，修改webpack配置文件如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22plugins: [\n        new webpack.optimize.CommonsChunkPlugin({\n            name: [\x27vendor\x27,\x27runtime\x27],\n            filename: \x27[name].js\x27,\n            minChunks: Infinity\n        }),\n        new webpack.optimize.CommonsChunkPlugin({\n            name: \x27common\x27,\n            filename: \x27[name].js\x27,\n            chunks: [\x27first\x27,\x27second\x27]\/\/从first.js和second.js中抽取commons chunk\n        }),\n    ]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attribute\x22\x3eplugins\x3c\/span\x3e: [\n        new webpack.optimize.CommonsChunkPlugin({\n            \x3cspan class=\x22hljs-attribute\x22\x3ename\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27vendor\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27runtime\x27\x3c\/span\x3e],\n            \x3cspan class=\x22hljs-attribute\x22\x3efilename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27[name].js\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attribute\x22\x3eminChunks\x3c\/span\x3e: Infinity\n        }),\n        new webpack.optimize.CommonsChunkPlugin({\n            \x3cspan class=\x22hljs-attribute\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27common\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attribute\x22\x3efilename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27[name].js\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attribute\x22\x3echunks\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27first\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27second\x27\x3c\/span\x3e]\x3cspan class=\x22hljs-comment\x22\x3e\/\/从first.js和second.js中抽取commons chunk\x3c\/span\x3e\n        }),\n    ]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e查看dist目录下，新增了一个common.js的文件：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012828891?w=236\x26amp;h=302\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012828891?w=236\x26amp;h=302\x22 alt=\x22image\x22 title=\x22image\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e再来查看一下命令行中webpack的打包信息，自定义的公共模块分离出来：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012828892?w=563\x26amp;h=140\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012828892?w=563\x26amp;h=140\x22 alt=\x22image\x22 title=\x22image\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e这时候的vendor.js就纯白无瑕，只包含第三方库文件，common.js就是自定义的公共模块，runtime.js就是webpack的运行文件。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e第二种方法\x3c\/strong\x3e把它们分离开来，就是利用minChunks作为函数的时候，说一下minChunks作为函数两个参数的含义：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3emodule：当前chunk及其包含的模块\x3c\/li\x3e\n\x3cli\x3ecount：当前chunk及其包含的模块被引用的次数\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3eminChunks作为函数会遍历每一个入口文件及其依赖的模块，返回一个布尔值，为true代表当前正在处理的文件（module.resource）合并到commons chunk中，为false则不合并。\x3c\/p\x3e\n\x3cp\x3e继续修改我们的webpack配置文件，把vendor入口文件注释掉，用minChunks作为函数实现vendor只包含第三方库，达到和上面一样的效果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const config = {\n    entry: {\n        first: \x27.\/src\/first.js\x27,\n        second: \x27.\/src\/second.js\x27,\n        \/\/vendor: Object.keys(packagejson.dependencies)\/\/获取生产环境依赖的库\n    },\n    output: {\n        path: path.resolve(__dirname,\x27.\/dist\x27),\n        filename: \x27[name].js\x27\n    },\n     plugins: [\n        new webpack.optimize.CommonsChunkPlugin({\n            name: \x27vendor\x27,\n            filename: \x27[name].js\x27,\n            minChunks: function (module,count) {\n                console.log(module.resource,`引用次数${count}`);\n                \/\/\x26quot;有正在处理文件\x26quot; \x2b \x26quot;这个文件是 .js 后缀\x26quot; \x2b \x26quot;这个文件是在 node_modules 中\x26quot;\n                return (\n                    module.resource \x26amp;\x26amp;\n                    \/\\.js$\/.test(module.resource) \x26amp;\x26amp;\n                    module.resource.indexOf(path.join(__dirname, \x27.\/node_modules\x27)) === 0\n                )\n            }\n        }),\n        new webpack.optimize.CommonsChunkPlugin({\n            name: \x27runtime\x27,\n            filename: \x27[name].js\x27,\n            chunks: [\x27vendor\x27]\n        }),\n    ]\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e config = {\n    \x3cspan class=\x22hljs-attr\x22\x3eentry\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3efirst\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/src\/first.js\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3esecond\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/src\/second.js\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/vendor: Object.keys(packagejson.dependencies)\/\/获取生产环境依赖的库\x3c\/span\x3e\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3eoutput\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: path.resolve(__dirname,\x3cspan class=\x22hljs-string\x22\x3e\x27.\/dist\x27\x3c\/span\x3e),\n        \x3cspan class=\x22hljs-attr\x22\x3efilename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27[name].js\x27\x3c\/span\x3e\n    },\n     \x3cspan class=\x22hljs-attr\x22\x3eplugins\x3c\/span\x3e: [\n        \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.CommonsChunkPlugin({\n            \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27vendor\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3efilename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27[name].js\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3eminChunks\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3emodule,count\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.resource,\x3cspan class=\x22hljs-string\x22\x3e`引用次数\x3cspan class=\x22hljs-subst\x22\x3e${count}\x3c\/span\x3e`\x3c\/span\x3e);\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/\x22有正在处理文件\x22 \x2b \x22这个文件是 .js 后缀\x22 \x2b \x22这个文件是在 node_modules 中\x22\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n                    \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.resource \x26amp;\x26amp;\n                    \x3cspan class=\x22hljs-regexp\x22\x3e\/\\.js$\/\x3c\/span\x3e.test(\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.resource) \x26amp;\x26amp;\n                    \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.resource.indexOf(path.join(__dirname, \x3cspan class=\x22hljs-string\x22\x3e\x27.\/node_modules\x27\x3c\/span\x3e)) === \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n                )\n            }\n        }),\n        \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.CommonsChunkPlugin({\n            \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27runtime\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3efilename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27[name].js\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3echunks\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27vendor\x27\x3c\/span\x3e]\n        }),\n    ]\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面的代码其实就是生成一个叫做vendor的commons chunk，那么有哪些模块会被加入到vendor中呢？就对入口文件及其依赖的模块进行遍历，如果该模块是js文件并且在node_modules中，就会加入到vendor当中，其实这也是一种让vendor只保留第三方库的办法。\x3c\/p\x3e\n\x3cp\x3e再来查看一下命令行中webpack的打包信息：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012828893?w=762\x26amp;h=294\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012828893?w=762\x26amp;h=294\x22 alt=\x22image\x22 title=\x22image\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e你会发现，和上面minChunks设为Infinity的结果是一致的。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e\x3cstrong\x3echildren和async属性\x3c\/strong\x3e\x3c\/h2\x3e\n\x3cp\x3e这两个属性主要是在code split（代码分割）和异步加载当中应用。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3echildren\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e指定为true的时候，就代表source chunks是通过entry chunks（入口文件）进行code split出来的children chunks\x3c\/li\x3e\n\x3cli\x3e\x3cstrong\x3echildren和chunks不能同时设置，因为它们都是指定source chunks的\x3c\/strong\x3e\x3c\/li\x3e\n\x3cli\x3echildren 可以用来把 entry chunk 创建的 children chunks 的共用模块合并到自身，但这会导致初始加载时间较长\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3easync：即解决children:true时合并到entry chunks自身时初始加载时间过长的问题。async设为true时，commons chunk 将不会合并到自身，而是使用一个新的异步的commons chunk。当这个children chunk 被下载时，自动并行下载该commons chunk\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e修改webpack配置文件，增加chunkFilename，如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 output: {\n        ...........\n        chunkFilename: \x26quot;[name].[hash:5].chunk.js\x26quot;,\n    },\nplugins: [\n    new webpack.optimize.CommonsChunkPlugin({\n        name: [\x27vendor\x27,\x27runtime\x27],\n        filename: \x27[name].js\x27,\n        minChunks: Infinity\n    }),\n   new webpack.optimize.CommonsChunkPlugin({\n        children: true,\n        async: \x27children-async\x27\n    })\n]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e \x3cspan class=\x22hljs-attribute\x22\x3eoutput\x3c\/span\x3e: {\n        ...........\n        \x3cspan class=\x22hljs-attribute\x22\x3echunkFilename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22[name].[hash:5].chunk.js\x22\x3c\/span\x3e,\n    },\n\x3cspan class=\x22hljs-attribute\x22\x3eplugins\x3c\/span\x3e: [\n    new webpack.optimize.CommonsChunkPlugin({\n        \x3cspan class=\x22hljs-attribute\x22\x3ename\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27vendor\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27runtime\x27\x3c\/span\x3e],\n        \x3cspan class=\x22hljs-attribute\x22\x3efilename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27[name].js\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attribute\x22\x3eminChunks\x3c\/span\x3e: Infinity\n    }),\n   new webpack.optimize.CommonsChunkPlugin({\n        \x3cspan class=\x22hljs-attribute\x22\x3echildren\x3c\/span\x3e: true,\n        \x3cspan class=\x22hljs-attribute\x22\x3easync\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27children-async\x27\x3c\/span\x3e\n    })\n]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3echunkFilename用来指定异步加载的模块名字，异步加载模块中的共同引用到的模块就会被合并到async中指定名字，上面就是children-async。\x3c\/p\x3e\n\x3cp\x3e修改成异步截图出来太麻烦了，就简单说明一下：first和second是异步加载模块，同时它们共同引用了common.js这个模块，如果你不设置这一步：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 new webpack.optimize.CommonsChunkPlugin({\n        children: true,\n        async: \x27children-async\x27\n    })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3ewebpack\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.optimize\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.CommonsChunkPlugin\x3c\/span\x3e({\n        \x3cspan class=\x22hljs-attribute\x22\x3echildren\x3c\/span\x3e: true,\n        async: \x3cspan class=\x22hljs-string\x22\x3e\x27children-async\x27\x3c\/span\x3e\n    })\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e那么共同引用的common.js都被打包进各自的模块当中，就重复打包了。\x3c\/p\x3e\n\x3cp\x3eOK，你设置之后，也得看children的脸色怎么来划分：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3echildren为true，共同引用的模块就会被打包合并到名为children-async的公共模块，当你懒加载first或者second的时候并行加载这和children-async公共模块\x3c\/li\x3e\n\x3cli\x3echildren为false，共同引用的模块就会被打包到首屏加载的app.bundle当中，这就会导致首屏加载过长了，而且也不要用到，所以最好还是设为true\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e\x3cstrong\x3e浏览器缓存的实现\x3c\/strong\x3e\x3c\/h2\x3e\n\x3cp\x3e先来说一下哈希值的不同：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3ehash 是 build-specific ，即每次编译都不同——适用于开发阶段\x3c\/li\x3e\n\x3cli\x3echunkhash 是 chunk-specific，是根据每个 chunk 的内容计算出的 hash——适用于生产\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e所以，在生产环境，要把文件名改成\x27[name].[chunkhash]\x27，最大限度的利用浏览器缓存。\x3c\/p\x3e\n\x3cp\x3e最后，写这篇文章，自己测试了很多demo，当然不可能全部贴上，但还是希望自己多动手测试以下，真的坑中带坑。\x3c\/p\x3e\n\x3cp\x3e也参考了很多文章：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/creeperyang\/blog\/issues\/37\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/creeperyan...\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/segmentfault.com\/q\/1010000008726439\/revision\x22\x3ehttps:\/\/segmentfault.com\/q\/10...\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/segmentfault.com\/q\/1010000009070061\x22 target=\x22_blank\x22\x3ehttps:\/\/segmentfault.com\/q\/10...\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/www.jianshu.com\/p\/2b81262898a4\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/www.jianshu.com\/p\/2b8...\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>详解CommonsChunkPlugin的配置和用法</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000012828879">https://segmentfault.com/a/1190000012828879</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/dd9l6mjzw0f/" target="_blank">https://alili.tech/archive/dd9l6mjzw0f/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>