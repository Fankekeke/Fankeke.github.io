<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="如何写出简洁、优雅、可维护的组件。"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>如何写出简洁、优雅、可维护的组件。 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/df8a7ban3w/",
				"appid": "1613049289050283", 
				"title": "如何写出简洁、优雅、可维护的组件。 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-31T02:30:29"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/iff1dnsnyl/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/0c9la8y5nnub/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fdf8a7ban3w%2f&text=%e5%a6%82%e4%bd%95%e5%86%99%e5%87%ba%e7%ae%80%e6%b4%81%e3%80%81%e4%bc%98%e9%9b%85%e3%80%81%e5%8f%af%e7%bb%b4%e6%8a%a4%e7%9a%84%e7%bb%84%e4%bb%b6%e3%80%82"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fdf8a7ban3w%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fdf8a7ban3w%2f&text=%e5%a6%82%e4%bd%95%e5%86%99%e5%87%ba%e7%ae%80%e6%b4%81%e3%80%81%e4%bc%98%e9%9b%85%e3%80%81%e5%8f%af%e7%bb%b4%e6%8a%a4%e7%9a%84%e7%bb%84%e4%bb%b6%e3%80%82"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fdf8a7ban3w%2f&title=%e5%a6%82%e4%bd%95%e5%86%99%e5%87%ba%e7%ae%80%e6%b4%81%e3%80%81%e4%bc%98%e9%9b%85%e3%80%81%e5%8f%af%e7%bb%b4%e6%8a%a4%e7%9a%84%e7%bb%84%e4%bb%b6%e3%80%82"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fdf8a7ban3w%2f&is_video=false&description=%e5%a6%82%e4%bd%95%e5%86%99%e5%87%ba%e7%ae%80%e6%b4%81%e3%80%81%e4%bc%98%e9%9b%85%e3%80%81%e5%8f%af%e7%bb%b4%e6%8a%a4%e7%9a%84%e7%bb%84%e4%bb%b6%e3%80%82"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%a6%82%e4%bd%95%e5%86%99%e5%87%ba%e7%ae%80%e6%b4%81%e3%80%81%e4%bc%98%e9%9b%85%e3%80%81%e5%8f%af%e7%bb%b4%e6%8a%a4%e7%9a%84%e7%bb%84%e4%bb%b6%e3%80%82&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fdf8a7ban3w%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fdf8a7ban3w%2f&title=%e5%a6%82%e4%bd%95%e5%86%99%e5%87%ba%e7%ae%80%e6%b4%81%e3%80%81%e4%bc%98%e9%9b%85%e3%80%81%e5%8f%af%e7%bb%b4%e6%8a%a4%e7%9a%84%e7%bb%84%e4%bb%b6%e3%80%82"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fdf8a7ban3w%2f&title=%e5%a6%82%e4%bd%95%e5%86%99%e5%87%ba%e7%ae%80%e6%b4%81%e3%80%81%e4%bc%98%e9%9b%85%e3%80%81%e5%8f%af%e7%bb%b4%e6%8a%a4%e7%9a%84%e7%bb%84%e4%bb%b6%e3%80%82"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fdf8a7ban3w%2f&title=%e5%a6%82%e4%bd%95%e5%86%99%e5%87%ba%e7%ae%80%e6%b4%81%e3%80%81%e4%bc%98%e9%9b%85%e3%80%81%e5%8f%af%e7%bb%b4%e6%8a%a4%e7%9a%84%e7%bb%84%e4%bb%b6%e3%80%82"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fdf8a7ban3w%2f&title=%e5%a6%82%e4%bd%95%e5%86%99%e5%87%ba%e7%ae%80%e6%b4%81%e3%80%81%e4%bc%98%e9%9b%85%e3%80%81%e5%8f%af%e7%bb%b4%e6%8a%a4%e7%9a%84%e7%bb%84%e4%bb%b6%e3%80%82"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">如何写出简洁、优雅、可维护的组件。</h1><div class="meta"><div class="postdate"><time datetime="2018-12-31" itemprop="datePublished">2018-12-31</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e最近开始维护项目，然后我发现每天的时间常常是花在修改几个小功能上，改了问题有出了另一个问题，思考哪里不对?，然后这么一天就过去了。。然后我就开始思考标题好让我的时间不总是花在修改上，下面的是我最近的一些总结。\x3c\/p\x3e\n\x3chr\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e功能分离\x3c\/h2\x3e\n\x3cp\x3e这个算是面向对象里的思想，在组件里，有很多功能是独立的，比如最常见的发送验证码，确认密码等。把这些逻辑封装成一个或几个函数写在组件里的话，这在组件很小的时候没有什么影响，但是当组件功能比较复杂的时候，就会有些问题：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e组件逻辑区域会变的很大，各种方法混杂很难一眼辨识\x3c\/li\x3e\n\x3cli\x3e因为定义功能需要的变量和方法不在一起，导致修改麻烦\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e功能分离就是把这些功能抽离出来，写出一个类，然后在组件里引入。\x3c\/p\x3e\n\x3cp\x3e下面是一个简单的弹窗控制的功能的类和这个类的使用：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export class DialogCtrl {\n  isVisible = false;\n\n  open () {\n    this.isVisible = true;\n  }\n  close () {\n    this.isVisible = false;\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3eexport \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eDialogCtrl\x3c\/span\x3e \x3c\/span\x3e{\n  isVisible = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n\n  \x3cspan class=\x22hljs-keyword\x22\x3eopen\x3c\/span\x3e () {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.isVisible = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n  }\n  close () {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.isVisible = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后在需要的组件里引入并实例化：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22DialogCtrl = new this.CommonService.DialogCtrl();  \/\/ 是否打开弹窗\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eDialogCtrl = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.CommonService.DialogCtrl();  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 是否打开弹窗\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在html里可以直接这样用：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cnz-modal\n    [nzVisible]=\x26quot;DialogCtrl.isVisible\x26quot; \n    [nzTitle]=\x26quot;\x27更新密码\x27\x26quot; \n    [nzContent]=\x26quot;modalContent\x26quot; \n    (nzOnCancel)=\x26quot;DialogCtrl.close()\x26quot; \n    [nzConfirmLoading]=\x26quot;isSubmiting\x26quot;\n    nzOkText=\x26quot;保存\x26quot;\n    (nzOnOk)=\x26quot;savePassword()\x26quot;\x3e\x3c\/nz-modal\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs accesslog\x22\x3e\x3ccode\x3e\x26lt;nz-modal\n    \x3cspan class=\x22hljs-string\x22\x3e[nzVisible]\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22DialogCtrl.isVisible\x22\x3c\/span\x3e \n    \x3cspan class=\x22hljs-string\x22\x3e[nzTitle]\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\x27更新密码\x27\x22\x3c\/span\x3e \n    \x3cspan class=\x22hljs-string\x22\x3e[nzContent]\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22modalContent\x22\x3c\/span\x3e \n    (nzOnCancel)=\x3cspan class=\x22hljs-string\x22\x3e\x22DialogCtrl.close()\x22\x3c\/span\x3e \n    \x3cspan class=\x22hljs-string\x22\x3e[nzConfirmLoading]\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22isSubmiting\x22\x3c\/span\x3e\n    nzOkText=\x3cspan class=\x22hljs-string\x22\x3e\x22保存\x22\x3c\/span\x3e\n    (nzOnOk)=\x3cspan class=\x22hljs-string\x22\x3e\x22savePassword()\x22\x3c\/span\x3e\x26gt;\x26lt;\/nz-modal\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个nz-modal是一个弹窗，在组件里我们只有一个变量的声明，如此简洁！而在html里DialogCtrl.isVisible，DialogCtrl.close()的形式也很容易理解它的作用和出处。\x3c\/p\x3e\n\x3cp\x3e这样做的另一个好处是利于实现复用。对于可以复用的功能，比如上面发送验证码的逻辑，可以建一个全局的服务来提供。在angular里，通过angular的服务和依赖注入可以很轻松的实现，这里是我集中功能的common.service.ts服务文件：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVVxMN?w=212\x26amp;h=133\x22 src=\x22https:\/\/static.alili.tech\/img\/bVVxMN?w=212\x26amp;h=133\x22 alt=\x22common.service.ts\x22 title=\x22common.service.ts\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3ecommon.servide.ts文件:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@Injectable()\nexport class CommonService {\n  \/\/ 功能类集合\n  public DialogCtrl = DialogCtrl;\n  public MessageCodeCtrl = MessageCodeCtrl;\n  public CheckPasswordCtrl = CheckPasswordCtrl;\n\n  constructor(\n    private http: HttpClient\n  ) { }\n\n  \/* 获取短信验证码(这些功能需要用到的方法)\n  -------------------------- *\/\n  public getVerificationCode (phoneNum: string): Observable\x3cany\x3e {\n    return this.http.get(\x27\/account\/short_message?phoneNumber=\x27 \x2b phoneNum);\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-meta\x22\x3e@Injectable()\x3c\/span\x3e\nexport \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eCommonService\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 功能类集合\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e DialogCtrl = DialogCtrl;\n  \x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e MessageCodeCtrl = MessageCodeCtrl;\n  \x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e CheckPasswordCtrl = CheckPasswordCtrl;\n\n  \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e(\n    \x3cspan class=\x22hljs-keyword\x22\x3eprivate\x3c\/span\x3e http: HttpClient\n  ) { }\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/* 获取短信验证码(这些功能需要用到的方法)\n  -------------------------- *\/\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e getVerificationCode (phoneNum: string): Observable\x26lt;any\x26gt; {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.http.\x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27\/account\/short_message?phoneNumber=\x27\x3c\/span\x3e \x2b phoneNum);\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e需要的地方只要注入这个服务就可以获取想要的功能。相比较直接建立一个组件来实现，我觉得这样写有一些优势：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e灵活性更高。写成组件会有样式的限制，而这样写没有。\x3c\/li\x3e\n\x3cli\x3e更简洁。写成组件，与之沟通只能通过子父组件的传入变量，监听子组件事件的方法，你使用的组件不可避免的会多出这些变量和方法。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e状态管理\x3c\/h2\x3e\n\x3cp\x3e不知道大伙儿有没有这样的感觉，自己写新项目的时候觉得逻辑清晰，代码简练，功能也都实现了，但是过一段时间去看或者要改自己的代码的时候...哇，看不懂。\x3c\/p\x3e\n\x3cp\x3e前端复杂的地方源于数不清的状态，于是我为那些有复杂状态的组件建立一个集中管理状态的对象(这里我取名为Impure)：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  \/* 变量定义 -- 状态\n  -------------------------- *\/\n  registerForm: FormGroup;  \/\/ 注册账号表单\n  registerInfoForm: FormGroup; \/\/ 公司信息表单\n  isSubmitting = false; \/\/ 表单是否正在提交\n  nowForm = \x27registerForm\x27;  \/\/ 当前正在操作的表单\n  MessageCodeCtrl = new this.CommonService.MessageCodeCtrl(this.Msg, this.CommonService); \/\/ 验证码控制\n\n  \/* 变量定义 -- 定值\n  -------------------------- *\/\n  registerFormSubmitAttr = [\x27login\x27, \x27password\x27, \x27shortMessageCode\x27, \x27roles\x27, \x27langKey\x27];\n  registerInfoFormFormSubmitAttr = [\x27simName\x27, \x27contacter\x27, \x27officeTel\x27, \x27uid\x27];\n\n  \/* 改变状态事件\n  -------------------------- *\/\n  Impure = {\n\n    \/\/ 表单初始化\n    RegisterFormInit: () =\x3e this.registerForm = this.registerFormInit(),\n    RegisterInfoFormInit: () =\x3e this.registerInfoForm = this.registerInfoFormInit(),\n\n    \/\/ 验证码不合法\n    MessageCodeInvalid: {\n      notSend: () =\x3e this.Msg.error(\x27您还未发送验证码\x27),\n      notRight: () =\x3e this.Msg.error(\x27验证码错误\x27)\n    },\n\n    \/\/ 表单提交\n    FormSubmit: {\n      invalid: () =\x3e this.Msg.error(\x27表单填写有误\x27),\n      before: () =\x3e this.isSubmitting = true,\n      registerOk: () =\x3e {\n        this.Msg.success(\x27账号注册成功\x27);\n        this.nowForm = \x27registerInfoForm\x27;\n      },\n      registerInfoOk: () =\x3e {\n        this.Msg.success(\x27保存信息成功!请耐心等待管理员审核\x27);\n        this.Router.navigate([\x27\/login\x27]);\n      },\n      fail: () =\x3e this.Msg.error(\x27提交失败，请重试\x27),\n      after: () =\x3e this.isSubmitting = false\n    }\n  };\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/* 变量定义 -- 状态\n  -------------------------- *\/\x3c\/span\x3e\n  registerForm: FormGroup;  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 注册账号表单\x3c\/span\x3e\n  registerInfoForm: FormGroup; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 公司信息表单\x3c\/span\x3e\n  isSubmitting = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 表单是否正在提交\x3c\/span\x3e\n  nowForm = \x3cspan class=\x22hljs-string\x22\x3e\x27registerForm\x27\x3c\/span\x3e;  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 当前正在操作的表单\x3c\/span\x3e\n  MessageCodeCtrl = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.CommonService.MessageCodeCtrl(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Msg, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.CommonService); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 验证码控制\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/* 变量定义 -- 定值\n  -------------------------- *\/\x3c\/span\x3e\n  registerFormSubmitAttr = [\x3cspan class=\x22hljs-string\x22\x3e\x27login\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27password\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27shortMessageCode\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27roles\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27langKey\x27\x3c\/span\x3e];\n  registerInfoFormFormSubmitAttr = [\x3cspan class=\x22hljs-string\x22\x3e\x27simName\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27contacter\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27officeTel\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27uid\x27\x3c\/span\x3e];\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/* 改变状态事件\n  -------------------------- *\/\x3c\/span\x3e\n  Impure = {\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 表单初始化\x3c\/span\x3e\n    RegisterFormInit: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.registerForm = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.registerFormInit(),\n    \x3cspan class=\x22hljs-attr\x22\x3eRegisterInfoFormInit\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.registerInfoForm = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.registerInfoFormInit(),\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 验证码不合法\x3c\/span\x3e\n    MessageCodeInvalid: {\n      \x3cspan class=\x22hljs-attr\x22\x3enotSend\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Msg.error(\x3cspan class=\x22hljs-string\x22\x3e\x27您还未发送验证码\x27\x3c\/span\x3e),\n      \x3cspan class=\x22hljs-attr\x22\x3enotRight\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Msg.error(\x3cspan class=\x22hljs-string\x22\x3e\x27验证码错误\x27\x3c\/span\x3e)\n    },\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 表单提交\x3c\/span\x3e\n    FormSubmit: {\n      \x3cspan class=\x22hljs-attr\x22\x3einvalid\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Msg.error(\x3cspan class=\x22hljs-string\x22\x3e\x27表单填写有误\x27\x3c\/span\x3e),\n      \x3cspan class=\x22hljs-attr\x22\x3ebefore\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.isSubmitting = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3eregisterOk\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Msg.success(\x3cspan class=\x22hljs-string\x22\x3e\x27账号注册成功\x27\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.nowForm = \x3cspan class=\x22hljs-string\x22\x3e\x27registerInfoForm\x27\x3c\/span\x3e;\n      },\n      \x3cspan class=\x22hljs-attr\x22\x3eregisterInfoOk\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Msg.success(\x3cspan class=\x22hljs-string\x22\x3e\x27保存信息成功!请耐心等待管理员审核\x27\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Router.navigate([\x3cspan class=\x22hljs-string\x22\x3e\x27\/login\x27\x3c\/span\x3e]);\n      },\n      \x3cspan class=\x22hljs-attr\x22\x3efail\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Msg.error(\x3cspan class=\x22hljs-string\x22\x3e\x27提交失败，请重试\x27\x3c\/span\x3e),\n      \x3cspan class=\x22hljs-attr\x22\x3eafter\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.isSubmitting = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n    }\n  };\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这是一个简单的有两个表单的注册组件，因为两个表单html耦合度很高，所以写在了一起。\x3c\/p\x3e\n\x3cp\x3e在组件内将变量分为状态和定值的两类，声明了一个Impure对象来集中管理这些状态，原则上这个组件里所有状态的改变都写在Impure里，而将事件触发的判断条件，数据处理写在Impure外面。\x3c\/p\x3e\n\x3cp\x3e可以对比下这两个使用Impure和不使用Impure的表单提交方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  \/* 注册账号表单提交(Impure)\n  -------------------------- *\/\n  async register (form) {\n    const _ = this.Fp._; \/\/ ramda库,用于数据处理\n    const { MessageCodeInvalid, FormSubmit } = this.Impure;\n\n    \/\/ 表单不合法\n    if (form.invalid) { FormSubmit.invalid(); return; }\n\n    \/\/ 验证码不合法\n    if (!this.MessageCodeCtrl.code) { MessageCodeInvalid.notSend(); return; }\n    if (this.MessageCodeCtrl.code !== form.controls.shortMessageCode.value) { MessageCodeInvalid.notRight(); return; }\n\n    \/\/ 表单提交\n    FormSubmit.before();\n    const data = _.compose(_.pick(this.registerFormSubmitAttr), _.map(_.prop(\x27value\x27)))(form.controls); \/\/ 数据处理\n    const res = await this.AccountService.producerRegisterFirst(data).toPromise();\n    if (!res) { FormSubmit.registerOk(); } else { FormSubmit.fail(); }\n    FormSubmit.after();\n  }\n\n  \/* 公司信息表单提交(非Impure)\n  -------------------------- *\/\n  async registerInfo ({ simName, contacter, officeTel }) {\n    \/\/ 表单不合法\n    if (this.registerInfoForm.invalid) { this.Msg.error(\x27表单填写有误\x27); return; }\n\n    \/\/ 表单提交\n    this.isSubmitting = true;\n    const data = { \/\/ 数据处理\n      simName: simName.value,\n      contacter: contacter.value,\n      officeTel: officeTel.value,\n      uid: this.registerForm.controls.phone.value\n    };\n    const res = await this.AccountService.producerRegisterSecond(data).toPromise();\n    if (!res) {\n      this.Msg.success(\x27保存信息成功!请耐心等待管理员审核\x27);\n      this.Router.navigate([\x27\/login\x27]);\n    } else {\n      this.Msg.error(\x27提交失败，请重试\x27);\n    }\n    this.isSubmitting = false;\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/* 注册账号表单提交(Impure)\n  -------------------------- *\/\x3c\/span\x3e\n  async register (form) {\n    const _ = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Fp._; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ramda库,用于数据处理\x3c\/span\x3e\n    const { MessageCodeInvalid, FormSubmit } = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Impure;\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 表单不合法\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (form.invalid) { FormSubmit.invalid(); \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e; }\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 验证码不合法\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.MessageCodeCtrl.code) { MessageCodeInvalid.notSend(); \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e; }\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.MessageCodeCtrl.code !== form.controls.shortMessageCode.value) { MessageCodeInvalid.notRight(); \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e; }\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 表单提交\x3c\/span\x3e\n    FormSubmit.before();\n    const \x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e = _.compose(_.pick(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.registerFormSubmitAttr), _.map(_.prop(\x3cspan class=\x22hljs-string\x22\x3e\x27value\x27\x3c\/span\x3e)))(form.controls); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 数据处理\x3c\/span\x3e\n    const res = await \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.AccountService.producerRegisterFirst(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e).toPromise();\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!res) { FormSubmit.registerOk(); } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e { FormSubmit.fail(); }\n    FormSubmit.after();\n  }\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/* 公司信息表单提交(非Impure)\n  -------------------------- *\/\x3c\/span\x3e\n  async registerInfo ({ simName, contacter, officeTel }) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 表单不合法\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.registerInfoForm.invalid) { \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Msg.error(\x3cspan class=\x22hljs-string\x22\x3e\x27表单填写有误\x27\x3c\/span\x3e); \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e; }\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 表单提交\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.isSubmitting = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n    const \x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e = { \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 数据处理\x3c\/span\x3e\n      simName: simName.value,\n      contacter: contacter.value,\n      officeTel: officeTel.value,\n      uid: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.registerForm.controls.phone.value\n    };\n    const res = await \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.AccountService.producerRegisterSecond(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e).toPromise();\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!res) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Msg.success(\x3cspan class=\x22hljs-string\x22\x3e\x27保存信息成功!请耐心等待管理员审核\x27\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Router.navigate([\x3cspan class=\x22hljs-string\x22\x3e\x27\/login\x27\x3c\/span\x3e]);\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Msg.error(\x3cspan class=\x22hljs-string\x22\x3e\x27提交失败，请重试\x27\x3c\/span\x3e);\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.isSubmitting = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e使用Impure管理状态后，逻辑清晰，在提交表单时你\x3cem\x3e只需要关注事件发生的条件\x3c\/em\x3e就可以了，而第二个条件和状态写在一起会很混乱，不能一眼清楚这个状态改变发生在什么时候，特别是你一段时间再来看的时候。\x3c\/p\x3e\n\x3cp\x3e其实这里的数据处理(这里面的data)应该单独拿出来写一个方法的，我只是来顶一下用纯函数来处理数据的优点，这里的_是用了ramda这个库。相比较第二个处理方式，第一种方式更加优雅，简洁，很容易看出数据的源头是什么(这里是form.controls),单独抽离成数据处理函数也有很高的复用性。\x3c\/p\x3e\n\x3cp\x3e假如某一天你要改下这里两个表格的成功后的状态，不再需要到这两个长长的提交函数里找到它们然后一个一个改，只要在Impure里面改就可以了，你甚至不需要看那两个提交的方法。\x3c\/p\x3e\n\x3cp\x3e这样子，一个组件可以大致分为状态，状态管理(impure)，改变状态的事件(状态改变的判断条件)，和数据处理(纯函数)四部分，各司其职，很好维护。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e结语\x3c\/h2\x3e\n\x3cp\x3e这些适合我但不一定适合所有人，每个人都有自己的风格，各位看官感受下就好。以后我有其它方面的总结也会拿出来分享。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>如何写出简洁、优雅、可维护的组件。</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011294511">https://segmentfault.com/a/1190000011294511</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/df8a7ban3w/" target="_blank">https://alili.tech/archive/df8a7ban3w/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>