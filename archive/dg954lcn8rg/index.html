<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="【30分钟学完】canvas动画|游戏基础(4)：边界与碰撞"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>【30分钟学完】canvas动画|游戏基础(4)：边界与碰撞 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/dg954lcn8rg/",
				"appid": "1613049289050283", 
				"title": "【30分钟学完】canvas动画|游戏基础(4)：边界与碰撞 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-08T02:30:30"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/42ml7q7htu6/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/kgu346mk19/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fdg954lcn8rg%2f&text=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%284%29%ef%bc%9a%e8%be%b9%e7%95%8c%e4%b8%8e%e7%a2%b0%e6%92%9e"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fdg954lcn8rg%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fdg954lcn8rg%2f&text=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%284%29%ef%bc%9a%e8%be%b9%e7%95%8c%e4%b8%8e%e7%a2%b0%e6%92%9e"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fdg954lcn8rg%2f&title=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%284%29%ef%bc%9a%e8%be%b9%e7%95%8c%e4%b8%8e%e7%a2%b0%e6%92%9e"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fdg954lcn8rg%2f&is_video=false&description=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%284%29%ef%bc%9a%e8%be%b9%e7%95%8c%e4%b8%8e%e7%a2%b0%e6%92%9e"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%284%29%ef%bc%9a%e8%be%b9%e7%95%8c%e4%b8%8e%e7%a2%b0%e6%92%9e&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fdg954lcn8rg%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fdg954lcn8rg%2f&title=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%284%29%ef%bc%9a%e8%be%b9%e7%95%8c%e4%b8%8e%e7%a2%b0%e6%92%9e"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fdg954lcn8rg%2f&title=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%284%29%ef%bc%9a%e8%be%b9%e7%95%8c%e4%b8%8e%e7%a2%b0%e6%92%9e"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fdg954lcn8rg%2f&title=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%284%29%ef%bc%9a%e8%be%b9%e7%95%8c%e4%b8%8e%e7%a2%b0%e6%92%9e"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fdg954lcn8rg%2f&title=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%284%29%ef%bc%9a%e8%be%b9%e7%95%8c%e4%b8%8e%e7%a2%b0%e6%92%9e"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">【30分钟学完】canvas动画|游戏基础(4)：边界与碰撞</h1><div class="meta"><div class="postdate"><time datetime="2018-12-08" itemprop="datePublished">2018-12-08</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e前言\x3c\/h2\x3e\n\x3cp\x3e本系列前几篇中常出现物体跑到画布外的情况，本篇就是为了解决这个问题。  \x3cbr\x3e阅读本篇前请先打好前面的基础。  \x3cbr\x3e本人能力有限，欢迎牛人共同讨论，批评指正。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e越界检测\x3c\/h2\x3e\n\x3cp\x3e假定物体是个圆形，如图其圆心坐标即是物体的x轴和y轴坐标。  \x3cbr\x3e越界是常见的场景，一般会有两种场景的越界：一是整个物体移出区域，二是物体接触到区域边界。我们以画布边界为例进行讨论，示例中矩形边界即是：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let top = 0;\nlet bottom = canvas.height;\nlet left = 0;\nlet right = canvas.width;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e top = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e bottom = canvas.height;\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e left = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e right = canvas.width;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV6UUr?w=1044\x26amp;h=536\x22 src=\x22https:\/\/static.alili.tech\/img\/bV6UUr?w=1044\x26amp;h=536\x22 alt=\x22边界\x22 title=\x22边界\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e整个物体移出区域\x3c\/h3\x3e\n\x3cp\x3e要整个物体离开范围才算越界，则可得越界条件如下，以下任何一项为true即可判定越界。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 右侧越界\nobject.x - object.width\/2 \x3e right\n\/\/ 左侧越界\nobject.x \x2b object.width\/2 \x3c left\n\/\/ 上部越界\nobject.y \x2b object.height\/2 \x3c top\n\/\/ 下部越界\nobject.y - object.height\/2 \x3e bottom\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 右侧越界\x3c\/span\x3e\nobject.x - object.width\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x26gt; right\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 左侧越界\x3c\/span\x3e\nobject.x \x2b object.width\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x26lt; left\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 上部越界\x3c\/span\x3e\nobject.y \x2b object.height\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x26lt; top\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 下部越界\x3c\/span\x3e\nobject.y - object.height\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x26gt; bottom\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e物体接触到区域边界\x3c\/h3\x3e\n\x3cp\x3e物体接触到区域边界就算越界，则可得越界条件如下，以下任何一项为true即可判定越界。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 右侧越界\nobject.x \x2b object.width\/2 \x3e right\n\/\/ 左侧越界\nobject.x - object.width\/2 \x3c left\n\/\/ 上部越界\nobject.y - object.height\/2 \x3c top\n\/\/ 下部越界\nobject.y \x2b object.height\/2 \x3e bottom\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 右侧越界\x3c\/span\x3e\nobject.x \x2b object.width\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x26gt; right\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 左侧越界\x3c\/span\x3e\nobject.x - object.width\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x26lt; left\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 上部越界\x3c\/span\x3e\nobject.y - object.height\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x26lt; top\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 下部越界\x3c\/span\x3e\nobject.y \x2b object.height\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x26gt; bottom\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e越界了该怎么办\x3c\/h2\x3e\n\x3cp\x3e搞明白越界条件后，接下来讨论越界之后的处理办法，一般是一下四种。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e将物体移除\x3c\/h3\x3e\n\x3cp\x3e这是最简单的处理办法，属于整个物体移出区域才算越界的情况。  \x3cbr\x3e下面的例子会先批量创建ball，保存在balls数组里，每次动画循环都会遍历这个数组，依次输入draw()函数，改变ball的位置并检测是否越界。下面只列出draw()函数的代码。  \x3cbr\x3e完整示例：\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part5\/01-removal.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e清除越界圆\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function draw(ball, pos) {\n  \/\/ 依据球的速度改变球的位置\n  ball.x \x2b= ball.vx;\n  ball.y \x2b= ball.vy;\n  \/\/ 检查是否越界\n  if (ball.x - ball.radius \x3e canvas.width || ball.x \x2b ball.radius \x3c 0 || ball.y - ball.radius \x3e canvas.height || ball.y \x2b ball.radius \x3c 0) {\n    \/\/ 在数组中清除越界的球\n    balls.splice(pos, 1);\n    \/\/ 打印提示\n    if (balls.length \x3e 0) {\n      log.value \x2b= `Removed ${ball.id}\\n`;\n      log.scrollTop = log.scrollHeight;\n    } else {\n      log.value \x2b= \x27All gone!\\n\x27;\n    }\n  }\n  \/\/ 画球\n  ball.draw(context);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edraw\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eball, pos\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 依据球的速度改变球的位置\x3c\/span\x3e\n  ball.x \x2b= ball.vx;\n  ball.y \x2b= ball.vy;\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 检查是否越界\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ball.x - ball.radius \x26gt; canvas.width || ball.x \x2b ball.radius \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e || ball.y - ball.radius \x26gt; canvas.height || ball.y \x2b ball.radius \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在数组中清除越界的球\x3c\/span\x3e\n    balls.splice(pos, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 打印提示\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (balls.length \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n      log.value \x2b= \x3cspan class=\x22hljs-string\x22\x3e`Removed \x3cspan class=\x22hljs-subst\x22\x3e${ball.id}\x3c\/span\x3e\\n`\x3c\/span\x3e;\n      log.scrollTop = log.scrollHeight;\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      log.value \x2b= \x3cspan class=\x22hljs-string\x22\x3e\x27All gone!\\n\x27\x3c\/span\x3e;\n    }\n  }\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 画球\x3c\/span\x3e\n  ball.draw(context);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e将其物体置回边界内\x3c\/h3\x3e\n\x3cp\x3e属于整个物体移出区域才算越界的情况。  \x3cbr\x3e下面的例子也是把创建的ball保存在balls数组里，但ball的初始位置都是画布中间的下部，如果检测到有ball越界，则会重置ball的位置。下面只列出draw()函数的代码。  \x3cbr\x3e完整示例：\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part5\/02-fountain.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e彩色喷泉\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function draw(ball) {\n  \/\/ 依据球的速度改变球的位置，这里包含了伪重力\n  ball.vy \x2b= gravity;\n  ball.x \x2b= ball.vx;\n  ball.y \x2b= ball.vy;\n  \/\/ 检测是否越界\n  if (ball.x - ball.radius \x3e canvas.width || ball.x \x2b ball.radius \x3c 0 || ball.y - ball.radius \x3e canvas.height || ball.y \x2b ball.radius \x3c 0) {\n    \/\/ 重置ball的位置\n    ball.x = canvas.width \/ 2;\n    ball.y = canvas.height;\n    \/\/ 重置ball的速度\n    ball.vx = Math.random() * 6 - 3;\n    ball.vy = Math.random() * -10 - 10;\n    \/\/ 打印提示\n    log.value = `Reset ${ball.id}\\n`;\n  }\n  \/\/ 画球\n  ball.draw(context);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edraw\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eball\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 依据球的速度改变球的位置，这里包含了伪重力\x3c\/span\x3e\n  ball.vy \x2b= gravity;\n  ball.x \x2b= ball.vx;\n  ball.y \x2b= ball.vy;\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 检测是否越界\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ball.x - ball.radius \x26gt; canvas.width || ball.x \x2b ball.radius \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e || ball.y - ball.radius \x26gt; canvas.height || ball.y \x2b ball.radius \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 重置ball的位置\x3c\/span\x3e\n    ball.x = canvas.width \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\n    ball.y = canvas.height;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 重置ball的速度\x3c\/span\x3e\n    ball.vx = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.random() * \x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e - \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e;\n    ball.vy = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.random() * \x3cspan class=\x22hljs-number\x22\x3e-10\x3c\/span\x3e - \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 打印提示\x3c\/span\x3e\n    log.value = \x3cspan class=\x22hljs-string\x22\x3e`Reset \x3cspan class=\x22hljs-subst\x22\x3e${ball.id}\x3c\/span\x3e\\n`\x3c\/span\x3e;\n  }\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 画球\x3c\/span\x3e\n  ball.draw(context);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e屏幕环绕\x3c\/h3\x3e\n\x3cp\x3e属于整个物体移出区域才算越界的情况。  \x3cbr\x3e屏幕环绕就是让同一个物体出现在边界内的另一个位置，如果一个物体从屏幕左侧移出，它就会在屏幕右侧再次出现，反之亦然，上下也是同理。  \x3cbr\x3e这里比前面的要稍微复杂的判断物体跃的是那边的界，伪代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if(object.x - object.width\/2 \x3e right){\n    object.x = left - object.widht\/2;\n}else if(object.x \x2b object.width\/2 \x3c left){\n    object.x = right \x2b object.width\/2;\n}\nif(object.y - object.height\/2 \x3e bottom){\n    object.y = top - object.height\/2;\n}else if(object.y \x2b object.height\/2 \x3c top){\n    obejct.y = bottom \x2b object.height\/2;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(object.x - object.width\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x26gt; right){\n    object.x = left - object.widht\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\n}\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(object.x \x2b object.width\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x26lt; left){\n    object.x = right \x2b object.width\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\n}\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(object.y - object.height\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x26gt; bottom){\n    object.y = top - object.height\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\n}\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(object.y \x2b object.height\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x26lt; top){\n    obejct.y = bottom \x2b object.height\/\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e反弹（粗略版）\x3c\/h3\x3e\n\x3cp\x3e这是较复杂的一种情况，属于物体接触到区域边界就算越界的情况。基本思路：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e检查物体是否越过任意边界；\x3c\/li\x3e\n\x3cli\x3e如果发生越界， 立即将物体置回边界；\x3c\/li\x3e\n\x3cli\x3e反转物体的速度向量的方向。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e下面的示例是一个ball在画布内移动，撞到边界就反弹，反弹核心代码如下。  \x3cbr\x3e完整示例：\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part5\/04-bouncing-1.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e反弹球（粗略版）\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (ball.x \x2b ball.radius \x3e right) {\n  ball.x = right - ball.radius;\n  vx *= -1;\n} else if (ball.x - ball.radius \x3c left) {\n  ball.x = left \x2b ball.radius;\n  vx *= -1;\n}\nif (ball.y \x2b ball.radius \x3e bottom) {\n  ball.y = bottom - ball.radius;\n  vy *= -1;\n} else if (ball.y - ball.radius \x3c top) {\n  ball.y = top \x2b ball.radius;\n  vy *= -1;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ball.x \x2b ball.radius \x26gt; right) {\n  ball.x = right - ball.radius;\n  vx *= \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e;\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ball.x - ball.radius \x26lt; left) {\n  ball.x = left \x2b ball.radius;\n  vx *= \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e;\n}\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ball.y \x2b ball.radius \x26gt; bottom) {\n  ball.y = bottom - ball.radius;\n  vy *= \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e;\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ball.y - ball.radius \x26lt; top) {\n  ball.y = top \x2b ball.radius;\n  vy *= \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e反弹（完美版）\x3c\/h3\x3e\n\x3cp\x3e咋看似乎效果不错，但仔细想想，我们这样将物体置回边界的做法是准确的吗？  \x3cbr\x3e答案是否定的，理想反弹与实际反弹是不同的，如下图：  \x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV6UUs?w=760\x26amp;h=654\x22 src=\x22https:\/\/static.alili.tech\/img\/bV6UUs?w=760\x26amp;h=654\x22 alt=\x22理想反弹与实际反弹\x22 title=\x22理想反弹与实际反弹\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e从图中我们可以清除的知道，ball实际上是不太可能会在理想反弹点反弹的，因为如果速度过大，计算位置时ball已经越过“理想反弹点”到达“实际反弹点”，而我们如果只是将ball的x轴坐标简单粗暴移到边界上，那还是不可能是“理想反弹点”，也就是说这种反弹方法不准确。  \x3cbr\x3e那么，完美反弹的思路就明确了，我们需要找到“理想反弹点”，并将ball置到该点。如果是左右边越界，则算出\x22理想反弹点\x22与“实际反弹点”在y轴上的距离；如果是上下边越界，则算出\x22理想反弹点\x22与“实际反弹点”在x轴上的距离。如图，思路以左右边越界为例：  \x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV6UUt?w=1132\x26amp;h=726\x22 src=\x22https:\/\/static.alili.tech\/img\/bV6UUt?w=1132\x26amp;h=726\x22 alt=\x22求理想反弹点\x22 title=\x22求理想反弹点\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e由速度可求得物体的方向弧度angle；\x3c\/li\x3e\n\x3cli\x3e算出\x22实际反弹点\x22和“理想反弹点”在x轴上的距离；\x3c\/li\x3e\n\x3cli\x3e依据正切求\x22实际反弹点\x22和“理想反弹点”在y轴上的距离；\x3c\/li\x3e\n\x3cli\x3e“理想反弹点”的y轴坐标即是\x22实际反弹点\x22加上这段距离。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e改造后的核心代码如下，至于有没有必要多做这么多运算，这就要权衡性能和精密性了。  \x3cbr\x3e完整示例：\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part5\/05-bouncing-2.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e反弹球（完美版）\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (ball.x \x2b ball.radius \x3e right) {\n  const dx = ball.x - (right - ball.radius);\n  const dy = Math.tan(angle) * dx;\n  ball.x = right - ball.radius;\n  ball.y \x2b= dy;\n  vx *= bounce;\n} else if (ball.x - ball.radius \x3c left) {\n  const dx = ball.x - (left \x2b ball.radius);\n  const dy = Math.tan(angle) * dx;\n  ball.x = left \x2b ball.radius;\n  ball.y \x2b= dy;\n  vx *= bounce;\n}\nif (ball.y \x2b ball.radius \x3e bottom) {\n  const dy = ball.y - (bottom - ball.radius);\n  const dx = dy \/ Math.tan(angle);\n  ball.y = bottom - ball.radius;\n  ball.x \x2b= dx;\n  vy *= bounce;\n} else if (ball.y - ball.radius \x3c top) {\n  const dy = ball.y - (top \x2b ball.radius);\n  const dx = dy \/ Math.tan(angle);\n  ball.y = top \x2b ball.radius;\n  ball.x \x2b= dx;\n  vy *= bounce;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ball.x \x2b ball.radius \x26gt; right) {\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e dx = ball.x - (right - ball.radius);\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e dy = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.tan(angle) * dx;\n  ball.x = right - ball.radius;\n  ball.y \x2b= dy;\n  vx *= bounce;\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ball.x - ball.radius \x26lt; left) {\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e dx = ball.x - (left \x2b ball.radius);\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e dy = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.tan(angle) * dx;\n  ball.x = left \x2b ball.radius;\n  ball.y \x2b= dy;\n  vx *= bounce;\n}\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ball.y \x2b ball.radius \x26gt; bottom) {\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e dy = ball.y - (bottom - ball.radius);\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e dx = dy \/ \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.tan(angle);\n  ball.y = bottom - ball.radius;\n  ball.x \x2b= dx;\n  vy *= bounce;\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ball.y - ball.radius \x26lt; top) {\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e dy = ball.y - (top \x2b ball.radius);\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e dx = dy \/ \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.tan(angle);\n  ball.y = top \x2b ball.radius;\n  ball.x \x2b= dx;\n  vy *= bounce;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e碰撞检测\x3c\/h2\x3e\n\x3cp\x3e和越界检查很像，我们扩展到两个物体间的碰撞检测，一般常用的有如下两种办法。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e基于几何图形的碰撞检测\x3c\/h3\x3e\n\x3cp\x3e一般是用在\x3cstrong\x3e检测矩形的碰撞\x3c\/strong\x3e，原理就是判断一个物体是否和另一个物体有重叠。  \x3cbr\x3e下面直接给出两个检测的工具函数。完整示例：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part8\/01-object-hit-test.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e两个矩形碰撞检测演示\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part8\/03-point-hit-test.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e矩形与点碰撞检测演示\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 两个矩形碰撞检测\nfunction intersects(rectA, rectB) {\n  return !(rectA.x \x2b rectA.width \x3c rectB.x ||\n    rectB.x \x2b rectB.width \x3c rectA.x ||\n    rectA.y \x2b rectA.height \x3c rectB.y ||\n    rectB.y \x2b rectB.height \x3c rectA.y);\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 两个矩形碰撞检测\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eintersects\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3erectA, rectB\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e !(rectA.x \x2b rectA.width \x26lt; rectB.x ||\n    rectB.x \x2b rectB.width \x26lt; rectA.x ||\n    rectA.y \x2b rectA.height \x26lt; rectB.y ||\n    rectB.y \x2b rectB.height \x26lt; rectA.y);\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 矩形与点碰撞检测\nfunction containsPoint(rect, x, y) {\n  return !(x \x3c rect.x || x \x3e rect.x \x2b rect.width || y \x3c rect.y || y \x3e rect.y \x2b rect.height);\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 矩形与点碰撞检测\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3econtainsPoint\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3erect, x, y\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e !(x \x26lt; rect.x || x \x26gt; rect.x \x2b rect.width || y \x26lt; rect.y || y \x26gt; rect.y \x2b rect.height);\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e基于距离的碰撞检测\x3c\/h3\x3e\n\x3cp\x3e一般是用在\x3cstrong\x3e检测圆形的碰撞\x3c\/strong\x3e，原理就是判断两个物体是否足够近到发生碰撞。  \x3cbr\x3e对于圆来说，只要两个圆心距离小于两圆半径之和，那我们就可判定为碰撞。圆心距离可通过\x3cstrong\x3e勾股定理\x3c\/strong\x3e求得。核心代码如下：  \x3cbr\x3e完整示例：\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part8\/05-distance-2.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e两圆基于距离的碰撞演示\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const dx = ballB.x - ballA.x;\nconst dy = ballB.y - ballA.y;\nconst dist = Math.sqrt(dx ** 2 \x2b dy ** 2);\n\nif (dist \x3c ballA.radius \x2b ballB.radius) {\n  log.value = \x27Hit!\x27;\n} else {\n  log.value = \x27\x27;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e dx = ballB.x - ballA.x;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e dy = ballB.y - ballA.y;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e dist = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.sqrt(dx ** \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e \x2b dy ** \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (dist \x26lt; ballA.radius \x2b ballB.radius) {\n  log.value = \x3cspan class=\x22hljs-string\x22\x3e\x27Hit!\x27\x3c\/span\x3e;\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n  log.value = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>【30分钟学完】canvas动画|游戏基础(4)：边界与碰撞</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000014002724">https://segmentfault.com/a/1190000014002724</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/dg954lcn8rg/" target="_blank">https://alili.tech/archive/dg954lcn8rg/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>