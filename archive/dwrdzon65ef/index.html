<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="记一次 webpack 打包体积优化"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>记一次 webpack 打包体积优化 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/dwrdzon65ef/",
				"appid": "1613049289050283", 
				"title": "记一次 webpack 打包体积优化 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-13T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/xfmfdu8ue7/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/2sj0ic1iisb/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fdwrdzon65ef%2f&text=%e8%ae%b0%e4%b8%80%e6%ac%a1%20webpack%20%e6%89%93%e5%8c%85%e4%bd%93%e7%a7%af%e4%bc%98%e5%8c%96"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fdwrdzon65ef%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fdwrdzon65ef%2f&text=%e8%ae%b0%e4%b8%80%e6%ac%a1%20webpack%20%e6%89%93%e5%8c%85%e4%bd%93%e7%a7%af%e4%bc%98%e5%8c%96"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fdwrdzon65ef%2f&title=%e8%ae%b0%e4%b8%80%e6%ac%a1%20webpack%20%e6%89%93%e5%8c%85%e4%bd%93%e7%a7%af%e4%bc%98%e5%8c%96"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fdwrdzon65ef%2f&is_video=false&description=%e8%ae%b0%e4%b8%80%e6%ac%a1%20webpack%20%e6%89%93%e5%8c%85%e4%bd%93%e7%a7%af%e4%bc%98%e5%8c%96"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e8%ae%b0%e4%b8%80%e6%ac%a1%20webpack%20%e6%89%93%e5%8c%85%e4%bd%93%e7%a7%af%e4%bc%98%e5%8c%96&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fdwrdzon65ef%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fdwrdzon65ef%2f&title=%e8%ae%b0%e4%b8%80%e6%ac%a1%20webpack%20%e6%89%93%e5%8c%85%e4%bd%93%e7%a7%af%e4%bc%98%e5%8c%96"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fdwrdzon65ef%2f&title=%e8%ae%b0%e4%b8%80%e6%ac%a1%20webpack%20%e6%89%93%e5%8c%85%e4%bd%93%e7%a7%af%e4%bc%98%e5%8c%96"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fdwrdzon65ef%2f&title=%e8%ae%b0%e4%b8%80%e6%ac%a1%20webpack%20%e6%89%93%e5%8c%85%e4%bd%93%e7%a7%af%e4%bc%98%e5%8c%96"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fdwrdzon65ef%2f&title=%e8%ae%b0%e4%b8%80%e6%ac%a1%20webpack%20%e6%89%93%e5%8c%85%e4%bd%93%e7%a7%af%e4%bc%98%e5%8c%96"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">记一次 webpack 打包体积优化</h1><div class="meta"><div class="postdate"><time datetime="2018-12-13" itemprop="datePublished">2018-12-13</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e手头做的项目开发得差不多了，而打包配置是一开始粗略配置的，不大的项目打包出来得6MB\x2b，所以现在必须进行优化。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e打包结果分析\x3c\/h2\x3e\n\x3cp\x3e执行命令 \x3ccode\x3ewebpack --profile --json \x26gt; stats.json\x3c\/code\x3e ，可以将打包过程的详细信息以 json 格式记录到文件中。依据该文件，\x3ca href=\x22https:\/\/github.com\/webpack-contrib\/webpack-bundle-analyzer\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack-bundle-analyzer\x3c\/a\x3e、\x3ca href=\x22http:\/\/alexkuz.github.io\/webpack-chart\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eWebpack Chart\x3c\/a\x3e 等分析工具会以可视化的形式展示打包过程和结果。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008837589?w=908\x26amp;h=547\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008837589?w=908\x26amp;h=547\x22 alt=\x22webpack-bundle-analyzer\x22 title=\x22webpack-bundle-analyzer\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e如果不想用这些额外工具，通过命令 \x3ccode\x3ewebpack --display-modules --sort-modules-by size\x3c\/code\x3e ，webpack 会在日志中按大小排序显示所有模块。\x3c\/p\x3e\n\x3cp\x3e我在项目中，将第三方库基本都集中打包到一个 chunk (vendors)，业务逻辑单独一个 chunk (app)。打包总体积的大头来自 vendors，其中\x3ccode\x3eantd\x3c\/code\x3e占据大头(3MB\x2b)、\x3ccode\x3emoment\x3c\/code\x3e占据约500KB、提取的 css 约300KB、\x3ccode\x3ereact-dom\x3c\/code\x3e也是500KB\x2b，出乎意料的是 \x3ccode\x3elodash\x3c\/code\x3e 也是500KB\x2b。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e逐个击破\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e设置环境变量 \x3ccode\x3eNODE_ENV\x3c\/code\x3e 为 \x3ccode\x3eproduction\x3c\/code\x3e\n\x3c\/h3\x3e\n\x3cp\x3e不少库会按开发环境(development)和生产环境(production)提供不同的文件，主要是为了开发模式下的调试，也会因此有文件体积上的差别。用于生产环境的打包，设置其为\x3ccode\x3eproduction\x3c\/code\x3e后，这些库会提供最小体积的文件。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22plugins: [\n    \/\/ ...\n    new webpack.DefinePlugin({\n      \x27process.env\x27: {\n        NODE_ENV: JSON.stringify(\x27production\x27)\n      }\n    }),\n    \/\/ ...\n]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eplugins: [\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.DefinePlugin({\n      \x3cspan class=\x22hljs-string\x22\x3e\x27process.env\x27\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3eNODE_ENV\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(\x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e)\n      }\n    }),\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n]\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3ecss-loader\x3c\/h3\x3e\n\x3cp\x3ecss-loader 在 webpack 默认不开启压缩，需要设置 \x3ccode\x3ecss-loader?minimize\x3c\/code\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22module: {\n    \/\/ ...\n    {\n      test: \/\\.css$\/,\n      use: ExtractTextPlugin.extract({\n        fallback: \x27style-loader\x27,\n        use: \x27css-loader?minimize\x27\n      })\n    }\n    \/\/ ...\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    {\n      \x3cspan class=\x22hljs-attr\x22\x3etest\x3c\/span\x3e: \x3cspan class=\x22hljs-regexp\x22\x3e\/\\.css$\/\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3euse\x3c\/span\x3e: ExtractTextPlugin.extract({\n        \x3cspan class=\x22hljs-attr\x22\x3efallback\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27style-loader\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3euse\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27css-loader?minimize\x27\x3c\/span\x3e\n      })\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e大头——antd (ant design)\x3c\/h3\x3e\n\x3cp\x3e因为并没有使用 antd 的所有组件，所以按需加载是必需的。根据其文档（\x3ca href=\x22https:\/\/ant.design\/docs\/react\/introduce-cn#%E6%8C%89%E9%9C%80%E5%8A%A0%E8%BD%BD\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e按需加载 - Ant Design\x3c\/a\x3e），需要安装 bable 插件 \x3ccode\x3ebabel-plugin-import \x3c\/code\x3e，并在 babel 配置中添加：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n    \/\/ ...\n    \x26quot;plugins\x26quot;: [\n        [\x26quot;import\x26quot;, { \x26quot;libraryName\x26quot;: \x26quot;antd\x26quot;, \x26quot;libraryDirectory\x26quot;: \x26quot;es\x26quot;, \x26quot;style\x26quot;: \x26quot;css\x26quot; }],\n        \/\/ ...\n    ]\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e\x22plugins\x22\x3c\/span\x3e: [\n        [\x3cspan class=\x22hljs-string\x22\x3e\x22import\x22\x3c\/span\x3e, { \x3cspan class=\x22hljs-string\x22\x3e\x22libraryName\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22antd\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22libraryDirectory\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22es\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22style\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22css\x22\x3c\/span\x3e }],\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    ]\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在我配置过程中，\x3ccode\x3elibraryDirectory\x3c\/code\x3e 配置的不同也会有较大影响，但按目前文档来看貌似没有影响，待我确认后再做记录。\x3c\/p\x3e\n\x3cp\x3e=== 2018-02-23 更新 ===\x3c\/p\x3e\n\x3cp\x3e看来\x3ccode\x3ebable-plugin-import\x3c\/code\x3e这几天有更新，现在配置项 \x3ccode\x3elibraryDirectory\x3c\/code\x3e 的默认值时 \x3ccode\x3elib\x3c\/code\x3e，即使用通过 \x3ccode\x3erequire\x3c\/code\x3e (commonjs) 引用模块的文件。而先前我在配置的时候并没有默认值，如果没有显示配置 \x3ccode\x3elibraryDirectory\x3c\/code\x3e，打包结果会出现重复的内容。\x3c\/p\x3e\n\x3cp\x3e采用了 es6 module 的项目建议配置 \x3ccode\x3elibraryDirectory\x3c\/code\x3e 为 \x3ccode\x3ees\x3c\/code\x3e，即使用通过 \x3ccode\x3eimport\x3c\/code\x3e (es6 module) 引用模块的文件。这种情况打包后的体积要更小一些。\x3c\/p\x3e\n\x3cp\x3e=== end ===\x3c\/p\x3e\n\x3cp\x3e这里还有很重要一点，\x3ccode\x3ebabel-plugin-import\x3c\/code\x3e 要求 \x3ccode\x3eantd\x3c\/code\x3e 不能被提取为公共模块 vendors，否则就无法实现按需加载。尚不清楚是 babel 插件的原因，还是这个插件单独的原因。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3emoment\x3c\/h3\x3e\n\x3cp\x3emoment 库的体积开销主要是 i18n 文件，配置 webpack 将用不到 i18n 文件不打包即可。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22plugins: [\n    new webpack.ContextReplacementPlugin(\/moment[\\\/\\\\]locale$\/, \/zh-cn\/),\n]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eplugins: [\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.ContextReplacementPlugin(\x3cspan class=\x22hljs-regexp\x22\x3e\/moment[\\\/\\\\]locale$\/\x3c\/span\x3e, \/zh-cn\/),\n]\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e看上去很轻量的 \x3ccode\x3elodash\x3c\/code\x3e\n\x3c\/h3\x3e\n\x3cp\x3e\x3ccode\x3elodash\x3c\/code\x3e看上去就是一些工具函数，应该是很轻量的，然而一次全部加载下来要达到500KB，因此也需要按需加载。它的按需加载还比较麻烦。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3elodash\x3c\/code\x3e为每个方法单独提供了库，但这种方式在实际使用中并不灵活，所以这种最「干净」的方法不建议使用。\x3c\/p\x3e\n\x3cp\x3e像 antd 一样，\x3ccode\x3elodash\x3c\/code\x3e 也有 babel 插件用于按需加载——\x3ca href=\x22https:\/\/github.com\/lodash\/babel-plugin-lodash\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ebabel-plugin-lodash\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n    \/\/ ...\n    \x26quot;plugins\x26quot;: [\n        \x26quot;lodash\x26quot;,\n        \/\/ ...\n    ]\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e\x22plugins\x22\x3c\/span\x3e: [\n        \x3cspan class=\x22hljs-string\x22\x3e\x22lodash\x22\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    ]\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e同样，\x3ccode\x3elodash\x3c\/code\x3e 就不能提取到公共模块了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e最后\x3c\/h2\x3e\n\x3cp\x3e打包结果的体积开销主要就是以上几项。经过优化后，体积下降至1.5MB以内，还是很客观的。不过 antd 依然占据大头，后续会考虑把 antd 替换掉，毕竟用到的组件不多。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>记一次 webpack 打包体积优化</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000013326506">https://segmentfault.com/a/1190000013326506</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/dwrdzon65ef/" target="_blank">https://alili.tech/archive/dwrdzon65ef/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>