<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="ES2018 新特征之：异步迭代器 for-await-of"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>ES2018 新特征之：异步迭代器 for-await-of | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/e5xjwxfsxdv/",
				"appid": "1613049289050283", 
				"title": "ES2018 新特征之：异步迭代器 for-await-of | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-12T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/hdgye0c5jdv/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/fw7ed6tbeii/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fe5xjwxfsxdv%2f&text=ES2018%20%e6%96%b0%e7%89%b9%e5%be%81%e4%b9%8b%ef%bc%9a%e5%bc%82%e6%ad%a5%e8%bf%ad%e4%bb%a3%e5%99%a8%20for-await-of"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fe5xjwxfsxdv%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fe5xjwxfsxdv%2f&text=ES2018%20%e6%96%b0%e7%89%b9%e5%be%81%e4%b9%8b%ef%bc%9a%e5%bc%82%e6%ad%a5%e8%bf%ad%e4%bb%a3%e5%99%a8%20for-await-of"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fe5xjwxfsxdv%2f&title=ES2018%20%e6%96%b0%e7%89%b9%e5%be%81%e4%b9%8b%ef%bc%9a%e5%bc%82%e6%ad%a5%e8%bf%ad%e4%bb%a3%e5%99%a8%20for-await-of"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fe5xjwxfsxdv%2f&is_video=false&description=ES2018%20%e6%96%b0%e7%89%b9%e5%be%81%e4%b9%8b%ef%bc%9a%e5%bc%82%e6%ad%a5%e8%bf%ad%e4%bb%a3%e5%99%a8%20for-await-of"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=ES2018%20%e6%96%b0%e7%89%b9%e5%be%81%e4%b9%8b%ef%bc%9a%e5%bc%82%e6%ad%a5%e8%bf%ad%e4%bb%a3%e5%99%a8%20for-await-of&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fe5xjwxfsxdv%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fe5xjwxfsxdv%2f&title=ES2018%20%e6%96%b0%e7%89%b9%e5%be%81%e4%b9%8b%ef%bc%9a%e5%bc%82%e6%ad%a5%e8%bf%ad%e4%bb%a3%e5%99%a8%20for-await-of"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fe5xjwxfsxdv%2f&title=ES2018%20%e6%96%b0%e7%89%b9%e5%be%81%e4%b9%8b%ef%bc%9a%e5%bc%82%e6%ad%a5%e8%bf%ad%e4%bb%a3%e5%99%a8%20for-await-of"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fe5xjwxfsxdv%2f&title=ES2018%20%e6%96%b0%e7%89%b9%e5%be%81%e4%b9%8b%ef%bc%9a%e5%bc%82%e6%ad%a5%e8%bf%ad%e4%bb%a3%e5%99%a8%20for-await-of"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fe5xjwxfsxdv%2f&title=ES2018%20%e6%96%b0%e7%89%b9%e5%be%81%e4%b9%8b%ef%bc%9a%e5%bc%82%e6%ad%a5%e8%bf%ad%e4%bb%a3%e5%99%a8%20for-await-of"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">ES2018 新特征之：异步迭代器 for-await-of</h1><div class="meta"><div class="postdate"><time datetime="2018-12-12" itemprop="datePublished">2018-12-12</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3eES2018 新特性\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3e异步迭代器\x3c\/strong\x3e（本文）\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/esnext.justjavac.com\/proposal\/regexp-lookbehind.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e正则表达式反向(lookbehind)断言\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/esnext.justjavac.com\/proposal\/regexp-unicode-property-escapes.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e正则表达式 Unicode 转义\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/esnext.justjavac.com\/proposal\/template-literal-revision.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e非转义序列的模板字符串\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/esnext.justjavac.com\/proposal\/regexp-dotall-flag.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e正则表达式 s\/dotAll 模式\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/esnext.justjavac.com\/proposal\/regexp-named-groups.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e正则表达式命名捕获组\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/esnext.justjavac.com\/proposal\/object-rest-spread.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e对象展开运算符\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/esnext.justjavac.com\/api\/Promise.prototype.finally.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ePromise.prototype.finally\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e1. 概述\x3c\/h2\x3e\n\x3cp\x3e在 ECMAScript 2015(ES6) 中 JavaScript 引入了迭代器接口（iterator）用来遍历数据。迭代器对象知道如何每次访问集合中的一项， 并跟踪该序列中的当前位置。在  JavaScript 中迭代器是一个对象，它提供了一个 \x3ccode\x3enext()\x3c\/code\x3e 方法，用来返回序列中的下一项。这个方法返回包含两个属性：\x3ccode\x3edone\x3c\/code\x3e 和 \x3ccode\x3evalue\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e迭代器对象一旦被创建，就可以反复调用 \x3ccode\x3enext()\x3c\/code\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function makeIterator(array) {\n  let nextIndex = 0;  \/\/ 初始索引\n\n  \/\/ 返回一个迭代器对象，对象的属性是一个 next 方法\n  return {\n    next: function() {\n      if (nextIndex \x3c array.length) {\n        \/\/ 当没有到达末尾时，返回当前值，并把索引加1\n        return { value: array[nextIndex\x2b\x2b], done: false };\n      }\n\n      \/\/ 到达末尾，done 属性为 true\n      return {done: true};\n    }\n  };\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emakeIterator\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3earray\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e nextIndex = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 初始索引\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 返回一个迭代器对象，对象的属性是一个 next 方法\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3enext\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (nextIndex \x26lt; array.length) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 当没有到达末尾时，返回当前值，并把索引加1\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e { \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: array[nextIndex\x2b\x2b], \x3cspan class=\x22hljs-attr\x22\x3edone\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e };\n      }\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 到达末尾，done 属性为 true\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\x3cspan class=\x22hljs-attr\x22\x3edone\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e};\n    }\n  };\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e一旦初始化，\x3ccode\x3enext()\x3c\/code\x3e 方法可以用来依次访问对象中的键值：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const it = makeIterator([\x27j\x27, \x27u\x27, \x27s\x27, \x27t\x27]);\nit.next().value;  \/\/ j\nit.next().value;  \/\/ u\nit.next().value;  \/\/ s\nit.next().value;  \/\/ t\nit.next().value;  \/\/ undefined\nit.next().done;   \/\/ true\nit.next().value;  \/\/ undefined\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e it = makeIterator([\x3cspan class=\x22hljs-string\x22\x3e\x27j\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27u\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27s\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27t\x27\x3c\/span\x3e]);\nit.next().value;  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ j\x3c\/span\x3e\nit.next().value;  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ u\x3c\/span\x3e\nit.next().value;  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ s\x3c\/span\x3e\nit.next().value;  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ t\x3c\/span\x3e\nit.next().value;  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ undefined\x3c\/span\x3e\nit.next().done;   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ true\x3c\/span\x3e\nit.next().value;  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ undefined\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e2. 可迭代对象\x3c\/h2\x3e\n\x3cp\x3e一个定义了\x3cstrong\x3e迭代行为\x3c\/strong\x3e的对象，比如在 \x3ccode\x3efor...of\x3c\/code\x3e 中循环了哪些值。为了实现可迭代，一个对象必须实现 \x3ccode\x3e@@iterator\x3c\/code\x3e 方法，这意味着这个对象（或其原型链中的一个对象）必须具有带 \x3ccode\x3eSymbol.iterator\x3c\/code\x3e 键的属性：\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eString\x3c\/code\x3e，\x3ccode\x3eArray\x3c\/code\x3e，\x3ccode\x3eTypedArray\x3c\/code\x3e，\x3ccode\x3eMap\x3c\/code\x3e 和 \x3ccode\x3eSet\x3c\/code\x3e 都内置可迭代对象，因为它们的原型对象都有一个 \x3ccode\x3eSymbol.iterator\x3c\/code\x3e 方法。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const justjavac = {\n  [Symbol.iterator]: () =\x3e {\n    const items = [`j`, `u`, `s`, `t`, `j`, `a`, `v`, `a`, `c`];\n    return {\n      next: () =\x3e ({\n        done: items.length === 0,\n        value: items.shift()\n      })\n    }\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e justjavac = {\n  [\x3cspan class=\x22hljs-built_in\x22\x3eSymbol\x3c\/span\x3e.iterator]: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e items = [\x3cspan class=\x22hljs-string\x22\x3e`j`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`u`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`s`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`t`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`j`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`a`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`v`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`a`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`c`\x3c\/span\x3e];\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-attr\x22\x3enext\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e ({\n        \x3cspan class=\x22hljs-attr\x22\x3edone\x3c\/span\x3e: items.length === \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: items.shift()\n      })\n    }\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当我们定义了可迭代对象后，就可以在 \x3ccode\x3eArray.from\x3c\/code\x3e、\x3ccode\x3efor...of\x3c\/code\x3e 中使用这个对象：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22[...justjavac];\n\/\/ [\x26quot;j\x26quot;, \x26quot;u\x26quot;, \x26quot;s\x26quot;, \x26quot;t\x26quot;, \x26quot;j\x26quot;, \x26quot;a\x26quot;, \x26quot;v\x26quot;, \x26quot;a\x26quot;, \x26quot;c\x26quot;]\n\nArray.from(justjavac)\n\/\/ [\x26quot;j\x26quot;, \x26quot;u\x26quot;, \x26quot;s\x26quot;, \x26quot;t\x26quot;, \x26quot;j\x26quot;, \x26quot;a\x26quot;, \x26quot;v\x26quot;, \x26quot;a\x26quot;, \x26quot;c\x26quot;]\n\nnew Set(justjavac);\n\/\/ {\x26quot;j\x26quot;, \x26quot;u\x26quot;, \x26quot;s\x26quot;, \x26quot;t\x26quot;, \x26quot;a\x26quot;, \x26quot;v\x26quot;, \x26quot;c\x26quot;}\n\nfor (const item of justjavac) {\n  console.log(item)\n}\n\/\/ j \n\/\/ u \n\/\/ s \n\/\/ t \n\/\/ j \n\/\/ a \n\/\/ v \n\/\/ a \n\/\/ c\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e[...justjavac];\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ [\x22j\x22, \x22u\x22, \x22s\x22, \x22t\x22, \x22j\x22, \x22a\x22, \x22v\x22, \x22a\x22, \x22c\x22]\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e.from(justjavac)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ [\x22j\x22, \x22u\x22, \x22s\x22, \x22t\x22, \x22j\x22, \x22a\x22, \x22v\x22, \x22a\x22, \x22c\x22]\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eSet\x3c\/span\x3e(justjavac);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ {\x22j\x22, \x22u\x22, \x22s\x22, \x22t\x22, \x22a\x22, \x22v\x22, \x22c\x22}\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e item \x3cspan class=\x22hljs-keyword\x22\x3eof\x3c\/span\x3e justjavac) {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(item)\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ j \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ u \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ s \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ t \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ j \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ a \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ v \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ a \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ c\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e3. 同步迭代\x3c\/h2\x3e\n\x3cp\x3e由于在迭代器方法返回时，序列中的下一个值和数据源的 \x22done\x22 状态必须已知，所以迭代器只适合于表示\x3cstrong\x3e同步\x3c\/strong\x3e数据源。\x3c\/p\x3e\n\x3cp\x3e虽然 JavaScript 程序员遇到的许多数据源是同步的（比如内存中的列表和其他数据结构），但是其他许多数据源却不是。例如，任何需要 I\/O 访问的数据源通常都会使用基于事件的或流式异步 API 来表示。不幸的是，迭代器不能用来表示这样的数据源。\x3c\/p\x3e\n\x3cp\x3e（即使是 promise 的迭代器也是不够的，因为它的 value 是异步的，但是迭代器需要同步确定 \x22done\x22 状态。）\x3c\/p\x3e\n\x3cp\x3e为了给异步数据源提供通用的数据访问协议，我们引入了 \x3ccode\x3eAsyncIterator\x3c\/code\x3e 接口，异步迭代语句（\x3ccode\x3efor-await-of\x3c\/code\x3e）和异步生成器函数。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e4. 异步迭代器\x3c\/h2\x3e\n\x3cp\x3e一个异步迭代器就像一个迭代器，除了它的 \x3ccode\x3enext()\x3c\/code\x3e 方法返回一个 \x3ccode\x3e{ value, done }\x3c\/code\x3e 的 promise。如上所述，我们必须返回迭代器结果的 promise，因为在迭代器方法返回时，迭代器的下一个值和“完成”状态可能未知。\x3c\/p\x3e\n\x3cp\x3e我们修改一下之前的代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 const justjavac = {\n-  [Symbol.iterator]: () =\x3e {\n\x2b  [Symbol.asyncIterator]: () =\x3e {\n     const items = [`j`, `u`, `s`, `t`, `j`, `a`, `v`, `a`, `c`];\n     return {\n-      next: () =\x3e ({\n\x2b      next: () =\x3e Promise.resolve({\n         done: items.length === 0,\n         value: items.shift()\n       })\n     }\n   }\n }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22diff hljs\x22\x3e\x3ccode class=\x22diff\x22\x3e const justjavac = {\n\x3cspan class=\x22hljs-deletion\x22\x3e-  [Symbol.iterator]: () =\x26gt; {\x3c\/span\x3e\n\x3cspan class=\x22hljs-addition\x22\x3e\x2b  [Symbol.asyncIterator]: () =\x26gt; {\x3c\/span\x3e\n     const items = [`j`, `u`, `s`, `t`, `j`, `a`, `v`, `a`, `c`];\n     return {\n\x3cspan class=\x22hljs-deletion\x22\x3e-      next: () =\x26gt; ({\x3c\/span\x3e\n\x3cspan class=\x22hljs-addition\x22\x3e\x2b      next: () =\x26gt; Promise.resolve({\x3c\/span\x3e\n         done: items.length \x3cspan class=\x22hljs-comment\x22\x3e=== 0,\x3c\/span\x3e\n         value: items.shift()\n       })\n     }\n   }\n }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e好的，我们现在有了一个异步迭代器，代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const justjavac = {\n  [Symbol.asyncIterator]: () =\x3e {\n    const items = [`j`, `u`, `s`, `t`, `j`, `a`, `v`, `a`, `c`];\n    return {\n      next: () =\x3e Promise.resolve({\n        done: items.length === 0,\n        value: items.shift()\n      })\n    }\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e justjavac = {\n  [\x3cspan class=\x22hljs-built_in\x22\x3eSymbol\x3c\/span\x3e.asyncIterator]: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e items = [\x3cspan class=\x22hljs-string\x22\x3e`j`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`u`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`s`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`t`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`j`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`a`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`v`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`a`\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e`c`\x3c\/span\x3e];\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-attr\x22\x3enext\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve({\n        \x3cspan class=\x22hljs-attr\x22\x3edone\x3c\/span\x3e: items.length === \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: items.shift()\n      })\n    }\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们可以使用如下代码进行遍历：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22for await (const item of justjavac) {\n  console.log(item)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eawait\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e item \x3cspan class=\x22hljs-keyword\x22\x3eof\x3c\/span\x3e justjavac) {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(item)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果你遇到了 \x3ccode\x3eSyntaxError: for await (... of ...) is only valid in async functions and async generators\x3c\/code\x3e 错误，那是因为 \x3ccode\x3efor-await-of\x3c\/code\x3e 只能在 async 函数或者 async 生成器里面使用。\x3c\/p\x3e\n\x3cp\x3e修改一下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22(async function(){\n  for await (const item of justjavac) {\n    console.log(item)\n  }\n})();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e(\x3cspan class=\x22hljs-keyword\x22\x3easync\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eawait\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e item \x3cspan class=\x22hljs-keyword\x22\x3eof\x3c\/span\x3e justjavac) {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(item)\n  }\n})();\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e5. 同步迭代器 vs 异步迭代器\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e5.1 Iterators\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 迭代器\ninterface Iterator {\n    next(value) : IteratorResult;\n    [optional] throw(value) : IteratorResult;\n    [optional] return(value) : IteratorResult;\n}\n\n\/\/ 迭代结果\ninterface IteratorResult {\n    value : any;\n    done : bool;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 迭代器\x3c\/span\x3e\ninterface Iterator {\n    next(value) : IteratorResult;\n    [optional] \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e(value) : IteratorResult;\n    [optional] \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e(value) : IteratorResult;\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 迭代结果\x3c\/span\x3e\ninterface IteratorResult {\n    \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e : any;\n    done : bool;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e5.2 Async Iterators\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 异步迭代器\ninterface AsyncIterator {\n    next(value) : Promise\x3cIteratorResult\x3e;\n    [optional] throw(value) : Promise\x3cIteratorResult\x3e;\n    [optional] return(value) : Promise\x3cIteratorResult\x3e;\n}\n\n\/\/ 迭代结果\ninterface IteratorResult {\n    value : any;\n    done : bool;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 异步迭代器\x3c\/span\x3e\ninterface AsyncIterator {\n    next(value) : \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e\x26lt;IteratorResult\x26gt;;\n    [optional] \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e(value) : \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e\x26lt;IteratorResult\x26gt;;\n    [optional] \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e(value) : \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e\x26lt;IteratorResult\x26gt;;\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 迭代结果\x3c\/span\x3e\ninterface IteratorResult {\n    \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e : any;\n    done : bool;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e6. 异步生成器函数\x3c\/h2\x3e\n\x3cp\x3e异步生成器函数与生成器函数类似，但有以下区别：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e当被调用时，异步生成器函数返回一个对象，\x22async generator\x22，含有 3 个方法（\x3ccode\x3enext\x3c\/code\x3e，\x3ccode\x3ethrow\x3c\/code\x3e，和\x3ccode\x3ereturn\x3c\/code\x3e），每个方法都返回一个 Promise，Promise 返回 \x3ccode\x3e{ value, done }\x3c\/code\x3e。而普通生成器函数并不返回 Promise，而是直接返回 \x3ccode\x3e{ value, done }\x3c\/code\x3e。这会自动使返回的异步生成器对象具有异步迭代的功能。\x3c\/li\x3e\n\x3cli\x3e允许使用 \x3ccode\x3eawait\x3c\/code\x3e 表达式和 \x3ccode\x3efor-await-of\x3c\/code\x3e 语句。\x3c\/li\x3e\n\x3cli\x3e修改了 \x3ccode\x3eyield*\x3c\/code\x3e 的行为以支持异步迭代。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e示例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22async function* readLines(path) {\n  let file = await fileOpen(path);\n\n  try {\n    while (!file.EOF) {\n      yield await file.readLine();\n    }\n  } finally {\n    await file.close();\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3easync\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e* \x3cspan class=\x22hljs-title\x22\x3ereadLines\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3epath\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e file = \x3cspan class=\x22hljs-keyword\x22\x3eawait\x3c\/span\x3e fileOpen(path);\n\n  \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (!file.EOF) {\n      \x3cspan class=\x22hljs-keyword\x22\x3eyield\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eawait\x3c\/span\x3e file.readLine();\n    }\n  } \x3cspan class=\x22hljs-keyword\x22\x3efinally\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3eawait\x3c\/span\x3e file.close();\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e函数返回一个异步生成器（async generator）对象，可以用在 \x3ccode\x3efor-await-of\x3c\/code\x3e 语句中。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e7. 实现\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/github.com\/Microsoft\/ChakraCore\/issues\/2720\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eChakra\x3c\/a\x3e - 暂未支持\x3c\/li\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/github.com\/tc39\/proposal-async-iteration\/issues\/63#issuecomment-330929480\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJavaScriptCore\x3c\/a\x3e - Safari Tech Preview 40\x3c\/li\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/github.com\/tc39\/proposal-async-iteration\/issues\/63#issuecomment-330978069\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eSpiderMonkey\x3c\/a\x3e - Firefox 57\x3c\/li\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/blog.chromium.org\/2017\/10\/chrome-63-beta-dynamic-module-imports_27.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eV8\x3c\/a\x3e - Chrome 63\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3ePolyfills\x3c\/h2\x3e\n\x3cp\x3eFacebook 的 \x3ca href=\x22https:\/\/github.com\/facebook\/regenerator\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRegenerator\x3c\/a\x3e 项目为 \x3ccode\x3eAsyncIterator\x3c\/code\x3e 接口提供了一个 polyfill，将异步生成器函数变成返回 \x3ccode\x3eAsyncIterator\x3c\/code\x3e 的对象 ECMAScript 5 函数。Regenerator 还不支持 \x3ccode\x3efor-await-of\x3c\/code\x3e 异步迭代语法。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/babel\/babel\/tree\/master\/packages\/babylon\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eBabylon parser\x3c\/a\x3e 项目支持异步生成器函数和 \x3ccode\x3efor- await-of\x3c\/code\x3e 语句（v6.8.0\x2b）。你可以使用它的 \x3ca href=\x22https:\/\/github.com\/babel\/babel\/tree\/master\/packages\/babylon#plugins\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3easyncGenerators 插件\x3c\/a\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22require(\x26quot;babylon\x26quot;).parse(\x26quot;code\x26quot;, {\n  sourceType: \x26quot;module\x26quot;,\n  plugins: [\n    \x26quot;asyncGenerators\x26quot;\n  ]\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22babylon\x22\x3c\/span\x3e).parse(\x3cspan class=\x22hljs-string\x22\x3e\x22code\x22\x3c\/span\x3e, {\n  \x3cspan class=\x22hljs-attr\x22\x3esourceType\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22module\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eplugins\x3c\/span\x3e: [\n    \x3cspan class=\x22hljs-string\x22\x3e\x22asyncGenerators\x22\x3c\/span\x3e\n  ]\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e另外，从 6.16.0 开始，异步迭代被包含在 Babel 的 \x3ca href=\x22https:\/\/github.com\/babel\/babel\/tree\/master\/packages\/babel-plugin-transform-async-generator-functions\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3e\x22babel-plugin-transform-async-generator-functions\x22\x3c\/code\x3e\x3c\/a\x3e 下以及 \x3ca href=\x22http:\/\/babeljs.io\/docs\/plugins\/preset-stage-3\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3ebabel-preset-stage-3\x3c\/code\x3e\x3c\/a\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22require(\x26quot;babel-core\x26quot;).transform(\x26quot;code\x26quot;, {\n  plugins: [\n    \x26quot;transform-async-generator-functions\x26quot;\n  ]\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22babel-core\x22\x3c\/span\x3e).transform(\x3cspan class=\x22hljs-string\x22\x3e\x22code\x22\x3c\/span\x3e, {\n  \x3cspan class=\x22hljs-attr\x22\x3eplugins\x3c\/span\x3e: [\n    \x3cspan class=\x22hljs-string\x22\x3e\x22transform-async-generator-functions\x22\x3c\/span\x3e\n  ]\n});\x3c\/code\x3e\x3c\/pre\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>ES2018 新特征之：异步迭代器 for-await-of</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000013387616">https://segmentfault.com/a/1190000013387616</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/e5xjwxfsxdv/" target="_blank">https://alili.tech/archive/e5xjwxfsxdv/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>