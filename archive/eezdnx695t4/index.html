<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="前端基础进阶（十）：面向对象实战之封装拖拽对象"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>前端基础进阶（十）：面向对象实战之封装拖拽对象 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/eezdnx695t4/",
				"appid": "1613049289050283", 
				"title": "前端基础进阶（十）：面向对象实战之封装拖拽对象 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-19T02:30:08"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/w4k264c7c8q/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/2p4g2i6vnvx/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2feezdnx695t4%2f&text=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%ef%bc%89%ef%bc%9a%e9%9d%a2%e5%90%91%e5%af%b9%e8%b1%a1%e5%ae%9e%e6%88%98%e4%b9%8b%e5%b0%81%e8%a3%85%e6%8b%96%e6%8b%bd%e5%af%b9%e8%b1%a1"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2feezdnx695t4%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2feezdnx695t4%2f&text=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%ef%bc%89%ef%bc%9a%e9%9d%a2%e5%90%91%e5%af%b9%e8%b1%a1%e5%ae%9e%e6%88%98%e4%b9%8b%e5%b0%81%e8%a3%85%e6%8b%96%e6%8b%bd%e5%af%b9%e8%b1%a1"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2feezdnx695t4%2f&title=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%ef%bc%89%ef%bc%9a%e9%9d%a2%e5%90%91%e5%af%b9%e8%b1%a1%e5%ae%9e%e6%88%98%e4%b9%8b%e5%b0%81%e8%a3%85%e6%8b%96%e6%8b%bd%e5%af%b9%e8%b1%a1"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2feezdnx695t4%2f&is_video=false&description=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%ef%bc%89%ef%bc%9a%e9%9d%a2%e5%90%91%e5%af%b9%e8%b1%a1%e5%ae%9e%e6%88%98%e4%b9%8b%e5%b0%81%e8%a3%85%e6%8b%96%e6%8b%bd%e5%af%b9%e8%b1%a1"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%ef%bc%89%ef%bc%9a%e9%9d%a2%e5%90%91%e5%af%b9%e8%b1%a1%e5%ae%9e%e6%88%98%e4%b9%8b%e5%b0%81%e8%a3%85%e6%8b%96%e6%8b%bd%e5%af%b9%e8%b1%a1&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2feezdnx695t4%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2feezdnx695t4%2f&title=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%ef%bc%89%ef%bc%9a%e9%9d%a2%e5%90%91%e5%af%b9%e8%b1%a1%e5%ae%9e%e6%88%98%e4%b9%8b%e5%b0%81%e8%a3%85%e6%8b%96%e6%8b%bd%e5%af%b9%e8%b1%a1"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2feezdnx695t4%2f&title=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%ef%bc%89%ef%bc%9a%e9%9d%a2%e5%90%91%e5%af%b9%e8%b1%a1%e5%ae%9e%e6%88%98%e4%b9%8b%e5%b0%81%e8%a3%85%e6%8b%96%e6%8b%bd%e5%af%b9%e8%b1%a1"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2feezdnx695t4%2f&title=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%ef%bc%89%ef%bc%9a%e9%9d%a2%e5%90%91%e5%af%b9%e8%b1%a1%e5%ae%9e%e6%88%98%e4%b9%8b%e5%b0%81%e8%a3%85%e6%8b%96%e6%8b%bd%e5%af%b9%e8%b1%a1"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2feezdnx695t4%2f&title=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%ef%bc%89%ef%bc%9a%e9%9d%a2%e5%90%91%e5%af%b9%e8%b1%a1%e5%ae%9e%e6%88%98%e4%b9%8b%e5%b0%81%e8%a3%85%e6%8b%96%e6%8b%bd%e5%af%b9%e8%b1%a1"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">前端基础进阶（十）：面向对象实战之封装拖拽对象</h1><div class="meta"><div class="postdate"><time datetime="2018-12-19" itemprop="datePublished">2018-12-19</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008699587\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008699587\x22 alt=\x22终于\x22 title=\x22终于\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e前面几篇文章，我跟大家分享了JavaScript的一些基础知识，这篇文章，将会进入第一个实战环节：利用前面几章的所涉及到的知识，封装一个拖拽对象。为了能够帮助大家了解更多的方式与进行对比，我会使用三种不同的方式来实现拖拽。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e不封装对象直接实现；\x3c\/li\x3e\n\x3cli\x3e利用原生JavaScript封装拖拽对象；\x3c\/li\x3e\n\x3cli\x3e通过扩展jQuery来实现拖拽对象。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cblockquote\x3e本文的例子会放置于\x3ca href=\x22http:\/\/codepen.io\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ecodepen.io\x3c\/a\x3e中，供大家在阅读时直接查看。如果对于codepen不了解的同学，可以花点时间稍微了解一下。\x3c\/blockquote\x3e\n\x3cp\x3e拖拽的实现过程会涉及到非常多的实用小知识，因此为了巩固我自己的知识积累，也为了大家能够学到更多的知识，我会尽量详细的将一些细节分享出来，相信大家认真阅读之后，一定能学到一些东西。\x3c\/p\x3e\n\x3ch6\x3e1、如何让一个DOM元素动起来\x3c\/h6\x3e\n\x3cp\x3e我们常常会通过修改元素的\x3ccode\x3etop，left，translate\x3c\/code\x3e来其的位置发生改变。在下面的例子中，每点击一次按钮，对应的元素就会移动5px。大家可点击查看。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/codepen.io\/yangbo5207\/pen\/YZxGpO\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e点击查看一个让元素动起来的小例子\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22yangbo5207\/pen\/YZxGpO\x22 data-typeid=\x223\x22\x3e点击预览\x3c\/button\x3e\x3c\/p\x3e\n\x3cblockquote\x3e由于修改一个元素top\/left值会引起页面重绘，而translate不会，因此从性能优化上来判断，我们会优先使用translate属性。\x3c\/blockquote\x3e\n\x3ch6\x3e2、如何获取当前浏览器支持的transform兼容写法\x3c\/h6\x3e\n\x3cp\x3etransform是css3的属性，当我们使用它时就不得不面对兼容性的问题。不同版本浏览器的兼容写法大致有如下几种：\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3e [\x27transform\x27, \x27webkitTransform\x27, \x27MozTransform\x27, \x27msTransform\x27, \x27OTransform\x27]\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e因此我们需要判断当前浏览器环境支持的transform属性是哪一种，方法如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 获取当前浏览器支持的transform兼容写法\nfunction getTransform() {\n    var transform = \x27\x27,\n        divStyle = document.createElement(\x27div\x27).style,\n        \/\/ 可能涉及到的几种兼容性写法，通过循环找出浏览器识别的那一个\n        transformArr = [\x27transform\x27, \x27webkitTransform\x27, \x27MozTransform\x27, \x27msTransform\x27, \x27OTransform\x27],\n\n        i = 0,\n        len = transformArr.length;\n\n    for(; i \x3c len; i\x2b\x2b)  {\n        if(transformArr[i] in divStyle) {\n            \/\/ 找到之后立即返回，结束函数\n            return transform = transformArr[i];\n        }\n    }\n\n    \/\/ 如果没有找到，就直接返回空字符串\n    return transform;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取当前浏览器支持的transform兼容写法\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetTransform\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e transform = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e,\n        divStyle = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e).style,\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 可能涉及到的几种兼容性写法，通过循环找出浏览器识别的那一个\x3c\/span\x3e\n        transformArr = [\x3cspan class=\x22hljs-string\x22\x3e\x27transform\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27webkitTransform\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27MozTransform\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27msTransform\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27OTransform\x27\x3c\/span\x3e],\n\n        i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n        len = transformArr.length;\n\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(; i \x26lt; len; i\x2b\x2b)  {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(transformArr[i] \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e divStyle) {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 找到之后立即返回，结束函数\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e transform = transformArr[i];\n        }\n    }\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果没有找到，就直接返回空字符串\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e transform;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e该方法用于获取浏览器支持的transform属性。如果返回的为空字符串，则表示当前浏览器并不支持transform，这个时候我们就需要使用left，top值来改变元素的位置。如果支持，就改变transform的值。\x3c\/p\x3e\n\x3ch6\x3e3、 如何获取元素的初始位置\x3c\/h6\x3e\n\x3cp\x3e我们首先需要获取到目标元素的初始位置，因此这里我们需要一个专门用来获取元素样式的功能函数。\x3c\/p\x3e\n\x3cp\x3e但是获取元素样式在IE浏览器与其他浏览器有一些不同，因此我们需要一个兼容性的写法。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function getStyle(elem, property) {\n    \/\/ ie通过currentStyle来获取元素的样式，其他浏览器通过getComputedStyle来获取\n    return document.defaultView.getComputedStyle ? document.defaultView.getComputedStyle(elem, false)[property] : elem.currentStyle[property];\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetStyle\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eelem, property\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ie通过currentStyle来获取元素的样式，其他浏览器通过getComputedStyle来获取\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.defaultView.getComputedStyle ? \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.defaultView.getComputedStyle(elem, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e)[property] : elem.currentStyle[property];\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e有了这个方法之后，就可以开始动手写获取目标元素初始位置的方法了。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function getTargetPos(elem) {\n    var pos = {x: 0, y: 0};\n    var transform = getTransform();\n    if(transform) {\n        var transformValue = getStyle(elem, transform);\n        if(transformValue == \x27none\x27) {\n            elem.style[transform] = \x27translate(0, 0)\x27;\n            return pos;\n        } else {\n            var temp = transformValue.match(\/-?\\d\x2b\/g);\n            return pos = {\n                x: parseInt(temp[4].trim()),\n                y: parseInt(temp[5].trim())\n            }\n        }\n    } else {\n        if(getStyle(elem, \x27position\x27) == \x27static\x27) {\n            elem.style.position = \x27relative\x27;\n            return pos;\n        } else {\n            var x = parseInt(getStyle(elem, \x27left\x27) ? getStyle(elem, \x27left\x27) : 0);\n            var y = parseInt(getStyle(elem, \x27top\x27) ? getStyle(elem, \x27top\x27) : 0);\n            return pos = {\n                x: x,\n                y: y\n            }\n        }\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetTargetPos\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eelem\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e pos = {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e};\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e transform = getTransform();\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(transform) {\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e transformValue = getStyle(elem, transform);\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(transformValue == \x3cspan class=\x22hljs-string\x22\x3e\x27none\x27\x3c\/span\x3e) {\n            elem.style[transform] = \x3cspan class=\x22hljs-string\x22\x3e\x27translate(0, 0)\x27\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e pos;\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e temp = transformValue.match(\x3cspan class=\x22hljs-regexp\x22\x3e\/-?\\d\x2b\/g\x3c\/span\x3e);\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e pos = {\n                \x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eparseInt\x3c\/span\x3e(temp[\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e].trim()),\n                \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eparseInt\x3c\/span\x3e(temp[\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e].trim())\n            }\n        }\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(getStyle(elem, \x3cspan class=\x22hljs-string\x22\x3e\x27position\x27\x3c\/span\x3e) == \x3cspan class=\x22hljs-string\x22\x3e\x27static\x27\x3c\/span\x3e) {\n            elem.style.position = \x3cspan class=\x22hljs-string\x22\x3e\x27relative\x27\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e pos;\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e x = \x3cspan class=\x22hljs-built_in\x22\x3eparseInt\x3c\/span\x3e(getStyle(elem, \x3cspan class=\x22hljs-string\x22\x3e\x27left\x27\x3c\/span\x3e) ? getStyle(elem, \x3cspan class=\x22hljs-string\x22\x3e\x27left\x27\x3c\/span\x3e) : \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e y = \x3cspan class=\x22hljs-built_in\x22\x3eparseInt\x3c\/span\x3e(getStyle(elem, \x3cspan class=\x22hljs-string\x22\x3e\x27top\x27\x3c\/span\x3e) ? getStyle(elem, \x3cspan class=\x22hljs-string\x22\x3e\x27top\x27\x3c\/span\x3e) : \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e pos = {\n                \x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: x,\n                \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: y\n            }\n        }\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在拖拽过程中，我们需要不停的设置目标元素的新位置，这样它才会移动起来，因此我们需要一个设置目标元素位置的方法。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ pos = { x: 200, y: 100 }\nfunction setTargetPos(elem, pos) {\n    var transform = getTransform();\n    if(transform) {\n        elem.style[transform] = \x27translate(\x27\x2b pos.x \x2b\x27px, \x27\x2b pos.y \x2b\x27px)\x27;\n    } else {\n        elem.style.left = pos.x \x2b \x27px\x27;\n        elem.style.top = pos.y \x2b \x27px\x27;\n    }\n    return elem;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ pos = { x: 200, y: 100 }\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esetTargetPos\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eelem, pos\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e transform = getTransform();\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(transform) {\n        elem.style[transform] = \x3cspan class=\x22hljs-string\x22\x3e\x27translate(\x27\x3c\/span\x3e\x2b pos.x \x2b\x3cspan class=\x22hljs-string\x22\x3e\x27px, \x27\x3c\/span\x3e\x2b pos.y \x2b\x3cspan class=\x22hljs-string\x22\x3e\x27px)\x27\x3c\/span\x3e;\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        elem.style.left = pos.x \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27px\x27\x3c\/span\x3e;\n        elem.style.top = pos.y \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27px\x27\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e elem;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch6\x3e5、我们需要用到哪些事件？\x3c\/h6\x3e\n\x3cp\x3e在pc上的浏览器中，结合\x3ccode\x3emousedown、mousemove、mouseup\x3c\/code\x3e这三个事件可以帮助我们实现拖拽。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ccode\x3emousedown\x3c\/code\x3e 鼠标按下时触发\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3emousemove\x3c\/code\x3e 鼠标按下后拖动时触发\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3emouseup\x3c\/code\x3e 鼠标松开时触发\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cblockquote\x3e而在移动端，分别与之对应的则是\x3ccode\x3etouchstart、touchmove、touchend\x3c\/code\x3e。\x3c\/blockquote\x3e\n\x3cp\x3e当我们将元素绑定这些事件时，有一个事件对象将会作为参数传递给回调函数，通过事件对象，我们可以获取到当前鼠标的精确位置，鼠标位置信息是实现拖拽的关键。\x3c\/p\x3e\n\x3cblockquote\x3e事件对象十分重要，其中包含了非常多的有用的信息，这里我就不扩展了，大家可以在函数中将事件对象打印出来查看其中的具体属性，这个方法对于记不清事件对象重要属性的童鞋非常有用。\x3c\/blockquote\x3e\n\x3ch6\x3e6、拖拽的原理\x3c\/h6\x3e\n\x3cp\x3e当事件触发时，我们可以通过事件对象获取到鼠标的精切位置。这是实现拖拽的关键。当鼠标按下(mousedown触发)时，我们需要记住鼠标的初始位置与目标元素的初始位置，我们的目标就是实现当鼠标移动时，目标元素也跟着移动，根据常理我们可以得出如下关系：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22移动后的鼠标位置 - 鼠标初始位置 = 移动后的目标元素位置 - 目标元素的初始位置\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs fix\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-attr\x22\x3e移动后的鼠标位置 - 鼠标初始位置 \x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e 移动后的目标元素位置 - 目标元素的初始位置\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果鼠标位置的差值我们用dis来表示，那么目标元素的位置就等于：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22移动后目标元素的位置 = dis \x2b 目标元素的初始位置\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs fix\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-attr\x22\x3e移动后目标元素的位置 \x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e dis \x2b 目标元素的初始位置\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e通过事件对象，我们可以精确的知道鼠标的当前位置，因此当鼠标拖动(mousemove)时，我们可以不停的计算出鼠标移动的差值，以此来求出目标元素的当前位置。这个过程，就实现了拖拽。\x3c\/p\x3e\n\x3cp\x3e而在鼠标松开(mouseup)结束拖拽时，我们需要处理一些收尾工作。详情见代码。\x3c\/p\x3e\n\x3ch6\x3e7、 我又来推荐思维导图辅助写代码了\x3c\/h6\x3e\n\x3cp\x3e常常有新人朋友跑来问我，如果逻辑思维能力不强，能不能写代码做前端。我的答案是：能。因为借助思维导图，可以很轻松的弥补逻辑的短板。而且比在自己头脑中脑补逻辑更加清晰明了，不易出错。\x3c\/p\x3e\n\x3cp\x3e上面第六点我介绍了原理，因此如何做就显得不是那么难了，而具体的步骤，则在下面的思维导图中明确给出，我们只需要按照这个步骤来写代码即可，试试看，一定很轻松。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008699588\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008699588\x22 alt=\x22使用思维导图清晰的表达出整个拖拽过程我们需要干的事情\x22 title=\x22使用思维导图清晰的表达出整个拖拽过程我们需要干的事情\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch6\x3e8、代码实现\x3c\/h6\x3e\n\x3cp\x3e\x3cstrong\x3epart1、准备工作\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 获取目标元素对象\nvar oElem = document.getElementById(\x27target\x27);\n\n\/\/ 声明2个变量用来保存鼠标初始位置的x，y坐标\nvar startX = 0;\nvar startY = 0;\n\n\/\/ 声明2个变量用来保存目标元素初始位置的x，y坐标\nvar sourceX = 0;\nvar sourceY = 0;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取目标元素对象\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e oElem = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27target\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 声明2个变量用来保存鼠标初始位置的x，y坐标\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e startX = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e startY = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 声明2个变量用来保存目标元素初始位置的x，y坐标\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e sourceX = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e sourceY = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3epart2、功能函数\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e因为之前已经贴过代码，就不再重复\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 获取当前浏览器支持的transform兼容写法\nfunction getTransform() {}\n\n\/\/ 获取元素属性\nfunction getStyle(elem, property) {}\n\n\/\/ 获取元素的初始位置\nfunction getTargetPos(elem) {}\n\n\/\/ 设置元素的初始位置\nfunction setTargetPos(elem, potions) {}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取当前浏览器支持的transform兼容写法\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetTransform\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取元素属性\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetStyle\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eelem, property\x3c\/span\x3e) \x3c\/span\x3e{}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取元素的初始位置\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetTargetPos\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eelem\x3c\/span\x3e) \x3c\/span\x3e{}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置元素的初始位置\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esetTargetPos\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eelem, potions\x3c\/span\x3e) \x3c\/span\x3e{}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3epart3、声明三个事件的回调函数\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e这三个方法就是实现拖拽的核心所在，我将严格按照上面思维导图中的步骤来完成我们的代码。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 绑定在mousedown上的回调，event为传入的事件对象\nfunction start(event) {\n    \/\/ 获取鼠标初始位置\n    startX = event.pageX;\n    startY = event.pageY;\n\n    \/\/ 获取元素初始位置\n    var pos = getTargetPos(oElem);\n\n    sourceX = pos.x;\n    sourceY = pos.y;\n\n    \/\/ 绑定\n    document.addEventListener(\x27mousemove\x27, move, false);\n    document.addEventListener(\x27mouseup\x27, end, false);\n}\n\nfunction move(event) {\n    \/\/ 获取鼠标当前位置\n    var currentX = event.pageX;\n    var currentY = event.pageY;\n\n    \/\/ 计算差值\n    var distanceX = currentX - startX;\n    var distanceY = currentY - startY;\n\n    \/\/ 计算并设置元素当前位置\n    setTargetPos(oElem, {\n        x: (sourceX \x2b distanceX).toFixed(),\n        y: (sourceY \x2b distanceY).toFixed()\n    })\n}\n\nfunction end(event) {\n    document.removeEventListener(\x27mousemove\x27, move);\n    document.removeEventListener(\x27mouseup\x27, end);\n    \/\/ do other things\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绑定在mousedown上的回调，event为传入的事件对象\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3estart\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取鼠标初始位置\x3c\/span\x3e\n    startX = event.pageX;\n    startY = event.pageY;\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取元素初始位置\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e pos = getTargetPos(oElem);\n\n    sourceX = pos.x;\n    sourceY = pos.y;\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绑定\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mousemove\x27\x3c\/span\x3e, move, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mouseup\x27\x3c\/span\x3e, end, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emove\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取鼠标当前位置\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e currentX = event.pageX;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e currentY = event.pageY;\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 计算差值\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e distanceX = currentX - startX;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e distanceY = currentY - startY;\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 计算并设置元素当前位置\x3c\/span\x3e\n    setTargetPos(oElem, {\n        \x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: (sourceX \x2b distanceX).toFixed(),\n        \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: (sourceY \x2b distanceY).toFixed()\n    })\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eend\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.removeEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mousemove\x27\x3c\/span\x3e, move);\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.removeEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mouseup\x27\x3c\/span\x3e, end);\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ do other things\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eOK，一个简单的拖拽，就这样愉快的实现了。点击下面的链接，可以在线查看该例子的demo。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/codepen.io\/yangbo5207\/pen\/WpEoyd\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e使用原生js实现拖拽\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22yangbo5207\/pen\/WpEoyd\x22 data-typeid=\x223\x22\x3e点击预览\x3c\/button\x3e\x3c\/p\x3e\n\x3ch6\x3e9、封装拖拽对象\x3c\/h6\x3e\n\x3cp\x3e在前面一章我给大家分享了面向对象如何实现，基于那些基础知识，我们来将上面实现的拖拽封装为一个拖拽对象。我们的目标是，只要我们声明一个拖拽实例，那么传入的目标元素将自动具备可以被拖拽的功能。\x3c\/p\x3e\n\x3cp\x3e在实际开发中，一个对象我们常常会单独放在一个js文件中，这个js文件将单独作为一个模块，利用各种模块的方式组织起来使用。当然这里没有复杂的模块交互，因为这个例子，我们只需要一个模块即可。\x3c\/p\x3e\n\x3cp\x3e为了避免变量污染，我们需要将模块放置于一个函数自执行方式模拟的块级作用域中。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22;\n(function() {\n    ...\n})();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e;\n(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    ...\n})();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e在普通的模块组织中，我们只是单纯的将许多js文件压缩成为一个js文件，因此此处的第一个分号则是为了防止上一个模块的结尾不用分号导致报错。必不可少。当然在通过require或者ES6模块等方式就不会出现这样的情况。\x3c\/blockquote\x3e\n\x3cp\x3e我们知道，在封装一个对象的时候，我们可以将属性与方法放置于构造函数或者原型中，而在增加了自执行函数之后，我们又可以将属性和方法防止与模块的内部作用域。这是闭包的知识。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e那么我们面临的挑战就在于，如何合理的处理属性与方法的位置。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e当然，每一个对象的情况都不一样，不能一概而论，我们需要清晰的知道这三种位置的特性才能做出最适合的决定。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e构造函数中： 属性与方法为当前实例单独拥有，只能被当前实例访问，并且每声明一个实例，其中的方法都会被重新创建一次。\x3c\/li\x3e\n\x3cli\x3e原型中： 属性与方法为所有实例共同拥有，可以被所有实例访问，新声明实例不会重复创建方法。\x3c\/li\x3e\n\x3cli\x3e模块作用域中：属性和方法不能被任何实例访问，但是能被内部方法访问，新声明的实例，不会重复创建相同的方法。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e对于方法的判断比较简单。\x3c\/p\x3e\n\x3cp\x3e因为在构造函数中的方法总会在声明一个新的实例时被重复创建，因此我们声明的方法都尽量避免出现在构造函数中。\x3c\/p\x3e\n\x3cp\x3e而如果你的方法中需要用到构造函数中的变量，或者想要公开，那就需要放在原型中。\x3c\/p\x3e\n\x3cp\x3e如果方法需要私有不被外界访问，那么就放置在模块作用域中。\x3c\/p\x3e\n\x3cp\x3e对于属性放置于什么位置有的时候很难做出正确的判断，因此我很难给出一个准确的定义告诉你什么属性一定要放在什么位置，这需要在实际开发中不断的总结经验。但是总的来说，仍然要结合这三个位置的特性来做出最合适的判断。\x3c\/p\x3e\n\x3cp\x3e如果属性值只能被实例单独拥有，比如person对象的name，只能属于某一个person实例，又比如这里拖拽对象中，某一个元素的初始位置，也仅仅只是这个元素的当前位置，这个属性，则适合放在构造函数中。\x3c\/p\x3e\n\x3cp\x3e而如果一个属性仅仅供内部方法访问，这个属性就适合放在模块作用域中。\x3c\/p\x3e\n\x3cblockquote\x3e关于面向对象，上面的几点思考我认为是这篇文章最值得认真思考的精华。如果在封装时没有思考清楚，很可能会遇到很多你意想不到的bug，所以建议大家结合自己的开发经验，多多思考，总结出自己的观点。\x3c\/blockquote\x3e\n\x3cp\x3e根据这些思考，大家可以自己尝试封装一下。然后与我的做一些对比，看看我们的想法有什么不同，在下面例子的注释中，我将自己的想法表达出来。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/codepen.io\/yangbo5207\/pen\/LWjWpe\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e点击查看已经封装好的demo\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22yangbo5207\/pen\/LWjWpe\x22 data-typeid=\x223\x22\x3e点击预览\x3c\/button\x3e\x3c\/p\x3e\n\x3cp\x3ejs 源码\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22;\n(function() {\n    \/\/ 这是一个私有属性，不需要被实例访问\n    var transform = getTransform();\n\n    function Drag(selector) {\n        \/\/ 放在构造函数中的属性，都是属于每一个实例单独拥有\n        this.elem = typeof selector == \x27Object\x27 ? selector : document.getElementById(selector);\n        this.startX = 0;\n        this.startY = 0;\n        this.sourceX = 0;\n        this.sourceY = 0;\n\n        this.init();\n    }\n\n\n    \/\/ 原型\n    Drag.prototype = {\n        constructor: Drag,\n\n        init: function() {\n            \/\/ 初始时需要做些什么事情\n            this.setDrag();\n        },\n\n        \/\/ 稍作改造，仅用于获取当前元素的属性，类似于getName\n        getStyle: function(property) {\n            return document.defaultView.getComputedStyle ? document.defaultView.getComputedStyle(this.elem, false)[property] : this.elem.currentStyle[property];\n        },\n\n        \/\/ 用来获取当前元素的位置信息，注意与之前的不同之处\n        getPosition: function() {\n            var pos = {x: 0, y: 0};\n            if(transform) {\n                var transformValue = this.getStyle(transform);\n                if(transformValue == \x27none\x27) {\n                    this.elem.style[transform] = \x27translate(0, 0)\x27;\n                } else {\n                    var temp = transformValue.match(\/-?\\d\x2b\/g);\n                    pos = {\n                        x: parseInt(temp[4].trim()),\n                        y: parseInt(temp[5].trim())\n                    }\n                }\n            } else {\n                if(this.getStyle(\x27position\x27) == \x27static\x27) {\n                    this.elem.style.position = \x27relative\x27;\n                } else {\n                    pos = {\n                        x: parseInt(this.getStyle(\x27left\x27) ? this.getStyle(\x27left\x27) : 0),\n                        y: parseInt(this.getStyle(\x27top\x27) ? this.getStyle(\x27top\x27) : 0)\n                    }\n                }\n            }\n\n            return pos;\n        },\n\n        \/\/ 用来设置当前元素的位置\n        setPostion: function(pos) {\n            if(transform) {\n                this.elem.style[transform] = \x27translate(\x27\x2b pos.x \x2b\x27px, \x27\x2b pos.y \x2b\x27px)\x27;\n            } else {\n                this.elem.style.left = pos.x \x2b \x27px\x27;\n                this.elem.style.top = pos.y \x2b \x27px\x27;\n            }\n        },\n\n        \/\/ 该方法用来绑定事件\n        setDrag: function() {\n            var self = this;\n            this.elem.addEventListener(\x27mousedown\x27, start, false);\n            function start(event) {\n                self.startX = event.pageX;\n                self.startY = event.pageY;\n\n                var pos = self.getPosition();\n\n                self.sourceX = pos.x;\n                self.sourceY = pos.y;\n\n                document.addEventListener(\x27mousemove\x27, move, false);\n                document.addEventListener(\x27mouseup\x27, end, false);\n            }\n\n            function move(event) {\n                var currentX = event.pageX;\n                var currentY = event.pageY;\n\n                var distanceX = currentX - self.startX;\n                var distanceY = currentY - self.startY;\n\n                self.setPostion({\n                    x: (self.sourceX \x2b distanceX).toFixed(),\n                    y: (self.sourceY \x2b distanceY).toFixed()\n                })\n            }\n\n            function end(event) {\n                document.removeEventListener(\x27mousemove\x27, move);\n                document.removeEventListener(\x27mouseup\x27, end);\n                \/\/ do other things\n            }\n        }\n    }\n\n    \/\/ 私有方法，仅仅用来获取transform的兼容写法\n    function getTransform() {\n        var transform = \x27\x27,\n            divStyle = document.createElement(\x27div\x27).style,\n            transformArr = [\x27transform\x27, \x27webkitTransform\x27, \x27MozTransform\x27, \x27msTransform\x27, \x27OTransform\x27],\n\n            i = 0,\n            len = transformArr.length;\n\n        for(; i \x3c len; i\x2b\x2b)  {\n            if(transformArr[i] in divStyle) {\n                return transform = transformArr[i];\n            }\n        }\n\n        return transform;\n    }\n\n    \/\/ 一种对外暴露的方式\n    window.Drag = Drag;\n})();\n\n\/\/ 使用：声明2个拖拽实例\nnew Drag(\x27target\x27);\nnew Drag(\x27target2\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e;\n(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这是一个私有属性，不需要被实例访问\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e transform = getTransform();\n\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eDrag\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eselector\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 放在构造函数中的属性，都是属于每一个实例单独拥有\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elem = \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e selector == \x3cspan class=\x22hljs-string\x22\x3e\x27Object\x27\x3c\/span\x3e ? selector : \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(selector);\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.startX = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.startY = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.sourceX = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.sourceY = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.init();\n    }\n\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 原型\x3c\/span\x3e\n    Drag.prototype = {\n        \x3cspan class=\x22hljs-attr\x22\x3econstructor\x3c\/span\x3e: Drag,\n\n        \x3cspan class=\x22hljs-attr\x22\x3einit\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 初始时需要做些什么事情\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setDrag();\n        },\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 稍作改造，仅用于获取当前元素的属性，类似于getName\x3c\/span\x3e\n        getStyle: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eproperty\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.defaultView.getComputedStyle ? \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.defaultView.getComputedStyle(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elem, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e)[property] : \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elem.currentStyle[property];\n        },\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 用来获取当前元素的位置信息，注意与之前的不同之处\x3c\/span\x3e\n        getPosition: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e pos = {\x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e};\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(transform) {\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e transformValue = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getStyle(transform);\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(transformValue == \x3cspan class=\x22hljs-string\x22\x3e\x27none\x27\x3c\/span\x3e) {\n                    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elem.style[transform] = \x3cspan class=\x22hljs-string\x22\x3e\x27translate(0, 0)\x27\x3c\/span\x3e;\n                } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e temp = transformValue.match(\x3cspan class=\x22hljs-regexp\x22\x3e\/-?\\d\x2b\/g\x3c\/span\x3e);\n                    pos = {\n                        \x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eparseInt\x3c\/span\x3e(temp[\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e].trim()),\n                        \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eparseInt\x3c\/span\x3e(temp[\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e].trim())\n                    }\n                }\n            } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getStyle(\x3cspan class=\x22hljs-string\x22\x3e\x27position\x27\x3c\/span\x3e) == \x3cspan class=\x22hljs-string\x22\x3e\x27static\x27\x3c\/span\x3e) {\n                    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elem.style.position = \x3cspan class=\x22hljs-string\x22\x3e\x27relative\x27\x3c\/span\x3e;\n                } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                    pos = {\n                        \x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eparseInt\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getStyle(\x3cspan class=\x22hljs-string\x22\x3e\x27left\x27\x3c\/span\x3e) ? \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getStyle(\x3cspan class=\x22hljs-string\x22\x3e\x27left\x27\x3c\/span\x3e) : \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e),\n                        \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eparseInt\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getStyle(\x3cspan class=\x22hljs-string\x22\x3e\x27top\x27\x3c\/span\x3e) ? \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getStyle(\x3cspan class=\x22hljs-string\x22\x3e\x27top\x27\x3c\/span\x3e) : \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\n                    }\n                }\n            }\n\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e pos;\n        },\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 用来设置当前元素的位置\x3c\/span\x3e\n        setPostion: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3epos\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(transform) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elem.style[transform] = \x3cspan class=\x22hljs-string\x22\x3e\x27translate(\x27\x3c\/span\x3e\x2b pos.x \x2b\x3cspan class=\x22hljs-string\x22\x3e\x27px, \x27\x3c\/span\x3e\x2b pos.y \x2b\x3cspan class=\x22hljs-string\x22\x3e\x27px)\x27\x3c\/span\x3e;\n            } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elem.style.left = pos.x \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27px\x27\x3c\/span\x3e;\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elem.style.top = pos.y \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27px\x27\x3c\/span\x3e;\n            }\n        },\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 该方法用来绑定事件\x3c\/span\x3e\n        setDrag: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e self = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elem.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mousedown\x27\x3c\/span\x3e, start, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\n            \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3estart\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n                self.startX = event.pageX;\n                self.startY = event.pageY;\n\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e pos = self.getPosition();\n\n                self.sourceX = pos.x;\n                self.sourceY = pos.y;\n\n                \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mousemove\x27\x3c\/span\x3e, move, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\n                \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mouseup\x27\x3c\/span\x3e, end, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\n            }\n\n            \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emove\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e currentX = event.pageX;\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e currentY = event.pageY;\n\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e distanceX = currentX - self.startX;\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e distanceY = currentY - self.startY;\n\n                self.setPostion({\n                    \x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: (self.sourceX \x2b distanceX).toFixed(),\n                    \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: (self.sourceY \x2b distanceY).toFixed()\n                })\n            }\n\n            \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eend\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.removeEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mousemove\x27\x3c\/span\x3e, move);\n                \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.removeEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mouseup\x27\x3c\/span\x3e, end);\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ do other things\x3c\/span\x3e\n            }\n        }\n    }\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 私有方法，仅仅用来获取transform的兼容写法\x3c\/span\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetTransform\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e transform = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e,\n            divStyle = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e).style,\n            transformArr = [\x3cspan class=\x22hljs-string\x22\x3e\x27transform\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27webkitTransform\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27MozTransform\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27msTransform\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27OTransform\x27\x3c\/span\x3e],\n\n            i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n            len = transformArr.length;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(; i \x26lt; len; i\x2b\x2b)  {\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(transformArr[i] \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e divStyle) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e transform = transformArr[i];\n            }\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e transform;\n    }\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 一种对外暴露的方式\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.Drag = Drag;\n})();\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 使用：声明2个拖拽实例\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Drag(\x3cspan class=\x22hljs-string\x22\x3e\x27target\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Drag(\x3cspan class=\x22hljs-string\x22\x3e\x27target2\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样一个拖拽对象就封装完毕了。\x3c\/p\x3e\n\x3cp\x3e建议大家根据我提供的思维方式，多多尝试封装一些组件。比如封装一个弹窗，封装一个循环轮播等。练得多了，面向对象就不再是问题了。这种思维方式，在未来任何时候都是能够用到的。\x3c\/p\x3e\n\x3cp\x3e下一章分析jQuery对象的实现，与如何将我们这里封装的拖拽对象扩展为jQuery插件。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000012646488\x22\x3e前端基础进阶系列目录\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV0emY?w=800\x26amp;h=300\x22 src=\x22https:\/\/static.alili.tech\/img\/bV0emY?w=800\x26amp;h=300\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>前端基础进阶（十）：面向对象实战之封装拖拽对象</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000012646340">https://segmentfault.com/a/1190000012646340</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/eezdnx695t4/" target="_blank">https://alili.tech/archive/eezdnx695t4/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>