<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="使用 TypeScript 改造构建工具及测试用例"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>使用 TypeScript 改造构建工具及测试用例 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/f0ef0977/",
				"appid": "1613049289050283", 
				"title": "使用 TypeScript 改造构建工具及测试用例 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-10-23T00:00:00"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/eacdd004/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/d4881399/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2ff0ef0977%2f&text=%e4%bd%bf%e7%94%a8%20TypeScript%20%e6%94%b9%e9%80%a0%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7%e5%8f%8a%e6%b5%8b%e8%af%95%e7%94%a8%e4%be%8b"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2ff0ef0977%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2ff0ef0977%2f&text=%e4%bd%bf%e7%94%a8%20TypeScript%20%e6%94%b9%e9%80%a0%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7%e5%8f%8a%e6%b5%8b%e8%af%95%e7%94%a8%e4%be%8b"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2ff0ef0977%2f&title=%e4%bd%bf%e7%94%a8%20TypeScript%20%e6%94%b9%e9%80%a0%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7%e5%8f%8a%e6%b5%8b%e8%af%95%e7%94%a8%e4%be%8b"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2ff0ef0977%2f&is_video=false&description=%e4%bd%bf%e7%94%a8%20TypeScript%20%e6%94%b9%e9%80%a0%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7%e5%8f%8a%e6%b5%8b%e8%af%95%e7%94%a8%e4%be%8b"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%bd%bf%e7%94%a8%20TypeScript%20%e6%94%b9%e9%80%a0%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7%e5%8f%8a%e6%b5%8b%e8%af%95%e7%94%a8%e4%be%8b&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2ff0ef0977%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2ff0ef0977%2f&title=%e4%bd%bf%e7%94%a8%20TypeScript%20%e6%94%b9%e9%80%a0%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7%e5%8f%8a%e6%b5%8b%e8%af%95%e7%94%a8%e4%be%8b"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ff0ef0977%2f&title=%e4%bd%bf%e7%94%a8%20TypeScript%20%e6%94%b9%e9%80%a0%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7%e5%8f%8a%e6%b5%8b%e8%af%95%e7%94%a8%e4%be%8b"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ff0ef0977%2f&title=%e4%bd%bf%e7%94%a8%20TypeScript%20%e6%94%b9%e9%80%a0%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7%e5%8f%8a%e6%b5%8b%e8%af%95%e7%94%a8%e4%be%8b"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ff0ef0977%2f&title=%e4%bd%bf%e7%94%a8%20TypeScript%20%e6%94%b9%e9%80%a0%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7%e5%8f%8a%e6%b5%8b%e8%af%95%e7%94%a8%e4%be%8b"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文链接">原文链接</a></li><li><a href="#原文标题">原文标题</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">使用 TypeScript 改造构建工具及测试用例</h1><div class="meta"><div class="postdate"><time datetime="2018-10-23" itemprop="datePublished">2018-10-23</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e最近的一段时间一直在搞\x3ccode\x3eTypeScript\x3c\/code\x3e，一个巨硬出品、赋予\x3ccode\x3eJavaScript\x3c\/code\x3e语言静态类型和编译的语言。  \x3cbr\x3e第一个完全使用\x3ccode\x3eTypeScript\x3c\/code\x3e重构的纯\x3ccode\x3eNode.js\x3c\/code\x3e项目已经上线并稳定运行了。  \x3cbr\x3e第二个前后端的项目目前也在重构中，关于前端基于\x3ccode\x3ewebpack\x3c\/code\x3e的\x3ccode\x3eTypeScript\x3c\/code\x3e套路之前也有提到过：\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000016163937\x22\x3eTypeScript在react项目中的实践\x3c\/a\x3e。  \x3c\/p\x3e\n\x3cp\x3e但是这些做完以后也总感觉缺了点儿什么 _（没有尽兴）_：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/bVbgkU9?w=1984\x26amp;h=270\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbgkU9?w=1984\x26amp;h=270\x22 alt=\x22old-project-screenshot.png\x22 title=\x22old-project-screenshot.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e是的，依然有五分之一的\x3ccode\x3eJavaScript\x3c\/code\x3e代码存在于项目中，作为一个\x3ccode\x3eTypeScript\x3c\/code\x3e的示例项目，表现的很不纯粹。  \x3cbr\x3e所以有没有可能将这些\x3ccode\x3eJavaScript\x3c\/code\x3e代码也换成\x3ccode\x3eTypeScript\x3c\/code\x3e呢？  \x3cbr\x3e答案肯定是有的，首先需要分析这些代码都是什么：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ccode\x3eWebpack\x3c\/code\x3e打包时的配置文件\x3c\/li\x3e\n\x3cli\x3e一些简单的测试用例（使用的mocha和chai）\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e知道了是哪些地方还在使用\x3ccode\x3eJavaScript\x3c\/code\x3e，这件事儿就变得很好解决了，从构建工具（\x3ccode\x3eWebpack\x3c\/code\x3e）开始，逐个击破，将这些全部替换为\x3ccode\x3eTypeScript\x3c\/code\x3e。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3eWebpack 的 TypeScript 实现版本\x3c\/h2\x3e\n\x3cp\x3e在这\x3ccode\x3e8102\x3c\/code\x3e年，很幸福，\x3ccode\x3eWebpack\x3c\/code\x3e官方已经支持了\x3ccode\x3eTypeScript\x3c\/code\x3e编写配置文件，\x3ca href=\x22https:\/\/webpack.js.org\/configuration\/configuration-languages\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e文档地址\x3c\/a\x3e。  \x3cbr\x3e\x3cem\x3e除了\x3ccode\x3eTypeScript\x3c\/code\x3e以外还支持\x3ccode\x3eJSX\x3c\/code\x3e和\x3ccode\x3eCoffeeScript\x3c\/code\x3e的解释器，在这就忽略它们的存在了\x3c\/em\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e依赖的安装\x3c\/h3\x3e\n\x3cp\x3e首先是要安装\x3ccode\x3eTypeScript\x3c\/code\x3e相关的一套各种依赖，包括解释器及该语言的核心模块：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install -D typescript ts-node\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22bash hljs\x22\x3e\x3ccode class=\x22bash\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3enpm install -D typescript ts-node\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3etypescript\x3c\/code\x3e为这个语言的核心模块，\x3ccode\x3ets-node\x3c\/code\x3e用于直接执行\x3ccode\x3e.ts\x3c\/code\x3e文件，而不需要像\x3ccode\x3etsc\x3c\/code\x3e那样会编译输出\x3ccode\x3e.js\x3c\/code\x3e文件。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ts-node helloworld.ts\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22bash hljs\x22\x3e\x3ccode class=\x22bash\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3ets-node helloworld.ts\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e因为要在\x3ccode\x3eTypeScript\x3c\/code\x3e环境下使用\x3ccode\x3eWebpack\x3c\/code\x3e相关的东东，所以要安装对应的\x3ccode\x3etypes\x3c\/code\x3e。  \x3cbr\x3e也就是\x3ccode\x3eWebpack\x3c\/code\x3e所对应的那些\x3ccode\x3e*.d.ts\x3c\/code\x3e，用来告诉\x3ccode\x3eTypeScript\x3c\/code\x3e这是个什么对象，提供什么方法。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm i -D @types\/webpack\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22bash hljs\x22\x3e\x3ccode class=\x22bash\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3enpm i -D @types\/webpack\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cem\x3e一些常用的\x3ccode\x3epLugin\x3c\/code\x3e都会有对应的\x3ccode\x3e@types\x3c\/code\x3e文件，可以简单的通过\x3ccode\x3enpm info @types\/XXX\x3c\/code\x3e来检查是否存在\x3c\/em\x3e  \x3c\/p\x3e\n\x3cp\x3e如果是一些小众的\x3ccode\x3eplugin\x3c\/code\x3e，则可能需要自己创建对应的\x3ccode\x3ed.ts\x3c\/code\x3e文件，例如我们一直在用的\x3ccode\x3eqiniu-webpack-plugin\x3c\/code\x3e，这个就没有对应的\x3ccode\x3e@types\x3c\/code\x3e包的，所以就自己创建一个空文件来告诉\x3ccode\x3eTypeScript\x3c\/code\x3e这是个啥：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22declare module \x27qiniu-webpack-plugin\x27 \/\/ 就一个简单的定义即可\n\n\/\/ 如果还有其他的包，直接放到同一个文件就行了\n\/\/ 文件名也没有要求，保证是 d.ts 结尾即可\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3edeclare\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e \x27qiniu-webpack-plugin\x27 \/\/ 就一个简单的定义即可\n\n\/\/ 如果还有其他的包，直接放到同一个文件就行了\n\/\/ 文件名也没有要求，保证是 d.ts 结尾即可\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cem\x3e放置的位置没有什么限制，随便丢，一般建议放到\x3ccode\x3etypes\x3c\/code\x3e文件夹下\x3c\/em\x3e  \x3c\/p\x3e\n\x3cp\x3e最后就是\x3ccode\x3e.ts\x3c\/code\x3e文件在执行时的一些配置文件设置。   \x3cbr\x3e用来执行\x3ccode\x3eWebpack\x3c\/code\x3e的\x3ccode\x3e.ts\x3c\/code\x3e文件对\x3ccode\x3etsconfig.json\x3c\/code\x3e有一些小小的要求。  \x3cbr\x3e\x3ccode\x3ecompilerOptions\x3c\/code\x3e下的\x3ccode\x3etarget\x3c\/code\x3e选项必须是\x3ccode\x3ees5\x3c\/code\x3e，这个代表着输出的格式。  \x3cbr\x3e以及\x3ccode\x3emodule\x3c\/code\x3e要求选择\x3ccode\x3ecommonjs\x3c\/code\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;compilerOptions\x26quot;: {\n    \x26quot;module\x26quot;: \x26quot;commonjs\x26quot;,\n    \x26quot;target\x26quot;: \x26quot;es5\x26quot;,\n    \x26quot;esModuleInterop\x26quot;: true\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22json hljs\x22\x3e\x3ccode class=\x22json\x22\x3e{\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22compilerOptions\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22module\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22commonjs\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22target\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22es5\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22esModuleInterop\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e但一般来讲，执行\x3ccode\x3eWebpack\x3c\/code\x3e的同级目录都已经存在了\x3ccode\x3etsconfig.json\x3c\/code\x3e，用于实际的前端代码编译，很可能两个配置文件的参数并不一样。  \x3cbr\x3e如果因为要使用\x3ccode\x3eWebpack\x3c\/code\x3e去修改真正的代码配置参数肯定是不可取的。  \x3cbr\x3e所以我们就会用到这么一个包，用来改变\x3ccode\x3ets-node\x3c\/code\x3e执行时所依赖的配置文件：\x3ca href=\x22https:\/\/www.npmjs.com\/package\/tsconfig-paths\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etsconfig-paths\x3c\/a\x3e  \x3c\/p\x3e\n\x3cp\x3e在\x3ccode\x3eReadme\x3c\/code\x3e中发现了这样的说法：\x3ccode\x3eIf process.env.TS_NODE_PROJECT is set it will be used to resolved tsconfig.json\x3c\/code\x3e。  \x3cbr\x3e在\x3ccode\x3eWebpack\x3c\/code\x3e的文档中同样也提到了这句，所以这是一个兼容的方法，在命令运行时指定一个路径，在不影响原有配置的情况下创建一个供\x3ccode\x3eWebpack\x3c\/code\x3e打包时使用的配置。\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e将上述的配置文件改名为其它名称，\x3ccode\x3eWebpack\x3c\/code\x3e文档示例中为\x3ccode\x3etsconfig-for-webpack-config.json\x3c\/code\x3e，这里就直接沿用了\x3c\/li\x3e\n\x3cli\x3e然后添加\x3ccode\x3enpm script\x3c\/code\x3e如下\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;scripts\x26quot;: {\n    \x26quot;build\x26quot;: \x26quot;TS_NODE_PROJECT=tsconfig-for-webpack-config.json webpack --config configs.ts\x26quot;\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22json hljs\x22\x3e\x3ccode class=\x22json\x22\x3e{\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22scripts\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22build\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22TS_NODE_PROJECT=tsconfig-for-webpack-config.json webpack --config configs.ts\x22\x3c\/span\x3e\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e文件的编写\x3c\/h3\x3e\n\x3cp\x3e关于配置文件，从\x3ccode\x3eJavaScript\x3c\/code\x3e切换到\x3ccode\x3eTypeScript\x3c\/code\x3e实际上并不会有太大的改动，因为\x3ccode\x3eWebpack\x3c\/code\x3e的配置文件大多都是写死的文本\/常量。  \x3cbr\x3e很多类型都是自动生成的，基本可以不用手动指定，一个简单的示例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { Configuration } from \x27webpack\x27\n\nconst config: Configuration = {\n  mode: process.env.NODE_ENV === \x27production\x27 ? \x27production\x27 : \x27development\x27,\n}\n\nexport default config\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { Configuration } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27webpack\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e config: Configuration = {\n  mode: process.env.NODE_ENV === \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e ? \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27development\x27\x3c\/span\x3e,\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e config\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3eConfiguration\x3c\/code\x3e是一个\x3ccode\x3eWebpack\x3c\/code\x3e定义的接口（\x3ccode\x3einterface\x3c\/code\x3e），用来规范一个对象的行为。  \x3cbr\x3e在\x3ccode\x3eVS Code\x3c\/code\x3e下按住\x3ccode\x3eCommand\x3c\/code\x3e \x2b 单击可以直接跳转到具体的\x3ccode\x3ewebpack.d.ts\x3c\/code\x3e定义文件那里，可以看到详细的定义信息。  \x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/bVbgkWT?w=1790\x26amp;h=1068\x22 del-src=\x22https:\/\/static.alili.tech\/v-5bbf1b3b\/global\/img\/squares.svg\x22 alt=\x22webpack-declare.png\x22 title=\x22webpack-declare.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e各种常用的规则都写在了这里，使用\x3ccode\x3eTypeScript\x3c\/code\x3e的一个好处就是，当要实现一个功能时你不再需要去网站上查询应该要配置什么，可以直接翻看\x3ccode\x3ed.ts\x3c\/code\x3e的定义。  \x3cbr\x3e如果注释写得足够完善，基本可以当成文档来用了，而且在\x3ccode\x3eVS Code\x3c\/code\x3e编辑器中还有动态的提示，以及一些错误的纠正，比如上述的\x3ccode\x3eNODE_ENV\x3c\/code\x3e的获取，如果直接写\x3ccode\x3eprocess.env.NODE_ENV || \x27development\x27\x3c\/code\x3e是会抛出一个异常的，因为从\x3ccode\x3ed.ts\x3c\/code\x3e中可以看到，关于\x3ccode\x3emode\x3c\/code\x3e只有三个有效值\x3ccode\x3eproduction\x3c\/code\x3e、\x3ccode\x3edevelopemnt\x3c\/code\x3e和\x3ccode\x3enone\x3c\/code\x3e，而\x3ccode\x3eprocess.env.NODE_ENV\x3c\/code\x3e显然只是一个字符串类型的变量。  \x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/bVbgkVj?w=1082\x26amp;h=502\x22 del-src=\x22https:\/\/static.alili.tech\/v-5bbf1b3b\/global\/img\/squares.svg\x22 alt=\x22warning-tips.png\x22 title=\x22warning-tips.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e所以我们需要使用三元运算符保证传入的参数一定是我们想要的。  \x3c\/p\x3e\n\x3cp\x3e以及在编写的过程中，如果有一些自定义的\x3ccode\x3eplugin\x3c\/code\x3e之类的，可能在使用的过程中会抛异常提示说某个对象不是有效的\x3ccode\x3ePlugin\x3c\/code\x3e对象，一个很简单的方法，在对应的\x3ccode\x3eplugin\x3c\/code\x3e后边添加一个\x3ccode\x3eas webpack.Plugin\x3c\/code\x3e即可。  \x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e在这里\x3ccode\x3eTypeScript\x3c\/code\x3e所做的只是静态的检查，并不会对实际的代码执行造成任何影响，就算类型因为强行\x3ccode\x3eas\x3c\/code\x3e而改变，也只是编译期的修改，在实际执行的\x3ccode\x3eJavaScript\x3c\/code\x3e代码中还是弱类型的\x3c\/strong\x3e   \x3c\/p\x3e\n\x3cp\x3e在完成了上述的操作后，再执行\x3ccode\x3enpm run XXX\x3c\/code\x3e就可以直接运行\x3ccode\x3eTypeScript\x3c\/code\x3e版本的\x3ccode\x3eWebpack\x3c\/code\x3e配置咯。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e探索期间的一件趣事\x3c\/h3\x3e\n\x3cp\x3e因为我的项目根目录已经安装了\x3ccode\x3ets-node\x3c\/code\x3e，而前端项目是作为其中的一个文件夹存在的，所以就没有再次进行安装。  \x3cbr\x3e这就带来了一个令人吐血的问题。  \x3c\/p\x3e\n\x3cp\x3e首先全部流程走完以后，我直接在命令行中输入\x3ccode\x3eTS_NODE_PROJECT=XXX.json NODE_ENV=dev webpack --config .\/webpack\/dev.ts\x3c\/code\x3e  \x3cbr\x3e完美运行，然后将这行命令放到了\x3ccode\x3enpm scripts\x3c\/code\x3e中：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;scripts\x26quot;: {\n    \x26quot;start\x26quot;: \x26quot;TS_NODE_PROJECT=XXX.json NODE_ENV=dev webpack --config .\/webpack\/dev.ts\x26quot;\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22json hljs\x22\x3e\x3ccode class=\x22json\x22\x3e{\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22scripts\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22start\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22TS_NODE_PROJECT=XXX.json NODE_ENV=dev webpack --config .\/webpack\/dev.ts\x22\x3c\/span\x3e\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e再次运行\x3ccode\x3enpm start\x3c\/code\x3e，发现竟然出错了-.-，提示我说\x3ccode\x3eimport\x3c\/code\x3e语法不能被识别，这个很显然就是没有应用我们在\x3ccode\x3ets_NODE_PROJECT\x3c\/code\x3e中指定的\x3ccode\x3econfig\x3c\/code\x3e文件。  \x3cbr\x3e刚开始并不知道问题出在哪，因为这个在命令行中直接执行并没有任何问题。  \x3cbr\x3e期间曾经怀疑是否是环境变量没有被正确设置，还使用了\x3ccode\x3ecross-env\x3c\/code\x3e这个插件，甚至将命令写到了一个\x3ccode\x3esh\x3c\/code\x3e文件中进行执行。  \x3cbr\x3e然而问题依然存在，后来在一个群中跟小伙伴们聊起了这个问题，有人提出，__你是不是全局安装了\x3ccode\x3ets-node\x3c\/code\x3e__。  \x3cbr\x3e检查以后发现，果然是的，在命令行执行时使用的是全局的\x3ccode\x3ets-node\x3c\/code\x3e，但是在\x3ccode\x3enpm scripts\x3c\/code\x3e中使用的是本地的\x3ccode\x3ets-node\x3c\/code\x3e。  \x3cbr\x3e在命令行环境执行时还以为是会自动寻找父文件夹\x3ccode\x3enode_modules\x3c\/code\x3e下边的依赖，其实是使用的全局包。  \x3cbr\x3e乖乖的在\x3ccode\x3eclient-src\x3c\/code\x3e文件夹下也安装了\x3ccode\x3ets-node\x3c\/code\x3e就解决了这个问题。  \x3cbr\x3e\x3cem\x3e全局依赖害人。。\x3c\/em\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e测试用例的改造\x3c\/h2\x3e\n\x3cp\x3e前边的\x3ccode\x3eWebpack\x3c\/code\x3e改为\x3ccode\x3eTypeScript\x3c\/code\x3e大多数原因是因为强迫症所致。  \x3cbr\x3e但是测试用例的\x3ccode\x3eTypeScript\x3c\/code\x3e改造则是一个能极大提高效率的操作。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e为什么要在测试用例中使用 TypeScript\x3c\/h3\x3e\n\x3cp\x3e测试用例使用\x3ccode\x3echai\x3c\/code\x3e来编写，_（之前的\x3ccode\x3ePostman\x3c\/code\x3e也是用的\x3ccode\x3echai\x3c\/code\x3e的语法）_  \x3cbr\x3e\x3ccode\x3echai\x3c\/code\x3e提供了一系列的语义化链式调用来实现断言。  \x3cbr\x3e在之前的分享中也提到过，这么多的命令你并不需要完全记住，只知道一个\x3ccode\x3eexpect(XXX).to.equal(true)\x3c\/code\x3e就够了。  \x3c\/p\x3e\n\x3cp\x3e但是这样的通篇\x3ccode\x3eto.equal(true)\x3c\/code\x3e是巨丑无比的，而如果使用那些语义化的链式调用，在不熟练的情况下很容易就会得到：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Error: XXX.XXX is not a function\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22bash hljs\x22\x3e\x3ccode class=\x22bash\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eError: XXX.XXX is not a \x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e因为这确实有一个门槛问题，必须要写很多才能记住调用规则，各种\x3ccode\x3enot\x3c\/code\x3e、\x3ccode\x3eincludes\x3c\/code\x3e的操作。  \x3cbr\x3e但是接入了\x3ccode\x3eTypeScript\x3c\/code\x3e以后，这些问题都迎刃而解了。  \x3cbr\x3e也是前边提到的，所有的\x3ccode\x3eTypeScript\x3c\/code\x3e模块都有其对应的\x3ccode\x3e.d.ts\x3c\/code\x3e文件，用来告诉我们这个模块是做什么的，提供了什么可以使用。  \x3cbr\x3e也就是说在测试用例编写时，我们可以通过动态提示来快速的书写断言，而不需要结合着文档去进行“翻译”。  \x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/bVbgkVl?w=1298\x26amp;h=152\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbgkVl?w=1298\x26amp;h=152\x22 alt=\x22chai-tips.png\x22 title=\x22chai-tips.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/bVbgkVo?w=1086\x26amp;h=196\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbgkVo?w=1086\x26amp;h=196\x22 alt=\x22chai-warning.png\x22 title=\x22chai-warning.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e使用方式\x3c\/h3\x3e\n\x3cp\x3e如果是之前有写过\x3ccode\x3emocha\x3c\/code\x3e和\x3ccode\x3echai\x3c\/code\x3e的童鞋，基本上修改文件后缀\x2b安装对应的\x3ccode\x3e@types\x3c\/code\x3e即可。  \x3cbr\x3e可以直接跳到这里来：\x3ca href=\x22#%E5%BC%80%E5%A7%8B%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC\x22\x3e开始编写测试脚本\x3c\/a\x3e  \x3cbr\x3e但是如果对测试用例感兴趣，但是并没有使用过的童鞋，可以看下边的一个基本步骤。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e安装依赖\x3c\/h3\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3ccode\x3eTypeScript\x3c\/code\x3e相关的安装，\x3ccode\x3enpm i -D typescript ts-node\x3c\/code\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eMocha\x3c\/code\x3e、\x3ccode\x3echai\x3c\/code\x3e相关的安装，\x3ccode\x3enpm i -D mocha chai @types\/mocha @types\/chai\x3c\/code\x3e\n\x3c\/li\x3e\n\x3cli\x3e如果需要涉及到一些API的请求，可以额外安装\x3ccode\x3echai-http\x3c\/code\x3e，\x3ccode\x3enpm i -D chai-http @types\/chai-http\x3c\/code\x3e\n\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e环境的依赖就已经完成了，如果额外的使用一些其他的插件，记得安装对应的\x3ccode\x3e@types\x3c\/code\x3e文件即可。  \x3cbr\x3e\x3cem\x3e如果有使用ESLint之类的插件，可能会提示\x3ccode\x3emodules\x3c\/code\x3e必须存在于\x3ccode\x3edependencies\x3c\/code\x3e而非\x3ccode\x3edevDependencies\x3c\/code\x3e\x3c\/em\x3e  \x3cbr\x3e这是ESLint的\x3ccode\x3eimport\/no-extraneous-dependencies\x3c\/code\x3e规则导致的，针对这个，我们目前的方案是添加一些例外：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import\/no-extraneous-dependencies:\n  - 2\n  - devDependencies:\n    - \x26quot;**\/*.test.js\x26quot;\n    - \x26quot;**\/*.spec.js\x26quot;\n    - \x26quot;**\/webpack*\x26quot;\n    - \x26quot;**\/webpack\/*\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22yaml hljs\x22\x3e\x3ccode class=\x22yaml\x22\x3e\x3cspan class=\x22hljs-string\x22\x3eimport\/no-extraneous-dependencies:\x3c\/span\x3e\n\x3cspan class=\x22hljs-bullet\x22\x3e  -\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e  - devDependencies:\x3c\/span\x3e\n\x3cspan class=\x22hljs-bullet\x22\x3e    -\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22**\/*.test.js\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-bullet\x22\x3e    -\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22**\/*.spec.js\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-bullet\x22\x3e    -\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22**\/webpack*\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-bullet\x22\x3e    -\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22**\/webpack\/*\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e针对这些目录下的文件\/文件夹不进行校验。_是的，webpack的使用也会遇到这个问题_\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e开始编写测试脚本\x3c\/h3\x3e\n\x3cp\x3e如果是对原有的测试脚本进行修改，无外乎修改后缀、添加一些必要的类型声明，不会对逻辑造成任何修改。\x3c\/p\x3e\n\x3ch4\x3e一个简单的示例\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ number-comma.ts\nexport default (num: number | string) =\x3e String(num).replace(\/\\B(?=(\\d{3})\x2b$)\/g, \x27,\x27)\n\n\/\/ number-comma.spec.ts\nimport chai from \x27chai\x27\nimport numberComma from \x27.\/number-comma\x27\n\nconst { expect } = chai\n\n\/\/ 测试项\ndescribe(\x27number-comma\x27, () =\x3e {\n  \/\/ 子项目1\n  it(\x27`1234567` should transform to `1,234,567`\x27, done =\x3e {\n    expect(numberComma(1234567)).to.equal(\x271,234,567\x27)\n    done()\n  })\n\n  \/\/ 子项目2\n  it(\x27`123` should never transform\x27, done =\x3e {\n    const num = 123\n    expect(numberComma(num)).to.equal(String(num))\n    done()\n  })\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ number-comma.ts\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e (num: \x3cspan class=\x22hljs-built_in\x22\x3enumber\x3c\/span\x3e | \x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e) =\x26gt; \x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e(num).replace(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\B(?=(\\d{3})\x2b$)\/g\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27,\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ number-comma.spec.ts\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e chai \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27chai\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e numberComma \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/number-comma\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e { expect } = chai\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 测试项\x3c\/span\x3e\ndescribe(\x3cspan class=\x22hljs-string\x22\x3e\x27number-comma\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 子项目1\x3c\/span\x3e\n  it(\x3cspan class=\x22hljs-string\x22\x3e\x27`1234567` should transform to `1,234,567`\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3edone\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    expect(numberComma(\x3cspan class=\x22hljs-number\x22\x3e1234567\x3c\/span\x3e)).to.equal(\x3cspan class=\x22hljs-string\x22\x3e\x271,234,567\x27\x3c\/span\x3e)\n    done()\n  })\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 子项目2\x3c\/span\x3e\n  it(\x3cspan class=\x22hljs-string\x22\x3e\x27`123` should never transform\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3edone\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e num = \x3cspan class=\x22hljs-number\x22\x3e123\x3c\/span\x3e\n    expect(numberComma(num)).to.equal(\x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e(num))\n    done()\n  })\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e如果全局没有安装\x3ccode\x3emocha\x3c\/code\x3e，记得将命令写到\x3ccode\x3enpm script\x3c\/code\x3e中，或者通过下述方式执行\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22.\/node_modules\/mocha\/bin\/mocha -r ts-node\/register test\/number-comma.spec.ts\n\n# 如果直接这样写，会抛出异常提示 mocha 不是命令\nmocha -r ts-node\/register test\/number-comma.spec.ts\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22bash hljs\x22\x3e\x3ccode class=\x22bash\x22\x3e.\/node_modules\/mocha\/bin\/mocha -r ts-node\/register \x3cspan class=\x22hljs-built_in\x22\x3etest\x3c\/span\x3e\/number-comma.spec.ts\n\n\x3cspan class=\x22hljs-comment\x22\x3e# 如果直接这样写，会抛出异常提示 mocha 不是命令\x3c\/span\x3e\nmocha -r ts-node\/register \x3cspan class=\x22hljs-built_in\x22\x3etest\x3c\/span\x3e\/number-comma.spec.ts\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3emocha\x3c\/code\x3e有一点儿比较好的是提供了\x3ccode\x3e-r\x3c\/code\x3e命令来让你手动指定执行测试用例脚本所使用的解释器，这里直接设置为\x3ccode\x3ets-node\x3c\/code\x3e的路径\x3ccode\x3ets-node\/register\x3c\/code\x3e，然后就可以在后边直接跟一个文件名（或者是一些通配符）。  \x3c\/p\x3e\n\x3cp\x3e目前我们在项目中批量执行测试用例的命令如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;scripts\x26quot;: {\n    \x26quot;test\x26quot;: \x26quot;mocha -r ts-node\/register test\/**\/*.spec.ts\x26quot;\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22json hljs\x22\x3e\x3ccode class=\x22json\x22\x3e{\n  \x3cspan class=\x22hljs-attr\x22\x3e\x22scripts\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3e\x22test\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22mocha -r ts-node\/register test\/**\/*.spec.ts\x22\x3c\/span\x3e\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cem\x3e\x3ccode\x3enpm test\x3c\/code\x3e可以直接调用，而不需要添加\x3ccode\x3erun\x3c\/code\x3e命令符，类似的还有\x3ccode\x3estart\x3c\/code\x3e、\x3ccode\x3ebuild\x3c\/code\x3e等等\x3c\/em\x3e  \x3c\/p\x3e\n\x3cp\x3e一键执行以后就可以得到我们想要的结果了，再也不用担心一些代码的改动会影响到其他模块的逻辑了 \x3cstrong\x3e（前提是认真写测试用例）\x3c\/strong\x3e  \x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/bVbgkVw?w=696\x26amp;h=248\x22 del-src=\x22https:\/\/static.alili.tech\/v-5bbf1b3b\/global\/img\/squares.svg\x22 alt=\x22mocha-results.png\x22 title=\x22mocha-results.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e小结\x3c\/h2\x3e\n\x3cp\x3e做完上边两步的操作以后，我们的项目就实现了100%的\x3ccode\x3eTypeScript\x3c\/code\x3e化，在任何地方享受静态编译语法所带来的好处。  \x3cbr\x3e附上更新后的代码含量截图：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/bVbgkVz?w=1982\x26amp;h=276\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbgkVz?w=1982\x26amp;h=276\x22 alt=\x22new-project-screenshot.png\x22 title=\x22new-project-screenshot.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e最近针对\x3ccode\x3eTypeScript\x3c\/code\x3e做了很多事情，从\x3ccode\x3eNode.js\x3c\/code\x3e、\x3ccode\x3eReact\x3c\/code\x3e以及这次的\x3ccode\x3eWebpack\x3c\/code\x3e与\x3ccode\x3eMocha\x2bChai\x3c\/code\x3e。  \x3cbr\x3e\x3ccode\x3eTypeScript\x3c\/code\x3e因为其存在一个编译的过程，极大的降低了代码出bug的可能性，提高程序的稳定度。  \x3cbr\x3e全面切换到\x3ccode\x3eTypeScript\x3c\/code\x3e更是能够降低在两种语法之间互相切换时所带来的不必要的消耗，祝大家搬砖愉快。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e之前关于 TypeScript 的笔记\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000015719697\x22\x3eTypeScript在node项目中的实践\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000016163937\x22 target=\x22_blank\x22\x3eTypeScript在react项目中的实践\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e一个完整的 TypeScript 示例\x3c\/h3\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/jiasm\/typescript-example\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etypescript-example\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e欢迎各位来讨论关于\x3ccode\x3eTypeScript\x3c\/code\x3e使用上的一些问题，针对稳重的感觉不足之处也欢迎指出。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e参考资料\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/www.npmjs.com\/package\/ts-node\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ets-node\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/webpack.js.org\/configuration\/configuration-languages\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3econfiguration-languages | webpack\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/mochajs.org\/#getting-started\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3emochajs\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.chaijs.com\/api\/bdd\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3echaijs\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000016247815">https://segmentfault.com/a/1190000016247815</a></p><h2 id="原文标题">原文标题</h2><p>使用 TypeScript 改造构建工具及测试用例</p><h2>本文链接：</h2><a href="https://alili.tech/archive/f0ef0977/" target="_blank">https://alili.tech/archive/f0ef0977/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>