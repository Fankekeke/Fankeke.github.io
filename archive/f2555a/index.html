<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | å‰ç«¯å¤§çˆ†ç‚¸! - WEB BANG! BANG!! BANG!!! å‰ç«¯å¤§çˆ†ç‚¸,ä¸€ä¸ªå‰ç«¯æŠ€æœ¯åšå®¢.æƒ³åˆ°å“ª,å­¦åˆ°å“ª,å†™åˆ°å“ª. æœ¬æ–‡èµ„æºæ¥æºäº’è”ç½‘ï¼Œä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œç‰ˆæƒå½’è¯¥èµ„æºçš„åˆæ³•æ‹¥æœ‰è€…æ‰€æœ‰ï¼Œ Alili, å‰ç«¯å¤§çˆ†ç‚¸, WEB BANG BANG BANG, webå‰ç«¯åšå®¢, å‰ç«¯æ¨¡å—åŒ–, å‰ç«¯å·¥ç¨‹åŒ–, å‰ç«¯æ•°æ®ç›‘æ§, æ€§èƒ½ä¼˜åŒ–, ç½‘é¡µåˆ¶ä½œ, å‰ç«¯, js, html5, css"><meta name="keywords" content="Alili, å‰ç«¯å¤§çˆ†ç‚¸, WEB BANG BANG BANG, webå‰ç«¯åšå®¢, å‰ç«¯æ¨¡å—åŒ–, å‰ç«¯å·¥ç¨‹åŒ–, å‰ç«¯æ•°æ®ç›‘æ§, æ€§èƒ½ä¼˜åŒ–, ç½‘é¡µåˆ¶ä½œ, å‰ç«¯, js, html5, css, è¸©å‘å°æŠ¥å‘Š, å¾®å‰ç«¯, æ ‘è“æ´¾, å‰ç«¯å¼€å‘, åŒºå—é“¾, ç½‘ç»œ, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Node.js äº‹ä»¶å¾ªç¯å·¥ä½œæµç¨‹ &amp; ç”Ÿå‘½å‘¨æœŸ -- Void Canvas"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | å‰ç«¯å¤§çˆ†ç‚¸! - WEB BANG! BANG!! BANG!!! å‰ç«¯å¤§çˆ†ç‚¸,ä¸€ä¸ªå‰ç«¯æŠ€æœ¯åšå®¢.æƒ³åˆ°å“ª,å­¦åˆ°å“ª,å†™åˆ°å“ª. æœ¬æ–‡èµ„æºæ¥æºäº’è”ç½‘ï¼Œä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œç‰ˆæƒå½’è¯¥èµ„æºçš„åˆæ³•æ‹¥æœ‰è€…æ‰€æœ‰ï¼Œ Alili, å‰ç«¯å¤§çˆ†ç‚¸, WEB BANG BANG BANG, webå‰ç«¯åšå®¢, å‰ç«¯æ¨¡å—åŒ–, å‰ç«¯å·¥ç¨‹åŒ–, å‰ç«¯æ•°æ®ç›‘æ§, æ€§èƒ½ä¼˜åŒ–, ç½‘é¡µåˆ¶ä½œ, å‰ç«¯, js, html5, css"><meta property="og:site_name" content="Alili"><title>Node.js äº‹ä»¶å¾ªç¯å·¥ä½œæµç¨‹ &amp; ç”Ÿå‘½å‘¨æœŸ -- Void Canvas | å‰ç«¯å¤§çˆ†ç‚¸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/f2555a/",
				"appid": "1613049289050283", 
				"title": "Node.js äº‹ä»¶å¾ªç¯å·¥ä½œæµç¨‹ &amp; ç”Ÿå‘½å‘¨æœŸ -- Void Canvas | å‰ç«¯å¤§çˆ†ç‚¸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-10-18T00:00:00"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/b821ddf1/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/f2571b7a/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2ff2555a%2f&text=Node.js%20%e4%ba%8b%e4%bb%b6%e5%be%aa%e7%8e%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b%20%26%20%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f%20--%20Void%20Canvas"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2ff2555a%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2ff2555a%2f&text=Node.js%20%e4%ba%8b%e4%bb%b6%e5%be%aa%e7%8e%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b%20%26%20%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f%20--%20Void%20Canvas"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2ff2555a%2f&title=Node.js%20%e4%ba%8b%e4%bb%b6%e5%be%aa%e7%8e%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b%20%26%20%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f%20--%20Void%20Canvas"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2ff2555a%2f&is_video=false&description=Node.js%20%e4%ba%8b%e4%bb%b6%e5%be%aa%e7%8e%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b%20%26%20%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f%20--%20Void%20Canvas"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Node.js%20%e4%ba%8b%e4%bb%b6%e5%be%aa%e7%8e%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b%20%26%20%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f%20--%20Void%20Canvas&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2ff2555a%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2ff2555a%2f&title=Node.js%20%e4%ba%8b%e4%bb%b6%e5%be%aa%e7%8e%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b%20%26%20%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f%20--%20Void%20Canvas"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ff2555a%2f&title=Node.js%20%e4%ba%8b%e4%bb%b6%e5%be%aa%e7%8e%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b%20%26%20%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f%20--%20Void%20Canvas"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ff2555a%2f&title=Node.js%20%e4%ba%8b%e4%bb%b6%e5%be%aa%e7%8e%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b%20%26%20%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f%20--%20Void%20Canvas"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ff2555a%2f&title=Node.js%20%e4%ba%8b%e4%bb%b6%e5%be%aa%e7%8e%af%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b%20%26%20%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f%20--%20Void%20Canvas"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#ç‰ˆæƒå£°æ˜">ç‰ˆæƒå£°æ˜</a></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Node.js äº‹ä»¶å¾ªç¯å·¥ä½œæµç¨‹ &amp; ç”Ÿå‘½å‘¨æœŸ -- Void Canvas</h1><div class="meta"><div class="postdate"><time datetime="2018-10-18" itemprop="datePublished">2018-10-18</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | å‰ç«¯å¤§çˆ†ç‚¸! - WEB BANG! BANG!! BANG!!! å‰ç«¯å¤§çˆ†ç‚¸,ä¸€ä¸ªå‰ç«¯æŠ€æœ¯åšå®¢.æƒ³åˆ°å“ª,å­¦åˆ°å“ª,å†™åˆ°å“ª. æœ¬æ–‡èµ„æºæ¥æºäº’è”ç½‘ï¼Œä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œç‰ˆæƒå½’è¯¥èµ„æºçš„åˆæ³•æ‹¥æœ‰è€…æ‰€æœ‰ï¼Œ Alili, å‰ç«¯å¤§çˆ†ç‚¸, WEB BANG BANG BANG, webå‰ç«¯åšå®¢, å‰ç«¯æ¨¡å—åŒ–, å‰ç«¯å·¥ç¨‹åŒ–, å‰ç«¯æ•°æ®ç›‘æ§, æ€§èƒ½ä¼˜åŒ–, ç½‘é¡µåˆ¶ä½œ, å‰ç«¯, js, html5, css, è¸©å‘å°æŠ¥å‘Š, å¾®å‰ç«¯, æ ‘è“æ´¾, å‰ç«¯å¼€å‘, åŒºå—é“¾, ç½‘ç»œ, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3cp\x3eä¸€å¹´å‰åœ¨æè¿°  \x3ca href=\x22http:\/\/voidcanvas.com\/setimmediate-vs-nexttick-vs-settimeout\/\x22\x3esetImmediate \x26amp; process.nextTick\x3c\/a\x3e çš„åŒºåˆ«æ—¶ï¼Œæˆ‘å†™äº†ä¸€äº›å…³äºå…·ä½“çš„ node çš„äº‹ä»¶å¾ªç¯çš„æ¶æ„ã€‚å‡ºä¹æˆ‘çš„æ„æ–™ï¼Œè¯»è¿‡é‚£ç¯‡æ–‡ç« çš„è¯»è€…å¯¹äºäº‹ä»¶å¾ªç¯çš„è¿™ä¸€éƒ¨åˆ†å˜å¾—æ›´åŠ æœ‰å…´è¶£ï¼Œæˆ‘æ”¶åˆ°äº†å¾ˆå¤šåé¦ˆï¼Œä¹Ÿæœ‰å¾ˆå¤šè¯»è€…åœ¨ç«™å†…æœç´¢ç›¸åº”çš„å…³é”®è¯ï¼Œè¿™å°±æ˜¯æˆ‘ä¸ºä»€ä¹ˆå†³å®šå›æ¥å†™ nodejs çš„äº‹ä»¶å¾ªç¯çš„å·¥ä½œæµç¨‹ã€‚\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3eæˆ‘å»ºè®®ä½ é˜…è¯»æ•´ç¯‡æ–‡ç« ï¼Œè€Œä¸ä»…ä»…æ˜¯çœ‹çœ‹æ¯ä¸ªæ®µè½ä¸­çš„æ ‡é¢˜ã€‚\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3ch3\x3eæˆ‘ä¸ºä»€ä¹ˆè¦å†™è¿™ç¯‡æ–‡ç« ?\x3c\/h3\x3e\n\x3cp\x3eå½“æˆ‘åœ¨ google ä¸­æœç´¢ \x3ccode\x3enode.js event loop\x3c\/code\x3e æ—¶ï¼Œæœå‡ºæ¥çš„æ–‡ç« å¤§å¤šæ•°éƒ½æ²¡æœ‰æè¿°æ¸…æ¥š (å®ƒä»¬éƒ½ä»¥ä¸€ä¸ªéå¸¸æŠ½è±¡çš„çº§åˆ«æ¥æè¿°ï¼‰ã€‚\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t018141191fa6951c9d.png\x22 alt=\x22event loop google search image\x22\x3e\x3c\/p\x3e\n\x3cp\x3eè¿™æ˜¯ä¸€å¼ æˆ‘åœ¨ Google å›¾ç‰‡ä¸­æœç´¢ \x3ccode\x3enodejs event loop\x3c\/code\x3e çš„ä¸€å¼ æˆªå›¾ã€‚æœå‡ºæ¥çš„å¤§å¤šæ•°ç»“æœéƒ½æ˜¯é”™çš„ï¼Œæˆ–è€…ä¸€ä¸ªéå¸¸æŠ½è±¡çš„çº§åˆ«æ¥æè¿°çœŸå®çš„äº‹ä»¶å¾ªç¯ã€‚ç”±äºè¿™äº›æè¿°ï¼Œå¼€å‘è€…ç»å¸¸å®¹æ˜“è¯¯è§£ã€‚\x3c\/p\x3e\n\x3chr\x3e\n\x3ch2\x3eä¸€äº›å¸¸è§çš„è¯¯è§£\x3c\/h2\x3e\n\x3ch3\x3eåœ¨ JS å¼•æ“å†…éƒ¨çš„äº‹ä»¶å¾ªç¯\x3c\/h3\x3e\n\x3cp\x3eæœ€å¸¸è§çš„è¯¯è§£ä¹‹ä¸€ï¼Œäº‹ä»¶å¾ªç¯æ˜¯ Javascript å¼•æ“ï¼ˆV8ï¼ŒspiderMonkey ç­‰ï¼‰çš„ä¸€éƒ¨åˆ†ã€‚äº‹å®ä¸Šäº‹ä»¶å¾ªç¯ä¸»è¦åˆ©ç”¨ Javascript å¼•æ“æ¥æ‰§è¡Œä»£ç ã€‚\x3c\/p\x3e\n\x3ch3\x3eæœ‰ä¸€ä¸ªæ ˆæˆ–è€…é˜Ÿåˆ—\x3c\/h3\x3e\n\x3cp\x3eé¦–å…ˆæ²¡æœ‰æ ˆï¼Œå…¶æ¬¡è¿™ä¸ªè¿‡ç¨‹æ˜¯å¤æ‚çš„ï¼Œæœ‰å¤šä¸ªé˜Ÿåˆ—ï¼ˆåƒæ•°æ®ç»“æ„ä¸­çš„é˜Ÿåˆ—ï¼‰å‚ä¸ã€‚ä½†æ˜¯å¤§å¤šæ•°å¼€å‘è€…çŸ¥é“å¤šå°‘æœ‰çš„å›è°ƒå‡½æ•°è¢«æ¨è¿›ä¸€ä¸ªå•ä¸€çš„é˜Ÿåˆ—é‡Œé¢ï¼Œæ˜¯å®Œå…¨é”™è¯¯çš„ã€‚\x3c\/p\x3e\n\x3ch3\x3eäº‹ä»¶å¾ªç¯è¿è¡Œåœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹é‡Œé¢\x3c\/h3\x3e\n\x3cp\x3eç”±äºé”™è¯¯çš„ nodejs äº‹ä»¶å¾ªç¯å›¾ï¼Œæˆ‘ä»¬ä¸­æœ‰ä¸€éƒ¨åˆ†ï¼ˆæ—©æœŸæˆ‘ä¹Ÿæ˜¯å…¶ä¸­ä¸€å‘˜ï¼‰è®¤ä¸ºæœ‰ä¸¤ä¸ªçº¿ç¨‹ã€‚ä¸€ä¸ªæ‰§è¡Œ Javascriptï¼Œå¦ä¸€ä¸ªæ‰§è¡Œäº‹ä»¶å¾ªç¯ã€‚äº‹å®ä¸Šéƒ½åœ¨ä¸€ä¸ªçº¿ç¨‹é‡Œé¢æ‰§è¡Œã€‚\x3c\/p\x3e\n\x3ch3\x3eåœ¨ setTimeout ä¸­æœ‰å¼‚æ­¥çš„ OS çš„ç³»ç»Ÿå‚ä¸\x3c\/h3\x3e\n\x3cp\x3eå¦ä¸€ä¸ªéå¸¸å¤§çš„è¯¯è§£æ˜¯ setTimeout çš„å›è°ƒå‡½æ•°åœ¨ç»™å®šçš„å»¶è¿Ÿå®Œæˆä¹‹åè¢«ï¼ˆå¯èƒ½æ˜¯ OS æˆ–è€… å†…æ ¸ï¼‰æ¨è¿›ä¸€ä¸ªé˜Ÿåˆ—ã€‚ç­‰ä¸‹æˆ‘ä»¬å°†è®¨è®ºè¿™ä¸€æœºåˆ¶ã€‚\x3c\/p\x3e\n\x3ch3\x3esetImmediate å°†å›è°ƒå‡½æ•°æ”¾åœ¨ç¬¬ä¸€ä¸ªä½ç½®\x3c\/h3\x3e\n\x3cp\x3eä½œä¸ºå¸¸è§çš„äº‹ä»¶å¾ªç¯æè¿°åªæœ‰ä¸€ä¸ªé˜Ÿåˆ—ï¼›æ‰€ä»¥ä¸€äº›å¼€å‘è€…è®¤ä¸º \x3ccode\x3esetImmediate\x3c\/code\x3e å°†å›è°ƒæ”¾åœ¨å·¥ä½œé˜Ÿåˆ—çš„å‰é¢ã€‚è¿™æ˜¯å®Œå…¨é”™è¯¯çš„ï¼Œåœ¨ Javascript çš„å·¥ä½œé˜Ÿåˆ—éƒ½æ˜¯å…ˆè¿›å…ˆå‡ºçš„ã€‚\x3c\/p\x3e\n\x3chr\x3e\n\x3ch2\x3eäº‹ä»¶å¾ªç¯çš„æ¶æ„\x3c\/h2\x3e\n\x3cp\x3eåœ¨æˆ‘ä»¬å¼€å§‹æè¿°äº‹ä»¶å¾ªç¯çš„å·¥ä½œæµç¨‹æ—¶ï¼ŒçŸ¥é“å®ƒçš„æ¶æ„éå¸¸é‡è¦ã€‚ä¹‹å‰é‚£ä¸ªå›¾æ˜¯é”™è¯¯çš„ï¼Œä¸‹é¢è¿™ä¸ªæ‰æ˜¯äº‹ä»¶å¾ªç¯çœŸæ­£çš„å·¥ä½œæµç¨‹ã€‚\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/voidcanvas.com\/wp-content\/uploads\/2018\/02\/nodejs-event-loop-phase.png\x22\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t01757686d614a09a98.png\x22 alt=\x22nodejs event loop phases\x22\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3eå›¾ç‰‡ä¸­çš„ä¸åŒçš„ç›’å­ä»£è¡¨ä¸åŒçš„é˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µæ‰§è¡Œç‰¹å®šçš„å·¥ä½œã€‚æ¯ä¸ªé˜¶æ®µéƒ½æœ‰ä¸€ä¸ªé˜Ÿåˆ—ï¼ˆè¿™é‡Œè¯´æˆé˜Ÿåˆ—ä¸»è¦æ˜¯ä¸ºäº†ä½ æ›´å¥½çš„ç†è§£ï¼›çœŸå®çš„æ•°æ®ç»“æ„å¯èƒ½ä¸æ˜¯é˜Ÿåˆ—ï¼‰ï¼ŒJavascript å¯ä»¥åœ¨ä»»ä½•ä¸€ä¸ªé˜¶æ®µæ‰§è¡Œï¼ˆé™¤äº† idle \x26amp; prepareï¼‰ã€‚ä½ åœ¨å›¾ç‰‡ä¸­ä¹Ÿèƒ½çœ‹åˆ°  \x3ccode\x3enextTickQueue\x3c\/code\x3e  å’Œ  \x3ccode\x3emicroTaskQueue\x3c\/code\x3eï¼Œå®ƒä»¬ä¸æ˜¯å¾ªç¯çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒä»¬ä¹‹ä¸­çš„å›è°ƒå¯ä»¥åœ¨ä»»æ„é˜¶æ®µæ‰§è¡Œã€‚å®ƒä»¬æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§å»æ‰§è¡Œã€‚\x3c\/p\x3e\n\x3cp\x3eç°åœ¨ä½ çŸ¥é“äº†äº‹ä»¶å¾ªç¯æ˜¯ä¸åŒé˜¶æ®µå’Œä¸åŒé˜Ÿåˆ—çš„ç»“åˆï¼›ä¸‹é¢æ˜¯æ¯ä¸ªé˜¶æ®µçš„æè¿°ã€‚\x3c\/p\x3e\n\x3ch3\x3eå®šæ—¶å™¨ï¼ˆTimerï¼‰é˜¶æ®µ\x3c\/h3\x3e\n\x3cp\x3eè¿™ä¸ªæ˜¯äº‹ä»¶å¾ªç¯å¼€å§‹çš„é˜¶æ®µï¼Œç»‘å®šåˆ°è¿™ä¸ªé˜¶æ®µçš„é˜Ÿåˆ—ï¼Œä¿ç•™ç€å®šæ—¶å™¨ï¼ˆsetTimeout, setIntervalï¼‰çš„å›è°ƒã€‚å°½ç®¡å®ƒå¹¶æ²¡æœ‰å°†å›è°ƒæ¨å…¥é˜Ÿåˆ—ä¸­ï¼Œä½†æ˜¯ä»¥æœ€å°çš„å †æ¥ç»´æŒè®¡æ—¶å™¨å¹¶ä¸”åœ¨åˆ°è¾¾è§„å®šçš„æ—¶é—´åæ‰§è¡Œå›è°ƒã€‚\x3c\/p\x3e\n\x3ch3\x3eæ‚¬è€Œæœªå†³çš„ï¼ˆPendingï¼‰ i\/o å›è°ƒé˜¶æ®µ\x3c\/h3\x3e\n\x3cp\x3eè¿™ä¸ªé˜¶æ®µæ‰§è¡Œåœ¨äº‹ä»¶å¾ªç¯ä¸­ \x3ccode\x3epending_queue\x3c\/code\x3e é‡Œçš„å›è°ƒã€‚è¿™äº›å›è°ƒæ˜¯è¢«ä¹‹å‰çš„æ“ä½œæ¨å…¥çš„ã€‚ä¾‹å¦‚å½“ä½ å°è¯•å¾€ tcp ä¸­å†™å…¥ä¸€äº›ä¸œè¥¿ï¼Œè¿™ä¸ªå·¥ä½œå®Œæˆäº†ï¼Œç„¶åå›è°ƒè¢«æ¨å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚é”™è¯¯å¤„ç†çš„å›è°ƒä¹Ÿåœ¨è¿™é‡Œã€‚\x3c\/p\x3e\n\x3ch3\x3eIdle, Prepare é˜¶æ®µ\x3c\/h3\x3e\n\x3cp\x3eå°½ç®¡åå­—æ˜¯ç©ºé—²ï¼ˆidleï¼‰,ä½†æ˜¯æ¯ä¸ª tick éƒ½è¿è¡Œã€‚Prepare ä¹Ÿåœ¨è½®è¯¢é˜¶æ®µå¼€å§‹ä¹‹å‰è¿è¡Œã€‚ä¸ç®¡æ€æ ·ï¼Œè¿™ä¸¤ä¸ªé˜¶æ®µæ˜¯ node ä¸»è¦åšä¸€äº›å†…éƒ¨æ“ä½œçš„é˜¶æ®µï¼›å› æ­¤ï¼Œæˆ‘ä»¬ä¸åœ¨è¿™å„¿è®¨è®ºã€‚ä»Šå¤©ä¸è®¨è®ºã€‚\x3c\/p\x3e\n\x3ch3\x3eè½®è¯¢ï¼ˆPollï¼‰é˜¶æ®µ\x3c\/h3\x3e\n\x3cp\x3eå¯èƒ½æ•´ä¸ªäº‹ä»¶å¾ªç¯æœ€é‡è¦çš„ä¸€ä¸ªé˜¶æ®µå°±æ˜¯ \x3ccode\x3epoll phase\x3c\/code\x3eã€‚è¿™ä¸ªé˜¶æ®µæ¥å—æ–°ä¼ å…¥çš„è¿æ¥ï¼ˆæ–°çš„ Socket å»ºç«‹ç­‰ï¼‰å’Œæ•°æ®ï¼ˆæ–‡ä»¶è¯»å–ç­‰ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥å°†è½®è¯¢é˜¶æ®µåˆ†æˆå‡ ä¸ªä¸åŒçš„éƒ¨åˆ†ã€‚\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eå¦‚æœåœ¨ \x3ccode\x3ewatch_queue\x3c\/code\x3eï¼ˆè¿™ä¸ªé˜Ÿåˆ—è¢«ç»‘å®šåˆ°è½®è¯¢é˜¶æ®µï¼‰æœ‰ä¸œè¥¿ï¼Œå®ƒä»¬å°†ä¼šè¢«ä¸€ä¸ªæ¥ç€ä¸€ä¸ªçš„æ‰§è¡Œç›´åˆ°é˜Ÿåˆ—ä¸ºç©ºæˆ–è€…ç³»ç»Ÿåˆ°è¾¾æœ€å¤§çš„é™åˆ¶ã€‚\x3c\/li\x3e\n\x3cli\x3eä¸€æ—¦é˜Ÿåˆ—ä¸ºç©ºï¼Œnode å°±ä¼šç­‰å¾…æ–°çš„è¿æ¥ã€‚ç­‰å¾…æˆ–è€…ç¡çœ çš„æ—¶é—´å–å†³äºå¤šç§å› ç´ ï¼Œå¾…ä¼šå„¿æˆ‘ä»¬ä¼šè®¨è®ºã€‚\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3\x3eæ£€æŸ¥ï¼ˆCheckï¼‰é˜¶æ®µ\x3c\/h3\x3e\n\x3cp\x3eè½®è¯¢çš„ä¸‹ä¸€ä¸ªé˜¶æ®µæ˜¯ \x3ccode\x3echeck phase\x3c\/code\x3eï¼Œè¿™ä¸ªä¸“ç”¨äº \x3ccode\x3esetImmediate\x3c\/code\x3e çš„é˜¶æ®µã€‚ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ªä¸“é—¨çš„é˜Ÿåˆ—æ¥å¤„ç† setImmediate å›è°ƒã€‚è¿™æ˜¯å› ä¸ºè½®è¯¢é˜¶æ®µçš„è¡Œä¸ºï¼Œå¾…ä¼šå„¿å°†åœ¨æµç¨‹éƒ¨åˆ†è®¨è®ºã€‚ç°åœ¨åªéœ€è¦è®°ä½æ£€æŸ¥ï¼ˆcheckï¼‰é˜¶æ®µä¸»è¦ç”¨äºå¤„ç† setImmediate() çš„å›è°ƒã€‚\x3c\/p\x3e\n\x3ch3\x3eå…³é—­ï¼ˆCloseï¼‰å›è°ƒ\x3c\/h3\x3e\n\x3cp\x3eå›è°ƒçš„å…³é—­(socket.on(â€˜closeâ€™, ()=\x26gt;{})) éƒ½åœ¨è¿™é‡Œå¤„ç†çš„ï¼Œæ›´åƒä¸€ä¸ªæ¸…ç†é˜¶æ®µ\x3c\/p\x3e\n\x3ch3\x3enextTickQueue \x26amp; microTaskQueue\x3c\/h3\x3e\n\x3cp\x3enextTickQueue ä¸­çš„ä»»åŠ¡ä¿ç•™ç€è¢« \x3ccode\x3eprocess.nextTick()\x3c\/code\x3e è§¦å‘çš„å›è°ƒã€‚microTaskQueue ä¿ç•™ç€è¢« Promise è§¦å‘çš„å›è°ƒã€‚å®ƒä»¬éƒ½ä¸æ˜¯äº‹ä»¶å¾ªç¯çš„ä¸€éƒ¨åˆ†ï¼ˆä¸æ˜¯åœ¨ libUV ä¸­å¼€å‘çš„ï¼‰ï¼Œè€Œæ˜¯åœ¨ node.js ä¸­ã€‚åœ¨ C\/C\x2b\x2b å’Œ Javascript æœ‰äº¤å‰çš„æ—¶å€™ï¼Œå®ƒä»¬éƒ½æ˜¯å°½å¯èƒ½å¿«åœ°è¢«è°ƒç”¨ã€‚å› æ­¤å®ƒä»¬åº”è¯¥åœ¨å½“å‰æ“ä½œè¿è¡Œåï¼ˆä¸ä¸€å®šæ˜¯å½“å‰ js å›è°ƒæ‰§è¡Œå®Œï¼‰ã€‚\x3c\/p\x3e\n\x3chr\x3e\n\x3ch2\x3eäº‹ä»¶å¾ªç¯çš„å·¥ä½œæµç¨‹\x3c\/h2\x3e\n\x3cp\x3eå½“åœ¨ä½ çš„æ§åˆ¶å°è¿è¡Œ \x3ccode\x3enode my-script.js\x3c\/code\x3eï¼Œnode è®¾ç½®äº‹ä»¶å¾ªç¯ç„¶åè¿è¡Œä½ ä¸»è¦çš„æ¨¡å—ï¼ˆmy-script.jsï¼‰ \x3cstrong\x3e\x3cem\x3eäº‹ä»¶å¾ªç¯çš„å¤–éƒ¨\x3c\/em\x3e\x3c\/strong\x3eã€‚ä¸€æ—¦ä¸»è¦æ¨¡å—æ‰§è¡Œå®Œï¼Œnode å°†ä¼šæ£€æŸ¥å¾ªç¯æ˜¯å¦è¿˜æ´»ç€ï¼ˆäº‹ä»¶å¾ªç¯ä¸­æ˜¯å¦è¿˜æœ‰äº‹æƒ…è¦åšï¼‰ï¼Ÿå¦‚æœæ²¡æœ‰ï¼Œå°†ä¼šåœ¨æ‰§è¡Œé€€å‡ºå›è°ƒåé€€å‡ºã€‚\x3ccode\x3eprocess,on(\x27exit\x27, foo)\x3c\/code\x3e å›è°ƒï¼ˆé€€å‡ºå›è°ƒï¼‰ã€‚ä½†æ˜¯å¦‚æœå¾ªç¯è¿˜æ´»ç€ï¼Œnode å°†ä¼šä»è®¡æ—¶å™¨é˜¶æ®µè¿›å…¥å¾ªç¯ã€‚\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/voidcanvas.com\/wp-content\/uploads\/2018\/02\/nodejs-event-loop-workflow.png\x22\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t016d6170bb89353d65.png\x22 alt=\x22nodejs event loop workflow\x22\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3\x3eè®¡æ—¶å™¨é˜¶æ®µï¼ˆTimer phaseï¼‰çš„å·¥ä½œæµç¨‹\x3c\/h3\x3e\n\x3cp\x3eäº‹ä»¶å¾ªç¯è¿›å…¥è®¡æ—¶å™¨é˜¶æ®µå¹¶ä¸”æ£€æŸ¥åœ¨è®¡æ—¶å™¨é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰éœ€è¦æ‰§è¡Œçš„ã€‚å¥½å§ï¼Œè¿™å¥è¯å¬èµ·æ¥éå¸¸ç®€å•ï¼Œä½†æ˜¯äº‹ä»¶å¾ªç¯å®é™…ä¸Šè¦æ‰§è¡Œä¸€äº›æ­¥éª¤å‘ç°åˆé€‚çš„å›è°ƒã€‚å®é™…ä¸Šè®¡æ—¶å™¨è„šæœ¬ä»¥å‡åºå­˜å‚¨åœ¨å †å†…å­˜ä¸­ã€‚å®ƒé¦–å…ˆè·å–åˆ°ä¸€ä¸ªæ‰§è¡Œè®¡å™¨ï¼Œè®¡ç®—ä¸‹æ˜¯å¦ \x3ccode\x3enow-registeredTime == delta\x3c\/code\x3eï¼Ÿå¦‚æœæ˜¯ï¼Œä»–ä¼šæ‰§è¿™ä¸ªè¡Œè®¡æ—¶å™¨çš„å›è°ƒå¹¶ä¸”æ£€æŸ¥ä¸‹ä¸€ä¸ªè®¡æ—¶å™¨ã€‚ç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªè¿˜æ²¡åˆ°çº¦å®šæ—¶é—´çš„è®¡æ—¶å™¨ï¼Œ å®ƒä¼šåœæ­¢æ£€æŸ¥å…¶ä»–çš„å®šæ—¶å™¨ï¼ˆå› ä¸ºå®šæ—¶å™¨éƒ½ä»¥å‡åºæ‹å¥½äº†ï¼‰å¹¶ä¸”ç§»åˆ°ä¸‹ä¸€ä¸ªé˜¶æ®µäº†ã€‚\x3c\/p\x3e\n\x3cp\x3eå‡è®¾ä½ è°ƒç”¨äº† setTimeout 4æ¬¡åˆ›å»ºäº†4ä¸ªå®šæ—¶å™¨ï¼Œåˆ†åˆ«ç›¸å¯¹äºæ—¶é—´ \x3ccode\x3et\x3c\/code\x3e æ¥è¯´ \x3ccode\x3e100\x3c\/code\x3e, \x3ccode\x3e200\x3c\/code\x3e, \x3ccode\x3e300\x3c\/code\x3e, \x3ccode\x3e400\x3c\/code\x3e çš„å·®å€¼ã€‚\n\x3ca href=\x22http:\/\/voidcanvas.com\/wp-content\/uploads\/2018\/02\/Screen-Shot-2018-02-18-at-12.50.48-PM.png\x22\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t015a2fe8a03fc4a2fe.png\x22 alt=\x22simple timer example\x22\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3eå‡è®¾äº‹ä»¶å¾ªç¯åœ¨ \x3ccode\x3et\x2b250\x3c\/code\x3e è¿›å…¥åˆ°äº†è®¡æ—¶å™¨é˜¶æ®µã€‚å®ƒä¼šé¦–å…ˆçœ‹ä¸‹è®¡æ—¶å™¨ Aï¼ŒA çš„è¿‡æœŸæ—¶é—´æ˜¯ \x3ccode\x3et\x2b100\x3c\/code\x3eã€‚ä½†æ˜¯ç°åœ¨æ—¶é—´æ˜¯ \x3ccode\x3et\x2b250\x3c\/code\x3eã€‚å› æ­¤å®ƒå°†æ‰§è¡Œç»‘å®šåœ¨è®¡æ—¶å™¨ A ä¸Šçš„å›è°ƒã€‚ç„¶åå»æ£€æŸ¥è®¡æ—¶å™¨ Bï¼Œå‘ç°å®ƒçš„è¿‡æœŸæ—¶é—´æ˜¯ \x3ccode\x3et\x2b200\x3c\/code\x3eï¼Œå› æ­¤ä¹Ÿä¼šæ‰§è¡Œ B çš„å›è°ƒã€‚ç°åœ¨å®ƒä¼šæ£€æŸ¥ Cï¼Œå‘ç°å®ƒçš„è¿‡æœŸæ—¶é—´æ˜¯ \x3ccode\x3et\x2b300\x3c\/code\x3eï¼Œå› æ­¤å°†ç¦»å¼€å®ƒã€‚äº‹ä»¶å¾ªç¯ä¸ä¼šå»æ£€æŸ¥ D ï¼Œå› ä¸ºè®¡æ—¶å™¨éƒ½æ˜¯æŒ‰å‡åºæ’å¥½çš„ï¼›å› æ­¤ D çš„é˜ˆå€¼æ¯” C å¤§ã€‚ç„¶è€Œè¿™ä¸ªé˜¶æ®µæœ‰ä¸€ä¸ªç³»ç»Ÿç›¸å…³çš„ç¡¬é™åˆ¶ï¼Œå¦‚æœè¾¾åˆ°ç³»ç»Ÿä¾èµ–æœ€å¤§é™åˆ¶æ•°é‡ï¼Œå³ä½¿æœ‰æœªæ‰§è¡Œçš„è®¡æ—¶å™¨ï¼Œå®ƒä¹Ÿä¼šç§»åˆ°ä¸‹ä¸€é˜¶æ®µã€‚\x3c\/p\x3e\n\x3ch3\x3eæ‚¬è€Œæœªå†³ï¼ˆPengding phaseï¼‰çš„ i\/o é˜¶æ®µå·¥ä½œæµç¨‹\x3c\/h3\x3e\n\x3cp\x3eè®¡æ—¶å™¨é˜¶æ®µåï¼Œäº‹ä»¶å¾ªç¯å°†ä¼šè¿›å…¥åˆ°äº†æ‚¬è€Œæœªå†³çš„ i\/o é˜¶æ®µï¼Œç„¶åæ£€æŸ¥ä¸€ä¸‹ \x3ccode\x3epengding_queue\x3c\/code\x3e ä¸­æ˜¯å¦æœ‰æ¥è‡ªäºä¹‹å‰çš„æ‚¬è€Œæœªå†³çš„ä»»åŠ¡çš„å›è°ƒã€‚å¦‚æœæœ‰ï¼Œä¸€ä¸ªæ¥ä¸€ä¸ªçš„æ‰§è¡Œï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ºç©ºï¼Œæˆ–è€…è¾¾åˆ°ç³»ç»Ÿçš„æœ€å¤§é™åˆ¶ã€‚ä¹‹åï¼Œäº‹ä»¶å¾ªç¯å°†ä¼šç§»åˆ° idle handler é˜¶æ®µï¼Œå…¶æ¬¡æ˜¯å‡†å¤‡é˜¶æ®µåšä¸€äº›å†…éƒ¨çš„æ“ä½œã€‚ç„¶åæœ€ç»ˆå¾ˆå¯èƒ½è¿›å…¥åˆ°äº†æœ€é‡è¦çš„é˜¶æ®µ \x3ccode\x3epoll phase\x3c\/code\x3eã€‚\x3c\/p\x3e\n\x3ch3\x3eè½®è¯¢é˜¶æ®µï¼ˆPoll phaseï¼‰å·¥ä½œæµç¨‹\x3c\/h3\x3e\n\x3cp\x3eåƒåå­—è¯´çš„é‚£æ ·ï¼Œè¿™æ˜¯ä¸€ä¸ªè§‚å¯Ÿçš„é˜¶æ®µã€‚è§‚å¯Ÿæ˜¯å¦æœ‰æ–°çš„è¯·æ±‚æˆ–è€…è¿æ¥ä¼ å…¥ã€‚å½“äº‹ä»¶å¾ªç¯è¿›å…¥è½®è¯¢é˜¶æ®µï¼Œå®ƒä¼šåœ¨ \x3ccode\x3ewatcher_queue\x3c\/code\x3e ä¸­æ‰§è¡Œè„šæœ¬ï¼ŒåŒ…å«æ–‡ä»¶è¯»å“åº”ï¼Œæ–°çš„ socket æˆ–è€… http è¿æ¥è¯·æ±‚ï¼Œç›´åˆ°æ—¶é—´è€—å°½æˆ–è€…åƒå…¶ä»–é˜¶æ®µé‚£æ ·è¾¾åˆ°ç³»ç»Ÿä¾èµ–ä¸Šé™ã€‚å‡è®¾æ²¡æœ‰è¦æ‰§è¡Œçš„å›è°ƒï¼Œè½®è¯¢åœ¨æŸäº›ç‰¹å®šçš„æ¡ä»¶ä¸‹å°†ä¼šç­‰å¾…ä¸€ä¼šå„¿ã€‚å¦‚æœåœ¨æ£€æŸ¥é˜Ÿåˆ—ï¼ˆcheck queueï¼‰ï¼Œæ‚¬è€Œæœªå†³é˜Ÿåˆ—pending queueï¼‰ï¼Œæˆ–è€…å…³é—­é˜Ÿåˆ—ï¼ˆclosing callbacks queue æˆ–è€… idle handler queueï¼‰é‡Œé¢æœ‰ä»»ä½•ä»»åŠ¡åœ¨ç­‰å¾…ï¼Œå®ƒå°†ç­‰å¾… 0 æ¯«ç§’ã€‚ç„¶è€Œå®ƒä¼šæ ¹æ®å®šæ—¶å™¨å †æ¥å†³å®šç­‰å¾…æ—¶é—´æ‰§è¡Œç¬¬ä¸€ä¸ªå®šæ—¶å™¨ï¼ˆå¦‚æœå¯è·å–ï¼‰ã€‚å¦‚æœç¬¬ä¸€ä¸ªå®šæ—¶å™¨é˜ˆå€¼ç»è¿‡äº†ï¼Œæ¯«æ— ç–‘é—®å®ƒä¸éœ€è¦ç­‰å¾…ï¼ˆå°±ä¼šæ‰§è¡Œç¬¬ä¸€ä¸ªå®šæ—¶å™¨ï¼‰ã€‚\x3c\/p\x3e\n\x3ch3\x3eæ£€æŸ¥é˜¶æ®µï¼ˆCheck phaseï¼‰å·¥ä½œæµç¨‹\x3c\/h3\x3e\n\x3cp\x3eè½®è¯¢é˜¶æ®µç»“æŸä¹‹åï¼Œç«‹å³æ¥åˆ°æ£€æŸ¥é˜¶æ®µã€‚è¿™ä¸ªé˜¶æ®µçš„é˜Ÿåˆ—ä¸­æœ‰è¢« api \x3ccode\x3esetImmediate\x3c\/code\x3e è§¦å‘çš„å›è°ƒã€‚å®ƒå°†ä¼šåƒå…¶ä»–é˜¶æ®µé‚£æ ·ä¸€ä¸ªæ¥ç€ä¸€ä¸ªçš„æ‰§è¡Œï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ºç©ºæˆ–è€…è¾¾åˆ°ä¾èµ–ç³»ç»Ÿçš„æœ€å¤§é™åˆ¶ã€‚\x3c\/p\x3e\n\x3ch3\x3eå…³é—­å›è°ƒï¼ˆClose callbackï¼‰çš„å·¥ä½œæµç¨‹\x3c\/h3\x3e\n\x3cp\x3eå®Œæˆåœ¨æ£€æŸ¥é˜¶æ®µçš„ä»»åŠ¡ä¹‹åï¼Œäº‹ä»¶å¾ªç¯çš„ä¸‹ä¸€ä¸ªç›®çš„åœ°æ˜¯å¤„ç†å…³é—­æˆ–è€…é”€æ¯ç±»å‹çš„å›è°ƒ \x3ccode\x3eclose callback\x3c\/code\x3eã€‚äº‹ä»¶å¾ªç¯æ‰§è¡Œå®Œè¿™ä¸ªé˜¶æ®µçš„é˜Ÿåˆ—ä¸­çš„å›è°ƒåï¼Œå®ƒä¼šæ£€æŸ¥å¾ªç¯ï¼ˆloopï¼‰æ˜¯å¦è¿˜æ´»ç€ï¼Œå¦‚æœæ²¡æœ‰ï¼Œé€€å‡ºã€‚ä½†æ˜¯å¦‚æœè¿˜æœ‰å·¥ä½œè¦åšï¼Œå®ƒä¼šè¿›è¡Œä¸‹ä¸€ä¸ªå¾ªç¯ï¼›å› æ­¤åœ¨è®¡æ—¶å™¨é˜¶æ®µã€‚å¦‚æœä½ è®¤ä¸ºä¹‹å‰ä¾‹å­ä¸­çš„å®šæ—¶å™¨ ï¼ˆA \x26amp; Bï¼‰è¿‡æœŸï¼Œé‚£ä¹ˆç°åœ¨åœ¨å®šæ—¶å™¨é˜¶æ®µå°†ä¼šä»å®šæ—¶å™¨ C å¼€å§‹æ£€æŸ¥æ˜¯å¦è¿‡æœŸã€‚\x3c\/p\x3e\n\x3ch3\x3enextTickQueue \x26amp; microTaskQueue\x3c\/h3\x3e\n\x3cp\x3eå› æ­¤ï¼Œè¿™ä¸¤ä¸ªé˜Ÿåˆ—çš„å›è°ƒå‡½æ•°ä»€ä¹ˆæ—¶å€™è¿è¡Œï¼Ÿå®ƒä»¬å½“ç„¶åœ¨ä»å½“å‰é˜¶æ®µåˆ°ä¸‹ä¸€ä¸ªé˜¶æ®µä¹‹å‰å°½å¯èƒ½å¿«çš„è¿è¡Œã€‚ä¸åƒå…¶ä»–é˜¶æ®µï¼Œå®ƒä»¬ä¸¤ä¸ªæ²¡æœ‰ç³»ç»Ÿä¾èµ–çš„æœ€å¤§é™åˆ¶ï¼Œnode è¿è¡Œå®ƒä»¬ç›´åˆ°ä¸¤ä¸ªé˜Ÿåˆ—æ˜¯ç©ºçš„ã€‚ç„¶è€Œï¼ŒnextTickQueue ä¼šæ¯” microTaskQueue æœ‰ç€æ›´é«˜çš„ä»»åŠ¡ä¼˜å…ˆçº§ã€‚\x3c\/p\x3e\n\x3ch3\x3eè¿›ç¨‹æ± ï¼ˆThread-poolï¼‰\x3c\/h3\x3e\n\x3cp\x3eæˆ‘ä» JavaScript å¼€å‘è€…é‚£é‡Œå¬åˆ°æ™®éçš„ä¸€ä¸ªè¯å°±æ˜¯ \x3ccode\x3eThreadPool\x3c\/code\x3eã€‚ä¸€ä¸ªæ™®éçš„è¯¯è§£æ˜¯ï¼Œnodejs æœ‰ä¸€ä¸ªå¤„ç†æ‰€æœ‰å¼‚æ­¥æ“ä½œçš„è¿›ç¨‹æ± ã€‚ä½†æ˜¯å®é™…ä¸Šè¿›ç¨‹æ± æ˜¯ libUVï¼ˆnodejs ç”¨æ¥å¤„ç†å¼‚æ­¥çš„ç¬¬ä¸‰æ–¹åº“ï¼‰ åº“ä¸­çš„ã€‚æˆ‘æ²¡æœ‰åœ¨å›¾ä¸­ç”»å‡ºæ¥ï¼Œå› ä¸ºä»–ä¸æ˜¯å¾ªç¯æœºåˆ¶çš„ä¸€éƒ¨åˆ†ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å¦ä¸€ç¯‡ä½ æ–‡ç« é‡Œè®²è®² libUVã€‚ç›®å‰ï¼Œæˆ‘åªèƒ½å‘Šè¯‰ä½ å¹¶ä¸æ˜¯æ¯ä¸ªå¼‚æ­¥ä»»åŠ¡è¢«è¿›ç¨‹æ± æ‰€å¤„ç†çš„ã€‚libUv èƒ½å¤Ÿçµæ´»åœ°ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„å¼‚æ­¥ apis æ¥ä¿æŒç¯å¢ƒä¸ºäº‹ä»¶é©±åŠ¨ã€‚ç„¶è€Œæ“ä½œç³»ç»Ÿçš„ api ä¸èƒ½åšæ–‡ä»¶è¯»å–ï¼Œdns æŸ¥è¯¢ç­‰ï¼Œè¿™äº›ç”±è¿›ç¨‹æ± æ‰€å¤„ç†ï¼Œé»˜è®¤åªæœ‰ 4 ä¸ªè¿›ç¨‹ã€‚ä½ å¯ä»¥é€šè¿‡è®¾ç½®  \x3ccode\x3euv_threadpool_size\x3c\/code\x3e  åœ°ç¯å¢ƒå˜é‡å¢åŠ è¿›ç¨‹åœ°æ•°é‡ç›´åˆ° 128ã€‚\x3c\/p\x3e\n\x3chr\x3e\n\x3ch2\x3eå¸¦æœ‰ç¤ºä¾‹çš„å·¥ä½œæµç¨‹\x3c\/h2\x3e\n\x3cp\x3eå¸Œæœ›ä½ èƒ½ç†è§£äº‹ä»¶å¾ªç¯æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚\x3ccode\x3eC è¯­è¨€\x3c\/code\x3e ä¸­åŒæ­¥çš„ while å¸®åŠ© Javascript æˆä¸ºå¼‚æ­¥çš„ã€‚æ¯æ¬¡åªå¤„ç†ä¸€ä»¶äº‹ä½†æ˜¯å¾ˆéš¾é˜»å¡ã€‚å½“ç„¶ï¼Œæ— è®ºæˆ‘ä»¬å¦‚ä½•æè¿°ç†è®ºï¼Œæˆ‘ç›¸ä¿¡æœ€å¥½çš„ç†è§£å°±æ˜¯ç¤ºä¾‹ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä¸€äº›ä»£ç ç‰‡æ®µæ¥ç†è§£è¿™ä¸ªè„šæœ¬ã€‚\x3c\/p\x3e\n\x3ch3\x3eç‰‡æ®µ 1 â€“ åŸºç¡€ç†è§£\x3c\/h3\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs coffeescript\x22\x3esetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27setTimeout\x27\x3c\/span\x3e);\n}, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\nsetImmediate(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27setImmediate\x27\x3c\/span\x3e);\n});\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3eä½ èƒ½å¤ŸçŒœåˆ°ä¸Šé¢çš„è¾“å‡ºå—ï¼Ÿå¥½å§ï¼Œä½ å¯èƒ½è®¤ä¸º \x3ccode\x3esetTimeout\x3c\/code\x3e ä¼šå…ˆè¢«æ‰“å°å‡ºæ¥ï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿæ‰§è¡Œå®Œä¸»æ¨¡å—ä¹‹åè¿›å…¥è®¡æ—¶å™¨é˜¶æ®µï¼Œå®ƒå¯èƒ½ä¸ä¼šæˆ–è€…ä¼šå‘ç°ä½ çš„è®¡æ—¶å™¨è€—å°½äº†ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿä¸€ä¸ªè®¡æ—¶å™¨è„šæœ¬æ ¹æ®ç³»ç»Ÿæ—¶é—´å’Œä½ æä¾›çš„å¢é‡æ—¶é—´æ³¨å†Œçš„ã€‚ setTimeout è°ƒç”¨çš„åŒæ—¶ï¼Œè®¡æ—¶å™¨è„šæœ¬è¢«å†™å…¥åˆ°äº†å†…å­˜ä¸­ï¼Œæ ¹æ®ä½ çš„æœºå™¨æ€§èƒ½å’Œå…¶ä»–è¿è¡Œåœ¨å®ƒä¸Šé¢çš„æ“ä½œï¼ˆä¸æ˜¯ nodeï¼‰çš„ä¸åŒï¼Œå¯èƒ½ä¼šæœ‰ä¸€ä¸ªå¾ˆå°çš„å»¶è¿Ÿã€‚å¦ä¸€ç‚¹æ˜¯ï¼Œnode ä»…ä»…åœ¨è¿›å…¥è®¡æ—¶å™¨é˜¶æ®µï¼ˆæ¯ä¸€è½®éå†ï¼‰ä¹‹å‰è®¾ç½®ä¸€ä¸ªå˜é‡ \x3ccode\x3enow\x3c\/code\x3e ï¼Œå°† \x3ccode\x3enow\x3c\/code\x3e ä½œä¸ºå½“å‰æ—¶é—´ã€‚å› æ­¤ä½ å¯ä»¥è¯´ç›¸å¯¹äºç²¾ç¡®çš„æ—¶é—´æœ‰ç‚¹å„¿é—®é¢˜ã€‚è¿™å°±æ˜¯ä¸ç¡®å®šæ€§çš„åŸå› ã€‚å¦‚æœä½ åœ¨ä¸€ä¸ªè®¡æ—¶å™¨ä»£ç çš„å›è°ƒé‡Œé¢ï¼ˆæ¯”å¦‚ï¼š setTimeoutï¼‰æ‰§è¡Œç›¸åŒçš„ä»£ç ä¼šå¾—åˆ°ç›¸åŒçš„çš„ç»“æœã€‚\x3c\/p\x3e\n\x3cp\x3eç„¶è€Œï¼Œå¦‚æœä½ ç§»åŠ¨è¿™æ®µä»£ç åˆ° i\/o å‘¨æœŸé‡Œï¼Œä¿è¯ setImmediate å›è°ƒä¼šå…ˆäº setTimeout è¿è¡Œã€‚\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs coffeescript\x22\x3efs.readFile(\x3cspan class=\x22hljs-string\x22\x3e\x27my-file-path.txt\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27setTimeout\x27\x3c\/span\x3e);\n  }, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n  setImmediate(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27setImmediate\x27\x3c\/span\x3e);\n  });\n});\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch3\x3eç‰‡æ®µ 2 â€“ æ›´å¥½çš„ç†è§£è®¡æ—¶å™¨\x3c\/h3\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e start = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e();\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efoo\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    i\x2b\x2b;\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (i \x26lt; \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e) {\n        setImmediate(foo);\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e end = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e();\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22Execution time: \x22\x3c\/span\x3e, (end - start));\n    }\n}\nfoo();\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3eä¸Šé¢çš„ä¾‹å­éå¸¸ç®€å•ã€‚è°ƒç”¨å‡½æ•° foo å‡½æ•°å†…éƒ¨å†é€šè¿‡ \x3ccode\x3esetImmediate\x3c\/code\x3e é€’å½’è°ƒç”¨ foo ç›´åˆ°1000ã€‚åœ¨æˆ‘çš„ macbook pro ä¸Šé¢ï¼Œnode ç‰ˆæœ¬æ˜¯ 8.9.1ï¼ŒèŠ±è´¹äº†  \x3ccode\x3e6 åˆ° 8 æ¯«ç§’\x3c\/code\x3eã€‚ç°åœ¨ä¿®æ”¹ä¸‹ä¸Šé¢çš„ä»£ç ï¼ŒæŠŠ \x3ccode\x3esetImmediate(foo)\x3c\/code\x3e æ¢æˆ \x3ccode\x3esetTimeout(foo, 0)\x3c\/code\x3eã€‚\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e start = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e();\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efoo\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    i\x2b\x2b;\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (i \x26lt; \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e) {\n        setTimeout(foo, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e end = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e();\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22Execution time: \x22\x3c\/span\x3e, (end - start));\n    }\n}\nfoo();\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3eç°åœ¨åœ¨æˆ‘çš„ç”µè„‘ä¸Šé¢è¿è¡Œè¿™æ®µä»£ç èŠ±è´¹äº† \x3ccode\x3e1400\x2bms\x3c\/code\x3eã€‚ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿå®ƒä»¬éƒ½æ²¡æœ‰ i\/o äº‹ä»¶ï¼Œåº”è¯¥ä¸€æ ·æ‰å¯¹ã€‚ä¸Šé¢ä¸¤ä¸ªä¾‹å­ç­‰å¾…æ—¶é—´æ˜¯ 0ã€‚ä¸ºä»€ä¹ˆèŠ±è´¹äº†è¿™ä¹ˆé•¿æ—¶é—´ï¼Ÿé€šè¿‡æ—¶é—´æ¯”è¾ƒæ‰¾åˆ°äº†åå·®ï¼ŒCPU å¯†é›†å‹ä»»åŠ¡ï¼ŒèŠ±è´¹æ›´å¤šçš„æ—¶é—´ã€‚æ³¨å†Œè®¡æ—¶å™¨è„šæœ¬ä¹ŸèŠ±è´¹æ—¶é—´ã€‚å®šæ—¶å™¨çš„æ¯ä¸ªé˜¶æ®µéƒ½éœ€è¦åšä¸€äº›æ“ä½œæ¥å†³å®šä¸€ä¸ªè®¡æ—¶å™¨æ˜¯å¦åº”è¯¥æ‰§è¡Œã€‚é•¿æ—¶é—´çš„æ‰§è¡Œä¹Ÿä¼šå¯¼è‡´æ›´å¤šçš„ ticksã€‚ç„¶è€Œï¼Œåœ¨ setImmediate ä¸­ï¼Œæ²¡æœ‰æ£€æŸ¥è¿™ä¸€é˜¶æ®µï¼Œå°±å¥½åƒåœ¨ä¸€ä¸ªé˜Ÿåˆ—é‡Œé¢ç„¶åæ‰§è¡Œå°±è¡Œäº†ã€‚\x3c\/p\x3e\n\x3ch3\x3eç‰‡æ®µ 3 â€“ ç†è§£ nextTick() \x26amp; è®¡æ—¶å™¨ï¼ˆtimerï¼‰ æ‰§è¡Œ\x3c\/h3\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efoo\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  i\x2b\x2b;\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(i\x26gt;\x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e){\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n  }\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22foo\x22\x3c\/span\x3e);\n  setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22setTimeout\x22\x3c\/span\x3e);\n  },\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n  process.nextTick(foo);\n}   \nsetTimeout(foo, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3eä½ è®¤ä¸ºä¸Šé¢çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿæ˜¯çš„ï¼Œå®ƒä¼šè¾“å‡º \x3ccode\x3efoo\x3c\/code\x3e ç„¶åè¾“å‡º \x3ccode\x3esetTimeout\x3c\/code\x3eã€‚2ç§’åï¼Œè¢« nextTickQueue é€’å½’è°ƒç”¨çš„ \x3ccode\x3efoo()\x3c\/code\x3e æ‰“å°å‡ºç¬¬ä¸€ä¸ª fooã€‚å½“æ‰€æœ‰çš„ nextTickQueue æ‰§è¡Œå®Œäº†ï¼Œå¼€å§‹æ‰§è¡Œå…¶ä»–ï¼ˆæ¯”å¦‚ setTimeout å›è°ƒï¼‰çš„ã€‚ \x3c\/p\x3e\n\x3cp\x3eæ‰€ä»¥æ˜¯æ¯ä¸ªå›è°ƒæ‰§è¡Œå®Œä¹‹åï¼Œå¼€å§‹æ£€æŸ¥ nextTickQueue çš„å—ï¼Ÿæˆ‘ä»¬æ”¹ä¸‹ä»£ç çœ‹ä¸‹ã€‚\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efoo\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  i\x2b\x2b;\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(i\x26gt;\x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e){\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n  }\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22foo\x22\x3c\/span\x3e, i);\n  setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22setTimeout\x22\x3c\/span\x3e, i);\n  },\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n  process.nextTick(foo);\n}\n\nsetTimeout(foo, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\nsetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22Other setTimeout\x22\x3c\/span\x3e);\n},\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3eåœ¨ setTimeout ä¹‹åï¼Œæˆ‘ä»…ä»…ç”¨ä¸€æ ·çš„å»¶è¿Ÿæ—¶é—´æ·»åŠ äº†å¦ä¸€ä¸ªè¾“å‡º \x3ccode\x3eother setTimeout\x3c\/code\x3e çš„ setTimeoutã€‚å°½ç®¡ä¸èƒ½ä¿è¯ï¼Œä½†æ˜¯æœ‰å¯èƒ½ä¼šåœ¨è¾“å‡ºç¬¬ä¸€ä¸ª foo ä¹‹åè¾“å‡º \x3ccode\x3eother setTimeout\x3c\/code\x3e ã€‚ç›¸åŒçš„è®¡æ—¶å™¨åˆ†æˆä¸€ä¸ªç»„ï¼ŒnextTickQueue ä¼šåœ¨æ­£åœ¨è¿›è¡Œä¸­çš„å›è°ƒç»„æ‰§è¡Œå®Œä¹‹åæ‰§è¡Œã€‚\x3c\/p\x3e\n\x3chr\x3e\n\x3ch2\x3eä¸€äº›æ™®éçš„é—®é¢˜\x3c\/h2\x3e\n\x3ch3\x3eJavaScript ä»£ç åœ¨å“ªé‡Œæ‰§è¡Œçš„?\x3c\/h3\x3e\n\x3cp\x3eå°±åƒæˆ‘ä»¬å¤§å¤šæ•°äººéƒ½è®¤ä¸ºäº‹ä»¶å¾ªç¯æ˜¯åœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹é‡Œé‡Œé¢ï¼Œå°†å›è°ƒæ¨å…¥ä¸€ä¸ªé˜Ÿåˆ—ï¼Œç„¶åä¸€ä¸ªæ¥ä¸€ä¸ªçš„æ‰§è¡Œã€‚ç¬¬ä¸€æ¬¡è¯»åˆ°è¿™ç¯‡æ–‡ç« çš„è¯»è€…å¯èƒ½ä¼šæ„Ÿåˆ°ç–‘æƒ‘ï¼ŒJavaScript åœ¨å“ªé‡Œæ‰§è¡Œçš„ã€‚æ­£å¦‚æˆ‘æ—©äº›æ—¶å€™è¯´çš„ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œæ¥è‡ªäºæœ¬èº«ä½¿ç”¨ V8 æˆ–è€…å…¶ä»–å¼•æ“çš„äº‹ä»¶å¾ªç¯çš„ Javascript ä»£ç ä¹Ÿæ˜¯åœ¨è¿™é‡Œè¿è¡Œçš„ã€‚æ‰§è¡Œæ˜¯åŒæ­¥çš„ï¼Œå¦‚æœå½“å‰çš„ JavaScript æ‰§è¡Œè¿˜æ²¡æœ‰å®Œæˆï¼Œäº‹ä»¶å¾ªç¯ä¸ä¼šä¼ æ’­ã€‚\x3c\/p\x3e\n\x3ch3\x3eæˆ‘ä»¬æœ‰äº† setTimeout(fn, 0)ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦setImmediate?\x3c\/h3\x3e\n\x3cp\x3eé¦–å…ˆä¸æ˜¯ 0ï¼Œè€Œæ˜¯ 1ã€‚å½“ä½ è®¾ç½®ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œæ—¶é—´ä¸ºå°äº 1ï¼Œæˆ–è€…å¤§äº 2147483647ms çš„æ—¶å€™ï¼Œå®ƒä¼šè‡ªåŠ¨è®¾ç½®ä¸º 1ã€‚å› æ­¤ä½ å¦‚æœè®¾ç½® setTimeout çš„å»¶è¿Ÿæ—¶é—´ä¸º 0ï¼Œå®ƒä¼šè‡ªåŠ¨è®¾ç½®ä¸º 1ã€‚\x3c\/p\x3e\n\x3cp\x3eæˆ‘ä»¬\x3ca href=\x22http:\/\/voidcanvas.com\/#snippet-2-understanding-timers-better\x22\x3eä¹‹å‰è°ˆè¿‡\x3c\/a\x3eï¼ŒsetImmediate ä¼šå‡å°‘é¢å¤–çš„æ£€æŸ¥ã€‚å› æ­¤ setImmediate ä¼šæ‰§è¡Œæ›´å¿«ä¸€äº›ã€‚å®ƒä¹Ÿæ”¾ç½®åœ¨è½®è¯¢é˜¶æ®µä¹‹åï¼Œå› æ­¤æ¥è‡ªäºä»»ä½•ä¸€ä¸ªåˆ°æ¥çš„è¯·æ±‚ setImmediate å›è°ƒå°†ä¼šç«‹å³è¢«æ‰§è¡Œã€‚\x3c\/p\x3e\n\x3ch3\x3eä¸ºä»€ä¹ˆ setImmediate ä¼šè¢«ç†è§£è°ƒç”¨?\x3c\/h3\x3e\n\x3cp\x3esetImmediate å’Œ process.nextTick() éƒ½å‘½åé”™äº†ã€‚æ‰€ä»¥åŠŸèƒ½ä¸Šï¼ŒsetImmediate åœ¨ä¸‹ä¸€ä¸ª tick æ‰§è¡Œï¼ŒnextTick æ˜¯é©¬ä¸Šæ‰§è¡Œçš„ã€‚ğŸ˜›\x3c\/p\x3e\n\x3ch3\x3eJavascript ä»£ç èƒ½è¢«é˜»å¡å—?\x3c\/h3\x3e\n\x3cp\x3eåƒæˆ‘ä»¬å·²ç»è°ˆè¿‡çš„ï¼ŒnextTickQueue æ²¡æœ‰å›è°ƒæ‰§è¡Œçš„é™åˆ¶ã€‚å› æ­¤å¦‚æœä½ é€’å½’åœ°æ‰§è¡Œ \x3ccode\x3eprocess.nextTick()\x3c\/code\x3eï¼Œä½ çš„ç¨‹åºå¯èƒ½å°±æ°¸è¿œåœ¨äº‹ä»¶å¾ªç¯ä¸­å‡ºä¸æ¥ï¼Œæ— è®ºä½ åœ¨å…¶å®ƒé˜¶æ®µæœ‰ä»€ä¹ˆã€‚\x3c\/p\x3e\n\x3ch3\x3eå¦‚æœæˆ‘å† exit callback é˜¶æ®µè°ƒç”¨ setTimeout ä¼šæ€ä¹ˆæ ·ï¼Ÿ\x3c\/h3\x3e\n\x3cp\x3eå®ƒå¯èƒ½ä¼šåˆå§‹åŒ–è®¡æ—¶å™¨ï¼Œä½†å›è°ƒå¯èƒ½æ°¸è¿œä¸ä¼šè¢«è°ƒç”¨ã€‚å› ä¸ºå¦‚æœ node åœ¨ exit callback é˜¶æ®µï¼Œå®ƒå·²ç»è·³å‡ºäº‹ä»¶å¾ªç¯äº†ã€‚å› æ­¤æ²¡æœ‰å›å»æ‰§è¡Œã€‚\x3c\/p\x3e\n\x3ch2\x3eä¸€äº›çŸ­çš„ç»“è®º\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3eäº‹ä»¶å¾ªç¯æ²¡æœ‰å·¥ä½œæ ˆ\x3c\/li\x3e\n\x3cli\x3eäº‹ä»¶å¾ªç¯ä¸åœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹é‡Œé¢ï¼ŒJavaScript çš„æ‰§è¡Œä¹Ÿä¸æ˜¯åƒä»é˜Ÿåˆ—ä¸­å¼¹å‡ºä¸€ä¸ªå›è°ƒæ‰§è¡Œé‚£ä¹ˆç®€å•ã€‚\x3c\/li\x3e\n\x3cli\x3esetImmediate æ²¡æœ‰å°†å›è°ƒæ¨å…¥åˆ°å·¥ä½œé˜Ÿåˆ—çš„å¤´éƒ¨ï¼Œæœ‰ä¸€ä¸ªä¸“é—¨çš„é˜¶æ®µå’Œé˜Ÿåˆ—ã€‚\x3c\/li\x3e\n\x3cli\x3esetImmediate åœ¨ä¸‹ä¸€ä¸ªå¾ªç¯æ‰§è¡Œï¼ŒnextTick å®é™…ä¸Šæ˜¯é©¬ä¸Šæ‰§è¡Œã€‚\x3c\/li\x3e\n\x3cli\x3eå½“å¿ƒï¼Œå¦‚æœé€’å½’è°ƒç”¨çš„è¯ï¼ŒnextTickQueue å¯èƒ½ä¼šé˜»å¡ä½ çš„ node ä»£ç ã€‚\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2\x3eæœ€å\x3c\/h2\x3e\n\x3cp\x3eæˆ‘ä¸æ˜¯ nodejs æ ¸å¿ƒå¼€å‘ç»„çš„ã€‚æˆ‘éƒ½æ˜¯ä»ä¸åŒçš„æ¼”è®²å’Œæ–‡ç« é‡Œé¢å­¦åˆ°çš„ã€‚é¦–å…ˆæ„Ÿè°¢\x3ca href=\x22https:\/\/nodejs.org\/en\/docs\/guides\/event-loop-timers-and-nexttick\/\x22\x3enode.js doc\x3c\/a\x3eã€‚å…¶æ¬¡æ„Ÿè°¢  SaÃºl Ibarra CorretgÃ© for çš„ \x3ca href=\x22https:\/\/www.youtube.com\/watch?v=sGTRmPiXD4Y\x22\x3etalk on libUV\x3c\/a\x3eã€‚æœ€åä¹Ÿæ˜¯æœ€é‡è¦çš„ï¼Œæ„Ÿè°¢ VoidCanvas çš„è¯»è€…ï¼Œæ˜¯ä½ ä»¬åˆ›å»ºäº†ä¸€ä¸ªå¥åº·çš„è®¨è®ºç¯å¢ƒã€‚ğŸ™‚\x3c\/p\x3e\n\x3chr\x3e\n\x3ch2\x3eç›¸å…³çš„æ–‡ç« :\x3c\/h2\x3e\n\x3col\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/voidcanvas.com\/all-type-of-loops-in-javascript-a-brief-explanation\/\x22 title=\x22All type of loops in JavaScript, a brief explanation\x22\x3eAll type of loops in JavaScript, a brief explanation\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/voidcanvas.com\/javascript-performant-coding-tips\/\x22 title=\x2217 JavaScript \/ node.js performance coding tips to make applications faster\x22\x3e17 JavaScript \/ node.js performance coding tips to make applications faster\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/voidcanvas.com\/best-way-to-update-manage-your-node-js-versions\/\x22 title=\x22Best way to update \x26amp; manage your node.js versions\x22\x3eBest way to update \x26amp; manage your node.js versions\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/voidcanvas.com\/global-module-not-found-when-node-version-is-changed-using-nvm\/\x22 title=\x22Global module not found when node version is changed using nvm\x22\x3eGlobal module not found when node version is changed using nvm\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/voidcanvas.com\/http2-server-push\/\x22 title=\x22HTTP2 server push in depth with node.js\x22\x3eHTTP2 server push in depth with node.js\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/voidcanvas.com\/node-js-googleapis-v4-spreadsheet\/\x22 title=\x22Read, write, update \x26amp; create google spreadsheets by node.js with googleapis v4\x22\x3eRead, write, update \x26amp; create google spreadsheets by node.js with googleapis v4\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="ç‰ˆæƒå£°æ˜">ç‰ˆæƒå£°æ˜</h1><p>åŸæ–‡é“¾æ¥: <a href="https://www.zcfy.cc/article/node-js-event-loop-workflow-lifecycle-in-low-level-void-canvas">https://www.zcfy.cc/article/node-js-event-loop-workflow-lifecycle-in-low-level-void-canvas</a> åŸæ–‡æ ‡é¢˜: Node.js äº‹ä»¶å¾ªç¯å·¥ä½œæµç¨‹ &amp; ç”Ÿå‘½å‘¨æœŸ &ndash; Void Canvas æœ¬æ–‡ä»…ç”¨äºå­¦ä¹ ã€ç ”ç©¶å’Œäº¤æµç›®çš„ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€å®Œæ•´é“¾æ¥ä»¥åŠåŸä½œè€…ã€‚</p><p>æœ¬æ–‡èµ„æºæ¥æºäº’è”ç½‘ï¼Œä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œç‰ˆæƒå½’è¯¥èµ„æºçš„åˆæ³•æ‹¥æœ‰è€…æ‰€æœ‰ï¼Œ</p><p>åŸä½œè€…è‹¥è®¤ä¸ºæœ¬ç«™ä¾µçŠ¯äº†æ‚¨çš„ç‰ˆæƒï¼Œè¯·è”ç³»æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¼šç«‹å³åˆ é™¤ï¼</p><h2>æœ¬æ–‡é“¾æ¥ï¼š</h2><a href="https://alili.tech/archive/f2555a/" target="_blank">https://alili.tech/archive/f2555a/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: 'è¯´ç‚¹ä»€ä¹ˆ?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>å…¶ä»–æ¨è</h3><li><a href="/archive/hvvo3rmt3dj/">JSæ‰“åŒ…å·¥å…·rollupâ€”â€”å®Œå…¨å…¥é—¨æŒ‡å—<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [åŸºäºSpring Boot ä¸ Vueçš„åå°è„šæ‰‹æ¶] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGLå…¥é—¨demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[é¢è¯•ä¸“é¢˜]ä¸€çº¿äº’è”ç½‘å¤§å‚é¢è¯•æ€»ç»“<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;reduxæœ€æ–°ç‰ˆæ„å»ºåˆ†äº«<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">reactè™šæ‹Ÿdomæœºåˆ¶ä¸diffç®—æ³•<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">ä¸€å¥—Vueçš„å•é¡µæ¨¡æ¿ï¼šN3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">ä½¿ç”¨ json-server æ­å»º api mock æœåŠ¡ (ä¸€)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">ä½¿ç”¨Ionic3æ¡†æ¶å¼€å§‹ç¬¬ä¸€ä¸ªæ··åˆå¼€å‘APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">å¦‚ä½•åªç”¨ CSS å®Œæˆæ¼‚äº®çš„åŠ è½½<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright Â© 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">æµ™ICPå¤‡18045521å·</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>