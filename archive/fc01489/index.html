<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="学习 canvas 的 globalCompositeOperation 做出的神奇效果"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>学习 canvas 的 globalCompositeOperation 做出的神奇效果 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/fc01489/",
				"appid": "1613049289050283", 
				"title": "学习 canvas 的 globalCompositeOperation 做出的神奇效果 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-10-22T00:00:00"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/c59e1898/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/961ee5ac/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2ffc01489%2f&text=%e5%ad%a6%e4%b9%a0%20canvas%20%e7%9a%84%20globalCompositeOperation%20%e5%81%9a%e5%87%ba%e7%9a%84%e7%a5%9e%e5%a5%87%e6%95%88%e6%9e%9c"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2ffc01489%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2ffc01489%2f&text=%e5%ad%a6%e4%b9%a0%20canvas%20%e7%9a%84%20globalCompositeOperation%20%e5%81%9a%e5%87%ba%e7%9a%84%e7%a5%9e%e5%a5%87%e6%95%88%e6%9e%9c"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2ffc01489%2f&title=%e5%ad%a6%e4%b9%a0%20canvas%20%e7%9a%84%20globalCompositeOperation%20%e5%81%9a%e5%87%ba%e7%9a%84%e7%a5%9e%e5%a5%87%e6%95%88%e6%9e%9c"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2ffc01489%2f&is_video=false&description=%e5%ad%a6%e4%b9%a0%20canvas%20%e7%9a%84%20globalCompositeOperation%20%e5%81%9a%e5%87%ba%e7%9a%84%e7%a5%9e%e5%a5%87%e6%95%88%e6%9e%9c"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%ad%a6%e4%b9%a0%20canvas%20%e7%9a%84%20globalCompositeOperation%20%e5%81%9a%e5%87%ba%e7%9a%84%e7%a5%9e%e5%a5%87%e6%95%88%e6%9e%9c&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2ffc01489%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2ffc01489%2f&title=%e5%ad%a6%e4%b9%a0%20canvas%20%e7%9a%84%20globalCompositeOperation%20%e5%81%9a%e5%87%ba%e7%9a%84%e7%a5%9e%e5%a5%87%e6%95%88%e6%9e%9c"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ffc01489%2f&title=%e5%ad%a6%e4%b9%a0%20canvas%20%e7%9a%84%20globalCompositeOperation%20%e5%81%9a%e5%87%ba%e7%9a%84%e7%a5%9e%e5%a5%87%e6%95%88%e6%9e%9c"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ffc01489%2f&title=%e5%ad%a6%e4%b9%a0%20canvas%20%e7%9a%84%20globalCompositeOperation%20%e5%81%9a%e5%87%ba%e7%9a%84%e7%a5%9e%e5%a5%87%e6%95%88%e6%9e%9c"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ffc01489%2f&title=%e5%ad%a6%e4%b9%a0%20canvas%20%e7%9a%84%20globalCompositeOperation%20%e5%81%9a%e5%87%ba%e7%9a%84%e7%a5%9e%e5%a5%87%e6%95%88%e6%9e%9c"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文链接">原文链接</a></li><li><a href="#原文标题">原文标题</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">学习 canvas 的 globalCompositeOperation 做出的神奇效果</h1><div class="meta"><div class="postdate"><time datetime="2018-10-22" itemprop="datePublished">2018-10-22</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch3 id=\x22articleHeader0\x22\x3e说明\x3c\/h3\x3e\n\x3cp\x3e最早知道 canvas 的 \x3ca href=\x22http:\/\/www.w3school.com.cn\/tags\/canvas_globalcompositeoperation.asp\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eglobalCompositeOperation\x3c\/a\x3e 属性，是在需要实现一个刮刮卡效果的时候，当时也就是网上找到刮刮卡的效果赶紧完成任务就完了，这次又学习一次，希望能加深理解吧。\x3c\/p\x3e\n\x3cp\x3e先来看下  canvas 的 \x3ca href=\x22http:\/\/www.w3school.com.cn\/tags\/canvas_globalcompositeoperation.asp\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eglobalCompositeOperation\x3c\/a\x3e属性，具体是干什么的。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e定义\x3c\/h3\x3e\n\x3cblockquote\x3eglobalCompositeOperation 属性设置或返回如何将一个源（新的）图像绘制到目标（已有）的图像上。        \x3cbr\x3e源图像 = 您打算放置到画布上的绘图。        \x3cbr\x3e目标图像 = 您已经放置在画布上的绘图。\x3c\/blockquote\x3e\n\x3cp\x3e这个属性用来设置要在绘制新形状时应用的合成操作的类型，比如在一个蓝色的矩形上画一个红色的圆形，是红色在上显示，还是蓝色在上显示，重叠的部分显示还是不显示，不重叠的部分又怎么显示，等一些情况，在面对这些情况的时候，就是 \x3ccode\x3eglobalCompositeOperation\x3c\/code\x3e 属性起作用的时候了。     \x3cbr\x3e在取默认值的情况下，都是显示的，新画的图形会覆盖原来的图形。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e用法\x3c\/h3\x3e\n\x3cp\x3e默认值：    \x3ccode\x3esource-over\x3c\/code\x3e        \x3cbr\x3e语法：    \x3ccode\x3econtext.globalCompositeOperation=\x22source-in\x22;\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e表格中的蓝色矩形为目标图像，红色圆形为源图像。\x3c\/p\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth align=\x22left\x22\x3e属性值\x3c\/th\x3e\n\x3cth\x3e描述\x3c\/th\x3e\n\x3cth\x3e效果\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3esource-over\x3c\/td\x3e\n\x3ctd\x3e默认。在目标图像上显示源图像。\x3c\/td\x3e\n\x3ctd\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214911?w=126\x26amp;h=106\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214911?w=126\x26amp;h=106\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3esource-atop\x3c\/td\x3e\n\x3ctd\x3e在目标图像顶部显示源图像。源图像位于目标图像之外的部分是不可见的。\x3c\/td\x3e\n\x3ctd\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214912?w=126\x26amp;h=106\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214912?w=126\x26amp;h=106\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3esource-in\x3c\/td\x3e\n\x3ctd\x3e在目标图像中显示源图像。只有目标图像内的源图像部分会显示，目标图像是透明的。\x3c\/td\x3e\n\x3ctd\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214913?w=127\x26amp;h=106\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214913?w=127\x26amp;h=106\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3esource-out\x3c\/td\x3e\n\x3ctd\x3e在目标图像之外显示源图像。只会显示目标图像之外源图像部分，目标图像是透明的。\x3c\/td\x3e\n\x3ctd\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214914?w=126\x26amp;h=106\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214914?w=126\x26amp;h=106\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3edestination-over\x3c\/td\x3e\n\x3ctd\x3e在源图像上方显示目标图像。\x3c\/td\x3e\n\x3ctd\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214915?w=126\x26amp;h=107\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214915?w=126\x26amp;h=107\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3edestination-atop\x3c\/td\x3e\n\x3ctd\x3e在源图像顶部显示目标图像。源图像之外的目标图像部分不会被显示。\x3c\/td\x3e\n\x3ctd\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214916?w=126\x26amp;h=106\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214916?w=126\x26amp;h=106\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3edestination-in\x3c\/td\x3e\n\x3ctd\x3e在源图像中显示目标图像。只有源图像内的目标图像部分会被显示，源图像是透明的。\x3c\/td\x3e\n\x3ctd\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214917?w=125\x26amp;h=105\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214917?w=125\x26amp;h=105\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3edestination-out\x3c\/td\x3e\n\x3ctd\x3e在源图像外显示目标图像。只有源图像外的目标图像部分会被显示，源图像是透明的。\x3c\/td\x3e\n\x3ctd\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214918?w=125\x26amp;h=105\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214918?w=125\x26amp;h=105\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3elighter\x3c\/td\x3e\n\x3ctd\x3e显示源图像 \x2b 目标图像。\x3c\/td\x3e\n\x3ctd\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214919?w=125\x26amp;h=105\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214919?w=125\x26amp;h=105\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3ecopy\x3c\/td\x3e\n\x3ctd\x3e显示源图像。忽略目标图像。\x3c\/td\x3e\n\x3ctd\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214920?w=126\x26amp;h=105\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214920?w=126\x26amp;h=105\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3exor\x3c\/td\x3e\n\x3ctd\x3e使用异或操作对源图像与目标图像进行组合。\x3c\/td\x3e\n\x3ctd\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214921?w=127\x26amp;h=106\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214921?w=127\x26amp;h=106\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3cp\x3e好的，下来实现一个\x3ca href=\x22https:\/\/codepen.io\/FEWY\/pen\/oPxbmj\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e水滴扩散\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22FEWY\/pen\/oPxbmj\x22 data-typeid=\x223\x22\x3e点击预览\x3c\/button\x3e的效果    \x3cbr\x3e\x3cstrong\x3e效果图\x3c\/strong\x3e    \x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214922?w=404\x26amp;h=250\x22 del-src=\x22https:\/\/static.alili.tech\/v-5bbf1b3b\/global\/img\/squares.svg\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e实现思路\x3c\/strong\x3e  \x3c\/p\x3e\n\x3cp\x3e在一个 canvas 上先画出黑白色的图片，然后设置背景是一张彩色的图片，鼠标点击时，设置 canvas 的 \x3ccode\x3eglobalCompositeOperation\x3c\/code\x3e 属性值为 \x3ccode\x3edestination-out\x3c\/code\x3e，根据鼠标在 canvas 中的 坐标，用一个不规则的图形逐渐增大，来擦除掉黑白色的图片，就可以慢慢显示彩色的背景了。\x3c\/p\x3e\n\x3cp\x3e也就是说我们需要三张图片 \x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e黑白的图片\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214923?w=640\x26amp;h=360\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214923?w=640\x26amp;h=360\x22 alt=\x22这里写图片描述\x22 title=\x22这里写图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e彩色的图片\x3c\/strong\x3e    \x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214924?w=640\x26amp;h=360\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214924?w=640\x26amp;h=360\x22 alt=\x22这里写图片描述\x22 title=\x22这里写图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e不规则形状的图片\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214925?w=100\x26amp;h=100\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214925?w=100\x26amp;h=100\x22 alt=\x22这里写图片描述\x22 title=\x22这里写图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e代码\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c!doctype html\x3e\n\x3chtml\x3e\n\n\x3chead\x3e\n    \x3cmeta charset=\x26quot;UTF-8\x26quot;\x3e\n    \x3cstyle\x3e\n        canvas {\n            \/* 设置鼠标的光标是一张图片， 16和22 分别表示热点的X坐标和Y坐标 *\/\n            \/* https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/CSS\/cursor\/url *\/\n            cursor: url(\x27https:\/\/www.kkkk1000.com\/images\/mouse.png\x27) 16 22, auto;\n        }\n    \x3c\/style\x3e\n\x3c\/head\x3e\n\n\x3cbody\x3e\n    \x3ccanvas id=\x26quot;canvas\x26quot; width=\x26quot;400px\x26quot; height=\x26quot;250px\x26quot;\x3e\x3c\/canvas\x3e\n\n    \x3cscript type=\x26quot;text\/javascript\x26quot;\x3e \n        var canvas = document.getElementById(\x26quot;canvas\x26quot;);\n        var context = canvas.getContext(\x26quot;2d\x26quot;);\n\n        \/\/ 保存图片路径的数组\n        var urlArr = [\x26quot;https:\/\/www.kkkk1000.com\/images\/bg2.png\x26quot;, \x26quot;https:\/\/www.kkkk1000.com\/images\/clear.png\x26quot;];\n        \/\/ imgArr 保存加载后的图片的数组，imgArr中保存的是真实的图片\n        \/\/ loadImg 函数用来加载 urlArr 中所有的图片\n        \/\/ 并返回一个保存所有图片的数组\n        var imgArr = loadImg(urlArr);\n        \/\/ flag 用来限制 点击事件，一张图片只会产生一次效果\n        var flag = false;\n \n\n        function loadImg(urlArr) {\n            var index = 0;\n            var res = [];\n            \/\/ 每次给 load 函数传入一个图片路径，来加载图片\n            load(urlArr[index]);\n            function load(url) {\n                \/\/ 如果 index 等于 urlArr.length，\n                \/\/ 表示加载完 全部图片了，就结束 load函数\n                if (index == urlArr.length) {\n                    \/\/ 加载完全部图片，调用 init 函数\n                    init();\n                    return;\n                }\n\n                var img = new Image();\n                img.src = url;\n                \/\/ 不管当前图片是否加载成功，都要加载下一张图片\n                img.onload = next;\n                img.onerror = function () {\n                    console.log(res[index] \x2b \x26quot;加载失败\x26quot;);\n                    next();\n                }\n                \/\/ next 用来加载下一张图片\n                function next() {\n                    \/\/ 把加载后的图片，保存到 res 中\n                    res[index] = img;\n                    load(urlArr[\x2b\x2bindex])\n                }\n            }\n            \/\/ 最后返回保存所有真实图片的数组\n            return res;\n        }\n\n        function init() {\n            \/\/ 先在canvas上画黑白的图片，然后再设置背景是彩色的图片\n            \/\/ 避免先显示出彩色图片，再显示出黑白的图片\n            context.globalCompositeOperation = \x26quot;source-over\x26quot;;\n            context.drawImage(imgArr[0], 0, 0, 400, 250);\n            canvas.style.background = \x27url(https:\/\/www.kkkk1000.com\/images\/bg.jpg)\x27;\n            canvas.style.backgroundSize = \x26quot;100% 100%\x26quot;;\n\n            \/\/ flag 是 true 时，鼠标点击才有水滴扩散的效果\n            flag = true;\n            \/\/ canvas 绑定点击事件，点击时产生水滴扩散效果\n            canvas.onclick =  diffusion;\n        }\n\n        \/\/ width 表示 不规则形状的图片的尺寸\n        var width = 0;\n        \/\/ speed 表示扩散效果的速度\n        var speed = 8;\n        \/\/ diffusion 函数根据鼠标坐标，产生效果\n        function  diffusion (e) {\n            if (flag) {\n                flag = false;\n                context.globalCompositeOperation = \x26quot;destination-out\x26quot;;\n                window.requestAnimationFrame(draw);\n                \/\/ 根据鼠标坐标，画扩散效果\n                function draw() {\n                    \/\/ 这里不一定需要是 1800 ，但必须是一个足够大的数，可以扩散出整张背景图\n                    if (width \x3e 1800) {\n                        flag = true;\n                        return;\n                    }\n                    width \x2b= speed;\n                    \/\/ 获取鼠标相对于 canvas 的坐标\n                    var x = e.layerX;\n                    var y = e.layerY;\n\n                    \/\/ 画不规则形状的图片，逐渐增大图片尺寸\n                    context.drawImage(imgArr[1], x - (width \/ 2), y - (width \/ 2), width, width);\n                    window.requestAnimationFrame(draw);\n                }\n            }\n        }\n    \x3c\/script\x3e\n\x3c\/body\x3e\n\n\x3c\/html\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!doctype html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3echarset\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22UTF-8\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3estyle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22css\x22\x3e\n        \x3cspan class=\x22hljs-selector-tag\x22\x3ecanvas\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/* 设置鼠标的光标是一张图片， 16和22 分别表示热点的X坐标和Y坐标 *\/\x3c\/span\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\/* https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/CSS\/cursor\/url *\/\x3c\/span\x3e\n            \x3cspan class=\x22hljs-attribute\x22\x3ecursor\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/mouse.png\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-number\x22\x3e16\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e22\x3c\/span\x3e, auto;\n        }\n    \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3estyle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ecanvas\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22canvas\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ewidth\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22400px\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eheight\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22250px\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ecanvas\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e \n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e canvas = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x22canvas\x22\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e context = canvas.getContext(\x3cspan class=\x22hljs-string\x22\x3e\x222d\x22\x3c\/span\x3e);\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 保存图片路径的数组\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e urlArr = [\x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/www.kkkk1000.com\/images\/bg2.png\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/www.kkkk1000.com\/images\/clear.png\x22\x3c\/span\x3e];\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ imgArr 保存加载后的图片的数组，imgArr中保存的是真实的图片\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ loadImg 函数用来加载 urlArr 中所有的图片\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 并返回一个保存所有图片的数组\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e imgArr = loadImg(urlArr);\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ flag 用来限制 点击事件，一张图片只会产生一次效果\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e flag = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n \n\n        \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eloadImg\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eurlArr\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e index = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e res = [];\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 每次给 load 函数传入一个图片路径，来加载图片\x3c\/span\x3e\n            load(urlArr[index]);\n            \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eload\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eurl\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果 index 等于 urlArr.length，\x3c\/span\x3e\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 表示加载完 全部图片了，就结束 load函数\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (index == urlArr.length) {\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 加载完全部图片，调用 init 函数\x3c\/span\x3e\n                    init();\n                    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n                }\n\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e img = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Image();\n                img.src = url;\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 不管当前图片是否加载成功，都要加载下一张图片\x3c\/span\x3e\n                img.onload = next;\n                img.onerror = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n                    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(res[index] \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22加载失败\x22\x3c\/span\x3e);\n                    next();\n                }\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ next 用来加载下一张图片\x3c\/span\x3e\n                \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3enext\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 把加载后的图片，保存到 res 中\x3c\/span\x3e\n                    res[index] = img;\n                    load(urlArr[\x2b\x2bindex])\n                }\n            }\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 最后返回保存所有真实图片的数组\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e res;\n        }\n\n        \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3einit\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 先在canvas上画黑白的图片，然后再设置背景是彩色的图片\x3c\/span\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 避免先显示出彩色图片，再显示出黑白的图片\x3c\/span\x3e\n            context.globalCompositeOperation = \x3cspan class=\x22hljs-string\x22\x3e\x22source-over\x22\x3c\/span\x3e;\n            context.drawImage(imgArr[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e], \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e400\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e250\x3c\/span\x3e);\n            canvas.style.background = \x3cspan class=\x22hljs-string\x22\x3e\x27url(https:\/\/www.kkkk1000.com\/images\/bg.jpg)\x27\x3c\/span\x3e;\n            canvas.style.backgroundSize = \x3cspan class=\x22hljs-string\x22\x3e\x22100% 100%\x22\x3c\/span\x3e;\n\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ flag 是 true 时，鼠标点击才有水滴扩散的效果\x3c\/span\x3e\n            flag = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ canvas 绑定点击事件，点击时产生水滴扩散效果\x3c\/span\x3e\n            canvas.onclick =  diffusion;\n        }\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ width 表示 不规则形状的图片的尺寸\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e width = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ speed 表示扩散效果的速度\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e speed = \x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ diffusion 函数根据鼠标坐标，产生效果\x3c\/span\x3e\n        \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e  \x3cspan class=\x22hljs-title\x22\x3ediffusion\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (flag) {\n                flag = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n                context.globalCompositeOperation = \x3cspan class=\x22hljs-string\x22\x3e\x22destination-out\x22\x3c\/span\x3e;\n                \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.requestAnimationFrame(draw);\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 根据鼠标坐标，画扩散效果\x3c\/span\x3e\n                \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edraw\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这里不一定需要是 1800 ，但必须是一个足够大的数，可以扩散出整张背景图\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (width \x26gt; \x3cspan class=\x22hljs-number\x22\x3e1800\x3c\/span\x3e) {\n                        flag = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n                        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n                    }\n                    width \x2b= speed;\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取鼠标相对于 canvas 的坐标\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e x = e.layerX;\n                    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e y = e.layerY;\n\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 画不规则形状的图片，逐渐增大图片尺寸\x3c\/span\x3e\n                    context.drawImage(imgArr[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e], x - (width \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e), y - (width \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e), width, width);\n                    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.requestAnimationFrame(draw);\n                }\n            }\n        }\n    \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们继续来实现一个刮刮卡的效果\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e效果图\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214926?w=403\x26amp;h=252\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016214926?w=403\x26amp;h=252\x22 alt=\x22这里写图片描述\x22 title=\x22这里写图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e刮刮卡效果实现的思路：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e一个 canvas 上先画一层灰色，然后设置canvas的背景图，设置 canvas 的 \x3ccode\x3eglobalCompositeOperation\x3c\/code\x3e属性值为 \x3ccode\x3edestination-out\x3c\/code\x3e，点击并移动时，根据移动点的坐标，擦除掉灰色，当擦掉一部分时，再自动擦除掉全部灰色，显示出背景来。\x3c\/p\x3e\n\x3cp\x3e刮刮卡的效果和水滴扩散的效果，在开始的时候几乎是一样的，不过水滴扩散效果，用的是一张不规则形状的图片来清除黑白图片，而刮刮卡效果，是通过画线的方式，线比较粗而已，来清除上面的灰色。\x3cbr\x3e主要的不同是，刮刮卡效果最后需要自动擦除掉全部灰色，这里有两种方式。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e第一种\x3c\/strong\x3e    \x3cbr\x3e使用 canvas 的 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/ImageData\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3egetImageData\x3c\/a\x3e 方法，来获取 canvas 上的像素信息，这个方法返回的对象的 data 属性是一个一维数组，包含以 RGBA 顺序的数据，数据使用  0 至 255（包含）的整数表示，详细的可以看看 canvas 的\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/Canvas_API\/Tutorial\/Pixel_manipulation_with_canvas\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e像素操作\x3c\/a\x3e。     \x3cbr\x3e用这个方法来判断有多少已经擦除掉了，也就是通过一个变量来记录有多少像素的RGBA的值是0，当变量的值超过某一个值时，就清除全部灰色。\x3c\/p\x3e\n\x3cp\x3e代码在\x3ca href=\x22https:\/\/codepen.io\/FEWY\/pen\/BOjmyg\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这里\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22FEWY\/pen\/BOjmyg\x22 data-typeid=\x223\x22\x3e点击预览\x3c\/button\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e第二种\x3c\/strong\x3e     \x3cbr\x3e就直接看移动了多少，鼠标移动时，会有一个变量进行自增运算，当这个变量，超过一定值时，就擦除全部灰色。\x3c\/p\x3e\n\x3cp\x3e代码在\x3ca href=\x22https:\/\/codepen.io\/FEWY\/pen\/eLJeNv\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这里\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22FEWY\/pen\/eLJeNv\x22 data-typeid=\x223\x22\x3e点击预览\x3c\/button\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e注意：\x3c\/strong\x3e       \x3cbr\x3e第一种方式使用  \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/CanvasRenderingContext2D\/getImageData\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3egetImageData\x3c\/a\x3e 存在跨域问题，不过因为这个效果中，没有在canvas上画图片，而是设置canvas的 \x3ccode\x3ebackground\x3c\/code\x3e 为一张图片，所以这个还没有影响，但是如果canvas上画了其他图片，就可能需要处理跨域的问题了。              \x3cbr\x3e使用 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/CanvasRenderingContext2D\/getImageData\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3egetImageData\x3c\/a\x3e 能获取到 canvas 上的像素信息，可以更加灵活的控制擦除全部灰色的时机。\x3c\/p\x3e\n\x3cp\x3e第二种方式，使用图片地址，不存在跨域的问题，但是不能很好的控制最后擦除全部灰色的时机。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e总结\x3c\/h3\x3e\n\x3cp\x3e文章中的效果主要是使用 \x3ccode\x3eglobalCompositeOperation\x3c\/code\x3e属性取值为 \x3ccode\x3edestination-out\x3c\/code\x3e ，而取值为其他值的时候，同样也是可以制作出各种效果的，大家也可以发挥自己的想象力，去试试其它值，也许有新发现呢。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016248923?w=600\x26amp;h=342\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016248923?w=600\x26amp;h=342\x22 alt=\x22这里写图片描述\x22 title=\x22这里写图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000016214908">https://segmentfault.com/a/1190000016214908</a></p><h2 id="原文标题">原文标题</h2><p>学习 canvas 的 globalCompositeOperation 做出的神奇效果</p><h2>本文链接：</h2><a href="https://alili.tech/archive/fc01489/" target="_blank">https://alili.tech/archive/fc01489/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>