<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="基于 github issues 实现第三方评论系统"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>基于 github issues 实现第三方评论系统 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/gfoj8k8we6f/",
				"appid": "1613049289050283", 
				"title": "基于 github issues 实现第三方评论系统 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-01T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/2o5z3qiuunh/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/4nzasbbwpmb/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fgfoj8k8we6f%2f&text=%e5%9f%ba%e4%ba%8e%20github%20issues%20%e5%ae%9e%e7%8e%b0%e7%ac%ac%e4%b8%89%e6%96%b9%e8%af%84%e8%ae%ba%e7%b3%bb%e7%bb%9f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fgfoj8k8we6f%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fgfoj8k8we6f%2f&text=%e5%9f%ba%e4%ba%8e%20github%20issues%20%e5%ae%9e%e7%8e%b0%e7%ac%ac%e4%b8%89%e6%96%b9%e8%af%84%e8%ae%ba%e7%b3%bb%e7%bb%9f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fgfoj8k8we6f%2f&title=%e5%9f%ba%e4%ba%8e%20github%20issues%20%e5%ae%9e%e7%8e%b0%e7%ac%ac%e4%b8%89%e6%96%b9%e8%af%84%e8%ae%ba%e7%b3%bb%e7%bb%9f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fgfoj8k8we6f%2f&is_video=false&description=%e5%9f%ba%e4%ba%8e%20github%20issues%20%e5%ae%9e%e7%8e%b0%e7%ac%ac%e4%b8%89%e6%96%b9%e8%af%84%e8%ae%ba%e7%b3%bb%e7%bb%9f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%9f%ba%e4%ba%8e%20github%20issues%20%e5%ae%9e%e7%8e%b0%e7%ac%ac%e4%b8%89%e6%96%b9%e8%af%84%e8%ae%ba%e7%b3%bb%e7%bb%9f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fgfoj8k8we6f%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fgfoj8k8we6f%2f&title=%e5%9f%ba%e4%ba%8e%20github%20issues%20%e5%ae%9e%e7%8e%b0%e7%ac%ac%e4%b8%89%e6%96%b9%e8%af%84%e8%ae%ba%e7%b3%bb%e7%bb%9f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fgfoj8k8we6f%2f&title=%e5%9f%ba%e4%ba%8e%20github%20issues%20%e5%ae%9e%e7%8e%b0%e7%ac%ac%e4%b8%89%e6%96%b9%e8%af%84%e8%ae%ba%e7%b3%bb%e7%bb%9f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fgfoj8k8we6f%2f&title=%e5%9f%ba%e4%ba%8e%20github%20issues%20%e5%ae%9e%e7%8e%b0%e7%ac%ac%e4%b8%89%e6%96%b9%e8%af%84%e8%ae%ba%e7%b3%bb%e7%bb%9f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fgfoj8k8we6f%2f&title=%e5%9f%ba%e4%ba%8e%20github%20issues%20%e5%ae%9e%e7%8e%b0%e7%ac%ac%e4%b8%89%e6%96%b9%e8%af%84%e8%ae%ba%e7%b3%bb%e7%bb%9f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">基于 github issues 实现第三方评论系统</h1><div class="meta"><div class="postdate"><time datetime="2019-01-01" itemprop="datePublished">2019-01-01</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3e本文只是介绍如何基于 github issues 实现第三方评论系统，对于 Hexo 介绍，本文并不打算详述，如果有童鞋之前还没有了解 Hexo 的，可以先看一下之前文章《\x3ca href=\x22http:\/\/jelon.top\/posts\/start-hexo\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e静态博客框架 Hexo 入门\x3c\/a\x3e 》，或者直接访问 Hexo 官网 \x3ca href=\x22https:\/\/hexo.io\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/hexo.io\/\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader0\x22\x3e一、事情起因\x3c\/h3\x3e\n\x3cp\x3e个人博客是基于静态博客系统（Hexo）搭建的，本身是没有具备任何后台功能的，例如搜索、评论系统等。但是，如果你想在静态博客上加上评论功能，也不是无法实现的，这时候就要借助第三方评论系统了。\x3c\/p\x3e\n\x3cp\x3e什么是第三方评论系统？博客或 cms 系统，一般都是有内容和评论两部分组成。评论可以增加博主与用户之间的交流互动，也是博主一对多的传达自己想法和观点的交流平台。所以除了社区平台外，评论也成为一般博客和cms系统必备功能。大型网站本身自己开发了评论系统和分享系统，而一般中小型网站开发的自己的评论系统，成本高。而且垃圾评论和过滤非法关键字难度较大，所以在国内外都有第三评论系统。以下是曾经流行或者正在流行的一些第三方评论系统。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e多说。多说是一款追求极致体验的社会化评论框，可以用微博、QQ、人人、豆瓣等帐号登录并评论。多说已经成为国内份额最大的所谓“社交评论框”服务，但是这个行业第一并没有给它带来更多的收益和发展空间。不过可惜，现在已经停止服务了。\x3c\/li\x3e\n\x3cli\x3e搜狐畅言。搜狐畅言是由搜狐推出的一个简单而强大的社会化评论及聚合平台。用户可以直接用自己的社会化网络账户在第三方网站发表评论，并且一键评论同步至社交网络将网站内容和自己的评论分享给好友。增加第三方网站用户活跃度，调动好友参与评论，帮助网站实现社会化网络优化，有效提升网站社会化流量。现在还健在。\x3c\/li\x3e\n\x3cli\x3e友言。友言是国内专业的第三方实时社会化评论系统，“完全社交化”可将评论一键同步到各大微博与社区（目前支持10个社交媒体），同时将评论的回复与跟帖同步至使用的网站上，让网站变得更具有活力和社交性，从而为网站带来更多的回访和流量，是一个简单而强大的社会化评论及聚合平台。现在还健在。\x3c\/li\x3e\n\x3cli\x3e网易云跟帖。网易云跟贴是网易公司推出的强大而又简单的评论聚合与分享平台。坑爹的，在多说发布停止服务声明之后不久，网易云跟帖也分出了停止服务声明。\x3c\/li\x3e\n\x3cli\x3eDisqus。说到第三放评论系统，当然不得不提国外第三方评论系统界的老大 Disqus，只可惜由于天朝网络原因，Disqus 加载很慢，甚至有时候加载不出来，建议用户自备梯子。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e那么回归主题，市面上那么多第三方评论系统，就算有那么一两个挂掉了，还是有很多选择呢，为什么还要自己去做一个呢，这不是造轮子吗？其实，一开始我一直用多说的，用的不亦乐乎，突然有一天说挂就挂了，没办法，那我就选择其他的呗，然后就改成网易云，坑爹的，刚改造好没多久，网易云也挂了。\x3c\/p\x3e\n\x3cp\x3e后面我就在网上找啊找啊，发现居然有人用 GitHub Issue 做了一个评论系统，这无疑是一个很好的想法，很有创意啊。当然，我也拿来用了，但是始终觉得有点丑，跟我自己的博客主题不搭，才用了两天，撤了，打算自己做一个。说干就干，程序员总喜欢造轮子。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e二、什么是 GitHub Issues\x3c\/h3\x3e\n\x3cp\x3e经常逛 GitHub 的童鞋，都应该知道这个功能，有人理解 GitHub 的 issue 功能，就如同 TODO list。你可以把所有想要在下一步完成的工作，如 feature 添加、bug 修复等，都写成一个个的 issue ，放在上面。既可以作为提醒，也可以统一管理。另外，每一次 commit 都可以选择性的与某个 issue 关联。比如在 message 中添加 #n，就可以与第 n 个 issue 进行关联。具体可以看一下知乎里面别人对 《\x3ca href=\x22https:\/\/www.zhihu.com\/question\/22969033\/answer\/25927363\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3egithub issue是做什么的？\x3c\/a\x3e 》的解答。而本博客的评论数据存储 issues 仓库地址为 \x3ca href=\x22https:\/\/github.com\/jangdelong\/blog_comments\/issues\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/jangdelong\/blog_comments\/issues\x3c\/a\x3e，仓库里面并没有放置托管代码。总之，像我现在要用 github Issues 来制作评论系统的，其实就是把数据存储到 github issues，简单的说可以把 github issues 理解为一个免费的数据库。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e三、评论系统实现\x3c\/h3\x3e\n\x3cp\x3e\x3cstrong\x3e预备工作\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e创建 OAuth applications。评论需要涉及 GitHub 授权登录，所以在这里你先要有一个 GitHub application。GitHub 授权登录遵循 \x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2014\/05\/oauth_2_0.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eOAuth 2.0 标准\x3c\/a\x3e。OAuth applications 创建如下图所示，填写上面相应的内容。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011100939\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011100939\x22 alt=\x22OAuth\x22 title=\x22OAuth\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3eApplication name：你的站点名称；\x3cbr\x3eHomepage URL：你的站点主页链接；\x3cbr\x3eApplication description：站点描述；\x3cbr\x3eAuthorization callback URL：GitHub 授权成功后返回地址\x3c\/p\x3e\n\x3cp\x3e创建成功之后会生成一个 Client ID 和一个 Client Secret。\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3eGitHub REST API v3\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3eGitHub 提供了很多方便第三方开发的 API，当然，github issues 的增删改查 API 也在其中，有了这些 API，你才能各种施展奇技淫巧，比如我们现在要写的评论系统。另外，有人怀疑我们应不应该“滥用”这些 API，但是，个人觉得，既然，GitHub 提供了这些 API，就是说明要开放给大家这些权限，应该就不怕你“滥用”。那么，要满足我们现在的需求需要哪些 API 呢，下面我列举一下，以我的账号为例，jangdelong 为 Github 名，blog_comments 为仓库名。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eGET: https:\/\/api.github.com\/repos\/jangdelong\/blog_comments\/issues\x3c\/code\x3e                         获取所有issues信息\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eGET: https:\/\/api.github.com\/repos\/jangdelong\/blog_comments\/issues\/11\x3c\/code\x3e                   获取某个issue下的信息 （11 为 issue 编号 ）\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eGET: https:\/\/api.github.com\/repos\/jangdelong\/blog_comments\/issues\/11\/\x3c\/code\x3ecomments  获取某个issue下的评论\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eGET: https:\/\/api.github.com\/repos\/jangdelong\/blog_comments\/issues\/comments\/111\/reactions\x3c\/code\x3e 获取评论 ID 为 111 下的所有 reactions（reactions 包含顶[\x2b1]、踩[-1]、喜欢[heart]等字段）\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ePOST: https:\/\/api.github.com\/repos\/jangdelong\/blog_comments\/issues\x3c\/code\x3e 创建一个 issue\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ePOST: https:\/\/api.github.com\/repos\/jangdelong\/blog_comments\/issues\/11\/comments\x3c\/code\x3e 在编号为 11 的 issue 下创建一条评论\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ePOST: https:\/\/api.github.com\/repos\/jangdelong\/blog_comments\/issues\/comments\/111\/reactions\x3c\/code\x3e 在 ID 为 111 的评论下创建一条 reactions（如 heart）\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ePOST：https:\/\/developer.github.com\/v3\/markdown\/\x3c\/code\x3e  markdown 语法解析接口\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e整体设计\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e流程图：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22                                             |--\x3e 显示已登录    \n                              |--\x3e 已登录 --\x3e |--\x3e 加载评论列表 --\x3e 分页加载 \n                              |              |--\x3e 其他 \n                              |              |--\x3e 评论操作 --\x3e 成功\/失败            |\n 开始 --\x3e GitHub 授权登录 ? --\x3e |                                                   |--\x3e 结束\n                              |              |--\x3e 显示未登录                       |\n                              |--\x3e 未登录 --\x3e |--\x3e 加载评论列表 --\x3e 分页加载          \n                                             |--\x3e 其他\n                                             |--\x3e 评论操作 --\x3e 提示未登录状态\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs brainfuck\x22\x3e\x3ccode\x3e                                             \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e显示已登录\x3c\/span\x3e    \n                              \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e已登录\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e加载评论列表\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e分页加载\x3c\/span\x3e \n                              \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e              \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e其他\x3c\/span\x3e \n                              \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e              \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e评论操作\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e成功\/失败\x3c\/span\x3e            \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e\n \x3cspan class=\x22hljs-comment\x22\x3e开始\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3eGitHub\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e授权登录\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e?\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e                                                   \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e结束\x3c\/span\x3e\n                              \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e              \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e显示未登录\x3c\/span\x3e                       \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e\n                              \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e未登录\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e加载评论列表\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e分页加载\x3c\/span\x3e          \n                                             \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e其他\x3c\/span\x3e\n                                             \x3cspan class=\x22hljs-comment\x22\x3e|\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e评论操作\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x26gt; \x3cspan class=\x22hljs-comment\x22\x3e提示未登录状态\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e效果图：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011100940\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011100940\x22 alt=\x22OAuth\x22 title=\x22OAuth\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e因此，我们可以将评论系统分为列表（list）、评论框（box）、顶部登录状态栏（signbar）等部分。View 部分的代码组织为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 为了减少全局变量，整个网站就暴露一个全局变量 JELON\nvar JELON = JELON || {};\n;(function (JL) {\n    ...\n    JL.Renders = {\n        \/\/ 列表模块\n        list: {\n            tpl: ...,\n            ...\n        },\n        \/\/ 评论框模块\n        box: {\n            tpl: ...,\n            ...\n        },\n        \/\/ 顶部登录状态栏\n        signBar: {\n            tpl: ...,\n            ...\n        },\n        ... \/\/ 其他模块视图\n    };\n    ...\n})(JELON);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 为了减少全局变量，整个网站就暴露一个全局变量 JELON\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e JELON = JELON || {};\n;(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eJL\x3c\/span\x3e) \x3c\/span\x3e{\n    ...\n    JL.Renders = {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 列表模块\x3c\/span\x3e\n        list: {\n            \x3cspan class=\x22hljs-attr\x22\x3etpl\x3c\/span\x3e: ...,\n            ...\n        },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 评论框模块\x3c\/span\x3e\n        box: {\n            \x3cspan class=\x22hljs-attr\x22\x3etpl\x3c\/span\x3e: ...,\n            ...\n        },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 顶部登录状态栏\x3c\/span\x3e\n        signBar: {\n            \x3cspan class=\x22hljs-attr\x22\x3etpl\x3c\/span\x3e: ...,\n            ...\n        },\n        ... \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 其他模块视图\x3c\/span\x3e\n    };\n    ...\n})(JELON);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e视图部分的代码组织好之后，根据 GitHub 提供的各种 API，我们将其封装到 Requests 里面去，组织如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 为了减少全局变量，整个网站就暴露一个全局变量 JELON\nvar JELON = JELON || {};\n;(function (JL) {\n    ...\n    JL.Requests = {\n        \/\/ 根据 label 获取 issue 编号\n        getIssueNumberByLabel: function () { ... },\n        \/\/ 创建 issue\n        createIssue: function () { ... },\n        \/\/ 根据 issue 编号获取评论列表\n        getCommentListByIssueNumber: function () { ... },\n        \/\/ 根据评论 ID 获取 reactions （即点赞数据）\n        getReactionsByCommentId: function () { ... },\n        \/\/ markdown 解析\n        markdown: function () { ... },\n        \/\/ 通过 code 获取 access_token\n        getAccessToken: function () { ... },\n        \/\/ 利用 access_token 去获取 GitHub 用户信息\n        getUserInfo: function () { ... },\n        \/\/ 创建评论\n        createComment: function () { ... },\n        \/\/ 创建 reactions （点赞）\n        createReaction: function () { ... }\n    };\n    ...\n})(JELON);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 为了减少全局变量，整个网站就暴露一个全局变量 JELON\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e JELON = JELON || {};\n;(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eJL\x3c\/span\x3e) \x3c\/span\x3e{\n    ...\n    JL.Requests = {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 根据 label 获取 issue 编号\x3c\/span\x3e\n        getIssueNumberByLabel: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建 issue\x3c\/span\x3e\n        createIssue: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 根据 issue 编号获取评论列表\x3c\/span\x3e\n        getCommentListByIssueNumber: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 根据评论 ID 获取 reactions （即点赞数据）\x3c\/span\x3e\n        getReactionsByCommentId: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ markdown 解析\x3c\/span\x3e\n        markdown: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 通过 code 获取 access_token\x3c\/span\x3e\n        getAccessToken: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 利用 access_token 去获取 GitHub 用户信息\x3c\/span\x3e\n        getUserInfo: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建评论\x3c\/span\x3e\n        createComment: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建 reactions （点赞）\x3c\/span\x3e\n        createReaction: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... }\n    };\n    ...\n})(JELON);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e接下来是封装事件操作，我们将其封装到 Actions 里面去，代码组织如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 为了减少全局变量，整个网站就暴露一个全局变量 JELON\nvar JELON = JELON || {};\n;(function (JL) {\n    ...\n    JL.Actions = {\n        \/\/ 初始加载，如列表、登录状态等\n        init: function () { ... },\n        \/\/ 登出操作\n        signOut: function () { ... },\n        \/\/ 列表翻页跳转\n        pageJump: function () { ... },\n        \/\/ 编辑预览\n        editPreviewSwitch: function () { ... },\n        \/\/ 提交评论操作\n        postComment: function () { ... },\n        \/\/ 点赞操作\n        like: function () { ... }\n    };\n    ...\n})(JELON);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 为了减少全局变量，整个网站就暴露一个全局变量 JELON\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e JELON = JELON || {};\n;(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eJL\x3c\/span\x3e) \x3c\/span\x3e{\n    ...\n    JL.Actions = {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 初始加载，如列表、登录状态等\x3c\/span\x3e\n        init: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 登出操作\x3c\/span\x3e\n        signOut: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 列表翻页跳转\x3c\/span\x3e\n        pageJump: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 编辑预览\x3c\/span\x3e\n        editPreviewSwitch: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 提交评论操作\x3c\/span\x3e\n        postComment: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... },\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 点赞操作\x3c\/span\x3e\n        like: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ ... }\n    };\n    ...\n})(JELON);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e程序入口：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 为了减少全局变量，整个网站就暴露一个全局变量 JELON\nvar JELON = JELON || {};\n;(function (JL) {\n    ...\n    JL.Comment = function (options) {\n        JL.options = options || {};\n        $(\x27comments\x27).innerHTML = [\n            this.Renders.signBar.tpl,\n            this.Renders.box.tpl,\n            this.Renders.tips,\n            this.Renders.list.tpl\n        ].join(\x27\x27);\n        JL.Actions.init();\n    };\n    ...\n})(JELON);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 为了减少全局变量，整个网站就暴露一个全局变量 JELON\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e JELON = JELON || {};\n;(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eJL\x3c\/span\x3e) \x3c\/span\x3e{\n    ...\n    JL.Comment = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eoptions\x3c\/span\x3e) \x3c\/span\x3e{\n        JL.options = options || {};\n        $(\x3cspan class=\x22hljs-string\x22\x3e\x27comments\x27\x3c\/span\x3e).innerHTML = [\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Renders.signBar.tpl,\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Renders.box.tpl,\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Renders.tips,\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Renders.list.tpl\n        ].join(\x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e);\n        JL.Actions.init();\n    };\n    ...\n})(JELON);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e登录流程\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3eGitHub 授权登录是不可或缺的功能，用只有登录之后才能进行评论。前面有提到，GitHub 授权登录是遵循一个 OAuth 2.0 标准。以下是 OAuth 2.0 的一个运作流程，可以让我们更好的理解它。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011100941\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011100941\x22 alt=\x22OAuth 2.0 运行流程\x22 title=\x22OAuth 2.0 运行流程\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e那么，GitHub 授权登录是怎么样按照这个标准来运作的呢，接下来简单介绍一下，如果要更加详细深入了解的话，你也可以访问 \x3ca href=\x22https:\/\/developer.github.com\/apps\/building-integrations\/setting-up-and-registering-oauth-apps\/about-authorization-options-for-oauth-apps\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGitHub 官方文档\x3c\/a\x3e。\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3cp\x3e用户发起重定向请求授权服务器换取 code\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22`GET http:\/\/github.com\/login\/oauth\/authorize`\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs awk\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e`GET http:\x3cspan class=\x22hljs-regexp\x22\x3e\/\/gi\x3c\/span\x3ethub.com\x3cspan class=\x22hljs-regexp\x22\x3e\/login\/\x3c\/span\x3eoauth\x3cspan class=\x22hljs-regexp\x22\x3e\/authorize`\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e拿到 code 之后，利用 client_id、client_secret 和 code 去换取 token_access。（client_id 和 client_secret 前面的预备工作里有提到）\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22`POST https:\/\/github.com\/login\/oauth\/access_token`\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs awk\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e`POST https:\x3cspan class=\x22hljs-regexp\x22\x3e\/\/gi\x3c\/span\x3ethub.com\x3cspan class=\x22hljs-regexp\x22\x3e\/login\/\x3c\/span\x3eoauth\x3cspan class=\x22hljs-regexp\x22\x3e\/access_token`\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e获取到 token_access 之后，我们就可以用 token_access 去获取已登录的用户的信息了\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22`GET https:\/\/api.github.com\/user`\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs autohotkey\x22\x3e\x3ccode\x3e`GET https:\/\/api.github.com\/user`\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e通过以上3个步骤，GitHub 授权登录就算是完成了。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e四、评论系统如何使用\x3c\/h3\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3cp\x3e引入评论系统相关的 css、js 。引入相关样式和脚本之后，在你的页面加入以下代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3clink rel=\x26quot;stylesheet\x26quot; href=\x26quot;样式路径\x26quot;\x3e\n\x3cscript src=\x26quot;脚本路径\x26quot;\x3e\x3c\/script\x3e\n\x3cdiv id=\x26quot;comment\x26quot; class=\x26quot;comment\x26quot;\x3e\n\x3c\/div\x3e\n\x3cscript\x3e\nJELON.Comment({\n    container: \x27comments\x27, \/\/ 评论框容器id或对象，留空是默认为 comments \n    label: \x27\x3c%- post.slug %\x3e\x27 || \x27\x3c%- post.path %\x3e\x27, \/\/ 文章标签\n    owner: \x27\x3c%- theme.comment.owner %\x3e\x27, \/\/ GitHub application 创建者\n    repo: \x27\x3c%- theme.comment.repo %\x3e\x27, \/\/ issue 所在仓库名\n    clientId: \x27\x3c%- theme.comment.client_id %\x3e\x27, \/\/ GitHub application client_id\n    clientSecret: \x27\x3c%- theme.comment.client_secret %\x3e\x27 \/\/ GitHub application client_secret\n});\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elink\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3erel\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22stylesheet\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ehref\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22样式路径\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22脚本路径\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22comment\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22comment\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22actionscript\x22\x3e\nJELON.Comment({\n    container: \x3cspan class=\x22hljs-string\x22\x3e\x27comments\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 评论框容器id或对象，留空是默认为 comments \x3c\/span\x3e\n    label: \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;%- post.slug %\x26gt;\x27\x3c\/span\x3e || \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;%- post.path %\x26gt;\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 文章标签\x3c\/span\x3e\n    owner: \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;%- theme.comment.owner %\x26gt;\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ GitHub application 创建者\x3c\/span\x3e\n    repo: \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;%- theme.comment.repo %\x26gt;\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ issue 所在仓库名\x3c\/span\x3e\n    clientId: \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;%- theme.comment.client_id %\x26gt;\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ GitHub application client_id\x3c\/span\x3e\n    clientSecret: \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;%- theme.comment.client_secret %\x26gt;\x27\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/ GitHub application client_secret\x3c\/span\x3e\n});\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e由于这个评论系统是要集成到个人的主题上去的，所以要跟 hexo-theme-xups 搭配使用，hexo-theme-xups 主题链接为 \x3ca href=\x22https:\/\/github.com\/jangdelong\/hexo-theme-xups\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/jangdelong\/hexo-theme-xups\x3c\/a\x3e，目前最新的主题（带有GitHub 登录评论功能），后面会更新上去，往后当然也会陆续进行更新和优化，欢迎多多 star。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e五、遇到的问题\x3c\/h3\x3e\n\x3cp\x3e遇到的问题主要有三个，一个是创建 label 权限问题，一个是跨域问题，另外一个 GitHub 授权登录兼容性问题。\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3cp\x3e创建 label 权限问题（目前未解决）。label 是一个连接文章和 issue 关系的纽带，因为我们要用 label 去查询 issue number，后面的流程才能走下去。如今遇到的问题是，对于新文章来说，只能是我自己本人账号（GitHub Application）创建者才能创建带有 label 的 issue。参考了 GitHub 的接口（\x3ccode\x3ePOST \/repos\/:owner\/:repo\/issues\x3c\/code\x3e）文档，上面说\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3e Labels to associate with this issue. NOTE: Only users with push access can set labels for new issues. Labels are silently dropped otherwise.\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs livescript\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x26gt; Labels \x3cspan class=\x22hljs-keyword\x22\x3eto\x3c\/span\x3e associate \x3cspan class=\x22hljs-keyword\x22\x3ewith\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e issue. NOTE: Only users \x3cspan class=\x22hljs-keyword\x22\x3ewith\x3c\/span\x3e push access can set labels \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e issues. Labels are silently dropped \x3cspan class=\x22hljs-keyword\x22\x3eotherwise\x3c\/span\x3e.\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e跨域问题（暂时解决了）。主要是通过 code 去换取 token_access 的 \x3ccode\x3ePOST https:\/\/github.com\/login\/oauth\/access_token\x3c\/code\x3e 这个接口跨域，暂时解决方案是\x3cbr\x3e使用 \x3ccode\x3ehttps:\/\/cors-anywhere.herokuapp.com\/https:\/\/github.com\/login\/oauth\/access_token\x3c\/code\x3e 进行转发。参见：\x3ca href=\x22https:\/\/github.com\/Rob--W\/cors-anywhere\/#documentation\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/Rob--W\/cor...\x3c\/a\x3e 。\x3c\/li\x3e\n\x3cli\x3eGitHub 授权登录兼容性问题（暂时不解决）。经过简单的测试，发现 PC 端兼容性问题主要是一些老版本的浏览器，其中包括一些老版本的谷歌浏览器（版本号55.x.xxxx.xx）；而移动端的主要是 UC 浏览器无法实现 GitHub 授权登录。\x3c\/li\x3e\n\x3c\/ol\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>基于 github issues 实现第三方评论系统</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011100934">https://segmentfault.com/a/1190000011100934</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/gfoj8k8we6f/" target="_blank">https://alili.tech/archive/gfoj8k8we6f/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>