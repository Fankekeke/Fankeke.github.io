<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="为什么要避免使用 &#34;document.write()&#34;"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>为什么要避免使用 &#34;document.write()&#34; | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/h8z6pkbotok/",
				"appid": "1613049289050283", 
				"title": "为什么要避免使用 &#34;document.write()&#34; | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-04T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/8jte0g0a1ta/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/4c62am6qg8i/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fh8z6pkbotok%2f&text=%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e9%81%bf%e5%85%8d%e4%bd%bf%e7%94%a8%20%22document.write%28%29%22"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fh8z6pkbotok%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fh8z6pkbotok%2f&text=%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e9%81%bf%e5%85%8d%e4%bd%bf%e7%94%a8%20%22document.write%28%29%22"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fh8z6pkbotok%2f&title=%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e9%81%bf%e5%85%8d%e4%bd%bf%e7%94%a8%20%22document.write%28%29%22"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fh8z6pkbotok%2f&is_video=false&description=%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e9%81%bf%e5%85%8d%e4%bd%bf%e7%94%a8%20%22document.write%28%29%22"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e9%81%bf%e5%85%8d%e4%bd%bf%e7%94%a8%20%22document.write%28%29%22&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fh8z6pkbotok%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fh8z6pkbotok%2f&title=%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e9%81%bf%e5%85%8d%e4%bd%bf%e7%94%a8%20%22document.write%28%29%22"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fh8z6pkbotok%2f&title=%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e9%81%bf%e5%85%8d%e4%bd%bf%e7%94%a8%20%22document.write%28%29%22"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fh8z6pkbotok%2f&title=%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e9%81%bf%e5%85%8d%e4%bd%bf%e7%94%a8%20%22document.write%28%29%22"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fh8z6pkbotok%2f&title=%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e9%81%bf%e5%85%8d%e4%bd%bf%e7%94%a8%20%22document.write%28%29%22"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">为什么要避免使用 &#34;document.write()&#34;</h1><div class="meta"><div class="postdate"><time datetime="2019-01-04" itemprop="datePublished">2019-01-04</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e本文是技术圈 \x3ca href=\x22https:\/\/segmentfault.com\/g\/1570000010620468\x22\x3egoogle 浏览器前端新特性播报\x3c\/a\x3e的推送，欢迎大家加入\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader0\x22\x3e为什么要避免使用 \x3ccode\x3edocument.write()\x3c\/code\x3e\n\x3c\/h3\x3e\n\x3cp\x3e最近我们发现如果我们在页面中使用了\x3ccode\x3edocument.wirte()\x3c\/code\x3e,那么在 chrome 的开发者控制台会出现下面的警告信息\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22(index):34 A Parser-blocking, cross-origin script, \nhttps:\/\/paul.kinlan.me\/ad-inject.js, is invoked via document.write(). \nThis may be blocked by the browser if the device has poor network connectivity.\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs vim\x22\x3e\x3ccode\x3e(\x3cspan class=\x22hljs-built_in\x22\x3eindex\x3c\/span\x3e):\x3cspan class=\x22hljs-number\x22\x3e34\x3c\/span\x3e A Parser-blocking, cross-origin script, \nhttp\x3cspan class=\x22hljs-variable\x22\x3es:\x3c\/span\x3e\/\/paul.kinlan.\x3cspan class=\x22hljs-keyword\x22\x3eme\x3c\/span\x3e\/ad-inject.js, \x3cspan class=\x22hljs-keyword\x22\x3eis\x3c\/span\x3e invoked via document.\x3cspan class=\x22hljs-keyword\x22\x3ewrite\x3c\/span\x3e(). \nThis may \x3cspan class=\x22hljs-keyword\x22\x3ebe\x3c\/span\x3e blocked by the browser \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e the device \x3cspan class=\x22hljs-built_in\x22\x3ehas\x3c\/span\x3e poor network connectivity.\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e为啥要做这个提示呢，对于在2G，3G 或者是慢 wifi 环境下面，使用\x3ccode\x3edocument.write()\x3c\/code\x3e动态加载资源会让页面的展现慢10秒以上，浏览器可以呈现页面之前，必须通过解析HTML标记来构建DOM树。每当解析器遇到脚本时，它必须停止并执行它，然后才能继续解析HTML。如果脚本动态地注入另一个脚本，解析器将被迫等待更长时间才能下载资源，这可能会导致一个或多个网络往返并延迟首次渲染页面的时间，导致页面无法加载或花费的时间长于用户放弃。根据Chrome中的设备，我们了解到，通过第三方脚本插入的\x3ccode\x3edocument.write()\x3c\/code\x3e页面的速度通常比2G的其他页面载入速度慢两倍。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e去除\x3ccode\x3edocument.write\x3c\/code\x3e的效果\x3c\/h3\x3e\n\x3cp\x3echrome 开发者收集了28天chrome浏览器使用者的2G浏览数据,从中发现7.6%的2G加载页面中都包含了通过\x3ccode\x3edocument.write()\x3c\/code\x3e写入页面的跨网站，并且会中断浏览器解析的脚本。通过把这些加载脚本进行拦截加载，我们看到了以下的改进：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e页面加载到达\x3ccode\x3efirst contentful paint(视觉上让用户感觉正在加载的状态)t\x3c\/code\x3e的状态的数量增加10%，达到完全解析状态的页面数量增加25%，减少10%由于需要刷新页面带来的用户失望\x3c\/li\x3e\n\x3cli\x3e到达\x3ccode\x3efirst contentful paint\x3c\/code\x3e的时间减少了21%(加快速度大于1秒)\x3c\/li\x3e\n\x3cli\x3e解析页面所需的时间减少了38%，差不多加快了6秒，大大减少了向用户展示内容的时间\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3echrome 浏览器对于\x3ccode\x3edocument.write\x3c\/code\x3e的策略\x3c\/h3\x3e\n\x3cp\x3e针对以上的测试数据，chrome 从 55版本开始，chrome 浏览器对用户使用的\x3ccode\x3edocument.write()\x3c\/code\x3e进行干预，如果符合以下\x3cstrong\x3e所有\x3c\/strong\x3e的情况，页面\x3ccode\x3e\x26lt;script\x26gt;\x3c\/code\x3e标签中的\x3ccode\x3edocument.write()\x3c\/code\x3e将不会被执行:\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e用户处于缓慢的连接状态，特别是用户在2G时。（将来可能会延伸到慢速连接的其他用户，例如慢速3G或慢速WiFi。）\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3edocument.write()\x3c\/code\x3e在一个顶级的文件中，不适用于iframe中的document.write脚本，因为它们不会阻止主页面的呈现。\x3cbr\x3e3.\x3ccode\x3edocument.write()\x3c\/code\x3e中加载的脚本是会阻断解析的，如果脚本中有\x3ccode\x3easync\x3c\/code\x3e或者是\x3ccode\x3edefer\x3c\/code\x3e属性，那么它们还是会被解析执行\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e4.\x3ccode\x3edocument.write()\x3c\/code\x3e中加载的脚本和页面地址不是同个主域的，换句话说，chrome 浏览器不会阻止\x3ccode\x3escript\x3c\/code\x3e标签符合\x3ccode\x3eeTLD\x2b1\x3c\/code\x3e规则的加载（比如页面地址是\x3ccode\x3ewww.a.com\x3c\/code\x3e,\x3ccode\x3escript\x3c\/code\x3e的地址是 \x3ccode\x3ejs.a.com\x3c\/code\x3e）\x3cbr\x3e5.\x3ccode\x3edocument.write()\x3c\/code\x3e中加载的脚本尚未在浏览器HTTP缓存中。缓存中的脚本不会导致网络延迟，并且仍然会执行。\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e页面的请求不是重新加载。如果用户触发重新加载并且正常执行该页面，Chrome将不会进行干预。\x3c\/li\x3e\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e如何检测你的\x3ccode\x3edocument.write\x3c\/code\x3e是否被执行限制了\x3c\/h3\x3e\n\x3cp\x3echrome 提供了多种方式来检测你的\x3ccode\x3edocument.write\x3c\/code\x3e请求是否被限制了\x3c\/p\x3e\n\x3ch4\x3e了解下你的用户在2G下面的使用占比\x3c\/h4\x3e\n\x3cp\x3e由于上面的规则现阶段只针对慢速情况2G,因此首先可以先分析出来，你的网站的2G 用户占比，通过\x3ccode\x3echrome\x3c\/code\x3e提供的网络信息 API，可以判断用户是不是在2G 环境下面，代码如下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if(navigator.connection \x26amp;\x26amp;\n   navigator.connection.type === \x27cellular\x27 \x26amp;\x26amp;\n   navigator.connection.downlinkMax \x3c= 0.115) {\n   \/\/ Notify your service to indicate that you might be affected by this restriction.\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs go\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(navigator.connection \x26amp;\x26amp;\n   navigator.connection.\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27cellular\x27\x3c\/span\x3e \x26amp;\x26amp;\n   navigator.connection.downlinkMax \x26lt;= \x3cspan class=\x22hljs-number\x22\x3e0.115\x3c\/span\x3e) {\n   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Notify your service to indicate that you might be affected by this restriction.\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e在 Chrome DevTools 中捕获警告\x3c\/h4\x3e\n\x3cp\x3e在\x3ccode\x3echrome devtools\x3c\/code\x3e中，如果页面满足上面的2-5的规则，则会在\x3ccode\x3echrome devtools\x3c\/code\x3e中看到如下警告\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVSSL9?w=640\x26amp;h=196\x22 src=\x22https:\/\/static.alili.tech\/img\/bVSSL9?w=640\x26amp;h=196\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e￼\x3c\/p\x3e\n\x3ch4\x3e更加全面的告警\x3c\/h4\x3e\n\x3cp\x3e上面两种方式结合之后可以对影响的用户量有一个初步的判断，如果要做精确的判断，可以检查 HTTP 头部：\x3cbr\x3e当插入的脚本document.write被阻止时，Chrome会将以下标头发送到所请求的资源：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Intervention: \x3chttps:\/\/shorturl\/relevant\/spec\x3e;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-string\x22\x3eIntervention:\x3c\/span\x3e \x26lt;\x3cspan class=\x22hljs-string\x22\x3ehttps:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/shorturl\/relevant\/spec\x26gt;;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当document.write发现插入脚本时，可能会在不同情况下被阻止，Chrome可能会发送：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Intervention: \x3chttps:\/\/shorturl\/relevant\/spec\x3e; level=\x26quot;warning\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs awk\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eIntervention: \x26lt;https:\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3eshorturl\x3cspan class=\x22hljs-regexp\x22\x3e\/relevant\/\x3c\/span\x3espec\x26gt;; level=\x3cspan class=\x22hljs-string\x22\x3e\x22warning\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e干预头将作为脚本的GET请求的一部分发送（在实际干预的情况下异步）。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e替换方案\x3c\/h3\x3e\n\x3cp\x3e由于\x3ccode\x3edocument.write\x3c\/code\x3e会减慢页面的加载，可以考虑使用\x3ccode\x3eappendChild\x3c\/code\x3e等 api 将元素插入页面中，不过这两者有以下的区别\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ccode\x3edocument.write\x3c\/code\x3e的参数是一个 html 字符串，\x3ccode\x3eappendChild\x3c\/code\x3e是一个\x3ccode\x3eNode\x3c\/code\x3e对象\x3c\/li\x3e\n\x3cli\x3e如果有多个\x3ccode\x3edocument.write\x3c\/code\x3e写入 script 标签，标签与标签之间的加载是同步的，也就是说，标签的加载顺序会和\x3ccode\x3edocument.write\x3c\/code\x3e的执行顺序相同;而使用\x3ccode\x3eappendChild\x3c\/code\x3e插入多个\x3ccode\x3esciprt\x3c\/code\x3e标签时，标签加载的顺序是不确定的,先加载完成的先执行，因此通过\x3ccode\x3eappendChild\x3c\/code\x3e插入\x3ccode\x3escript\x3c\/code\x3e标签时，要注意是否需要对加载的顺序进行控制，可以通过\x3ccode\x3escript.onload\x3c\/code\x3e进行顺序回调插入\x3c\/li\x3e\n\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>为什么要避免使用 &ldquo;document.write()&rdquo;</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010657951">https://segmentfault.com/a/1190000010657951</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/h8z6pkbotok/" target="_blank">https://alili.tech/archive/h8z6pkbotok/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>