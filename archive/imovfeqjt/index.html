<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="如何理解package.json中的proxy字段？"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>如何理解package.json中的proxy字段？ | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/imovfeqjt/",
				"appid": "1613049289050283", 
				"title": "如何理解package.json中的proxy字段？ | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-11-30T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/swiwedu3cy9/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/nm4y4ktt8fd/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fimovfeqjt%2f&text=%e5%a6%82%e4%bd%95%e7%90%86%e8%a7%a3package.json%e4%b8%ad%e7%9a%84proxy%e5%ad%97%e6%ae%b5%ef%bc%9f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fimovfeqjt%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fimovfeqjt%2f&text=%e5%a6%82%e4%bd%95%e7%90%86%e8%a7%a3package.json%e4%b8%ad%e7%9a%84proxy%e5%ad%97%e6%ae%b5%ef%bc%9f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fimovfeqjt%2f&title=%e5%a6%82%e4%bd%95%e7%90%86%e8%a7%a3package.json%e4%b8%ad%e7%9a%84proxy%e5%ad%97%e6%ae%b5%ef%bc%9f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fimovfeqjt%2f&is_video=false&description=%e5%a6%82%e4%bd%95%e7%90%86%e8%a7%a3package.json%e4%b8%ad%e7%9a%84proxy%e5%ad%97%e6%ae%b5%ef%bc%9f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%a6%82%e4%bd%95%e7%90%86%e8%a7%a3package.json%e4%b8%ad%e7%9a%84proxy%e5%ad%97%e6%ae%b5%ef%bc%9f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fimovfeqjt%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fimovfeqjt%2f&title=%e5%a6%82%e4%bd%95%e7%90%86%e8%a7%a3package.json%e4%b8%ad%e7%9a%84proxy%e5%ad%97%e6%ae%b5%ef%bc%9f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fimovfeqjt%2f&title=%e5%a6%82%e4%bd%95%e7%90%86%e8%a7%a3package.json%e4%b8%ad%e7%9a%84proxy%e5%ad%97%e6%ae%b5%ef%bc%9f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fimovfeqjt%2f&title=%e5%a6%82%e4%bd%95%e7%90%86%e8%a7%a3package.json%e4%b8%ad%e7%9a%84proxy%e5%ad%97%e6%ae%b5%ef%bc%9f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fimovfeqjt%2f&title=%e5%a6%82%e4%bd%95%e7%90%86%e8%a7%a3package.json%e4%b8%ad%e7%9a%84proxy%e5%ad%97%e6%ae%b5%ef%bc%9f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">如何理解package.json中的proxy字段？</h1><div class="meta"><div class="postdate"><time datetime="2018-11-30" itemprop="datePublished">2018-11-30</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000014891899\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000014891899\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e入职新公司以来，第一个月接手vue项目，第二个月接手angularjs项目，第三个月加入react重构项目。心生感叹：业务驱动式学习是一种高效率的学习方式，保持好奇心，在业务中快速成长！\x3cbr\x3e新项目中在package.json中有一个proxy字段，这是我从来没接触过的，因此就有了此文的诞生，我使用create-react-app 新建了一个最原始状态的项目，对proxy字段与create-react-app之间的纠葛展开了学习。\x3c\/blockquote\x3e\n\x3cp\x3e在npm-configuration中，对proxy有如下解释：\x3c\/p\x3e\n\x3cblockquote\x3e默认值为null，类型为url，一个为了发送http请求的代理。如果HTTP__PROXY或者http_proxy环境变量已经设置好了，那么proxy设置将被底层的请求库实现。\x3c\/blockquote\x3e\n\x3cp\x3e这个proxy字段目前我只了解到可以与create-react-app的react-scripts结合使用:Proxying API Requests in Development，react-scripts应该是基于HTTP_PROXY环境变量做了一些封装。\x3c\/p\x3e\n\x3cp\x3e阅读完本文，你将有一以下收获：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cstrong\x3e如何更优雅地为前端项目配置代理Proxy服务器\x3c\/strong\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cstrong\x3e复现之前啃《HTTP权威指南》代理相关的知识\x3c\/strong\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cstrong\x3e对easy-mock的使用限制有了新的认识\x3c\/strong\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cstrong\x3e对process.env可以直接在React层展示感到震惊\x3c\/strong\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cstrong\x3e了解到对process.env可以进行扩展的dotenv和expand-env两个库\x3c\/strong\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e主要分为3部分：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e开发过程中的Proxy API 请求设置\x3c\/li\x3e\n\x3cli\x3e手动配置proxy\x3c\/li\x3e\n\x3cli\x3e环境变量式配置Proxy\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader0\x22\x3e开发过程中的Proxy API 请求设置\x3c\/h3\x3e\n\x3cblockquote\x3e注意：这个特性可以在react-scripts@2.3以及更高版本中使用。\x3c\/blockquote\x3e\n\x3cp\x3e人们通常从将服务于后端实现的host和port，同样也为前端react应用提供服务。\x3cbr\x3e例如，在一个应用部署后，生产配置类似下面这样：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/                   -静态服务器返回React应用和index.html\n\/todos         -静态服务器返回React应用和index.html\n\/api\/todos   -服务器会使用后端实现去处理所有\/api\/*的请求\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3e\/                   -静态服务器返回React应用和index\x3cspan class=\x22hljs-selector-class\x22\x3e.html\x3c\/span\x3e\n\/todos         -静态服务器返回React应用和index\x3cspan class=\x22hljs-selector-class\x22\x3e.html\x3c\/span\x3e\n\/api\/todos   -服务器会使用后端实现去处理所有\/api\x3cspan class=\x22hljs-comment\x22\x3e\/*的请求\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e但其实这样的设置不是必须的。然而，如果你确实有一个这样的设置，在不考虑重定向它们到其他的host和port开发环境下，那么写出像fetch(\x27\/api\/todos\x27)这样的请求时正常的。\x3c\/p\x3e\n\x3cp\x3e为了告诉开发环境的服务器去代理任何开发环境中未知的请求到我们自己的api服务器，添加一个proxy到package.json的字段，例如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;proxy\x26quot;:\x26quot;http:\/\/localhost:4000\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs 1c\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22proxy\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/localhost:4000\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e使用这种形式的话，当你在开发环境中使用fecth(\x27api\/todos\x27)的时候，开发环境的服务器将识别出这不是一个静态资源，然后将代理转发你的请求到\x3ca href=\x22http:\/\/localhost\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/localhost\x3c\/a\x3e:4000\/api\/todos 作为一个回调。生产环境服务器只能代理没有text\/html在Accept头中的请求。\x3c\/p\x3e\n\x3cp\x3e方便的是，这就避免了CORS问题以及类似像下面这样的错误信息。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Fetch API cannot load http:\/\/localhost:4000\/api\/todos. No \x27Access-Control-Allow-Origin\x27 header is present on the requested resource. Origin \x27http:\/\/localhost:3000\x27 is therefore not allowed access. If an opaque response serves your needs, set the request\x27s mode to \x27no-cors\x27 to fetch the resource with CORS disabled.\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs sql\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eFetch API cannot \x3cspan class=\x22hljs-keyword\x22\x3eload\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ehttp\x3c\/span\x3e:\/\/localhost:\x3cspan class=\x22hljs-number\x22\x3e4000\x3c\/span\x3e\/api\/todos. \x3cspan class=\x22hljs-keyword\x22\x3eNo\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Access-Control-Allow-Origin\x27\x3c\/span\x3e header \x3cspan class=\x22hljs-keyword\x22\x3eis\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3epresent\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eon\x3c\/span\x3e the requested resource. Origin \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/localhost:3000\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eis\x3c\/span\x3e therefore \x3cspan class=\x22hljs-keyword\x22\x3enot\x3c\/span\x3e allowed access. \x3cspan class=\x22hljs-keyword\x22\x3eIf\x3c\/span\x3e an \x3cspan class=\x22hljs-keyword\x22\x3eopaque\x3c\/span\x3e response serves your needs, \x3cspan class=\x22hljs-keyword\x22\x3eset\x3c\/span\x3e the request\x3cspan class=\x22hljs-string\x22\x3e\x27s mode to \x27\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3eno\x3c\/span\x3e-cors\x3cspan class=\x22hljs-string\x22\x3e\x27 to fetch the resource with CORS disabled.\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e要知道proxy只有在开发环境中会有副作用，而且类似\/api\/todos 这样的URL在生产环境中是否指向正确取决于我们。你不需要使用\/api前缀。任何没有text／html请求头的未识别的请求将会被代理到配置的服务器。\x3c\/p\x3e\n\x3cp\x3eproxy选项支持HTTP，HTTPS以及WebSocket连接。\x3cbr\x3e如果proxy选项还不够灵活的话，你可以去做自定义：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/github.com\/facebook\/create-react-app\/blob\/master\/packages\/react-scripts\/template\/README.md#configuring-the-proxy-manually\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e自己配置代理\x3c\/a\x3e（未实验）\x3c\/li\x3e\n\x3cli\x3e服务器端开启CORS（亲测，\x3ca href=\x22https:\/\/enable-cors.org\/server_expressjs.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eexpress\x3c\/a\x3e和koa均可实现，koa可以直接使用koa-cors）\x3c\/li\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/github.com\/facebook\/create-react-app\/blob\/master\/packages\/react-scripts\/template\/README.md#adding-custom-environment-variables\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e使用环境变量注入正确的服务器以及端口到应用\x3c\/a\x3e（未实验）\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e工科男的执着：）\x3cbr\x3e为了更好的说明问题，我们来做一次本地实验：\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e启动服务\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npx creat-react-app my-app\ncd my-app\nnpm run start\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stata\x22\x3e\x3ccode\x3enpx creat-react-\x3cspan class=\x22hljs-keyword\x22\x3eapp\x3c\/span\x3e my-\x3cspan class=\x22hljs-keyword\x22\x3eapp\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3ecd\x3c\/span\x3e my-\x3cspan class=\x22hljs-keyword\x22\x3eapp\x3c\/span\x3e\nnpm \x3cspan class=\x22hljs-keyword\x22\x3erun\x3c\/span\x3e start\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e引入axios并发送请求\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm i axios --save\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3enpm \x3cspan class=\x22hljs-selector-tag\x22\x3ei\x3c\/span\x3e axios --save\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22componentDidMount(){\n    axios.get(\x27\/foo\x27)\n        .then(function (response) {\n          console.log(response);\n        })\n        .catch(function (error) {\n          console.log(error);\n        });\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs scilab\x22\x3e\x3ccode\x3ecomponentDidMount(){\n    axios.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/foo\x27\x3c\/span\x3e)\n        .\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(response)\x3c\/span\x3e {\x3c\/span\x3e\n          console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(response);\n        })\n        .\x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(error)\x3c\/span\x3e {\x3c\/span\x3e\n          console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-built_in\x22\x3eerror\x3c\/span\x3e);\n        });\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e请求发送：\x22http:\/\/localhost:3000\/foo\x22\x3cbr\x3e错误信息：404\x3c\/p\x3e\n\x3cp\x3e我们为package.json新增proxy服务器：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;proxy\x26quot;:\x26quot;http:\/\/0.0.0.89:7300\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs 1c\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22proxy\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/0.0.0.89:7300\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ectrl \x2b s 热更新react代码后，没有生效，依旧报404的错误。\x3c\/p\x3e\n\x3cp\x3enpm run start 重启本地服务后，代理服务器生效，返回正常的数据。\x3c\/p\x3e\n\x3cp\x3e实现了自动将\x22http:\/\/localhost:3000\x22 请求转发到\x22http:\/\/0.0.0.89:7300\x22 的服务器。\x3c\/p\x3e\n\x3cp\x3e不知道聪明的你们发现没有，我们并没有遇到CORS问题，因为在浏览器眼里，我们还是将请求发送到\x22http:\/\/localhost:3000\x22 中的，它并不知道creat-react-app已经将请求转发到了\x22http:\/\/0.0.0.89:7300\x22 这个所谓的会触发浏览器CORS安全策略的其他Origin。\x3c\/p\x3e\n\x3cp\x3e天真的浏览器：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVbdNRf?w=700\x26amp;h=418\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbdNRf?w=700\x26amp;h=418\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e请求发送路径：\x3cbr\x3e\x22http:\/\/localhost:3000\x22 →\x22http:\/\/0.0.0.89:7300\/foo\x22\x3c\/p\x3e\n\x3cp\x3e响应返回路径：\x3cbr\x3e\x22http:\/\/0.0.0.89:7300\/foo\x22 →\x22http:\/\/localhost:3000\x22\x3cbr\x3e备注：\x3cbr\x3e1.此处需要重新运行npm run start 重启本地服务，否则在package.json中设置的proxy不会被检测到并生效。\x3cbr\x3e2.此处的服务器可以是公司内网某台虚拟机上的启动的node服务，也可以是easy-mock等mock服务器（仅支持公司内网部署版，大搜车公网线上服务器不支持）。\x3c\/p\x3e\n\x3cp\x3e因此我们得出一个结论：\x3c\/p\x3e\n\x3cblockquote\x3ecreat-react-app脚手架可以结合package.json中的proxy实现请求转发。\x3c\/blockquote\x3e\n\x3cp\x3e实验成功！\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e手动配置proxy\x3c\/h3\x3e\n\x3cblockquote\x3e注意：这个特性可以在react-scripts@1.0.0以及更高版本中使用。\x3c\/blockquote\x3e\n\x3cp\x3e如果proxy的默认配置不够灵活，可以在package.json自定义一个像下面这样形式的对象。\x3cbr\x3e你也可以http-proxy-middleware或者http-proxy去实现。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n    “proxy”:{\n        \x26quot;\/api\x26quot;:{\n            \x26quot;target\x26quot;:\x26quot;\x3curl\x3e\x26quot;,\n            \x26quot;ws\x26quot;:true \n        }\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs clojure\x22\x3e\x3ccode\x3e{\n    “proxy”:{\n        \x3cspan class=\x22hljs-string\x22\x3e\x22\/api\x22\x3c\/span\x3e:{\n            \x3cspan class=\x22hljs-string\x22\x3e\x22target\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22\x26lt;url\x26gt;\x22\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-string\x22\x3e\x22ws\x22\x3c\/span\x3e\x3cspan class=\x22hljs-symbol\x22\x3e:true\x3c\/span\x3e \n        }\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e所有与这个路径相互匹配的请求将被代理转发。这包括了text\/html类型的请求，这种类型是标准proxy选项不支持的。\x3c\/p\x3e\n\x3cp\x3e如果你需要配置多个代理，你需要在定义几个入口。匹配规则还是那样，这样你才能使用正则匹配多个路径。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \/\/ ...\n  \x26quot;proxy\x26quot;: {\n    \/\/ Matches any request starting with \/api\n    \x26quot;\/api\x26quot;: {\n      \x26quot;target\x26quot;: \x26quot;\x3curl_1\x3e\x26quot;,\n      \x26quot;ws\x26quot;: true\n      \/\/ ...\n    },\n    \/\/ Matches any request starting with \/foo\n    \x26quot;\/foo\x26quot;: {\n      \x26quot;target\x26quot;: \x26quot;\x3curl_2\x3e\x26quot;,\n      \x26quot;ssl\x26quot;: true,\n      \x26quot;pathRewrite\x26quot;: {\n        \x26quot;^\/foo\x26quot;: \x26quot;\/foo\/beta\x26quot;\n      }\n      \/\/ ...\n    },\n    \/\/ Matches \/bar\/abc.html but not \/bar\/sub\/def.html\n    \x26quot;\/bar\/[^\/]*[.]html\x26quot;: {\n      \x26quot;target\x26quot;: \x26quot;\x3curl_3\x3e\x26quot;,\n      \/\/ ...\n    },\n    \/\/ Matches \/baz\/abc.html and \/baz\/sub\/def.html\n    \x26quot;\/baz\/.*\/.*[.]html\x26quot;: {\n      \x26quot;target\x26quot;: \x26quot;\x3curl_4\x3e\x26quot;\n      \/\/ ...\n    }\n  }\n  \/\/ ...\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3e\x22proxy\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Matches any request starting with \/api\x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e\x22\/api\x22\x3c\/span\x3e: {\n      \x3cspan class=\x22hljs-string\x22\x3e\x22target\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\x26lt;url_1\x26gt;\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22ws\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Matches any request starting with \/foo\x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e\x22\/foo\x22\x3c\/span\x3e: {\n      \x3cspan class=\x22hljs-string\x22\x3e\x22target\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\x26lt;url_2\x26gt;\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22ssl\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22pathRewrite\x22\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-string\x22\x3e\x22^\/foo\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\/foo\/beta\x22\x3c\/span\x3e\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Matches \/bar\/abc.html but not \/bar\/sub\/def.html\x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e\x22\/bar\/[^\/]*[.]html\x22\x3c\/span\x3e: {\n      \x3cspan class=\x22hljs-string\x22\x3e\x22target\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\x26lt;url_3\x26gt;\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Matches \/baz\/abc.html and \/baz\/sub\/def.html\x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e\x22\/baz\/.*\/.*[.]html\x22\x3c\/span\x3e: {\n      \x3cspan class=\x22hljs-string\x22\x3e\x22target\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\x26lt;url_4\x26gt;\x22\x3c\/span\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n    }\n  }\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e工科男的执着，继续来做一个实验：\x3c\/p\x3e\n\x3cp\x3e依然使用上面的my-app项目，proxy配置如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;proxy\x26quot;:{\n    \x26quot;\/api\x26quot;: {\n      \x26quot;target\x26quot;: \x26quot;http:\/\/0.0.0.89:7300\x26quot;,\n      \x26quot;ws\x26quot;: true\n    },\n    \x26quot;\/foo\x26quot;: {\n      \x26quot;target\x26quot;: \x26quot;http:\/\/0.0.11.22:8848\x26quot;,\n      \x26quot;ws\x26quot;: true,\n      \x26quot;pathRewrite\x26quot;: {\n        \x26quot;^\/foo\x26quot;: \x26quot;\/foo\/beta\x26quot;\n      }\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xquery\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22proxy\x22\x3c\/span\x3e:{\n    \x3cspan class=\x22hljs-string\x22\x3e\x22\/api\x22\x3c\/span\x3e: {\n      \x3cspan class=\x22hljs-string\x22\x3e\x22target\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/0.0.0.89:7300\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22ws\x22\x3c\/span\x3e: true\n    },\n    \x3cspan class=\x22hljs-string\x22\x3e\x22\/foo\x22\x3c\/span\x3e: {\n      \x3cspan class=\x22hljs-string\x22\x3e\x22target\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/0.0.11.22:8848\x22\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22ws\x22\x3c\/span\x3e: true,\n      \x3cspan class=\x22hljs-string\x22\x3e\x22pathRewrite\x22\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-string\x22\x3e\x22^\/foo\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\/foo\/beta\x22\x3c\/span\x3e\n      }\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    axios.get(\x27\/api\x27)\n    .then(function (response) {\n      console.log(response);\n    })\n    .catch(function (error) {\n      console.log(error);\n    });\n    axios.get(\x27\/foo\x27)\n    .then(function (response) {\n      console.log(response);\n    })\n    .catch(function (error) {\n      console.log(error);\n    });\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs scilab\x22\x3e\x3ccode\x3e    axios.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/api\x27\x3c\/span\x3e)\n    .\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(response)\x3c\/span\x3e {\x3c\/span\x3e\n      console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(response);\n    })\n    .\x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(error)\x3c\/span\x3e {\x3c\/span\x3e\n      console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-built_in\x22\x3eerror\x3c\/span\x3e);\n    });\n    axios.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/foo\x27\x3c\/span\x3e)\n    .\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(response)\x3c\/span\x3e {\x3c\/span\x3e\n      console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(response);\n    })\n    .\x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(error)\x3c\/span\x3e {\x3c\/span\x3e\n      console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-built_in\x22\x3eerror\x3c\/span\x3e);\n    });\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e执行结果：\x3cbr\x3eapi接口和之前一致，我们这里主要看重定向的foo接口。\x3c\/p\x3e\n\x3cp\x3e请求发送路径：\x3cbr\x3e\x22http:\/\/localhost:3000\x22 →\x22http:\/\/0.0.11.22:8848\/foo\x22 →\x22http:\/\/0.0.11.22:8848\/foo\/beta\x22\x3c\/p\x3e\n\x3cp\x3e响应返回路径：\x3cbr\x3e\x22http:\/\/0.0.11.22:8848\/foo\/beta\x22 →\x22http:\/\/localhost:3000\x22\x3c\/p\x3e\n\x3cp\x3e可以配置对个代理，我们此处使用的是\x22http:\/\/0.0.0.89:7300\x22 和\x22http:\/\/0.0.11.22:8848\x22 这个两台代理服务器，其中\x3cbr\x3e\x22http:\/\/0.0.0.89:7300\x22 提供了api接口，\x22http:\/\/0.0.11.22:8848\x22 提供了foo接口。而且我们可以在代理服务器上重定向接口。\x3c\/p\x3e\n\x3cp\x3e因此我们得出一个结论：\x3c\/p\x3e\n\x3cblockquote\x3ecreat-react-app脚手架可以结合package.json中的proxy，可以配置对个代理，而且我们可以在代理服务器上重定向接口。\x3c\/blockquote\x3e\n\x3cp\x3e实验成功！\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e环境变量式配置proxy\x3c\/h3\x3e\n\x3cblockquote\x3e这个功能在react-scripts@0.2.3及更高本版中适用。\x3c\/blockquote\x3e\n\x3cp\x3ereact的项目可以使用已经声明好的环境变量，这些变量就像是在你的js文件中定义的本地变量一样。默认情况下，已经有NODE_ENV默认环境变量，以及其他的以REACT_APP_为前缀的环境变量。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e环境变量在构建期间是被嵌入进去的。\x3c\/strong\x3e因为Create React App提供了静态的HTML\/CSS\/JS打包，不能在runtime时被读取到。为了在runtime期间读取到环境变量，你需要还在HTML到服务器的内存，并且在运行时替换占位符，就像这里描述的这样：\x3ca href=\x22https:\/\/github.com\/facebook\/create-react-app\/blob\/master\/packages\/react-scripts\/template\/README.md#injecting-data-from-the-server-into-the-page\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eInjecting Data from the Server into the Page\x3c\/a\x3e。另外你可以在任何你更改他们的时间里重新构建应用。\x3c\/p\x3e\n\x3cblockquote\x3e你需要使用REACT_APP_创建通用的环境变量。除了NODE_ENV之外的任何其他的变量将被忽略，这是为了避免\x3ca href=\x22https:\/\/github.com\/facebook\/create-react-app\/issues\/865#issuecomment-252199527\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eexposing a private key on the machine that could have the same name\x3c\/a\x3e。运行期间，只要你修改了环境变量，就需要重启开发服务器。\x3c\/blockquote\x3e\n\x3cp\x3e这些环境变量将被定义在process.env。例如，有一个名叫REACT_APP_SECRET_CODE的环境变量，它可以通过process.env.REACT_APP_SECRET_CODE暴露在我们的javascript文件中。\x3c\/p\x3e\n\x3cp\x3e我们这里同样也有一个内建的叫做NODE_ENV的环境变量。你可以通过process.env.NODE_ENV去读取它。当你运行npm start时，NODE_ENV的值是development，当你运行npm test时，NODE_ENV的值是test，而且当你运行npm run build构建生产环境的包的时候，它通常是production。\x3cstrong\x3e你不能的手动覆盖NODE_ENV。\x3c\/strong\x3e这样可以预防开发者错把开发环境的代码部署到生产环境。\x3c\/p\x3e\n\x3cp\x3e这些环境变量可以用于根据项目的部署位置或使用超出版本控制的敏感数据来有条件地显示信息。\x3c\/p\x3e\n\x3cp\x3e首先，你需要一个已经定义的环境变量。例如，你想在form表单中控制一个secret变量。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22render(){\n    return (\n        \x3cdiv\x3e\n            \x3csmall\x3e你的应用运行在\x3cb\x3e{process.env.NODE_ENV}\x3c\/b\x3e模式。\x3c\/small\x3e\n            \x3cform\x3e\n               \x3cinput type=\x26quot;hidden\x26quot; defaultValue={process.env.REACT_APP_SECRET_CODE} \/\x3e\n            \x3c\/form\x3e\n        \x3c\/div\x3e\n    );\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3erender(){\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n        \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3esmall\x3c\/span\x3e\x26gt;\x3c\/span\x3e你的应用运行在\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eb\x3c\/span\x3e\x26gt;\x3c\/span\x3e{process.env.NODE_ENV}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eb\x3c\/span\x3e\x26gt;\x3c\/span\x3e模式。\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3esmall\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eform\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n               \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22hidden\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edefaultValue\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{process.env.REACT_APP_SECRET_CODE}\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eform\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    );\n}\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在构建期间，process.env.REACT_APP_SECRET_CODE将会被环境变量中的当前值替代。谨记NODE_ENV是自动设置的变量。\x3c\/p\x3e\n\x3cp\x3e当你在浏览器查看input时，它已经被设置成了abcde（或者是空）。\x3cbr\x3e上面的表单从环境变量中搜索一个名叫REACT_APP_SECRET_CODE的变量。为了使用这个值，我们需要将其定义在环境中。使用两种方式可以做到，一种是在shell中定义，一种是.env文件中。\x3c\/p\x3e\n\x3cp\x3e可以通过NODE_ENV去对一些操作进行控制：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if(process.env.NODE_ENV !== \x27production\x27){\n   analytics.disable();\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs mel\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(process.\x3cspan class=\x22hljs-keyword\x22\x3eenv\x3c\/span\x3e.NODE_ENV !== \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e){\n   analytics.\x3cspan class=\x22hljs-keyword\x22\x3edisable\x3c\/span\x3e();\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当你使用npm run build编译app时，将会使文件变得更小。\x3c\/p\x3e\n\x3cp\x3e在HTML中引用环境变量：\x3c\/p\x3e\n\x3cblockquote\x3e注意：这个特性在react-scripts@0.9.0以及更高版本中使用。\x3c\/blockquote\x3e\n\x3cp\x3e你可以在public\/index.html中获取到以REACT_APP_为前缀的环境变量。例如：\x3cbr\x3e\x26lt;title\x26gt;%REACT_APP_WEBSITE_NAME%\x26lt;\/title\x26gt;\x3c\/p\x3e\n\x3cp\x3e注意事项：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e除了内建变量(NODE_ENV和PUBLIC_URL)，变量名必须以REACT_APP_开头才能正常工作。\x3c\/li\x3e\n\x3cli\x3e构建期间环境变量可以被注入进去。如果你想在运行期间注入它们，采用这个方法：\x3ca href=\x22https:\/\/github.com\/facebook\/create-react-app\/blob\/master\/packages\/react-scripts\/template\/README.md#generating-dynamic-meta-tags-on-the-server\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGenerating Dynamic \x26lt;meta\x26gt; Tags on the Server\x3c\/a\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e在shell中添加临时的环境变量\x3cbr\x3e对于不同的操作系统，环境变量的设置是不同的。但是更加需要注意的是，这是创建变量的方式仅仅是当前shell session窗口有效。\x3c\/p\x3e\n\x3cp\x3eLinux和macOS(Bash)\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22REACT_APP_SECRECT_CODE=abcdef npm start\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ini\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-attr\x22\x3eREACT_APP_SECRECT_CODE\x3c\/span\x3e=abcdef npm start\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e还有一种创建.env文件定义环境变量的方式。\x3c\/p\x3e\n\x3cp\x3e.env文件将被检如源代码控制。\x3c\/p\x3e\n\x3cp\x3e其他.env文件将怎么使用？\x3c\/p\x3e\n\x3cblockquote\x3e这个特性仅在react-scripts@1.0.0及更高中使用\x3cbr\x3e使用dotenv可以将.env中的值注入到process.env中。例如：\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22require(\x27dotenv\x27).config()\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3erequire\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27dotenv\x27\x3c\/span\x3e)\x3c\/span\x3e\x3c\/span\x3e.config()\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e在项目的根目录定义一个.env文件并键入如下内容\x3c\/strong\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22DB_HOST=localhost\nDB_USER=root\nDB_PASS=s1mpl3\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ini\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attr\x22\x3eDB_HOST\x3c\/span\x3e=localhost\n\x3cspan class=\x22hljs-attr\x22\x3eDB_USER\x3c\/span\x3e=root\n\x3cspan class=\x22hljs-attr\x22\x3eDB_PASS\x3c\/span\x3e=s1mpl3\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后就可以在process.env中访问到了：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const db = require(\x27db\x27)\ndb.connect({\n  host: process.env.DB_HOST,\n  username: process.env.DB_USER,\n  password: process.env.DB_PASS\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3econst db = require(\x3cspan class=\x22hljs-string\x22\x3e\x27db\x27\x3c\/span\x3e)\ndb.connect({\n  host: process\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.DB_HOST\x3c\/span\x3e,\n  username: process\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.DB_USER\x3c\/span\x3e,\n  password: process\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.DB_PASS\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22.env: Default.\n.env.local: Local overrides. 加载除了test之外的环境变量。\n.env.development, .env.test, .env.production: 公用的环境变量。\n.env.development.local, .env.test.local, .env.production.local:本地的环境变量。\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e: Default.\n\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.local\x3c\/span\x3e: Local overrides. 加载除了test之外的环境变量。\n\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.development\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.test\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.production\x3c\/span\x3e: 公用的环境变量。\n\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.development\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.local\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.test\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.local\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.production\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.local\x3c\/span\x3e:本地的环境变量。\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e左边的比右边的优先级高：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm start: .env.development.local, .env.development, .env.local, .env\nnpm run build: .env.production.local, .env.production, .env.local, .env\nnpm test: .env.test.local, .env.test, .env (note .env.local is missing)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3enpm start: \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.development\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.local\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.development\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.local\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\nnpm run build: \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.production\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.local\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.production\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.local\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\nnpm test: \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.test\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.local\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.test\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e (note \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.local\x3c\/span\x3e is missing)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如何将系统环境变量扩展到我们项目下的.env文件使用：\x3c\/p\x3e\n\x3cp\x3e使用dotenv-expand\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22REACT_APP_VERSION=$npm_package_version\n# also works:\n# REACT_APP_VERSION=${npm_package_version}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ini\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attr\x22\x3eREACT_APP_VERSION\x3c\/span\x3e=\x3cspan class=\x22hljs-variable\x22\x3e$npm_package_version\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e# also works:\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e# REACT_APP_VERSION=${npm_package_version}\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在.env文件内部也可以使用变量：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22DOMAIN=www.example.com\nREACT_APP_FOO=$DOMAIN\/foo\nREACT_APP_BAR=$DOMAIN\/bar\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ini\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attr\x22\x3eDOMAIN\x3c\/span\x3e=www.example.com\n\x3cspan class=\x22hljs-attr\x22\x3eREACT_APP_FOO\x3c\/span\x3e=\x3cspan class=\x22hljs-variable\x22\x3e$DOMAIN\x3c\/span\x3e\/foo\n\x3cspan class=\x22hljs-attr\x22\x3eREACT_APP_BAR\x3c\/span\x3e=\x3cspan class=\x22hljs-variable\x22\x3e$DOMAIN\x3c\/span\x3e\/bar\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e工科男的执着：）\x3cbr\x3e简单做个实验：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22touch .env\ncode .env\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3etouch \x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\n\x3cspan class=\x22hljs-selector-tag\x22\x3ecode\x3c\/span\x3e .env\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e键入：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22DB_HOST=localhost\nDB_USER=root\nDB_PASS=s1mpl3\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ini\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attr\x22\x3eDB_HOST\x3c\/span\x3e=localhost\n\x3cspan class=\x22hljs-attr\x22\x3eDB_USER\x3c\/span\x3e=root\n\x3cspan class=\x22hljs-attr\x22\x3eDB_PASS\x3c\/span\x3e=s1mpl3\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22console.log(\x26quot;process.env.DB_HOST--\x3e%s,process.env.DB_USER--\x3e%s,process.env.DB_PASS--\x3e%s\x26quot;,process.env.DB_HOST,process.env.DB_USER,process.env.DB_PASS)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3econsole\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.log\x3c\/span\x3e(\x22\x3cspan class=\x22hljs-selector-tag\x22\x3eprocess\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.DB_HOST--\x3c\/span\x3e\x26gt;%\x3cspan class=\x22hljs-selector-tag\x22\x3es\x3c\/span\x3e,\x3cspan class=\x22hljs-selector-tag\x22\x3eprocess\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.DB_USER--\x3c\/span\x3e\x26gt;%\x3cspan class=\x22hljs-selector-tag\x22\x3es\x3c\/span\x3e,\x3cspan class=\x22hljs-selector-tag\x22\x3eprocess\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.DB_PASS--\x3c\/span\x3e\x26gt;%\x3cspan class=\x22hljs-selector-tag\x22\x3es\x3c\/span\x3e\x22,\x3cspan class=\x22hljs-selector-tag\x22\x3eprocess\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.DB_HOST\x3c\/span\x3e,\x3cspan class=\x22hljs-selector-tag\x22\x3eprocess\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.DB_USER\x3c\/span\x3e,\x3cspan class=\x22hljs-selector-tag\x22\x3eprocess\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.DB_PASS\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e实验结果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22process.env.DB_HOST--\x3eundefined,process.env.DB_USER--\x3eundefined,process.env.DB_PASS--\x3eundefined\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eprocess\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.DB_HOST--\x3c\/span\x3e\x26gt;undefined,process\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.DB_USER--\x3c\/span\x3e\x26gt;undefined,process\x3cspan class=\x22hljs-selector-class\x22\x3e.env\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.DB_PASS--\x3c\/span\x3e\x26gt;undefined\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e实验结果并不总是令人满意，问题在于不知道在何处require(\x27dotenv\x27).config()，可能需要在node层引入，也可能需要借助webpack之类的工具，使得view层能访问到。\x3c\/p\x3e\n\x3cp\x3e实验失败。\x3cbr\x3e做一下总结：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e开发过程中的Proxy API 请求设置(默认选型，满足大多数情况下需求)\x3c\/li\x3e\n\x3cli\x3e手动配置Proxy （可实现多代理，重定向）\x3c\/li\x3e\n\x3cli\x3e环境变量式配置Proxy (临时变量方式简单易用，.env方式较为复杂，可以使用配置文件代替)\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e努力成为优秀的前端工程师！\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>如何理解package.json中的proxy字段？</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000014891894">https://segmentfault.com/a/1190000014891894</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/imovfeqjt/" target="_blank">https://alili.tech/archive/imovfeqjt/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>