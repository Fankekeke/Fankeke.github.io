<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="页面优化的一些建议"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>页面优化的一些建议 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/jra9nhryt5f/",
				"appid": "1613049289050283", 
				"title": "页面优化的一些建议 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-11-29T09:34:56"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/frt0ejycue/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/s6wuxbip1mn/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fjra9nhryt5f%2f&text=%e9%a1%b5%e9%9d%a2%e4%bc%98%e5%8c%96%e7%9a%84%e4%b8%80%e4%ba%9b%e5%bb%ba%e8%ae%ae"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fjra9nhryt5f%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fjra9nhryt5f%2f&text=%e9%a1%b5%e9%9d%a2%e4%bc%98%e5%8c%96%e7%9a%84%e4%b8%80%e4%ba%9b%e5%bb%ba%e8%ae%ae"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fjra9nhryt5f%2f&title=%e9%a1%b5%e9%9d%a2%e4%bc%98%e5%8c%96%e7%9a%84%e4%b8%80%e4%ba%9b%e5%bb%ba%e8%ae%ae"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fjra9nhryt5f%2f&is_video=false&description=%e9%a1%b5%e9%9d%a2%e4%bc%98%e5%8c%96%e7%9a%84%e4%b8%80%e4%ba%9b%e5%bb%ba%e8%ae%ae"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e9%a1%b5%e9%9d%a2%e4%bc%98%e5%8c%96%e7%9a%84%e4%b8%80%e4%ba%9b%e5%bb%ba%e8%ae%ae&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fjra9nhryt5f%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fjra9nhryt5f%2f&title=%e9%a1%b5%e9%9d%a2%e4%bc%98%e5%8c%96%e7%9a%84%e4%b8%80%e4%ba%9b%e5%bb%ba%e8%ae%ae"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fjra9nhryt5f%2f&title=%e9%a1%b5%e9%9d%a2%e4%bc%98%e5%8c%96%e7%9a%84%e4%b8%80%e4%ba%9b%e5%bb%ba%e8%ae%ae"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fjra9nhryt5f%2f&title=%e9%a1%b5%e9%9d%a2%e4%bc%98%e5%8c%96%e7%9a%84%e4%b8%80%e4%ba%9b%e5%bb%ba%e8%ae%ae"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fjra9nhryt5f%2f&title=%e9%a1%b5%e9%9d%a2%e4%bc%98%e5%8c%96%e7%9a%84%e4%b8%80%e4%ba%9b%e5%bb%ba%e8%ae%ae"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">页面优化的一些建议</h1><div class="meta"><div class="postdate"><time datetime="2018-11-29" itemprop="datePublished">2018-11-29</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e文章本来是给公司内部分享用的，现在发表出来，欢迎大家提出宝贵建议。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e背景目的\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e让官网首页加载速度更快，对用户的操作响应得更及时，给用户提供更为友好的体验。\x3c\/li\x3e\n\x3cli\x3e减少页面请求数，减小请求所占带宽，节省资源。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e优化手段\x3c\/h2\x3e\n\x3cp\x3e按粒度分为两类：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e页面级别优化（HTTP请求数，资源合并压缩，资源加载时机等）\x3c\/li\x3e\n\x3cli\x3e代码级别优化（DOM操作优化、CSS选择符优化、HTML结构优化）\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e具体措施\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e页面级别优化\x3c\/h3\x3e\n\x3cp\x3e页面级别的优化目标基本就是如何减少HTTP请求数，减少请求资源的体积。每个请求都是有成本的，既包含时间成本也包含资源成本（一个完整的请求都需要经过DNS寻址、与服务器建立连接、发送数据、等待服务器响应、接收数据这样一个 “漫长” 而又复杂的过程）\x3c\/p\x3e\n\x3ch4\x3e1. 静态资源的合并和压缩\x3c\/h4\x3e\n\x3cp\x3e根据静态文件的类型，可以借助gulp工具将js文件和css文件进行合并和压缩。\x3cbr\x3e例如官网项目里css文件有七个，js文件有十几二十多个,合并压缩静态资源后可以减少http的开销。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22https:\/\/cdn.liujiefront.com\/images\/web-optimization\/1.png\x22 src=\x22https:\/\/static.alili.techhttps:\/\/cdn.liujiefront.com\/images\/web-optimization\/1.png\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e我们将不经常改变的资源(例如jquery、各种lib库、插件等)全部合并压缩成一个文件，命名为vender.css、vender.js。经常改变上线的文件合并压缩成一个文件，命名为index.css，index.js,并且加上hash戳，index等文件每次上线内容基本都是会改变的，那么gulp自动构建后加上的hash戳也是不一样的，而vender类型不变，这样我们就能合理利用浏览器的缓存机制了。\x3c\/p\x3e\n\x3ch4\x3e2. 图片的处理\x3c\/h4\x3e\n\x3cul\x3e\n\x3cli\x3e使用jq的\x3ccode\x3elazyload\x3c\/code\x3e插件实现图片懒加载。等滚动条滚动到对应的地方再加载所需要的图片资源。\x3c\/li\x3e\n\x3cli\x3e不直接使用设计给的两倍图，用css的\x3ccode\x3edevicePixelRatio\x3c\/code\x3e检查设备的像素比，辅助区分视网膜设备还是非视网膜设备来决定加载两倍图还是原始大小的图片。\x3c\/li\x3e\n\x3cli\x3e图片上传到cdn之前在保证不失真的情况下，用\x3ccode\x3egulp-imagemin\x3c\/code\x3e工具压缩下大小。\x3c\/li\x3e\n\x3cli\x3e将下图这样的小图片全部做成雪碧图，单色可以考虑用\x3ccode\x3eicon-font\x3c\/code\x3e来实现。或者直接在页面写svg代码和转成base64写到页面也行，总之是要减少http的请求数。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22https:\/\/cdn.liujiefront.com\/images\/web-optimization\/2.png\x22 src=\x22https:\/\/static.alili.techhttps:\/\/cdn.liujiefront.com\/images\/web-optimization\/2.png\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e3. 首屏加载\x3c\/h4\x3e\n\x3cp\x3e将首屏第一时间呈现给用户。\x3cbr\x3e具体的做法是除了首屏dom元素之外,将所有的dom元素用一个\x3ccode\x3etemplate\x3c\/code\x3e元素进行包裹，等window监听到load事件后，将剩余的dom部分全部插到页面中。（tips：为避免用户可能还没等到window的load事件就开始滚动页面，可以将首屏的范围扩大。）\x3c\/p\x3e\n\x3ch4\x3e4. DNS预读取\x3c\/h4\x3e\n\x3cp\x3eDNS预读取是一项使浏览器主动去执行域名解析的功能。DNS请求需要的带宽非常小，但是延迟却有点高。\x3cbr\x3e下面是引用MDN的一句话：\x3c\/p\x3e\n\x3cblockquote\x3e在某些浏览器中这个预读取的行为将会与页面实际内容并行发生（而不是串行）。正因如此，某些高延迟的域名的解析过程才不会卡住资源的加载。\x3cbr\x3e这样可以极大的加速（尤其是移动网络环境下）页面的加载。在某些图片较多的页面中，在发起图片加载请求之前预先把域名解析好将会有至少 5% 的图片加载速度提升。\x3c\/blockquote\x3e\n\x3cp\x3e具体做法：\x3cbr\x3e\x3ccode\x3ehead\x3c\/code\x3e标签里加上\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3clink rel=\x26quot;dns-prefetch\x26quot; href=\x26quot;https:\/\/data.dadaabc.com\/\x26quot;\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elink\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3erel\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22dns-prefetch\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ehref\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/data.dadaabc.com\/\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3edata.dadaabc.com\x3c\/code\x3e为静态资源的域名，如还有其他链接的域名，都一起加进去。\x3c\/p\x3e\n\x3ch4\x3e5. 多域名分发静态资源\x3c\/h4\x3e\n\x3cp\x3e同域下浏览器能并发的请求有限，为了增加并发，尤其是一些静态资源上，可以使用多个域名。但由于域名DNS解析本身也是耗时的，所以也不是越多越好，chrome最大支持6路并发，所以一般设置2-4个域名较为合适。\x3cbr\x3e具体的做法是：再增加cdn域名来下载静态资源。比如图片全部用\x3ccode\x3eimg.dadaabc.com\/\x3c\/code\x3e域名,css资源全部用\x3ccode\x3ecss.dadaabc.com\/\x3c\/code\x3e域名，这些域名最终全部指向同样的cdn服务器。静态资源域名加前缀可以用\x3ccode\x3egulp-rev-replace\x3c\/code\x3e来实现。\x3c\/p\x3e\n\x3ch4\x3e6. 统计代码\x3c\/h4\x3e\n\x3cp\x3e统计代码全部放到window的load事件之后执行。为了便于管理统计代码，例如页面加上一些埋点，增加删除统计产品，我们可以借助\x3ccode\x3eGoogle Tag Manager\x3c\/code\x3e工具来统一管理。\x3cbr\x3e具体做法是：页面只拉取\x3ccode\x3eGoogle Tag Manager\x3c\/code\x3e提供的\x3ccode\x3egtm\x3c\/code\x3e代码，该js代码含有全部的统计产品，例如百度、Inspelect等， 这些统计产品也都是通过创建script标签来动态插入到页面中的。另外需要注意的是，google提供的\x3ccode\x3egtm\x3c\/code\x3e代码是在google服务器上的，为了让获取该代码的速度更快，我们可以在自己的服务器上执行\x3ccode\x3ecrontab\x3c\/code\x3e定时任务，每分钟获取一次，然后\x3ccode\x3egtm\x3c\/code\x3e代码直接从自己服务器上获取。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e代码级别优化\x3c\/h3\x3e\n\x3ch4\x3e1. 合理的dom结构\x3c\/h4\x3e\n\x3cp\x3ecss文件全部放到\x3ccode\x3ehead\x3c\/code\x3e里，script文件全部放到\x3ccode\x3ebody\x3c\/code\x3e的最底部。\x3cbr\x3e原因：\x3cbr\x3e把样式表移到\x3ccode\x3ehead\x3c\/code\x3e里允许页面逐步渲染。\x3cbr\x3e浏览器负责渲染的GUI渲染线程与JS引擎线程是互斥的，当JS引擎执行时GUI线程会被挂起（相当于被冻结了），GUI更新会被保存在一个队列中等到JS引擎空闲时立即被执行。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22https:\/\/cdn.liujiefront.com\/images\/web-optimization\/3.png\x22 src=\x22https:\/\/static.alili.techhttps:\/\/cdn.liujiefront.com\/images\/web-optimization\/3.png\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e参考资料：\x3ca href=\x22https:\/\/mp.weixin.qq.com\/s\/GFUivceIlbjVDfcJibnVOg\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e从浏览器多进程到JS单线程，JS运行机制最全面的一次梳理\x3c\/a\x3e\x3c\/p\x3e\n\x3ch4\x3e2. 最小化重排和重绘\x3c\/h4\x3e\n\x3ch5\x3e多个属性改变一次性写：\x3c\/h5\x3e\n\x3cp\x3e举个例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var ele = document.getElementById(\x27myDiv\x27);\nele.style.borderLeft = \x271px\x27;\nele.style.borderRight = \x272px\x27;\nele.style.padding = \x275px\x27;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dart\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ele = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27myDiv\x27\x3c\/span\x3e);\nele.style.borderLeft = \x3cspan class=\x22hljs-string\x22\x3e\x271px\x27\x3c\/span\x3e;\nele.style.borderRight = \x3cspan class=\x22hljs-string\x22\x3e\x272px\x27\x3c\/span\x3e;\nele.style.padding = \x3cspan class=\x22hljs-string\x22\x3e\x275px\x27\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e三个样式属性被改变，每一个都会影响元素的几何结构，虽然大部分现代浏览器都做了优化，只会引起一次重排，但是像上文一样，如果一个及时的属性被请求，那么就会强制刷新队列，而且这段代码四次访问DOM，一个很显然的优化策略就是把它们的操作合成一次，这样只会修改DOM一次：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var ele = document.getElementById(\x27myDiv\x27);\nele.style.cssText = \x27border-left: 1px; border-right: 2px; padding: 5px;\x27;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dart\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ele = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27myDiv\x27\x3c\/span\x3e);\nele.style.cssText = \x3cspan class=\x22hljs-string\x22\x3e\x27border-left: 1px; border-right: 2px; padding: 5px;\x27\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e总结：同一个DOM的多个属性改变可以写在一起（减少DOM访问，同时把强制渲染队列刷新的风险降为0）\x3c\/p\x3e\n\x3ch5\x3efragment元素的应用：\x3c\/h5\x3e\n\x3cp\x3efragment是个轻量级的document对象，它的设计初衷就是为了完成更新和移动节点这样的任务。fragment的一个便利的语法特性是当你附加一个片断到节点时，实际上被添加的是该片断的子节点，而不是片断本身。只触发了一次重排，而且只访问了一次实时的DOM。\x3cbr\x3e例如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var fragment = document.createDocumentFragment();\n\nvar li = document.createElement(\x27li\x27);\nli.innerHTML = \x27apple\x27;\nfragment.appendChild(li);\n\nvar li = document.createElement(\x27li\x27);\nli.innerHTML = \x27watermelon\x27;\nfragment.appendChild(li);\n\ndocument.getElementById(\x27fruit\x27).appendChild(fragment);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e fragment = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createDocumentFragment();\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e li = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27li\x27\x3c\/span\x3e);\nli.innerHTML = \x3cspan class=\x22hljs-string\x22\x3e\x27apple\x27\x3c\/span\x3e;\nfragment.appendChild(li);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e li = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27li\x27\x3c\/span\x3e);\nli.innerHTML = \x3cspan class=\x22hljs-string\x22\x3e\x27watermelon\x27\x3c\/span\x3e;\nfragment.appendChild(li);\n\n\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27fruit\x27\x3c\/span\x3e).appendChild(fragment);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e3. 函数防抖和函数节流\x3c\/h4\x3e\n\x3cp\x3e触发大量回调函数的事件，例如拖拽时的\x3ccode\x3emousemove\x3c\/code\x3e事件，window对象的\x3ccode\x3eresize\x3c\/code\x3e、\x3ccode\x3escroll\x3c\/code\x3e事件，文字输入、自动完成的\x3ccode\x3ekeyup\x3c\/code\x3e事件等，需要合理使用函数防抖和函数节流机制。具体可以参考我的另外一篇文章\x3ca href=\x22https:\/\/blog.liujiefront.com\/2018\/04\/27\/throttle-debounce\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e函数防抖和函数节流\x3c\/a\x3e\x3c\/p\x3e\n\x3ch4\x3e4. CSS选择器\x3c\/h4\x3e\n\x3cp\x3eCSS选择器的解析式其实是\x3cstrong\x3e从右到左\x3c\/strong\x3e的，例如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22#div1 a {\n    color: red\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22css hljs\x22\x3e\x3ccode class=\x22css\x22\x3e\x3cspan class=\x22hljs-selector-id\x22\x3e#div1\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3ea\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attribute\x22\x3ecolor\x3c\/span\x3e: red\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如上面的选择器，浏览器必须遍历查找所有的a元素，再去找ID为div1的元素，这样查找的方式显然很低效。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/blog.liujiefront.com\/2018\/05\/19\/web-optimization\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eblog链接\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e参考资料：\x3cbr\x3e\x3ca href=\x22https:\/\/www.zhihu.com\/question\/21658448\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eWeb前端应该从哪些方面来优化网站?\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/zichi\/p\/4720000.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e重排和重绘\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>页面优化的一些建议</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000014976119">https://segmentfault.com/a/1190000014976119</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/jra9nhryt5f/" target="_blank">https://alili.tech/archive/jra9nhryt5f/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>