<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Create React App：不使用eject，自定义webpack配置"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Create React App：不使用eject，自定义webpack配置 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/k50t8pklkdn/",
				"appid": "1613049289050283", 
				"title": "Create React App：不使用eject，自定义webpack配置 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-27T02:30:13"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/peoedtbjnqk/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/58bwq1dxt4w/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fk50t8pklkdn%2f&text=Create%20React%20App%ef%bc%9a%e4%b8%8d%e4%bd%bf%e7%94%a8eject%ef%bc%8c%e8%87%aa%e5%ae%9a%e4%b9%89webpack%e9%85%8d%e7%bd%ae"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fk50t8pklkdn%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fk50t8pklkdn%2f&text=Create%20React%20App%ef%bc%9a%e4%b8%8d%e4%bd%bf%e7%94%a8eject%ef%bc%8c%e8%87%aa%e5%ae%9a%e4%b9%89webpack%e9%85%8d%e7%bd%ae"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fk50t8pklkdn%2f&title=Create%20React%20App%ef%bc%9a%e4%b8%8d%e4%bd%bf%e7%94%a8eject%ef%bc%8c%e8%87%aa%e5%ae%9a%e4%b9%89webpack%e9%85%8d%e7%bd%ae"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fk50t8pklkdn%2f&is_video=false&description=Create%20React%20App%ef%bc%9a%e4%b8%8d%e4%bd%bf%e7%94%a8eject%ef%bc%8c%e8%87%aa%e5%ae%9a%e4%b9%89webpack%e9%85%8d%e7%bd%ae"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Create%20React%20App%ef%bc%9a%e4%b8%8d%e4%bd%bf%e7%94%a8eject%ef%bc%8c%e8%87%aa%e5%ae%9a%e4%b9%89webpack%e9%85%8d%e7%bd%ae&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fk50t8pklkdn%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fk50t8pklkdn%2f&title=Create%20React%20App%ef%bc%9a%e4%b8%8d%e4%bd%bf%e7%94%a8eject%ef%bc%8c%e8%87%aa%e5%ae%9a%e4%b9%89webpack%e9%85%8d%e7%bd%ae"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fk50t8pklkdn%2f&title=Create%20React%20App%ef%bc%9a%e4%b8%8d%e4%bd%bf%e7%94%a8eject%ef%bc%8c%e8%87%aa%e5%ae%9a%e4%b9%89webpack%e9%85%8d%e7%bd%ae"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fk50t8pklkdn%2f&title=Create%20React%20App%ef%bc%9a%e4%b8%8d%e4%bd%bf%e7%94%a8eject%ef%bc%8c%e8%87%aa%e5%ae%9a%e4%b9%89webpack%e9%85%8d%e7%bd%ae"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fk50t8pklkdn%2f&title=Create%20React%20App%ef%bc%9a%e4%b8%8d%e4%bd%bf%e7%94%a8eject%ef%bc%8c%e8%87%aa%e5%ae%9a%e4%b9%89webpack%e9%85%8d%e7%bd%ae"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Create React App：不使用eject，自定义webpack配置</h1><div class="meta"><div class="postdate"><time datetime="2018-12-27" itemprop="datePublished">2018-12-27</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3e前言：译者一直使用react，但是前段时间因为facebook的协议问题，公司开始禁止使用react来开发前端项目。（更新到react16的MIT协议也不行）于是，笔者决定将react替换为preact，这样就需要在webpack配置中设置alias，但是又不希望使用create-react-app中不可逆的eject。于是找到了这篇教程，简单翻译后结合自己的需要进行了修改。分享给有需要的人。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3eCreate React App提供了一套非常不错的配置，能够上手即用，并且提供了“eject”功能，让你能够自己接管所有的配置项。\x3c\/p\x3e\n\x3cp\x3e但是，如果当你仅仅是想微调一下Webpack的配置呢？而并不是接管所有的配置项。你可能想要增加SASS或者SCSS的支持，或者使用自己定义的.eslintrc文件。（译者的使用场景是在webpack中增加alias）\x3c\/p\x3e\n\x3cp\x3e让我们开始讲解如何操作。\x3c\/p\x3e\n\x3cp\x3e警告！\x3cbr\x3e首先你要注意: 如果你并不了解Webpack的运行机制，或是不喜欢在工程里加入的hacky代码（少量的），我建议你不要使用这种方式，这是一种高级的技巧。\x3c\/p\x3e\n\x3cp\x3e当Create React App变化时，特别是它使用的react-scripts包变化时，\x3cstrong\x3e很有可能\x3c\/strong\x3e导致我们的代码需要一些修复。如果官方修改了webpack的结构，或者导出方式，我们的代码将出现问题，这时就需要你自己去了解如何修复它们。所以，再强调一次，如果你觉得这种方式有问题，请不要这么做！（译者觉得原作者有点夸张了）\x3c\/p\x3e\n\x3cp\x3e破解Create React App\x3cbr\x3e好了，有了这个可怕的免责声明，让我们来看看如何破解Create React App，如果你想直接去看\x3ca href=\x22https:\/\/daveceddia.com\/customize-create-react-app-webpack-without-ejecting\/#example-project\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e示例项目\x3c\/a\x3e的代码，也是可以的。在开始之前，确保使用的是最新的react-scripts，作者在编写的时候是1.0.11。（译者使用的是1.4.1）\x3c\/p\x3e\n\x3cp\x3eCreate React App的基础被封装在“react-scripts”包中，可以在package.json中的“dependencies”的列表里了解到。\x3c\/p\x3e\n\x3cp\x3e我们将使用rewire来创建猴子补丁（运行时动态替换），使得我们在执行之前对Webpack配置进行定制。\x3c\/p\x3e\n\x3cp\x3e下面这个文件是这个项目中最重要的部分。我建议在您的CRA项目中建立一个名为“scripts”的目录，并将这些代码放入scripts\/customized-config.js文件中。你可以任意命名，不过(稍后我们将用到这个文件名)。\x3c\/p\x3e\n\x3cp\x3escripts\/customized-config.js\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/*\n  本模块运行react-scripts里的脚本 (Create React App)\n  可以自定义webpack配置，通过在项目根目录创建\x26quot;config-overrides.dev.js\x26quot; 、 \x26quot;config-overrides.prod.js\x26quot; 文件.\n\n  A config-overrides file should export a single function that takes a\n  config and modifies it as necessary.\n\n  module.exports = function(webpackConfig) {\n    webpackConfig.module.rules[0].use[0].options.useEslintrc = true;\n  };\n*\/\nvar rewire = require(\x27rewire\x27);\nvar proxyquire = require(\x27proxyquire\x27);\n\nswitch(process.argv[2]) {\n  \/\/ The \x26quot;start\x26quot; script is run during development mode\n  case \x27start\x27:\n    rewireModule(\x27react-scripts\/scripts\/start.js\x27, loadCustomizer(\x27..\/config-overrides.dev\x27));\n    break;\n  \/\/ The \x26quot;build\x26quot; script is run to produce a production bundle\n  case \x27build\x27:\n    rewireModule(\x27react-scripts\/scripts\/build.js\x27, loadCustomizer(\x27..\/config-overrides.prod\x27));\n    break;\n  \/\/ The \x26quot;test\x26quot; script runs all the tests with Jest\n  case \x27test\x27:\n    \/\/ Load customizations from the config-overrides.testing file.\n    \/\/ That file should export a single function that takes a config and returns a config\n    let customizer = loadCustomizer(\x27..\/config-overrides.testing\x27);\n    proxyquire(\x27react-scripts\/scripts\/test.js\x27, {\n      \/\/ When test.js asks for \x27..\/utils\/createJestConfig\x27 it will get this instead:\n      \x27..\/utils\/createJestConfig\x27: (...args) =\x3e {\n        \/\/ Use the existing createJestConfig function to create a config, then pass\n        \/\/ it through the customizer\n        var createJestConfig = require(\x27react-scripts\/utils\/createJestConfig\x27);\n        return customizer(createJestConfig(...args));\n      }\n    });\n    break;\n  default:\n    console.log(\x27customized-config only supports \x26quot;start\x26quot;, \x26quot;build\x26quot;, and \x26quot;test\x26quot; options.\x27);\n    process.exit(-1);\n}\n\n\/\/ Attempt to load the given module and return null if it fails.\nfunction loadCustomizer(module) {\n  try {\n    return require(module);\n  } catch(e) {\n    if(e.code !== \x26quot;MODULE_NOT_FOUND\x26quot;) {\n      throw e;\n    }\n  }\n\n  \/\/ If the module doesn\x27t exist, return a\n  \/\/ noop that simply returns the config it\x27s given.\n  return config =\x3e config;\n}\n\nfunction rewireModule(modulePath, customizer) {\n  \/\/ Load the module with `rewire`, which allows modifying the\n  \/\/ script\x27s internal variables.\n  let defaults = rewire(modulePath);\n\n  \/\/ Reach into the module, grab its global \x27config\x27 variable,\n  \/\/ and pass it through the customizer function.\n  \/\/ The customizer should *mutate* the config object, because\n  \/\/ react-scripts imports the config as a `const` and we can\x27t\n  \/\/ modify that reference.\n  let config = defaults.__get__(\x27config\x27);\n  customizer(config);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/*\n  本模块运行react-scripts里的脚本 (Create React App)\n  可以自定义webpack配置，通过在项目根目录创建\x22config-overrides.dev.js\x22 、 \x22config-overrides.prod.js\x22 文件.\n\n  A config-overrides file should export a single function that takes a\n  config and modifies it as necessary.\n\n  module.exports = function(webpackConfig) {\n    webpackConfig.module.rules[0].use[0].options.useEslintrc = true;\n  };\n*\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e rewire = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27rewire\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e proxyquire = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27proxyquire\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e(process.argv[\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e]) {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ The \x22start\x22 script is run during development mode\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27start\x27\x3c\/span\x3e:\n    rewireModule(\x3cspan class=\x22hljs-string\x22\x3e\x27react-scripts\/scripts\/start.js\x27\x3c\/span\x3e, loadCustomizer(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/config-overrides.dev\x27\x3c\/span\x3e));\n    \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ The \x22build\x22 script is run to produce a production bundle\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27build\x27\x3c\/span\x3e:\n    rewireModule(\x3cspan class=\x22hljs-string\x22\x3e\x27react-scripts\/scripts\/build.js\x27\x3c\/span\x3e, loadCustomizer(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/config-overrides.prod\x27\x3c\/span\x3e));\n    \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ The \x22test\x22 script runs all the tests with Jest\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27test\x27\x3c\/span\x3e:\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Load customizations from the config-overrides.testing file.\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ That file should export a single function that takes a config and returns a config\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e customizer = loadCustomizer(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/config-overrides.testing\x27\x3c\/span\x3e);\n    proxyquire(\x3cspan class=\x22hljs-string\x22\x3e\x27react-scripts\/scripts\/test.js\x27\x3c\/span\x3e, {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ When test.js asks for \x27..\/utils\/createJestConfig\x27 it will get this instead:\x3c\/span\x3e\n      \x3cspan class=\x22hljs-string\x22\x3e\x27..\/utils\/createJestConfig\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e...args\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Use the existing createJestConfig function to create a config, then pass\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ it through the customizer\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e createJestConfig = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27react-scripts\/utils\/createJestConfig\x27\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e customizer(createJestConfig(...args));\n      }\n    });\n    \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e:\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27customized-config only supports \x22start\x22, \x22build\x22, and \x22test\x22 options.\x27\x3c\/span\x3e);\n    process.exit(\x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e);\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Attempt to load the given module and return null if it fails.\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eloadCustomizer\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3emodule\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e);\n  } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(e.code !== \x3cspan class=\x22hljs-string\x22\x3e\x22MODULE_NOT_FOUND\x22\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e e;\n    }\n  }\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ If the module doesn\x27t exist, return a\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ noop that simply returns the config it\x27s given.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3econfig\x3c\/span\x3e =\x26gt;\x3c\/span\x3e config;\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erewireModule\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3emodulePath, customizer\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Load the module with `rewire`, which allows modifying the\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ script\x27s internal variables.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e defaults = rewire(modulePath);\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Reach into the module, grab its global \x27config\x27 variable,\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ and pass it through the customizer function.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ The customizer should *mutate* the config object, because\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ react-scripts imports the config as a `const` and we can\x27t\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ modify that reference.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e config = defaults.__get__(\x3cspan class=\x22hljs-string\x22\x3e\x27config\x27\x3c\/span\x3e);\n  customizer(config);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e为了跑通代码，你需要安装一些额外的依赖包:\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3enpm install --save rewire proxyquire\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e你可以通过注释来了解它是如何工作的。最有趣的部分是位于底部的rewireModule方法，它使用rewire库来查看另一个文件，并获取定义在那里的配置变量的引用。\x3c\/p\x3e\n\x3cp\x3e一旦你完成了这个操作，就可以为开发，生产，测试环境编写用来覆盖的配置文件。这一部分完全取决于你——无论你对CRA的Webpack配置做了什么改动，你都可以直接去做。\x3c\/p\x3e\n\x3cp\x3e这些文件应该直接在CRA文件夹的根目录下，所有3个文件都是可选的。如果您想要重新配置它们的位置，只需改变上面“loadCustomizer”调用的路径。只是不要把它们放在“src”中就可以。\x3c\/p\x3e\n\x3cp\x3e下面是一些开发环境替换配置的例子:\x3c\/p\x3e\n\x3cp\x3econfig-overrides.dev.js\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const path = require(\x27path\x27);\n\nmodule.exports = function(config) {\n  \/\/ 使用你自己的 ESLint \n  let eslintLoader = config.module.rules[0];\n  eslintLoader.use[0].options.useEslintrc = true;\n\n  \/\/ Add the SASS loader second-to-last\n  \/\/ (last one must remain as the \x26quot;file-loader\x26quot;)\n  let loaderList = config.module.rules[1].oneOf;\n  loaderList.splice(loaderList.length - 1, 0, {\n    test: \/\\.scss$\/,\n    use: [\x26quot;style-loader\x26quot;, \x26quot;css-loader\x26quot;, \x26quot;sass-loader\x26quot;]\n  });\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs openscad\x22\x3e\x3ccode\x3econst path = require(\x27path\x27);\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3eexports\x3c\/span\x3e =\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(config)\x3c\/span\x3e {\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 使用你自己的 ESLint \x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3elet\x3c\/span\x3e eslintLoader = config.\x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e.rules[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n  eslintLoader.\x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].options.useEslintrc = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Add the SASS loader second-to-last\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ (last one must remain as the \x22file-loader\x22)\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3elet\x3c\/span\x3e loaderList = config.\x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e.rules[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e].oneOf;\n  loaderList.splice(loaderList.length - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, {\n    test: \/\\.scss$\/,\n    \x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x22style-loader\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22css-loader\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22sass-loader\x22\x3c\/span\x3e]\n  });\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e还需要创建一个config-overrides.prod.js文件具有相同的内容。开发过程中使用的是dev文件(例如npm start)，在构建期间使用prod文件(例如，npm run build)。\x3c\/p\x3e\n\x3cp\x3e为了让刚刚的配置生效，你需要安装SASS loader, 和它的依赖node-sass:\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3enpm install --save sass-loader node-sass\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e最后，要让这些新代码生效，你需要更改package.json，调用这些新的脚本，而不是默认的react-scripts的脚本。要做到这一点，可以用以下方法替换“start”、“build”和“test”。\x3c\/p\x3e\n\x3cp\x3epackage.json\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;scripts\x26quot;: {\n  \x26quot;start\x26quot;: \x26quot;node scripts\/customized-config start\x26quot;,\n  \x26quot;build\x26quot;: \x26quot;node scripts\/customized-config build\x26quot;,\n  \x26quot;test\x26quot;: \x26quot;node scripts\/customized-config test --env=jsdom\x26quot;,\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xquery\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22scripts\x22\x3c\/span\x3e: {\n  \x3cspan class=\x22hljs-string\x22\x3e\x22start\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22node scripts\/customized-config start\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22build\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22node scripts\/customized-config build\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22test\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22node scripts\/customized-config test --env=jsdom\x22\x3c\/span\x3e,\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e示例项目\x3cbr\x3e一个CRA生成的项目，在github上，点击\x3ca href=\x22https:\/\/github.com\/dceddia\/create-react-app-customized\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这里\x3c\/a\x3e.\x3c\/p\x3e\n\x3cp\x3e译者补充：\x3cbr\x3e1.原文没有讲到默认的配置文件位置，是在\x3ccode\x3enode_modules\\react-scripts\\config\\\x3c\/code\x3e目录下的\x3cbr\x3e\x3ccode\x3ewebpack.config\x3c\/code\x3e开头的文件，例如：\x3ccode\x3ewebpack.config.dev.js\x3c\/code\x3e\x3cbr\x3e2.替换react为preact只需要在\x3ccode\x3econfig-overrides.dev.js\x3c\/code\x3e文件中加入：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  \/*\n  * 替换react为preact\n  * *\/\n  let alias = config.resolve.alias\n  alias[\x26quot;react\x26quot;] = \x26quot;preact-compat\x26quot;\n  alias[\x26quot;react-dom\x26quot;] = \x26quot;preact-compat\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ceylon\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/*\n  * 替换react为preact\n  * *\/\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ealias\x3c\/span\x3e = config.resolve.\x3cspan class=\x22hljs-keyword\x22\x3ealias\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ealias\x3c\/span\x3e[\x3cspan class=\x22hljs-string\x22\x3e\x22react\x22\x3c\/span\x3e] = \x3cspan class=\x22hljs-string\x22\x3e\x22preact-compat\x22\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ealias\x3c\/span\x3e[\x3cspan class=\x22hljs-string\x22\x3e\x22react-dom\x22\x3c\/span\x3e] = \x3cspan class=\x22hljs-string\x22\x3e\x22preact-compat\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e相关资料：\x3cbr\x3epreact替换react：\x3ca href=\x22https:\/\/preactjs.com\/guide\/switching-to-preact\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/preactjs.com\/guide\/sw...\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Create React App：不使用eject，自定义webpack配置</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011752103">https://segmentfault.com/a/1190000011752103</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/k50t8pklkdn/" target="_blank">https://alili.tech/archive/k50t8pklkdn/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>