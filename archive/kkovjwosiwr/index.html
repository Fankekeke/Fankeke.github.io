<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Vue2 源码漫游（一）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Vue2 源码漫游（一） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/kkovjwosiwr/",
				"appid": "1613049289050283", 
				"title": "Vue2 源码漫游（一） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-26T02:30:14"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/bl64pl38epi/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/2ffzitgztce/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fkkovjwosiwr%2f&text=Vue2%20%e6%ba%90%e7%a0%81%e6%bc%ab%e6%b8%b8%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fkkovjwosiwr%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fkkovjwosiwr%2f&text=Vue2%20%e6%ba%90%e7%a0%81%e6%bc%ab%e6%b8%b8%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fkkovjwosiwr%2f&title=Vue2%20%e6%ba%90%e7%a0%81%e6%bc%ab%e6%b8%b8%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fkkovjwosiwr%2f&is_video=false&description=Vue2%20%e6%ba%90%e7%a0%81%e6%bc%ab%e6%b8%b8%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Vue2%20%e6%ba%90%e7%a0%81%e6%bc%ab%e6%b8%b8%ef%bc%88%e4%b8%80%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fkkovjwosiwr%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fkkovjwosiwr%2f&title=Vue2%20%e6%ba%90%e7%a0%81%e6%bc%ab%e6%b8%b8%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkkovjwosiwr%2f&title=Vue2%20%e6%ba%90%e7%a0%81%e6%bc%ab%e6%b8%b8%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkkovjwosiwr%2f&title=Vue2%20%e6%ba%90%e7%a0%81%e6%bc%ab%e6%b8%b8%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkkovjwosiwr%2f&title=Vue2%20%e6%ba%90%e7%a0%81%e6%bc%ab%e6%b8%b8%ef%bc%88%e4%b8%80%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Vue2 源码漫游（一）</h1><div class="meta"><div class="postdate"><time datetime="2018-12-26" itemprop="datePublished">2018-12-26</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3eVue2 源码漫游（一）\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e描述：\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Vue框架中的基本原理可能大家都基本了解了，但是还没有漫游一下源码。\n所以，觉得还是有必要跑一下。\n由于是代码漫游，所以大部分为关键性代码，以主线路和主要分支的代码为主，大部分理解都写在代码注释中。\n\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs\x22\x3e\x3ccode\x3eVue框架中的基本原理可能大家都基本了解了，但是还没有漫游一下源码。\n所以，觉得还是有必要跑一下。\n由于是代码漫游，所以大部分为关键性代码，以主线路和主要分支的代码为主，大部分理解都写在代码注释中。\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3chr\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e一、代码主线\x3c\/h2\x3e\n\x3cp\x3e文件结构1--\x26gt;4，代码执行顺序4--\x26gt;1\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVX3C4?w=293\x26amp;h=623\x22 src=\x22https:\/\/static.alili.tech\/img\/bVX3C4?w=293\x26amp;h=623\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e1.\x3cstrong\x3eplatforms\/web\/entry-runtime.js\/index.js\x3c\/strong\x3e\n\x3c\/h2\x3e\n\x3cp\x3eweb不同平台入口；\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/* @flow *\/\n\nimport Vue from \x27.\/runtime\/index\x27\n\nexport default Vue\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/* @flow *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Vue \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/runtime\/index\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e Vue\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e2.\x3cstrong\x3eruntime\/index.js\x3c\/strong\x3e\n\x3c\/h2\x3e\n\x3cp\x3e为Vue配置一些属性方法\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/* @flow *\/\n\nimport Vue from \x27core\/index\x27\nimport config from \x27core\/config\x27\nimport { extend, noop } from \x27shared\/util\x27\nimport { mountComponent } from \x27core\/instance\/lifecycle\x27\nimport { devtools, inBrowser, isChrome } from \x27core\/util\/index\x27\n\nimport {\n  query,\n  mustUseProp,\n  isReservedTag,\n  isReservedAttr,\n  getTagNamespace,\n  isUnknownElement\n} from \x27web\/util\/index\x27\n\nimport { patch } from \x27.\/patch\x27\nimport platformDirectives from \x27.\/directives\/index\x27\nimport platformComponents from \x27.\/components\/index\x27\n\n\/\/ install platform specific utils\nVue.config.mustUseProp = mustUseProp\nVue.config.isReservedTag = isReservedTag\nVue.config.isReservedAttr = isReservedAttr\nVue.config.getTagNamespace = getTagNamespace\nVue.config.isUnknownElement = isUnknownElement\n\n\/\/ install platform runtime directives \x26amp; components\nextend(Vue.options.directives, platformDirectives)\nextend(Vue.options.components, platformComponents)\n\n\/\/ install platform patch function\nVue.prototype.__patch__ = inBrowser ? patch : noop\n\n\/\/ public mount method\nVue.prototype.$mount = function (\n  el?: string | Element,\n  hydrating?: boolean\n): Component {\n  el = el \x26amp;\x26amp; inBrowser ? query(el) : undefined\n  return mountComponent(this, el, hydrating)\n}\n\n\/\/ devtools global hook\n\/* istanbul ignore next *\/\nVue.nextTick(() =\x3e {\n  if (config.devtools) {\n    if (devtools) {\n      devtools.emit(\x27init\x27, Vue)\n    } else if (process.env.NODE_ENV !== \x27production\x27 \x26amp;\x26amp; isChrome) {\n      console[console.info ? \x27info\x27 : \x27log\x27](\n        \x27Download the Vue Devtools extension for a better development experience:\\n\x27 \x2b\n        \x27https:\/\/github.com\/vuejs\/vue-devtools\x27\n      )\n    }\n  }\n  if (process.env.NODE_ENV !== \x27production\x27 \x26amp;\x26amp;\n    config.productionTip !== false \x26amp;\x26amp;\n    inBrowser \x26amp;\x26amp; typeof console !== \x27undefined\x27\n  ) {\n    console[console.info ? \x27info\x27 : \x27log\x27](\n      `You are running Vue in development mode.\\n` \x2b\n      `Make sure to turn on production mode when deploying for production.\\n` \x2b\n      `See more tips at https:\/\/vuejs.org\/guide\/deployment.html`\n    )\n  }\n}, 0)\n\nexport default Vue\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/* @flow *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Vue \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27core\/index\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e config \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27core\/config\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { extend, noop } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27shared\/util\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { mountComponent } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27core\/instance\/lifecycle\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { devtools, inBrowser, isChrome } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27core\/util\/index\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {\n  query,\n  mustUseProp,\n  isReservedTag,\n  isReservedAttr,\n  getTagNamespace,\n  isUnknownElement\n} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27web\/util\/index\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { patch } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/patch\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e platformDirectives \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/directives\/index\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e platformComponents \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/components\/index\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ install platform specific utils\x3c\/span\x3e\nVue.config.mustUseProp = mustUseProp\nVue.config.isReservedTag = isReservedTag\nVue.config.isReservedAttr = isReservedAttr\nVue.config.getTagNamespace = getTagNamespace\nVue.config.isUnknownElement = isUnknownElement\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ install platform runtime directives \x26amp; components\x3c\/span\x3e\nextend(Vue.options.directives, platformDirectives)\nextend(Vue.options.components, platformComponents)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ install platform patch function\x3c\/span\x3e\nVue.prototype.__patch__ = inBrowser ? patch : noop\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ public mount method\x3c\/span\x3e\nVue.prototype.$mount = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\n  el?: \x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e | Element,\n  hydrating?: \x3cspan class=\x22hljs-built_in\x22\x3eboolean\x3c\/span\x3e\n\x3c\/span\x3e): \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n  el = el \x26amp;\x26amp; inBrowser ? query(el) : \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e mountComponent(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, el, hydrating)\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ devtools global hook\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/* istanbul ignore next *\/\x3c\/span\x3e\nVue.nextTick(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (config.devtools) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (devtools) {\n      devtools.emit(\x3cspan class=\x22hljs-string\x22\x3e\x27init\x27\x3c\/span\x3e, Vue)\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (process.env.NODE_ENV !== \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e \x26amp;\x26amp; isChrome) {\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e[\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.info ? \x3cspan class=\x22hljs-string\x22\x3e\x27info\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27log\x27\x3c\/span\x3e](\n        \x3cspan class=\x22hljs-string\x22\x3e\x27Download the Vue Devtools extension for a better development experience:\\n\x27\x3c\/span\x3e \x2b\n        \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/github.com\/vuejs\/vue-devtools\x27\x3c\/span\x3e\n      )\n    }\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (process.env.NODE_ENV !== \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e \x26amp;\x26amp;\n    config.productionTip !== \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e \x26amp;\x26amp;\n    inBrowser \x26amp;\x26amp; \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e !== \x3cspan class=\x22hljs-string\x22\x3e\x27undefined\x27\x3c\/span\x3e\n  ) {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e[\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.info ? \x3cspan class=\x22hljs-string\x22\x3e\x27info\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27log\x27\x3c\/span\x3e](\n      \x3cspan class=\x22hljs-string\x22\x3e`You are running Vue in development mode.\\n`\x3c\/span\x3e \x2b\n      \x3cspan class=\x22hljs-string\x22\x3e`Make sure to turn on production mode when deploying for production.\\n`\x3c\/span\x3e \x2b\n      \x3cspan class=\x22hljs-string\x22\x3e`See more tips at https:\/\/vuejs.org\/guide\/deployment.html`\x3c\/span\x3e\n    )\n  }\n}, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e Vue\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e3.\x3cstrong\x3ecore\/index.js\x3c\/strong\x3e\n\x3c\/h2\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVXZxt?w=573\x26amp;h=398\x22 src=\x22https:\/\/static.alili.tech\/img\/bVXZxt?w=573\x26amp;h=398\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/* @flow *\/\n\nimport config from \x27..\/config\x27\nimport { initUse } from \x27.\/use\x27\nimport { initMixin } from \x27.\/mixin\x27\nimport { initExtend } from \x27.\/extend\x27\nimport { initAssetRegisters } from \x27.\/assets\x27\nimport { set, del } from \x27..\/observer\/index\x27\nimport { ASSET_TYPES } from \x27shared\/constants\x27\nimport builtInComponents from \x27..\/components\/index\x27\n\nimport {\n  warn,\n  extend,\n  nextTick,\n  mergeOptions,\n  defineReactive\n} from \x27..\/util\/index\x27\n\nexport function initGlobalAPI (Vue: GlobalAPI) {\n  \/\/ 重写config,创建了一个configDef对象，最终目的是为了Object.defineProperty(Vue, \x27config\x27, configDef)\n  const configDef = {}\n  configDef.get = () =\x3e config\n  if (process.env.NODE_ENV !== \x27production\x27) {\n    configDef.set = () =\x3e {\n      warn(\n        \x27Do not replace the Vue.config object, set individual fields instead.\x27\n      )\n    }\n  }\n  Object.defineProperty(Vue, \x27config\x27, configDef)\n  \/\/ 具体Vue.congfig的具体内容就要看..\/config文件了\n\n  \/\/ exposed util methods.\n  \/\/ NOTE: these are not considered part of the public API - avoid relying on them unless you are aware of the risk.\n  \/\/ 添加一些方法，但是该方法并不是公共API的一部分。源码中引入了flow.js\n  Vue.util = {\n    warn, \/\/ 查看\x27..\/util\/debug\x27\n    extend,\/\/查看\x27..\/sharde\/util\x27\n    mergeOptions,\/\/查看\x27..\/util\/options\x27\n    defineReactive\/\/查看\x27..\/observe\/index\x27\n  }\n\n  Vue.set = set \/\/查看\x27..\/observe\/index\x27 \n  Vue.delete = del\/\/查看\x27..\/observe\/index\x27\n  Vue.nextTick = nextTick\/\/查看\x27..\/util\/next-click\x27.在callbacks中注册回调函数\n\n  \/\/ 创建一个纯净的options对象，添加components、directives、filters属性\n  Vue.options = Object.create(null)\n  ASSET_TYPES.forEach(type =\x3e {\n    Vue.options[type \x2b \x27s\x27] = Object.create(null)\n  })\n  \n\n  \/\/ this is used to identify the \x26quot;base\x26quot; constructor to extend all plain-object\n  \/\/ components with in Weex\x27s multi-instance scenarios.\n  Vue.options._base = Vue\n\n  \/\/ ..\/components\/keep-alive.js  拷贝组件对象。该部分最重要的一部分。\n  extend(Vue.options.components, builtInComponents)\n  \/\/ Vue.options = {\n  \/\/   components : {\n  \/\/     KeepAlive : {\n  \/\/       name : \x27keep-alive\x27,\n  \/\/       abstract : true,\n  \/\/       created : function created(){},\n  \/\/       destoryed : function destoryed(){},\n  \/\/       props : {\n  \/\/         exclude : [String, RegExp, Array],\n  \/\/         includen : [String, RegExp, Array],\n  \/\/         max : [String, Number]\n  \/\/       },\n  \/\/       render : function render(){},\n  \/\/       watch : {\n  \/\/         exclude : function exclude(){},\n  \/\/         includen : function includen(){},\n  \/\/       }\n  \/\/     },\n  \/\/     directives : {},\n  \/\/     filters : {},\n  \/\/     _base : Vue\n  \/\/   }\n  \/\/ }\n  \/\/ 添加Vue.use方法，使用插件，内部维护一个插件列表_installedPlugins，如果插件有install方法就执行自己的install方法，否则如果plugin是一个function就执行这个方法，传参(this, args)\n  initUse(Vue)\n  \/\/ .\/mixin.js 添加Vue.mixin方法，this.options = mergeOptions(this.options, mixin)，\n  initMixin(Vue)\n  \/\/ .\/extend.js 添加Vue.cid（每一个够着函数实例都有一个cid，方便缓存），Vue.extend(options)方法\n  initExtend(Vue)\n  \/\/ .\/assets.js 创建收集方法Vue[type] = function (id: string, definition: Function | Object)，其中type ： component \/ directive \/ filter\n  initAssetRegisters(Vue)\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/* @flow *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e config \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/config\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { initUse } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/use\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { initMixin } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/mixin\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { initExtend } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/extend\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { initAssetRegisters } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/assets\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { \x3cspan class=\x22hljs-keyword\x22\x3eset\x3c\/span\x3e, del } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/observer\/index\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { ASSET_TYPES } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27shared\/constants\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e builtInComponents \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/components\/index\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {\n  warn,\n  extend,\n  nextTick,\n  mergeOptions,\n  defineReactive\n} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/util\/index\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3einitGlobalAPI\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eVue: GlobalAPI\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 重写config,创建了一个configDef对象，最终目的是为了Object.defineProperty(Vue, \x27config\x27, configDef)\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e configDef = {}\n  configDef.get = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e config\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (process.env.NODE_ENV !== \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e) {\n    configDef.set = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      warn(\n        \x3cspan class=\x22hljs-string\x22\x3e\x27Do not replace the Vue.config object, set individual fields instead.\x27\x3c\/span\x3e\n      )\n    }\n  }\n  \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.defineProperty(Vue, \x3cspan class=\x22hljs-string\x22\x3e\x27config\x27\x3c\/span\x3e, configDef)\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 具体Vue.congfig的具体内容就要看..\/config文件了\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ exposed util methods.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ \x3cspan class=\x22hljs-doctag\x22\x3eNOTE:\x3c\/span\x3e these are not considered part of the public API - avoid relying on them unless you are aware of the risk.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 添加一些方法，但是该方法并不是公共API的一部分。源码中引入了flow.js\x3c\/span\x3e\n  Vue.util = {\n    warn, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 查看\x27..\/util\/debug\x27\x3c\/span\x3e\n    extend,\x3cspan class=\x22hljs-comment\x22\x3e\/\/查看\x27..\/sharde\/util\x27\x3c\/span\x3e\n    mergeOptions,\x3cspan class=\x22hljs-comment\x22\x3e\/\/查看\x27..\/util\/options\x27\x3c\/span\x3e\n    defineReactive\x3cspan class=\x22hljs-comment\x22\x3e\/\/查看\x27..\/observe\/index\x27\x3c\/span\x3e\n  }\n\n  Vue.set = \x3cspan class=\x22hljs-keyword\x22\x3eset\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/查看\x27..\/observe\/index\x27 \x3c\/span\x3e\n  Vue.delete = del\x3cspan class=\x22hljs-comment\x22\x3e\/\/查看\x27..\/observe\/index\x27\x3c\/span\x3e\n  Vue.nextTick = nextTick\x3cspan class=\x22hljs-comment\x22\x3e\/\/查看\x27..\/util\/next-click\x27.在callbacks中注册回调函数\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建一个纯净的options对象，添加components、directives、filters属性\x3c\/span\x3e\n  Vue.options = \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.create(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e)\n  ASSET_TYPES.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3etype\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    Vue.options[\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27s\x27\x3c\/span\x3e] = \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.create(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e)\n  })\n  \n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ this is used to identify the \x22base\x22 constructor to extend all plain-object\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ components with in Weex\x27s multi-instance scenarios.\x3c\/span\x3e\n  Vue.options._base = Vue\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ..\/components\/keep-alive.js  拷贝组件对象。该部分最重要的一部分。\x3c\/span\x3e\n  extend(Vue.options.components, builtInComponents)\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Vue.options = {\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/   components : {\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/     KeepAlive : {\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/       name : \x27keep-alive\x27,\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/       abstract : true,\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/       created : function created(){},\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/       destoryed : function destoryed(){},\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/       props : {\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/         exclude : [String, RegExp, Array],\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/         includen : [String, RegExp, Array],\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/         max : [String, Number]\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/       },\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/       render : function render(){},\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/       watch : {\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/         exclude : function exclude(){},\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/         includen : function includen(){},\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/       }\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/     },\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/     directives : {},\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/     filters : {},\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/     _base : Vue\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/   }\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ }\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 添加Vue.use方法，使用插件，内部维护一个插件列表_installedPlugins，如果插件有install方法就执行自己的install方法，否则如果plugin是一个function就执行这个方法，传参(this, args)\x3c\/span\x3e\n  initUse(Vue)\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ .\/mixin.js 添加Vue.mixin方法，this.options = mergeOptions(this.options, mixin)，\x3c\/span\x3e\n  initMixin(Vue)\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ .\/extend.js 添加Vue.cid（每一个够着函数实例都有一个cid，方便缓存），Vue.extend(options)方法\x3c\/span\x3e\n  initExtend(Vue)\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ .\/assets.js 创建收集方法Vue[type] = function (id: string, definition: Function | Object)，其中type ： component \/ directive \/ filter\x3c\/span\x3e\n  initAssetRegisters(Vue)\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3eVue.util对象的部分解释：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cli\x3e\x3cul\x3e\x3cli\x3e\x3cp\x3eVue.util.warn \x3cbr\x3ewarn(msg, vm) 警告方法代码在util\/debug.js，\x3cbr\x3e通过var trac = generateComponentTrace(vm)方法vm=vm.$parent递归收集到msg出处。\x3cbr\x3e然后判断是否存在console对象，如果有 console.error(\x3ccode\x3e[Vue warn]: ${msg}${trace}\x3c\/code\x3e)。\x3cbr\x3e如果config.warnHandle存在config.warnHandler.call(null, msg, vm, trace)\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\x3c\/li\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3eVue.util.extend\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    extend (to: Object, _from: ?Object):Object Object类型浅拷贝方法代码在shared\/util.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs vbnet\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e    extend (\x3cspan class=\x22hljs-keyword\x22\x3eto\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e, _from: ?\x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e):\x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e类型浅拷贝方法代码在\x3cspan class=\x22hljs-keyword\x22\x3eshared\x3c\/span\x3e\/util.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3eVue.util.mergeOptions\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22   合并，vue实例化和实现继承的核心方法，代码在shared\/options.js\n    mergeOptions (\n     parent: Object,\n     child: Object,\n     vm?: Component\n   ) \n   先通过normalizeProps、normalizeInject、normalizeDirectives以Object-base标准化，然后依据strats合并策略进行合并。\n   strats是对data、props、watch、methods等实例化参数的合并策略。除此之外还有defaultStrat默认策略。\n   后期暴露的mixin和Vue.extend()就是从这里出来的。[官网解释][1]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs markdown\x22\x3e\x3ccode\x3e   合并，vue实例化和实现继承的核心方法，代码在shared\/options.js\n\x3cspan class=\x22hljs-code\x22\x3e    mergeOptions (\x3c\/span\x3e\n\x3cspan class=\x22hljs-code\x22\x3e     parent: Object,\x3c\/span\x3e\n\x3cspan class=\x22hljs-code\x22\x3e     child: Object,\x3c\/span\x3e\n\x3cspan class=\x22hljs-code\x22\x3e     vm?: Component\x3c\/span\x3e\n   ) \n   先通过normalizeProps、normalizeInject、normalizeDirectives以Object-base标准化，然后依据strats合并策略进行合并。\n   strats是对data、props、watch、methods等实例化参数的合并策略。除此之外还有defaultStrat默认策略。\n   后期暴露的mixin和Vue.extend()就是从这里出来的。[\x3cspan class=\x22hljs-string\x22\x3e官网解释\x3c\/span\x3e][\x3cspan class=\x22hljs-symbol\x22\x3e1\x3c\/span\x3e]\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3eVue.util.defineReactive\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22   大家都知道的数据劫持核心方法，代码在shared\/util.js\n    defineReactive (\n     obj: Object,\n     key: string,\n     val: any,\n     customSetter?: ?Function,\n     shallow?: boolean\n   ) \n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs vbnet\x22\x3e\x3ccode\x3e   大家都知道的数据劫持核心方法，代码在\x3cspan class=\x22hljs-keyword\x22\x3eshared\x3c\/span\x3e\/util.js\n    defineReactive (\n     obj: \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e,\n     \x3cspan class=\x22hljs-keyword\x22\x3ekey\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3estring\x3c\/span\x3e,\n     val: any,\n     customSetter?: ?\x3cspan class=\x22hljs-keyword\x22\x3eFunction\x3c\/span\x3e,\n     shallow?: \x3cspan class=\x22hljs-built_in\x22\x3eboolean\x3c\/span\x3e\n   ) \n\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e4.\x3cstrong\x3einstance\/index.js\x3c\/strong\x3e Vue对象生成文件\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { initMixin } from \x27.\/init\x27\nimport { stateMixin } from \x27.\/state\x27\nimport { renderMixin } from \x27.\/render\x27\nimport { eventsMixin } from \x27.\/events\x27\nimport { lifecycleMixin } from \x27.\/lifecycle\x27\nimport { warn } from \x27..\/util\/index\x27\n\nfunction Vue (options) {\n  \/\/ 判断是否是new调用。\n  if (process.env.NODE_ENV !== \x27production\x27 \x26amp;\x26amp;\n    !(this instanceof Vue)\n  ) {\n    warn(\x27Vue is a constructor and should be called with the `new` keyword\x27)\n  }\n  \/\/ 开始初始化\n  this._init(options)\n}\n\/\/ 添加Vue._init(options)内部方法，.\/init.js\ninitMixin(Vue)\n\/**\n * .\/state.js\n * 添加属性和方法\n * Vue.prototype.$data \n * Vue.prototype.$props\n * Vue.prototype.$watch\n * Vue.prototype.$set\n * Vue.prototype.$delete\n *\/ \nstateMixin(Vue)\n\/**\n * .\/event.js\n * 添加实例事件\n * Vue.prototype.$on\n * Vue.prototype.$once\n * Vue.prototype.$off\n * Vue.prototype.$emit\n *\/ \neventsMixin(Vue)\n\/**\n * .\/lifecycle.js\n * 添加实例生命周期方法\n * Vue.prototype._update\n * Vue.prototype.$forceUpdate\n * Vue.prototype.$destroy\n *\/ \nlifecycleMixin(Vue)\n\/**\n * .\/render.js\n * 添加实例渲染方法\n * 通过执行installRenderHelpers(Vue.prototype);为实例添加很多helper\n * Vue.prototype.$nextTick\n * Vue.prototype._render\n *\/ \nrenderMixin(Vue)\n\nexport default Vue\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3eimport { initMixin } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x27.\/init\x27\nimport { \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3eMixin } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x27.\/\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e\x27\nimport { renderMixin } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x27.\/render\x27\nimport { eventsMixin } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x27.\/events\x27\nimport { lifecycleMixin } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x27.\/lifecycle\x27\nimport { warn } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x27..\/util\/index\x27\n\nfunction Vue (options) {\n  \/\/ 判断是否是new调用。\n  if (process.env.NODE_ENV !== \x27production\x27 \x26amp;\x26amp;\n    !(this instanceof Vue)\n  ) {\n    warn(\x27Vue is a constructor and should be called with the `new` keyword\x27)\n  }\n  \/\/ 开始初始化\n  this._init(options)\n}\n\/\/ 添加Vue._init(options)内部方法，.\/init.js\ninitMixin(Vue)\n\/**\n * .\/\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.js\n * 添加属性和方法\n * Vue.prototype.\x3cspan class=\x22hljs-variable\x22\x3e$data\x3c\/span\x3e \n * Vue.prototype.\x3cspan class=\x22hljs-variable\x22\x3e$props\x3c\/span\x3e\n * Vue.prototype.\x3cspan class=\x22hljs-variable\x22\x3e$watch\x3c\/span\x3e\n * Vue.prototype.\x3cspan class=\x22hljs-variable\x22\x3e$set\x3c\/span\x3e\n * Vue.prototype.\x3cspan class=\x22hljs-variable\x22\x3e$delete\x3c\/span\x3e\n *\/ \n\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3eMixin(Vue)\n\/**\n * .\/event.js\n * 添加实例事件\n * Vue.prototype.\x3cspan class=\x22hljs-variable\x22\x3e$on\x3c\/span\x3e\n * Vue.prototype.\x3cspan class=\x22hljs-variable\x22\x3e$once\x3c\/span\x3e\n * Vue.prototype.\x3cspan class=\x22hljs-variable\x22\x3e$off\x3c\/span\x3e\n * Vue.prototype.\x3cspan class=\x22hljs-variable\x22\x3e$emit\x3c\/span\x3e\n *\/ \neventsMixin(Vue)\n\/**\n * .\/lifecycle.js\n * 添加实例生命周期方法\n * Vue.prototype._update\n * Vue.prototype.\x3cspan class=\x22hljs-variable\x22\x3e$forceUpdate\x3c\/span\x3e\n * Vue.prototype.\x3cspan class=\x22hljs-variable\x22\x3e$destroy\x3c\/span\x3e\n *\/ \nlifecycleMixin(Vue)\n\/**\n * .\/render.js\n * 添加实例渲染方法\n * 通过执行installRenderHelpers(Vue.prototype);为实例添加很多helper\n * Vue.prototype.\x3cspan class=\x22hljs-variable\x22\x3e$nextTick\x3c\/span\x3e\n * Vue.prototype._render\n *\/ \nrenderMixin(Vue)\n\nexport \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e Vue\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e5.\x3cstrong\x3einstance\/init.js\x3c\/strong\x3e\n\x3c\/h2\x3e\n\x3cp\x3e初始化,完成主组件的所有动作的主线。从这儿出发可以理清observer、watcher、compiler 、render等\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import config from \x27..\/config\x27\nimport { initProxy } from \x27.\/proxy\x27\nimport { initState } from \x27.\/state\x27\nimport { initRender } from \x27.\/render\x27\nimport { initEvents } from \x27.\/events\x27\nimport { mark, measure } from \x27..\/util\/perf\x27\nimport { initLifecycle, callHook } from \x27.\/lifecycle\x27\nimport { initProvide, initInjections } from \x27.\/inject\x27\nimport { extend, mergeOptions, formatComponentName } from \x27..\/util\/index\x27\n\nlet uid = 0\n\nexport function initMixin (Vue: Class\x3cComponent\x3e) {\n  Vue.prototype._init = function (options?: Object) {\n    const vm: Component = this\n    \/\/ a uid\n    vm._uid = uid\x2b\x2b\n\n    let startTag, endTag\n    \/* istanbul ignore if *\/\n    if (process.env.NODE_ENV !== \x27production\x27 \x26amp;\x26amp; config.performance \x26amp;\x26amp; mark) {\n      startTag = `vue-perf-start:${vm._uid}`\n      endTag = `vue-perf-end:${vm._uid}`\n      mark(startTag)\n    }\n\n    \/\/ a flag to avoid this being observed\n    vm._isVue = true\n    \/\/ merge options\n    if (options \x26amp;\x26amp; options._isComponent) {\n      \/\/ optimize internal component instantiation\n      \/\/ since dynamic options merging is pretty slow, and none of the\n      \/\/ internal component options needs special treatment.\n      initInternalComponent(vm, options)\n    } else {\n      vm.$options = mergeOptions(\n        resolveConstructorOptions(vm.constructor),\n        options || {},\n        vm\n      )\n    }\n    \/* istanbul ignore else *\/\n    if (process.env.NODE_ENV !== \x27production\x27) {\n      initProxy(vm)\n    } else {\n      vm._renderProxy = vm\n    }\n    \/\/ expose real self\n    vm._self = vm\n    initLifecycle(vm)\n    initEvents(vm)\n    \/**\n    * 添加vm.$createElement vm.$vnode vm.$slots vm.\n    * 创建vm.$attrs  \/  vm.$listeners 并且转换为getter和setter\n    * \n    *\/\n    initRender(vm)\n    callHook(vm, \x27beforeCreate\x27)\n    initInjections(vm) \/\/ resolve injections before data\/props vm.$scopedSlots \n    \/**\n    * 1、创建 vm._watchers = [];\n    * 2、执行if (opts.props) { initProps(vm, opts.props); } 验证props后调用defineReactive转化，并且代理数据proxy(vm, \x26quot;_props\x26quot;, key);\n    * 3、执行if (opts.methods) { initMethods(vm, opts.methods); } 然后vm[key] = methods[key] == null ? noop : bind(methods[key], vm);\n    * 4、处理data,\n    * if (opts.data) {\n    *    initData(vm);\n    * } else {\n    *    observe(vm._data = {}, true \/* asRootData *\/);\n    * }\n    * 5、执行initData:\n    *       （1）先判断data的属性是否有与methods和props值同名\n    *       （2）获取vm.data（如果为function，执行getData(data, vm)），代理proxy(vm, \x26quot;_data\x26quot;, key);\n    *       （3）执行 observe(data, true \/* asRootData *\/);递归观察\n    * 6、完成observe，具体看解释\n    *\/\n    initState(vm)\n    initProvide(vm) \/\/ resolve provide after data\/props\n    callHook(vm, \x27created\x27)\n\n    \/* istanbul ignore if *\/\n    if (process.env.NODE_ENV !== \x27production\x27 \x26amp;\x26amp; config.performance \x26amp;\x26amp; mark) {\n      vm._name = formatComponentName(vm, false)\n      mark(endTag)\n      measure(`vue ${vm._name} init`, startTag, endTag)\n    }\n\n    if (vm.$options.el) {\n      vm.$mount(vm.$options.el)\n    }\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e config \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/config\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { initProxy } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/proxy\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { initState } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/state\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { initRender } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/render\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { initEvents } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/events\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { mark, measure } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/util\/perf\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { initLifecycle, callHook } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/lifecycle\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { initProvide, initInjections } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/inject\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { extend, mergeOptions, formatComponentName } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/util\/index\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e uid = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3einitMixin\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eVue: Class\x26lt;Component\x26gt;\x3c\/span\x3e) \x3c\/span\x3e{\n  Vue.prototype._init = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eoptions?: Object\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e vm: Component = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ a uid\x3c\/span\x3e\n    vm._uid = uid\x2b\x2b\n\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e startTag, endTag\n    \x3cspan class=\x22hljs-comment\x22\x3e\/* istanbul ignore if *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (process.env.NODE_ENV !== \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e \x26amp;\x26amp; config.performance \x26amp;\x26amp; mark) {\n      startTag = \x3cspan class=\x22hljs-string\x22\x3e`vue-perf-start:\x3cspan class=\x22hljs-subst\x22\x3e${vm._uid}\x3c\/span\x3e`\x3c\/span\x3e\n      endTag = \x3cspan class=\x22hljs-string\x22\x3e`vue-perf-end:\x3cspan class=\x22hljs-subst\x22\x3e${vm._uid}\x3c\/span\x3e`\x3c\/span\x3e\n      mark(startTag)\n    }\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ a flag to avoid this being observed\x3c\/span\x3e\n    vm._isVue = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ merge options\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (options \x26amp;\x26amp; options._isComponent) {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ optimize internal component instantiation\x3c\/span\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ since dynamic options merging is pretty slow, and none of the\x3c\/span\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ internal component options needs special treatment.\x3c\/span\x3e\n      initInternalComponent(vm, options)\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      vm.$options = mergeOptions(\n        resolveConstructorOptions(vm.constructor),\n        options || {},\n        vm\n      )\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/* istanbul ignore else *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (process.env.NODE_ENV !== \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e) {\n      initProxy(vm)\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      vm._renderProxy = vm\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ expose real self\x3c\/span\x3e\n    vm._self = vm\n    initLifecycle(vm)\n    initEvents(vm)\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n    * 添加vm.$createElement vm.$vnode vm.$slots vm.\n    * 创建vm.$attrs  \/  vm.$listeners 并且转换为getter和setter\n    * \n    *\/\x3c\/span\x3e\n    initRender(vm)\n    callHook(vm, \x3cspan class=\x22hljs-string\x22\x3e\x27beforeCreate\x27\x3c\/span\x3e)\n    initInjections(vm) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ resolve injections before data\/props vm.$scopedSlots \x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n    * 1、创建 vm._watchers = [];\n    * 2、执行if (opts.props) { initProps(vm, opts.props); } 验证props后调用defineReactive转化，并且代理数据proxy(vm, \x22_props\x22, key);\n    * 3、执行if (opts.methods) { initMethods(vm, opts.methods); } 然后vm[key] = methods[key] == null ? noop : bind(methods[key], vm);\n    * 4、处理data,\n    * if (opts.data) {\n    *    initData(vm);\n    * } else {\n    *    observe(vm._data = {}, true \/* asRootData *\/\x3c\/span\x3e);\n    * }\n    * \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e、执行initData:\n    *       （\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e）先判断data的属性是否有与methods和props值同名\n    *       （\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e）获取vm.data（如果为\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e，执行\x3cspan class=\x22hljs-title\x22\x3egetData\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata, vm\x3c\/span\x3e)），代理\x3cspan class=\x22hljs-title\x22\x3eproxy\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evm, \x3cspan class=\x22hljs-string\x22\x3e\x22_data\x22\x3c\/span\x3e, key\x3c\/span\x3e);\n    *       （3）执行 \x3cspan class=\x22hljs-title\x22\x3eobserve\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata, true \x3cspan class=\x22hljs-regexp\x22\x3e\/* asRootData *\/\x3c\/span\x3e\x3c\/span\x3e);递归观察\n    * 6、完成\x3cspan class=\x22hljs-title\x22\x3eobserve\x3c\/span\x3e，具体看解释\n    *\/\n    \x3cspan class=\x22hljs-title\x22\x3einitState\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evm\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-title\x22\x3einitProvide\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evm\x3c\/span\x3e) \/\/ \x3cspan class=\x22hljs-title\x22\x3eresolve\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eprovide\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eafter\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edata\x3c\/span\x3e\/\x3cspan class=\x22hljs-title\x22\x3eprops\x3c\/span\x3e\n    \x3cspan class=\x22hljs-title\x22\x3ecallHook\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evm, \x3cspan class=\x22hljs-string\x22\x3e\x27created\x27\x3c\/span\x3e\x3c\/span\x3e)\n\n    \/* \x3cspan class=\x22hljs-title\x22\x3eistanbul\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eignore\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eif\x3c\/span\x3e *\/\n    \x3cspan class=\x22hljs-title\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eprocess.env.NODE_ENV !== \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e \x26amp;\x26amp; config.performance \x26amp;\x26amp; mark\x3c\/span\x3e) \x3c\/span\x3e{\n      vm._name = formatComponentName(vm, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e)\n      mark(endTag)\n      measure(\x3cspan class=\x22hljs-string\x22\x3e`vue \x3cspan class=\x22hljs-subst\x22\x3e${vm._name}\x3c\/span\x3e init`\x3c\/span\x3e, startTag, endTag)\n    }\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (vm.$options.el) {\n      vm.$mount(vm.$options.el)\n    }\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e二、observe 响应式数据转换\x3c\/h2\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e1.前置方法 observe(value, asRootData)\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function observe (value, asRootData) {\n  \/\/ 如果value不是是Object 或者是VNode这不用转换\n  if (!isObject(value) || value instanceof VNode) {\n    return\n  }\n  var ob;\n  \/\/ 如果已经转换就复用\n  if (hasOwn(value, \x27__ob__\x27) \x26amp;\x26amp; value.__ob__ instanceof Observer) {\n    ob = value.__ob__;\n  } else if (\n    \/\/一堆必要的条件判断\n    observerState.shouldConvert \x26amp;\x26amp;\n    !isServerRendering() \x26amp;\x26amp;\n    (Array.isArray(value) || isPlainObject(value)) \x26amp;\x26amp;\n    Object.isExtensible(value) \x26amp;\x26amp;\n    !value._isVue\n  ) {\n    \/\/这才是observe主体\n    ob = new Observer(value);\n  }\n  if (asRootData \x26amp;\x26amp; ob) {\n    ob.vmCount\x2b\x2b;\n  }\n  return ob\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ceylon\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e observe (\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e, asRootData) {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果value不是是Object 或者是VNode这不用转换\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!isObject(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e) || \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e instanceof VNode) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n  }\n  var ob;\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果已经转换就复用\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (hasOwn(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27__ob__\x27\x3c\/span\x3e) \x26amp;\x26amp; \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e__\x3c\/span\x3eob\x3cspan class=\x22hljs-number\x22\x3e__\x3c\/span\x3e instanceof Observer) {\n    ob = \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e__\x3c\/span\x3eob\x3cspan class=\x22hljs-number\x22\x3e__\x3c\/span\x3e;\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/一堆必要的条件判断\x3c\/span\x3e\n    observerState.shouldConvert \x26amp;\x26amp;\n    !isServerRendering() \x26amp;\x26amp;\n    (Array.isArray(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e) || isPlainObject(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e)) \x26amp;\x26amp;\n    Object.isExtensible(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e) \x26amp;\x26amp;\n    !\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3eisVue\n  ) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/这才是observe主体\x3c\/span\x3e\n    ob = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Observer(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e);\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (asRootData \x26amp;\x26amp; ob) {\n    ob.vmCount\x2b\x2b;\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e ob\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e2.Observer 类\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var Observer = function Observer (value) {\n  \/\/ 当asRootData = true时，其实可以将value当做vm.$options.data，后面都这样方便理解\n  this.value = value;\n  \/**\n  * 为vm.data创建一个dep实例，可以理解为一个专属事件列表维护对象\n  * 例如： this.dep = { id : 156, subs : [] }\n  * 实例方法： this.dep.__proto__ = { addSub, removeSub, depend, notify, constructor }\n  *\/\n  this.dep = new Dep();\n  \/\/记录关联的vm实例的数量\n  this.vmCount = 0;\n  \/\/为vm.data 添加__ob__属性，值为当前observe实例，并且转化为响应式数据。所以看一个value是否为响应式就可以看他有没有__ob__属性\n  def(value, \x27__ob__\x27, this);\n  \/\/响应式数据转换分为数组、对象两种。\n  if (Array.isArray(value)) {\n    var augment = hasProto\n      ? protoAugment\n      : copyAugment;\n    augment(value, arrayMethods, arrayKeys);\n    this.observeArray(value);\n  } else {\n    \/\/对象的转换，而且walk是Observer的实例方法，请记住\n    this.walk(value);\n  }\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cs\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e Observer = \x3cspan class=\x22hljs-function\x22\x3efunction \x3cspan class=\x22hljs-title\x22\x3eObserver\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 当asRootData = true时，其实可以将value当做vm.$options.data，后面都这样方便理解\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e = \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-comment\x22\x3e\/**\n  * 为vm.data创建一个dep实例，可以理解为一个专属事件列表维护对象\n  * 例如： this.dep = { id : 156, subs : [] }\n  * 实例方法： this.dep.__proto__ = { addSub, removeSub, depend, notify, constructor }\n  *\/\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.dep = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Dep();\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/记录关联的vm实例的数量\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.vmCount = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/为vm.data 添加__ob__属性，值为当前observe实例，并且转化为响应式数据。所以看一个value是否为响应式就可以看他有没有__ob__属性\x3c\/span\x3e\n  def(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27__ob__\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/响应式数据转换分为数组、对象两种。\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (Array.isArray(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e)) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e augment = hasProto\n      ? protoAugment\n      : copyAugment;\n    augment(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e, arrayMethods, arrayKeys);\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.observeArray(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e);\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/对象的转换，而且walk是Observer的实例方法，请记住\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.walk(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e);\n  }\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader11\x22\x3e3.walk\x3c\/h2\x3e\n\x3cp\x3e该方法要将vm.data的所有属性都转化为getter\/setter模式，所以vm.data只能是Object。数组的转换不一样，这里暂不做讲解。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Observer.prototype.walk = function walk (obj) {\n  \/\/ 得到key的列表\n  var keys = Object.keys(obj);\n  for (var i = 0; i \x3c keys.length; i\x2b\x2b) {\n    \/\/核心方法：定义响应式数据的方法  defineReactive(对象, 属性, 值);这样看是不是就很爽了\n    defineReactive(obj, keys[i], obj[keys[i]]);\n  }\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3eObserver.prototype.walk = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ewalk\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eobj\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 得到key的列表\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e keys = \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.keys(obj);\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; keys.length; i\x2b\x2b) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/核心方法：定义响应式数据的方法  defineReactive(对象, 属性, 值);这样看是不是就很爽了\x3c\/span\x3e\n    defineReactive(obj, keys[i], obj[keys[i]]);\n  }\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader12\x22\x3e4.defineReactive(obj, key, value)\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function defineReactive (\n  obj,\n  key,\n  val,\n  customSetter, \/\/自定义setter，为了测试\n  shallow \/\/是否只转换这一个属性后代不管控制参数,false ：是，true ： 否\n) {\n  \/**\n  * 又是一个dep实例，其实作用与observe中的dep功能一样，不同点：\n  *     1.observe实例的dep对象是父级vm.data的订阅者维护对象\n  *     2.这个dep是vm.data的属性key的订阅者维护对象，因为val有可能也是对象\n  *     3.这里的dep没有写this.dep是因为defineReactive是一个方法，不是构造函数，所以使用闭包锁在内存中\n  *\/\n  var dep = new Dep();\n  \/\/ 获取key的属性描述符\n  var property = Object.getOwnPropertyDescriptor(obj, key);\n  \/\/ 如果key属性不可设置，则退出该函数\n  if (property \x26amp;\x26amp; property.configurable === false) {\n    return\n  }\n\n  \/\/ 为了配合那些已经的定义了getter\/setter的情况\n  var getter = property \x26amp;\x26amp; property.get;\n  var setter = property \x26amp;\x26amp; property.set;\n  \n  \/\/递归，因为没有传asRootData为true，所以vm.data的vmCount是部分计数的。因为它还是属于vm的数据\n  var childOb = !shallow \x26amp;\x26amp; observe(val);\n  \/**\n  * 全部完成后observe也就完成了。但是，每个属性的dep都没启作用。\n  * 这就是所谓的依赖收集了，后面继续。\n  *\/\n  Object.defineProperty(obj, key, {\n    enumerable: true,\n    configurable: true,\n    get: function reactiveGetter () {\n      var value = getter ? getter.call(obj) : val;\n      if (Dep.target) {\n        dep.depend();\n        if (childOb) {\n          childOb.dep.depend();\n          if (Array.isArray(value)) {\n            dependArray(value);\n          }\n        }\n      }\n      return value\n    },\n    set: function reactiveSetter (newVal) {\n      var value = getter ? getter.call(obj) : val;\n      \/* eslint-disable no-self-compare *\/\n      if (newVal === value || (newVal !== newVal \x26amp;\x26amp; value !== value)) {\n        return\n      }\n      \/* eslint-enable no-self-compare *\/\n      if (process.env.NODE_ENV !== \x27production\x27 \x26amp;\x26amp; customSetter) {\n        customSetter();\n      }\n      if (setter) {\n        setter.call(obj, newVal);\n      } else {\n        val = newVal;\n      }\n      childOb = !shallow \x26amp;\x26amp; observe(newVal);\n      dep.notify();\n    }\n  });\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edefineReactive\x3c\/span\x3e \x3c\/span\x3e(\n  obj,\n  key,\n  val,\n  customSetter, \x3cspan class=\x22hljs-comment\x22\x3e\/\/自定义setter，为了测试\x3c\/span\x3e\n  shallow \x3cspan class=\x22hljs-comment\x22\x3e\/\/是否只转换这一个属性后代不管控制参数,false ：是，true ： 否\x3c\/span\x3e\n) {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/**\n  * 又是一个dep实例，其实作用与observe中的dep功能一样，不同点：\n  *     1.observe实例的dep对象是父级vm.data的订阅者维护对象\n  *     2.这个dep是vm.data的属性key的订阅者维护对象，因为val有可能也是对象\n  *     3.这里的dep没有写this.dep是因为defineReactive是一个方法，不是构造函数，所以使用闭包锁在内存中\n  *\/\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e dep = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eDep\x3c\/span\x3e();\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取key的属性描述符\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e property = Object.getOwnPropertyDescriptor(obj, key);\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果key属性不可设置，则退出该函数\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (property \x26amp;\x26amp; property.configurable === \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n  }\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 为了配合那些已经的定义了getter\/setter的情况\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e getter = property \x26amp;\x26amp; property.\x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e setter = property \x26amp;\x26amp; property.\x3cspan class=\x22hljs-keyword\x22\x3eset\x3c\/span\x3e;\n  \n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/递归，因为没有传asRootData为true，所以vm.data的vmCount是部分计数的。因为它还是属于vm的数据\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e childOb = !shallow \x26amp;\x26amp; observe(val);\n  \x3cspan class=\x22hljs-comment\x22\x3e\/**\n  * 全部完成后observe也就完成了。但是，每个属性的dep都没启作用。\n  * 这就是所谓的依赖收集了，后面继续。\n  *\/\x3c\/span\x3e\n  Object.defineProperty(obj, key, {\n    enumerable: \x3cspan class=\x22hljs-type\x22\x3etrue\x3c\/span\x3e,\n    configurable: \x3cspan class=\x22hljs-type\x22\x3etrue\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e: \x3cspan class=\x22hljs-type\x22\x3efunction reactiveGetter \x3c\/span\x3e() {\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e value = getter ? getter.call(obj) : \x3cspan class=\x22hljs-type\x22\x3eval\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (Dep.target) {\n        dep.depend();\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (childOb) {\n          childOb.dep.depend();\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3eArray\x3c\/span\x3e.isArray(value)) {\n            dependArray(value);\n          }\n        }\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e value\n    },\n    \x3cspan class=\x22hljs-keyword\x22\x3eset\x3c\/span\x3e: \x3cspan class=\x22hljs-type\x22\x3efunction reactiveSetter \x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e value = getter ? getter.call(obj) : \x3cspan class=\x22hljs-type\x22\x3eval\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/* eslint-disable no-self-compare *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e === value || (\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e !== \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e \x26amp;\x26amp; value !== value)) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/* eslint-enable no-self-compare *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (process.env.NODE_ENV !== \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e \x26amp;\x26amp; customSetter) {\n        customSetter();\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (setter) {\n        setter.call(obj, \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e);\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        val = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e;\n      }\n      childOb = !shallow \x26amp;\x26amp; observe(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e);\n      dep.notify();\n    }\n  });\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader13\x22\x3e三、依赖收集\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22一些个人理解：\n    1、Watcher 订阅者\n        可以将它理解为，要做什么。具体的体现就是Watcher的第二个参数expOrFn。\n    2、Observer 观察者\n        其实观察的体现就是getter\/setter能够观察数据的变化（数组的实现不同）。\n    3、dependency collection 依赖收集\n        订阅者(Watcher)是干事情的，是一些指令、方法、表达式的执行形式。它运行的过程中肯定离不开数据，所以就成了这些数据的依赖项目。因为离不开^_^数据。\n        数据是肯定会变的，那么数据变了就得通知数据的依赖项目(Watcher)让他们再执行一下。\n        依赖同一个数据的依赖项目(Watcher)可能会很多，为了保证能够都通知到，所以需要收集一下。\n    4、Dep 依赖收集器构造函数\n        因为数据是由深度的，在不同的深度有不同的依赖，所以我们需要一个容器来装起来。\n        Dep.target的作用是保证数据在收集依赖项(Watcher)时，watcher是对这个数据依赖的，然后一个个去收集的。\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e一些个人理解：\n    \x3cspan class=\x22hljs-selector-tag\x22\x3e1\x3c\/span\x3e、\x3cspan class=\x22hljs-selector-tag\x22\x3eWatcher\x3c\/span\x3e 订阅者\n        可以将它理解为，要做什么。具体的体现就是\x3cspan class=\x22hljs-selector-tag\x22\x3eWatcher\x3c\/span\x3e的第二个参数\x3cspan class=\x22hljs-selector-tag\x22\x3eexpOrFn\x3c\/span\x3e。\n    \x3cspan class=\x22hljs-selector-tag\x22\x3e2\x3c\/span\x3e、\x3cspan class=\x22hljs-selector-tag\x22\x3eObserver\x3c\/span\x3e 观察者\n        其实观察的体现就是\x3cspan class=\x22hljs-selector-tag\x22\x3egetter\x3c\/span\x3e\/\x3cspan class=\x22hljs-selector-tag\x22\x3esetter\x3c\/span\x3e能够观察数据的变化（数组的实现不同）。\n    \x3cspan class=\x22hljs-selector-tag\x22\x3e3\x3c\/span\x3e、\x3cspan class=\x22hljs-selector-tag\x22\x3edependency\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3ecollection\x3c\/span\x3e 依赖收集\n        订阅者(Watcher)是干事情的，是一些指令、方法、表达式的执行形式。它运行的过程中肯定离不开数据，所以就成了这些数据的依赖项目。因为离不开^\x3cspan class=\x22hljs-selector-tag\x22\x3e_\x3c\/span\x3e^数据。\n        数据是肯定会变的，那么数据变了就得通知数据的依赖项目(Watcher)让他们再执行一下。\n        依赖同一个数据的依赖项目(Watcher)可能会很多，为了保证能够都通知到，所以需要收集一下。\n    \x3cspan class=\x22hljs-selector-tag\x22\x3e4\x3c\/span\x3e、\x3cspan class=\x22hljs-selector-tag\x22\x3eDep\x3c\/span\x3e 依赖收集器构造函数\n        因为数据是由深度的，在不同的深度有不同的依赖，所以我们需要一个容器来装起来。\n        \x3cspan class=\x22hljs-selector-tag\x22\x3eDep\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.target\x3c\/span\x3e的作用是保证数据在收集依赖项(Watcher)时，\x3cspan class=\x22hljs-selector-tag\x22\x3ewatcher\x3c\/span\x3e是对这个数据依赖的，然后一个个去收集的。\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader14\x22\x3e1、Watcher\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Watcher (vm, expOrFn, cb, options)\n参数：\n{string | Function} expOrFn\n{Function | Object} callback\n{Object} [options]\n    {boolean} deep\n    {boolean} user\n    {boolean} lazy\n    {boolean} sync\n在Vue的整个生命周期当中，会有4类地方会实例化Watcher：\n    Vue实例化的过程中有watch选项\n    Vue实例化的过程中有computed计算属性选项\n    Vue原型上有挂载$watch方法: Vue.prototype.$watch，可以直接通过实例调用this.$watch方法\n    Vue生成了render函数，更新视图时\n    \n    Watcher接收的参数当中expOrFn定义了用以获取watcher的getter函数。expOrFn可以有2种类型：string或function.若为string类型，\n首先会通过parsePath方法去对string进行分割(仅支持.号形式的对象访问)。在除了computed选项外，其他几种实例化watcher的方式都\n是在实例化过程中完成求值及依赖的收集工作：this.value = this.lazy ? undefined : this.get().在Watcher的get方法中:\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs arduino\x22\x3e\x3ccode\x3eWatcher (vm, expOrFn, cb, options)\n参数：\n{\x3cspan class=\x22hljs-keyword\x22\x3estring\x3c\/span\x3e | Function} expOrFn\n{Function | Object} callback\n{Object} [options]\n    {\x3cspan class=\x22hljs-keyword\x22\x3eboolean\x3c\/span\x3e} deep\n    {\x3cspan class=\x22hljs-keyword\x22\x3eboolean\x3c\/span\x3e} user\n    {\x3cspan class=\x22hljs-keyword\x22\x3eboolean\x3c\/span\x3e} lazy\n    {\x3cspan class=\x22hljs-keyword\x22\x3eboolean\x3c\/span\x3e} sync\n在Vue的整个生命周期当中，会有\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e类地方会实例化Watcher：\n    Vue实例化的过程中有watch选项\n    Vue实例化的过程中有computed计算属性选项\n    Vue原型上有挂载$watch方法: Vue.prototype.$watch，可以直接通过实例调用\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$watch方法\n    Vue生成了render函数，更新视图时\n    \n    Watcher接收的参数当中expOrFn定义了用以获取watcher的getter函数。expOrFn可以有\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e种类型：\x3cspan class=\x22hljs-keyword\x22\x3estring\x3c\/span\x3e或function.若为\x3cspan class=\x22hljs-keyword\x22\x3estring\x3c\/span\x3e类型，\n首先会通过parsePath方法去对\x3cspan class=\x22hljs-keyword\x22\x3estring\x3c\/span\x3e进行分割(仅支持.号形式的对象访问)。在除了computed选项外，其他几种实例化watcher的方式都\n是在实例化过程中完成求值及依赖的收集工作：\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.value = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.lazy ? undefined : \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.\x3cspan class=\x22hljs-built_in\x22\x3eget\x3c\/span\x3e().在Watcher的\x3cspan class=\x22hljs-built_in\x22\x3eget\x3c\/span\x3e方法中:\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var Watcher = function Watcher (\n  vm,\n  expOrFn,\n  cb,\n  options\n) {\n  this.vm = vm;\n  vm._watchers.push(this);\n  \/\/ options\n  if (options) {\n    this.deep = !!options.deep;\n    this.user = !!options.user;\n    this.lazy = !!options.lazy;\n    this.sync = !!options.sync;\n  } else {\n    this.deep = this.user = this.lazy = this.sync = false;\n  }\n  \/\/相关属性\n  this.cb = cb;\n  this.id = \x2b\x2buid$2; \/\/ uid for batching\n  this.active = true;\n  this.dirty = this.lazy; \/\/ for lazy watchers\n  \/\/\n  this.deps = [];\n  this.newDeps = [];\n  \/\/set类型的ids\n  this.depIds = new _Set();\n  this.newDepIds = new _Set();\n  \/\/ 表达式\n  this.expression = process.env.NODE_ENV !== \x27production\x27\n    ? expOrFn.toString()\n    : \x27\x27;\n  \/\/ 创建一个getter\n  if (typeof expOrFn === \x27function\x27) {\n    this.getter = expOrFn;\n  } else {\n    this.getter = parsePath(expOrFn);\n    if (!this.getter) {\n      this.getter = function () {};\n      process.env.NODE_ENV !== \x27production\x27 \x26amp;\x26amp; warn(\n        \x26quot;Failed watching path: \\\x26quot;\x26quot; \x2b expOrFn \x2b \x26quot;\\\x26quot; \x26quot; \x2b\n        \x27Watcher only accepts simple dot-delimited paths. \x27 \x2b\n        \x27For full control, use a function instead.\x27,\n        vm\n      );\n    }\n  }\n  this.value = this.lazy\n    ? undefined\n    : this.get();\/\/执行get收集依赖项\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e Watcher = function Watcher (\n  vm,\n  expOrFn,\n  cb,\n  options\n) {\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.vm = vm;\n  vm._watchers.push(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ options\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (options) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.deep = !!options.deep;\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.user = !!options.user;\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.lazy = !!options.lazy;\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.sync = !!options.sync;\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.deep = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.user = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.lazy = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.sync = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n  }\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/相关属性\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cb = cb;\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.id = \x2b\x2buid$\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ uid for batching\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.active = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.dirty = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.lazy; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ for lazy watchers\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.deps = [];\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.newDeps = [];\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/set类型的ids\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.depIds = new _Set();\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.newDepIds = new _Set();\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 表达式\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.expression = process.env.NODE_ENV !== \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e\n    ? expOrFn.toString()\n    : \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建一个getter\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (typeof expOrFn === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getter = expOrFn;\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getter = parsePath(expOrFn);\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getter) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getter = function () {};\n      process.env.NODE_ENV !== \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e \x26amp;\x26amp; warn(\n        \x3cspan class=\x22hljs-string\x22\x3e\x22Failed watching path: \\\x22\x22\x3c\/span\x3e \x2b expOrFn \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22\\\x22 \x22\x3c\/span\x3e \x2b\n        \x3cspan class=\x22hljs-string\x22\x3e\x27Watcher only accepts simple dot-delimited paths. \x27\x3c\/span\x3e \x2b\n        \x3cspan class=\x22hljs-string\x22\x3e\x27For full control, use a function instead.\x27\x3c\/span\x3e,\n        vm\n      );\n    }\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.value = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.lazy\n    ? undefined\n    : \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e();\x3cspan class=\x22hljs-comment\x22\x3e\/\/执行get收集依赖项\x3c\/span\x3e\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader15\x22\x3e2、Watcher.prototype.get\x3c\/h2\x3e\n\x3cp\x3e通过设置观察值(this.value)调用this.get方法，执行this.getter.call(vm, vm)，这个过程中只要获取了某个响应式数据。那么肯定会触发该数据的getter方法。因为当前的Dep.target = watcher。所以就将该watcher作为了这个响应数据的依赖项。因为watcher在执行过程中的确需要、使用了它、所以依赖它。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Watcher.prototype.get = function get () {\n  \/\/将这个watcher观察者实例添加到Dep.target，表明当前为this.expressoin的依赖收集时间\n  pushTarget(this);\n  var value;\n  var vm = this.vm;\n  try {\n    \/**\n    * 执行this.getter.call(vm, vm):\n    *     1、如果是function则相当于vm.expOrFn(vm)，只要在这个方法执行的过程中有从vm上获取属性值的都会触发该属性值的get方法从而完成依赖收集。因为现在Dep.target=this. \n    *     2、如果是字符串（如a.b）,那么this.getter.call(vm, vm)就相当于vm.a.b\n    *\/ \n    value = this.getter.call(vm, vm);\n  } catch (e) {\n    if (this.user) {\n      handleError(e, vm, (\x26quot;getter for watcher \\\x26quot;\x26quot; \x2b (this.expression) \x2b \x26quot;\\\x26quot;\x26quot;));\n    } else {\n      throw e\n    }\n  } finally {\n    \/\/ \x26quot;touch\x26quot; every property so they are all tracked as\n    \/\/ dependencies for deep watching\n    if (this.deep) {\n      traverse(value);\n    }\n    popTarget();\n    this.cleanupDeps();\n  }\n  return value\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3eWatcher.prototype.\x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e = function \x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e () {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/将这个watcher观察者实例添加到Dep.target，表明当前为this.expressoin的依赖收集时间\x3c\/span\x3e\n  pushTarget(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e value;\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e vm = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.vm;\n  \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n    * 执行this.getter.call(vm, vm):\n    *     1、如果是function则相当于vm.expOrFn(vm)，只要在这个方法执行的过程中有从vm上获取属性值的都会触发该属性值的get方法从而完成依赖收集。因为现在Dep.target=this. \n    *     2、如果是字符串（如a.b）,那么this.getter.call(vm, vm)就相当于vm.a.b\n    *\/\x3c\/span\x3e \n    value = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getter.call(vm, vm);\n  } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.user) {\n      handleError(e, vm, (\x3cspan class=\x22hljs-string\x22\x3e\x22getter for watcher \\\x22\x22\x3c\/span\x3e \x2b (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.expression) \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22\\\x22\x22\x3c\/span\x3e));\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e e\n    }\n  } \x3cspan class=\x22hljs-keyword\x22\x3efinally\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ \x22touch\x22 every property so they are all tracked as\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ dependencies for deep watching\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.deep) {\n      traverse(value);\n    }\n    popTarget();\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cleanupDeps();\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e value\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader16\x22\x3e3、getter\/setter\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Object.defineProperty(obj, key, {\n    enumerable: true,\n    configurable: true,\n    get: function reactiveGetter () {\n      var value = getter ? getter.call(obj) : val;\n      if (Dep.target) {\n        \/\/依赖收集，这里又饶了一圈，看后面的解释\n        dep.depend();\n        if (childOb) {\n          childOb.dep.depend();\n          if (Array.isArray(value)) {\n            dependArray(value);\n          }\n        }\n      }\n      return value\n    },\n    set: function reactiveSetter (newVal) {\n      var value = getter ? getter.call(obj) : val;\n      \/* eslint-disable no-self-compare *\/\n      if (newVal === value || (newVal !== newVal \x26amp;\x26amp; value !== value)) {\n        return\n      }\n      \/* eslint-enable no-self-compare *\/\n      if (process.env.NODE_ENV !== \x27production\x27 \x26amp;\x26amp; customSetter) {\n        customSetter();\n      }\n      if (setter) {\n        setter.call(obj, newVal);\n      } else {\n        val = newVal;\n      }\n      childOb = !shallow \x26amp;\x26amp; observe(newVal);\n      \/\/数据变动出发所有依赖项\n      dep.notify();\n    }\n  });\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode\x3eObject.defineProperty(obj, key, {\n    enumerable: \x3cspan class=\x22hljs-type\x22\x3etrue\x3c\/span\x3e,\n    configurable: \x3cspan class=\x22hljs-type\x22\x3etrue\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e: \x3cspan class=\x22hljs-type\x22\x3efunction reactiveGetter \x3c\/span\x3e() {\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e value = getter ? getter.call(obj) : \x3cspan class=\x22hljs-type\x22\x3eval\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (Dep.target) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/依赖收集，这里又饶了一圈，看后面的解释\x3c\/span\x3e\n        dep.depend();\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (childOb) {\n          childOb.dep.depend();\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3eArray\x3c\/span\x3e.isArray(value)) {\n            dependArray(value);\n          }\n        }\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e value\n    },\n    \x3cspan class=\x22hljs-keyword\x22\x3eset\x3c\/span\x3e: \x3cspan class=\x22hljs-type\x22\x3efunction reactiveSetter \x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e value = getter ? getter.call(obj) : \x3cspan class=\x22hljs-type\x22\x3eval\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-comment\x22\x3e\/* eslint-disable no-self-compare *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e === value || (\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e !== \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e \x26amp;\x26amp; value !== value)) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/* eslint-enable no-self-compare *\/\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (process.env.NODE_ENV !== \x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e \x26amp;\x26amp; customSetter) {\n        customSetter();\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (setter) {\n        setter.call(obj, \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e);\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        val = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e;\n      }\n      childOb = !shallow \x26amp;\x26amp; observe(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/数据变动出发所有依赖项\x3c\/span\x3e\n      dep.notify();\n    }\n  });\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e- 依赖收集具体动作：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/调用的自己dep的实例方法\nDep.prototype.depend = function depend () {\n  if (Dep.target) {\n    \/\/调用的是当前Watcher实例的addDe方法，并且把dep对象传过去了\n    Dep.target.addDep(this);\n  }\n};\n\nWatcher.prototype.addDep = function addDep (dep) {\n  var id = dep.id;\n  if (!this.newDepIds.has(id)) {\n    \/\/为这个watcher统计内部依赖了多少个数据，以及其他公用该数据的watcher\n    this.newDepIds.add(id);\n    this.newDeps.push(dep);\n    if (!this.depIds.has(id)) {\n      \/\/继续为数据收集依赖项目的步骤\n      dep.addSub(this);\n    }\n  }\n};\nDep.prototype.addSub = function addSub (sub) {\n  this.subs.push(sub);\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/调用的自己dep的实例方法\x3c\/span\x3e\nDep.prototype.depend = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edepend\x3c\/span\x3e \x3c\/span\x3e() {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (Dep.target) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/调用的是当前Watcher实例的addDe方法，并且把dep对象传过去了\x3c\/span\x3e\n    Dep.target.addDep(\x3cspan class=\x22hljs-built_in\x22\x3ethis\x3c\/span\x3e);\n  }\n};\n\nWatcher.prototype.addDep = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eaddDep\x3c\/span\x3e \x3c\/span\x3e(dep) {\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e id = dep.id;\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-built_in\x22\x3ethis\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eDepIds\x3c\/span\x3e.has(id)) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/为这个watcher统计内部依赖了多少个数据，以及其他公用该数据的watcher\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3ethis\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eDepIds\x3c\/span\x3e.add(id);\n    \x3cspan class=\x22hljs-built_in\x22\x3ethis\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eDeps\x3c\/span\x3e.push(dep);\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-built_in\x22\x3ethis\x3c\/span\x3e.depIds.has(id)) {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/继续为数据收集依赖项目的步骤\x3c\/span\x3e\n      dep.addSub(\x3cspan class=\x22hljs-built_in\x22\x3ethis\x3c\/span\x3e);\n    }\n  }\n};\nDep.prototype.addSub = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eaddSub\x3c\/span\x3e \x3c\/span\x3e(sub) {\n  \x3cspan class=\x22hljs-built_in\x22\x3ethis\x3c\/span\x3e.subs.push(sub);\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e- 数据变动出发依赖动作：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Dep.prototype.notify = function notify () {\n  \/\/ stabilize the subscriber list first\n  var subs = this.subs.slice();\n  for (var i = 0, l = subs.length; i \x3c l; i\x2b\x2b) {\n    subs[i].update();\n  }\n};\n\/\/对当前watcher的处理\nWatcher.prototype.update = function update () {\n  \/* istanbul ignore else *\/\n  if (this.lazy) {\n    this.dirty = true;\n  } else if (this.sync) {\n    this.run();\n  } else {\n    queueWatcher(this);\n  }\n};\n\/\/把一个观察者推入观察者队列。\n\/\/具有重复id的作业将被跳过，除非它是\n\/\/当队列被刷新时被推。\nexport function queueWatcher (watcher: Watcher) {\n  const id = watcher.id\n  if (has[id] == null) {\n    has[id] = true\n    if (!flushing) {\n      queue.push(watcher)\n    } else {\n      \/\/ if already flushing, splice the watcher based on its id\n      \/\/ if already past its id, it will be run next immediately.\n      let i = queue.length - 1\n      while (i \x3e index \x26amp;\x26amp; queue[i].id \x3e watcher.id) {\n        i--\n      }\n      queue.splice(i \x2b 1, 0, watcher)\n    }\n    \/\/ queue the flush\n    if (!waiting) {\n      waiting = true\n      nextTick(flushSchedulerQueue)\n    }\n  }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3eDep.prototype.notify = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3enotify\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ stabilize the subscriber list first\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e subs = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.subs.slice();\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, l = subs.length; i \x26lt; l; i\x2b\x2b) {\n    subs[i].update();\n  }\n};\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/对当前watcher的处理\x3c\/span\x3e\nWatcher.prototype.update = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eupdate\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/* istanbul ignore else *\/\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.lazy) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.dirty = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.sync) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.run();\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    queueWatcher(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e);\n  }\n};\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/把一个观察者推入观察者队列。\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/具有重复id的作业将被跳过，除非它是\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/当队列被刷新时被推。\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3equeueWatcher\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ewatcher: Watcher\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e id = watcher.id\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (has[id] == \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e) {\n    has[id] = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!flushing) {\n      queue.push(watcher)\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ if already flushing, splice the watcher based on its id\x3c\/span\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ if already past its id, it will be run next immediately.\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = queue.length - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (i \x26gt; index \x26amp;\x26amp; queue[i].id \x26gt; watcher.id) {\n        i--\n      }\n      queue.splice(i \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, watcher)\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ queue the flush\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!waiting) {\n      waiting = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n      nextTick(flushSchedulerQueue)\n    }\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Vue2 源码漫游（一）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011945068">https://segmentfault.com/a/1190000011945068</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/kkovjwosiwr/" target="_blank">https://alili.tech/archive/kkovjwosiwr/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>