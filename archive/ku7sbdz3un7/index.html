<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | å‰ç«¯å¤§çˆ†ç‚¸! - WEB BANG! BANG!! BANG!!! å‰ç«¯å¤§çˆ†ç‚¸,ä¸€ä¸ªå‰ç«¯æŠ€æœ¯åšå®¢.æƒ³åˆ°å“ª,å­¦åˆ°å“ª,å†™åˆ°å“ª. æœ¬æ–‡èµ„æºæ¥æºäº’è”ç½‘ï¼Œä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œç‰ˆæƒå½’è¯¥èµ„æºçš„åˆæ³•æ‹¥æœ‰è€…æ‰€æœ‰ï¼Œ Alili, å‰ç«¯å¤§çˆ†ç‚¸, WEB BANG BANG BANG, webå‰ç«¯åšå®¢, å‰ç«¯æ¨¡å—åŒ–, å‰ç«¯å·¥ç¨‹åŒ–, å‰ç«¯æ•°æ®ç›‘æ§, æ€§èƒ½ä¼˜åŒ–, ç½‘é¡µåˆ¶ä½œ, å‰ç«¯, js, html5, css"><meta name="keywords" content="Alili, å‰ç«¯å¤§çˆ†ç‚¸, WEB BANG BANG BANG, webå‰ç«¯åšå®¢, å‰ç«¯æ¨¡å—åŒ–, å‰ç«¯å·¥ç¨‹åŒ–, å‰ç«¯æ•°æ®ç›‘æ§, æ€§èƒ½ä¼˜åŒ–, ç½‘é¡µåˆ¶ä½œ, å‰ç«¯, js, html5, css, è¸©å‘å°æŠ¥å‘Š, å¾®å‰ç«¯, æ ‘è“æ´¾, å‰ç«¯å¼€å‘, åŒºå—é“¾, ç½‘ç»œ, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="ã€Reactè¿›é˜¶ç³»åˆ—ã€‘ä»é›¶å¼€å§‹æ‰‹æŠŠæ‰‹æ•™ä½ å®ç°ä¸€ä¸ªVirtual DOMï¼ˆä¸‰ï¼‰"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | å‰ç«¯å¤§çˆ†ç‚¸! - WEB BANG! BANG!! BANG!!! å‰ç«¯å¤§çˆ†ç‚¸,ä¸€ä¸ªå‰ç«¯æŠ€æœ¯åšå®¢.æƒ³åˆ°å“ª,å­¦åˆ°å“ª,å†™åˆ°å“ª. æœ¬æ–‡èµ„æºæ¥æºäº’è”ç½‘ï¼Œä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œç‰ˆæƒå½’è¯¥èµ„æºçš„åˆæ³•æ‹¥æœ‰è€…æ‰€æœ‰ï¼Œ Alili, å‰ç«¯å¤§çˆ†ç‚¸, WEB BANG BANG BANG, webå‰ç«¯åšå®¢, å‰ç«¯æ¨¡å—åŒ–, å‰ç«¯å·¥ç¨‹åŒ–, å‰ç«¯æ•°æ®ç›‘æ§, æ€§èƒ½ä¼˜åŒ–, ç½‘é¡µåˆ¶ä½œ, å‰ç«¯, js, html5, css"><meta property="og:site_name" content="Alili"><title>ã€Reactè¿›é˜¶ç³»åˆ—ã€‘ä»é›¶å¼€å§‹æ‰‹æŠŠæ‰‹æ•™ä½ å®ç°ä¸€ä¸ªVirtual DOMï¼ˆä¸‰ï¼‰ | å‰ç«¯å¤§çˆ†ç‚¸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/ku7sbdz3un7/",
				"appid": "1613049289050283", 
				"title": "ã€Reactè¿›é˜¶ç³»åˆ—ã€‘ä»é›¶å¼€å§‹æ‰‹æŠŠæ‰‹æ•™ä½ å®ç°ä¸€ä¸ªVirtual DOMï¼ˆä¸‰ï¼‰ | å‰ç«¯å¤§çˆ†ç‚¸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-03T02:30:08"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/hltrmqu7pwe/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/7fvkc5swso/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fku7sbdz3un7%2f&text=%e3%80%90React%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%e3%80%91%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aaVirtual%20DOM%ef%bc%88%e4%b8%89%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fku7sbdz3un7%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fku7sbdz3un7%2f&text=%e3%80%90React%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%e3%80%91%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aaVirtual%20DOM%ef%bc%88%e4%b8%89%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fku7sbdz3un7%2f&title=%e3%80%90React%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%e3%80%91%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aaVirtual%20DOM%ef%bc%88%e4%b8%89%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fku7sbdz3un7%2f&is_video=false&description=%e3%80%90React%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%e3%80%91%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aaVirtual%20DOM%ef%bc%88%e4%b8%89%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e3%80%90React%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%e3%80%91%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aaVirtual%20DOM%ef%bc%88%e4%b8%89%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fku7sbdz3un7%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fku7sbdz3un7%2f&title=%e3%80%90React%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%e3%80%91%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aaVirtual%20DOM%ef%bc%88%e4%b8%89%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fku7sbdz3un7%2f&title=%e3%80%90React%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%e3%80%91%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aaVirtual%20DOM%ef%bc%88%e4%b8%89%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fku7sbdz3un7%2f&title=%e3%80%90React%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%e3%80%91%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aaVirtual%20DOM%ef%bc%88%e4%b8%89%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fku7sbdz3un7%2f&title=%e3%80%90React%e8%bf%9b%e9%98%b6%e7%b3%bb%e5%88%97%e3%80%91%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aaVirtual%20DOM%ef%bc%88%e4%b8%89%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#ç‰ˆæƒå£°æ˜">ç‰ˆæƒå£°æ˜</a><ul><li><a href="#åŸæ–‡æ ‡é¢˜">åŸæ–‡æ ‡é¢˜</a></li><li><a href="#åŸæ–‡é“¾æ¥">åŸæ–‡é“¾æ¥</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">ã€Reactè¿›é˜¶ç³»åˆ—ã€‘ä»é›¶å¼€å§‹æ‰‹æŠŠæ‰‹æ•™ä½ å®ç°ä¸€ä¸ªVirtual DOMï¼ˆä¸‰ï¼‰</h1><div class="meta"><div class="postdate"><time datetime="2018-12-03" itemprop="datePublished">2018-12-03</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | å‰ç«¯å¤§çˆ†ç‚¸! - WEB BANG! BANG!! BANG!!! å‰ç«¯å¤§çˆ†ç‚¸,ä¸€ä¸ªå‰ç«¯æŠ€æœ¯åšå®¢.æƒ³åˆ°å“ª,å­¦åˆ°å“ª,å†™åˆ°å“ª. æœ¬æ–‡èµ„æºæ¥æºäº’è”ç½‘ï¼Œä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œç‰ˆæƒå½’è¯¥èµ„æºçš„åˆæ³•æ‹¥æœ‰è€…æ‰€æœ‰ï¼Œ Alili, å‰ç«¯å¤§çˆ†ç‚¸, WEB BANG BANG BANG, webå‰ç«¯åšå®¢, å‰ç«¯æ¨¡å—åŒ–, å‰ç«¯å·¥ç¨‹åŒ–, å‰ç«¯æ•°æ®ç›‘æ§, æ€§èƒ½ä¼˜åŒ–, ç½‘é¡µåˆ¶ä½œ, å‰ç«¯, js, html5, css, è¸©å‘å°æŠ¥å‘Š, å¾®å‰ç«¯, æ ‘è“æ´¾, å‰ç«¯å¼€å‘, åŒºå—é“¾, ç½‘ç»œ, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2\x3eä¸Šé›†å›é¡¾\x3c\/h2\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000014603332\x22\x3eã€Reactè¿›é˜¶ç³»åˆ—ã€‘ä»é›¶å¼€å§‹æ‰‹æŠŠæ‰‹æ•™ä½ å®ç°ä¸€ä¸ªVirtual DOMï¼ˆäºŒï¼‰\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3eä¸Šé›†æˆ‘ä»¬å®ç°äº†é¦–æ¬¡æ¸²æŸ“ä»JSX=\x26gt;Hyperscript=\x26gt;VDOM=\x26gt;DOMçš„è¿‡ç¨‹ï¼Œä»Šå¤©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å½“æ•°æ®å˜åŠ¨çš„æ—¶å€™æ€ä¹ˆæ›´æ–°DOMï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾çš„å³åŠè¾¹éƒ¨åˆ†ã€‚\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV9o7Q?w=314\x26amp;h=517\x22 src=\x22https:\/\/static.alili.tech\/img\/bV9o7Q?w=314\x26amp;h=517\x22 alt=\x22å›¾ç‰‡æè¿°\x22 title=\x22å›¾ç‰‡æè¿°\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2\x3eæ”¹å†™view()\x3c\/h2\x3e\n\x3cpre\x3e\x3ccode\x3efunction view(count) { \n  const r = [...Array(count).keys()]\n  return \x26lt;ul id=\x22filmList\x22 className={`list-${count % 3}`}\x26gt;\n    { r.map(n =\x26gt; \x26lt;li\x26gt;item {(count * n).toString()}\x26lt;\/li\x26gt;) }\n  \x26lt;\/ul\x26gt;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eæˆ‘ä»¬çš„viewå‡½æ•°æ¥æ”¶ä¸€ä¸ªå‚æ•°countï¼Œå˜é‡rè¡¨ç¤ºä»0åˆ°count-1çš„ä¸€ä¸ªæ•°ç»„ã€‚å‡å¦‚count=3, r=[0, 1, 2]ã€‚ulçš„classNameçš„å€¼æœ‰ä¸‰ç§å¯èƒ½ï¼šlist-0, list-1, list-2ã€‚liçš„æ•°é‡å–å†³äºcountã€‚\x3c\/p\x3e\n\x3ch2\x3eæ”¹å†™render()\x3c\/h2\x3e\n\x3cpre\x3e\x3ccode\x3efunction render(el) {\n  const initialCount = 0\n\n  el.appendChild(createElement(view(initialCount)))\n  setTimeout(() =\x26gt; tick(el, initialCount), 1000)\n}\n\nfunction tick(el, count) {\n  const patches = diff(view(count \x2b 1), view(count))\n  patch(el, patches)\n\n  if(count \x26gt; 5) { return }\n  setTimeout(() =\x26gt; tick(el, count \x2b 1), 1000)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3erenderå‡½æ•°æœ‰ä¸¤ä¸ªä¿®æ”¹ï¼Œé¦–å…ˆè°ƒç”¨view()çš„æ—¶å€™ä¼ å…¥count=0ã€‚å…¶æ¬¡ï¼Œå†™äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œ1ç§’åæ‚”æ‰§è¡Œtickå‡½æ•°ã€‚tickå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œelä»£è¡¨èŠ‚ç‚¹å…ƒç´ ï¼Œcountæ˜¯å½“å‰è®¡æ•°å€¼ã€‚\x3c\/p\x3e\n\x3cp\x3etickå‡½æ•°ä¾æ¬¡åšäº†è¿™å‡ ä»¶äº‹ï¼š\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3eè°ƒç”¨diffå‡½æ•°ï¼Œå¯¹æ¯”æ–°æ—§ä¸¤ä¸ªVDOMï¼Œæ ¹æ®ä¸¤è€…çš„ä¸åŒå¾—åˆ°éœ€è¦ä¿®æ”¹çš„è¡¥ä¸\x3c\/li\x3e\n\x3cli\x3eå°†è¡¥ä¸patchåˆ°çœŸå®DOMä¸Š\x3c\/li\x3e\n\x3cli\x3eå½“è®¡æ•°å™¨å°äºç­‰äº5çš„æ—¶å€™ï¼Œå°†countåŠ 1ï¼Œå†ç»§ç»­ä¸‹ä¸€æ¬¡tick\x3c\/li\x3e\n\x3cli\x3eå½“è®¡æ•°å™¨å¤§äº5çš„æ—¶å€™ï¼Œç»“æŸ\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3eä¸‹é¢æˆ‘ä»¬æ¥å®ç°diffå‡½æ•°å’Œpatchå‡½æ•°ã€‚\x3c\/p\x3e\n\x3cp\x3eæˆ‘ä»¬å…ˆåˆ—å‡ºæ¥æ–°æ—§ä¸¤ä¸ªVDOMå¯¹æ¯”ï¼Œä¼šæœ‰å“ªäº›ä¸åŒã€‚åœ¨index.jsæ–‡ä»¶çš„æœ€å‰é¢å£°æ˜ä¸€ä¸‹å‡ ä¸ªå¸¸é‡ã€‚\x3c\/p\x3e\n\x3cpre\x3e\x3ccode\x3econst CREATE = \x27CREATE\x27   \/\/æ–°å¢ä¸€ä¸ªèŠ‚ç‚¹\nconst REMOVE = \x27REMOVE\x27   \/\/åˆ é™¤åŸèŠ‚ç‚¹\nconst REPLACE = \x27REPLACE\x27  \/\/æ›¿æ¢åŸèŠ‚ç‚¹\nconst UPDATE = \x27UPDATE\x27    \/\/æ£€æŸ¥å±æ€§æˆ–å­èŠ‚ç‚¹æ˜¯å¦æœ‰å˜åŒ–\nconst SET_PROP = \x27SET_PROP\x27  \/\/æ–°å¢æˆ–æ›¿æ¢å±æ€§\nconst REMOVE_PROP = \x27REMOVE PROP\x27  \/\/åˆ é™¤å±æ€§\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2\x3ediff()\x3c\/h2\x3e\n\x3cpre\x3e\x3ccode\x3efunction diff(newNode, oldNode) {\n   if (!oldNode) {\n     return { type: CREATE, newNode }\n   }\n\n   if (!newNode) {\n     return { type: REMOVE }\n   }\n\n   if (changed(newNode, oldNode)) {\n     return { type: REPLACE, newNode }\n   }\n\n   if (newNode.type) {\n     return {\n       type: UPDATE,\n       props: diffProps(newNode, oldNode),\n       children: diffChildren(newNode, oldNode)\n     }\n   }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3col\x3e\n\x3cli\x3eå‡å¦‚æ—§èŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬è¿”å›çš„patcheså¯¹è±¡, ç±»å‹ä¸ºæ–°å¢èŠ‚ç‚¹ï¼›\x3c\/li\x3e\n\x3cli\x3eå‡å¦‚æ–°èŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œè¡¨ç¤ºæ˜¯åˆ é™¤èŠ‚ç‚¹ï¼›\x3c\/li\x3e\n\x3cli\x3eå‡å¦‚ä¸¤è€…éƒ½å­˜åœ¨çš„è¯ï¼Œè°ƒç”¨changedå‡½æ•°åˆ¤æ–­ä»–ä»¬æ˜¯ä¸æ˜¯æœ‰å˜åŠ¨ï¼›\x3c\/li\x3e\n\x3cli\x3eå‡å¦‚ä¸¤è€…éƒ½å­˜åœ¨ï¼Œä¸”changed()è¿”å›falseçš„è¯ï¼Œåˆ¤æ–­æ–°èŠ‚ç‚¹æ˜¯å¦æ˜¯VDOMï¼ˆæ ¹æ®typeæ˜¯å¦å­˜åœ¨æ¥åˆ¤æ–­çš„ï¼Œå› ä¸ºtypeä¸å­˜åœ¨çš„è¯ï¼ŒnewNodeè¦ä¹ˆæ˜¯ç©ºèŠ‚ç‚¹ï¼Œè¦ä¹ˆæ˜¯å­—ç¬¦ä¸²ï¼‰ã€‚å‡å¦‚æ–°èŠ‚ç‚¹æ˜¯VDOMï¼Œåˆ™è¿”å›ä¸€ä¸ªpatcheså¯¹è±¡ï¼Œç±»å‹æ˜¯UPDATEï¼ŒåŒæ—¶å¯¹propså’Œchildrenåˆ†åˆ«è¿›è¡ŒdiffPropså’ŒdiffChildrenæ“ä½œã€‚\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3eä¸‹é¢æˆ‘ä»¬ä¸€æ¬¡çœ‹ä¸€ä¸‹changed, diffProps, diffChildrenå‡½æ•°ã€‚\x3c\/p\x3e\n\x3ch2\x3echanged()\x3c\/h2\x3e\n\x3cpre\x3e\x3ccode\x3efunction changed(node1, node2) {\n  return typeof(node1) !== typeof(node2) ||\n         typeof(node1) === \x27string\x27 \x26amp;\x26amp; node1 !== node2 ||\n         node1.type !== node2.type\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eæ£€æŸ¥æ–°æ—§VDOMæ˜¯å¦æœ‰å˜åŠ¨çš„æ–¹æ³•å¾ˆç®€å•ï¼Œ\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3eé¦–å…ˆå‡å¦‚æ•°æ®ç±»å‹éƒ½ä¸ä¸€æ ·ï¼Œé‚£è‚¯å®šæ˜¯å˜åŠ¨äº†ï¼›\x3c\/li\x3e\n\x3cli\x3eå…¶æ¬¡å‡å¦‚ä¸¤è€…çš„ç±»å‹éƒ½æ˜¯çº¯æ–‡æœ¬ï¼Œåˆ™ç›´æ¥æ¯”è¾ƒä¸¤è€…æ˜¯å¦ç›¸ç­‰ï¼›\x3c\/li\x3e\n\x3cli\x3eæœ€åæ¯”è¾ƒä¸¤è€…çš„ç±»å‹æ˜¯å¦ç›¸ç­‰ã€‚\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2\x3ediffProps()\x3c\/h2\x3e\n\x3cpre\x3e\x3ccode\x3efunction diffProps(newNode, oldNode) {\n  let patches = []\n\n  let props = Object.assign({}, newNode.props, oldNode.props)\n  Object.keys(props).forEach(key =\x26gt; {\n    const newVal = newNode.props[key]\n    const oldVal = oldNode.props[key]\n    if (!newVal) {\n      patches.push({type: REMOVE_PROP, key, value: oldVal})\n    }\n\n    if (!oldVal || newVal !== oldVal) {\n      patches.push({ type: SET_PROP, key, value: newVal})\n    }\n  })\n\n  return patches\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eæ¯”è¾ƒæ–°æ—§VDOMçš„å±æ€§çš„å˜åŒ–ï¼Œå¹¶è¿”å›ç›¸åº”çš„patchesã€‚\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3eé¦–å…ˆæˆ‘ä»¬é‡‡ç”¨æœ€å¤§å¯èƒ½æ€§åŸåˆ™ï¼Œå°†æ–°æ—§VDOMçš„æ‰€æœ‰å±æ€§éƒ½åˆå¹¶èµ‹å€¼ç»™ä¸€ä¸ªæ–°çš„å˜é‡props\x3c\/li\x3e\n\x3cli\x3eéå†propså˜é‡çš„æ‰€æœ‰Keysï¼Œä¾æ¬¡æ¯”è¾ƒæ–°æ—§VDOMå¯¹äºè¿™ä¸ªKEYçš„å€¼\x3c\/li\x3e\n\x3cli\x3eå‡å¦‚æ–°å€¼ä¸å­˜åœ¨ï¼Œè¡¨ç¤ºè¿™ä¸ªå±æ€§è¢«åˆ é™¤äº†\x3c\/li\x3e\n\x3cli\x3eå‡å¦‚æ—§å€¼ä¸å­˜åœ¨ï¼Œæˆ–è€…æ–°æ—§å€¼ä¸åŒï¼Œåˆ™è¡¨ç¤ºæˆ‘ä»¬éœ€è¦é‡æ–°è®¾ç½®è¿™ä¸ªå±æ€§\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2\x3ediffChildren()\x3c\/h2\x3e\n\x3cpre\x3e\x3ccode\x3efunction diffChildren(newNode, oldNode) {\n  let patches = []\n\n  const maximumLength = Math.max(\n    newNode.children.length,\n    oldNode.children.length\n  )\n  for(let i = 0; i \x26lt; maximumLength; i\x2b\x2b) {\n    patches[i] = diff(\n      newNode.children[i],\n      oldNode.children[i]\n    )\n  }\n\n  return patches\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eåŒæ ·é‡‡ç”¨æœ€å¤§å¯èƒ½æ€§åŸåˆ™ï¼Œå–æ–°æ—§VDOMçš„childrençš„æœ€é•¿å€¼ä½œä¸ºéå†childrençš„é•¿åº¦ã€‚ç„¶åä¾æ¬¡æ¯”è¾ƒæ–°æ—§VDOMçš„åœ¨ç›¸åŒINDEXä¸‹çš„æ¯ä¸€ä¸ªchildã€‚\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e\x3cem\x3eè¿™é‡Œéœ€è¦å¼ºçƒˆæ³¨æ„ä¸€ä¸‹\x3c\/em\x3e\x3c\/strong\x3e\x3cbr\x3eä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬æ²¡æœ‰å¼•å…¥keyçš„æ¦‚å¿µï¼Œç›´æ¥æ¯”è¾ƒçš„æ˜¯ç›¸åŒindexä¸‹çš„childã€‚æ‰€ä»¥å‡å¦‚è¯´ä¸€ä¸ªåˆ—è¡¨ulæœ‰5é¡¹ï¼Œåˆ†åˆ«æ˜¯li1, li2, li3, li4, li5; å¦‚æœæˆ‘ä»¬åˆ æ‰äº†ç¬¬ä¸€é¡¹ï¼Œæ–°çš„å˜æˆäº†li2, li3, li4, li5ã€‚é‚£ä¹ˆdiffchildrençš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šæ‹¿li1å’Œli2æ¯”è¾ƒï¼Œä¾æ¬¡ç±»æ¨ã€‚è¿™æ ·ä¸€æ¥ï¼Œæœ¬æ¥åªæ˜¯åˆ é™¤äº†li1, è€Œli2, li3, li4, li5æ²¡æœ‰ä»»ä½•å˜åŒ–ï¼Œæˆ‘ä»¬å¾—å‡ºçš„diffç»“è®ºå´æ˜¯[liæ›¿æ¢ï¼Œli2æ›¿æ¢, li3æ›¿æ¢, li4æ›¿æ¢, li5åˆ é™¤]ã€‚æ‰€ä»¥reactè®©å¤§å®¶æ¸²æŸ“åˆ—è¡¨çš„æ—¶å€™ï¼Œå¿…é¡»æ·»åŠ Keyã€‚\x3c\/p\x3e\n\x3cp\x3eæˆªæ­¢åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»å¾—åˆ°äº†æˆ‘ä»¬éœ€è¦çš„è¡¥ä¸ã€‚ä¸‹é¢æˆ‘ä»¬è¦å°†è¡¥ä¸Patchåˆ°DOMé‡Œã€‚\x3c\/p\x3e\n\x3ch2\x3epatch()\x3c\/h2\x3e\n\x3cpre\x3e\x3ccode\x3efunction patch(parent, patches, index = 0) {\n  if (!patches) {\n    return\n  }\n\n  const el = parent.childNodes[index]\n  switch (patches.type) {\n    case CREATE: {\n      const { newNode } = patches\n      const newEl = createElement(newNode)\n      parent.appendChild(newEl)\n      break\n    }\n    case REMOVE: {\n      parent.removeChild(el)\n      break\n    }\n    case REPLACE: {\n      const {newNode} = patches\n      const newEl = createElement(newNode)\n      return parent.replaceChild(newEl, el)\n      break\n    }\n    case UPDATE: {\n      const {props, children} = patches\n      patchProps(el, props)\n      for(let i = 0; i \x26lt; children.length; i\x2b\x2b) {\n        patch(el, children[i], i)\n      }\n    }\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3col\x3e\n\x3cli\x3eé¦–å…ˆå½“patchesä¸å­˜åœ¨æ—¶ï¼Œç›´æ¥returnï¼Œä¸è¿›è¡Œä»»ä½•æ“ä½œ\x3c\/li\x3e\n\x3cli\x3eåˆ©ç”¨childNodeså’ŒIndexå–å‡ºå½“å‰æ­£åœ¨å¤„ç†çš„è¿™ä¸ªèŠ‚ç‚¹ï¼Œèµ‹å€¼ä¸ºel\x3c\/li\x3e\n\x3cli\x3eå¼€å§‹åˆ¤æ–­è¡¥ä¸çš„ç±»å‹\x3c\/li\x3e\n\x3cli\x3eå½“ç±»å‹æ˜¯CREATEæ—¶ï¼Œç”Ÿæˆä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œå¹¶appendåˆ°æ ¹èŠ‚ç‚¹\x3c\/li\x3e\n\x3cli\x3eå½“ç±»å‹æ˜¯REMOVEæ—¶ï¼Œç›´æ¥åˆ é™¤å½“å‰èŠ‚ç‚¹el\x3c\/li\x3e\n\x3cli\x3eå½“ç±»å‹æ˜¯REPLACEæ—¶ï¼Œç”Ÿæˆæ–°èŠ‚ç‚¹ï¼ŒåŒæ—¶æ›¿æ¢æ‰åŸèŠ‚ç‚¹\x3c\/li\x3e\n\x3cli\x3eå½“ç±»å‹æ˜¯UPDATEæ—¶ï¼Œéœ€è¦æˆ‘ä»¬ç‰¹æ®Šå¤„ç†\x3c\/li\x3e\n\x3cli\x3eè°ƒç”¨patchPropså°†æˆ‘ä»¬ä¹‹å‰diffPropså¾—åˆ°çš„è¡¥ä¸æ¸²æŸ“åˆ°èŠ‚ç‚¹ä¸Š\x3c\/li\x3e\n\x3cli\x3eéå†ä¹‹å‰diffChildrenå¾—åˆ°çš„è¡¥ä¸åˆ—è¡¨ï¼Œå†ä¾æ¬¡é€’å½’è°ƒç”¨patch\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3eæœ€åæˆ‘ä»¬å†è¡¥å……ä¸€ä¸‹patchPropså‡½æ•°\x3c\/p\x3e\n\x3ch2\x3epatchProps\x3c\/h2\x3e\n\x3cpre\x3e\x3ccode\x3efunction patchProps(parent, patches) {\n  patches.forEach(patch =\x26gt; {\n    const { type, key, value } = patch\n    if (type === \x27SET_PROP\x27) {\n      setProp(parent, key, value)\n    }\n    if (type === \x27REMOVE_PROP\x27) {\n      removeProp(parent, key, value)\n    }\n  })\n}\n\nfunction removeProp(target, name, value) { \/\/@\n  if (name === \x27className\x27) {\n    return target.removeAttribute(\x27class\x27)\n  }\n\n  target.removeAttribute(name)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eè¿™ä¸ªå°±ä¸ç”¨æˆ‘è§£é‡Šäº†ï¼Œä»£ç å¾ˆç›´è§‚ï¼ŒsetPropå‡½æ•°åœ¨ä¸Šä¸€é›†æˆ‘ä»¬å·²ç»å®šä¹‰è¿‡äº†ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†æ•´ä¸ªæ•°æ®æ›´æ–°å¯¼è‡´DOMæ›´æ–°çš„å®Œæ•´è¿‡ç¨‹ã€‚\x3cbr\x3enpm run compileåæ‰“å¼€æµè§ˆå™¨æŸ¥çœ‹æ•ˆæœï¼Œä½ åº”è¯¥çœ‹åˆ°æ˜¯ä¸€ä¸ªèƒŒæ™¯é¢œè‰²åœ¨ä¸åŒå˜åŒ–ï¼ŒåŒæ—¶åˆ—è¡¨é¡¹åœ¨é€æ¸å¢åŠ çš„åˆ—è¡¨ã€‚\x3c\/p\x3e\n\x3ch2\x3eå®Œç»“æ’’èŠ±\x3c\/h2\x3e\n\x3cp\x3eè‡³æ­¤ï¼Œæˆ‘ä»¬çš„VDOMå°±å…¨éƒ¨å®Œæˆäº†ã€‚ç³»åˆ—åˆæˆ‘æå‡ºçš„é‚£å‡ ä¸ªé—®é¢˜ä¸çŸ¥é“ä½ ç°åœ¨æ˜¯å¦æœ‰äº†ç­”æ¡ˆã€‚æœ‰ç­”æ¡ˆçš„ç«¥é‹å¯ä»¥åœ¨æ–‡ç« è¯„è®ºåŒºå°†ä½ çš„è§è§£è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹ã€‚åˆ†æå…¨é¢ä¸”å‡†ç¡®çš„ä¼šæ”¶åˆ°æˆ‘çš„ç‰¹æ®Šå¥–åŠ±ã€‚ğŸ˜ğŸ˜ğŸ˜ğŸ˜\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="ç‰ˆæƒå£°æ˜">ç‰ˆæƒå£°æ˜</h1><p>æœ¬æ–‡èµ„æºæ¥æºäº’è”ç½‘ï¼Œä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œç‰ˆæƒå½’è¯¥èµ„æºçš„åˆæ³•æ‹¥æœ‰è€…æ‰€æœ‰ï¼Œ</p><p>æœ¬æ–‡ä»…ç”¨äºå­¦ä¹ ã€ç ”ç©¶å’Œäº¤æµç›®çš„ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€å®Œæ•´é“¾æ¥ä»¥åŠåŸä½œè€…ã€‚</p><p>åŸä½œè€…è‹¥è®¤ä¸ºæœ¬ç«™ä¾µçŠ¯äº†æ‚¨çš„ç‰ˆæƒï¼Œè¯·è”ç³»æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¼šç«‹å³åˆ é™¤ï¼</p><h2 id="åŸæ–‡æ ‡é¢˜">åŸæ–‡æ ‡é¢˜</h2><p>ã€Reactè¿›é˜¶ç³»åˆ—ã€‘ä»é›¶å¼€å§‹æ‰‹æŠŠæ‰‹æ•™ä½ å®ç°ä¸€ä¸ªVirtual DOMï¼ˆä¸‰ï¼‰</p><h2 id="åŸæ–‡é“¾æ¥">åŸæ–‡é“¾æ¥</h2><p><a href="https://segmentfault.com/a/1190000014641724">https://segmentfault.com/a/1190000014641724</a></p><h2>æœ¬æ–‡é“¾æ¥ï¼š</h2><a href="https://alili.tech/archive/ku7sbdz3un7/" target="_blank">https://alili.tech/archive/ku7sbdz3un7/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: 'è¯´ç‚¹ä»€ä¹ˆ?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>å…¶ä»–æ¨è</h3><li><a href="/archive/hvvo3rmt3dj/">JSæ‰“åŒ…å·¥å…·rollupâ€”â€”å®Œå…¨å…¥é—¨æŒ‡å—<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [åŸºäºSpring Boot ä¸ Vueçš„åå°è„šæ‰‹æ¶] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGLå…¥é—¨demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[é¢è¯•ä¸“é¢˜]ä¸€çº¿äº’è”ç½‘å¤§å‚é¢è¯•æ€»ç»“<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;reduxæœ€æ–°ç‰ˆæ„å»ºåˆ†äº«<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">reactè™šæ‹Ÿdomæœºåˆ¶ä¸diffç®—æ³•<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">ä¸€å¥—Vueçš„å•é¡µæ¨¡æ¿ï¼šN3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">ä½¿ç”¨ json-server æ­å»º api mock æœåŠ¡ (ä¸€)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">ä½¿ç”¨Ionic3æ¡†æ¶å¼€å§‹ç¬¬ä¸€ä¸ªæ··åˆå¼€å‘APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">å¦‚ä½•åªç”¨ CSS å®Œæˆæ¼‚äº®çš„åŠ è½½<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright Â© 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">æµ™ICPå¤‡18045521å·</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>