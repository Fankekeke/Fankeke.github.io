<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="由 ECMA 规范解读 Javascript 可执行上下文概念"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>由 ECMA 规范解读 Javascript 可执行上下文概念 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/kvm1l1mbytb/",
				"appid": "1613049289050283", 
				"title": "由 ECMA 规范解读 Javascript 可执行上下文概念 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-01T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/f9s6dvrscro/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/zijyzbgbiu/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fkvm1l1mbytb%2f&text=%e7%94%b1%20ECMA%20%e8%a7%84%e8%8c%83%e8%a7%a3%e8%af%bb%20Javascript%20%e5%8f%af%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87%e6%a6%82%e5%bf%b5"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fkvm1l1mbytb%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fkvm1l1mbytb%2f&text=%e7%94%b1%20ECMA%20%e8%a7%84%e8%8c%83%e8%a7%a3%e8%af%bb%20Javascript%20%e5%8f%af%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87%e6%a6%82%e5%bf%b5"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fkvm1l1mbytb%2f&title=%e7%94%b1%20ECMA%20%e8%a7%84%e8%8c%83%e8%a7%a3%e8%af%bb%20Javascript%20%e5%8f%af%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87%e6%a6%82%e5%bf%b5"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fkvm1l1mbytb%2f&is_video=false&description=%e7%94%b1%20ECMA%20%e8%a7%84%e8%8c%83%e8%a7%a3%e8%af%bb%20Javascript%20%e5%8f%af%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87%e6%a6%82%e5%bf%b5"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e7%94%b1%20ECMA%20%e8%a7%84%e8%8c%83%e8%a7%a3%e8%af%bb%20Javascript%20%e5%8f%af%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87%e6%a6%82%e5%bf%b5&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fkvm1l1mbytb%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fkvm1l1mbytb%2f&title=%e7%94%b1%20ECMA%20%e8%a7%84%e8%8c%83%e8%a7%a3%e8%af%bb%20Javascript%20%e5%8f%af%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87%e6%a6%82%e5%bf%b5"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkvm1l1mbytb%2f&title=%e7%94%b1%20ECMA%20%e8%a7%84%e8%8c%83%e8%a7%a3%e8%af%bb%20Javascript%20%e5%8f%af%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87%e6%a6%82%e5%bf%b5"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkvm1l1mbytb%2f&title=%e7%94%b1%20ECMA%20%e8%a7%84%e8%8c%83%e8%a7%a3%e8%af%bb%20Javascript%20%e5%8f%af%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87%e6%a6%82%e5%bf%b5"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkvm1l1mbytb%2f&title=%e7%94%b1%20ECMA%20%e8%a7%84%e8%8c%83%e8%a7%a3%e8%af%bb%20Javascript%20%e5%8f%af%e6%89%a7%e8%a1%8c%e4%b8%8a%e4%b8%8b%e6%96%87%e6%a6%82%e5%bf%b5"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">由 ECMA 规范解读 Javascript 可执行上下文概念</h1><div class="meta"><div class="postdate"><time datetime="2019-01-01" itemprop="datePublished">2019-01-01</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e前言\x3c\/h2\x3e\n\x3cblockquote\x3e\x3cp\x3e其实规范这东西不是给人看的，它更多的是给语言实现者提供参考。但是当碰到问题找不到答案时，规范往往能提供想要的答案 。偶尔读一下能够带来很大的启发和思考，如果只读一章 Javascript 规范，大神们觉得非第10章莫属。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e我们来试试看，这次选用的是 \x3ccode\x3eECMA2.2\x3c\/code\x3e的 5.1 版，整个规范才200页， 而第10章共10页，可以感受到 \x3ccode\x3eJavascript\x3c\/code\x3e 的精简，目前的版本加了太多 ES6 的东西，让人望而生畏。\x3c\/p\x3e\n\x3cp\x3e资料地址：\x3ca href=\x22http:\/\/www.ecma-international.org\/ecma-262\/5.1\/Ecma-262.pdf\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.ecma-international...\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e任务\x3c\/h2\x3e\n\x3cp\x3e阅读 \x3ccode\x3eECMA262\x3c\/code\x3e 5.1 第10章 \x3ccode\x3eExecutable Code and Execution Contexts\x3c\/code\x3e (可执行代码与执行上下文)\x3cbr\x3e你能针对这章内容提出问题吗？ 即知道答案找出问题。\x3cbr\x3e你能使用图来更形象地表达文章内容吗？\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e开始我们的探险之旅\x3c\/h2\x3e\n\x3cp\x3e原汁原味 \x3ca href=\x22http:\/\/www.ecma-international.org\/ecma-262\/5.1\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eECMAScript 5.1 英文版\x3c\/a\x3e\x3cbr\x3e平易近人 \x3ca href=\x22https:\/\/www.w3.org\/html\/ig\/zh\/wiki\/ES5\/%E5%8F%AF%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E4%B8%8E%E6%89%A7%E8%A1%8C%E7%8E%AF%E5%A2%83\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eECMAScript 5.1 中文版\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e可执行代码类型\x3c\/h2\x3e\n\x3cblockquote\x3e\x3cp\x3e像 \x3ccode\x3ev8\x3c\/code\x3e 等 \x3ccode\x3eJavaScript\x3c\/code\x3e 引擎都是按照 \x3ccode\x3eecma-262\x3c\/code\x3e 的规范来实现的，\x3ccode\x3eJavaScript\x3c\/code\x3e 引擎在解释 \x3ccode\x3eJavaScript\x3c\/code\x3e 代码时，将可执行代码分为了三种。分别是：\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3e\x3cstrong\x3e全局代码\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22代码加载时首先进入的环境。\n例如加载外部的 JavaScript 文件或者本地 \x3cscript\x3e\x3c\/script\x3e 标签内的代码。\n但不包括任何 function 体内的代码。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e代码加载时首先进入的环境。\n例如加载外部的 JavaScript 文件或者本地 \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e 标签内的代码。\n但不包括任何 function 体内的代码。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e\x3cstrong\x3e 函数代码\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22是指作为 function 被解析的源代码。\n不包括作为其嵌套函数的 function 被解析的源代码。\n因为 JavaScript 函数中还可以嵌套函数，因此这也是三种可执行代码中最复杂的一种。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode\x3e是指作为 \x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3e被解析的源代码。\x3c\/span\x3e\n不包括作为其嵌套函数的 \x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3e被解析的源代码。\x3c\/span\x3e\n因为 JavaScript 函数中还可以嵌套函数，因此这也是三种可执行代码中最复杂的一种。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e\x3cstrong\x3e \x3ccode\x3eeval\x3c\/code\x3e代码\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22指的是传递给 eval 内置函数的代码。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs autoit\x22\x3e\x3ccode\x3e指的是传递给 \x3cspan class=\x22hljs-built_in\x22\x3eeval\x3c\/span\x3e 内置函数的代码。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e注：不了解 \x3ccode\x3eeval（string）\x3c\/code\x3e 的小伙伴，请参考 \x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/eval\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eeval() - JavaScript | MDN\x3c\/a\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e当 \x3ccode\x3eJavaScript\x3c\/code\x3e 引擎开始执行（进入）一段可执行代码之后，会生成一个执行环境（Execution Context)，或执行上下文。引擎用执行环境来维护执行当前代码所需要的变量声明、this指向等。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVWLdR?w=1544\x26amp;h=516\x22 src=\x22https:\/\/static.alili.tech\/img\/bVWLdR?w=1544\x26amp;h=516\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e词法环境 (Lexical Environments)\x3c\/h2\x3e\n\x3cp\x3e\x3ccode\x3e词法环境\x3c\/code\x3e 是执行环境的三个组成的状态之一。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3e官方解释：\x3c\/code\x3e词法环境是用来定义特定变量和函数标识符的。一个词法环境由一个\x3cstrong\x3e环境记录项\x3c\/strong\x3e和可能为空的\x3cstrong\x3e外部词法环境\x3c\/strong\x3e引用构成。\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3e通常词法环境会与 \x3ccode\x3eECMAScript\x3c\/code\x3e 代码诸如 \x3ccode\x3e函数声明（FunctionDeclaration）\x3c\/code\x3e、\x3ccode\x3eWithStatement\x3c\/code\x3e 或者 \x3ccode\x3eTryStatement\x3c\/code\x3e 的 \x3ccode\x3eCatch\x3c\/code\x3e 块这样的特定句法结构相联系，且类似代码每次执行都会\x3cstrong\x3e有一个新的词法环境\x3c\/strong\x3e被创建出来。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e外部词法环境引用\x3c\/strong\x3e 用于表示词法环境的逻辑嵌套关系模型。（内部）词法环境的外部引用是逻辑上包含内部词法环境的词法环境。外部词法环境自然也可能有多个内部词法环境。\x3c\/p\x3e\n\x3cp\x3e例如，如果一个 FunctionDeclaration 包含两个嵌套的 FunctionDeclaration，那么每个内嵌函数的词法环境都是外部函数本次执行所产生的词法环境。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e\x3cstrong\x3e环境记录项\x3c\/strong\x3e 又可以分为两种\x3cstrong\x3e声明式环境记录项\x3c\/strong\x3e和\x3cstrong\x3e对象式环境记录项\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e声明式环境记录项 用于标识标识符和\x3ccode\x3e函数声明\x3c\/code\x3e、\x3ccode\x3e变量声明\x3c\/code\x3e、\x3ccode\x3ecatch 语句\x3c\/code\x3e等语法元素的绑定。对象式环境记录项 主要用于定义那些将标识符与具体对象的属性绑定的语法元素。\x3c\/p\x3e\n\x3cp\x3e咬文嚼字，不好理解？\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3e通俗点讲：\x3c\/code\x3e 词法环境就是 JavaScript 引擎在执行代码过程中用来标识函数声明、变量声明这一类的。我们每次声明一个函数，或者使用 \x3ccode\x3ewith\x3c\/code\x3e 、\x3ccode\x3ecatch\x3c\/code\x3e语句的时候，就会有新的词法环境被创建出来。全局词法环境的外部词法环境就是空的，因为他已经是最外层的词法环境了。\x3c\/p\x3e\n\x3cp\x3e我们用个例子来说明词法环境：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var x = 10;\nfunction foo(y){\n    var z = 30;\n    function bar(q){\n        return x\x2by\x2bz\x2bq;\n    }\n    return bar;\n}\nvar bar = foo(20);\nbar(40);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e x = \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efoo\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ey\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e z = \x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ebar\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eq\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e x\x2by\x2bz\x2bq;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e bar;\n}\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e bar = foo(\x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e);\nbar(\x3cspan class=\x22hljs-number\x22\x3e40\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVWLfv?w=1858\x26amp;h=804\x22 src=\x22https:\/\/static.alili.tech\/img\/bVWLfv?w=1858\x26amp;h=804\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e词法环境的运算\x3c\/h3\x3e\n\x3cp\x3e给出一个标识符字符串，首先在当前的词法环境内寻找，如果存在，返回引用的标识符字符串，如果不存在，再在当前词法环境的外部词法环境寻找。\x3c\/p\x3e\n\x3cp\x3e咦，怎么感觉和作用域链的概念很相似？他们有什么关系吗？\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3e执行环境\x3c\/strong\x3e 当执行流进入一个函数时，函数的环境会被推入一个环境栈中。当函数执行之后，环境栈将其弹出，把控制权返回给之前的执行环境。\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3e作用域链\x3c\/strong\x3e 当代码在一个环境中执行时，会创建变量对象的一个作用域链。其用途是保证对执行环境有权访问的所有变量和函数的\x3cstrong\x3e有序访问\x3c\/strong\x3e。一个包含环境的变量对象到另一个包含环境的变量对象，最后到全局执行环境的变量对象。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e函数只要被创建，就会有自己的“地盘”，有自己的作用域。但是只有函数被执行的时候，才会有自己的执行环境。函数执行完毕的时候，执行环境就会退出。而且一个作用域下可能存在多个执行环境，比如闭包。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e小总结\x3c\/h3\x3e\n\x3cp\x3e1、词法环境分为了两部分：环境记录项和外部词法环境。\x3cbr\x3e2、环境记录项根据绑定的 ECMA 脚本元素的不同也分为了两部分。\x3cbr\x3e3、函数声明或者使用 \x3ccode\x3ewith\x3c\/code\x3e 、\x3ccode\x3ecatch\x3c\/code\x3e语句时，就会有新的词法环境被创建出来。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e执行环境（Execution Contexts）\x3c\/h2\x3e\n\x3cp\x3e如果我们的 \x3ccode\x3eJavaScript\x3c\/code\x3e 程序有各种函数，函数之间还有嵌套的情况，那 \x3ccode\x3eJavaScript\x3c\/code\x3e 引擎怎么解释各种声明和执行上下文哪？\x3c\/p\x3e\n\x3cp\x3e当控制器转入 \x3ccode\x3eECMA\x3c\/code\x3e 脚本的可执行代码时，上文已经说了有三种可执行代码，不管进入哪一种控制器都会进入一个执行环境。多个执行环境在逻辑上形成一个\x3cstrong\x3e栈结构\x3c\/strong\x3e。栈结构最顶层的执行环境称为当前运行的执行环境，最底层是全局执行环境。\x3c\/p\x3e\n\x3cp\x3e用一张图解释\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVVL6D?w=1138\x26amp;h=610\x22 src=\x22https:\/\/static.alili.tech\/img\/bVVL6D?w=1138\x26amp;h=610\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e因为 JS 引擎被实现为单线程，也就是同一时间只能发生一件事情，其他的行为就会依次排队。\x3c\/p\x3e\n\x3cp\x3e你可以有任意多个函数执行环境，每次调用函数创建一个新的执行环境，会创建一个私有作用域，函数内部声明的任何变量都不能在当前函数作用域外部直接访问。函数能访问当前执行环境外面的变量声明，但在外部执行环境不能访问内部的变量\/函数声明。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e小总结\x3c\/h3\x3e\n\x3cp\x3e关于执行栈（调用栈）\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22单线程。\n同步执行。\n一个全局上下文。\n无限制函数上下文。\n每次函数被调用创建新的执行上下文，包括调用自己。\nreturn 或者抛出异常退出一个执行环境。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e单线程。\n同步执行。\n一个全局上下文。\n无限制函数上下文。\n每次函数被调用创建新的执行上下文，包括调用自己。\n\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e 或者抛出异常退出一个执行环境。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们用一个具体的函数理解：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function foo(i) {\n  if (i \x3c 0) return;\n  console.log(\x27begin:\x27 \x2b i);\n  foo(i - 1);\n  console.log(\x27end:\x27 \x2b i);\n}\nfoo(2);\n\n\/\/ 输出:\n\n\/\/ begin:2\n\/\/ begin:1\n\/\/ begin:0\n\/\/ end:0\n\/\/ end:1\n\/\/ end:2\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efoo\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ei\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (i \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27begin:\x27\x3c\/span\x3e \x2b i);\n  foo(i - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27end:\x27\x3c\/span\x3e \x2b i);\n}\nfoo(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 输出:\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ begin:2\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ begin:1\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ begin:0\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ end:0\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ end:1\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ end:2\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVUK78?w=1958\x26amp;h=1246\x22 src=\x22https:\/\/static.alili.tech\/img\/bVUK78?w=1958\x26amp;h=1246\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e代码的执行流程进入内部函数，创建一个新的执行上下文并把它压入执行栈的顶部。\x3cstrong\x3e浏览器总会执行位于栈顶的执行上下文，一旦当前上下文函数执行结束，它将被从栈顶弹出，并将上下文控制权交给当前的栈。\x3c\/strong\x3e 这样，堆栈中的上下文就会被依次执行并且弹出堆栈，直到回到全局的上下文。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e执行环境包含所有用于追踪与其相关的代码的执行进度的状态。精确地说，每个执行环境包含如下表列出的组件。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e执行环境的三个状态\x3c\/p\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth\x3e组件\x3c\/th\x3e\n\x3cth\x3e作用目的\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd\x3e词法环境\x3c\/td\x3e\n\x3ctd\x3e指定一个词法环境对象，用于解析该执行环境内的代码创建的标识符引用。\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e变量环境\x3c\/td\x3e\n\x3ctd\x3e指定一个词法环境对象，其环境数据用于保存由该执行环境内的代码通过 变量表达式 和 函数表达式 创建的绑定。\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3ethis 绑定\x3c\/td\x3e\n\x3ctd\x3e指定该执行环境内的 \x3ccode\x3eECMA\x3c\/code\x3e 脚本代码中 \x3ccode\x3ethis\x3c\/code\x3e 关键字所关联的值。\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3cp\x3e当创建一个执行环境时，其词法环境组件和变量环境组件最初是同一个值。在该执行环境相关联的代码的执行过程中，变量环境组件永远不变，而词法环境组件有可能改变。变量环境的不变和词法环境的可能改变都是指引用的改变。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVWLdR?w=1544\x26amp;h=516\x22 src=\x22https:\/\/static.alili.tech\/img\/bVWLdR?w=1544\x26amp;h=516\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e建立执行环境\x3c\/h2\x3e\n\x3cblockquote\x3e\n\x3cp\x3e解释执行全局代码或使用 \x3ccode\x3eeval\x3c\/code\x3e 函数输入的代码会创建并进入一个新的执行环境。每次调用 \x3ccode\x3eECMA\x3c\/code\x3e 脚本代码定义的函数也会建立并进入一个新的执行环境，即便函数是自身递归调用的。\x3c\/p\x3e\n\x3cp\x3e每一次 \x3ccode\x3ereturn\x3c\/code\x3e 都会退出一个执行环境。抛出异常也可退出一个或多个执行环境。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e当控制流进入一个执行环境时，会设置该执行环境的 \x3ccode\x3ethis\x3c\/code\x3e 绑定组件，定义变量环境和初始词法环境，并执行声明式绑定初始化过程。\x3c\/strong\x3e以上这些步骤的严格执行方式由进入的代码的类型决定。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e进入全局代码\x3c\/h3\x3e\n\x3cp\x3e执行以下步骤：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x221、将变量环境设置为 全局环境 。 \n2、将词法环境设置为 全局环境 。\n3、将 this 绑定设置为 全局对象 。\n4、使用全局代码执行声明式绑定初始化化步骤。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lsl\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e、将变量环境设置为 全局环境 。 \n\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e、将词法环境设置为 全局环境 。\n\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e、将 this 绑定设置为 全局对象 。\n\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e、使用全局代码执行声明式绑定初始化化步骤。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e进入函数代码\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e当控制流根据一个函数对象 F、调用者提供的 \x3ccode\x3ethisArg\x3c\/code\x3e 以及调用者提供的 \x3ccode\x3eargumentList\x3c\/code\x3e，进入函数代码的执行环境时，执行以下步骤\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22如果函数代码是严格模式下的代码，设 this 绑定 为 thisArg。\n否则如果 thisArg 是 null 或 undefined，则设 this 绑定 为全局对象。\n否则如果 Type(thisArg) 的结果不为 Object，则设 this 绑定 为 ToObject(thisArg)。\n否则设 this 绑定 为 thisArg。\n以 F 的 [[Scope]] 内部属性为参数调用 NewDeclarativeEnvironment(新建声明式词法环境)，并令 localEnv 为调用的结果。\n设 词法环境组件 为 localEnv。\n设 变量环境组件 为 localEnv。\n令 code 为 F 的 [[Code]] 内部属性的值。\n使用函数代码 code 和 argumentList 执行声明式绑定初始化化步骤。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lua\x22\x3e\x3ccode\x3e如果函数代码是严格模式下的代码，设 this 绑定 为 thisArg。\n否则如果 thisArg 是 null 或 undefined，则设 this 绑定 为全局对象。\n否则如果 Type(thisArg) 的结果不为 Object，则设 this 绑定 为 ToObject(thisArg)。\n否则设 this 绑定 为 thisArg。\n以 F 的 \x3cspan class=\x22hljs-string\x22\x3e[[Scope]]\x3c\/span\x3e 内部属性为参数调用 NewDeclarativeEnvironment(新建声明式词法环境)，并令 localEnv 为调用的结果。\n设 词法环境组件 为 localEnv。\n设 变量环境组件 为 localEnv。\n令 code 为 F 的 \x3cspan class=\x22hljs-string\x22\x3e[[Code]]\x3c\/span\x3e 内部属性的值。\n使用函数代码 code 和 argumentList 执行声明式绑定初始化化步骤。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们用伪代码表示一下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if(是 严格模式) {\n    this = thisArg\n} else if(thisArg === null || thisArg === undefined) {\n    this = window\n} else if(typeof thisArg != \x27object\x27) {\n    this = Object(thisArg)\n} else {\n    this = thisArg\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(是 严格模式) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e = thisArg\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(thisArg === \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e || thisArg === \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e = \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e thisArg != \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e = \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e(thisArg)\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e = thisArg\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e哎，这里的 \x3ccode\x3ethisArg\x3c\/code\x3e 指的是什么？上文说了 \x3ccode\x3ethisArg\x3c\/code\x3e 来自于函数的调用者。\x3c\/p\x3e\n\x3cp\x3e这里代表函数的 \x3ccode\x3eapply\x3c\/code\x3e，\x3ccode\x3ecall\x3c\/code\x3e，\x3ccode\x3ebind\x3c\/code\x3e 等设置 \x3ccode\x3ethis\x3c\/code\x3e 绑定的参数：\x3c\/p\x3e\n\x3cp\x3e通过 \x3ccode\x3ecall\x3c\/code\x3e 或者 \x3ccode\x3eapply\x3c\/code\x3e 调用函数时，\x3ccode\x3ethisArg\x3c\/code\x3e 的值比较明显，为传入的第一个参数。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Function.prototype.apply (thisArg, argArray)\n\nFunction.prototype.call (thisArg [ , arg1 [ , arg2, … ] ] )\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs elm\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-type\x22\x3eFunction\x3c\/span\x3e.proto\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e.apply (thisArg, argArray)\n\n\x3cspan class=\x22hljs-type\x22\x3eFunction\x3c\/span\x3e.proto\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e.call (thisArg [ , arg1 [ , arg2, … ] ] )\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当然 \x3ccode\x3ethisArg\x3c\/code\x3e 还有其他的可能，具体的可以参考这篇文章 \x3ca href=\x22http:\/\/www.cnblogs.com\/Kingle\/p\/3281816.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJavascript this 解析\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e对上面的伪代码做一下解释：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e严格模式:\x3c\/strong\x3e 也就是说，在严格模式下，\x3ccode\x3ethis\x3c\/code\x3e 只能为 \x3ccode\x3ethisArg\x3c\/code\x3e，而当 \x3ccode\x3ethisArg\x3c\/code\x3e 为 \x3ccode\x3eundefined\x3c\/code\x3e 时，\x3ccode\x3ethis\x3c\/code\x3e 就是 \x3ccode\x3eundefined\x3c\/code\x3e ，而不是 \x3ccode\x3ewindow\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e非严格模式:\x3c\/strong\x3e 如果 \x3ccode\x3ethisArg\x3c\/code\x3e 是 \x3ccode\x3enull\x3c\/code\x3e (如 \x3ccode\x3efun.call(null)\x3c\/code\x3e) 或 \x3ccode\x3eundefined\x3c\/code\x3e （直接调用函数），则 \x3ccode\x3ethis\x3c\/code\x3e 为全局对象，浏览器里就是 \x3ccode\x3ewindow\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e否则，如果 传入了 \x3ccode\x3ethisArg\x3c\/code\x3e, 但不是个对象，则把它转为对象，并赋给 \x3ccode\x3ethis\x3c\/code\x3e，比如，当 \x3ccode\x3efun.call(\x27hhh\x27)\x3c\/code\x3e 时，打印 fun 内的 \x3ccode\x3ethis\x3c\/code\x3e 为\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22String {0: \x26quot;h\x26quot;, 1: \x26quot;h\x26quot;, 2: \x26quot;h\x26quot;, length: 3, [[PrimitiveValue]]: \x26quot;hhh\x26quot;}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lua\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eString {\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22h\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22h\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22h\x22\x3c\/span\x3e, length: \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e[[PrimitiveValue]]\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22hhh\x22\x3c\/span\x3e}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e否则 ，也就是仅剩的一种情况，显式的传入了一个对象作为 \x3ccode\x3ethisArg\x3c\/code\x3e 参数的情况下，设 \x3ccode\x3ethis\x3c\/code\x3e 绑定为 \x3ccode\x3ethisArg\x3c\/code\x3e。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader12\x22\x3e声明式绑定初始化\x3c\/h2\x3e\n\x3cp\x3e每个执行环境都有一个关联的 \x3ccode\x3e变量环境\x3c\/code\x3e。当在一个执行环境下评估一段 \x3ccode\x3eECMA\x3c\/code\x3e 脚本时，变量和函数定义会以绑定的形式添加到这个 \x3ccode\x3e变量环境\x3c\/code\x3e 的环境记录中。对于函数代码，参数也同样会以绑定的形式添加到这个 \x3ccode\x3e变量环境\x3c\/code\x3e 的环境记录中。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader13\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e\x3ccode\x3eECMAScript\x3c\/code\x3e 代码的执行由运行环境来完成。不同的运行环境可能采取不同的执行方式，但基本的流程是相同的。如浏览器在解析 \x3ccode\x3eHTML\x3c\/code\x3e 页面中遇到 \x3ccode\x3e\x26lt;script\x26gt;\x3c\/code\x3e 元素时，会下载对应的代码来运行，或直接执行内嵌的代码。代码的基本执行方式是从上到下，顺序执行。在调用函数之后，代码的执行会进入一个执行上下文之中。由于在一个函数的执行过程中会调用其他的函数，执行过程中的活动执行上下文会形成一个堆栈结构。在栈顶的是当前正在执行的代码。当函数返回时，会退出当前的执行上下文，而回到之前的执行上下文中。如果代码执行中出现异常，则可能从多个执行上下文中退出。\x3c\/p\x3e\n\x3cp\x3e在代码执行过程中很重要的一步是标识符的解析。比如当执行过程中遇到语句 \x3ccode\x3ealert(val)\x3c\/code\x3e 时，首先要做的是解析标识符 \x3ccode\x3eval\x3c\/code\x3e 的值。\x3ccode\x3eECMAScript\x3c\/code\x3e 不同于 \x3ccode\x3eJava\x3c\/code\x3e 和 \x3ccode\x3eC\/C\x2b\x2b\x3c\/code\x3e 等语言，在进行标识符解析时需要利用词法环境并与函数调用方式相关。具体来说，标识符解析由当前代码所对应的执行上下文来完成。为了描述标识符的解析过程，\x3ccode\x3eECMAScript\x3c\/code\x3e 规范中使用了词法环境的概念来进行描述。一个词法环境描述了标识符与变量或函数之间的对应关系。一个词法环境由两个部分组成：一部分是记录标识符与变量之间的绑定关系的环境记录，另一部分是包围当前词法环境的外部词法环境。环境记录可以看成是一个标识符与变量或函数之间的映射表。不同词法环境之间可以互相嵌套，而内部词法环境会持有一个包围它的外部词法环境的引用。在进行标识符解析时，如果当前词法环境中找不到标识符所对应的变量或函数，则使用外部词法环境来尝试解析。递归查找下去，直到解析成功或外部词法环境为 \x3ccode\x3enull\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e具体来说，根据标识符关联方式的不同，环境记录可以进一步分成两类。两种类型分别对应不同的 \x3ccode\x3eECMAScript\x3c\/code\x3e 中不同的语法结构。当使用这些语法结构时，会对环境记录中的内容产生影响，进而影响标识符的解析过程。第一类环境记录是声明式环境记录。顾名思义，声明式环境记录用来绑定 \x3ccode\x3eECMAScript\x3c\/code\x3e 代码中的变量声明。当使用 \x3ccode\x3evar\x3c\/code\x3e 声明变量或使用类似 \x3ccode\x3efunction func(){}\x3c\/code\x3e 的形式声明函数时，对应的变量或函数会被绑定到相应的环境记录中。另一类环境记录是对象环境记录。对象环境记录并不绑定具体的变量或函数，而是绑定另外一个对象中的属性。对象环境变量主要用来描述 \x3ccode\x3eECMAScript\x3c\/code\x3e 中 \x3ccode\x3ewith\x3c\/code\x3e 操作符的行为。\x3c\/p\x3e\n\x3cp\x3e每个执行上下文会对应两个不同的词法环境。一个是用来进行标识符解析的词法环境，可能随着代码的执行而发生变化；另外一个是包含执行上下文对应的作用域中的变量或函数声明的词法环境。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader14\x22\x3e提问\x3c\/h2\x3e\n\x3cp\x3e读完这篇文章，问问自己，能够回答下面的问题吗？\x3c\/p\x3e\n\x3cp\x3e1、ECMAScript 中可执行代码有几种？\x3cbr\x3e2、什么情况下会创建一个执行环境？\x3cbr\x3e3、什么情况下会退出一个执行环境？\x3cbr\x3e4、作用域链和执行环境的关系？\x3cbr\x3e5、执行环境的存在是为了解决什么？\x3cbr\x3e6、词法环境和变量环境的异同？\x3cbr\x3e7、this 的绑定的几种情况？\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader15\x22\x3e参考\x3c\/h2\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.w3.org\/html\/ig\/zh\/wiki\/ES5\/%E5%8F%AF%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E4%B8%8E%E6%89%A7%E8%A1%8C%E7%8E%AF%E5%A2%83#.E6.A0.87.E8.AF.86.E7.AC.A6.E8.A7.A3.E6.9E.90\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eES5\/可执行代码与执行环境\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/TomXu\/archive\/2012\/01\/13\/2308101.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e深入理解JavaScript系列（11）：执行上下文（Execution Contexts）\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22http:\/\/yanhaijing.com\/javascript\/2014\/04\/29\/what-is-the-execution-context-in-javascript\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e了解JavaScript的执行上下文\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000009041008\x22\x3e深入理解JavaScript执行上下文、函数堆栈、提升的概念\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22https:\/\/guxinyan.github.io\/2017\/01\/12\/%E5%85%B3%E4%BA%8Ejs%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%82%A3%E4%BA%9B%E4%BA%8B\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e关于js作用域那些事\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22http:\/\/blog.csdn.net\/zmhawk\/article\/details\/76013924\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e 从 ECMAScript 规范来看 JS 的 this 绑定规则\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22https:\/\/www.ibm.com\/developerworks\/cn\/web\/1305_chengfu_ecmascript5\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e深入探讨 ECMAScript 规范\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader16\x22\x3e推荐阅读\x3c\/h2\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/www.html5jscss.com\/js-data-scope.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJavaScript欲速则不达—通过解析过程了解JavaScript\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>由 ECMA 规范解读 Javascript 可执行上下文概念</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011105170">https://segmentfault.com/a/1190000011105170</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/kvm1l1mbytb/" target="_blank">https://alili.tech/archive/kvm1l1mbytb/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>