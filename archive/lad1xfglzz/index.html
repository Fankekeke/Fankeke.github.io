<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="[前端工坊]正则表达式-从模糊到清晰"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>[前端工坊]正则表达式-从模糊到清晰 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/lad1xfglzz/",
				"appid": "1613049289050283", 
				"title": "[前端工坊]正则表达式-从模糊到清晰 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-23T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/3o386jmynd8/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/rxnmpp4pjw/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2flad1xfglzz%2f&text=%5b%e5%89%8d%e7%ab%af%e5%b7%a5%e5%9d%8a%5d%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f-%e4%bb%8e%e6%a8%a1%e7%b3%8a%e5%88%b0%e6%b8%85%e6%99%b0"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2flad1xfglzz%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2flad1xfglzz%2f&text=%5b%e5%89%8d%e7%ab%af%e5%b7%a5%e5%9d%8a%5d%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f-%e4%bb%8e%e6%a8%a1%e7%b3%8a%e5%88%b0%e6%b8%85%e6%99%b0"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2flad1xfglzz%2f&title=%5b%e5%89%8d%e7%ab%af%e5%b7%a5%e5%9d%8a%5d%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f-%e4%bb%8e%e6%a8%a1%e7%b3%8a%e5%88%b0%e6%b8%85%e6%99%b0"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2flad1xfglzz%2f&is_video=false&description=%5b%e5%89%8d%e7%ab%af%e5%b7%a5%e5%9d%8a%5d%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f-%e4%bb%8e%e6%a8%a1%e7%b3%8a%e5%88%b0%e6%b8%85%e6%99%b0"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%5b%e5%89%8d%e7%ab%af%e5%b7%a5%e5%9d%8a%5d%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f-%e4%bb%8e%e6%a8%a1%e7%b3%8a%e5%88%b0%e6%b8%85%e6%99%b0&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2flad1xfglzz%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2flad1xfglzz%2f&title=%5b%e5%89%8d%e7%ab%af%e5%b7%a5%e5%9d%8a%5d%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f-%e4%bb%8e%e6%a8%a1%e7%b3%8a%e5%88%b0%e6%b8%85%e6%99%b0"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2flad1xfglzz%2f&title=%5b%e5%89%8d%e7%ab%af%e5%b7%a5%e5%9d%8a%5d%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f-%e4%bb%8e%e6%a8%a1%e7%b3%8a%e5%88%b0%e6%b8%85%e6%99%b0"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2flad1xfglzz%2f&title=%5b%e5%89%8d%e7%ab%af%e5%b7%a5%e5%9d%8a%5d%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f-%e4%bb%8e%e6%a8%a1%e7%b3%8a%e5%88%b0%e6%b8%85%e6%99%b0"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2flad1xfglzz%2f&title=%5b%e5%89%8d%e7%ab%af%e5%b7%a5%e5%9d%8a%5d%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f-%e4%bb%8e%e6%a8%a1%e7%b3%8a%e5%88%b0%e6%b8%85%e6%99%b0"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">[前端工坊]正则表达式-从模糊到清晰</h1><div class="meta"><div class="postdate"><time datetime="2018-12-23" itemprop="datePublished">2018-12-23</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3e文章来自微信公众号：前端工坊(fe_workshop)，不定期更新有趣、好玩的前端相关原创技术文章。  如果喜欢，请关注公众号：前端工坊\x3cbr\x3e版权归公众号所有，转载请注明出处。\x3cbr\x3e作者：京东商城-成都研究院-JSHOP研发部 卢兴元\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e正则表达式-从模糊到清晰\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e1. 什么是正则\x3c\/h3\x3e\n\x3cp\x3e简单点，正则是一些用来匹配和处理文本的字符串（或者叫工具），往往用于查找特定的信息（搜索），或者查找并编辑特定的信息（替换）。它是一种内置在其他语言里的一种“迷你”语言，比如内置在Javscript、Java等语言中。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e2. 要认可的事实\x3c\/h3\x3e\n\x3cp\x3e正则答案不唯一。几乎所有的问题，往往都会有不止一种解决方案。有的比较简单，有的比较快速，有点兼容性更好，有的功能更全。我们需要依据自己的需求，确认一种最适合自己的方案。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e3. 正则引擎概述\x3c\/h3\x3e\n\x3cp\x3e正则引擎可以分为2类。一种称之为NFA（非确定型有穷自动机），另一种称之为DFA（确定型又穷自动机）。嗯，概念不好理解，我们举个栗子：\x3cbr\x3e正则：\x3cstrong\x3eto(Jack|Rose|Jerry)\x3c\/strong\x3e\x3cbr\x3e匹配文本：\x3cstrong\x3exxx···toJerry\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch4\x3e1）NFA（表达式主导）匹配过程\x3c\/h4\x3e\n\x3cp\x3e正则表达式从正则的第一个\x3cstrong\x3e t \x3c\/strong\x3e开始，每次由正则引擎查看表达式的一部分，同时检查当前文本是否匹配表达式的当前部分。如果是，则继续表达式的下一部分，如果继续，直到表达式的所有部分都能匹配到。此时发现当检查到当前文本中的字符\x3cstrong\x3e t \x3c\/strong\x3e时，所以正则表达式的第一项匹配成功，接着会检查紧跟其后的字符是否能由\x3cstrong\x3e o \x3c\/strong\x3e来匹配，然后发现可以，则接着检查后面的元素，此时后面的元素是\x3cstrong\x3e (Jack|Rose|Jerry) \x3c\/strong\x3e，引擎会尝试着3种可能进行分别测试，直到匹配成功。\x3c\/p\x3e\n\x3ch4\x3e2）DFA（文本主导）匹配过程\x3c\/h4\x3e\n\x3cp\x3e引擎在扫码当前文本的时候，会记录当前有效的所有匹配可能。当引擎移动到文本的\x3cstrong\x3e t \x3c\/strong\x3e时，它会在当前处理的匹配可能中添加一个潜在的可能：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279476?w=474\x26amp;h=79\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279476?w=474\x26amp;h=79\x22 alt=\x22关键点1\x22 title=\x22关键点1\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e接下来扫描的每个字符，都会更新当前的可能匹配序列。例如扫码到匹配文本的\x3cstrong\x3e J \x3c\/strong\x3e时，有效的可能匹配变成了2个，Rose被淘汰出局。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279477?w=474\x26amp;h=79\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279477?w=474\x26amp;h=79\x22 alt=\x22关键点2\x22 title=\x22关键点2\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e扫描到匹配文本的\x3cstrong\x3e e \x3c\/strong\x3e时，Jack也被淘汰出局，此时就只剩一个可能的匹配了。当完成后续的rry的匹配时，整个匹配完成。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279478?w=474\x26amp;h=79\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279478?w=474\x26amp;h=79\x22 alt=\x22关键点3\x22 title=\x22关键点3\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e3）两句话点评NFA与DFA\x3c\/h4\x3e\n\x3cp\x3e1、DFA匹配速度快但特性少（比如不支持捕获组、反向引用），NFA匹配稍慢但能力强大；\x3cbr\x3e2、DFA就好比搭载电动发动机的汽车，加速度很快，但续航短，不能出远门，而NFA可以认为是汽油发动机的汽车，加速度没那么快，但是适应性广，哪里都能去，但由于适应性广，所以调教很重要。\x3c\/p\x3e\n\x3ch4\x3e4）需要注意的\x3c\/h4\x3e\n\x3cp\x3eJava、Javascript、PHP、Python这些都是NFA引擎。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e4. 过基础（老手请跳过）\x3c\/h3\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279479?w=447\x26amp;h=962\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279479?w=447\x26amp;h=962\x22 alt=\x22过基础\x22 title=\x22过基础\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e5. 要点讲解\x3c\/h3\x3e\n\x3ch4\x3e1）贪婪与懒惰\x3c\/h4\x3e\n\x3ch5\x3e贪婪模式：\x3c\/h5\x3e\n\x3cp\x3e尽可能匹配更多的字符。举个栗子：\x3cbr\x3e正则：\x3cstrong\x3e\x26lt;p\x26gt;.*\x26lt;\/p\x26gt;\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e结果：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279480?w=435\x26amp;h=301\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279480?w=435\x26amp;h=301\x22 alt=\x22贪婪模式\x22 title=\x22贪婪模式\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e从匹配过程我们也可以发现对于 \x3cstrong\x3e.\x3c\/strong\x3e* 这个表达式会尝试尽可能多的匹配字符，直到匹配到尽头，才尝试匹配正则结尾的 \x3cstrong\x3e\x26lt;\/p\x26gt;\x3c\/strong\x3e 。\x3c\/p\x3e\n\x3ch5\x3e懒惰模式：\x3c\/h5\x3e\n\x3cp\x3e与贪婪模式相反，尽可能匹配更少的字符。举个栗子：\x3cbr\x3e正则：\x3cstrong\x3e\x26lt;p\x26gt;.*?\x26lt;\/p\x26gt;\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e结果：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279481?w=416\x26amp;h=277\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279481?w=416\x26amp;h=277\x22 alt=\x22懒惰模式\x22 title=\x22懒惰模式\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e从匹配过程我们也可以发现，会优先匹配正则结尾的 \x3cstrong\x3e\x26lt;\/p\x26gt;\x3c\/strong\x3e ，在没有满足此结尾的情况下，才尽可能的去少匹配 \x3cstrong\x3e.*?\x3c\/strong\x3e 这个表达式。\x3c\/p\x3e\n\x3ch4\x3e2）子表达式与反向引用\x3c\/h4\x3e\n\x3ch5\x3e子表达式：\x3c\/h5\x3e\n\x3cp\x3e考虑这种场景，有些短语虽然由多个单词构成，但其实是一个整体，需要把它当做一个独立元素来使用，这种时候就需要使用子表达式。子表达式必须用()圆括号括起来。用途就是，可以精确的设定需要重复匹配的文本及重复次数。\x3c\/p\x3e\n\x3ch5\x3e反向引用：\x3c\/h5\x3e\n\x3cp\x3e它允许我们在正则中引用之前子表达式匹配到的结果。这有什么用？还是举个栗子：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e需求：匹配Html代码片段中的h1~h6标签\x3c\/strong\x3e\x3cbr\x3e正则：\x3cstrong\x3e\x26lt;h[1-6]\x26gt;.*?\x26lt;\/h[1-6]\x26gt;\x3c\/strong\x3e（没有使用反向引用）\x3c\/p\x3e\n\x3cp\x3e结果：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279482?w=341\x26amp;h=163\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279482?w=341\x26amp;h=163\x22 alt=\x22没有使用反向引用\x22 title=\x22没有使用反向引用\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e正则：\x3cstrong\x3e\x26lt;h([1-6])\x26gt;.*?\x26lt;\/h1\x26gt;\x3c\/strong\x3e（使用了反向引用）\x3c\/p\x3e\n\x3cp\x3e结果：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279483?w=341\x26amp;h=167\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279483?w=341\x26amp;h=167\x22 alt=\x22使用了反向引用\x22 title=\x22使用了反向引用\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e3）回溯\x3c\/h4\x3e\n\x3cp\x3eNFA引擎匹配能力强大，但是调教不好，有可能引发性能问题，它有另一个叫法，叫做\x3cstrong\x3e回溯失控\x3c\/strong\x3e。那么问题来了，什么是回溯？\x3c\/p\x3e\n\x3cp\x3e举个栗子：\x3cbr\x3e我们醒来的时候，突然发现被困在山洞里，这时候需要寻找出路，然而前方是一个岔路口。这个时候也并没有任何依据可以告诉我们哪一条是出路，只有挨个尝试，于是我们可以在岔路口做个标记，以便万一选择的这条路走不通，可以原路返回，直到遇见做了标记的岔路口，以便继续尝试另一条路是不是出路。我们可以把每次尝试失败然后往回走，找到之前做标记的地方的这个过程，称之为回溯。\x3cbr\x3e很多情况下，依据你写的正则表达式，正则引擎或多或少都需要进行这种2个或者多个选项的选择。\x3c\/p\x3e\n\x3ch4\x3e4）断言（环视）\x3c\/h4\x3e\n\x3cp\x3e先不做专业术语解释，先来看这么一个应用场景\x3cbr\x3e\x3cstrong\x3e需求：匹配网页里所有PC商品详情页地址所包含的sku信息\x3c\/strong\x3e\x3cbr\x3ePC商品详情页地址格式：\/\/item.jd.com\/xxxxxx.html\x3c\/p\x3e\n\x3ch5\x3e方法一：先正则匹配，再截断后面固定的.html\x3c\/h5\x3e\n\x3cp\x3e正则：\x3cstrong\x3e\/d\x2b\\.html\/g\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279483?w=341\x26amp;h=167\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279483?w=341\x26amp;h=167\x22 alt=\x22方法一\x22 title=\x22方法一\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch5\x3e方法二：先正则匹配，再截断前后固定的字符\x3c\/h5\x3e\n\x3cp\x3e正则：\x3cstrong\x3e\/item\\.jd\\.com\/d\x2b\\.html\/g\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279484?w=497\x26amp;h=295\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279484?w=497\x26amp;h=295\x22 alt=\x22方法二\x22 title=\x22方法二\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch5\x3e方法三：使用正向断言和反向断言，保证准确性，同时只返回sku数字\x3c\/h5\x3e\n\x3cp\x3e正则：\x3cstrong\x3e\/(?\x26lt;=item\\.jd\\.com\/)d\x2b(?=\\.html)\/g\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279485?w=515\x26amp;h=303\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279485?w=515\x26amp;h=303\x22 alt=\x22方法三\x22 title=\x22方法三\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch5\x3e断言分类：正向肯定断言、正向否定断言、反向肯定断言、反向否定断言\x3c\/h5\x3e\n\x3cp\x3e\x3cstrong\x3e需要注意的：Javascript不支持反向断言，Java也是有限制的支持反向断言\x3c\/strong\x3e\x3cbr\x3e总而言之，言而总之，当我们匹配目标关键字的时候，同时期望对目标关键字的前后进行限制，并且又不期望这些限制会出现在匹配结果中。这时候，就可以使用断言。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e6. 正则优化\x3c\/h3\x3e\n\x3ch4\x3e1）怎样才算是一个好正则\x3c\/h4\x3e\n\x3ch5\x3e准确性：只匹配期望的文本，排除掉不期望的文本\x3c\/h5\x3e\n\x3cp\x3e\x3cstrong\x3e需求：匹配jshop手机活动页url的域名部分\x3c\/strong\x3e\x3cbr\x3ejshop手机活动页URL格式：\/\/xxxx.jd.xxx\/m\/act\/xxxxxx.html\x3cbr\x3e正则：\x3cstrong\x3e\/\/\/(.*)(?=\/m)\/g\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279486?w=343\x26amp;h=149\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279486?w=343\x26amp;h=149\x22 alt=\x22优化前\x22 title=\x22优化前\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e正则：\x3cstrong\x3e\/\/\/(\x3csup id=\x22fnref-1\x22\x3e\x3ca href=\x22#fn-1\x22 class=\x22footnote-ref\x22\x3e1\x3c\/a\x3e\x3c\/sup\x3e*)\/g\x3c\/strong\x3e\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279487?w=340\x26amp;h=127\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279487?w=340\x26amp;h=127\x22 alt=\x22优化后\x22 title=\x22优化后\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e点评：如果不需要匹配\/，那就应该在正则表达式中作出这样的规定\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch5\x3e匹配效率：很快返回匹配结果，如果不能匹配，尽可能短的时间报告匹配失败\x3c\/h5\x3e\n\x3cp\x3e前面有提到过，NFA引擎功能强大，但是写不好很容易引发效率问题。其中太多的多选分支很容易成为效率杀手，因为任何多选分支只要匹配失败，都会导致回溯。所以提高正则匹配效率的方法之一就是减少多选分支。\x3c\/p\x3e\n\x3cp\x3e举个栗子：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e需求：匹配用户输入的一个字符串是否是一个4位IP里的一位，直白的说就是匹配0~255\x3c\/strong\x3e\x3cbr\x3e分析：可能有1位，也可能有2位，也可能有3位。3位的时候需要分开判断，当第一位是0或者1的时候，后面两位可以是任意数字。当第一位是2的时候，第二位只能是0-5。并且当第二位是0-4的时候，第三位可以是任意数字，但第二位是5的时候，第三位只能是0-5。\x3cbr\x3e翻译过来正则：\x3cstrong\x3e\/d|dd|[01]dd|2[0-4]d|25[0-5]\/\x3c\/strong\x3e\x3cbr\x3e合并同类项后：\x3cstrong\x3e\/[01]?dd?|2[0-4]d|25[0-5]\/\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e点评：可以通过合并同类项来减少多选分支。同时第一个多选分支使用的是 dd? 而不是 d?d ，这样如果根本不存在数字，NFA引擎会更快地报告失败\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch5\x3e易读性\x3c\/h5\x3e\n\x3cp\x3e……\x3c\/p\x3e\n\x3ch4\x3e2）使用工具\x3c\/h4\x3e\n\x3ch5\x3e分析正则表达式\x3c\/h5\x3e\n\x3cp\x3e比如这个网站 \x3ca href=\x22https:\/\/jex.im\/regulex\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/jex.im\/regulex\x3c\/a\x3e\x3cbr\x3e可以实现对复杂整个表达式的一个\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279488?w=585\x26amp;h=545\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279488?w=585\x26amp;h=545\x22 alt=\x22在线工具\x22 title=\x22在线工具\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch5\x3e测试正则表达式性能\x3c\/h5\x3e\n\x3cp\x3e比如这个猫头鹰工具 RegexBuddy\x3cbr\x3e可以用来测试正则表达式的匹配过程以及性能，包括各种语言下的正则特性支持情况。\x3c\/p\x3e\n\x3ch4\x3e3）优化手段\x3c\/h4\x3e\n\x3ch5\x3e优化方针：减少回溯\x3c\/h5\x3e\n\x3cp\x3e1、减少或者合并多选分支\x3cbr\x3e2、避免量词的嵌套\x3cbr\x3e3、占有优先量词。可以减少回溯，遗憾的是js不支持，但java支持。\x3cbr\x3e举个栗子：考虑到 \/a\x2bb\/ 和 \/a\x2b\x2bb\/ 两个正则，测试的字符串 aaaa\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279489?w=314\x26amp;h=262\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279489?w=314\x26amp;h=262\x22 alt=\x22没有使用占有量词\x22 title=\x22没有使用占有量词\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\/a\x2bb\/ 的匹配过程\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012279490?w=301\x26amp;h=176\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012279490?w=301\x26amp;h=176\x22 alt=\x22使用了占有量词\x22 title=\x22使用了占有量词\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\/a\x2b\x2bb\/ 的匹配过程\x3c\/p\x3e\n\x3cp\x3e4、使用正确的边界匹配器（^、$、b、B等），限定搜索字符串位置\x3cbr\x3e5、尽量不使用通配符\x22.\x22;字符使用具体的元字符、字符类（d、w、s等）（推荐）\x3cbr\x3e6、使用正确的量词（\x2b、*、?、{n,m}），如果能够限定长度，匹配最佳\x3cbr\x3e7、使用非捕获型括号。如果不需要引用括号内的文本，请使用非捕获型括号(?:……)，好处就是节省捕获时间，同时减少回溯使用的状态数量。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVU28g?w=900\x26amp;h=200\x22 src=\x22https:\/\/static.alili.tech\/img\/bVU28g?w=900\x26amp;h=200\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3chr\x3e\n\x3col\x3e\x3cli id=\x22fn-1\x22\x3e\/ \x3ca href=\x22#fnref-1\x22 class=\x22footnote-backref\x22\x3e↩\x3c\/a\x3e\n\x3c\/li\x3e\x3c\/ol\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>[前端工坊]正则表达式-从模糊到清晰</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000012279471">https://segmentfault.com/a/1190000012279471</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/lad1xfglzz/" target="_blank">https://alili.tech/archive/lad1xfglzz/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>