<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="了解HTML5中的MutationObserver"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>了解HTML5中的MutationObserver | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/laidwm0vxzr/",
				"appid": "1613049289050283", 
				"title": "了解HTML5中的MutationObserver | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-18T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/abnwylpv97s/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/t9oa70jpde/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2flaidwm0vxzr%2f&text=%e4%ba%86%e8%a7%a3HTML5%e4%b8%ad%e7%9a%84MutationObserver"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2flaidwm0vxzr%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2flaidwm0vxzr%2f&text=%e4%ba%86%e8%a7%a3HTML5%e4%b8%ad%e7%9a%84MutationObserver"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2flaidwm0vxzr%2f&title=%e4%ba%86%e8%a7%a3HTML5%e4%b8%ad%e7%9a%84MutationObserver"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2flaidwm0vxzr%2f&is_video=false&description=%e4%ba%86%e8%a7%a3HTML5%e4%b8%ad%e7%9a%84MutationObserver"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%ba%86%e8%a7%a3HTML5%e4%b8%ad%e7%9a%84MutationObserver&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2flaidwm0vxzr%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2flaidwm0vxzr%2f&title=%e4%ba%86%e8%a7%a3HTML5%e4%b8%ad%e7%9a%84MutationObserver"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2flaidwm0vxzr%2f&title=%e4%ba%86%e8%a7%a3HTML5%e4%b8%ad%e7%9a%84MutationObserver"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2flaidwm0vxzr%2f&title=%e4%ba%86%e8%a7%a3HTML5%e4%b8%ad%e7%9a%84MutationObserver"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2flaidwm0vxzr%2f&title=%e4%ba%86%e8%a7%a3HTML5%e4%b8%ad%e7%9a%84MutationObserver"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">了解HTML5中的MutationObserver</h1><div class="meta"><div class="postdate"><time datetime="2018-12-18" itemprop="datePublished">2018-12-18</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3eMutationObserver翻译过来就是变动观察器，字面上就可以理解这是用来观察Node（节点）变化的。MutationObserver是在DOM4规范中定义的，它的前身是MutationEvent事件，该事件最初在DOM2事件规范中介绍，到来了DOM3事件规范中正式定义，但是由于该事件存在兼容性以及性能上的问题被弃用。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader0\x22\x3eMutationEvent\x3c\/h3\x3e\n\x3cp\x3e虽然MutationEvent已经被弃用，但是我们还是需要了解它，可能你会为了浏览器兼容性的问题而遇到它（万恶的浏览器兼容性）。\x3c\/p\x3e\n\x3cp\x3eMutationEvent总共有7种事件：\x3cstrong\x3eDOMNodeInserted\x3c\/strong\x3e、\x3cstrong\x3eDOMNodeRemoved\x3c\/strong\x3e、\x3cstrong\x3eDOMSubtreeModified\x3c\/strong\x3e、\x3cstrong\x3eDOMAttrModified\x3c\/strong\x3e、\x3cbr\x3e\x3cstrong\x3eDOMCharacterDataModified\x3c\/strong\x3e、\x3cstrong\x3eDOMNodeInsertedIntoDocument\x3c\/strong\x3e和\x3cstrong\x3eDOMNodeRemovedFromDocument\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3eMutationEvent的兼容性：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3eMutationEvent在IE浏览器中最低支持到IE9\x3c\/li\x3e\n\x3cli\x3e在webkit内核的浏览器中，不支持\x3cstrong\x3eDOMAttrModified\x3c\/strong\x3e事件\x3c\/li\x3e\n\x3cli\x3eIE，Edge以及Firefox浏览器下不支持\x3cstrong\x3eDOMNodeInsertedIntoDocument\x3c\/strong\x3e和\x3cstrong\x3eDOMNodeRemovedFromDocument\x3c\/strong\x3e事件\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3eMutationEvent中的所有事件都被设计成无法取消，如果可以取消MutationEvent事件则会导致现有的DOM接口无法对文档进行改变，比如appendChild，remove等添加和删除节点的DOM操作。\x3cbr\x3eMutationEvent中最令人诟病的就是性能以及安全性的问题，比如下面这个例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22document.addEventListener(\x27DOMNodeInserted\x27, function() {\n    var newEl = document.createElement(\x27div\x27);\n    document.body.appendChild(newEl);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode\x3edocument.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27DOMNodeInserted\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3c\/span\x3e() {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eEl\x3c\/span\x3e = document.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e);\n    document.body.appendChild(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eEl\x3c\/span\x3e);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3edocument下的所有DOM添加操作都会触发DOMNodeInserted方法，这时就会出现循环调用DOMNodeInserted方法，导致浏览器崩溃。还有就是MutationEvent是事件机制，因此会有一般事件都存在的捕获和冒泡阶段，此时如果在捕获和冒泡阶段又对DOM进行了操作会拖慢浏览器的运行。\x3c\/p\x3e\n\x3cp\x3e另一点就是MutationEvent事件机制是同步的，也就是说每次DOM修改就会触发，修改几次就触发几次,严重降低浏览器的运行，严重时甚至导致线程崩溃\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv id=\x27block\x27\x3e\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs applescript\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eid\x3c\/span\x3e=\x27block\x27\x26gt;\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var i=0;\nblock.addEventListener(\x27DOMNodeInserted\x27, function(e) {\n     i\x2b\x2b                                  \n});\nblock.appendChild(docuemnt.createTextNode(\x271\x27));\nconsole.log(i)                  \/\/1\nblock.appendChild(docuemnt.createTextNode(\x272\x27));\nconsole.log(i)                  \/\/2\nblock.appendChild(docuemnt.createTextNode(\x273\x27));\nconsole.log(i)                  \/\/3\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs oxygene\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eblock\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27DOMNodeInserted\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(e)\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e{\n     i\x2b\x2b                                  \n}\x3c\/span\x3e);\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eblock\x3c\/span\x3e.appendChild(docuemnt.createTextNode(\x3cspan class=\x22hljs-string\x22\x3e\x271\x27\x3c\/span\x3e));\nconsole.log(i)                  \x3cspan class=\x22hljs-comment\x22\x3e\/\/1\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eblock\x3c\/span\x3e.appendChild(docuemnt.createTextNode(\x3cspan class=\x22hljs-string\x22\x3e\x272\x27\x3c\/span\x3e));\nconsole.log(i)                  \x3cspan class=\x22hljs-comment\x22\x3e\/\/2\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eblock\x3c\/span\x3e.appendChild(docuemnt.createTextNode(\x3cspan class=\x22hljs-string\x22\x3e\x273\x27\x3c\/span\x3e));\nconsole.log(i)                  \x3cspan class=\x22hljs-comment\x22\x3e\/\/3\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e再看个例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv id=\x27block\x27\x3e\n  \x3cspan id=\x27span\x27\x3eText\x3c\/span\x3e\n\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x27block\x27\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e\x26gt;\x3c\/span\x3eText\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22block.addEventListener(\x27DOMNodeInserted\x27, function(e) {\n     console.log(\x271\x27);                                  \/\/1\n});\nspan.appendChild(docuemnt.createTextNode(\x27other Text\x27));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3eblock.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27DOMNodeInserted\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n     \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x271\x27\x3c\/span\x3e);                                  \x3cspan class=\x22hljs-comment\x22\x3e\/\/1\x3c\/span\x3e\n});\nspan.appendChild(docuemnt.createTextNode(\x3cspan class=\x22hljs-string\x22\x3e\x27other Text\x27\x3c\/span\x3e));\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3espan元素中添加节点会触发block中的DOMNodeInserted事件，可是你只想观察block的变化，不想观察block中子节点的变化，这时你不得不在DOMNodeInserted事件中进行过滤，把对span的操作忽略掉，这无疑增加了操作的复杂性。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3eMutationObserver\x3c\/h3\x3e\n\x3cp\x3eMutationObserver的出现就是为了解决MutationEvent带来的问题。\x3cbr\x3e先看一下MutationObserver的浏览器兼容性：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV1NUJ?w=1257\x26amp;h=325\x22 src=\x22https:\/\/static.alili.tech\/img\/bV1NUJ?w=1257\x26amp;h=325\x22 alt=\x22MutationObserver浏览器兼容性\x22 title=\x22MutationObserver浏览器兼容性\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e我们可以看到MutationObserver在IE中最低要就是IE11，如果你的网站不需要支持IE或者只支持到IE11，那么你可以放心的使用MutationObserver，否则你可能需要用到上面提到的MutationEvent事件，当然如果你的网站还要支持IE8及以下版本，那么你只能和Mutation说拜拜了。\x3c\/p\x3e\n\x3cp\x3eMutationObserver是一个构造器，接受一个callback参数，用来处理节点变化的回调函数，返回两个参数，mutations：节点变化记录列表（sequence\x26lt;MutationRecord\x26gt;），observer：构造MutationObserver对象。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var observe = new MutationObserver(function(mutations,observer){\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e observe = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e MutationObserver(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(mutations,observer)\x3c\/span\x3e\x3c\/span\x3e{\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eMutationObserver对象有三个方法，分别如下：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3cstrong\x3eobserve\x3c\/strong\x3e：设置观察目标，接受两个参数，target：观察目标，options：通过对象成员来设置观察选项\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3edisconnect\x3c\/strong\x3e：阻止观察者观察任何改变\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3etakeRecords\x3c\/strong\x3e：清空记录队列并返回里面的内容\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e关于observe方法中options参数有已下几个选项：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3cstrong\x3echildList\x3c\/strong\x3e：设置true，表示观察目标子节点的变化，比如添加或者删除目标子节点，不包括修改子节点以及子节点后代的变化\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eattributes\x3c\/strong\x3e：设置true，表示观察目标属性的改变\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3echaracterData\x3c\/strong\x3e：设置true，表示观察目标数据的改变\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3esubtree\x3c\/strong\x3e：设置为true，目标以及目标的后代改变都会观察\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eattributeOldValue\x3c\/strong\x3e：如果属性为true或者省略，则相当于设置为true，表示需要记录改变前的目标属性值，设置了attributeOldValue可以省略attributes设置\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3echaracterDataOldValue\x3c\/strong\x3e：如果characterData为true或省略，则相当于设置为true,表示需要记录改变之前的目标数据，设置了characterDataOldValue可以省略characterData设置\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eattributeFilter\x3c\/strong\x3e：如果不是所有的属性改变都需要被观察，并且attributes设置为true或者被忽略，那么设置一个需要观察的属性本地名称（不需要命名空间）的列表\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e下表描述了MutationObserver选项与MutationEvent名称之间的对应关系：\x3c\/p\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth\x3eMutationEvent\x3c\/th\x3e\n\x3cth\x3eMutationObserver options\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd\x3eDOMNodeInserted\x3c\/td\x3e\n\x3ctd\x3e{ childList: true, subtree: true }\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eDOMNodeRemoved\x3c\/td\x3e\n\x3ctd\x3e{ childList: true, subtree: true }\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eDOMSubtreeModified\x3c\/td\x3e\n\x3ctd\x3e{ childList: true, subtree: true }\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eDOMAttrModified\x3c\/td\x3e\n\x3ctd\x3e{ attributes: true, subtree: true }\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eDOMCharacterDataModified\x3c\/td\x3e\n\x3ctd\x3e{ characterData: true, subtree: true }\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3cp\x3e从上表我们也可以看出相比与MutationEvent而言MutationObserver极大地增加了灵活性，可以设置各种各样的选项来满足程序员对目标的观察。\x3c\/p\x3e\n\x3cp\x3e我们简单看几个例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv id=\x27target\x27 class=\x27block\x27 name=\x27target\x27\x3e\n    target的第一个子节点\n    \x3cp\x3e\n       \x3cspan\x3etarget的后代\x3c\/span\x3e\n    \x3c\/p\x3e\n\x3c\/div\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x27target\x27\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x27block\x27\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x27target\x27\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    target的第一个子节点\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n       \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3etarget的后代\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e1.callback的回调次数\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var target=document.getElementById(\x27target\x27);\nvar i=0\nvar observe=new MutationObserver(function (mutations,observe) {\n    i\x2b\x2b   \n});\nobserve.observe(target,{ childList: true});\ntarget.appendChild(docuemnt.createTextNode(\x271\x27));\ntarget.appendChild(docuemnt.createTextNode(\x272\x27));\ntarget.appendChild(docuemnt.createTextNode(\x273\x27));\nconsole.log(i)                \/\/1\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e target=\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27target\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e observe=\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e MutationObserver(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3emutations,observe\x3c\/span\x3e) \x3c\/span\x3e{\n    i\x2b\x2b   \n});\nobserve.observe(target,{ \x3cspan class=\x22hljs-attr\x22\x3echildList\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e});\ntarget.appendChild(docuemnt.createTextNode(\x3cspan class=\x22hljs-string\x22\x3e\x271\x27\x3c\/span\x3e));\ntarget.appendChild(docuemnt.createTextNode(\x3cspan class=\x22hljs-string\x22\x3e\x272\x27\x3c\/span\x3e));\ntarget.appendChild(docuemnt.createTextNode(\x3cspan class=\x22hljs-string\x22\x3e\x273\x27\x3c\/span\x3e));\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(i)                \x3cspan class=\x22hljs-comment\x22\x3e\/\/1\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eMutationObserver的callback回调函数是异步的，只有在全部DOM操作完成之后才会调用callback。\x3c\/p\x3e\n\x3cp\x3e2.当只设置{ childList: true}时,表示观察目标子节点的变化\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var observe=new MutationObserver(function (mutations,observe) {\n    debugger;\n    console.log(mutations);\n    \/\/observe.discount();     \n});\n\nobserve.observe(target,{ childList: true});\ntarget.appendChild(document.createTextNode(\x27新增Text节点\x27));   \/\/增加节点，观察到变化\ntarget.childNodes[0].remove();                                \/\/删除节点，可以观察到\ntarget.childNodes[0].textContent=\x27改变子节点的后代\x27;             \/\/不会观察到\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e observe=\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e MutationObserver(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3emutations,observe\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3edebugger\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(mutations);\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/observe.discount();     \x3c\/span\x3e\n});\n\nobserve.observe(target,{ \x3cspan class=\x22hljs-attr\x22\x3echildList\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e});\ntarget.appendChild(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createTextNode(\x3cspan class=\x22hljs-string\x22\x3e\x27新增Text节点\x27\x3c\/span\x3e));   \x3cspan class=\x22hljs-comment\x22\x3e\/\/增加节点，观察到变化\x3c\/span\x3e\ntarget.childNodes[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].remove();                                \x3cspan class=\x22hljs-comment\x22\x3e\/\/删除节点，可以观察到\x3c\/span\x3e\ntarget.childNodes[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].textContent=\x3cspan class=\x22hljs-string\x22\x3e\x27改变子节点的后代\x27\x3c\/span\x3e;             \x3cspan class=\x22hljs-comment\x22\x3e\/\/不会观察到\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果想要观察到子节点以及后代的变化需设置{childList: true, subtree: true}\x3c\/p\x3e\n\x3cp\x3eattributes选项用来观察目标属性的变化，用法类似与childList,目标属性的删除添加以及修改都会被观察到。\x3c\/p\x3e\n\x3cp\x3e3.我们需要注意的是characterData这个选项，它是用来观察CharacterData类型的节点的，只有在改变节点数据时才会观察到，如果你删除或者增加节点都不会进行观察，还有如果对不是CharacterData类型的节点的改变不会观察到，比如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22observe.observe(target,{ characterData: true, subtree: true});\ntarget.childNodes[0].textContent=\x27改变Text节点\x27;              \/\/观察到\ntarget.childNodes[1].textContent=\x27改变p元素内容\x27;              \/\/不会观察到\ntarget.appendChild(document.createTextNode(\x27新增Text节点\x27));  \/\/不会观察到\ntarget.childNodes[0].remove();                               \/\/删除TEXT节点也不会观察到\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs aspectj\x22\x3e\x3ccode\x3eobserve.observe(\x3cspan class=\x22hljs-keyword\x22\x3etarget\x3c\/span\x3e,{ characterData: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e, subtree: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e});\n\x3cspan class=\x22hljs-keyword\x22\x3etarget\x3c\/span\x3e.childNodes[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].textContent=\x3cspan class=\x22hljs-string\x22\x3e\x27改变Text节点\x27\x3c\/span\x3e;              \x3cspan class=\x22hljs-comment\x22\x3e\/\/观察到\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etarget\x3c\/span\x3e.childNodes[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e].textContent=\x3cspan class=\x22hljs-string\x22\x3e\x27改变p元素内容\x27\x3c\/span\x3e;              \x3cspan class=\x22hljs-comment\x22\x3e\/\/不会观察到\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etarget\x3c\/span\x3e.appendChild(document.createTextNode(\x3cspan class=\x22hljs-string\x22\x3e\x27新增Text节点\x27\x3c\/span\x3e));  \x3cspan class=\x22hljs-comment\x22\x3e\/\/不会观察到\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3etarget\x3c\/span\x3e.childNodes[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].remove();                               \x3cspan class=\x22hljs-comment\x22\x3e\/\/删除TEXT节点也不会观察到\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们只需要记住只有对CharacterData类型的节点的数据改变才会被characterData为true的选项所观察到。\x3c\/p\x3e\n\x3cp\x3e4.最后关注一个特别有用的选项attributeFilter，这个选项主要是用来筛选要观察的属性，比如你只想观察目标style属性的变化，这时可以如下设置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22observe.observe(target,{ attributeFilter: [\x27style\x27], subtree: true});\ntarget.style=\x27color:red\x27;                      \/\/可以观察到\ntarget.removeAttribute(\x27name\x27);                \/\/删除name属性，无法观察到 \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3eobserve.observe(target,{ \x3cspan class=\x22hljs-string\x22\x3eattributeFilter:\x3c\/span\x3e [\x3cspan class=\x22hljs-string\x22\x3e\x27style\x27\x3c\/span\x3e], \x3cspan class=\x22hljs-string\x22\x3esubtree:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e});\ntarget.style=\x3cspan class=\x22hljs-string\x22\x3e\x27color:red\x27\x3c\/span\x3e;                      \x3cspan class=\x22hljs-comment\x22\x3e\/\/可以观察到\x3c\/span\x3e\ntarget.removeAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x27name\x27\x3c\/span\x3e);                \x3cspan class=\x22hljs-comment\x22\x3e\/\/删除name属性，无法观察到 \x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3edisconnect方法是用来阻止观察的，当你不再想观察目标节点的变化时可以调用observe.disconnect()方法来取消观察。\x3c\/p\x3e\n\x3cp\x3etakeRecords方法是用来取出记录队列中的记录。它的一个作用是，比如你对一个节点的操作你不想马上就做出反应，过段时间在显示改变了节点的内容。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var observe=new MutationObserver(function(){});\nobserve.observe(target,{ childList: true});\ntarget.appendChild(document.createTextNode(\x27新增Text节点\x27));\nvar record = observe.takeRecords();              \/\/此时record保存了改变记录列表  \n\/\/当调用takeRecords方法时，记录队列被清空因此不会触发MutationObserver中的callback回调方法。\ntarget.appendChild(document.createElement(\x27span\x27));\nobserve.disconnect();                            \/\/停止对target的观察。\n\/\/MutationObserver中的回调函数只有一个记录，只记录了新增span元素\n\n\/\/之后可以对record进行操作\n\/\/...\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e observe=\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e MutationObserver(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{});\nobserve.observe(target,{ \x3cspan class=\x22hljs-attr\x22\x3echildList\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e});\ntarget.appendChild(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createTextNode(\x3cspan class=\x22hljs-string\x22\x3e\x27新增Text节点\x27\x3c\/span\x3e));\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e record = observe.takeRecords();              \x3cspan class=\x22hljs-comment\x22\x3e\/\/此时record保存了改变记录列表  \x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/当调用takeRecords方法时，记录队列被清空因此不会触发MutationObserver中的callback回调方法。\x3c\/span\x3e\ntarget.appendChild(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e));\nobserve.disconnect();                            \x3cspan class=\x22hljs-comment\x22\x3e\/\/停止对target的观察。\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/MutationObserver中的回调函数只有一个记录，只记录了新增span元素\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/之后可以对record进行操作\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/...\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3eMutationRecord\x3c\/strong\x3e\x3cbr\x3e变动记录中的属性如下：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3cstrong\x3etype\x3c\/strong\x3e：如果是属性变化，返回\x22attributes\x22，如果是一个CharacterData节点（Text节点、Comment节点）变化，返回\x22characterData\x22，节点树变化返回\x22childList\x22\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3etarget\x3c\/strong\x3e：返回影响改变的节点\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eaddedNodes\x3c\/strong\x3e：返回添加的节点列表\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eremovedNodes\x3c\/strong\x3e：返回删除的节点列表\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3epreviousSibling\x3c\/strong\x3e：返回分别添加或删除的节点的上一个兄弟节点，否则返回null\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3enextSibling\x3c\/strong\x3e：返回分别添加或删除的节点的下一个兄弟节点，否则返回null\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eattributeName\x3c\/strong\x3e：返回已更改属性的本地名称，否则返回null\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eattributeNamespace\x3c\/strong\x3e：返回已更改属性的名称空间，否则返回null\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eoldValue\x3c\/strong\x3e：返回值取决于type。对于\x22attributes\x22，它是更改之前的属性的值。对于\x22characterData\x22，它是改变之前节点的数据。对于\x22childList\x22，它是null\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e其中 \x3cstrong\x3etype\x3c\/strong\x3e、\x3cstrong\x3etarget\x3c\/strong\x3e这两个属性不管是哪种观察方式都会有返回值，其他属性返回值与观察方式有关，比如只有当attributeOldValue或者characterDataOldValue为true时oldValue才有返回值，只有改变属性时，attributeName才有返回值等。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>了解HTML5中的MutationObserver</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000012787829">https://segmentfault.com/a/1190000012787829</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/laidwm0vxzr/" target="_blank">https://alili.tech/archive/laidwm0vxzr/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>