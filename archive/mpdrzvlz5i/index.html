<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="vue前端(element-ui)，express后端实现上传图片到七牛云"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>vue前端(element-ui)，express后端实现上传图片到七牛云 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/mpdrzvlz5i/",
				"appid": "1613049289050283", 
				"title": "vue前端(element-ui)，express后端实现上传图片到七牛云 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-07T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/3w59e8qhrcu/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/n9ue7bxtc5s/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fmpdrzvlz5i%2f&text=vue%e5%89%8d%e7%ab%af%28element-ui%29%ef%bc%8cexpress%e5%90%8e%e7%ab%af%e5%ae%9e%e7%8e%b0%e4%b8%8a%e4%bc%a0%e5%9b%be%e7%89%87%e5%88%b0%e4%b8%83%e7%89%9b%e4%ba%91"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fmpdrzvlz5i%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fmpdrzvlz5i%2f&text=vue%e5%89%8d%e7%ab%af%28element-ui%29%ef%bc%8cexpress%e5%90%8e%e7%ab%af%e5%ae%9e%e7%8e%b0%e4%b8%8a%e4%bc%a0%e5%9b%be%e7%89%87%e5%88%b0%e4%b8%83%e7%89%9b%e4%ba%91"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fmpdrzvlz5i%2f&title=vue%e5%89%8d%e7%ab%af%28element-ui%29%ef%bc%8cexpress%e5%90%8e%e7%ab%af%e5%ae%9e%e7%8e%b0%e4%b8%8a%e4%bc%a0%e5%9b%be%e7%89%87%e5%88%b0%e4%b8%83%e7%89%9b%e4%ba%91"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fmpdrzvlz5i%2f&is_video=false&description=vue%e5%89%8d%e7%ab%af%28element-ui%29%ef%bc%8cexpress%e5%90%8e%e7%ab%af%e5%ae%9e%e7%8e%b0%e4%b8%8a%e4%bc%a0%e5%9b%be%e7%89%87%e5%88%b0%e4%b8%83%e7%89%9b%e4%ba%91"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=vue%e5%89%8d%e7%ab%af%28element-ui%29%ef%bc%8cexpress%e5%90%8e%e7%ab%af%e5%ae%9e%e7%8e%b0%e4%b8%8a%e4%bc%a0%e5%9b%be%e7%89%87%e5%88%b0%e4%b8%83%e7%89%9b%e4%ba%91&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fmpdrzvlz5i%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fmpdrzvlz5i%2f&title=vue%e5%89%8d%e7%ab%af%28element-ui%29%ef%bc%8cexpress%e5%90%8e%e7%ab%af%e5%ae%9e%e7%8e%b0%e4%b8%8a%e4%bc%a0%e5%9b%be%e7%89%87%e5%88%b0%e4%b8%83%e7%89%9b%e4%ba%91"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fmpdrzvlz5i%2f&title=vue%e5%89%8d%e7%ab%af%28element-ui%29%ef%bc%8cexpress%e5%90%8e%e7%ab%af%e5%ae%9e%e7%8e%b0%e4%b8%8a%e4%bc%a0%e5%9b%be%e7%89%87%e5%88%b0%e4%b8%83%e7%89%9b%e4%ba%91"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fmpdrzvlz5i%2f&title=vue%e5%89%8d%e7%ab%af%28element-ui%29%ef%bc%8cexpress%e5%90%8e%e7%ab%af%e5%ae%9e%e7%8e%b0%e4%b8%8a%e4%bc%a0%e5%9b%be%e7%89%87%e5%88%b0%e4%b8%83%e7%89%9b%e4%ba%91"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fmpdrzvlz5i%2f&title=vue%e5%89%8d%e7%ab%af%28element-ui%29%ef%bc%8cexpress%e5%90%8e%e7%ab%af%e5%ae%9e%e7%8e%b0%e4%b8%8a%e4%bc%a0%e5%9b%be%e7%89%87%e5%88%b0%e4%b8%83%e7%89%9b%e4%ba%91"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">vue前端(element-ui)，express后端实现上传图片到七牛云</h1><div class="meta"><div class="postdate"><time datetime="2018-12-07" itemprop="datePublished">2018-12-07</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e看了几天七牛云nodejs的SDK文档，现在尝试写一个上传文件到七牛云的demo，不足之处请各位大佬指正！\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e实现思路\x3c\/h2\x3e\n\x3cblockquote\x3e模拟前后端分离，后端向前端发送七牛云的上传凭证token，前端获得凭证后将图片上传到七牛云，并获得返回的图片url地址\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e步骤\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e1.需要些什么？\x3c\/h3\x3e\n\x3cp\x3e既然要上传文件到七牛云，那我们至少需要一个七牛云空间啊\x3c\/p\x3e\n\x3cblockquote\x3e注册一个七牛云账号，然后绑定支付宝认证一下就OK了\x3c\/blockquote\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV7tii?w=880\x26amp;h=424\x22 src=\x22https:\/\/static.alili.tech\/img\/bV7tii?w=880\x26amp;h=424\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e完成之后先创建一个对象储存空间，名字随意\x3c\/blockquote\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV7tjk?w=566\x26amp;h=283\x22 src=\x22https:\/\/static.alili.tech\/img\/bV7tjk?w=566\x26amp;h=283\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e重点来了，这里有几项是要用到的\x3cbr\x3e1、 空间名称bucket, 我这里就是 lytton\x3cbr\x3e2、 SK 和 AK ,在控制面板的密匙管理\x3cbr\x3e3、 储存空间的外链域名，在储存空间可以找到\x3c\/blockquote\x3e\n\x3cp\x3eAK 和 SK\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV7tlh?w=677\x26amp;h=429\x22 src=\x22https:\/\/static.alili.tech\/img\/bV7tlh?w=677\x26amp;h=429\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e外链域名\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV7tmb?w=682\x26amp;h=369\x22 src=\x22https:\/\/static.alili.tech\/img\/bV7tmb?w=682\x26amp;h=369\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e2、写后端代码\x3c\/h3\x3e\n\x3cblockquote\x3e既然选择使用vue，那就直接用vue-cli创建项目了\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22vue init webpack qiniuupload\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ebnf\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-attribute\x22\x3evue init webpack qiniuupload\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e├── build\x3cbr\x3e├── config\x3cbr\x3e├── index.html\x3cbr\x3e├── node_modules\x3cbr\x3e├── package.json\x3cbr\x3e├── README.md\x3cbr\x3e├── src\x3cbr\x3e└── static\x3c\/p\x3e\n\x3cblockquote\x3e因为要用到后端，所以在src 目录里面创建一个server来当后端，一个client来当前端用\x3c\/blockquote\x3e\n\x3cp\x3elytton@lytton-ubuntu:~\/桌面\/demo\/qiniuupload\/src$ tree -L 1\x3cbr\x3e.\x3cbr\x3e├── App.vue\x3cbr\x3e├── client\x3cbr\x3e├── main.js\x3cbr\x3e├── router\x3cbr\x3e└── server\x3c\/p\x3e\n\x3cp\x3e然后在server目录下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm init\nnpm i express qiniu --save\n\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3enpm\x3c\/span\x3e init\n\x3cspan class=\x22hljs-built_in\x22\x3enpm\x3c\/span\x3e i express qiniu --save\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e当然这个server的作用很简单，就只做一件事，当前端请求要上传图片到七牛云的时候，像前端发送一个上传凭证的token\x3c\/blockquote\x3e\n\x3cp\x3e创建后端程序app.js\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 引入包\nconst express = require(\x27express\x27)\nconst bodyparse = require(\x27body-parser\x27)\n\/\/ 创建服务\nconst app = express()\n\/\/ 解析数据\napp.use(bodyparse.json())\n\/\/ 引入七牛云配置\nconst qnconfig = require(\x27.\/config.js\x27)\n\/\/ 处理请求\napp.get(\x27\/token\x27, (req, res, next) =\x3e {\n  \/\/ console.log(qnconfig.uploadToken)\n  res.status(200).send(qnconfig.uploadToken)\n})\n\/\/ 监听3000端口\napp.listen(3000, () =\x3e {\n  console.log(\x27this server are running on localhost:3000!\x27)\n})\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 引入包\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e express = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27express\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e bodyparse = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27body-parser\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建服务\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e app = express()\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 解析数据\x3c\/span\x3e\napp.use(bodyparse.json())\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 引入七牛云配置\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e qnconfig = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/config.js\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 处理请求\x3c\/span\x3e\napp.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/token\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res, next\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ console.log(qnconfig.uploadToken)\x3c\/span\x3e\n  res.status(\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e).send(qnconfig.uploadToken)\n})\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 监听3000端口\x3c\/span\x3e\napp.listen(\x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27this server are running on localhost:3000!\x27\x3c\/span\x3e)\n})\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e创建config.js以用来生成上传凭证\x3c\/p\x3e\n\x3cblockquote\x3e这里就需要用到上面的bucket ,AK,SK\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/*\n七牛云配置\n*\/\nconst qiniu = require(\x27qiniu\x27)\n\n\/\/ 创建上传凭证\nconst accessKey = \x27YOXpF0XvM_3yVDsz5C-hWwrFE5rtDAUQC3XjBQEG\x27\nconst secretKey = \x27CmrhUV2xHf1d8nPCsws9wwm7jKypCPA0lRVm-7lS\x27\nconst mac = new qiniu.auth.digest.Mac(accessKey, secretKey)\nconst options = {\n  scope: \x27lytton\x27,\n  expires: 7200\n}\nconst putPolicy = new qiniu.rs.PutPolicy(options)\nconst uploadToken = putPolicy.uploadToken(mac)\n\nmodule.exports = {\n  uploadToken\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs java\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/*\n七牛云配置\n*\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e qiniu = require(\x3cspan class=\x22hljs-string\x22\x3e\x27qiniu\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建上传凭证\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e accessKey = \x3cspan class=\x22hljs-string\x22\x3e\x27YOXpF0XvM_3yVDsz5C-hWwrFE5rtDAUQC3XjBQEG\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e secretKey = \x3cspan class=\x22hljs-string\x22\x3e\x27CmrhUV2xHf1d8nPCsws9wwm7jKypCPA0lRVm-7lS\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e mac = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e qiniu.auth.digest.Mac(accessKey, secretKey)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e options = {\n  scope: \x3cspan class=\x22hljs-string\x22\x3e\x27lytton\x27\x3c\/span\x3e,\n  expires: \x3cspan class=\x22hljs-number\x22\x3e7200\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e putPolicy = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e qiniu.rs.PutPolicy(options)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e uploadToken = putPolicy.uploadToken(mac)\n\n\x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3eexports\x3c\/span\x3e = {\n  uploadToken\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eserver的目录结构\x3c\/p\x3e\n\x3cp\x3elytton@lytton-ubuntu:~\/桌面\/demo\/qiniuupload\/src\/server$ tree -L 1\x3cbr\x3e.\x3cbr\x3e├── app.js\x3cbr\x3e├── config.js\x3cbr\x3e├── node_modules\x3cbr\x3e└── package.json\x3c\/p\x3e\n\x3cp\x3e然后控制台 nodemon app.js，当然如果没装nodemon的话，就 node app.js 一样的\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV7ty8?w=654\x26amp;h=112\x22 src=\x22https:\/\/static.alili.tech\/img\/bV7ty8?w=654\x26amp;h=112\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e打开浏览器 localhost:3000\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV7tz8?w=418\x26amp;h=139\x22 src=\x22https:\/\/static.alili.tech\/img\/bV7tz8?w=418\x26amp;h=139\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e然后服务端就不用管了\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e3、写前端代码\x3c\/h3\x3e\n\x3cp\x3e首先在根目录安装element-ui axios\x3c\/p\x3e\n\x3cp\x3e然后在main.js里面引入\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV7tCI?w=1103\x26amp;h=551\x22 src=\x22https:\/\/static.alili.tech\/img\/bV7tCI?w=1103\x26amp;h=551\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e然后在client文件夹下面创建一个upload.vue\x3cbr\x3e并在router里面引入\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import Vue from \x27vue\x27\nimport Router from \x27vue-router\x27\nimport UpLoad from \x27@\/client\/upload\x27\n\nVue.use(Router)\n\nexport default new Router({\n  routes: [\n    {\n      path: \x27\/\x27,\n      component: UpLoad\n    }\n  ]\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Vue \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vue\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Router \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vue-router\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e UpLoad \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27@\/client\/upload\x27\x3c\/span\x3e\n\nVue.use(Router)\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Router({\n  routes: [\n    {\n      path: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e,\n      component: UpLoad\n    }\n  ]\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e到这里整体结构也就完成了，src 的目录结构\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22lytton@lytton-ubuntu:~\/桌面\/demo\/qiniuupload\/src$ tree -L 2\n.\n├── App.vue\n├── client\n│\x26nbsp;\x26nbsp; └── upload.vue\n├── main.js\n├── router\n│\x26nbsp;\x26nbsp; └── index.js\n└── server\n    ├── app.js\n    ├── config.js\n    ├── node_modules\n    └── package.json\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3elytton@lytton-ubuntu:~\/桌面\/demo\/qiniuupload\/src$ tree -L \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n.\n├── App\x3cspan class=\x22hljs-selector-class\x22\x3e.vue\x3c\/span\x3e\n├── client\n│\x26nbsp;\x26nbsp; └── upload\x3cspan class=\x22hljs-selector-class\x22\x3e.vue\x3c\/span\x3e\n├── main\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n├── router\n│\x26nbsp;\x26nbsp; └── index\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n└── server\n    ├── app\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n    ├── config\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n    ├── node_modules\n    └── package\x3cspan class=\x22hljs-selector-class\x22\x3e.json\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e4、解决跨域问题\x3c\/h3\x3e\n\x3cblockquote\x3e这里前端向后端访问属于跨域访问，前端是跑在8080端口的，后端是跑在3000端口的，所以首先要解决一下跨域问题\x3c\/blockquote\x3e\n\x3cp\x3e打开config文件夹下的index.js\x3cbr\x3e添加跨域代理访问\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22module.exports = {\n  dev: {\n\n    \/\/ Paths\n    assetsSubDirectory: \x27static\x27,\n    assetsPublicPath: \x27\/\x27,\n    proxyTable: {\n      \x27\/up\x27: {\n        target: \x27http:\/\/localhost:3000\x27,\n        changeOrigin: true,\n        pathRewrite: {\n          \x27^\/up\x27: \x27\/\x27\n        }\n      }\n    },\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs java\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3eexports\x3c\/span\x3e = {\n  dev: {\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Paths\x3c\/span\x3e\n    assetsSubDirectory: \x3cspan class=\x22hljs-string\x22\x3e\x27static\x27\x3c\/span\x3e,\n    assetsPublicPath: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e,\n    proxyTable: {\n      \x3cspan class=\x22hljs-string\x22\x3e\x27\/up\x27\x3c\/span\x3e: {\n        target: \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/localhost:3000\x27\x3c\/span\x3e,\n        changeOrigin: \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e,\n        pathRewrite: {\n          \x3cspan class=\x22hljs-string\x22\x3e\x27^\/up\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e\n        }\n      }\n    },\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e5、 写upload.vue\x3c\/h3\x3e\n\x3cblockquote\x3e代码比较简单，基本从element-ui 官网拷贝过来就可以用了\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3ctemplate\x3e\n  \x3c!-- upload --\x3e\n  \x3cdiv class=\x26quot;upload\x26quot;\x3e\n    \x3cel-upload\n      class=\x26quot;avatar-uploader\x26quot;\n      :action= domain\n      :http-request = upqiniu\n      :show-file-list=\x26quot;false\x26quot;\n      :before-upload=\x26quot;beforeUpload\x26quot;\x3e\n      \x3cimg v-if=\x26quot;imageUrl\x26quot; :src=\x26quot;imageUrl\x26quot; class=\x26quot;avatar\x26quot;\x3e\n      \x3ci v-else class=\x26quot;el-icon-plus avatar-uploader-icon\x26quot;\x3e\x3c\/i\x3e\n    \x3c\/el-upload\x3e\n  \x3c\/div\x3e\n\x3c\/template\x3e\n\x3cscript\x3e\nexport default {\n  data () {\n    return {\n      imageUrl: \x27\x27,\n      token: {},\n      \/\/ 七牛云的上传地址，根据自己所在地区选择，我这里是华南区\n      domain: \x27https:\/\/upload-z2.qiniup.com\x27,\n      \/\/ 这是七牛云空间的外链默认域名\n      qiniuaddr: \x27p3z6q1uw1.bkt.clouddn.com\x27\n    }\n  },\n  methods: {\n    \/\/ 上传文件到七牛云\n    upqiniu (req) {\n      console.log(req)\n      const config = {\n        headers: {\x27Content-Type\x27: \x27multipart\/form-data\x27}\n      }\n      let filetype = \x27\x27\n      if (req.file.type === \x27image\/png\x27) {\n        filetype = \x27png\x27\n      } else {\n        filetype = \x27jpg\x27\n      }\n      \/\/ 重命名要上传的文件\n      const keyname = \x27lytton\x27 \x2b new Date() \x2b Math.floor(Math.random() * 100) \x2b \x27.\x27 \x2b filetype\n      \/\/ 从后端获取上传凭证token\n      this.axios.get(\x27\/up\/token\x27).then(res =\x3e {\n        console.log(res)\n        const formdata = new FormData()\n        formdata.append(\x27file\x27, req.file)\n        formdata.append(\x27token\x27, res.data)\n        formdata.append(\x27key\x27, keyname)\n        \/\/ 获取到凭证之后再将文件上传到七牛云空间\n        this.axios.post(this.domain, formdata, config).then(res =\x3e {\n          this.imageUrl = \x27http:\/\/\x27 \x2b this.qiniuaddr \x2b \x27\/\x27 \x2b res.data.key\n          \/\/ console.log(this.imageUrl)\n        })\n      })\n    },\n    \/\/ 验证文件合法性\n    beforeUpload (file) {\n      const isJPG = file.type === \x27image\/jpeg\x27 || file.type === \x27image\/png\x27\n      const isLt2M = file.size \/ 1024 \/ 1024 \x3c 2\n      if (!isJPG) {\n        this.$message.error(\x27上传头像图片只能是 JPG 格式!\x27)\n      }\n      if (!isLt2M) {\n        this.$message.error(\x27上传头像图片大小不能超过 2MB!\x27)\n      }\n      return isJPG \x26amp;\x26amp; isLt2M\n    }\n  }\n}\n\x3c\/script\x3e\n\x3cstyle scoped\x3e\n.upload {\n  width: 600px;\n  margin: 0 auto;\n}\n.avatar-uploader .el-upload {\n  border: 5px dashed #ca1717 !important;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\n  border-color: #409EFF;\n}\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n}\n.avatar {\n  width: 178px;\n  height: 178px;\n  display: block;\n}\n\x3c\/style\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!-- upload --\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22upload\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eel-upload\x3c\/span\x3e\n      \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22avatar-uploader\x22\x3c\/span\x3e\n      \x3cspan class=\x22hljs-attr\x22\x3e:action\x3c\/span\x3e= \x3cspan class=\x22hljs-string\x22\x3edomain\x3c\/span\x3e\n      \x3cspan class=\x22hljs-attr\x22\x3e:http-request\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3eupqiniu\x3c\/span\x3e\n      \x3cspan class=\x22hljs-attr\x22\x3e:show-file-list\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22false\x22\x3c\/span\x3e\n      \x3cspan class=\x22hljs-attr\x22\x3e:before-upload\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22beforeUpload\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eimg\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ev-if\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22imageUrl\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3e:src\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22imageUrl\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22avatar\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ei\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ev-else\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22el-icon-plus avatar-uploader-icon\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ei\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eel-upload\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  data () {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-attr\x22\x3eimageUrl\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3etoken\x3c\/span\x3e: {},\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 七牛云的上传地址，根据自己所在地区选择，我这里是华南区\x3c\/span\x3e\n      domain: \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/upload-z2.qiniup.com\x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这是七牛云空间的外链默认域名\x3c\/span\x3e\n      qiniuaddr: \x3cspan class=\x22hljs-string\x22\x3e\x27p3z6q1uw1.bkt.clouddn.com\x27\x3c\/span\x3e\n    }\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3emethods\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 上传文件到七牛云\x3c\/span\x3e\n    upqiniu (req) {\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(req)\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e config = {\n        \x3cspan class=\x22hljs-attr\x22\x3eheaders\x3c\/span\x3e: {\x3cspan class=\x22hljs-string\x22\x3e\x27Content-Type\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27multipart\/form-data\x27\x3c\/span\x3e}\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e filetype = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (req.file.type === \x3cspan class=\x22hljs-string\x22\x3e\x27image\/png\x27\x3c\/span\x3e) {\n        filetype = \x3cspan class=\x22hljs-string\x22\x3e\x27png\x27\x3c\/span\x3e\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        filetype = \x3cspan class=\x22hljs-string\x22\x3e\x27jpg\x27\x3c\/span\x3e\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 重命名要上传的文件\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e keyname = \x3cspan class=\x22hljs-string\x22\x3e\x27lytton\x27\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e() \x2b \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.random() * \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e) \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27.\x27\x3c\/span\x3e \x2b filetype\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 从后端获取上传凭证token\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.axios.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/up\/token\x27\x3c\/span\x3e).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(res)\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e formdata = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FormData()\n        formdata.append(\x3cspan class=\x22hljs-string\x22\x3e\x27file\x27\x3c\/span\x3e, req.file)\n        formdata.append(\x3cspan class=\x22hljs-string\x22\x3e\x27token\x27\x3c\/span\x3e, res.data)\n        formdata.append(\x3cspan class=\x22hljs-string\x22\x3e\x27key\x27\x3c\/span\x3e, keyname)\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取到凭证之后再将文件上传到七牛云空间\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.axios.post(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.domain, formdata, config).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n          \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.imageUrl = \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/\x27\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.qiniuaddr \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e \x2b res.data.key\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ console.log(this.imageUrl)\x3c\/span\x3e\n        })\n      })\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 验证文件合法性\x3c\/span\x3e\n    beforeUpload (file) {\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e isJPG = file.type === \x3cspan class=\x22hljs-string\x22\x3e\x27image\/jpeg\x27\x3c\/span\x3e || file.type === \x3cspan class=\x22hljs-string\x22\x3e\x27image\/png\x27\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e isLt2M = file.size \/ \x3cspan class=\x22hljs-number\x22\x3e1024\x3c\/span\x3e \/ \x3cspan class=\x22hljs-number\x22\x3e1024\x3c\/span\x3e \x26lt; \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!isJPG) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$message.error(\x3cspan class=\x22hljs-string\x22\x3e\x27上传头像图片只能是 JPG 格式!\x27\x3c\/span\x3e)\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!isLt2M) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$message.error(\x3cspan class=\x22hljs-string\x22\x3e\x27上传头像图片大小不能超过 2MB!\x27\x3c\/span\x3e)\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e isJPG \x26amp;\x26amp; isLt2M\n    }\n  }\n}\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3estyle\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3escoped\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22css\x22\x3e\n\x3cspan class=\x22hljs-selector-class\x22\x3e.upload\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3ewidth\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e600px\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-attribute\x22\x3emargin\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e auto;\n}\n\x3cspan class=\x22hljs-selector-class\x22\x3e.avatar-uploader\x3c\/span\x3e \x3cspan class=\x22hljs-selector-class\x22\x3e.el-upload\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3eborder\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e5px\x3c\/span\x3e dashed \x3cspan class=\x22hljs-number\x22\x3e#ca1717\x3c\/span\x3e \x3cspan class=\x22hljs-meta\x22\x3e!important\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-attribute\x22\x3eborder-radius\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e6px\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-attribute\x22\x3ecursor\x3c\/span\x3e: pointer;\n  \x3cspan class=\x22hljs-attribute\x22\x3eposition\x3c\/span\x3e: relative;\n  \x3cspan class=\x22hljs-attribute\x22\x3eoverflow\x3c\/span\x3e: hidden;\n}\n\x3cspan class=\x22hljs-selector-class\x22\x3e.avatar-uploader\x3c\/span\x3e \x3cspan class=\x22hljs-selector-class\x22\x3e.el-upload\x3c\/span\x3e\x3cspan class=\x22hljs-selector-pseudo\x22\x3e:hover\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3eborder-color\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e#409EFF\x3c\/span\x3e;\n}\n\x3cspan class=\x22hljs-selector-class\x22\x3e.avatar-uploader-icon\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3efont-size\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e28px\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-attribute\x22\x3ecolor\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e#8c939d\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-attribute\x22\x3ewidth\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e178px\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-attribute\x22\x3eheight\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e178px\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-attribute\x22\x3eline-height\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e178px\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-attribute\x22\x3etext-align\x3c\/span\x3e: center;\n}\n\x3cspan class=\x22hljs-selector-class\x22\x3e.avatar\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attribute\x22\x3ewidth\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e178px\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-attribute\x22\x3eheight\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e178px\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-attribute\x22\x3edisplay\x3c\/span\x3e: block;\n}\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3estyle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e测试\x3c\/h3\x3e\n\x3cp\x3e首先打开localhost:8080\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV7tMT?w=1277\x26amp;h=376\x22 src=\x22https:\/\/static.alili.tech\/img\/bV7tMT?w=1277\x26amp;h=376\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e然后选择上传图片\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV7tNM?w=1273\x26amp;h=412\x22 src=\x22https:\/\/static.alili.tech\/img\/bV7tNM?w=1273\x26amp;h=412\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e成功返回图片了\x3c\/p\x3e\n\x3cp\x3e看一下七牛云空间\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV7tOO?w=1200\x26amp;h=535\x22 src=\x22https:\/\/static.alili.tech\/img\/bV7tOO?w=1200\x26amp;h=535\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e多了一张刚刚上传的且已经重命名的图片\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e总结\x3c\/h2\x3e\n\x3cblockquote\x3e只做了文件的上传操作，如果是要修改，下载的话，需要写更多了，凭证也不能写得这么简单，学习还是要多看文档和demo\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3egithub地址：\x3c\/h2\x3e\n\x3cp\x3egithub: \x3ca href=\x22https:\/\/github.com\/lyttonlee\/qiniu-upload-demo\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/lyttonlee\/...\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>vue前端(element-ui)，express后端实现上传图片到七牛云</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000014137083">https://segmentfault.com/a/1190000014137083</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/mpdrzvlz5i/" target="_blank">https://alili.tech/archive/mpdrzvlz5i/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>