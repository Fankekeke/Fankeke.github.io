<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="一个只有十行的精简MVVM框架"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>一个只有十行的精简MVVM框架 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/n7q81ql61h/",
				"appid": "1613049289050283", 
				"title": "一个只有十行的精简MVVM框架 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-31T02:30:30"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/xsyk6re8i2e/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/74l5m91h0f/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fn7q81ql61h%2f&text=%e4%b8%80%e4%b8%aa%e5%8f%aa%e6%9c%89%e5%8d%81%e8%a1%8c%e7%9a%84%e7%b2%be%e7%ae%80MVVM%e6%a1%86%e6%9e%b6"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fn7q81ql61h%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fn7q81ql61h%2f&text=%e4%b8%80%e4%b8%aa%e5%8f%aa%e6%9c%89%e5%8d%81%e8%a1%8c%e7%9a%84%e7%b2%be%e7%ae%80MVVM%e6%a1%86%e6%9e%b6"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fn7q81ql61h%2f&title=%e4%b8%80%e4%b8%aa%e5%8f%aa%e6%9c%89%e5%8d%81%e8%a1%8c%e7%9a%84%e7%b2%be%e7%ae%80MVVM%e6%a1%86%e6%9e%b6"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fn7q81ql61h%2f&is_video=false&description=%e4%b8%80%e4%b8%aa%e5%8f%aa%e6%9c%89%e5%8d%81%e8%a1%8c%e7%9a%84%e7%b2%be%e7%ae%80MVVM%e6%a1%86%e6%9e%b6"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%b8%80%e4%b8%aa%e5%8f%aa%e6%9c%89%e5%8d%81%e8%a1%8c%e7%9a%84%e7%b2%be%e7%ae%80MVVM%e6%a1%86%e6%9e%b6&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fn7q81ql61h%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fn7q81ql61h%2f&title=%e4%b8%80%e4%b8%aa%e5%8f%aa%e6%9c%89%e5%8d%81%e8%a1%8c%e7%9a%84%e7%b2%be%e7%ae%80MVVM%e6%a1%86%e6%9e%b6"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fn7q81ql61h%2f&title=%e4%b8%80%e4%b8%aa%e5%8f%aa%e6%9c%89%e5%8d%81%e8%a1%8c%e7%9a%84%e7%b2%be%e7%ae%80MVVM%e6%a1%86%e6%9e%b6"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fn7q81ql61h%2f&title=%e4%b8%80%e4%b8%aa%e5%8f%aa%e6%9c%89%e5%8d%81%e8%a1%8c%e7%9a%84%e7%b2%be%e7%ae%80MVVM%e6%a1%86%e6%9e%b6"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fn7q81ql61h%2f&title=%e4%b8%80%e4%b8%aa%e5%8f%aa%e6%9c%89%e5%8d%81%e8%a1%8c%e7%9a%84%e7%b2%be%e7%ae%80MVVM%e6%a1%86%e6%9e%b6"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">一个只有十行的精简MVVM框架</h1><div class="meta"><div class="postdate"><time datetime="2018-12-31" itemprop="datePublished">2018-12-31</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e前言\x3c\/h1\x3e\n\x3cp\x3eMVVM模式相信做前端的人都不陌生，去网上搜MVVM，会出现一大堆关于MVVM模式的博文，但是这些博文大多都只是用图片和文字来进行抽象的概念讲解，对于刚接触MVVM模式的新手来说，这些概念虽然能够读懂，但是也很难做到理解透彻。因此，我写了这篇文章。\x3c\/p\x3e\n\x3cp\x3e这篇文章旨在通过代码的形式让大家更好的理解MVVM模式，相信大多数人读了这篇文章之后再去看其他诸如regular、vue等基于MVVM模式框架的源码，会容易很多。\x3c\/p\x3e\n\x3cp\x3e如果你对MVVM模式已经很熟悉并且也已经研读过并深刻理解了当下主流的前端框架，可以忽略下面的内容。如果你没有一点JavaScript基础，也请先去学习下再来阅读读此文。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3e引子\x3c\/h1\x3e\n\x3cp\x3e来张图来镇压此文：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011187170\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011187170\x22 alt=\x22alt MVVM模式\x22 title=\x22alt MVVM模式\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eMVVM\x3c\/code\x3e是\x3ccode\x3eModel-View-ViewModel\x3c\/code\x3e的缩写。简单的讲，它将\x3ccode\x3eView\x3c\/code\x3e与\x3ccode\x3eModel\x3c\/code\x3e层分隔开，利用\x3ccode\x3eViewModel\x3c\/code\x3e层将\x3ccode\x3eModel\x3c\/code\x3e层的数据经过一定的处理变成适用于\x3ccode\x3eView\x3c\/code\x3e层的数据结构并传送到\x3ccode\x3eView\x3c\/code\x3e层渲染界面，同时\x3ccode\x3eView\x3c\/code\x3e层的视图更新也会告知\x3ccode\x3eViewModel\x3c\/code\x3e层，然后\x3ccode\x3eViewModel\x3c\/code\x3e层再更新\x3ccode\x3eModel\x3c\/code\x3e层的数据。\x3c\/p\x3e\n\x3cp\x3e我们用一段学生信息的代码作为引子，然后一步步再重构成MVVM模式的样子。\x3c\/p\x3e\n\x3cp\x3e编写类似下面结构的学生信息：\x3c\/p\x3e\n\x3cblockquote\x3e\x3cul\x3e\n\x3cli\x3eName: Jessica Bre\x3c\/li\x3e\n\x3cli\x3eHeight: 1.8m\x3c\/li\x3e\n\x3cli\x3eWeight: 70kg\x3c\/li\x3e\n\x3c\/ul\x3e\x3c\/blockquote\x3e\n\x3cp\x3e用常规的js代码是这样的：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const student = {\n    \x27first-name\x27: \x27Jessica\x27,\n    \x27last-name\x27: \x27Bre\x27,\n    \x27height\x27: 180,\n    \x27weight\x27: 70,\n}\nconst root = document.createElement(\x27ul\x27)\nconst nameLi = document.createElement(\x27li\x27)\nconst nameLabel = document.createElement(\x27span\x27)\nnameLabel.textContent = \x27Name: \x27\nconst name_ = document.createElement(\x27span\x27)\nname_.textContent = student[\x27first-name\x27] \x2b \x27 \x27 \x2b student[\x27last-name\x27]\nnameLi.appendChild(nameLabel)\nnameLi.appendChild(name_)\nconst heightLi = document.createElement(\x27li\x27)\nconst heightLabel = document.createElement(\x27span\x27)\nheightLabel.textContent = \x27Height: \x27\nconst height = document.createElement(\x27span\x27)\nheight.textContent = \x27\x27 \x2b student[\x27height\x27] \/ 100 \x2b \x27m\x27\nheightLi.appendChild(heightLabel)\nheightLi.appendChild(height)\nconst weightLi = document.createElement(\x27li\x27)\nconst weightLabel = document.createElement(\x27span\x27)\nweightLabel.textContent = \x27Weight: \x27\nconst weight = document.createElement(\x27span\x27)\nweight.textContent = \x27\x27 \x2b student[\x27weight\x27] \x2b \x27kg\x27\nweightLi.appendChild(weightLabel)\nweightLi.appendChild(weight)\nroot.appendChild(nameLi)\nroot.appendChild(heightLi)\nroot.appendChild(weightLi)\ndocument.body.appendChild(root)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e student = {\n    \x3cspan class=\x22hljs-string\x22\x3e\x27first-name\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Jessica\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27last-name\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Bre\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27height\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e180\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27weight\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e70\x3c\/span\x3e,\n}\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e root = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27ul\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e nameLi = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27li\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e nameLabel = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\nnameLabel.textContent = \x3cspan class=\x22hljs-string\x22\x3e\x27Name: \x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e name_ = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\nname_.textContent = student[\x3cspan class=\x22hljs-string\x22\x3e\x27first-name\x27\x3c\/span\x3e] \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27 \x27\x3c\/span\x3e \x2b student[\x3cspan class=\x22hljs-string\x22\x3e\x27last-name\x27\x3c\/span\x3e]\nnameLi.appendChild(nameLabel)\nnameLi.appendChild(name_)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e heightLi = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27li\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e heightLabel = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\nheightLabel.textContent = \x3cspan class=\x22hljs-string\x22\x3e\x27Height: \x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e height = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\nheight.textContent = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e \x2b student[\x3cspan class=\x22hljs-string\x22\x3e\x27height\x27\x3c\/span\x3e] \/ \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27m\x27\x3c\/span\x3e\nheightLi.appendChild(heightLabel)\nheightLi.appendChild(height)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e weightLi = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27li\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e weightLabel = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\nweightLabel.textContent = \x3cspan class=\x22hljs-string\x22\x3e\x27Weight: \x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e weight = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\nweight.textContent = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e \x2b student[\x3cspan class=\x22hljs-string\x22\x3e\x27weight\x27\x3c\/span\x3e] \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27kg\x27\x3c\/span\x3e\nweightLi.appendChild(weightLabel)\nweightLi.appendChild(weight)\nroot.appendChild(nameLi)\nroot.appendChild(heightLi)\nroot.appendChild(weightLi)\n\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(root)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e好长的一堆代码呀！别急，下面我们一步步优化！\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3eDRY一下如何\x3c\/h1\x3e\n\x3cp\x3e程序设计中最广泛接受的规则之一就是“DRY”: \x22Do not Repeat Yourself\x22。很显然，上面的一段代码有很多重复的部分，不仅与这个准则相违背，而且给人一种不舒服的感觉。是时候做下处理，来让这段学生信息更\x22Drier\x22。\x3c\/p\x3e\n\x3cp\x3e可以发现，代码里写了很多遍\x3ccode\x3edocument.createElement\x3c\/code\x3e来创建节点，但是由于列表项都是相似的结构，所以我们没有必要一遍一遍的写。因此，进行如下封装：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const createListItem = function (label, content) {\n    const li = document.createElement(\x27li\x27)\n    const labelSpan = document.createElement(\x27span\x27)\n    labelSpan.textContent = label\n    const contentSpan = document.createElement(\x27span\x27)\n    contentSpan.textContent = content\n    li.appendChild(labelSpan)\n    li.appendChild(contentSpan)\n    return li\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e createListItem = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3elabel, content\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e li = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27li\x27\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e labelSpan = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\n    labelSpan.textContent = label\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e contentSpan = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\n    contentSpan.textContent = content\n    li.appendChild(labelSpan)\n    li.appendChild(contentSpan)\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e li\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e经过这步转化之后，整个学生信息应用就变成了这样：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const student = {\n    \x27first-name\x27: \x27Jessica\x27,\n    \x27last-name\x27: \x27Bre\x27,\n    \x27height\x27: 180,\n    \x27weight\x27: 70,\n}\n\nconst createListItem = function (label, content) {\n  const li = document.createElement(\x27li\x27)\n  const labelSpan = document.createElement(\x27span\x27)\n  labelSpan.textContent = label\n  const contentSpan = document.createElement(\x27span\x27)\n  contentSpan.textContent = content\n  li.appendChild(labelSpan)\n  li.appendChild(contentSpan)\n  return li\n}\nconst root = document.createElement(\x27ul\x27)\nconst nameLi = createListItem(\x27Name: \x27, student[\x27first-name\x27] \x2b \x27 \x27 \x2b student[\x27last-name\x27])\nconst heightLi = createListItem(\x27Height: \x27, student[\x27height\x27] \/ 100 \x2b \x27m\x27)\nconst weightLi = createListItem(\x27Weight: \x27, student[\x27weight\x27] \x2b \x27kg\x27)\nroot.appendChild(nameLi)\nroot.appendChild(heightLi)\nroot.appendChild(weightLi)\ndocument.body.appendChild(root)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e student = {\n    \x3cspan class=\x22hljs-string\x22\x3e\x27first-name\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Jessica\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27last-name\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Bre\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27height\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e180\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27weight\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e70\x3c\/span\x3e,\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e createListItem = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3elabel, content\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e li = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27li\x27\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e labelSpan = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\n  labelSpan.textContent = label\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e contentSpan = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\n  contentSpan.textContent = content\n  li.appendChild(labelSpan)\n  li.appendChild(contentSpan)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e li\n}\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e root = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27ul\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e nameLi = createListItem(\x3cspan class=\x22hljs-string\x22\x3e\x27Name: \x27\x3c\/span\x3e, student[\x3cspan class=\x22hljs-string\x22\x3e\x27first-name\x27\x3c\/span\x3e] \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27 \x27\x3c\/span\x3e \x2b student[\x3cspan class=\x22hljs-string\x22\x3e\x27last-name\x27\x3c\/span\x3e])\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e heightLi = createListItem(\x3cspan class=\x22hljs-string\x22\x3e\x27Height: \x27\x3c\/span\x3e, student[\x3cspan class=\x22hljs-string\x22\x3e\x27height\x27\x3c\/span\x3e] \/ \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27m\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e weightLi = createListItem(\x3cspan class=\x22hljs-string\x22\x3e\x27Weight: \x27\x3c\/span\x3e, student[\x3cspan class=\x22hljs-string\x22\x3e\x27weight\x27\x3c\/span\x3e] \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27kg\x27\x3c\/span\x3e)\nroot.appendChild(nameLi)\nroot.appendChild(heightLi)\nroot.appendChild(weightLi)\n\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(root)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e是不是变得更短了，也更易读了？即使你不看\x3ccode\x3ecreateListItem\x3c\/code\x3e函数的实现，光看\x3ccode\x3econst nameLi = createListItem(\x27Name: \x27, student[\x27first-name\x27] \x2b \x27 \x27 \x2b student[\x27last-name\x27])\x3c\/code\x3e也能大致明白这段代码时干什么的。\x3c\/p\x3e\n\x3cp\x3e但是上面的代码封装的还不够，因为每次创建一个列表项，我们都要多调用一遍\x3ccode\x3ecreateListItem\x3c\/code\x3e，上面的代码为了创建\x3ccode\x3ename,height,weight\x3c\/code\x3e标签，调用了三遍\x3ccode\x3ecreateListItem\x3c\/code\x3e，这里显然还有精简的空间。因此，我们再进一步封装：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const student = {\n    \x27first-name\x27: \x27Jessica\x27,\n    \x27last-name\x27: \x27Bre\x27,\n    \x27height\x27: 180,\n    \x27weight\x27: 70,\n}\n\nconst createList = function(kvPairs){\n  const createListItem = function (label, content) {\n    const li = document.createElement(\x27li\x27)\n    const labelSpan = document.createElement(\x27span\x27)\n    labelSpan.textContent = label\n    const contentSpan = document.createElement(\x27span\x27)\n    contentSpan.textContent = content\n    li.appendChild(labelSpan)\n    li.appendChild(contentSpan)\n    return li\n  }\n  const root = document.createElement(\x27ul\x27)\n  kvPairs.forEach(function (x) {\n    root.appendChild(createListItem(x.key, x.value))\n  })\n  return root\n}\n\n\nconst ul = createList([\n  {\n    key: \x27Name: \x27,\n    value: student[\x27first-name\x27] \x2b \x27 \x27 \x2b student[\x27last-name\x27]\n  },\n  {\n    key: \x27Height: \x27,\n    value: student[\x27height\x27] \/ 100 \x2b \x27m\x27\n  },\n  {\n    key: \x27Weight: \x27,\n    value: student[\x27weight\x27] \x2b \x27kg\x27\n  }])\ndocument.body.appendChild(ul)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e student = {\n    \x3cspan class=\x22hljs-string\x22\x3e\x27first-name\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Jessica\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27last-name\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Bre\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27height\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e180\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27weight\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e70\x3c\/span\x3e,\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e createList = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ekvPairs\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e createListItem = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3elabel, content\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e li = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27li\x27\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e labelSpan = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\n    labelSpan.textContent = label\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e contentSpan = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\n    contentSpan.textContent = content\n    li.appendChild(labelSpan)\n    li.appendChild(contentSpan)\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e li\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e root = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27ul\x27\x3c\/span\x3e)\n  kvPairs.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ex\x3c\/span\x3e) \x3c\/span\x3e{\n    root.appendChild(createListItem(x.key, x.value))\n  })\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e root\n}\n\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ul = createList([\n  {\n    \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Name: \x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: student[\x3cspan class=\x22hljs-string\x22\x3e\x27first-name\x27\x3c\/span\x3e] \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27 \x27\x3c\/span\x3e \x2b student[\x3cspan class=\x22hljs-string\x22\x3e\x27last-name\x27\x3c\/span\x3e]\n  },\n  {\n    \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Height: \x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: student[\x3cspan class=\x22hljs-string\x22\x3e\x27height\x27\x3c\/span\x3e] \/ \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27m\x27\x3c\/span\x3e\n  },\n  {\n    \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Weight: \x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: student[\x3cspan class=\x22hljs-string\x22\x3e\x27weight\x27\x3c\/span\x3e] \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27kg\x27\x3c\/span\x3e\n  }])\n\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(ul)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e有没有看到MVVM风格的影子？\x3ccode\x3estudent\x3c\/code\x3e对象是原始数据，相当于\x3ccode\x3eModel\x3c\/code\x3e层；\x3ccode\x3ecreateList\x3c\/code\x3e创建了\x3ccode\x3edom\x3c\/code\x3e树，相当于\x3ccode\x3eView\x3c\/code\x3e层，那么\x3ccode\x3eViewModel\x3c\/code\x3e层呢？仔细观察，其实我们传给\x3ccode\x3ecreateList\x3c\/code\x3e函数的参数就是\x3ccode\x3eModel\x3c\/code\x3e的数据的改造，为了让\x3ccode\x3eModel\x3c\/code\x3e的数据符合\x3ccode\x3eView\x3c\/code\x3e的结构，我们做了这样的改造，因此虽然这段函数里面没有独立的\x3ccode\x3eViewModel\x3c\/code\x3e层，但是它确实是存在的！聪明的同学应该想到了，下一步就是来独立出\x3ccode\x3eViewModel\x3c\/code\x3e层了吧~\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Model\nconst tk = {\n    \x27first-name\x27: \x27Jessica\x27,\n    \x27last-name\x27: \x27Bre\x27,\n    \x27height\x27: 180,\n    \x27weight\x27: 70,\n}\n\n\/\/View\nconst createList = function(kvPairs){\n  const createListItem = function (label, content) {\n    const li = document.createElement(\x27li\x27)\n    const labelSpan = document.createElement(\x27span\x27)\n    labelSpan.textContent = label\n    const contentSpan = document.createElement(\x27span\x27)\n    contentSpan.textContent = content\n    li.appendChild(labelSpan)\n    li.appendChild(contentSpan)\n    return li\n  }\n  const root = document.createElement(\x27ul\x27)\n  kvPairs.forEach(function (x) {\n    root.appendChild(createListItem(x.key, x.value))\n  })\n  return root\n}\n\/\/ViewModel\nconst formatStudent = function (student) {\n  return [\n    {\n      key: \x27Name: \x27,\n      value: student[\x27first-name\x27] \x2b \x27 \x27 \x2b student[\x27last-name\x27]\n    },\n    {\n      key: \x27Height: \x27,\n      value: student[\x27height\x27] \/ 100 \x2b \x27m\x27\n    },\n    {\n      key: \x27Weight: \x27,\n      value: student[\x27weight\x27] \x2b \x27kg\x27\n    }]\n}\nconst ul = createList(formatStudent(tk))\ndocument.body.appendChild(ul)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Model\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e tk = {\n    \x3cspan class=\x22hljs-string\x22\x3e\x27first-name\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Jessica\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27last-name\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Bre\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27height\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e180\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27weight\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e70\x3c\/span\x3e,\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/View\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e createList = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ekvPairs\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e createListItem = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3elabel, content\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e li = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27li\x27\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e labelSpan = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\n    labelSpan.textContent = label\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e contentSpan = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\n    contentSpan.textContent = content\n    li.appendChild(labelSpan)\n    li.appendChild(contentSpan)\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e li\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e root = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27ul\x27\x3c\/span\x3e)\n  kvPairs.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ex\x3c\/span\x3e) \x3c\/span\x3e{\n    root.appendChild(createListItem(x.key, x.value))\n  })\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e root\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ViewModel\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e formatStudent = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3estudent\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e [\n    {\n      \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Name: \x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: student[\x3cspan class=\x22hljs-string\x22\x3e\x27first-name\x27\x3c\/span\x3e] \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27 \x27\x3c\/span\x3e \x2b student[\x3cspan class=\x22hljs-string\x22\x3e\x27last-name\x27\x3c\/span\x3e]\n    },\n    {\n      \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Height: \x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: student[\x3cspan class=\x22hljs-string\x22\x3e\x27height\x27\x3c\/span\x3e] \/ \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27m\x27\x3c\/span\x3e\n    },\n    {\n      \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Weight: \x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: student[\x3cspan class=\x22hljs-string\x22\x3e\x27weight\x27\x3c\/span\x3e] \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27kg\x27\x3c\/span\x3e\n    }]\n}\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ul = createList(formatStudent(tk))\n\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(ul)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这看上去更舒服了。但是，最后两行还能封装~\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const run = function (root, {model, view, vm}) {\n  const rendered = view(vm(model))\n  root.appendChild(rendered)\n}\nrun(document.body, {\n      model: tk, \n      view: createList, \n      vm: formatStudent\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e run = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eroot, {model, view, vm}\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e rendered = view(vm(model))\n  root.appendChild(rendered)\n}\nrun(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body, {\n      \x3cspan class=\x22hljs-attr\x22\x3emodel\x3c\/span\x3e: tk, \n      \x3cspan class=\x22hljs-attr\x22\x3eview\x3c\/span\x3e: createList, \n      \x3cspan class=\x22hljs-attr\x22\x3evm\x3c\/span\x3e: formatStudent\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这种写法，熟悉vue或者regular的同学，应该会觉得似曾相识吧？\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader3\x22\x3e让我们来加点互动\x3c\/h1\x3e\n\x3cp\x3e前面学生信息的身高的单位都是默认\x3ccode\x3em\x3c\/code\x3e，如果新增一个需求，要求学生的身高的单位可以在\x3ccode\x3em\x3c\/code\x3e和\x3ccode\x3ecm\x3c\/code\x3e之间切换呢？\x3c\/p\x3e\n\x3cp\x3e首先需要一个变量来保存度量单位，因此这里必须用一个新的Model：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const tk = {\n    \x27first-name\x27: \x27Jessica\x27,\n    \x27last-name\x27: \x27Bre\x27,\n    \x27height\x27: 180,\n    \x27weight\x27: 70,\n}\nconst measurement = \x27cm\x27\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e tk = {\n    \x3cspan class=\x22hljs-string\x22\x3e\x27first-name\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Jessica\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27last-name\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Bre\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27height\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e180\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27weight\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e70\x3c\/span\x3e,\n}\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e measurement = \x3cspan class=\x22hljs-string\x22\x3e\x27cm\x27\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e为了让\x3ccode\x3etk\x3c\/code\x3e更方便的被其他模块重用，这里选择增加一个\x3ccode\x3emeasurement\x3c\/code\x3e数据源，而不是直接修改\x3ccode\x3etk\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e在视图部分要增加一个radio单选表单，用来切换身高单位。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const createList = function(kvPairs){\n  const createListItem = function (label, content) {\n    const li = document.createElement(\x27li\x27)\n    const labelSpan = document.createElement(\x27span\x27)\n    labelSpan.textContent = label\n    const contentSpan = document.createElement(\x27span\x27)\n    contentSpan.textContent = content\n    li.appendChild(labelSpan)\n    li.appendChild(contentSpan)\n    return li\n  }\n  const root = document.createElement(\x27ul\x27)\n  kvPairs.forEach(function (x) {\n    root.appendChild(createListItem(x.key, x.value))\n  })\n  return root\n}\nconst createToggle = function (options) {\n  const createRadio = function (name, opt){\n    const radio = document.createElement(\x27input\x27)\n    radio.name = name\n    radio.value = opt.value\n    radio.type = \x27radio\x27\n    radio.textContent = opt.value\n    radio.addEventListener(\x27click\x27, opt.onclick)\n    radio.checked = opt.checked\n    return radio\n  }\n  const root = document.createElement(\x27form\x27)\n  options.opts.forEach(function (x) {\n    root.appendChild(createRadio(options.name, x))\n    root.appendChild(document.createTextNode(x.value))\n  })\n  return root\n}\nconst createToggleableList = function(vm){\n  const listView = createList(vm.kvPairs)\n  const toggle = createToggle(vm.options)\n  const root = document.createElement(\x27div\x27)\n  root.appendChild(toggle)\n  root.appendChild(listView)\n  return root\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e createList = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ekvPairs\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e createListItem = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3elabel, content\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e li = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27li\x27\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e labelSpan = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\n    labelSpan.textContent = label\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e contentSpan = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27span\x27\x3c\/span\x3e)\n    contentSpan.textContent = content\n    li.appendChild(labelSpan)\n    li.appendChild(contentSpan)\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e li\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e root = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27ul\x27\x3c\/span\x3e)\n  kvPairs.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ex\x3c\/span\x3e) \x3c\/span\x3e{\n    root.appendChild(createListItem(x.key, x.value))\n  })\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e root\n}\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e createToggle = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eoptions\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e createRadio = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ename, opt\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e radio = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27input\x27\x3c\/span\x3e)\n    radio.name = name\n    radio.value = opt.value\n    radio.type = \x3cspan class=\x22hljs-string\x22\x3e\x27radio\x27\x3c\/span\x3e\n    radio.textContent = opt.value\n    radio.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e, opt.onclick)\n    radio.checked = opt.checked\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e radio\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e root = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27form\x27\x3c\/span\x3e)\n  options.opts.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ex\x3c\/span\x3e) \x3c\/span\x3e{\n    root.appendChild(createRadio(options.name, x))\n    root.appendChild(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createTextNode(x.value))\n  })\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e root\n}\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e createToggleableList = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evm\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e listView = createList(vm.kvPairs)\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e toggle = createToggle(vm.options)\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e root = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e)\n  root.appendChild(toggle)\n  root.appendChild(listView)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e root\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e接下来是\x3ccode\x3eViewModel\x3c\/code\x3e部分，\x3ccode\x3ecreateToggleableList\x3c\/code\x3e函数需要与之前的\x3ccode\x3ecreateList\x3c\/code\x3e函数不同的参数。因此，对View-Model结构重构是有必要的：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const createVm = function (model) {\n  const calcHeight = function (measurement, cms) {\n    if (measurement === \x27m\x27){\n      return cms \/ 100 \x2b \x27m\x27\n    }else{\n      return cms \x2b \x27cm\x27\n    }\n  }\n  const options = {\n    name: \x27measurement\x27,\n    opts: [\n      {\n        value: \x27cm\x27,\n        checked: model.measurement === \x27cm\x27,\n        onclick: () =\x3e model.measurement = \x27cm\x27\n      },\n      {\n        value: \x27m\x27,\n        checked: model.measurement === \x27m\x27,\n        onclick: () =\x3e model.measurement = \x27m\x27\n      }\n    ]\n  }\n  const kvPairs = [\n    {\n      key: \x27Name: \x27,\n      value: model.student[\x27first-name\x27] \x2b \x27 \x27 \x2b model.student[\x27last-name\x27]\n    },\n    {\n      key: \x27Height: \x27,\n      value: calcHeight(model.measurement, model.student[\x27height\x27])\n    },\n    {\n      key: \x27Weight: \x27,\n      value: model.student[\x27weight\x27] \x2b \x27kg\x27\n    },\n    {\n      key: \x27BMI: \x27,\n      value:  model.student[\x27weight\x27] \/ (model.student[\x27height\x27] * model.student[\x27height\x27] \/ 10000)\n    }]\n  return {kvPairs, options}\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e createVm = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3emodel\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e calcHeight = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3emeasurement, cms\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (measurement === \x3cspan class=\x22hljs-string\x22\x3e\x27m\x27\x3c\/span\x3e){\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e cms \/ \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27m\x27\x3c\/span\x3e\n    }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e cms \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27cm\x27\x3c\/span\x3e\n    }\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e options = {\n    \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27measurement\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eopts\x3c\/span\x3e: [\n      {\n        \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27cm\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3echecked\x3c\/span\x3e: model.measurement === \x3cspan class=\x22hljs-string\x22\x3e\x27cm\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eonclick\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e model.measurement = \x3cspan class=\x22hljs-string\x22\x3e\x27cm\x27\x3c\/span\x3e\n      },\n      {\n        \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27m\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3echecked\x3c\/span\x3e: model.measurement === \x3cspan class=\x22hljs-string\x22\x3e\x27m\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eonclick\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e model.measurement = \x3cspan class=\x22hljs-string\x22\x3e\x27m\x27\x3c\/span\x3e\n      }\n    ]\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e kvPairs = [\n    {\n      \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Name: \x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: model.student[\x3cspan class=\x22hljs-string\x22\x3e\x27first-name\x27\x3c\/span\x3e] \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27 \x27\x3c\/span\x3e \x2b model.student[\x3cspan class=\x22hljs-string\x22\x3e\x27last-name\x27\x3c\/span\x3e]\n    },\n    {\n      \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Height: \x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: calcHeight(model.measurement, model.student[\x3cspan class=\x22hljs-string\x22\x3e\x27height\x27\x3c\/span\x3e])\n    },\n    {\n      \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Weight: \x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: model.student[\x3cspan class=\x22hljs-string\x22\x3e\x27weight\x27\x3c\/span\x3e] \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27kg\x27\x3c\/span\x3e\n    },\n    {\n      \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27BMI: \x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e:  model.student[\x3cspan class=\x22hljs-string\x22\x3e\x27weight\x27\x3c\/span\x3e] \/ (model.student[\x3cspan class=\x22hljs-string\x22\x3e\x27height\x27\x3c\/span\x3e] * model.student[\x3cspan class=\x22hljs-string\x22\x3e\x27height\x27\x3c\/span\x3e] \/ \x3cspan class=\x22hljs-number\x22\x3e10000\x3c\/span\x3e)\n    }]\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {kvPairs, options}\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里为\x3ccode\x3ecreateToggle\x3c\/code\x3e添加了\x3ccode\x3eops\x3c\/code\x3e，并且将\x3ccode\x3eops\x3c\/code\x3e封装成了一个对象。根据度量单位，使用不同的方式去计算身高。当任何一个\x3ccode\x3eradio\x3c\/code\x3e被点击，数据的度量单位将会改变。\x3c\/p\x3e\n\x3cp\x3e看上去很完美，但是当你点击radio标签的时候，视图不会有任何改变。因为这里还没有为视图做更新算法。有关\x3ccode\x3eMVVM\x3c\/code\x3e如何处理视图更新，那是一个比较大的课题，需要另辟一个博文来讲，由于本文写的是一个精简的\x3ccode\x3eMVVM\x3c\/code\x3e框架，这里就不再赘述，并用最简单的方式实现视图更新:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const run = function (root, {model, view, vm}) {\n  let m = {...model}\n  let m_old = {}\n  setInterval( function (){\n    if(!_.isEqual(m, m_old)){\n      const rendered = view(vm(m))\n      root.innerHTML = \x27\x27\n      root.appendChild(rendered)\n      m_old = {...m}\n    }\n  },1000)\n}\nrun(document.body, {\n      model: {student:tk, measurement}, \n      view: createToggleableList, \n      vm: createVm \n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e run = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eroot, {model, view, vm}\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e m = {...model}\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e m_old = {}\n  setInterval( \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(!_.isEqual(m, m_old)){\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e rendered = view(vm(m))\n      root.innerHTML = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\n      root.appendChild(rendered)\n      m_old = {...m}\n    }\n  },\x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e)\n}\nrun(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body, {\n      \x3cspan class=\x22hljs-attr\x22\x3emodel\x3c\/span\x3e: {\x3cspan class=\x22hljs-attr\x22\x3estudent\x3c\/span\x3e:tk, measurement}, \n      \x3cspan class=\x22hljs-attr\x22\x3eview\x3c\/span\x3e: createToggleableList, \n      \x3cspan class=\x22hljs-attr\x22\x3evm\x3c\/span\x3e: createVm \n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上述代码引用了一个外部库\x3ccode\x3elodash\x3c\/code\x3e的\x3ccode\x3eisEqual\x3c\/code\x3e方法来比较数据模型是否有更新。此段代码应用了轮询，每秒都会检测数据是否发生变化，有变化了再更新视图。这是最笨的方法，并且在DOM结构比较复杂时，性能也会受到很大的影响。还是同样的话，本文的主题是\x3cstrong\x3e一个精简的MVVM框架\x3c\/strong\x3e，因此略去了很多细节性的东西，只把主要的东西提炼出来，以达到更好的理解MVVM模式的目的。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader4\x22\x3eMVVM框架的诞生\x3c\/h1\x3e\n\x3cp\x3e以上便是一个简短精简的MVVM风格的学生信息的示例。至此，一个精简的MVVM框架其实已经出来了：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/**\n* @param {Node} root\n* @param {Object} model\n* @param {Function} view\n* @param {Function} vm\n*\/\nconst run = function (root, {model, view, vm}) {\n  let m = {...model}\n  let m_old = {}\n  setInterval( function (){\n    if(!_.isEqual(m, m_old)){\n      const rendered = view(vm(m))\n      root.innerHTML = \x27\x27\n      root.appendChild(rendered)\n      m_old = {...m}\n    }\n  },1000)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/**\n* @param {Node} root\n* @param {Object} model\n* @param {Function} view\n* @param {Function} vm\n*\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e run = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eroot, {model, view, vm}\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e m = {...model}\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e m_old = {}\n  setInterval( \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(!_.isEqual(m, m_old)){\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e rendered = view(vm(m))\n      root.innerHTML = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\n      root.appendChild(rendered)\n      m_old = {...m}\n    }\n  },\x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e什么?你确定不是在开玩笑？一个只有十行的框架？请记住：\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e框架是对如何组织代码和整个项目如何通用运作的抽象。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e这并不意味着你应该有一堆代码或混乱的类，尽管企业可用的API列表经常都很可怕的长。但是如果你研读一个框架仓库的核心文件夹，你可能发现它会出乎意料的小（相比于整个项目来说）。其核心代码包含主要工作进程，而其他部分只是帮助开发人员以更加舒适的方式构建应用程序的附件。有兴趣的同学可以去看看\x3ca href=\x22https:\/\/cycle.js.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ecycle.js\x3c\/a\x3e,这个框架只有124行（包含注释和空格）。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader5\x22\x3e总结\x3c\/h1\x3e\n\x3cp\x3e此时用一张图来作为总结再好不过了！\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011187170\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011187170\x22 alt=\x22alt MVVM模式\x22 title=\x22alt MVVM模式\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e当然这里还有很多细节需要进一步探讨，比如如何选择或设计一个更加友好的View层的视图工具，如何更新和何时更新视图比较合适等等。如果把这些问题都解决了，相信这种MVVM框架会更加健壮。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>一个只有十行的精简MVVM框架</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011187165">https://segmentfault.com/a/1190000011187165</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/n7q81ql61h/" target="_blank">https://alili.tech/archive/n7q81ql61h/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>