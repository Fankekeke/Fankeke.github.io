<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="手把手教你写vue裁切预览组件"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>手把手教你写vue裁切预览组件 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/o6sg7qmt7p/",
				"appid": "1613049289050283", 
				"title": "手把手教你写vue裁切预览组件 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-01T02:30:12"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/lhv131o5b79/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/nhiubfjmu3/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fo6sg7qmt7p%2f&text=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99vue%e8%a3%81%e5%88%87%e9%a2%84%e8%a7%88%e7%bb%84%e4%bb%b6"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fo6sg7qmt7p%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fo6sg7qmt7p%2f&text=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99vue%e8%a3%81%e5%88%87%e9%a2%84%e8%a7%88%e7%bb%84%e4%bb%b6"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fo6sg7qmt7p%2f&title=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99vue%e8%a3%81%e5%88%87%e9%a2%84%e8%a7%88%e7%bb%84%e4%bb%b6"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fo6sg7qmt7p%2f&is_video=false&description=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99vue%e8%a3%81%e5%88%87%e9%a2%84%e8%a7%88%e7%bb%84%e4%bb%b6"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99vue%e8%a3%81%e5%88%87%e9%a2%84%e8%a7%88%e7%bb%84%e4%bb%b6&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fo6sg7qmt7p%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fo6sg7qmt7p%2f&title=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99vue%e8%a3%81%e5%88%87%e9%a2%84%e8%a7%88%e7%bb%84%e4%bb%b6"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fo6sg7qmt7p%2f&title=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99vue%e8%a3%81%e5%88%87%e9%a2%84%e8%a7%88%e7%bb%84%e4%bb%b6"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fo6sg7qmt7p%2f&title=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99vue%e8%a3%81%e5%88%87%e9%a2%84%e8%a7%88%e7%bb%84%e4%bb%b6"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fo6sg7qmt7p%2f&title=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99vue%e8%a3%81%e5%88%87%e9%a2%84%e8%a7%88%e7%bb%84%e4%bb%b6"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">手把手教你写vue裁切预览组件</h1><div class="meta"><div class="postdate"><time datetime="2018-12-01" itemprop="datePublished">2018-12-01</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3evue版本裁切工具，包含预览功能\x3c\/blockquote\x3e\n\x3cp\x3e最终效果： \x3ca href=\x22https:\/\/qiuyaofan.github.io\/vue-crop-demo\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/qiuyaofan.github.io\/vue-crop-demo\/\x3c\/a\x3e \x3c\/p\x3e\n\x3cp\x3e源码地址： \x3ca href=\x22https:\/\/github.com\/qiuyaofan\/vue-crop\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/qiuyaofan\/vue-crop\x3c\/a\x3e\x3c\/p\x3e\n\x3ch4\x3e第一步：先用vue-cli安装脚手架（不会安装的看 \x3ca href=\x22https:\/\/www.npmjs.com\/package\/vue-cli\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3evue-cli官网\x3c\/a\x3e）\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 初始化vue-cli\nvue init webpack my-plugin\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stata\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 初始化vue-cli\x3c\/span\x3e\nvue init webpack my-\x3cspan class=\x22hljs-keyword\x22\x3eplugin\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e第二步：创建文件\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22新建src\/views\/validSlideDemo.vue,\n\nsrc\/components里新建VueCrop\/index.js,VueCrop.vue，\n\n在routes\/index.js配置访问路由（具体看github源码）\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3e新建src\/views\/validSlideDemo\x3cspan class=\x22hljs-selector-class\x22\x3e.vue\x3c\/span\x3e,\n\nsrc\/components里新建VueCrop\/index\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e,VueCrop.vue，\n\n在routes\/index.js配置访问路由（具体看github源码）\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最终生成的文件结构如下图:\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV982Q?w=1678\x26amp;h=808\x22 src=\x22https:\/\/static.alili.tech\/img\/bV982Q?w=1678\x26amp;h=808\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e第三步：注册组件\x3c\/h4\x3e\n\x3ch5\x3e1.引用所有插件：src\/components\/index.js\x3c\/h5\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 导入插件入口文件\nimport VueCrop from \x27.\/VueCrop\/index.js\x27\nconst install = function (Vue, opts = {}) {\n  \/* 如果已安装就跳过 *\/\n  if (install.installed) return\n  \n  \/\/ 注册插件\n  Vue.component(VueCrop.name, VueCrop)\n}\n\n\/\/ 全局情况下注册插件\nif (typeof window !== \x27undefined\x27 \x26amp;\x26amp; window.Vue) {\n  install(window.Vue)\n}\n\nexport {\n  install,\n  \/\/ 此处是为了兼容在vue内单独引入这个插件，如果是main.js全局引入就可以去掉\n  VueCrop\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 导入插件入口文件\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e VueCrop \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/VueCrop\/index.js\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e install = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eVue, opts = {}\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/* 如果已安装就跳过 *\/\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (install.installed) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n  \n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 注册插件\x3c\/span\x3e\n  Vue.component(VueCrop.name, VueCrop)\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 全局情况下注册插件\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e !== \x3cspan class=\x22hljs-string\x22\x3e\x27undefined\x27\x3c\/span\x3e \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.Vue) {\n  install(\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.Vue)\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e {\n  install,\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 此处是为了兼容在vue内单独引入这个插件，如果是main.js全局引入就可以去掉\x3c\/span\x3e\n  VueCrop\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch5\x3e2.全局调用插件：src\/main.js （ \x3ca href=\x22https:\/\/cn.vuejs.org\/v2\/guide\/plugins.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3evue plugins官方文档解说install\x3c\/a\x3e）\x3c\/h5\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import Vue from \x27vue\x27\nimport App from \x27.\/App\x27\nimport router from \x27.\/router\x27\n\n\/\/ 新加的：导入入口文件\nimport { install } from \x27src\/components\/index.js\x27\n\n\/\/ 全局调用，相当于调用 `MyPlugin.install(Vue)`\nVue.use(install)\n\nVue.config.productionTip = false\n\/* eslint-disable no-new *\/\nnew Vue({\n  el: \x27#app\x27,\n  router,\n  components: { App },\n  template: \x27\x3cApp\/\x3e\x27\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gradle\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Vue \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27vue\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e App \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/App\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e router \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/router\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 新加的：导入入口文件\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { install } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27src\/components\/index.js\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 全局调用，相当于调用 `MyPlugin.install(Vue)`\x3c\/span\x3e\nVue.use(install)\n\nVue.config.productionTip = \x3cspan class=\x22hljs-keyword\x22\x3efalse\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/* eslint-disable no-new *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Vue({\n  el: \x3cspan class=\x22hljs-string\x22\x3e\x27#app\x27\x3c\/span\x3e,\n  router,\n  components: { App },\n  template: \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;App\/\x26gt;\x27\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch5\x3e3.VueCrop入口文件调用VueCrop.vue：src\/components\/VueCrop\/index.js\x3c\/h5\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 导入vue\nimport VueCrop from \x27.\/VueCrop.vue\x27\n\n\/\/ Vue.js 的插件应当有一个公开方法 install 。这个方法的第一个参数是 Vue 构造器\nVueCrop.install = function (Vue) {\n  \/\/ 注册组件\n  Vue.component(VueCrop.name, VueCrop)\n}\n\nexport default VueCrop\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 导入vue\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e VueCrop \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/VueCrop.vue\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Vue.js 的插件应当有一个公开方法 install 。这个方法的第一个参数是 Vue 构造器\x3c\/span\x3e\nVueCrop.install = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eVue\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 注册组件\x3c\/span\x3e\n  Vue.component(VueCrop.name, VueCrop)\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e VueCrop\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch5\x3e小结：我一开始一直有个误解，以为myPlugin.install是vue的一个方法，其实不是，他只是我们构造plugin识的一个公开方法，可以理解为原生js中的构造函数的方法：\x3c\/h5\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function MyPlugin(){\n  console.info(\x27构造函数\x27)\n}\nMyPlugin.prototype.install=function(vue,options){\n    console.info(\x27构造器vue:\x27\x2bvue);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eMyPlugin\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.info(\x3cspan class=\x22hljs-string\x22\x3e\x27构造函数\x27\x3c\/span\x3e)\n}\nMyPlugin.prototype.install=\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evue,options\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.info(\x3cspan class=\x22hljs-string\x22\x3e\x27构造器vue:\x27\x3c\/span\x3e\x2bvue);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e而真正注册组件的是：Vue.component()\x3c\/p\x3e\n\x3cp\x3e所以，vue插件注册的过程是：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x221.调用main.js中：\nimport { install } from \x27src\/components\/index.js\x27\nvue.use(install)\n\n2.index.js添加install方法，调用Vue.component注册组件\n\n3.组件内的index.js同所有组件的index.js一样\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs flix\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-number\x22\x3e1.\x3c\/span\x3e调用main.js中：\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { install } from \x27src\/components\/\x3cspan class=\x22hljs-keyword\x22\x3eindex\x3c\/span\x3e.js\x27\nvue.use(install)\n\n\x3cspan class=\x22hljs-number\x22\x3e2.\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3eindex\x3c\/span\x3e.js添加install方法，调用Vue.component注册组件\n\n\x3cspan class=\x22hljs-number\x22\x3e3.\x3c\/span\x3e组件内的\x3cspan class=\x22hljs-keyword\x22\x3eindex\x3c\/span\x3e.js同所有组件的\x3cspan class=\x22hljs-keyword\x22\x3eindex\x3c\/span\x3e.js一样\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e第四步：设计开发自己的组件，构建组件结构\x3c\/h4\x3e\n\x3cblockquote\x3e在此之前，可以先了解下组件的命名规范等，可参考文章 \x3ca href=\x22https:\/\/juejin.im\/post\/5ada9b586fb9a07aaf34c746?utm_source=gold_browser_extension\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e掘金：Vue前端开发规范\x3c\/a\x3e，其中第2点有详细讲解\x3c\/blockquote\x3e\n\x3cp\x3e首先，确定自己的调用方式和需要暴露的参数\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cvue-crop\n:crop-url=\x26quot;cropUrl1\x26quot;\n:ratio=\x26quot;ratio\x26quot;\n:height=\x26quot;460\x26quot;\n:width=\x26quot;460\x26quot;\n:previewJson=\x26quot;previewJson1\x26quot;\nclass=\x26quot;c-crop--preview_right\x26quot;\n@afterCrop=\x26quot;afterCrop\x26quot;\n\x3e\n\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs elixir\x22\x3e\x3ccode\x3e\x26lt;vue-crop\n\x3cspan class=\x22hljs-symbol\x22\x3e:crop-url=\x3cspan class=\x22hljs-string\x22\x3e\x22cropUrl1\x22\x3c\/span\x3e\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e:ratio=\x3cspan class=\x22hljs-string\x22\x3e\x22ratio\x22\x3c\/span\x3e\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e:height=\x3cspan class=\x22hljs-string\x22\x3e\x22460\x22\x3c\/span\x3e\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e:width=\x3cspan class=\x22hljs-string\x22\x3e\x22460\x22\x3c\/span\x3e\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e:previewJson=\x3cspan class=\x22hljs-string\x22\x3e\x22previewJson1\x22\x3c\/span\x3e\x3c\/span\x3e\nclass=\x3cspan class=\x22hljs-string\x22\x3e\x22c-crop--preview_right\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-variable\x22\x3e@afterCrop\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22afterCrop\x22\x3c\/span\x3e\n\x26gt;\n\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其中，@afterCrop=\x22afterCrop\x22是裁切完成的回调函数，其他是属性配置\x3c\/p\x3e\n\x3cp\x3e在组件src\/components\/VueCrop\/VueCrop.vue内，可以用this.$emit(\x27afterCrop\x27)触发demo里的afterCrop事件\x3c\/p\x3e\n\x3cp\x3e组件结构上，主要分为：裁切主体部分（VueCrop.vue），选框组件（VueCropTool.vue）,裁切框宽度、位置坐标等计算（VueCropMove.js）,拖拽事件注册公共js（components\/utils\/draggable.js）\x3c\/p\x3e\n\x3ch5\x3e当前裁切插件的总体思路\x3c\/h5\x3e\n\x3col\x3e\n\x3cli\x3e裁切插件的裁切主体由图片，选框，预览结构组成\x3c\/li\x3e\n\x3cli\x3e选框（VueCropTool.vue）负责拖拽改变其大小，坐标位置等并返回给VueCrop.vue\x3c\/li\x3e\n\x3cli\x3e主体计算数值同步预览显示（c-crop--preview）\x3c\/li\x3e\n\x3cli\x3e主体触发调用页面（VueCropDemo.vue）的afterCrop事件，从而传递参数返回裁切后的url,left,top,bottom,right,x,y,w,h等\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cblockquote\x3e备注：此组件不具备真实的裁切功能，最终的裁切是传递给后台去裁，你如果想扩展可以在afterCrop函数里根据坐标等信息进行处理\x3c\/blockquote\x3e\n\x3cp\x3e接下来我们对各个组件和js进行讲解\x3c\/p\x3e\n\x3ch5\x3e1.draggable.js是参照element里的，修改了一部分，源码如下\x3c\/h5\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export default function (element, options) {\n  const moveFn = function (event) {\n    if (options.drag) {\n      options.drag(event)\n    }\n  }\n  \/\/ mousedown fn\n  const downFn = function (event) {\n    if (options.start) {\n        \/\/ 调用参数中start函数\n      options.start(event)\n    }\n  }\n  \/\/ mouseup fn\n  const upFn = function (event) {\n    document.removeEventListener(\x27mousemove\x27, moveFn)\n    document.removeEventListener(\x27mouseup\x27, upFn)\n    document.onselectstart = null\n    document.ondragstart = null\n\n    if (options.end) {\n        \/\/ 调用参数中end函数\n      options.end(event)\n    }\n  }\n  \/\/ 绑定事件\n  element.addEventListener(\x27mousedown\x27, event =\x3e {\n    if (options.stop \x26amp;\x26amp; options.stop(event, element) === false) {\n      return false\n    }\n    document.onselectstart = function () {\n      return false\n    }\n    document.ondragstart = function () {\n      return false\n    }\n    document.addEventListener(\x27mousedown\x27, downFn)\n    document.addEventListener(\x27mousemove\x27, moveFn)\n    document.addEventListener(\x27mouseup\x27, upFn)\n  })\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eelement, options\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e moveFn = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (options.drag) {\n      options.drag(event)\n    }\n  }\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ mousedown fn\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e downFn = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (options.start) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 调用参数中start函数\x3c\/span\x3e\n      options.start(event)\n    }\n  }\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ mouseup fn\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e upFn = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.removeEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mousemove\x27\x3c\/span\x3e, moveFn)\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.removeEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mouseup\x27\x3c\/span\x3e, upFn)\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.onselectstart = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.ondragstart = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (options.end) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 调用参数中end函数\x3c\/span\x3e\n      options.end(event)\n    }\n  }\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绑定事件\x3c\/span\x3e\n  element.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mousedown\x27\x3c\/span\x3e, event =\x26gt; {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (options.stop \x26amp;\x26amp; options.stop(event, element) === \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.onselectstart = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.ondragstart = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mousedown\x27\x3c\/span\x3e, downFn)\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mousemove\x27\x3c\/span\x3e, moveFn)\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mouseup\x27\x3c\/span\x3e, upFn)\n  })\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch5\x3eVueCropTool.vue使用如下\x3c\/h5\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22draggable(this.$el.querySelector(\x27.c-crop--drap_screen\x27), {\n    start: (event) =\x3e {\n      this.startPos = [event.x, event.y]\n    },\n    drag: (event) =\x3e {\n      this.handleDragLocation(event)\n    },\n    end: (event) =\x3e {\n      this.handleDragLocation(event)\n    }\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3edraggable(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$el.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27.c-crop--drap_screen\x27\x3c\/span\x3e), {\n    start: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(event)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.startPos = [event.x, event.y]\n    },\n    drag: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(event)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleDragLocation(event)\n    },\n    end: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(event)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleDragLocation(event)\n    }\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch5\x3e2.裁切主体部分（\x3ca href=\x22https:\/\/github.com\/qiuyaofan\/vue-crop\/blob\/master\/src\/components\/VueCrop\/VueCrop.vue\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eVueCrop.vue全部源码链接\x3c\/a\x3e）\x3c\/h5\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/script部分\n\x3cscript\x3e\nimport VueCropTool from \x27.\/VueCropTool.vue\x27\nexport default {\n  name: \x27VueCrop\x27,\n  data () {\n    return {\n      \/\/ 根据裁切后的缩放和坐标等生成的预览尺寸坐标数组\n      previewImgSize: null,\n      \/\/ 图片初始数据\n      originImgSize: null,\n      \/\/ 裁切框宽度\n      elWidth: 0,\n      \/\/ 裁切框高度\n      elHeight: 0,\n      \/\/ 裁切框top\n      cursorTop: 0,\n      \/\/ 裁切框left\n      cursorLeft: 0,\n      \/\/ 根据当前的容器宽高计算出的图片尺寸\n      imgH: 0,\n      imgW: 0,\n      \/\/ 图片url\n      url: this.cropUrl,\n      \/\/ 为适应当前的容器对原始图片的缩放值\n      scale: 1,\n      \/\/ 根据当前选区和原始图片缩放前的尺寸，来得到最终的裁切尺寸\n      coord: null,\n      \/\/ 计算出的裁切框的初始值\n      cropJson: {\n        cw: null,\n        ch: null,\n        w: null,\n        h: null,\n        r: null\n      }\n    }\n  },\n  \/\/ 暴露出去的参数，具体解释可看前文的表格\n  props: {\n    cropUrl: String,\n    \/\/ 比例\n    ratio: {\n      type: null,\n      default: false\n    },\n    width: null,\n    height: null,\n    coordWidth: null,\n    coordHeight: null,\n    previewJson: {\n      type: Array,\n      default: function () {\n        return []\n      }\n    }\n  },\n  components: {\n    VueCropTool\n  },\n  created () {\n  },\n  watch: {\n      \/\/ 监听图片路径变化\n    cropUrl (val) {\n      this.url = val\n      \/\/ setTimeout是为了兼容马上获取尺寸获取不到的情况\n      setTimeout(() =\x3e {\n        this.setSize()\n      }, 200)\n    }\n  },\n  methods: {\n       \/\/ 更新拖拽尺寸，大部分由裁切框组件通过@updateSize触发\n    drapSizeUpdate (w, h, t, l) {\n      \/\/ 更新裁切框尺寸\n      this.elWidth = w\n      this.elHeight = h\n      this.cursorTop = t\n      this.cursorLeft = l\n      \/\/ 根据当前选区获取原始图片缩放前的尺寸（还原原始图片的宽高以获取最终裁切数据）\n      this.coord = this.getCoord(l, t, w, h)\n      \/\/ 更新预览尺寸\n      this.setPreviewSize(this.coord)\n    },\n    \/\/ 裁切完毕回调\n    afterCrop () {\n      this.$emit(\x27afterCrop\x27, this.coord, this.url)\n    },\n    \/\/ 设置preview尺寸\n    setPreviewSize (coord) {\n      if (!this.previewJson.length) {\n        return false\n      }\n      let result = this.previewJson.map(data =\x3e {\n           \/\/ 计算缩放比\n        let scale = data.width \/ coord.w\n        return {\n          scale,\n          l: -scale * coord.l,\n          t: -scale * coord.t,\n          w: scale * this.originImgSize.w,\n          h: scale * this.originImgSize.h\n        }\n      })\n      this.previewImgSize = result\n    },\n    \/\/ 设置裁切显示的图片尺寸，存储scale值\n    async setSize () {\n      if (!this.url) {\n        return\n      }\n      let imgSize = await this.getSize(this.url)\n      this.originImgSize = imgSize\n      this.setCoordRange()\n      this.scale = imgSize.w \/ this.imgW\n      this.cursorTop = 0\n      this.cursorLeft = 0\n      let json = {...this.cropJson}\n      json.w = this.imgW\n      json.h = this.imgH\n      \/\/ 有固定比例，则按比例截取\n      if (this.ratio) {\n        json.r = this.ratio\n        if (json.w \x3e json.h) {\n          let r = json.h * this.ratio \/ json.w\n          if (r \x3e 1) {\n            json.ch = json.h \/ r\n            json.cw = json.ch * this.ratio\n          } else {\n            json.ch = json.h\n            json.cw = json.ch * this.ratio\n          }\n        } else {\n          let r = json.w \/ this.ratio \/ json.h\n          if (r \x3e 1) {\n            json.cw = json.w \/ r\n            json.ch = json.cw \/ this.ratio\n          } else {\n            json.cw = json.w\n            json.ch = json.cw \/ this.ratio\n          }\n        }\n      } else {\n           \/\/ 无比例\n        json.cw = json.w\n        json.ch = json.h\n      }\n      \/\/ 裁切框的尺寸（\/2是取一半的值，使裁切框居中并宽度为一半）\n      this.elWidth = json.cw \/ 2\n      this.elHeight = json.ch \/ 2\n      this.cursorTop = json.ch \/ 4\n      this.cursorLeft = json.cw \/ 4\n      this.cropJson = {...json}\n      this.drapSizeUpdate(this.elWidth, this.elHeight, this.cursorTop, this.cursorLeft)\n    },\n    \/\/ 根据图片原本的尺寸比例和用户传入的尺寸宽高设置当前可显示的区域图片尺寸\n    setCoordRange () {\n      var size = {...this.originImgSize}\n      var ratio1 = this.width \/ this.height\n      var ratio2 = size.r\n      if (ratio2 \x3e ratio1) {\n        this.imgW = this.width\n        this.imgH = this.width \/ size.r\n      } else {\n        this.imgH = this.height\n        this.imgW = this.height * size.r\n      }\n    },\n    \/\/ 获取裁切后的原始坐标宽高（裁切看到的宽高不是原始图片的宽高）\n    getCoord (l, t, w, h) {\n      l = this.scale * l\n      t = this.scale * t\n      w = this.scale * w\n      h = this.scale * h\n      return {\n        p0: [l, t],\n        p1: [l \x2b w, t],\n        p2: [l \x2b w, t \x2b h],\n        p3: [l, t \x2b h],\n        w: w,\n        h: h,\n        l: l,\n        t: t\n      }\n    },\n    \/\/ 获取是src图片的尺寸\n    getSize (src) {\n      let _this = this\n      let img = this.$el.querySelector(\x27#c-crop--hide_img\x27)\n      return new Promise(resolve =\x3e {\n        if (src \x26amp;\x26amp; img) {\n          img.onload = function () {\n            const size = _this.getSizeImg(img)\n            resolve(size)\n          }\n          img.src = src\n        } else {\n          resolve({\n            w: 0,\n            h: 0,\n            r: 0\n          })\n        }\n      })\n    },\n    \/\/ 获取原始图片的真实宽高、比例\n    getSizeImg (img) {\n      let w = img.width\n      let h = img.height\n      let r = w === 0 \x26amp;\x26amp; h === 0 ? 0 : w \/ h\n      return {\n        w: w,\n        h: h,\n        r: r\n      }\n    }\n\n  },\n  mounted () {\n    this.setSize()\n  }\n\n}\n\n\x3c\/script\x3e\n\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/script部分\x3c\/span\x3e\n\x26lt;script\x26gt;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e VueCropTool from \x3cspan class=\x22hljs-string\x22\x3e\x27.\/VueCropTool.vue\x27\x3c\/span\x3e\nexport \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  name: \x3cspan class=\x22hljs-string\x22\x3e\x27VueCrop\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e () {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 根据裁切后的缩放和坐标等生成的预览尺寸坐标数组\x3c\/span\x3e\n      previewImgSize: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 图片初始数据\x3c\/span\x3e\n      originImgSize: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 裁切框宽度\x3c\/span\x3e\n      elWidth: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 裁切框高度\x3c\/span\x3e\n      elHeight: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 裁切框top\x3c\/span\x3e\n      cursorTop: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 裁切框left\x3c\/span\x3e\n      cursorLeft: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 根据当前的容器宽高计算出的图片尺寸\x3c\/span\x3e\n      imgH: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n      imgW: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 图片url\x3c\/span\x3e\n      url: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropUrl,\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 为适应当前的容器对原始图片的缩放值\x3c\/span\x3e\n      scale: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 根据当前选区和原始图片缩放前的尺寸，来得到最终的裁切尺寸\x3c\/span\x3e\n      coord: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 计算出的裁切框的初始值\x3c\/span\x3e\n      cropJson: {\n        cw: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n        ch: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n        w: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n        h: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n        r: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n      }\n    }\n  },\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 暴露出去的参数，具体解释可看前文的表格\x3c\/span\x3e\n  props: {\n    cropUrl: String,\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 比例\x3c\/span\x3e\n    ratio: {\n      type: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n    },\n    width: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n    height: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n    coordWidth: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n    coordHeight: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n    previewJson: {\n      type: Array,\n      \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e: function () {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e []\n      }\n    }\n  },\n  components: {\n    VueCropTool\n  },\n  created () {\n  },\n  watch: {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 监听图片路径变化\x3c\/span\x3e\n    cropUrl (\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.url = \x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ setTimeout是为了兼容马上获取尺寸获取不到的情况\x3c\/span\x3e\n      setTimeout(() =\x26gt; {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setSize()\n      }, \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e)\n    }\n  },\n  methods: {\n       \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 更新拖拽尺寸，大部分由裁切框组件通过@updateSize触发\x3c\/span\x3e\n    drapSizeUpdate (w, h, t, l) {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 更新裁切框尺寸\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elWidth = w\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elHeight = h\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cursorTop = t\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cursorLeft = l\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 根据当前选区获取原始图片缩放前的尺寸（还原原始图片的宽高以获取最终裁切数据）\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.coord = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getCoord(l, t, w, h)\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 更新预览尺寸\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setPreviewSize(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.coord)\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 裁切完毕回调\x3c\/span\x3e\n    afterCrop () {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$emit(\x3cspan class=\x22hljs-string\x22\x3e\x27afterCrop\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.coord, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.url)\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置preview尺寸\x3c\/span\x3e\n    setPreviewSize (coord) {\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.previewJson.length) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n      }\n      let result = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.previewJson.map(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e =\x26gt; {\n           \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 计算缩放比\x3c\/span\x3e\n        let scale = \x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e.width \/ coord.w\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n          scale,\n          l: -scale * coord.l,\n          t: -scale * coord.t,\n          w: scale * \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.originImgSize.w,\n          h: scale * \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.originImgSize.h\n        }\n      })\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.previewImgSize = result\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置裁切显示的图片尺寸，存储scale值\x3c\/span\x3e\n    async setSize () {\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.url) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n      }\n      let imgSize = await \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getSize(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.url)\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.originImgSize = imgSize\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setCoordRange()\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.scale = imgSize.w \/ \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.imgW\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cursorTop = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cursorLeft = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n      let json = {...\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson}\n      json.w = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.imgW\n      json.h = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.imgH\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 有固定比例，则按比例截取\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.ratio) {\n        json.r = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.ratio\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (json.w \x26gt; json.h) {\n          let r = json.h * \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.ratio \/ json.w\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (r \x26gt; \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) {\n            json.ch = json.h \/ r\n            json.cw = json.ch * \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.ratio\n          } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            json.ch = json.h\n            json.cw = json.ch * \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.ratio\n          }\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n          let r = json.w \/ \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.ratio \/ json.h\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (r \x26gt; \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) {\n            json.cw = json.w \/ r\n            json.ch = json.cw \/ \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.ratio\n          } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            json.cw = json.w\n            json.ch = json.cw \/ \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.ratio\n          }\n        }\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n           \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 无比例\x3c\/span\x3e\n        json.cw = json.w\n        json.ch = json.h\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 裁切框的尺寸（\/2是取一半的值，使裁切框居中并宽度为一半）\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elWidth = json.cw \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elHeight = json.ch \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cursorTop = json.ch \/ \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cursorLeft = json.cw \/ \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson = {...json}\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.drapSizeUpdate(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elWidth, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elHeight, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cursorTop, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cursorLeft)\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 根据图片原本的尺寸比例和用户传入的尺寸宽高设置当前可显示的区域图片尺寸\x3c\/span\x3e\n    setCoordRange () {\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e size = {...\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.originImgSize}\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ratio1 = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width \/ \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ratio2 = size.r\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ratio2 \x26gt; ratio1) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.imgW = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.imgH = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width \/ size.r\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.imgH = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.imgW = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height * size.r\n      }\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取裁切后的原始坐标宽高（裁切看到的宽高不是原始图片的宽高）\x3c\/span\x3e\n    getCoord (l, t, w, h) {\n      l = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.scale * l\n      t = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.scale * t\n      w = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.scale * w\n      h = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.scale * h\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n        p0: [l, t],\n        p1: [l \x2b w, t],\n        p2: [l \x2b w, t \x2b h],\n        p3: [l, t \x2b h],\n        w: w,\n        h: h,\n        l: l,\n        t: t\n      }\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取是src图片的尺寸\x3c\/span\x3e\n    getSize (src) {\n      let _this = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n      let img = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$el.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27#c-crop--hide_img\x27\x3c\/span\x3e)\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e new Promise(resolve =\x26gt; {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (src \x26amp;\x26amp; img) {\n          img.onload = function () {\n            const size = _this.getSizeImg(img)\n            resolve(size)\n          }\n          img.src = src\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n          resolve({\n            w: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n            h: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n            r: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n          })\n        }\n      })\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取原始图片的真实宽高、比例\x3c\/span\x3e\n    getSizeImg (img) {\n      let w = img.width\n      let h = img.height\n      let r = w === \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e \x26amp;\x26amp; h === \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e ? \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e : w \/ h\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n        w: w,\n        h: h,\n        r: r\n      }\n    }\n\n  },\n  mounted () {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setSize()\n  }\n\n}\n\n\x26lt;\/script\x26gt;\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch5\x3e3.裁切框部分（\x3ca href=\x22https:\/\/github.com\/qiuyaofan\/vue-crop\/blob\/master\/src\/components\/VueCrop\/VueCropTool.vue\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eVueCropTool.vue全部源码链接\x3c\/a\x3e）\x3c\/h5\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/script部分\n\n\x3cscript\x3e\n\/\/ 引入拖拽js\nimport draggable from \x27..\/utils\/draggable\x27\n\/\/ 引入裁切尺寸计算js\nimport movePos from \x27.\/VueCropMove\x27\n\/\/ 和VueCropMove有关，序号对应相应的操作，这些类名对应裁切框的四条边，四个角，四个边上的中点，拖拽由这12个位置进行\nconst dragEle = [\x27.c-crop--drap_eline\x27, \x27.c-crop--drap_sline\x27, \x27.c-crop--drap_wline\x27, \x27.c-crop--drap_nline\x27, \x27.c-crop--drap_e\x27, \x27.c-crop--drap_s\x27, \x27.c-crop--drap_w\x27, \x27.c-crop--drap_n\x27, \x27.c-crop--drap_ne\x27, \x27.c-crop--drap_se\x27, \x27.c-crop--drap_sw\x27, \x27.c-crop--drap_nw\x27]\n\nexport default {\n  data () {\n    return {\n      width: this.elWidth,\n      height: this.elHeight,\n      top: this.cursorTop,\n      left: this.cursorLeft,\n      \/\/ 存储拖拽开始坐标（拖拽改变位置时）\n      startPos: [0, 0],\n      crop: [],\n      \/\/ 计时器\n      cropTimer: null,\n      \/\/ 存储拖拽开始坐标尺寸（拖拽改变尺寸时）\n      startSize: null\n    }\n  },\n  props: [\x27elWidth\x27, \x27elHeight\x27, \x27cursorTop\x27, \x27cursorLeft\x27, \x27cropJson\x27],\n  created () {},\n  watch: {\n    elWidth (val) {\n      this.width = val\n    },\n    elHeight (val) {\n      this.height = val\n    },\n    cursorTop (val) {\n      this.top = val\n    },\n    cursorLeft (val) {\n      this.left = val\n    }\n  },\n\n  methods: {\n    \/\/ 拖拽更新位置\n    handleDragLocation (event) {\n      let x = event.clientX\n      let y = event.clientY\n      this.left = x - this.startPos[0] \x2b this.left\n      this.top = y - this.startPos[1] \x2b this.top\n      this.startPos = [x, y]\n      this.handleSize()\n      \/\/ 更新尺寸\n      this.$emit(\x27updateSize\x27, this.width, this.height, this.top, this.left)\n      clearTimeout(this.cropTimer)\n      \/\/ setTimeout是为了拖拽完成才调用afterCrop\n      this.cropTimer = setTimeout(() =\x3e {\n        \/\/ 调用回调\n        this.$emit(\x27afterCrop\x27)\n      }, 200)\n    },\n    \/\/ 拖拽改变位置：绑定事件\n    dragCallLocation () {\n      draggable(this.$el.querySelector(\x27.c-crop--drap_screen\x27), {\n        start: (event) =\x3e {\n          this.startPos = [event.x, event.y]\n        },\n        drag: (event) =\x3e {\n          this.handleDragLocation(event)\n        },\n        end: (event) =\x3e {\n          this.handleDragLocation(event)\n        }\n      })\n    },\n    \/\/ 根据className获取父元素\n    getParentElement (p, className) {\n      const classNames = p.className\n      if (classNames.indexOf(className) === -1) {\n        p = p.parentNode\n        return this.getParentElement(p, className)\n      } else {\n        return p\n      }\n    },\n    \/\/ 获取拖拽的尺寸\n    getDragSize (event) {\n      const el = this.$el\n      const screen = this.$cropArea.getBoundingClientRect()\n      const rect = el.getBoundingClientRect()\n      let json = {\n        x: event.clientX,\n        y: event.clientY,\n        t: rect.top,\n        b: rect.bottom,\n        l: rect.left,\n        r: rect.right,\n        w: rect.width,\n        h: rect.height,\n        screen: screen\n      }\n      json.ratio = json.w \/ json.h\n      return json\n    },\n    \/\/ 拖拽改变大小\n    handleDrag (event, i) {\n      \/\/ 获取坐标\n      \/\/ console.info(\x27move\x27, i)\n      const json = this.getDragSize(event)\n      movePos[i](this, json, this.startSize)\n      this.handleSize(true)\n      this.$emit(\x27updateSize\x27, this.width, this.height, this.top, this.left)\n      clearTimeout(this.cropTimer)\n      this.cropTimer = setTimeout(() =\x3e {\n        \/\/ 调用回调\n        this.$emit(\x27afterCrop\x27)\n      }, 200)\n    },\n    \/\/ 拖拽改变大小：绑定事件\n    dragCall (i) {\n      let target = this.$el.querySelector(dragEle[i])\n      draggable(target, {\n        start: (event) =\x3e {\n          \/\/ 开始时拖拽框json\n          this.startSize = this.getDragSize(event)\n        },\n        drag: (event) =\x3e {\n          this.handleDrag(event, i)\n        },\n        end: (event) =\x3e {\n          this.handleDrag(event, i)\n        }\n      })\n    },\n    \/\/ 改变位置大小\n    handleSize (isSize) {\n      this.left = range2(this.left, this.width, this.cropJson.w)\n      this.top = range2(this.top, this.height, this.cropJson.h)\n      if (isSize) {\n        let d1 = this.cropJson.w - this.left\n        let d2 = this.cropJson.h - this.top\n        \/\/ 按比例裁切\n        if (this.cropJson.r) {\n          if (d1 \x3c this.width) {\n            this.width = d1\n            this.height = this.width \/ this.cropJson.r\n          } else if (d2 \x3c this.height) {\n            this.height = d2\n            this.width = this.height * this.cropJson.r\n          }\n        } else {\n          \/\/ 不按比例裁切\n          if (d1 \x3c this.width) {\n            this.width = d1\n          }\n          if (d2 \x3c this.height) {\n            this.height = d2\n          }\n        }\n      }\n    }\n\n  },\n  mounted () {\n    this.$cropArea = this.getParentElement(this.$el.parentNode, \x27c-crop--area\x27)\n    \/\/ 初始化拖拽改变大小\n    for (var i = 0; i \x3c dragEle.length; i\x2b\x2b) {\n      this.dragCall(i)\n    }\n    \/\/ 初始化拖拽改变位置\n    this.dragCallLocation()\n  }\n}\n\n\/\/ 计算允许的范围\nfunction range2 (pos, val, mainW) {\n  return pos \x3c= 0 ? 0 : pos \x3e mainW - val ? mainW - val : pos\n}\n\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/script部分\x3c\/span\x3e\n\n\x26lt;script\x26gt;\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 引入拖拽js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e draggable from \x3cspan class=\x22hljs-string\x22\x3e\x27..\/utils\/draggable\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 引入裁切尺寸计算js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e movePos from \x3cspan class=\x22hljs-string\x22\x3e\x27.\/VueCropMove\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 和VueCropMove有关，序号对应相应的操作，这些类名对应裁切框的四条边，四个角，四个边上的中点，拖拽由这12个位置进行\x3c\/span\x3e\nconst dragEle = [\x3cspan class=\x22hljs-string\x22\x3e\x27.c-crop--drap_eline\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.c-crop--drap_sline\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.c-crop--drap_wline\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.c-crop--drap_nline\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.c-crop--drap_e\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.c-crop--drap_s\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.c-crop--drap_w\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.c-crop--drap_n\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.c-crop--drap_ne\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.c-crop--drap_se\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.c-crop--drap_sw\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.c-crop--drap_nw\x27\x3c\/span\x3e]\n\nexport \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e () {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n      width: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elWidth,\n      height: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elHeight,\n      top: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cursorTop,\n      left: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cursorLeft,\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 存储拖拽开始坐标（拖拽改变位置时）\x3c\/span\x3e\n      startPos: [\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e],\n      crop: [],\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 计时器\x3c\/span\x3e\n      cropTimer: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 存储拖拽开始坐标尺寸（拖拽改变尺寸时）\x3c\/span\x3e\n      startSize: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n    }\n  },\n  props: [\x3cspan class=\x22hljs-string\x22\x3e\x27elWidth\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27elHeight\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27cursorTop\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27cursorLeft\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27cropJson\x27\x3c\/span\x3e],\n  created () {},\n  watch: {\n    elWidth (\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width = \x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e\n    },\n    elHeight (\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height = \x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e\n    },\n    cursorTop (\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.top = \x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e\n    },\n    cursorLeft (\x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.left = \x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e\n    }\n  },\n\n  methods: {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 拖拽更新位置\x3c\/span\x3e\n    handleDragLocation (event) {\n      let x = event.clientX\n      let y = event.clientY\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.left = x - \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.startPos[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e] \x2b \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.left\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.top = y - \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.startPos[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e] \x2b \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.top\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.startPos = [x, y]\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleSize()\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 更新尺寸\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$emit(\x3cspan class=\x22hljs-string\x22\x3e\x27updateSize\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.top, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.left)\n      clearTimeout(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropTimer)\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ setTimeout是为了拖拽完成才调用afterCrop\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropTimer = setTimeout(() =\x26gt; {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 调用回调\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$emit(\x3cspan class=\x22hljs-string\x22\x3e\x27afterCrop\x27\x3c\/span\x3e)\n      }, \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e)\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 拖拽改变位置：绑定事件\x3c\/span\x3e\n    dragCallLocation () {\n      draggable(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$el.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27.c-crop--drap_screen\x27\x3c\/span\x3e), {\n        start: (event) =\x26gt; {\n          \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.startPos = [event.x, event.y]\n        },\n        drag: (event) =\x26gt; {\n          \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleDragLocation(event)\n        },\n        end: (event) =\x26gt; {\n          \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleDragLocation(event)\n        }\n      })\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 根据className获取父元素\x3c\/span\x3e\n    getParentElement (p, className) {\n      const classNames = p.className\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (classNames.indexOf(className) === \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e) {\n        p = p.parentNode\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getParentElement(p, className)\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e p\n      }\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取拖拽的尺寸\x3c\/span\x3e\n    getDragSize (event) {\n      const el = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$el\n      const screen = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$cropArea.getBoundingClientRect()\n      const rect = el.getBoundingClientRect()\n      let json = {\n        x: event.clientX,\n        y: event.clientY,\n        t: rect.top,\n        b: rect.bottom,\n        l: rect.left,\n        r: rect.right,\n        w: rect.width,\n        h: rect.height,\n        screen: screen\n      }\n      json.ratio = json.w \/ json.h\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e json\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 拖拽改变大小\x3c\/span\x3e\n    handleDrag (event, i) {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取坐标\x3c\/span\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ console.info(\x27move\x27, i)\x3c\/span\x3e\n      const json = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getDragSize(event)\n      movePos[i](\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.startSize)\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleSize(\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e)\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$emit(\x3cspan class=\x22hljs-string\x22\x3e\x27updateSize\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.top, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.left)\n      clearTimeout(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropTimer)\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropTimer = setTimeout(() =\x26gt; {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 调用回调\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$emit(\x3cspan class=\x22hljs-string\x22\x3e\x27afterCrop\x27\x3c\/span\x3e)\n      }, \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e)\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 拖拽改变大小：绑定事件\x3c\/span\x3e\n    dragCall (i) {\n      let target = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$el.querySelector(dragEle[i])\n      draggable(target, {\n        start: (event) =\x26gt; {\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 开始时拖拽框json\x3c\/span\x3e\n          \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.startSize = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getDragSize(event)\n        },\n        drag: (event) =\x26gt; {\n          \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleDrag(event, i)\n        },\n        end: (event) =\x26gt; {\n          \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleDrag(event, i)\n        }\n      })\n    },\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 改变位置大小\x3c\/span\x3e\n    handleSize (isSize) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.left = range2(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.left, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson.w)\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.top = range2(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.top, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson.h)\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (isSize) {\n        let d1 = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson.w - \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.left\n        let d2 = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson.h - \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.top\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 按比例裁切\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson.r) {\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (d1 \x26lt; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width = d1\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width \/ \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson.r\n          } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (d2 \x26lt; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height = d2\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height * \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson.r\n          }\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 不按比例裁切\x3c\/span\x3e\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (d1 \x26lt; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width = d1\n          }\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (d2 \x26lt; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height = d2\n          }\n        }\n      }\n    }\n\n  },\n  mounted () {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$cropArea = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.getParentElement(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$el.parentNode, \x3cspan class=\x22hljs-string\x22\x3e\x27c-crop--area\x27\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 初始化拖拽改变大小\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; dragEle.length; i\x2b\x2b) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.dragCall(i)\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 初始化拖拽改变位置\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.dragCallLocation()\n  }\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 计算允许的范围\x3c\/span\x3e\nfunction range2 (pos, \x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e, mainW) {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e pos \x26lt;= \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e ? \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e : pos \x26gt; mainW - \x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e ? mainW - \x3cspan class=\x22hljs-keyword\x22\x3eval\x3c\/span\x3e : pos\n}\n\n\x26lt;\/script\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch5\x3e4.计算裁切框的js（\x3ca href=\x22https:\/\/github.com\/qiuyaofan\/vue-crop\/blob\/master\/src\/components\/VueCrop\/VueCropMove.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eVueCropMove.js全部源码链接\x3c\/a\x3e）\x3c\/h5\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 12种形态，四条边，边的中点，边的四个角。e:东，w:西，n:北，s:南，ne:东南以此类推\nconst movePos = {\n  0: e,\n  4: e,\n  1: s,\n  5: s,\n  2: w,\n  6: w,\n  3: n,\n  7: n,\n  8: ne,\n  9: se,\n  10: sw,\n  11: nw\n}\nlet width, height, result, ratio\n\n\/\/ 获取某种形态类型的宽或高最大值\nfunction getMaxSize (json, startJson, dire, type) {\n  if (type === \x27w\x27) {\n    switch (dire) {\n      case \x27e\x27:\n      case \x27s\x27:\n      case \x27n\x27:\n      case \x27ne\x27:\n      case \x27se\x27:\n        return json.screen.right - json.l\n      case \x27w\x27:\n      case \x27nw\x27:\n      case \x27sw\x27:\n        return startJson.r - json.screen.left\n    }\n  } else if (type === \x27h\x27) {\n    switch (dire) {\n      case \x27n\x27:\n      case \x27nw\x27:\n      case \x27ne\x27:\n        return startJson.b - json.screen.top\n      case \x27s\x27:\n      case \x27w\x27:\n      case \x27e\x27:\n      case \x27sw\x27:\n      case \x27se\x27:\n        return json.screen.bottom - startJson.t\n    }\n  }\n}\n\/\/ 判断是否有ratio,返回修改后的尺寸\nfunction setRatioSize (type, json, startJson, ratio, width, height) {\n  if (ratio) {\n    if (width \/ ratio \x3e= height) {\n      var maxHeight = getMaxSize(json, startJson, type, \x27h\x27)\n      height = width \/ ratio\n      if (height \x3e maxHeight) {\n        height = maxHeight\n        width = height * ratio\n      }\n    } else {\n      var maxWidth = getMaxSize(json, startJson, type, \x27w\x27)\n      width = height * ratio\n      if (width \x3e maxWidth) {\n        width = maxWidth\n        height = width \/ ratio\n      }\n    }\n  }\n  return {\n    width: width,\n    height: height\n  }\n}\n\/\/ 拖拽东边，高度是不变的，除非有比例拖拽时\nfunction e (_this, json, startJson) {\n  ratio = _this.cropJson.r\n  width = range(getWidth(json, startJson, \x27e\x27), getMaxSize(json, startJson, \x27e\x27, \x27w\x27))\n  if (ratio) {\n      \/\/ 有比例时，计算高度，并对比最大值是否超出\n    height = range(width \/ ratio, getMaxSize(json, startJson, \x27e\x27, \x27h\x27))\n    result = setRatioSize(\x27e\x27, json, startJson, ratio, width, height)\n    setSize(_this, result)\n  } else {\n    _this.width = width\n  }\n  return _this\n}\n\n\/\/ 拖拽南边，宽度是不变的，除非有比例拖拽时\nfunction s (_this, json, startJson) {\n  ratio = _this.cropJson.r\n  height = range(getHeight(json, startJson, \x27s\x27), getMaxSize(json, startJson, \x27s\x27, \x27h\x27))\n  if (ratio) {\n    \/\/ 有比例时，计算宽度，并对比最大值是否超出\n    width = range(height * ratio, getMaxSize(json, startJson, \x27s\x27, \x27w\x27))\n    result = setRatioSize(\x27s\x27, json, startJson, ratio, width, height)\n    setSize(_this, result)\n  } else {\n    _this.height = height\n  }\n\n  return _this\n}\n\n\/\/ 以下同上，以此类推\nfunction w (_this, json, startJson) {\n  ratio = _this.cropJson.r\n  width = range(getWidth(json, startJson, \x27w\x27), getMaxSize(json, startJson, \x27w\x27, \x27w\x27))\n  if (ratio) {\n    height = range(width \/ ratio, getMaxSize(json, startJson, \x27w\x27, \x27h\x27))\n    result = setRatioSize(\x27w\x27, json, startJson, ratio, width, height)\n    setSize(_this, result)\n    _this.left = getLeft(_this, json, startJson)\n  } else {\n    _this.width = width\n    _this.left = rangeMax(json.x - json.screen.left, startJson.r)\n  }\n  return _this\n}\nfunction n (_this, json, startJson) {\n  ratio = _this.cropJson.r\n  height = range(getHeight(json, startJson, \x27n\x27), getMaxSize(json, startJson, \x27n\x27, \x27h\x27))\n  if (ratio) {\n    width = range(height * ratio, getMaxSize(json, startJson, \x27n\x27, \x27w\x27))\n    result = setRatioSize(\x27n\x27, json, startJson, ratio, width, height)\n    setSize(_this, result)\n    _this.top = getTop(_this, json, startJson)\n  } else {\n    _this.height = height\n    _this.top = rangeMax(json.y - json.screen.top, startJson.b)\n  }\n  return _this\n}\n\nfunction ne (_this, json, startJson) {\n  height = range(getHeight(json, startJson, \x27n\x27), getMaxSize(json, startJson, \x27ne\x27, \x27h\x27))\n  width = range(getWidth(json, startJson, \x27e\x27), getMaxSize(json, startJson, \x27ne\x27, \x27w\x27))\n  result = setRatioSize(\x27ne\x27, json, startJson, _this.cropJson.r, width, height)\n  setSize(_this, result)\n  _this.top = getTop(_this, json, startJson)\n  return _this\n}\nfunction se (_this, json, startJson) {\n  height = range(getHeight(json, startJson, \x27s\x27), getMaxSize(json, startJson, \x27se\x27, \x27h\x27))\n  width = range(getWidth(json, startJson, \x27e\x27), getMaxSize(json, startJson, \x27se\x27, \x27w\x27))\n  result = setRatioSize(\x27se\x27, json, startJson, _this.cropJson.r, width, height)\n  setSize(_this, result)\n  return _this\n}\nfunction sw (_this, json, startJson) {\n  width = range(getWidth(json, startJson, \x27w\x27), getMaxSize(json, startJson, \x27sw\x27, \x27w\x27))\n  height = range(getHeight(json, startJson, \x27s\x27), getMaxSize(json, startJson, \x27sw\x27, \x27h\x27))\n  result = setRatioSize(\x27sw\x27, json, startJson, _this.cropJson.r, width, height)\n  setSize(_this, result)\n  _this.left = getLeft(_this, json, startJson)\n  return _this\n}\nfunction nw (_this, json, startJson) {\n  width = range(getWidth(json, startJson, \x27w\x27), getMaxSize(json, startJson, \x27nw\x27, \x27w\x27))\n  height = range(getHeight(json, startJson, \x27n\x27), getMaxSize(json, startJson, \x27nw\x27, \x27h\x27))\n  result = setRatioSize(\x27nw\x27, json, startJson, _this.cropJson.r, width, height)\n  setSize(_this, result)\n  _this.left = getLeft(_this, json, startJson)\n  _this.top = getTop(_this, json, startJson)\n  return _this\n}\n\n\/\/ 匹配范围\nfunction range (value, max) {\n  value = value \x3e max ? max : value\n  return value \x3c 20 ? 20 : value\n}\n\/\/ 最大值\nfunction rangeMax (value, max) {\n  return value \x3e max ? max : value\n}\n\/\/ top\nfunction getTop (_this, json, startJson) {\n  return rangeMax(startJson.b - _this.height - json.screen.top, startJson.b)\n}\n\/\/ left\nfunction getLeft (_this, json, startJson) {\n  return rangeMax(startJson.r - _this.width - json.screen.left, startJson.r)\n}\n\/\/ height：只存在于s||n类型\nfunction getHeight (json, startJson, type) {\n  return type === \x27n\x27 ? startJson.b - json.y : json.y - startJson.t\n}\n\/\/ width：只存在于w||e类型\nfunction getWidth (json, startJson, type) {\n  return type === \x27w\x27 ? startJson.r - json.x : json.x - startJson.l\n}\n\/\/ setSize\nfunction setSize (_this, result) {\n  _this.width = result.width\n  _this.height = result.height\n}\n\nexport default movePos\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ceylon\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 12种形态，四条边，边的中点，边的四个角。e:东，w:西，n:北，s:南，ne:东南以此类推\x3c\/span\x3e\nconst movePos = {\n  \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e: e,\n  \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e: e,\n  \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e: s,\n  \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e: s,\n  \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e: w,\n  \x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e: w,\n  \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e: n,\n  \x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e: n,\n  \x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e: ne,\n  \x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3e: se,\n  \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e: sw,\n  \x3cspan class=\x22hljs-number\x22\x3e11\x3c\/span\x3e: nw\n}\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e width, height, result, ratio\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取某种形态类型的宽或高最大值\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e getMaxSize (json, startJson, dire, type) {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (type === \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e (dire) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27e\x27\x3c\/span\x3e:\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27s\x27\x3c\/span\x3e:\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27n\x27\x3c\/span\x3e:\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27ne\x27\x3c\/span\x3e:\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27se\x27\x3c\/span\x3e:\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e json.screen.right - json.l\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e:\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27nw\x27\x3c\/span\x3e:\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27sw\x27\x3c\/span\x3e:\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e startJson.r - json.screen.left\n    }\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (type === \x3cspan class=\x22hljs-string\x22\x3e\x27h\x27\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e (dire) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27n\x27\x3c\/span\x3e:\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27nw\x27\x3c\/span\x3e:\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27ne\x27\x3c\/span\x3e:\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e startJson.b - json.screen.top\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27s\x27\x3c\/span\x3e:\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e:\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27e\x27\x3c\/span\x3e:\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27sw\x27\x3c\/span\x3e:\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27se\x27\x3c\/span\x3e:\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e json.screen.bottom - startJson.t\n    }\n  }\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 判断是否有ratio,返回修改后的尺寸\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e setRatioSize (type, json, startJson, ratio, width, height) {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ratio) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (width \/ ratio \x26gt;= height) {\n      var maxHeight = getMaxSize(json, startJson, type, \x3cspan class=\x22hljs-string\x22\x3e\x27h\x27\x3c\/span\x3e)\n      height = width \/ ratio\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (height \x26gt; maxHeight) {\n        height = maxHeight\n        width = height * ratio\n      }\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      var maxWidth = getMaxSize(json, startJson, type, \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e)\n      width = height * ratio\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (width \x26gt; maxWidth) {\n        width = maxWidth\n        height = width \/ ratio\n      }\n    }\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n    width: width,\n    height: height\n  }\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 拖拽东边，高度是不变的，除非有比例拖拽时\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e e (\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson) {\n  ratio = \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson.r\n  width = range(getWidth(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27e\x27\x3c\/span\x3e), getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27e\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e))\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ratio) {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 有比例时，计算高度，并对比最大值是否超出\x3c\/span\x3e\n    height = range(width \/ ratio, getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27e\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27h\x27\x3c\/span\x3e))\n    result = setRatioSize(\x3cspan class=\x22hljs-string\x22\x3e\x27e\x27\x3c\/span\x3e, json, startJson, ratio, width, height)\n    setSize(\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, result)\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width = width\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 拖拽南边，宽度是不变的，除非有比例拖拽时\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e s (\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson) {\n  ratio = \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson.r\n  height = range(getHeight(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27s\x27\x3c\/span\x3e), getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27s\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27h\x27\x3c\/span\x3e))\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ratio) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 有比例时，计算宽度，并对比最大值是否超出\x3c\/span\x3e\n    width = range(height * ratio, getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27s\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e))\n    result = setRatioSize(\x3cspan class=\x22hljs-string\x22\x3e\x27s\x27\x3c\/span\x3e, json, startJson, ratio, width, height)\n    setSize(\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, result)\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height = height\n  }\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 以下同上，以此类推\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e w (\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson) {\n  ratio = \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson.r\n  width = range(getWidth(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e), getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e))\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ratio) {\n    height = range(width \/ ratio, getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27h\x27\x3c\/span\x3e))\n    result = setRatioSize(\x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e, json, startJson, ratio, width, height)\n    setSize(\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, result)\n    \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.left = getLeft(\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson)\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width = width\n    \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.left = rangeMax(json.x - json.screen.left, startJson.r)\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e n (\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson) {\n  ratio = \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson.r\n  height = range(getHeight(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27n\x27\x3c\/span\x3e), getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27n\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27h\x27\x3c\/span\x3e))\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (ratio) {\n    width = range(height * ratio, getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27n\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e))\n    result = setRatioSize(\x3cspan class=\x22hljs-string\x22\x3e\x27n\x27\x3c\/span\x3e, json, startJson, ratio, width, height)\n    setSize(\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, result)\n    \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.top = getTop(\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson)\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height = height\n    \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.top = rangeMax(json.y - json.screen.top, startJson.b)\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e ne (\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson) {\n  height = range(getHeight(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27n\x27\x3c\/span\x3e), getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27ne\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27h\x27\x3c\/span\x3e))\n  width = range(getWidth(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27e\x27\x3c\/span\x3e), getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27ne\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e))\n  result = setRatioSize(\x3cspan class=\x22hljs-string\x22\x3e\x27ne\x27\x3c\/span\x3e, json, startJson, \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson.r, width, height)\n  setSize(\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, result)\n  \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.top = getTop(\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e se (\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson) {\n  height = range(getHeight(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27s\x27\x3c\/span\x3e), getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27se\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27h\x27\x3c\/span\x3e))\n  width = range(getWidth(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27e\x27\x3c\/span\x3e), getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27se\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e))\n  result = setRatioSize(\x3cspan class=\x22hljs-string\x22\x3e\x27se\x27\x3c\/span\x3e, json, startJson, \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson.r, width, height)\n  setSize(\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, result)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e sw (\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson) {\n  width = range(getWidth(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e), getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27sw\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e))\n  height = range(getHeight(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27s\x27\x3c\/span\x3e), getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27sw\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27h\x27\x3c\/span\x3e))\n  result = setRatioSize(\x3cspan class=\x22hljs-string\x22\x3e\x27sw\x27\x3c\/span\x3e, json, startJson, \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson.r, width, height)\n  setSize(\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, result)\n  \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.left = getLeft(\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e nw (\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson) {\n  width = range(getWidth(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e), getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27nw\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e))\n  height = range(getHeight(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27n\x27\x3c\/span\x3e), getMaxSize(json, startJson, \x3cspan class=\x22hljs-string\x22\x3e\x27nw\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27h\x27\x3c\/span\x3e))\n  result = setRatioSize(\x3cspan class=\x22hljs-string\x22\x3e\x27nw\x27\x3c\/span\x3e, json, startJson, \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cropJson.r, width, height)\n  setSize(\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, result)\n  \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.left = getLeft(\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson)\n  \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.top = getTop(\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 匹配范围\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e range (\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e, max) {\n  \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e = \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e \x26gt; max ? max : \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e \x26lt; \x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e ? \x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e : \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 最大值\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e rangeMax (\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e, max) {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e \x26gt; max ? max : \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ top\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e getTop (\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson) {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e rangeMax(startJson.b - \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height - json.screen.top, startJson.b)\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ left\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e getLeft (\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, json, startJson) {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e rangeMax(startJson.r - \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width - json.screen.left, startJson.r)\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ height：只存在于s||n类型\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e getHeight (json, startJson, type) {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e type === \x3cspan class=\x22hljs-string\x22\x3e\x27n\x27\x3c\/span\x3e ? startJson.b - json.y : json.y - startJson.t\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ width：只存在于w||e类型\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e getWidth (json, startJson, type) {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e type === \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e ? startJson.r - json.x : json.x - startJson.l\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ setSize\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e setSize (\x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, result) {\n  \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.width = result.width\n  \x3cspan class=\x22hljs-number\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.height = result.height\n}\n\nexport \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e movePos\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e今天就分享到这里啦～喜欢这个插件可以去 \x3ca href=\x22https:\/\/github.com\/qiuyaofan\/vue-crop\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3egithub star~\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>手把手教你写vue裁切预览组件</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000014772044">https://segmentfault.com/a/1190000014772044</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/o6sg7qmt7p/" target="_blank">https://alili.tech/archive/o6sg7qmt7p/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>