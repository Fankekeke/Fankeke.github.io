<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="现在做 Web 全景合适吗？"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>现在做 Web 全景合适吗？ | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/ool0xz9pwq/",
				"appid": "1613049289050283", 
				"title": "现在做 Web 全景合适吗？ | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-19T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/gutdaylyer/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/pgetwclpn1m/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fool0xz9pwq%2f&text=%e7%8e%b0%e5%9c%a8%e5%81%9a%20Web%20%e5%85%a8%e6%99%af%e5%90%88%e9%80%82%e5%90%97%ef%bc%9f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fool0xz9pwq%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fool0xz9pwq%2f&text=%e7%8e%b0%e5%9c%a8%e5%81%9a%20Web%20%e5%85%a8%e6%99%af%e5%90%88%e9%80%82%e5%90%97%ef%bc%9f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fool0xz9pwq%2f&title=%e7%8e%b0%e5%9c%a8%e5%81%9a%20Web%20%e5%85%a8%e6%99%af%e5%90%88%e9%80%82%e5%90%97%ef%bc%9f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fool0xz9pwq%2f&is_video=false&description=%e7%8e%b0%e5%9c%a8%e5%81%9a%20Web%20%e5%85%a8%e6%99%af%e5%90%88%e9%80%82%e5%90%97%ef%bc%9f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e7%8e%b0%e5%9c%a8%e5%81%9a%20Web%20%e5%85%a8%e6%99%af%e5%90%88%e9%80%82%e5%90%97%ef%bc%9f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fool0xz9pwq%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fool0xz9pwq%2f&title=%e7%8e%b0%e5%9c%a8%e5%81%9a%20Web%20%e5%85%a8%e6%99%af%e5%90%88%e9%80%82%e5%90%97%ef%bc%9f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fool0xz9pwq%2f&title=%e7%8e%b0%e5%9c%a8%e5%81%9a%20Web%20%e5%85%a8%e6%99%af%e5%90%88%e9%80%82%e5%90%97%ef%bc%9f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fool0xz9pwq%2f&title=%e7%8e%b0%e5%9c%a8%e5%81%9a%20Web%20%e5%85%a8%e6%99%af%e5%90%88%e9%80%82%e5%90%97%ef%bc%9f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fool0xz9pwq%2f&title=%e7%8e%b0%e5%9c%a8%e5%81%9a%20Web%20%e5%85%a8%e6%99%af%e5%90%88%e9%80%82%e5%90%97%ef%bc%9f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">现在做 Web 全景合适吗？</h1><div class="meta"><div class="postdate"><time datetime="2018-12-19" itemprop="datePublished">2018-12-19</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3eWeb 全景在以前带宽有限的条件下常常用来作为街景和 360° 全景图片的查看。它可以给用户一种 self-immersive 的体验，通过简单的操作，自由的查看周围的物体。随着一些运营商推出大王卡等免流服务，以及 4G 环境的普及，大流量的应用也逐渐得到推广。比如，我们是否可以将静态低流量的全景图片，变为动态直播的全景视频呢？在一定网速带宽下，是可以实现的。后面，我们来了解一下，如何在 Web 端实现全景视频。先看一下实例 gif：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012687398?w=273\x26amp;h=370\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012687398?w=273\x26amp;h=370\x22 alt=\x22gif\x22 title=\x22gif\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3etl;dr;\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e使用 three.js 实现全景技术\x3c\/li\x3e\n\x3cli\x3eUV 映射原理简介\x3c\/li\x3e\n\x3cli\x3e3D 坐标原理和移动控制\x3c\/li\x3e\n\x3cli\x3eWeb 陀螺仪简介\x3c\/li\x3e\n\x3cli\x3eiv-panorama 简单库介绍\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e基于 Three.js\x3c\/h2\x3e\n\x3cp\x3e全景视频是基于 3D 空间，而在 Web 中，能够非常方便触摸到 3D 空间的技术，就是 WebGL。为了简化，这里就直接采用 Three.js 库。具体的工作原理就是将正在播放的 video 元素，映射到纹理(texture) 空间中，通过 UV 映射，直接贴到一个球面上。精简代码为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let camera = new THREE.PerspectiveCamera(75, window.innerWidth \/ window.innerHeight, 1, 1100); \n\/\/ 添加相机\n\n\ncamera.target = new THREE.Vector3(0, 0, 0); \n\/\/ 设置相机的观察位置，通常在球心\n\nscene = new THREE.Scene();\nlet  geometry = new THREE.SphereBufferGeometry(400, 60, 60);\n\/\/ 在贴图的时候，让像素点朝内（非常重要）\ngeometry.scale(-1, 1, 1);\n\n\/\/ 传入视频 VideoEle 进行绘制\nvar texture = new THREE.VideoTexture(videoElement);\n\nvar material = new THREE.MeshBasicMaterial({ map: texture });\nmesh = new THREE.Mesh(geometry, material);\nscene.add(mesh);\n\n\nrenderer = new THREE.WebGLRenderer();\nrenderer.setPixelRatio(window.devicePixelRatio); \/\/ canvas 的比例\nrenderer.setSize(window.innerWidth, window.innerHeight);\ncontainer.appendChild(renderer.domElement);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode\x3elet camera = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eTHREE\x3c\/span\x3e.PerspectiveCamera(\x3cspan class=\x22hljs-number\x22\x3e75\x3c\/span\x3e, window.innerWidth \/ window.innerHeight, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1100\x3c\/span\x3e); \n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 添加相机\x3c\/span\x3e\n\n\ncamera.target = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eTHREE\x3c\/span\x3e.Vector3(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e); \n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置相机的观察位置，通常在球心\x3c\/span\x3e\n\nscene = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eTHREE\x3c\/span\x3e.Scene();\nlet  geometry = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eTHREE\x3c\/span\x3e.SphereBufferGeometry(\x3cspan class=\x22hljs-number\x22\x3e400\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e60\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e60\x3c\/span\x3e);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在贴图的时候，让像素点朝内（非常重要）\x3c\/span\x3e\ngeometry.scale(\x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 传入视频 VideoEle 进行绘制\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e texture = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eTHREE\x3c\/span\x3e.VideoTexture(videoElement);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e material = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eTHREE\x3c\/span\x3e.MeshBasicMaterial({ map: \x3cspan class=\x22hljs-type\x22\x3etexture \x3c\/span\x3e});\nmesh = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eTHREE\x3c\/span\x3e.Mesh(geometry, material);\nscene.add(mesh);\n\n\nrenderer = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eTHREE\x3c\/span\x3e.WebGLRenderer();\nrenderer.setPixelRatio(window.devicePixelRatio); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ canvas 的比例\x3c\/span\x3e\nrenderer.setSize(window.innerWidth, window.innerHeight);\ncontainer.appendChild(renderer.domElement);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e具体的过程差不多就是上面的代码。上面代码中有两块需要注意一下，一个是 相机的视野范围值，一个是几何球体的相关参数设置。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e相机视野范围\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e具体代码为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let camera = new THREE.PerspectiveCamera(75, window.innerWidth \/ window.innerHeight, 1, 1100); \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gauss\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e camera = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e THREE.PerspectiveCamera(\x3cspan class=\x22hljs-number\x22\x3e75\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.innerWidth \/ \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.innerHeight, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1100\x3c\/span\x3e); \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里主要利用透视类型的相机，模拟人眼的效果。设置合适的视野效果，这里的范围还需要根据球体的直径来决定，通常为 2*radius \x2b 100，反正只要比球体直径大就行。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e几何球体的参数设置\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let  geometry = new THREE.SphereBufferGeometry(400, 60, 60);\n\/\/ 在贴图的时候，让像素点朝内（非常重要）\ngeometry.scale(-1, 1, 1);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lsl\x22\x3e\x3ccode\x3elet  geometry = new THREE.SphereBufferGeometry(\x3cspan class=\x22hljs-number\x22\x3e400\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e60\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e60\x3c\/span\x3e);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在贴图的时候，让像素点朝内（非常重要）\x3c\/span\x3e\ngeometry.scale(\x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面其实有两个部分需要讲解一下\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3e球体参数设置里面有三个属性值比较重要，该 API 格式为：\x3ccode\x3eSphereBufferGeometry(radius, widthSegments, heightSegments,...)\x3c\/code\x3e。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eraidus： 设置球体的半径，半径越大，视频在 canvas 上绘制的内容也会被放大，该设置值合适就行。\x3c\/li\x3e\n\x3cli\x3ewidth\/height Segments: 切片数，主要用来控制球体在宽高两个维度上最多细分为多少个三角切片数量，越高纹理拼接的边角越清晰。不过，并不是无限制高的，高的同时性能损耗也是有的。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e在几何绘制时，通过坐标变换使 X 轴的像素点朝内，让用户看起来不会存在 凸出放大的效果。具体代码为：\x3ccode\x3egeometry.scale(-1, 1, 1)\x3c\/code\x3e。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3eUV 映射\x3c\/h2\x3e\n\x3cp\x3e上面只是简单介绍了一下代码，如果仅仅只是为了应用，那么这也就足够了。但是，如果后面遇到优化的问题，不知道更底层的或者更细节内容的话，就感觉很尴尬。在全景视频中，有两个非常重要的点：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eUV 映射\x3c\/li\x3e\n\x3cli\x3e3D 移动\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e这里，我们主要探索一下 UV 映射的细节。UV 映射主要目的就是将 2D 图片映射到三维物体上，最经典的解释就是：\x3c\/p\x3e\n\x3cblockquote\x3e盒子是一个三维物体,正如同加到场景中的一个曲面网络(\x22mesh\x22)方块.\x3cbr\x3e如果沿着边缝或折痕剪开盒子,可以把盒子摊开在一个桌面上.当我们从上往下俯视桌子时,我们可以认为U是左右方向,V是上下方向.盒子上的图片就在一个二维坐标中.我们使用U V代表\x22纹理坐标系\x22来代替通常在三维空间使用的 X Y.\x3cbr\x3e在盒子重新被组装时,纸板上的特定的UV坐标被对应到盒子的一个空间(X Y Z)位置.这就是将2D图像包裹在3D物体上时计算机所做的.\x3c\/blockquote\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012687399?w=1342\x26amp;h=586\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012687399?w=1342\x26amp;h=586\x22 alt=\x22image.png-544.6kB\x22 title=\x22image.png-544.6kB\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e from \x3ca href=\x22http:\/\/xbbj.zust.edu.cn\/upload\/html\/201706009.htmluo.com\/jimmythr\/jqh2gxnjt0iu9thu4w1xoocg\/image.png\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e浙江研报\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e这里，我们通过代码来细致讲解一下。我们需要完成一个贴图，将如下的 sprite，贴到一个正方体上。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012687400?w=288\x26amp;h=432\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012687400?w=288\x26amp;h=432\x22 alt=\x22sprite\x22 title=\x22sprite\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3efrom iefreer\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012687401?w=564\x26amp;h=610\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012687401?w=564\x26amp;h=610\x22 alt=\x22cube\x22 title=\x22cube\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e这里，我们先将图片加载到纹理空间：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var material = new THREE.MeshPhongMaterial( { map: THREE.ImageUtils.loadTexture(\x27images\/texture-atlas.jpg\x27) } );\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs go\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e material = \x3cspan class=\x22hljs-built_in\x22\x3enew\x3c\/span\x3e THREE.MeshPhongMaterial( { \x3cspan class=\x22hljs-keyword\x22\x3emap\x3c\/span\x3e: THREE.ImageUtils.loadTexture(\x3cspan class=\x22hljs-string\x22\x3e\x27images\/texture-atlas.jpg\x27\x3c\/span\x3e) } );\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e那么，现在我们有一个如下的纹理空间区域：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012687402?w=333\x26amp;h=333\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012687402?w=333\x26amp;h=333\x22 alt=\x22此处输入图片的描述\x22 title=\x22此处输入图片的描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e这块内容，就实际涉及到 WebGL 的知识，纹理空间和物理空间并不是在一块，WebGL 中的 GLSL 语法，就是将纹理内容通过相关规则，映射到指定的三角形区域的表面。\x3c\/p\x3e\n\x3cp\x3e这里需要注意的是，纹理空间并不存在所谓的最小三角区域，这里适应的只是在物理空间中划分的三角区域。为了简单起见，我们设置的 boxGeometry 只使用单位为 1 的 Segments，减少需要划分的三角形数量。\x3c\/p\x3e\n\x3cp\x3e这样，就存在 12 块需要贴的三角区域。这里，我们就需要利用 \x3ccode\x3eVector2\x3c\/code\x3e 来手动划分一下纹理空间的区域，实际在映射的时候，就是按顺序，将物理空间的定点 和 纹理空间的定点一一映射，这样就实现了将纹理和物理空间联系到一起的步骤。\x3c\/p\x3e\n\x3cp\x3e因为，Three.js 中 \x3ccode\x3egeometry.faceVertexUvs\x3c\/code\x3e 在划分物理空间时，定义的面分解三角形的顺序 是 根据逆时针方向，按序号划分，如下图所示：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012687403?w=172\x26amp;h=197\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012687403?w=172\x26amp;h=197\x22 alt=\x22此处输入图片的描述\x22 title=\x22此处输入图片的描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e根据上图的定义，我们可以得到每个几何物体的面映射到纹理空间的坐标值可以分为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22left-bottom = [0,1,3]\nright-top = [1,2,3]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lsl\x22\x3e\x3ccode\x3eleft-bottom = [\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e]\nright-top = [\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e所以，我们需要定义一下纹理坐标值：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22face1_left = [new THREE.Vector2(0, 0),new THREE.Vector2(.5, 0),new THREE.Vector2(0, .333)]\nface1_right = [new THREE.Vector2(.5, 0),new THREE.Vector2(.5, .333),new THREE.Vector2(0, .333)]\n\n\/\/... 剩下 10 个面\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode\x3eface1_left = [\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eTHREE\x3c\/span\x3e.Vector2(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e),\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eTHREE\x3c\/span\x3e.Vector2(\x3cspan class=\x22hljs-number\x22\x3e.5\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e),\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eTHREE\x3c\/span\x3e.Vector2(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e.333\x3c\/span\x3e)]\nface1_right = [\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eTHREE\x3c\/span\x3e.Vector2(\x3cspan class=\x22hljs-number\x22\x3e.5\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e),\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eTHREE\x3c\/span\x3e.Vector2(\x3cspan class=\x22hljs-number\x22\x3e.5\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e.333\x3c\/span\x3e),\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eTHREE\x3c\/span\x3e.Vector2(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e.333\x3c\/span\x3e)]\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/... 剩下 10 个面\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e定点 UV 映射 API 具体格式为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22geometry.faceVertexUvs[ 0 ][ faceIndex ][ vertexIndex ]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs markdown\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3egeometry.faceVertexUvs[\x3cspan class=\x22hljs-string\x22\x3e 0 \x3c\/span\x3e][\x3cspan class=\x22hljs-symbol\x22\x3e faceIndex \x3c\/span\x3e][\x3cspan class=\x22hljs-string\x22\x3e vertexIndex \x3c\/span\x3e]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e则定义具体面的映射为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22geometry.faceVertexUvs[0][0] = face1_left;\ngeometry.faceVertexUvs[0][0] = face1_right;\n\/\/...剩下 10 个面\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs markdown\x22\x3e\x3ccode\x3egeometry.faceVertexUvs[\x3cspan class=\x22hljs-string\x22\x3e0\x3c\/span\x3e][\x3cspan class=\x22hljs-symbol\x22\x3e0\x3c\/span\x3e] = face1_left;\ngeometry.faceVertexUvs[\x3cspan class=\x22hljs-string\x22\x3e0\x3c\/span\x3e][\x3cspan class=\x22hljs-symbol\x22\x3e0\x3c\/span\x3e] = face1_right;\n\/\/...剩下 10 个面\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果，你写过原生的 WebGL 代码，对于理解 UV 映射原理应该很容易了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e3D 移动原理\x3c\/h2\x3e\n\x3cp\x3e这里需要注意的是 Web 全景不是 WebVR。全景没有 VR 那种沉浸式体验，单单只涉及三个维度上的旋转而没有移动距离这个说法。\x3c\/p\x3e\n\x3cp\x3e上面的描述中，提到了三维，旋转角度 这两个概念，很容易让我们想到《高中数学》学到的一个坐标系--球坐标系（这里默认都是右手坐标系）。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012687404?w=573\x26amp;h=339\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012687404?w=573\x26amp;h=339\x22 alt=\x22球坐标\x22 title=\x22球坐标\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eφ 是和 z 轴正方向 \x26lt;=180°的夹角\x3c\/li\x3e\n\x3cli\x3e∂ 是和 x 轴正方向 \x26lt;=180°的夹角\x3c\/li\x3e\n\x3cli\x3ep 是空间点距离原点的直线距离\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e计算公式为：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012687405?w=442\x26amp;h=32\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012687405?w=442\x26amp;h=32\x22 alt=\x22formula\x22 title=\x22formula\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e现在，如果应用到 Web 全景，我们可以知道几个已知条件:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3ep：定义的球体（SphereBufferGeometry）的半径大小\x3c\/li\x3e\n\x3cli\x3e∆φ：用户在 y 轴上移动的距离\x3c\/li\x3e\n\x3cli\x3e∆∂：用户在 x 轴上移动的距离\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3ep 这个是不变的，而 ∆φ 和 ∆∂ 则是根据用户输入来决定的大小值。这里，就需要一个算法来统一协定。该算法控制的主要内容就是:\x3c\/p\x3e\n\x3cblockquote\x3e用户的手指在 x\/y 平面轴上的 ∆x\/∆y 通过一定的比例换算成为 ∆φ\/∆∂\x3c\/blockquote\x3e\n\x3cp\x3e如果考虑到陀螺仪就是：\x3c\/p\x3e\n\x3cblockquote\x3e用户的手指在 x\/y 平面轴上的 ∆x\/∆y 通过一定的比例换算成为 ∆φ\/∆∂，用户在 x\/y 轴上旋转的角度值 ∆φ\x27\/∆∂\x27，分别和视角角度进行合并，算出结果。\x3c\/blockquote\x3e\n\x3cp\x3e为了更宽泛的兼容性，我们这里根据第二种算法的描述来进行讲解。上面 ∆φ\/∆∂ 的变动主要映射的是我们视野范围的变化。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012687398?w=273\x26amp;h=370\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012687398?w=273\x26amp;h=370\x22 alt=\x22gif\x22 title=\x22gif\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e在 Threejs 中，就是用来控制相机的视野范围。那我们如何在 ThreeJS 控制视野范围呢？下面是最简代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22phi = THREE.Math.degToRad(90 - lat);\ntheta = THREE.Math.degToRad(-lon);\ncamera.position.x = distance * Math.sin(phi) * Math.cos(theta);\ncamera.position.y = distance * Math.cos(phi);\ncamera.position.z = distance * Math.sin(phi) * Math.sin(theta);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs sqf\x22\x3e\x3ccode\x3ephi = THREE.Math.degToRad(\x3cspan class=\x22hljs-number\x22\x3e90\x3c\/span\x3e - lat);\ntheta = THREE.Math.degToRad(-lon);\ncamera.\x3cspan class=\x22hljs-built_in\x22\x3eposition\x3c\/span\x3e.x = \x3cspan class=\x22hljs-built_in\x22\x3edistance\x3c\/span\x3e * Math.\x3cspan class=\x22hljs-built_in\x22\x3esin\x3c\/span\x3e(phi) * Math.\x3cspan class=\x22hljs-built_in\x22\x3ecos\x3c\/span\x3e(theta);\ncamera.\x3cspan class=\x22hljs-built_in\x22\x3eposition\x3c\/span\x3e.y = \x3cspan class=\x22hljs-built_in\x22\x3edistance\x3c\/span\x3e * Math.\x3cspan class=\x22hljs-built_in\x22\x3ecos\x3c\/span\x3e(phi);\ncamera.\x3cspan class=\x22hljs-built_in\x22\x3eposition\x3c\/span\x3e.z = \x3cspan class=\x22hljs-built_in\x22\x3edistance\x3c\/span\x3e * Math.\x3cspan class=\x22hljs-built_in\x22\x3esin\x3c\/span\x3e(phi) * Math.\x3cspan class=\x22hljs-built_in\x22\x3esin\x3c\/span\x3e(theta);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里主要模拟地球坐标：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3elat 代表维度（latitude）: 用户上下滑动改变的值，或者手机上下旋转\x3c\/li\x3e\n\x3cli\x3elon 代表经度（lontitude）: 用户左右滑动改变的值，或者手机左右旋转\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e具体内容为：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012687406\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012687406\x22 alt=\x22image.png-17.9kB\x22 title=\x22image.png-17.9kB\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e在通常实践当中，改变全景视角的维度有两种，一种直接通过手滑，一种则根据陀螺仪旋转。\x3c\/p\x3e\n\x3cp\x3e简单来说，就是监听 \x3ccode\x3etouch\x3c\/code\x3e 和 \x3ccode\x3eorientation\x3c\/code\x3e 事件，根据触发信息来手动改变 lat\/lon 的值。不过，这里有一个注意事项：\x3c\/p\x3e\n\x3cblockquote\x3elatitude 方向上最多只能达到 (-90,90)，否则会造成屏幕翻转的效果，这种体验非常不好。\x3c\/blockquote\x3e\n\x3cp\x3e我们分别通过代码来实践一下。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e添加 touch 控制\x3c\/h3\x3e\n\x3cp\x3eTouch 相关的事件在 Web 中，其实可以讲到你崩溃为止，比如，用户用几个手指触摸屏幕？用户具体在屏幕上的手势是什么(\x3ccode\x3eswipe\x3c\/code\x3e，\x3ccode\x3ezoom\x3c\/code\x3e)？\x3c\/p\x3e\n\x3cp\x3e这里，我们简单起见，只针对一个手指滑动的距离来作为 相机 视角移动的数据。具体代码为：\x3c\/p\x3e\n\x3cp\x3e\/\/ 为了给自己博客拉量，完整版可以去我的博客查看：\x3cbr\x3e\x3ca href=\x22https:\/\/www.villainhr.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/www.villainhr.com\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3eiv-panorama 简介\x3c\/h2\x3e\n\x3cp\x3eiv-panorama 是 IVWEB 团队，针对于全景直播这个热点专门开发的一个播放器。现在 Web 对 VR 支持度也不是特别友好，但是，对于全景视频来说，在机器换代更新的前提下，全景在性能方面的瓶颈慢慢消失了。其主要特性为：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e依赖于 Three.js，需要预先挂载到 window 对象上\x3c\/li\x3e\n\x3cli\x3e灵活配置，内置支持陀螺仪和 touch 控制。\x3c\/li\x3e\n\x3cli\x3e支持灵敏度参数的动态调整\x3c\/li\x3e\n\x3cli\x3e使用 ES6 语法\x3c\/li\x3e\n\x3cli\x3e兼容 React，jQuery（简单凑数的）\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e项目地址为：\x3ca href=\x22https:\/\/github.com\/JimmyVV\/iv-panorama\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eiv-panorama\x3c\/a\x3e。该项目使用非常简单，有两种全景模式，一个是 图片，一个是视频：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import VRPlayer from \x27iv-panorama\x27;\n\nnew VRPlayer({\n        player: {\n            url: \x27\/test\/003.mp4\x27\n        },\n        container:document.getElementById(\x27container\x27)\n    });\n    \n\/\/ image\n\nlet panorama = new VRPlayer({\n    image: {\n            url: \x27.\/banner.png\x27\n        },\n        container:document.getElementById(\x27container\x27)\n    });\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e VRPlayer \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27iv-panorama\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e VRPlayer({\n        \x3cspan class=\x22hljs-attr\x22\x3eplayer\x3c\/span\x3e: {\n            \x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/test\/003.mp4\x27\x3c\/span\x3e\n        },\n        \x3cspan class=\x22hljs-attr\x22\x3econtainer\x3c\/span\x3e:\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27container\x27\x3c\/span\x3e)\n    });\n    \n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ image\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e panorama = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e VRPlayer({\n    \x3cspan class=\x22hljs-attr\x22\x3eimage\x3c\/span\x3e: {\n            \x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/banner.png\x27\x3c\/span\x3e\n        },\n        \x3cspan class=\x22hljs-attr\x22\x3econtainer\x3c\/span\x3e:\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27container\x27\x3c\/span\x3e)\n    });\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e全景资源都已经放在 github 仓库了，有兴趣的可以实践观察一下。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>现在做 Web 全景合适吗？</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000012687395">https://segmentfault.com/a/1190000012687395</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/ool0xz9pwq/" target="_blank">https://alili.tech/archive/ool0xz9pwq/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>