<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="网页性能优化，缓存优化、加载时优化、动画优化"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>网页性能优化，缓存优化、加载时优化、动画优化 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/pr17i4ohe9f/",
				"appid": "1613049289050283", 
				"title": "网页性能优化，缓存优化、加载时优化、动画优化 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-13T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/0iof83b7r1bf/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/cib14w51c8f/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fpr17i4ohe9f%2f&text=%e7%bd%91%e9%a1%b5%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%ef%bc%8c%e7%bc%93%e5%ad%98%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a0%e8%bd%bd%e6%97%b6%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a8%e7%94%bb%e4%bc%98%e5%8c%96"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fpr17i4ohe9f%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fpr17i4ohe9f%2f&text=%e7%bd%91%e9%a1%b5%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%ef%bc%8c%e7%bc%93%e5%ad%98%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a0%e8%bd%bd%e6%97%b6%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a8%e7%94%bb%e4%bc%98%e5%8c%96"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fpr17i4ohe9f%2f&title=%e7%bd%91%e9%a1%b5%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%ef%bc%8c%e7%bc%93%e5%ad%98%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a0%e8%bd%bd%e6%97%b6%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a8%e7%94%bb%e4%bc%98%e5%8c%96"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fpr17i4ohe9f%2f&is_video=false&description=%e7%bd%91%e9%a1%b5%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%ef%bc%8c%e7%bc%93%e5%ad%98%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a0%e8%bd%bd%e6%97%b6%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a8%e7%94%bb%e4%bc%98%e5%8c%96"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e7%bd%91%e9%a1%b5%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%ef%bc%8c%e7%bc%93%e5%ad%98%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a0%e8%bd%bd%e6%97%b6%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a8%e7%94%bb%e4%bc%98%e5%8c%96&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fpr17i4ohe9f%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fpr17i4ohe9f%2f&title=%e7%bd%91%e9%a1%b5%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%ef%bc%8c%e7%bc%93%e5%ad%98%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a0%e8%bd%bd%e6%97%b6%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a8%e7%94%bb%e4%bc%98%e5%8c%96"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fpr17i4ohe9f%2f&title=%e7%bd%91%e9%a1%b5%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%ef%bc%8c%e7%bc%93%e5%ad%98%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a0%e8%bd%bd%e6%97%b6%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a8%e7%94%bb%e4%bc%98%e5%8c%96"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fpr17i4ohe9f%2f&title=%e7%bd%91%e9%a1%b5%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%ef%bc%8c%e7%bc%93%e5%ad%98%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a0%e8%bd%bd%e6%97%b6%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a8%e7%94%bb%e4%bc%98%e5%8c%96"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fpr17i4ohe9f%2f&title=%e7%bd%91%e9%a1%b5%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%ef%bc%8c%e7%bc%93%e5%ad%98%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a0%e8%bd%bd%e6%97%b6%e4%bc%98%e5%8c%96%e3%80%81%e5%8a%a8%e7%94%bb%e4%bc%98%e5%8c%96"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">网页性能优化，缓存优化、加载时优化、动画优化</h1><div class="meta"><div class="postdate"><time datetime="2018-12-13" itemprop="datePublished">2018-12-13</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e本文提供一个优化网页性能的大概思路，具体操作网上资料很多。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3e缓存优化\x3c\/h1\x3e\n\x3cp\x3e性能优化第一步，便是管理好页面的缓存，避免重复下载资源。否则，即增加服务器压力，又折磨用户的钱包。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e浏览器缓存机制\x3c\/h2\x3e\n\x3col\x3e\n\x3cli\x3e访问页面，请求各种资源，浏览器检查本地是否有缓存。\x3c\/li\x3e\n\x3cli\x3e如果有，检查资源是否过期。没过期，直接使用缓存。过期了，便向服务器发出请求。\x3c\/li\x3e\n\x3cli\x3e发出的请求中会带上etag和last-modified首部字段。\x3c\/li\x3e\n\x3cli\x3e服务器会通过Etag和last-modified来判断浏览器缓存的资源是否已经不可用。\x3c\/li\x3e\n\x3cli\x3e如果资源仍然有效，便返回304告知浏览器使用缓存。否则返回更新后的资源。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e按照这一套逻辑，便可规划好网站的缓存。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e如果资源提前过期，如何通知浏览器更新资源？\x3c\/h3\x3e\n\x3cp\x3e通常无法做到这一点，因为浏览器发现资源没过期，根本不会发出请求。\x3cbr\x3e但是可以通过修改资源的网址来实现。所以需要给资源文件名加上版本号或者随机标记。例如 style.1234.css。\x3cbr\x3e也就是说，不要让浏览器缓存html文件，否则，过期之前，浏览器都不会请求服务器。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader3\x22\x3e加载时优化\x3c\/h1\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e消灭不必要的下载\x3c\/h2\x3e\n\x3cp\x3e最好的优化，便是根本不下载资源。所以要尽量减少比不要的资源。\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e评估所有依赖是否必要，权衡利弊。\x3c\/li\x3e\n\x3cli\x3e依赖的下载路径是否可靠，不可用时候是否会阻碍整个页面。\x3c\/li\x3e\n\x3cli\x3e产品设计时候就需要抛弃浪费带宽的设计。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e压缩所有可以压缩的资源\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e代码自不用说，都是文本，全部压缩。\x3c\/h3\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e优化图片\x3c\/h3\x3e\n\x3col\x3e\n\x3cli\x3e去掉不必要的图片\x3c\/li\x3e\n\x3cli\x3e多使用css3来代替图片\x3c\/li\x3e\n\x3cli\x3e使用压缩率更高的图片。特别是gif动图，一些视频格式（H.264或WebM）的体积比gif小很多。\x3c\/li\x3e\n\x3cli\x3e用艺术字字体，不要用图片\x3c\/li\x3e\n\x3cli\x3e仔细权衡图片和文字的关系。要表达一个意思，可能一图胜千言。多了一张图片，反而节省了大量文字。\x3c\/li\x3e\n\x3cli\x3e使用progressive jpeg。相比随着数据下载从上到下显示的baseline jpeg，progressive jpeg是由模糊到清晰，用户体验好，也不会导致reflow。\x3c\/li\x3e\n\x3cli\x3e图片分辨率要尽可能小，避免图片分辨率大于显示分辨率。\x3c\/li\x3e\n\x3cli\x3e为使用更新浏览器的用户提供更现代的图片格式。\x3c\/li\x3e\n\x3cli\x3e多种分辨率的位图供不同页面大小使用。\x3c\/li\x3e\n\x3cli\x3e要给标签指明宽高，否则会导致reflow。\x3c\/li\x3e\n\x3cli\x3e使用HTTP\/2。比如，精灵图是由很多小图片组成的一张大图片，可以减少http请求。但是却难以缓存，修改一个小图片，导致所有小图片缓存失效。HTTP\/2，一个链接内可以发起多个请求，便无需使用精灵图。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e优化字体\x3c\/h3\x3e\n\x3col\x3e\n\x3cli\x3e@font-face 中unicode-range可以制定字符范围，用来避免下载不需要的语言的字符。\x3c\/li\x3e\n\x3cli\x3e确保字体都被压缩过。\x3c\/li\x3e\n\x3cli\x3e用@font-face的display属性和FontFace对象管理好字体加载时的逻辑。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e关键渲染路径\x3c\/h3\x3e\n\x3cp\x3e浏览器渲染一张网页通过以下步骤。\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e处理 HTML 标记并构建 DOM 树。\x3c\/li\x3e\n\x3cli\x3e处理 CSS 标记并构建 CSSOM 树。\x3c\/li\x3e\n\x3cli\x3e将 DOM 与 CSSOM 合并成一个渲染树。\x3c\/li\x3e\n\x3cli\x3e根据渲染树来布局，以计算每个节点的几何信息。\x3c\/li\x3e\n\x3cli\x3e将各个节点绘制到屏幕上。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e说人话：浏览器先解析HTML，发现\x26lt;link\x26gt;就去请求CSS文件，发现\x26lt;script\x26gt;就去请求js文件。\x3cbr\x3e当CSS文件完全取回，便会开始构建CSSOM树，当CSSOM树和DOM树都构建完成，才会开始渲染页面。\x3cbr\x3e当JS文件完全取回，并不一定立刻执行，需要等待CSSOM树构建完成。同时，如果DOM树尚未构建完成，就会暂停构建，等待JS执行完成。因为浏览器不知道JS文件是否会修改CSS和DOM。\x3cbr\x3e所以，在网页中随意摆放\x26lt;link\x26gt;和\x26lt;script\x26gt;,极有可能造成各种阻塞，必须精心安排。\x3cbr\x3e优化关键渲染路径，便是指优化这个渲染过程，让网页尽快呈现出来。\x3c\/p\x3e\n\x3ch4\x3ecss\x3c\/h4\x3e\n\x3cul\x3e\n\x3cli\x3eCSS文件会阻塞渲染。浏览器构建好DOM树后，必须等待CSSOM树构建完成。\x3c\/li\x3e\n\x3cli\x3e在文档顶部放置外联CSS的标签，让浏览器尽快请求CSS文件。\x3c\/li\x3e\n\x3cli\x3e避免在css文件中使用@import，因为只有包含import的文件被下载编译后，浏览器才会发现并下载import的css。\x3c\/li\x3e\n\x3cli\x3e可以考虑使用内联CSS，无需额外请求，不会阻塞渲染。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch4\x3ejs\x3c\/h4\x3e\n\x3cul\x3e\n\x3cli\x3e在CSSOM构建完成前，js不会开始执行。\x3c\/li\x3e\n\x3cli\x3ejs也会阻止DOM树构建。除非在\x26lt;script\x26gt;标签上标记async。\x3c\/li\x3e\n\x3cli\x3e用Chrome开发者工具的audits检查网页。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch1 id=\x22articleHeader10\x22\x3e动画优化\x3c\/h1\x3e\n\x3cp\x3e重绘过程：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000013279035?w=1093\x26amp;h=167\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000013279035?w=1093\x26amp;h=167\x22 alt=\x22rendering\x22 title=\x22rendering\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3ejs修改元素样式\x3c\/li\x3e\n\x3cli\x3e浏览器重新计算CSSOM树\x3c\/li\x3e\n\x3cli\x3e如果布局发生变化，则计算出新的布局\x3c\/li\x3e\n\x3cli\x3e按不同的layer来计算出绘制元素所需的每个像素。\x3c\/li\x3e\n\x3cli\x3e按顺序合并不同的layer\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e优化动画便是优化以上步骤使动画达到60帧。\x3cbr\x3eCSS选择器要简单，避免浏览器遍历DOM树来寻找元素。\x3cbr\x3ejs修改的元素要避免牵连过多导致布局发生变化。\x3cbr\x3e要减少需要重绘的元素。重绘时，同一个layer的元素都会被重绘。重绘也是非常耗费性能的一步。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader11\x22\x3eCSS选择器\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e选择器越复杂，浏览器计算得越久。最糟情况下，浏览器需要遍历整个DOM-tree，计算量等于元素总个数乘以选择器个数。\x3c\/li\x3e\n\x3cli\x3e尽量不要使选择器太复杂，事先给需要被操作的元素加上类名。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader12\x22\x3ereflow, layout\x3c\/h2\x3e\n\x3cblockquote\x3e即布局发生变化。Chrome, Opera, Safari, Internet Explorer中叫layout. 火狐称之为Reflow。\x3c\/blockquote\x3e\n\x3cul\x3e\x3cli\x3ereflow, repaint次数越少越好，牵连的元素越少越好。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cblockquote\x3ereflow总是牵涉整个文档流。\x3c\/blockquote\x3e\n\x3cul\x3e\x3cli\x3e千万不能修改元素css后立刻读取css计算值。因为浏览器必须重新计算布局，才能知道所需值。而js中相关API都是同步的，所以这将导致浏览器同步reflow，阻塞js线程。\x3c\/li\x3e\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader13\x22\x3ePaint(重绘)\x3c\/h2\x3e\n\x3cp\x3e因为动画一直在运动，所以要避免使用会导致布局发生变化，和导致必须重新计算元素像素（重绘）的CSS属性制作动画。而\x3cstrong\x3etransform和opacity\x3c\/strong\x3e两个CSS属性正是我们所需的。\x3cbr\x3e因为浏览器渲染网页时，会将网页分层(layer)，最后将不同层合并，然后完成渲染。\x3cbr\x3e同一层中，哪怕只有一个小小的元素发生变化，整个层都会被repaint。\x3c\/p\x3e\n\x3cblockquote\x3e开发者工具的Paint Profiler界面中观察到每一层的绘制过程\x3cbr\x3e所以，可以考虑将动画放在单独的layer中。\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader14\x22\x3e创建新layer\x3c\/h3\x3e\n\x3cp\x3eCSS的will-change和 transform: translateZ(0)可以用来创建新layer；\x3cbr\x3e再搭配transform和opacity，用CSS3制作动画。\x3cstrong\x3e根据我的实验，可以完全避免reflow和重绘\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cblockquote\x3e但是过多layer也消耗内存和性能，用开发者工具中的\x3cstrong\x3ePerformance\x3c\/strong\x3e判断新layer是否带来优化，否则不要创建新layer。\x3cbr\x3e开发者工具的layer界面中可以观察网页有多少个layer，每个layer包含哪些元素。\x3c\/blockquote\x3e\n\x3ch1 id=\x22articleHeader15\x22\x3e优化交互\x3c\/h1\x3e\n\x3cp\x3e网页时给人用的，所以最恼人的是鼠标或手指操作页面时，页面卡卡的。\x3cbr\x3e而响应用户操作的JS都是异步的。\x3cstrong\x3e如果JS线程太繁忙，迟迟不能进入下一个事件循环\x3c\/strong\x3e，就会导致响应用户操作不及时。\x3cbr\x3e尽量增加线程空闲时间，让事件循环可以及时取出回调函数。提高响应的优先级，用户交互时，停下其他耗时的JS。\x3cbr\x3e但\x3cstrong\x3e响应不必过于及时，在100ms内得到反馈\x3c\/strong\x3e，人类都不会察觉到卡顿，可以把一些耗时的工作分解成很多步，利用这个时间差去执行它们。\x3cbr\x3e活用requestAnimationFrame方法。\x3c\/p\x3e\n\x3cblockquote\x3erequestAnimationFrame在下一帧开始前调用函数。优于setInterval的地方是每一帧只会调用一次，而setInterval则不一定。\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader16\x22\x3e监听函数\x3c\/h2\x3e\n\x3cp\x3e交互事件的监听函数的执行时间不能太长，否则会阻塞页面滚动。\x3c\/p\x3e\n\x3cblockquote\x3e监听函数可能会调用preventDefault, 导致浏览器必须等待监听函数执行完成。 \x3cbr\x3e不过新扩展的addEventListener方法第三个参数可以是一个对象，对象的passive属性用来事先承诺不会调用preventDefault方法，浏览器则不会等待监听函数。\x3c\/blockquote\x3e\n\x3cp\x3e不要再交互事件的监听函数中修改样式，会导致强制同步reflow，阻塞js执行。\x3c\/p\x3e\n\x3cblockquote\x3e因为监听函数会在requestAnimationFrame之前执行，如果监听函数中修改了样式，又用到requestAnimationFrame来制作动画，便会导致强制同步reflow。\x3c\/blockquote\x3e\n\x3cp\x3e某些交互事件触发极频繁，注意要debounce。\x3c\/p\x3e\n\x3cblockquote\x3edebounce:不要高频率调用函数，事件连续触发时，只调用一次函数。\x3c\/blockquote\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>网页性能优化，缓存优化、加载时优化、动画优化</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000013279030">https://segmentfault.com/a/1190000013279030</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/pr17i4ohe9f/" target="_blank">https://alili.tech/archive/pr17i4ohe9f/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>