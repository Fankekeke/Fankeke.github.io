<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="React 内部机制探秘 - React Component 和 Element（文末附彩蛋demo和源码）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>React 内部机制探秘 - React Component 和 Element（文末附彩蛋demo和源码） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/qgepungcgb9/",
				"appid": "1613049289050283", 
				"title": "React 内部机制探秘 - React Component 和 Element（文末附彩蛋demo和源码） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-30T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/rfb0m52hhq/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/hze9x3xtt7n/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fqgepungcgb9%2f&text=React%20%e5%86%85%e9%83%a8%e6%9c%ba%e5%88%b6%e6%8e%a2%e7%a7%98%20-%20React%20Component%20%e5%92%8c%20Element%ef%bc%88%e6%96%87%e6%9c%ab%e9%99%84%e5%bd%a9%e8%9b%8bdemo%e5%92%8c%e6%ba%90%e7%a0%81%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fqgepungcgb9%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fqgepungcgb9%2f&text=React%20%e5%86%85%e9%83%a8%e6%9c%ba%e5%88%b6%e6%8e%a2%e7%a7%98%20-%20React%20Component%20%e5%92%8c%20Element%ef%bc%88%e6%96%87%e6%9c%ab%e9%99%84%e5%bd%a9%e8%9b%8bdemo%e5%92%8c%e6%ba%90%e7%a0%81%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fqgepungcgb9%2f&title=React%20%e5%86%85%e9%83%a8%e6%9c%ba%e5%88%b6%e6%8e%a2%e7%a7%98%20-%20React%20Component%20%e5%92%8c%20Element%ef%bc%88%e6%96%87%e6%9c%ab%e9%99%84%e5%bd%a9%e8%9b%8bdemo%e5%92%8c%e6%ba%90%e7%a0%81%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fqgepungcgb9%2f&is_video=false&description=React%20%e5%86%85%e9%83%a8%e6%9c%ba%e5%88%b6%e6%8e%a2%e7%a7%98%20-%20React%20Component%20%e5%92%8c%20Element%ef%bc%88%e6%96%87%e6%9c%ab%e9%99%84%e5%bd%a9%e8%9b%8bdemo%e5%92%8c%e6%ba%90%e7%a0%81%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=React%20%e5%86%85%e9%83%a8%e6%9c%ba%e5%88%b6%e6%8e%a2%e7%a7%98%20-%20React%20Component%20%e5%92%8c%20Element%ef%bc%88%e6%96%87%e6%9c%ab%e9%99%84%e5%bd%a9%e8%9b%8bdemo%e5%92%8c%e6%ba%90%e7%a0%81%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fqgepungcgb9%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fqgepungcgb9%2f&title=React%20%e5%86%85%e9%83%a8%e6%9c%ba%e5%88%b6%e6%8e%a2%e7%a7%98%20-%20React%20Component%20%e5%92%8c%20Element%ef%bc%88%e6%96%87%e6%9c%ab%e9%99%84%e5%bd%a9%e8%9b%8bdemo%e5%92%8c%e6%ba%90%e7%a0%81%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqgepungcgb9%2f&title=React%20%e5%86%85%e9%83%a8%e6%9c%ba%e5%88%b6%e6%8e%a2%e7%a7%98%20-%20React%20Component%20%e5%92%8c%20Element%ef%bc%88%e6%96%87%e6%9c%ab%e9%99%84%e5%bd%a9%e8%9b%8bdemo%e5%92%8c%e6%ba%90%e7%a0%81%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqgepungcgb9%2f&title=React%20%e5%86%85%e9%83%a8%e6%9c%ba%e5%88%b6%e6%8e%a2%e7%a7%98%20-%20React%20Component%20%e5%92%8c%20Element%ef%bc%88%e6%96%87%e6%9c%ab%e9%99%84%e5%bd%a9%e8%9b%8bdemo%e5%92%8c%e6%ba%90%e7%a0%81%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqgepungcgb9%2f&title=React%20%e5%86%85%e9%83%a8%e6%9c%ba%e5%88%b6%e6%8e%a2%e7%a7%98%20-%20React%20Component%20%e5%92%8c%20Element%ef%bc%88%e6%96%87%e6%9c%ab%e9%99%84%e5%bd%a9%e8%9b%8bdemo%e5%92%8c%e6%ba%90%e7%a0%81%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">React 内部机制探秘 - React Component 和 Element（文末附彩蛋demo和源码）</h1><div class="meta"><div class="postdate"><time datetime="2018-12-30" itemprop="datePublished">2018-12-30</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3eReact 内部机制探秘 - React Component 和 Element（文末附彩蛋demo和源码）\x3c\/h1\x3e\n\x3cp\x3e这篇文章比较偏基础，但是对入门 React 内部机制和实现原理却至关重要。算是为以后深入解读的一个入门，如果您已经非常清楚:\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eReact Component Render =\x26gt; JSX =\x26gt; React.createElement =\x26gt; Virtual Dom\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e的流程，可以直接略过此文。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e谷歌工程师一个风骚的问题\x3c\/h2\x3e\n\x3cp\x3e在几个月前，谷歌的前端开发专家 Tyler McGinnis 在其个人 twitter 账号上发布了 \x3ca href=\x22https:\/\/twitter.com\/tylermcginnis33\/status\/771087982858113024\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这样一条推文\x3c\/a\x3e，引发了对 React 组件的讨论。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011413617\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011413617\x22 alt=\x22推文截图\x22 title=\x22推文截图\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e他抛出来的问题是 ：如上述代码，\x3cstrong\x3eReact 组件 Icon 直接出现在代码中，到底算什么？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e提供的选项有：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eA. Component Declaration 组件声明\x3c\/li\x3e\n\x3cli\x3eB. Component Invocation 组件调用\x3c\/li\x3e\n\x3cli\x3eC. Component Instantiation 组件实例化\x3c\/li\x3e\n\x3cli\x3eD. Using a Component 单纯地使用组件\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e有趣的是，参与回答的开发者中：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e有 15% 选择了 A 项；\x3c\/li\x3e\n\x3cli\x3e有 8% 选择了 B 项；\x3c\/li\x3e\n\x3cli\x3e有 45% 选择了 C 项；\x3c\/li\x3e\n\x3cli\x3e有 32% 选择了 D 项；\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e对 React 开发经验丰富的前端工程师来说，这个问题其实很好理解。它的关键在于：\x3cstrong\x3e真正明白 React Element 和 React Components，以及 JSX 抽象层是如连通 React 的。\x3c\/strong\x3e当然也需要明白一些浅显的 React 内部工作机制。\x3c\/p\x3e\n\x3cp\x3e这篇文章，就带领大家研究一下这个 JSX 抽象层的奥秘和 \x3cstrong\x3eReact Reconciliation\x3c\/strong\x3e 过程。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3eReact 和 React Element 到底是什么？\x3c\/h2\x3e\n\x3cp\x3e让我们回到最初，思考一下最原始的问题，React 到底是什么？\x3c\/p\x3e\n\x3cp\x3e简而言之，\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eReact is a library for building user interfaces.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3eReact 是一个构建视图层的类库(框架...whatever...)。不管 React 本身如何复杂，不管其生态如何庞大，\x3cstrong\x3e构建视图\x3c\/strong\x3e始终是他的核心。记住这个信息，我们即将进入今天的第一个概念 — \x3cstrong\x3eReact Element\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e简单地说，React Element 描述了“你想”在屏幕上看到的事物。\x3c\/p\x3e\n\x3cp\x3e抽象地说，React Element 元素是一个描述了 Dom Node 的对象。\x3c\/p\x3e\n\x3cp\x3e请注意我的用词 — “\x3cstrong\x3e描述\x3c\/strong\x3e”，因为 React Element 并不是你在屏幕上看见的真实事物。相反地，他是一个描述真实事物的集合。存在的就是合理的，我们看来看看 React Element 存在的意义，以及为什么会有这样一个概念：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eJavaScript 对象很轻量。用对象来作为 React Element，那么 React 可以轻松的创建或销毁这些元素，而不必去太担心操作成本；\x3c\/li\x3e\n\x3cli\x3eReact 具有分析这些对象的能力，进一步，也具有分析虚拟 Dom 的能力。当改变出现时，（相比于真实 Dom）更新虚拟 Dom 的性能优势非常明显。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e为了创建我们描述 Dom Node 的对象（或者 React Element），我们可以使用 React.createElement 方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const element = React.createElement( \n  \x27div\x27, \n  {id: \x27login-btn\x27}, \n  \x27Login\x27\n)\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xquery\x22\x3e\x3ccode\x3econst \x3cspan class=\x22hljs-literal\x22\x3eelement\x3c\/span\x3e = React.createElement( \n  \x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e, \n  {id: \x3cspan class=\x22hljs-string\x22\x3e\x27login-btn\x27\x3c\/span\x3e}, \n  \x3cspan class=\x22hljs-string\x22\x3e\x27Login\x27\x3c\/span\x3e\n)\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里 React.createElement 方法接受三个参数：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e一个表述标签名称的字符串 (div, span, etc.)；\x3c\/li\x3e\n\x3cli\x3e当前 React Element 需要具有的属性；\x3c\/li\x3e\n\x3cli\x3e当前 React Element 要表达的内容，或者一个子元素。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e上面 React.createElement 方法调用之后，会返回一个 javascript 对象：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\n{ \n  type: \x27div\x27, \n  props: { \n    children: \x27Login\x27, \n    id: \x27login-btn\x27 \n  } \n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode\x3e\n{ \n  \x3cspan class=\x22hljs-attribute\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e, \n  props: { \n    children: \x3cspan class=\x22hljs-string\x22\x3e\x27Login\x27\x3c\/span\x3e, \n    id: \x3cspan class=\x22hljs-string\x22\x3e\x27login-btn\x27\x3c\/span\x3e \n  } \n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e接着当我们使用 ReactDOM.render 方法，这才渲染到真实 DOM 之上时，就会得到：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv id=\x27login-btn\x27\x3eLogin\x3c\/div\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs applescript\x22\x3e\x3ccode\x3e\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eid\x3c\/span\x3e=\x27login-btn\x27\x26gt;Login\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e而这个才是真实的 Dom 节点。\x3c\/p\x3e\n\x3cp\x3e到目前为止，并没有什么很难理解的概念。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3eReact Element 深入和 React Component\x3c\/h2\x3e\n\x3cp\x3e这篇文章我们开篇就介绍了 React Element，而并不是像官网或者学习资料上来就介绍 React Component，我相信你理解了 React Element，理解 React Component 就是自然而然的事情了。\x3c\/p\x3e\n\x3cp\x3e在真正开发时，我们并不直接使用 React.createElement，这样做简直太无聊了，每个组件都这样写一定会疯掉的。这时候就出现了 React Component，即 React 组件。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eA component is a function or a Class which optionally accepts input and returns a React element.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e没错，组件就是一个函数或者一个 Class（当然 Class 也是 function），它根据输入参数，并最终返回一个 React Element，而不需要我们直接手写无聊的 React Element。\x3c\/p\x3e\n\x3cp\x3e所以说，实际上我们使用了 React Component 来生成 React Element，这对于开发体验的提升无疑是巨大的。\x3c\/p\x3e\n\x3cp\x3e这里剖出一个思考题：\x3cstrong\x3e所有 React Component 都需要返回  React Element 吗？\x3c\/strong\x3e显然是不需要的，那么 return null; 的 React 组件有存在的意义吗，它能完成并实现哪些巧妙的设计和思想？（请关注作者，下篇文章将会专门进行分析、讲解）\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e从场景实例来看问题\x3c\/h3\x3e\n\x3cp\x3e接下来，请看这样一段代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function Button ({ onLogin }) { \n  return React.createElement( \n    \x27div\x27, \n    {id: \x27login-btn\x27, onClick: onLogin}, \n    \x27Login\x27 \n  )\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eButton\x3c\/span\x3e ({ onLogin }) { \n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eReact.createElement(\x3c\/span\x3e \n    \x3cspan class=\x22hljs-symbol\x22\x3e\x27div\x3c\/span\x3e\x27, \n    {id: \x3cspan class=\x22hljs-symbol\x22\x3e\x27login\x3c\/span\x3e-btn\x27, onClick: onLogin}, \n    \x3cspan class=\x22hljs-symbol\x22\x3e\x27Login\x3c\/span\x3e\x27 \n  )\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们定义了一个 Button 组件，它接收 onLogin 参数，并返回一个 React Element。注意 onLogin 参数是一个函数，并最终像 id:\x27login-btn\x27 一样成为了这个 React Element 的属性。\x3c\/p\x3e\n\x3cp\x3e直到目前，我们见到了一个 React Element type 为 HTML 标签(“span”, “div”, etc)的情况。事实上，我们也可以传递另一个 React Element ：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const element = React.createElement(\n  User, \n  {name: \x27Lucas\x27},\n  null \n)\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e element = React.createElement(\n  User, \n  {name: \x3cspan class=\x22hljs-string\x22\x3e\x27Lucas\x27\x3c\/span\x3e},\n  \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e \n)\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e注意此时 React.createElement 第一个参数是另一个 React Element，这与 type 值为 HTML 标签的情况不尽相同，当 React 发现 type 值为一个 class 或者函数时，它就会先看这个 class 或函数会返回什么样的 Element，并为这个 Element 设置正确的属性。\x3c\/p\x3e\n\x3cp\x3eReact 会一直不断重复这个过程（有点类似递归），直到没有 “createElement 调用 type 值为 class 或者 function” 的情况。\x3c\/p\x3e\n\x3cp\x3e我们结合代码再来体会一下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function Button ({ addFriend }) {\n  return React.createElement(\n    \x26quot;button\x26quot;, \n    { onClick: addFriend }, \n    \x26quot;Add Friend\x26quot; \n  ) \n} \nfunction User({ name, addFriend }) { \n  return React.createElement(\n    \x26quot;div\x26quot;, \n    null,\n    React.createElement( \x26quot;p\x26quot;, null, name ),\n    React.createElement(Button, { addFriend })\n  ) \n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eButton\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e({ addFriend })\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e React.createElement(\n    \x3cspan class=\x22hljs-string\x22\x3e\x22button\x22\x3c\/span\x3e, \n    { onClick: addFriend }, \n    \x3cspan class=\x22hljs-string\x22\x3e\x22Add Friend\x22\x3c\/span\x3e \n  ) \n} \n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eUser\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e({ name, addFriend })\x3c\/span\x3e \x3c\/span\x3e{ \n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e React.createElement(\n    \x3cspan class=\x22hljs-string\x22\x3e\x22div\x22\x3c\/span\x3e, \n    \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n    React.createElement( \x3cspan class=\x22hljs-string\x22\x3e\x22p\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, name ),\n    React.createElement(Button, { addFriend })\n  ) \n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面有两个组件：Button 和 User，User 描述的 Dom 是一个 div 标签，这个 div 内，又存在一个 p 标签，这个 p 标签展示了用户的 name；还存在一个 Button。\x3c\/p\x3e\n\x3cp\x3e现在我们来看 User 和 Button 中，React.createElement 返回情况：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function Button ({ addFriend }) { \n  return { \n    type: \x27button\x27, \n    props: { \n      onClick: addFriend, \n      children: \x27Add Friend\x27 \n    } \n  } \n} \nfunction User ({ name, addFriend }) { \n  return { \n    type: \x27div\x27, \n    props: { \n      children: [{ \n        type: \x27p\x27,\n        props: { children: name } \n      }, \n      { \n       type: Button, \n       props: { addFriend } \n      }]\n    }\n  }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3eButton\x3c\/span\x3e ({ \x3cspan class=\x22hljs-selector-tag\x22\x3eaddFriend\x3c\/span\x3e }) { \n  \x3cspan class=\x22hljs-selector-tag\x22\x3ereturn\x3c\/span\x3e { \n    \x3cspan class=\x22hljs-attribute\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27button\x27\x3c\/span\x3e, \n    \x3cspan class=\x22hljs-attribute\x22\x3eprops\x3c\/span\x3e: { \n      \x3cspan class=\x22hljs-attribute\x22\x3eonClick\x3c\/span\x3e: addFriend, \n      \x3cspan class=\x22hljs-attribute\x22\x3echildren\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Add Friend\x27\x3c\/span\x3e \n    } \n  } \n} \nfunction User ({ name, addFriend }) { \n  \x3cspan class=\x22hljs-selector-tag\x22\x3ereturn\x3c\/span\x3e { \n    \x3cspan class=\x22hljs-attribute\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e, \n    \x3cspan class=\x22hljs-attribute\x22\x3eprops\x3c\/span\x3e: { \n      \x3cspan class=\x22hljs-attribute\x22\x3echildren\x3c\/span\x3e: [{ \n        \x3cspan class=\x22hljs-attribute\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27p\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attribute\x22\x3eprops\x3c\/span\x3e: { \x3cspan class=\x22hljs-attribute\x22\x3echildren\x3c\/span\x3e: name } \n      }, \n      { \n       \x3cspan class=\x22hljs-attribute\x22\x3etype\x3c\/span\x3e: Button, \n       \x3cspan class=\x22hljs-attribute\x22\x3eprops\x3c\/span\x3e: { addFriend } \n      }]\n    }\n  }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e你会发现，上面的输出中，我们发现了四种 type 值：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x22button\x22;\x3c\/li\x3e\n\x3cli\x3e\x22div\x22;\x3c\/li\x3e\n\x3cli\x3e\x22p\x22;\x3c\/li\x3e\n\x3cli\x3eButton\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e当 React 发现 type 是 Button 时，它会查询这个 Button 组件会返回什么样的 React Element，并赋予正确的 props。 \x3c\/p\x3e\n\x3cp\x3e直到最终，React 会得到完整的表述 Dom 树的对象。在我们的例子中，就是：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  type: \x27div\x27, \n  props: {\n    children: [{\n      type: \x27p\x27,\n      props: { children: \x27Tyler McGinnis\x27 }\n    }, \n    { \n      type: \x27button\x27, \n      props: { \n        onClick: addFriend, \n        children: \x27Add Friend\x27\n      }\n     }]\n   } \n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e{\n  \x3cspan class=\x22hljs-attribute\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e, \n  \x3cspan class=\x22hljs-attribute\x22\x3eprops\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attribute\x22\x3echildren\x3c\/span\x3e: [{\n      \x3cspan class=\x22hljs-attribute\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27p\x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attribute\x22\x3eprops\x3c\/span\x3e: { \x3cspan class=\x22hljs-attribute\x22\x3echildren\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Tyler McGinnis\x27\x3c\/span\x3e }\n    }, \n    { \n      \x3cspan class=\x22hljs-attribute\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27button\x27\x3c\/span\x3e, \n      \x3cspan class=\x22hljs-attribute\x22\x3eprops\x3c\/span\x3e: { \n        \x3cspan class=\x22hljs-attribute\x22\x3eonClick\x3c\/span\x3e: addFriend, \n        \x3cspan class=\x22hljs-attribute\x22\x3echildren\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Add Friend\x27\x3c\/span\x3e\n      }\n     }]\n   } \n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eReact 处理这些逻辑的过程就叫做 \x3cstrong\x3ereconciliation\x3c\/strong\x3e，那么“这个过程（reconciliation）在何时被触发呢？”\x3c\/p\x3e\n\x3cp\x3e答案当然就是每次 setState 或 ReactDOM.render 调用时。以后的分析文章将会更加详细的说明。\x3c\/p\x3e\n\x3cp\x3e好吧，再回到 Tyler McGinnis 那个风骚的问题上。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011413618\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011413618\x22 alt=\x22风骚的问题\x22 title=\x22风骚的问题\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e此时我们具备回答这个问题的一切知识了吗？稍等等，我要引出 JSX 这个老朋友了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3eJSX 的角色\x3c\/h2\x3e\n\x3cp\x3e在 React Component 编写时，相信大家都在使用 JSX 来描述虚拟 Dom。当然，反过来说，React 其实也可以脱离 JSX 而存在。\x3c\/p\x3e\n\x3cp\x3e文章开头部分，我提到 “不常被我们提起的 JSX 抽象层是如何联通 React 的？” 答案很简单，因为 JSX 总是被编译成为 React.createElement 而被调用。一般 Babel 为我们做了 JSX —\x26gt; React.createElement 这件事情。\x3c\/p\x3e\n\x3cp\x3e再看来先例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function Button ({ addFriend }) {\n  return React.createElement(\n    \x26quot;button\x26quot;,\n    { onClick: addFriend },\n    \x26quot;Add Friend\x26quot; \n   )\n} \nfunction User({ name, addFriend }) { \n  return React.createElement(\n    \x26quot;div\x26quot;,\n    null,\n    React.createElement( \x26quot;p\x26quot;, null, name),\n    React.createElement(Button, { addFriend })\n  )\n}\n    \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eButton\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e({ addFriend })\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e React.createElement(\n    \x3cspan class=\x22hljs-string\x22\x3e\x22button\x22\x3c\/span\x3e,\n    { onClick: addFriend },\n    \x3cspan class=\x22hljs-string\x22\x3e\x22Add Friend\x22\x3c\/span\x3e \n   )\n} \n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eUser\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e({ name, addFriend })\x3c\/span\x3e \x3c\/span\x3e{ \n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e React.createElement(\n    \x3cspan class=\x22hljs-string\x22\x3e\x22div\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n    React.createElement( \x3cspan class=\x22hljs-string\x22\x3e\x22p\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, name),\n    React.createElement(Button, { addFriend })\n  )\n}\n    \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e对应我们总在写的 JSX 用法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function Button ({ addFriend }) { \n  return ( \n    \x3cbutton onClick={addFriend}\x3eAdd Friend\x3c\/button\x3e \n  )\n}\nfunction User ({ name, addFriend }) {\n  return ( \n    \x3cdiv\x3e\n     \x3cp\x3e{name}\x3c\/p\x3e\n     \x3cButton addFriend={addFriend}\/\x3e\n    \x3c\/div\x3e\n  )\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eButton\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e{ addFriend }\x3c\/span\x3e) \x3c\/span\x3e{ \n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e ( \n    \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonClick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{addFriend}\x3c\/span\x3e\x26gt;\x3c\/span\x3eAdd Friend\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e \n  )\n}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eUser\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e{ name, addFriend }\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e ( \n    \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n     \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e{name}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n     \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eButton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eaddFriend\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{addFriend}\/\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  )\n}\n\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e就是一个编译产出的差别。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e最终答案和文末彩蛋\x3c\/h2\x3e\n\x3cp\x3e那么，请你来回答“Icon 组件单独出现代表了什么？”\x3c\/p\x3e\n\x3cp\x3eIcon 在 JSX 被编译之后，就有：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22React.createElement(Icon, null)\n\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs yaml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-string\x22\x3eReact.createElement(Icon,\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e)\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e你问我怎么知道这些编译结果的？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e或者\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e你想知道你编写的 JSX 最终编译成了什么样子？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e我写了一个小工具，进行对 JSX 的实时编译，放在 \x3ca href=\x22https:\/\/github.com\/HOUCe\/JSXLiveCompiler\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGithub仓库中\x3c\/a\x3e，它使用起来是这样子的：\x3c\/p\x3e\n\x3cp\x3e平台一分为二，左边可以写 JSX，右边实时展现其编译结果：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011413619\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011413619\x22 alt=\x22实时编译平台\x22 title=\x22实时编译平台\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e以及：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011413620\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011413620\x22 alt=\x22实时编译平台\x22 title=\x22实时编译平台\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e这个工具最核心的代码其实就是使用 babel 进行编译：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\nlet code = e.target.value;\ntry {\n    this.setState({\n        output: window.Babel.transform(code, {presets: [\x27es2015\x27, \x27react\x27]})\n        .code,\n        err: \x27\x27\n    })\n}\ncatch(err) {\n    this.setState({err: err.message})\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xquery\x22\x3e\x3ccode\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e code = e.target.\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n    this.setState({\n        output: window.Babel.transform(code, {presets: [\x3cspan class=\x22hljs-string\x22\x3e\x27es2015\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e]})\n        .code,\n        err: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\n    })\n}\n\x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(err) {\n    this.setState({err: err.message})\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e感兴趣的读者可以去 GitHub 仓库参看源码。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e其实不管是 JSX 还是 React Element、React Component 这些概念，都是大家在开发中天天接触到的。有的开发者也许能上手做项目，但是并没有深入理解其中的概念，更无法真正掌握 React 核心思想。\x3c\/p\x3e\n\x3cp\x3e这些内容其实比较基础，但同时又很关键，对于后续理解 React\/Preact 源码至关重要。在这个基础上，我会更新更多更加深入的类 React 实现原理剖析，感兴趣的读者可以关注。\x3c\/p\x3e\n\x3cp\x3e我的其他几篇关于React技术栈的文章：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.jianshu.com\/p\/1c53e3b38f71\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e通过实例，学习编写 React 组件的“最佳实践”\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.jianshu.com\/p\/a50289d46236\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e从 React 绑定 this，看 JS 语言发展和框架设计\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.jianshu.com\/p\/49029b49f2b4\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e做出Uber移动网页版还不够 极致性能打造才见真章\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.jianshu.com\/p\/7a56ac1de2a8\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e解析Twitter前端架构 学习复杂场景数据设计\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.jianshu.com\/p\/83c86dd0802d\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eReact Conf 2017 干货总结1: React \x2b ES next = ♥\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.jianshu.com\/p\/cde3cf7e2760\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eReact\x2bRedux打造“NEWS EARLY”单页应用 一个项目理解最前沿技术栈真谛\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.jianshu.com\/p\/8e28be0e7ab1\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e一个react\x2bredux工程实例\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e......\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3eHappy Coding!\x3c\/p\x3e\n\x3cp\x3ePS: \x3cbr\x3e作者\x3ca href=\x22https:\/\/github.com\/HOUCe\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGithub仓库\x3c\/a\x3e 和 \x3ca href=\x22https:\/\/www.zhihu.com\/people\/lucas-hc\/answers\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e知乎问答链接\x3c\/a\x3e\x3cbr\x3e欢迎各种形式交流。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>React 内部机制探秘 - React Component 和 Element（文末附彩蛋demo和源码）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011413614">https://segmentfault.com/a/1190000011413614</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/qgepungcgb9/" target="_blank">https://alili.tech/archive/qgepungcgb9/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>