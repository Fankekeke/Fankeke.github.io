<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="解决Vue引入百度地图JSSDK：BMap is undefined 问题"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>解决Vue引入百度地图JSSDK：BMap is undefined 问题 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/rbh8472za3f/",
				"appid": "1613049289050283", 
				"title": "解决Vue引入百度地图JSSDK：BMap is undefined 问题 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-18T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/lmxxzbwy7hr/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/uf2qq7b0tis/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2frbh8472za3f%2f&text=%e8%a7%a3%e5%86%b3Vue%e5%bc%95%e5%85%a5%e7%99%be%e5%ba%a6%e5%9c%b0%e5%9b%beJSSDK%ef%bc%9aBMap%20is%20undefined%20%e9%97%ae%e9%a2%98"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2frbh8472za3f%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2frbh8472za3f%2f&text=%e8%a7%a3%e5%86%b3Vue%e5%bc%95%e5%85%a5%e7%99%be%e5%ba%a6%e5%9c%b0%e5%9b%beJSSDK%ef%bc%9aBMap%20is%20undefined%20%e9%97%ae%e9%a2%98"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2frbh8472za3f%2f&title=%e8%a7%a3%e5%86%b3Vue%e5%bc%95%e5%85%a5%e7%99%be%e5%ba%a6%e5%9c%b0%e5%9b%beJSSDK%ef%bc%9aBMap%20is%20undefined%20%e9%97%ae%e9%a2%98"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2frbh8472za3f%2f&is_video=false&description=%e8%a7%a3%e5%86%b3Vue%e5%bc%95%e5%85%a5%e7%99%be%e5%ba%a6%e5%9c%b0%e5%9b%beJSSDK%ef%bc%9aBMap%20is%20undefined%20%e9%97%ae%e9%a2%98"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e8%a7%a3%e5%86%b3Vue%e5%bc%95%e5%85%a5%e7%99%be%e5%ba%a6%e5%9c%b0%e5%9b%beJSSDK%ef%bc%9aBMap%20is%20undefined%20%e9%97%ae%e9%a2%98&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2frbh8472za3f%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2frbh8472za3f%2f&title=%e8%a7%a3%e5%86%b3Vue%e5%bc%95%e5%85%a5%e7%99%be%e5%ba%a6%e5%9c%b0%e5%9b%beJSSDK%ef%bc%9aBMap%20is%20undefined%20%e9%97%ae%e9%a2%98"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2frbh8472za3f%2f&title=%e8%a7%a3%e5%86%b3Vue%e5%bc%95%e5%85%a5%e7%99%be%e5%ba%a6%e5%9c%b0%e5%9b%beJSSDK%ef%bc%9aBMap%20is%20undefined%20%e9%97%ae%e9%a2%98"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2frbh8472za3f%2f&title=%e8%a7%a3%e5%86%b3Vue%e5%bc%95%e5%85%a5%e7%99%be%e5%ba%a6%e5%9c%b0%e5%9b%beJSSDK%ef%bc%9aBMap%20is%20undefined%20%e9%97%ae%e9%a2%98"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2frbh8472za3f%2f&title=%e8%a7%a3%e5%86%b3Vue%e5%bc%95%e5%85%a5%e7%99%be%e5%ba%a6%e5%9c%b0%e5%9b%beJSSDK%ef%bc%9aBMap%20is%20undefined%20%e9%97%ae%e9%a2%98"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">解决Vue引入百度地图JSSDK：BMap is undefined 问题</h1><div class="meta"><div class="postdate"><time datetime="2018-12-18" itemprop="datePublished">2018-12-18</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e原文链接：\x3ca href=\x22http:\/\/www.huchiwei.com\/2018\/01\/11\/%E8%A7%A3%E5%86%B3Vue%E5%BC%95%E5%85%A5%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BEJSSDK%EF%BC%9ABMap%20is%20undefined%20%E9%97%AE%E9%A2%98\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e解决Vue引入百度地图JSSDK：BMap is undefined 问题\x3c\/a\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e百度地图官网文档介绍使用JSSDK时，仅提供了2种引入方式：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3escript引入\x3c\/li\x3e\n\x3cli\x3e异步加载\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e但vue项目中仅某一两个页面需要用到百度地图，所以不想在 \x3ccode\x3eindex.html\x3c\/code\x3e 中全局引用。\x3c\/p\x3e\n\x3cp\x3e那在单个vue组件页面中如何引入呢？\x3c\/p\x3e\n\x3cp\x3e刚开始时，是直接通过 DOM 操作方式插入script标签到当前document中，如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let scriptNode = document.createElement(\x26quot;script\x26quot;);\nscriptNode.setAttribute(\x26quot;type\x26quot;, \x26quot;text\/javascript\x26quot;);\nscriptNode.setAttribute(\x26quot;src\x26quot;, \x26quot;http:\/\/api.map.baidu.com\/api?v=3.0\x26amp;ak=您的密钥\x26quot;);\ndocument.body.appendChild(scriptNode);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e scriptNode = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x22script\x22\x3c\/span\x3e);\nscriptNode.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e);\nscriptNode.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22src\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/api.map.baidu.com\/api?v=3.0\x26amp;ak=您的密钥\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(scriptNode);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e结果是不行的。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e然后考虑使用异步加载的方式，结合参考网上方案，单独创建\x3ccode\x3ebaidu-map.js\x3c\/code\x3e脚本：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export default {\n  init: function (){\n    const AK = \x26quot;AK密钥\x26quot;;\n    const apiVersion = \x26quot;3.0\x26quot;;\n    const timestamp = new Date().getTime();\n    const BMap_URL = \x26quot;http:\/\/api.map.baidu.com\/api?v=\x26quot;\x2b apiVersion \x2b\x26quot;\x26amp;ak=\x26quot;\x2b AK \x2b\x26quot;\x26amp;services=\x26amp;t=\x26quot; \x2b timestamp;\n    return new Promise((resolve, reject) =\x3e {\n      \/\/ 插入script脚本\n      let scriptNode = document.createElement(\x26quot;script\x26quot;);\n      scriptNode.setAttribute(\x26quot;type\x26quot;, \x26quot;text\/javascript\x26quot;);\n      scriptNode.setAttribute(\x26quot;src\x26quot;, BMap_URL);\n      document.body.appendChild(scriptNode);\n\n      \/\/ 等待页面加载完毕回调\n      window.onload = function () {  \n         resolve(BMap)  \n       } \n    });\n  }\n}\n\n\/\/ -------------------------\n\/\/ vue引入调用\nimport BaiduMap from \x27baidu-map\x27;\n\n...\nmounted(){\n    BauduMap.init()\n    .then((BMap) =\x3e {\n        console.log(BMap)\n        console.log(\x26quot;加载成功...\x26quot;)\n    })\n}\n...  \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attr\x22\x3einit\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e AK = \x3cspan class=\x22hljs-string\x22\x3e\x22AK密钥\x22\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e apiVersion = \x3cspan class=\x22hljs-string\x22\x3e\x223.0\x22\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e timestamp = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e().getTime();\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e BMap_URL = \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/api.map.baidu.com\/api?v=\x22\x3c\/span\x3e\x2b apiVersion \x2b\x3cspan class=\x22hljs-string\x22\x3e\x22\x26amp;ak=\x22\x3c\/span\x3e\x2b AK \x2b\x3cspan class=\x22hljs-string\x22\x3e\x22\x26amp;services=\x26amp;t=\x22\x3c\/span\x3e \x2b timestamp;\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 插入script脚本\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e scriptNode = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x22script\x22\x3c\/span\x3e);\n      scriptNode.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e);\n      scriptNode.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22src\x22\x3c\/span\x3e, BMap_URL);\n      \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(scriptNode);\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 等待页面加载完毕回调\x3c\/span\x3e\n      \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{  \n         resolve(BMap)  \n       } \n    });\n  }\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ -------------------------\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ vue引入调用\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e BaiduMap \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27baidu-map\x27\x3c\/span\x3e;\n\n...\nmounted(){\n    BauduMap.init()\n    .then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eBMap\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(BMap)\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22加载成功...\x22\x3c\/span\x3e)\n    })\n}\n...  \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e结果还是不行。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e想了下原因，一、可能是vue中window.onload没有触发，二、百度地图JSSDK没有真正加载成功。\x3c\/p\x3e\n\x3cp\x3e继续验证测试，发现window.onload能够正常触发，那就是JSSDK没有加载成功。\x3c\/p\x3e\n\x3cp\x3e直接复制JSSDK URL浏览器中打开 \x3ca href=\x22http:\/\/api.map.baidu.com\/api?v=3.0\x26amp;ak=\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/api.map.baidu.com\/api?v=3.0\x26amp;ak=您的密钥\x3c\/a\x3e ，\x3cstrong\x3e关键点来了\x3c\/strong\x3e，打开后内容如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22(function(){ \nwindow.BMap_loadScriptTime = (new Date).getTime(); \ndocument.write(\x27\x3cscript type=\x26quot;text\/javascript\x26quot; src=\x26quot;http:\/\/api.map.baidu.com\/getscript?v=3.0\x26amp;ak=您的密钥\x26amp;services=\x26amp;t=20180102163224\x26quot;\x3e\x3c\/script\x3e\x27);\n})();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{ \n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.BMap_loadScriptTime = (\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e).getTime(); \n\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.write(\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;script type=\x22text\/javascript\x22 src=\x22http:\/\/api.map.baidu.com\/getscript?v=3.0\x26amp;ak=您的密钥\x26amp;services=\x26amp;t=20180102163224\x22\x26gt;\x26lt;\/script\x26gt;\x27\x3c\/span\x3e);\n})();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e从返回内容中看出，立即执行函数中再次插入了另外一个\x26lt;scirpt\x26gt;标签，经检查发现这个\x26lt;scirpt\x26gt;实际并没有插入成功。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e既然如此，那就直接把脚本放到我们上面的代码中去加载，结果就真的成功了。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e修改优化后的代码如下：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export default {\n  init: function (){\n    console.log(\x26quot;初始化百度地图脚本...\x26quot;);\n    const AK = \x26quot;AK密钥\x26quot;;\n    const apiVersion = \x26quot;3.0\x26quot;;\n    const timestamp = new Date().getTime();\n    const BMap_URL = \x26quot;http:\/\/api.map.baidu.com\/getscript?v=\x26quot;\x2b apiVersion \x2b\x26quot;\x26amp;ak=\x26quot;\x2b AK \x2b\x26quot;\x26amp;services=\x26amp;t=\x26quot; \x2b timestamp;\n    return new Promise((resolve, reject) =\x3e {\n      if(typeof BMap !== \x26quot;undefined\x26quot;) {\n        resolve(BMap);\n        return true;\n      }\n\n      \/\/ 插入script脚本\n      let scriptNode = document.createElement(\x26quot;script\x26quot;);\n      scriptNode.setAttribute(\x26quot;type\x26quot;, \x26quot;text\/javascript\x26quot;);\n      scriptNode.setAttribute(\x26quot;src\x26quot;, BMap_URL);\n      document.body.appendChild(scriptNode);\n\n      \/\/ 等待页面加载完毕回调\n      let timeout = 0;\n      let interval = setInterval(() =\x3e {\n        \/\/ 超时10秒加载失败\n        if(timeout \x3e= 20) {\n          reject();\n          clearInterval(interval);\n          console.error(\x26quot;百度地图脚本初始化失败...\x26quot;);\n        }\n        \/\/ 加载成功\n        if(typeof BMap !== \x26quot;undefined\x26quot;) {\n          resolve(BMap);\n          clearInterval(interval);\n          console.log(\x26quot;百度地图脚本初始化成功...\x26quot;);\n        }\n        timeout \x2b= 1;\n      }, 500);\n    });\n  }\n}  \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attr\x22\x3einit\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22初始化百度地图脚本...\x22\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e AK = \x3cspan class=\x22hljs-string\x22\x3e\x22AK密钥\x22\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e apiVersion = \x3cspan class=\x22hljs-string\x22\x3e\x223.0\x22\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e timestamp = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e().getTime();\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e BMap_URL = \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/api.map.baidu.com\/getscript?v=\x22\x3c\/span\x3e\x2b apiVersion \x2b\x3cspan class=\x22hljs-string\x22\x3e\x22\x26amp;ak=\x22\x3c\/span\x3e\x2b AK \x2b\x3cspan class=\x22hljs-string\x22\x3e\x22\x26amp;services=\x26amp;t=\x22\x3c\/span\x3e \x2b timestamp;\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e BMap !== \x3cspan class=\x22hljs-string\x22\x3e\x22undefined\x22\x3c\/span\x3e) {\n        resolve(BMap);\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n      }\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 插入script脚本\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e scriptNode = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x22script\x22\x3c\/span\x3e);\n      scriptNode.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e);\n      scriptNode.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22src\x22\x3c\/span\x3e, BMap_URL);\n      \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(scriptNode);\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 等待页面加载完毕回调\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e timeout = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e interval = setInterval(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 超时10秒加载失败\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(timeout \x26gt;= \x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e) {\n          reject();\n          clearInterval(interval);\n          \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error(\x3cspan class=\x22hljs-string\x22\x3e\x22百度地图脚本初始化失败...\x22\x3c\/span\x3e);\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 加载成功\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e BMap !== \x3cspan class=\x22hljs-string\x22\x3e\x22undefined\x22\x3c\/span\x3e) {\n          resolve(BMap);\n          clearInterval(interval);\n          \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22百度地图脚本初始化成功...\x22\x3c\/span\x3e);\n        }\n        timeout \x2b= \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n      }, \x3cspan class=\x22hljs-number\x22\x3e500\x3c\/span\x3e);\n    });\n  }\n}  \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e问题到此就解决了，至于为什么用官网提供的地址没有真正加载到JSSDK这个问题有空再研究下。\x3c\/p\x3e\n\x3chr\x3e\n\x3cp\x3e\x3cstrong\x3e最新解决方案\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export default {\n  init: function (){\n    \/\/console.log(\x26quot;初始化百度地图脚本...\x26quot;);\n    const AK = \x26quot;AK密钥\x26quot;;\n    const BMap_URL = \x26quot;https:\/\/api.map.baidu.com\/api?v=2.0\x26amp;ak=\x26quot;\x2b AK \x2b\x26quot;\x26amp;s=1\x26amp;callback=onBMapCallback\x26quot;;\n    return new Promise((resolve, reject) =\x3e {\n      \/\/ 如果已加载直接返回\n      if(typeof BMap !== \x26quot;undefined\x26quot;) {\n        resolve(BMap);\n        return true;\n      }\n      \/\/ 百度地图异步加载回调处理\n      window.onBMapCallback = function () {\n        console.log(\x26quot;百度地图脚本初始化成功...\x26quot;);\n        resolve(BMap);\n      };\n\n      \/\/ 插入script脚本\n      let scriptNode = document.createElement(\x26quot;script\x26quot;);\n      scriptNode.setAttribute(\x26quot;type\x26quot;, \x26quot;text\/javascript\x26quot;);\n      scriptNode.setAttribute(\x26quot;src\x26quot;, BMap_URL);\n      document.body.appendChild(scriptNode);\n    });\n  }\n}  \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-attr\x22\x3einit\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/console.log(\x22初始化百度地图脚本...\x22);\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e AK = \x3cspan class=\x22hljs-string\x22\x3e\x22AK密钥\x22\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e BMap_URL = \x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/api.map.baidu.com\/api?v=2.0\x26amp;ak=\x22\x3c\/span\x3e\x2b AK \x2b\x3cspan class=\x22hljs-string\x22\x3e\x22\x26amp;s=1\x26amp;callback=onBMapCallback\x22\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果已加载直接返回\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e BMap !== \x3cspan class=\x22hljs-string\x22\x3e\x22undefined\x22\x3c\/span\x3e) {\n        resolve(BMap);\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n      }\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 百度地图异步加载回调处理\x3c\/span\x3e\n      \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.onBMapCallback = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22百度地图脚本初始化成功...\x22\x3c\/span\x3e);\n        resolve(BMap);\n      };\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 插入script脚本\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e scriptNode = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x22script\x22\x3c\/span\x3e);\n      scriptNode.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e);\n      scriptNode.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22src\x22\x3c\/span\x3e, BMap_URL);\n      \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(scriptNode);\n    });\n  }\n}  \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e优化如下：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e直接使用官网提供的引用地址：\x3ccode\x3ehttp:\/\/api.map.baidu.com\/api?v=2.0\x26amp;ak=您的密钥\x3c\/code\x3e\n\x3c\/li\x3e\n\x3cli\x3e启用 \x3ccode\x3ecallback\x3c\/code\x3e 参数，异步加载必须使用此参数才可以生效\x3c\/li\x3e\n\x3cli\x3e启用 \x3ccode\x3ehttps\x3c\/code\x3e 配置，通过 \x3ccode\x3es=1\x3c\/code\x3e 参数实现\x3c\/li\x3e\n\x3cli\x3eAPI版本为\x3ccode\x3e2.0\x3c\/code\x3e，经测试使用，发现\x3ccode\x3e3.0\x3c\/code\x3e版本在HTTPS环境下是有问题的，脚本内部某些请求固定使用HTTP，无法正常使用。\x3c\/li\x3e\n\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>解决Vue引入百度地图JSSDK：BMap is undefined 问题</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000012815739">https://segmentfault.com/a/1190000012815739</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/rbh8472za3f/" target="_blank">https://alili.tech/archive/rbh8472za3f/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>