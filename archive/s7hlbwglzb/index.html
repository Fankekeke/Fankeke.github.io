<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="没有了CommonsChunkPlugin，咱拿什么来分包（译）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>没有了CommonsChunkPlugin，咱拿什么来分包（译） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/s7hlbwglzb/",
				"appid": "1613049289050283", 
				"title": "没有了CommonsChunkPlugin，咱拿什么来分包（译） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-12T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/t6x2c3891cs/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/0j0rle83cglq/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fs7hlbwglzb%2f&text=%e6%b2%a1%e6%9c%89%e4%ba%86CommonsChunkPlugin%ef%bc%8c%e5%92%b1%e6%8b%bf%e4%bb%80%e4%b9%88%e6%9d%a5%e5%88%86%e5%8c%85%ef%bc%88%e8%af%91%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fs7hlbwglzb%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fs7hlbwglzb%2f&text=%e6%b2%a1%e6%9c%89%e4%ba%86CommonsChunkPlugin%ef%bc%8c%e5%92%b1%e6%8b%bf%e4%bb%80%e4%b9%88%e6%9d%a5%e5%88%86%e5%8c%85%ef%bc%88%e8%af%91%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fs7hlbwglzb%2f&title=%e6%b2%a1%e6%9c%89%e4%ba%86CommonsChunkPlugin%ef%bc%8c%e5%92%b1%e6%8b%bf%e4%bb%80%e4%b9%88%e6%9d%a5%e5%88%86%e5%8c%85%ef%bc%88%e8%af%91%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fs7hlbwglzb%2f&is_video=false&description=%e6%b2%a1%e6%9c%89%e4%ba%86CommonsChunkPlugin%ef%bc%8c%e5%92%b1%e6%8b%bf%e4%bb%80%e4%b9%88%e6%9d%a5%e5%88%86%e5%8c%85%ef%bc%88%e8%af%91%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e6%b2%a1%e6%9c%89%e4%ba%86CommonsChunkPlugin%ef%bc%8c%e5%92%b1%e6%8b%bf%e4%bb%80%e4%b9%88%e6%9d%a5%e5%88%86%e5%8c%85%ef%bc%88%e8%af%91%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fs7hlbwglzb%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fs7hlbwglzb%2f&title=%e6%b2%a1%e6%9c%89%e4%ba%86CommonsChunkPlugin%ef%bc%8c%e5%92%b1%e6%8b%bf%e4%bb%80%e4%b9%88%e6%9d%a5%e5%88%86%e5%8c%85%ef%bc%88%e8%af%91%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fs7hlbwglzb%2f&title=%e6%b2%a1%e6%9c%89%e4%ba%86CommonsChunkPlugin%ef%bc%8c%e5%92%b1%e6%8b%bf%e4%bb%80%e4%b9%88%e6%9d%a5%e5%88%86%e5%8c%85%ef%bc%88%e8%af%91%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fs7hlbwglzb%2f&title=%e6%b2%a1%e6%9c%89%e4%ba%86CommonsChunkPlugin%ef%bc%8c%e5%92%b1%e6%8b%bf%e4%bb%80%e4%b9%88%e6%9d%a5%e5%88%86%e5%8c%85%ef%bc%88%e8%af%91%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fs7hlbwglzb%2f&title=%e6%b2%a1%e6%9c%89%e4%ba%86CommonsChunkPlugin%ef%bc%8c%e5%92%b1%e6%8b%bf%e4%bb%80%e4%b9%88%e6%9d%a5%e5%88%86%e5%8c%85%ef%bc%88%e8%af%91%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">没有了CommonsChunkPlugin，咱拿什么来分包（译）</h1><div class="meta"><div class="postdate"><time datetime="2018-12-12" itemprop="datePublished">2018-12-12</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e原文：\x3ca href=\x22http:\/\/www.codedata.cn\/hacknews\/151994848372127661\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRIP CommonsChunkPlugin\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3ewebpack 4 移除 \x3ccode\x3eCommonsChunkPlugin\x3c\/code\x3e，取而代之的是两个新的配置项（optimization.splitChunks 和 optimization.runtimeChunk），下面介绍一下用法和机制。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e默认方式\x3c\/h2\x3e\n\x3cp\x3ewebpack模式模式现在已经做了一些通用性优化，适用于多数使用者。\x3c\/p\x3e\n\x3cp\x3e需要注意的是：默认模式只影响按需(on-demand)加载的代码块(chunk)，因为改变初始代码块会影响声明在HTML的\x3ccode\x3escript\x3c\/code\x3e标签。如果可以处理好这些（比如，从打包状态里面读取并动态生成script标签到HTML），你可以通过设置\x3ccode\x3eoptimization.splitChunks.chunks: \x22all\x22\x3c\/code\x3e，应用这些优化模式到初始代码块(initial chunk)。\x3c\/p\x3e\n\x3cp\x3ewebpack根据下述条件自动进行代码块分割：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e新代码块可以被共享引用，OR这些模块都是来自\x3ccode\x3enode_modules\x3c\/code\x3e文件夹里面\x3c\/li\x3e\n\x3cli\x3e新代码块大于30kb（min\x2bgziped之前的体积）\x3c\/li\x3e\n\x3cli\x3e按需加载的代码块，最大数量应该小于或者等于5\x3c\/li\x3e\n\x3cli\x3e初始加载的代码块，最大数量应该小于或等于3\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e为了满足后面两个条件，webpack有可能受限于包的最大数量值，生成的代码体积往上增加。\x3c\/p\x3e\n\x3cp\x3e我们来看一下一些例子：\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3eExample 1\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ entry.js\nimport(\x26quot;.\/a\x26quot;);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22swift hljs\x22\x3e\x3ccode class=\x22swift\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ entry.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e(\x22.\/a\x22);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ a.js\nimport \x26quot;react-dom\x26quot;;\n\/\/ ...\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22swift hljs\x22\x3e\x3ccode class=\x22swift\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ a.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x22react-dom\x22;\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e结果：webpack会创建一个包含\x3ccode\x3ereact-dom\x3c\/code\x3e的分离代码块。当\x3ccode\x3eimport\x3c\/code\x3e调用时候，这个代码块就会与\x3ccode\x3e.\/a\x3c\/code\x3e代码被并行加载。\x3c\/p\x3e\n\x3cp\x3e为什么会这样打包：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e条件1：这个代码块是从\x3ccode\x3enode_modules\x3c\/code\x3e来的\x3c\/li\x3e\n\x3cli\x3e条件2：react-dom大于30kb\x3c\/li\x3e\n\x3cli\x3e条件3：按需请求的数量是2（小于5）\x3c\/li\x3e\n\x3cli\x3e条件4：不会影响初始代码请求数量\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e这样打包有什么好处呢？\x3c\/p\x3e\n\x3cp\x3e对比起你的应用代码，\x3ccode\x3ereact-dom\x3c\/code\x3e可能不会经常变动。通过将它分割至另外一个代码块，这个代码块可以被独立缓存起来（假设你在用的是长期缓存策略：chunkhash，records，Cache-Control）\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3eExample 2\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ entry.js\nimport(\x26quot;.\/a\x26quot;);\nimport(\x26quot;.\/b\x26quot;);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22swift hljs\x22\x3e\x3ccode class=\x22swift\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ entry.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e(\x22.\/a\x22);\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e(\x22.\/b\x22);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ a.js\nimport \x26quot;.\/helpers\x26quot;; \/\/ helpers is 40kb in size\n\/\/ ...\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22swift hljs\x22\x3e\x3ccode class=\x22swift\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ a.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x22.\/helpers\x22; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ helpers is 40kb in size\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ b.js\nimport \x26quot;.\/helpers\x26quot;;\nimport \x26quot;.\/more-helpers\x26quot;; \/\/ more-helpers is also 40kb in size\n\/\/ ...\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22swift hljs\x22\x3e\x3ccode class=\x22swift\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ b.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x22.\/helpers\x22;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x22.\/more-helpers\x22; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ more-helpers is also 40kb in size\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e结果：webpack会创建一个包含\x3ccode\x3e.\/helpers\x3c\/code\x3e的独立代码块，其他模块会依赖于它。在\x3ccode\x3eimport\x3c\/code\x3e被调用时候，这个代码块会跟原始的代码并行加载（译注：它会跟\x3ccode\x3ea.js\x3c\/code\x3e和\x3ccode\x3eb.js\x3c\/code\x3e并行加载）。\x3c\/p\x3e\n\x3cp\x3e为什么会这样打包：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e条件1：这个代码块会被两个导入(\x3ccode\x3eimport\x3c\/code\x3e)调用依赖（指的是\x3ccode\x3ea.js\x3c\/code\x3e和\x3ccode\x3eb.js\x3c\/code\x3e）\x3c\/li\x3e\n\x3cli\x3e条件2：\x3ccode\x3ehelpers\x3c\/code\x3e体积大于30kb\x3c\/li\x3e\n\x3cli\x3e条件3：按需请求的数量是2（小于5）\x3c\/li\x3e\n\x3cli\x3e条件4：不会影响初始代码请求数量\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e这样打包有什么好处呢？\x3c\/p\x3e\n\x3cp\x3e将\x3ccode\x3ehelpers\x3c\/code\x3e代码放在每一个依赖的块里，可能就意味着，用户重复会下载它两次。通过用一个独立的代码块分割，它只需要被下载一次。实际上，这只是一种折衷方案，因为我们为此需要付出额外的一次请求的代价。这就是为什么默认webpack将最小代码块分割体积设置成30kb（译注：太小体积的代码块被分割，可能还会因为额外的请求，拖慢加载性能）。\x3c\/p\x3e\n\x3cp\x3e通过\x3ccode\x3eoptimizations.splitChunks.chunks: \x22all\x22\x3c\/code\x3e，上面的策略也可以应用到初始代码块上(inital chunks)。代码代码块也会被多个入口共享\x26amp;按需加载（译注：以往我们使用CommonsChunkPlugin最通常的目的）。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e配置\x3c\/h2\x3e\n\x3cp\x3e如果想要更深入控制这个按需分块的功能，这里提供很多选项来满足你的需求。\x3c\/p\x3e\n\x3cp\x3eDisclaimer：不要在没有实践测量的情况下，尝试手动优化这些参数。默认模式是经过千挑万选的，可以用于满足最佳web性能的策略。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e缓存组（Cache Group）\x3c\/h3\x3e\n\x3cp\x3e这项优化可以用于将模块分配到对应的\x3ccode\x3eCache group\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e默认模式会将所有来自\x3ccode\x3enode_modules\x3c\/code\x3e的模块分配到一个叫\x3ccode\x3evendors\x3c\/code\x3e的缓存组；所有重复引用至少两次的代码，会被分配到\x3ccode\x3edefault\x3c\/code\x3e的缓存组。\x3c\/p\x3e\n\x3cp\x3e一个模块可以被分配到多个缓存组，优化策略会将模块分配至跟高优先级别（priority）的缓存组，或者会分配至可以形成更大体积代码块的组里。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3eConditions\x3c\/h3\x3e\n\x3cp\x3e在满足下述所有条件时，那些从相同代码块和缓存组来的模块，会形成一个新的代码块（译注：比如，在满足条件下，一个vendoer可能会被分割成两个，以充分利用并行请求性能）。\x3c\/p\x3e\n\x3cp\x3e有四个选项可以用于配置这些条件：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ccode\x3eminSize\x3c\/code\x3e(默认是30000)：形成一个新代码块最小的体积\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eminChunks\x3c\/code\x3e（默认是1）：在分割之前，这个代码块最小应该被引用的次数（译注：保证代码块复用性，默认配置的策略是不需要多次引用也可以被分割）\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3emaxInitialRequests\x3c\/code\x3e（默认是3）：一个入口最大的并行请求数\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3emaxAsyncRequests\x3c\/code\x3e（默认是5）：按需加载时候最大的并行请求数。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3eNaming\x3c\/h3\x3e\n\x3cp\x3e要控制代码块的命名，可以用\x3ccode\x3ename\x3c\/code\x3e参数来配置。\x3c\/p\x3e\n\x3cp\x3e注意：当不同分割代码块被赋予相同名称时候，他们会被合并在一起。这个可以用于在：比如将那些多个入口\/分割点的共享模块(vendor)合并在一起，不过不推荐这样做。这可能会导致加载额外的代码。\x3c\/p\x3e\n\x3cp\x3e如果赋予一个神奇的值\x3ccode\x3etrue\x3c\/code\x3e，webpack会基于代码块和缓存组的\x3ccode\x3ekey\x3c\/code\x3e自动选择一个名称。除此之外，可以使用字符串或者函数作为参数值。\x3c\/p\x3e\n\x3cp\x3e当一个名称匹配到相应的入口名称，这个入口会被移除。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3eSelect chunks\x3c\/h3\x3e\n\x3cp\x3e通过\x3ccode\x3echunks\x3c\/code\x3e选项，可以配置控制webpack选择哪些代码块用于分割（译注：其他类型代码块按默认方式打包）。有3个可选的值：\x3ccode\x3einitial\x3c\/code\x3e、\x3ccode\x3easync\x3c\/code\x3e和\x3ccode\x3eall\x3c\/code\x3e。webpack将会只对配置所对应的代码块应用这些策略。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ereuseExistingChunk\x3c\/code\x3e选项允许复用已经存在的代码块，而不是新建一个新的，需要在精确匹配到对应模块时候才会生效。\x3c\/p\x3e\n\x3cp\x3e这个选项可以在每个缓存组（Cache Group）里面做配置。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3eSelect modules\x3c\/h3\x3e\n\x3cp\x3e\x3ccode\x3etest\x3c\/code\x3e选项用于控制哪些模块被这个缓存组匹配到。原封不动传递出去的话，它默认会选择所有的模块。可以传递的值类型：\x3ccode\x3eRegExp\x3c\/code\x3e、\x3ccode\x3eString\x3c\/code\x3e和\x3ccode\x3eFunction\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e通过这个选项，可以通过绝对资源路径（absolute modules resource path）或者代码块名称(chunk names)来匹配对应模块。当一个代码块名称(chunk name)被匹配到，这个代码块的所有模块都会被选中。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e配置缓存组(Configurate cache group)\x3c\/h3\x3e\n\x3cp\x3e这是默认的配置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22splitChunks: {\n    chunks: \x26quot;async\x26quot;,\n    minSize: 30000,\n    minChunks: 1,\n    maxAsyncRequests: 5,\n    maxInitialRequests: 3,\n    name: true,\n    cacheGroups: {\n        default: {\n            minChunks: 2,\n            priority: -20,\n            reuseExistingChunk: true,\n        },\n        vendors: {\n            test: \/[\\\\\/]node_modules[\\\\\/]\/,\n            priority: -10\n        }\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22swift hljs\x22\x3e\x3ccode class=\x22swift\x22\x3esplitChunks: {\n    chunks: \x3cspan class=\x22hljs-string\x22\x3e\x22async\x22\x3c\/span\x3e,\n    minSize: \x3cspan class=\x22hljs-number\x22\x3e30000\x3c\/span\x3e,\n    minChunks: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\n    maxAsyncRequests: \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e,\n    maxInitialRequests: \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e,\n    name: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n    cacheGroups: {\n        \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e: {\n            minChunks: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e,\n            priority: -\x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e,\n            reuseExistingChunk: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n        },\n        vendors: {\n            test: \/[\\\\\/]node_modules[\\\\\/]\/,\n            priority: -\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e\n        }\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e默认来说，缓存组会继承\x3ccode\x3esplitChunks\x3c\/code\x3e的配置，但是\x3ccode\x3etest\x3c\/code\x3e、\x3ccode\x3epriorty\x3c\/code\x3e和\x3ccode\x3ereuseExistingChunk\x3c\/code\x3e只能用于配置缓存组。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ecacheGroups\x3c\/code\x3e是一个对象，按上述介绍的键值对方式来配置即可，值代表对应的选项：\x3c\/p\x3e\n\x3cp\x3e除此之外，所有上面列出的选择都是可以用在缓存组里的：\x3ccode\x3echunks\x3c\/code\x3e, \x3ccode\x3eminSize\x3c\/code\x3e, \x3ccode\x3eminChunks\x3c\/code\x3e, \x3ccode\x3emaxAsyncRequests\x3c\/code\x3e, \x3ccode\x3emaxInitialRequests\x3c\/code\x3e, \x3ccode\x3ename\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e可以通过\x3ccode\x3eoptimization.splitChunks.cacheGroups.default: false\x3c\/code\x3e禁用\x3ccode\x3edefault\x3c\/code\x3e缓存组。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3edefault\x3c\/code\x3e缓存组的优先级(priotity)是负数，因此所有自定义缓存组都可以有比它更高优先级（译注：更高优先级的缓存组可以优先打包所选择的模块）（默认自定义缓存组优先级为0）\x3c\/p\x3e\n\x3cp\x3e可以用一些例子来说明：\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3eExample 1\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22splitChunks: {\n    cacheGroups: {\n        commons: {\n            name: \x26quot;commons\x26quot;,\n            chunks: \x26quot;initial\x26quot;,\n            minChunks: 2\n        }\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22swift hljs\x22\x3e\x3ccode class=\x22swift\x22\x3esplitChunks: {\n    cacheGroups: {\n        commons: {\n            name: \x3cspan class=\x22hljs-string\x22\x3e\x22commons\x22\x3c\/span\x3e,\n            chunks: \x3cspan class=\x22hljs-string\x22\x3e\x22initial\x22\x3c\/span\x3e,\n            minChunks: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n        }\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这会创建一个\x3ccode\x3ecommons\x3c\/code\x3e代码块，这个代码块包含所有被其他入口(entrypoints)共享的代码。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e注意\x3c\/strong\x3e：这可能会导致下载额外的代码。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3eExample 2\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22splitChunks: {\n    cacheGroups: {\n        commons: {\n            test: \/[\\\\\/]node_modules[\\\\\/]\/,\n            name: \x26quot;vendors\x26quot;,\n            chunks: \x26quot;all\x26quot;\n        }\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22swift hljs\x22\x3e\x3ccode class=\x22swift\x22\x3esplitChunks: {\n    cacheGroups: {\n        commons: {\n            test: \/[\\\\\/]node_modules[\\\\\/]\/,\n            name: \x3cspan class=\x22hljs-string\x22\x3e\x22vendors\x22\x3c\/span\x3e,\n            chunks: \x3cspan class=\x22hljs-string\x22\x3e\x22all\x22\x3c\/span\x3e\n        }\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这会创建一个名为\x3ccode\x3evendors\x3c\/code\x3e的代码块，它会包含整个应用所有来自\x3ccode\x3enode_modules\x3c\/code\x3e的代码。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e注意\x3c\/strong\x3e：这可能会导致下载额外的代码。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader12\x22\x3eoptimization.runtimeChunk\x3c\/h2\x3e\n\x3cp\x3e通过\x3ccode\x3eoptimization.runtimeChunk: true\x3c\/code\x3e选项，webpack会添加一个只包含运行时(runtime)额外代码块到每一个入口。（译注：这个需要看场景使用，会导致每个入口都加载多一份运行时代码）\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>没有了CommonsChunkPlugin，咱拿什么来分包（译）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000013476837">https://segmentfault.com/a/1190000013476837</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/s7hlbwglzb/" target="_blank">https://alili.tech/archive/s7hlbwglzb/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>