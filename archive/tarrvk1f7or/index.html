<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="JavaScript专题之解读 v8 排序源码"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>JavaScript专题之解读 v8 排序源码 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/tarrvk1f7or/",
				"appid": "1613049289050283", 
				"title": "JavaScript专题之解读 v8 排序源码 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-28T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/0a8dns6i20pr/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/d3dt9g71l5e/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2ftarrvk1f7or%2f&text=JavaScript%e4%b8%93%e9%a2%98%e4%b9%8b%e8%a7%a3%e8%af%bb%20v8%20%e6%8e%92%e5%ba%8f%e6%ba%90%e7%a0%81"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2ftarrvk1f7or%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2ftarrvk1f7or%2f&text=JavaScript%e4%b8%93%e9%a2%98%e4%b9%8b%e8%a7%a3%e8%af%bb%20v8%20%e6%8e%92%e5%ba%8f%e6%ba%90%e7%a0%81"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2ftarrvk1f7or%2f&title=JavaScript%e4%b8%93%e9%a2%98%e4%b9%8b%e8%a7%a3%e8%af%bb%20v8%20%e6%8e%92%e5%ba%8f%e6%ba%90%e7%a0%81"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2ftarrvk1f7or%2f&is_video=false&description=JavaScript%e4%b8%93%e9%a2%98%e4%b9%8b%e8%a7%a3%e8%af%bb%20v8%20%e6%8e%92%e5%ba%8f%e6%ba%90%e7%a0%81"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=JavaScript%e4%b8%93%e9%a2%98%e4%b9%8b%e8%a7%a3%e8%af%bb%20v8%20%e6%8e%92%e5%ba%8f%e6%ba%90%e7%a0%81&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2ftarrvk1f7or%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2ftarrvk1f7or%2f&title=JavaScript%e4%b8%93%e9%a2%98%e4%b9%8b%e8%a7%a3%e8%af%bb%20v8%20%e6%8e%92%e5%ba%8f%e6%ba%90%e7%a0%81"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftarrvk1f7or%2f&title=JavaScript%e4%b8%93%e9%a2%98%e4%b9%8b%e8%a7%a3%e8%af%bb%20v8%20%e6%8e%92%e5%ba%8f%e6%ba%90%e7%a0%81"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftarrvk1f7or%2f&title=JavaScript%e4%b8%93%e9%a2%98%e4%b9%8b%e8%a7%a3%e8%af%bb%20v8%20%e6%8e%92%e5%ba%8f%e6%ba%90%e7%a0%81"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftarrvk1f7or%2f&title=JavaScript%e4%b8%93%e9%a2%98%e4%b9%8b%e8%a7%a3%e8%af%bb%20v8%20%e6%8e%92%e5%ba%8f%e6%ba%90%e7%a0%81"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">JavaScript专题之解读 v8 排序源码</h1><div class="meta"><div class="postdate"><time datetime="2018-12-28" itemprop="datePublished">2018-12-28</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3eJavaScript 专题系列第二十篇，也是最后一篇，解读 v8 排序源码\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e前言\x3c\/h2\x3e\n\x3cp\x3ev8 是 Chrome 的 JavaScript 引擎，其中关于数组的排序完全采用了 JavaScript 实现。\x3c\/p\x3e\n\x3cp\x3e排序采用的算法跟数组的长度有关，当数组长度小于等于 10 时，采用插入排序，大于 10 的时候，采用快速排序。(当然了，这种说法并不严谨)。\x3c\/p\x3e\n\x3cp\x3e我们先来看看插入排序和快速排序。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e插入排序\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e原理\x3c\/h3\x3e\n\x3cp\x3e将第一个元素视为有序序列，遍历数组，将之后的元素依次插入这个构建的有序序列中。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e图示\x3c\/h3\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011521014?w=394\x26amp;h=520\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011521014?w=394\x26amp;h=520\x22 alt=\x22插入排序\x22 title=\x22插入排序\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e实现\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function insertionSort(arr) {\n    for (var i = 1; i \x3c arr.length; i\x2b\x2b) {\n        var element = arr[i];\n        for (var j = i - 1; j \x3e= 0; j--) {\n            var tmp = arr[j];\n            var order = tmp - element;\n            if (order \x3e 0) {\n                arr[j \x2b 1] = tmp;\n            } else {\n                break;\n            }\n        }\n        arr[j \x2b 1] = element;\n    }\n    return arr;\n}\n\nvar arr = [6, 5, 4, 3, 2, 1];\nconsole.log(insertionSort(arr));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3einsertionSort\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3earr\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e; i \x26lt; arr.length; i\x2b\x2b) {\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e element = arr[i];\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e j = i - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e; j \x26gt;= \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; j--) {\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e tmp = arr[j];\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e order = tmp - element;\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (order \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n                arr[j \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e] = tmp;\n            } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n            }\n        }\n        arr[j \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e] = element;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e arr;\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e arr = [\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e];\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(insertionSort(arr));\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e时间复杂度\x3c\/h3\x3e\n\x3cp\x3e时间复杂度是指执行算法所需要的计算工作量，它考察当输入值大小趋近无穷时的情况，一般情况下，算法中基本操作重复执行的次数是问题规模 n 的某个函数。\x3c\/p\x3e\n\x3cp\x3e最好情况：数组升序排列，时间复杂度为：O(n)\x3c\/p\x3e\n\x3cp\x3e最坏情况：数组降序排列，时间复杂度为：O(n²)\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e稳定性\x3c\/h3\x3e\n\x3cp\x3e稳定性，是指相同的元素在排序后是否还保持相对的位置。\x3c\/p\x3e\n\x3cp\x3e要注意的是对于不稳定的排序算法，只要举出一个实例，即可说明它的不稳定性；而对于稳定的排序算法，必须对算法进行分析从而得到稳定的特性。\x3c\/p\x3e\n\x3cp\x3e比如 [3, 3, 1]，排序后，还是 [3, 3, 1]，但是其实是第二个 3 在 第一个 3 前，那这就是不稳定的排序算法。\x3c\/p\x3e\n\x3cp\x3e插入排序是稳定的算法。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e优势\x3c\/h3\x3e\n\x3cp\x3e当数组是快要排序好的状态或者问题规模比较小的时候，插入排序效率更高。这也是为什么 v8 会在数组长度小于等于 10 的时候采用插入排序。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e快速排序\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e原理\x3c\/h3\x3e\n\x3col\x3e\n\x3cli\x3e选择一个元素作为\x22基准\x22\x3c\/li\x3e\n\x3cli\x3e小于\x22基准\x22的元素，都移到\x22基准\x22的左边；大于\x22基准\x22的元素，都移到\x22基准\x22的右边。\x3c\/li\x3e\n\x3cli\x3e对\x22基准\x22左边和右边的两个子集，不断重复第一步和第二步，直到所有子集只剩下一个元素为止。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e示例\x3c\/h3\x3e\n\x3cp\x3e示例和下面的实现方式来源于阮一峰老师的\x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2011\/04\/quicksort_in_javascript.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e《快速排序（Quicksort）的Javascript实现》\x3c\/a\x3e \x3c\/p\x3e\n\x3cp\x3e以数组 [85, 24, 63, 45, 17, 31, 96, 50] 为例：\x3c\/p\x3e\n\x3cp\x3e第一步，选择中间的元素 45 作为\x22基准\x22。（基准值可以任意选择，但是选择中间的值比较容易理解。）\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011623642?w=1044\x26amp;h=152\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011623642?w=1044\x26amp;h=152\x22 alt=\x22quick 第一步\x22 title=\x22quick 第一步\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e第二步，按照顺序，将每个元素与\x22基准\x22进行比较，形成两个子集，一个\x22小于45\x22，另一个\x22大于等于45\x22。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011623643?w=1054\x26amp;h=156\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011623643?w=1054\x26amp;h=156\x22 alt=\x22quick 第二步\x22 title=\x22quick 第二步\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e第三步，对两个子集不断重复第一步和第二步，直到所有子集只剩下一个元素为止。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011623644?w=1056\x26amp;h=620\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011623644?w=1056\x26amp;h=620\x22 alt=\x22quick 第三步\x22 title=\x22quick 第三步\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e实现\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var quickSort = function(arr) {\n　　if (arr.length \x3c= 1) { return arr; }\n    \/\/ 取数组的中间元素作为基准\n　　var pivotIndex = Math.floor(arr.length \/ 2);\n　　var pivot = arr.splice(pivotIndex, 1)[0];\n\n　　var left = [];\n　　var right = [];\n\n　　for (var i = 0; i \x3c arr.length; i\x2b\x2b){\n　　　　if (arr[i] \x3c pivot) {\n　　　　　　left.push(arr[i]);\n　　　　} else {\n　　　　　　right.push(arr[i]);\n　　　　}\n　　}\n　　return quickSort(left).concat([pivot], quickSort(right));\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e quickSort = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3earr\x3c\/span\x3e) \x3c\/span\x3e{\n　　\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (arr.length \x26lt;= \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) { \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e arr; }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 取数组的中间元素作为基准\x3c\/span\x3e\n　　\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e pivotIndex = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(arr.length \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n　　\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e pivot = arr.splice(pivotIndex, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n\n　　\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e left = [];\n　　\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e right = [];\n\n　　\x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; arr.length; i\x2b\x2b){\n　　　　\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (arr[i] \x26lt; pivot) {\n　　　　　　left.push(arr[i]);\n　　　　} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n　　　　　　right.push(arr[i]);\n　　　　}\n　　}\n　　\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e quickSort(left).concat([pivot], quickSort(right));\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然而这种实现方式需要额外的空间用来储存左右子集，所以还有一种原地(in-place)排序的实现方式。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e图示\x3c\/h3\x3e\n\x3cp\x3e我们来看看原地排序的实现图示：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011623645?w=866\x26amp;h=260\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011623645?w=866\x26amp;h=260\x22 alt=\x22快速排序\x22 title=\x22快速排序\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e为了让大家看明白快速排序的原理，我调慢了执行速度。\x3c\/p\x3e\n\x3cp\x3e在这张示意图里，基准的取值规则是取最左边的元素，黄色代表当前的基准，绿色代表小于基准的元素，紫色代表大于基准的元素。\x3c\/p\x3e\n\x3cp\x3e我们会发现，绿色的元素会紧挨在基准的右边，紫色的元素会被移到后面，然后交换基准和绿色的最后一个元素，此时，基准处于正确的位置，即前面的元素都小于基准值，后面的元素都大于基准值。然后再对前面的和后面的多个元素取基准，做排序。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3ein-place 实现\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function quickSort(arr) {\n    \/\/ 交换元素\n    function swap(arr, a, b) {\n        var temp = arr[a];\n        arr[a] = arr[b];\n        arr[b] = temp;\n    }\n\n    function partition(arr, left, right) {\n        var pivot = arr[left];\n        var storeIndex = left;\n\n        for (var i = left \x2b 1; i \x3c= right; i\x2b\x2b) {\n            if (arr[i] \x3c pivot) {\n                swap(arr, \x2b\x2bstoreIndex, i);\n            }\n        }\n\n        swap(arr, left, storeIndex);\n\n        return storeIndex;\n    }\n\n    function sort(arr, left, right) {\n        if (left \x3c right) {\n            var storeIndex = partition(arr, left, right);\n            sort(arr, left, storeIndex - 1);\n            sort(arr, storeIndex \x2b 1, right);\n        }\n    }\n\n    sort(arr, 0, arr.length - 1);\n\n    return arr;\n}\n\nconsole.log(quickSort(6, 7, 3, 4, 1, 5, 9, 2, 8))\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3equickSort\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3earr\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 交换元素\x3c\/span\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eswap\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3earr, a, b\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e temp = arr[a];\n        arr[a] = arr[b];\n        arr[b] = temp;\n    }\n\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3epartition\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3earr, left, right\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e pivot = arr[left];\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e storeIndex = left;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = left \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e; i \x26lt;= right; i\x2b\x2b) {\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (arr[i] \x26lt; pivot) {\n                swap(arr, \x2b\x2bstoreIndex, i);\n            }\n        }\n\n        swap(arr, left, storeIndex);\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e storeIndex;\n    }\n\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esort\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3earr, left, right\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (left \x26lt; right) {\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e storeIndex = partition(arr, left, right);\n            sort(arr, left, storeIndex - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n            sort(arr, storeIndex \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, right);\n        }\n    }\n\n    sort(arr, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, arr.length - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e arr;\n}\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(quickSort(\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e))\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader14\x22\x3e稳定性\x3c\/h3\x3e\n\x3cp\x3e快速排序是不稳定的排序。如果要证明一个排序是不稳定的，你只用举出一个实例就行。\x3c\/p\x3e\n\x3cp\x3e所以我们举一个呗~\x3c\/p\x3e\n\x3cp\x3e就以数组 [1, 2, 3, 3, 4, 5] 为例，因为基准的选择不确定，假如选定了第三个元素(也就是第一个 3) 为基准，所有小于 3 的元素在前面，大于等于 3 的在后面，排序的结果没有问题。可是如果选择了第四个元素(也就是第二个 3 )，小于 3 的在基准前面，大于等于 3 的在基准后面，第一个 3 就会被移动到 第二个 3 后面，所以快速排序是不稳定的排序。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader15\x22\x3e时间复杂度\x3c\/h3\x3e\n\x3cp\x3e阮一峰老师的实现中，基准取的是中间元素，而原地排序中基准取最左边的元素。快速排序的关键点就在于基准的选择，选取不同的基准时，会有不同性能表现。\x3c\/p\x3e\n\x3cp\x3e快速排序的时间复杂度最好为 O(nlogn)，可是为什么是 nlogn 呢？来一个并不严谨的证明：\x3c\/p\x3e\n\x3cp\x3e在最佳情况下，每一次都平分整个数组。假设数组有 n 个元素，其递归的深度就为 log\x3csub\x3e2\x3c\/sub\x3en \x2b 1，时间复杂度为 O(n)[(log\x3csub\x3e2\x3c\/sub\x3en \x2b 1)]，因为时间复杂度考察当输入值大小趋近无穷时的情况，所以会忽略低阶项，时间复杂度为：o(nlog\x3csub\x3e2\x3c\/sub\x3en)。\x3c\/p\x3e\n\x3cp\x3e如果一个程序的运行时间是对数级的，则随着 n 的增大程序会渐渐慢下来。如果底数是 10，lg1000 等于 3，如果 n 为 1000000，lgn 等于 6，仅为之前的两倍。如果底数为 2，log\x3csub\x3e2\x3c\/sub\x3e1000 的值约为 10，log\x3csub\x3e2\x3c\/sub\x3e1000000 的值约为 19，约为之前的两倍。我们可以发现任意底数的一个对数函数其实都相差一个常数倍而已。所以我们认为 O(logn)已经可以表达所有底数的对数了，所以时间复杂度最后为： O(nlogn)。\x3c\/p\x3e\n\x3cp\x3e而在最差情况下，如果对一个已经排序好的数组，每次选择基准元素时总是选择第一个元素或者最后一个元素，那么每次都会有一个子集是空的，递归的层数将达到 n，最后导致算法的时间复杂度退化为 O(n²)。\x3c\/p\x3e\n\x3cp\x3e这也充分说明了一个基准的选择是多么的重要，而 v8 为了提高性能，就对基准的选择做了很多优化。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader16\x22\x3ev8 基准选择\x3c\/h2\x3e\n\x3cp\x3ev8 选择基准的原理是从头和尾之外再选择一个元素，然后三个值排序取中间值。\x3c\/p\x3e\n\x3cp\x3e当数组长度大于 10 但是小于 1000 的时候，取中间位置的元素，实现代码为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 基准的下标\n\/\/ \x3e\x3e 1 相当于除以 2 (忽略余数)\nthird_index = from \x2b ((to - from) \x3e\x3e 1);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 基准的下标\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ \x26gt;\x26gt; 1 相当于除以 2 (忽略余数)\x3c\/span\x3e\nthird_index = \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x2b ((to - \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e) \x26gt;\x26gt; \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当数组长度大于 1000 的时候，每隔 200 ~ 215 个元素取一个值，然后将这些值进行排序，取中间值的下标，实现的代码为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 简单处理过\nfunction GetThirdIndex(a, from, to) {\n    var t_array = new Array();\n\n    \/\/ \x26amp; 位运算符\n    var increment = 200 \x2b ((to - from) \x26amp; 15);\n\n    var j = 0;\n    from \x2b= 1;\n    to -= 1;\n\n    for (var i = from; i \x3c to; i \x2b= increment) {\n        t_array[j] = [i, a[i]];\n        j\x2b\x2b;\n    }\n    \/\/ 对随机挑选的这些值进行排序\n    t_array.sort(function(a, b) {\n        return comparefn(a[1], b[1]);\n    });\n    \/\/ 取中间值的下标\n    var third_index = t_array[t_array.length \x3e\x3e 1][0];\n    return third_index;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 简单处理过\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eGetThirdIndex\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea, from, to\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e t_array = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e();\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ \x26amp; 位运算符\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e increment = \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e \x2b ((to - \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e) \x26amp; \x3cspan class=\x22hljs-number\x22\x3e15\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e j = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x2b= \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n    to -= \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e; i \x26lt; to; i \x2b= increment) {\n        t_array[j] = [i, a[i]];\n        j\x2b\x2b;\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 对随机挑选的这些值进行排序\x3c\/span\x3e\n    t_array.sort(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea, b\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e comparefn(a[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e], b[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e]);\n    });\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 取中间值的下标\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e third_index = t_array[t_array.length \x26gt;\x26gt; \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e][\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e third_index;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e也许你会好奇 \x3ccode\x3e200 \x2b ((to - from) \x26amp; 15)\x3c\/code\x3e 是什么意思？\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3e\x26amp;\x3c\/code\x3e 表示是按位与，对整数操作数逐位执行布尔与操作。只有两个操作数中相对应的位都是 1，结果中的这一位才是 1。\x3c\/p\x3e\n\x3cp\x3e以 \x3ccode\x3e15 \x26amp; 127\x3c\/code\x3e 为例：\x3c\/p\x3e\n\x3cp\x3e15 二进制为： （0000 1111）\x3c\/p\x3e\n\x3cp\x3e127 二进制为：（1111 1111）\x3c\/p\x3e\n\x3cp\x3e按位与结果为：（0000 1111）＝ 15\x3c\/p\x3e\n\x3cp\x3e所以 \x3ccode\x3e15 \x26amp; 127\x3c\/code\x3e 的结果为 \x3ccode\x3e15\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e注意 15 的二进制为： \x3ccode\x3e1111\x3c\/code\x3e，这就意味着任何和 15 按位与的结果都会小于或者等于 15，这才实现了每隔 200 ~ 215 个元素取一个值。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader17\x22\x3ev8 源码\x3c\/h2\x3e\n\x3cp\x3e终于到了看源码的时刻！源码地址为：\x3ca href=\x22https:\/\/github.com\/v8\/v8\/blob\/master\/src\/js\/array.js#L758\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/v8\/v8\/blob\/master\/src\/js\/array.js#L758\x3c\/a\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function InsertionSort(a, from, to) {\n    for (var i = from \x2b 1; i \x3c to; i\x2b\x2b) {\n        var element = a[i];\n        for (var j = i - 1; j \x3e= from; j--) {\n            var tmp = a[j];\n            var order = comparefn(tmp, element);\n            if (order \x3e 0) {\n                a[j \x2b 1] = tmp;\n            } else {\n                break;\n            }\n        }\n        a[j \x2b 1] = element;\n    }\n};\n\n\nfunction QuickSort(a, from, to) {\n\n    var third_index = 0;\n    while (true) {\n            \/\/ Insertion sort is faster for short arrays.\n        if (to - from \x3c= 10) {\n            InsertionSort(a, from, to);\n            return;\n        }\n        if (to - from \x3e 1000) {\n            third_index = GetThirdIndex(a, from, to);\n        } else {\n            third_index = from \x2b ((to - from) \x3e\x3e 1);\n        }\n        \/\/ Find a pivot as the median of first, last and middle element.\n        var v0 = a[from];\n        var v1 = a[to - 1];\n        var v2 = a[third_index];\n\n        var c01 = comparefn(v0, v1);\n        if (c01 \x3e 0) {\n            \/\/ v1 \x3c v0, so swap them.\n            var tmp = v0;\n            v0 = v1;\n            v1 = tmp;\n        } \/\/ v0 \x3c= v1.\n        var c02 = comparefn(v0, v2);\n        if (c02 \x3e= 0) {\n            \/\/ v2 \x3c= v0 \x3c= v1.\n            var tmp = v0;\n            v0 = v2;\n            v2 = v1;\n            v1 = tmp;\n        } else {\n            \/\/ v0 \x3c= v1 \x26amp;\x26amp; v0 \x3c v2\n            var c12 = comparefn(v1, v2);\n            if (c12 \x3e 0) {\n                \/\/ v0 \x3c= v2 \x3c v1\n                var tmp = v1;\n                v1 = v2;\n                v2 = tmp;\n            }\n        }\n\n        \/\/ v0 \x3c= v1 \x3c= v2\n        a[from] = v0;\n        a[to - 1] = v2;\n\n        var pivot = v1;\n\n        var low_end = from \x2b 1; \/\/ Upper bound of elements lower than pivot.\n        var high_start = to - 1; \/\/ Lower bound of elements greater than pivot.\n\n        a[third_index] = a[low_end];\n        a[low_end] = pivot;\n\n        \/\/ From low_end to i are elements equal to pivot.\n        \/\/ From i to high_start are elements that haven\x27t been compared yet.\n\n        partition: for (var i = low_end \x2b 1; i \x3c high_start; i\x2b\x2b) {\n            var element = a[i];\n            var order = comparefn(element, pivot);\n            if (order \x3c 0) {\n                a[i] = a[low_end];\n                a[low_end] = element;\n                low_end\x2b\x2b;\n            } else if (order \x3e 0) {\n                do {\n                    high_start--;\n                    if (high_start == i) break partition;\n                    var top_elem = a[high_start];\n                    order = comparefn(top_elem, pivot);\n                } while (order \x3e 0);\n\n                a[i] = a[high_start];\n                a[high_start] = element;\n                if (order \x3c 0) {\n                    element = a[i];\n                    a[i] = a[low_end];\n                    a[low_end] = element;\n                    low_end\x2b\x2b;\n                }\n            }\n        }\n\n\n        if (to - high_start \x3c low_end - from) {\n            QuickSort(a, high_start, to);\n            to = low_end;\n        } else {\n            QuickSort(a, from, low_end);\n            from = high_start;\n        }\n    }\n}\n\nvar arr = [10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0];\n\nfunction comparefn(a, b) {\n    return a - b\n}\n\nQuickSort(arr, 0, arr.length)\nconsole.log(arr)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eInsertionSort\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea, from, to\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e; i \x26lt; to; i\x2b\x2b) {\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e element = a[i];\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e j = i - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e; j \x26gt;= \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e; j--) {\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e tmp = a[j];\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e order = comparefn(tmp, element);\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (order \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n                a[j \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e] = tmp;\n            } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n            }\n        }\n        a[j \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e] = element;\n    }\n};\n\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eQuickSort\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea, from, to\x3c\/span\x3e) \x3c\/span\x3e{\n\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e third_index = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Insertion sort is faster for short arrays.\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (to - \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x26lt;= \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e) {\n            InsertionSort(a, \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e, to);\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (to - \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x26gt; \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e) {\n            third_index = GetThirdIndex(a, \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e, to);\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            third_index = \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x2b ((to - \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e) \x26gt;\x26gt; \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Find a pivot as the median of first, last and middle element.\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e v0 = a[\x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e];\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e v1 = a[to - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e];\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e v2 = a[third_index];\n\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e c01 = comparefn(v0, v1);\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (c01 \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ v1 \x26lt; v0, so swap them.\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e tmp = v0;\n            v0 = v1;\n            v1 = tmp;\n        } \x3cspan class=\x22hljs-comment\x22\x3e\/\/ v0 \x26lt;= v1.\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e c02 = comparefn(v0, v2);\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (c02 \x26gt;= \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ v2 \x26lt;= v0 \x26lt;= v1.\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e tmp = v0;\n            v0 = v2;\n            v2 = v1;\n            v1 = tmp;\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ v0 \x26lt;= v1 \x26amp;\x26amp; v0 \x26lt; v2\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e c12 = comparefn(v1, v2);\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (c12 \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ v0 \x26lt;= v2 \x26lt; v1\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e tmp = v1;\n                v1 = v2;\n                v2 = tmp;\n            }\n        }\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ v0 \x26lt;= v1 \x26lt;= v2\x3c\/span\x3e\n        a[\x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e] = v0;\n        a[to - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e] = v2;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e pivot = v1;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e low_end = \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Upper bound of elements lower than pivot.\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e high_start = to - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Lower bound of elements greater than pivot.\x3c\/span\x3e\n\n        a[third_index] = a[low_end];\n        a[low_end] = pivot;\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ From low_end to i are elements equal to pivot.\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ From i to high_start are elements that haven\x27t been compared yet.\x3c\/span\x3e\n\n        partition: \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = low_end \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e; i \x26lt; high_start; i\x2b\x2b) {\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e element = a[i];\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e order = comparefn(element, pivot);\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (order \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n                a[i] = a[low_end];\n                a[low_end] = element;\n                low_end\x2b\x2b;\n            } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (order \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n                \x3cspan class=\x22hljs-keyword\x22\x3edo\x3c\/span\x3e {\n                    high_start--;\n                    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (high_start == i) \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e partition;\n                    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e top_elem = a[high_start];\n                    order = comparefn(top_elem, pivot);\n                } \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (order \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n\n                a[i] = a[high_start];\n                a[high_start] = element;\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (order \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n                    element = a[i];\n                    a[i] = a[low_end];\n                    a[low_end] = element;\n                    low_end\x2b\x2b;\n                }\n            }\n        }\n\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (to - high_start \x26lt; low_end - \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e) {\n            QuickSort(a, high_start, to);\n            to = low_end;\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            QuickSort(a, \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e, low_end);\n            \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e = high_start;\n        }\n    }\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e arr = [\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecomparefn\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ea, b\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e a - b\n}\n\nQuickSort(arr, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, arr.length)\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(arr)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们以数组 \x3ccode\x3e[10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0]\x3c\/code\x3e 为例，分析执行的过程。\x3c\/p\x3e\n\x3cp\x3e1.执行 QuickSort 函数 参数 from 值为 0，参数 to 的值 11。\x3c\/p\x3e\n\x3cp\x3e2.10 \x26lt; to - from \x26lt; 1000 第三个基准元素的下标为 \x3ccode\x3e(0 \x2b 11 \x26gt;\x26gt; 1) = 5\x3c\/code\x3e，基准值 a[5] 为 5。\x3c\/p\x3e\n\x3cp\x3e3.比较 a[0] a[10] a[5] 的值，然后根据比较结果修改数组，数组此时为 [0, 9, 8, 7, 6, 5, 4, 3, 2, 1, 10]\x3c\/p\x3e\n\x3cp\x3e4.将基准值和数组的第(from \x2b 1)个即数组的第二个元素互换，此时数组为 [0, 5, 8, 7, 6, 9, 4, 3, 2, 1, 10]，此时在基准值 5 前面的元素肯定是小于 5 的，因为第三步已经做了一次比较。后面的元素是未排序的。\x3c\/p\x3e\n\x3cp\x3e我们接下来要做的就是把后面的元素中小于 5 的全部移到 5 的前面。\x3c\/p\x3e\n\x3cp\x3e5.然后我们进入 partition 循环，我们依然以这个数组为例，单独抽出来写个 demo 讲一讲\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 假设代码执行到这里，为了方便演示，我们直接设置 low_end 等变量的值\n\/\/ 可以直接复制到浏览器中查看数组变换效果\nvar a = [0, 5, 8, 7, 6, 9, 4, 3, 2, 1, 10]\nvar low_end = 1;\nvar high_start = 10;\nvar pivot = 5;\n\nconsole.log(\x27起始数组为\x27, a)\n\npartition: for (var i = low_end \x2b 1; i \x3c high_start; i\x2b\x2b) {\n\n    var element = a[i];\n    console.log(\x27循环当前的元素为：\x27, a[i])\n    var order = element - pivot;\n\n    if (order \x3c 0) {\n        a[i] = a[low_end];\n        a[low_end] = element;\n        low_end\x2b\x2b;\n        console.log(a)\n    }\n    else if (order \x3e 0) {\n        do {\n            high_start--;\n            if (high_start == i) break partition;\n            var top_elem = a[high_start];\n            order = top_elem - pivot;\n        } while (order \x3e 0);\n\n        a[i] = a[high_start];\n        a[high_start] = element;\n\n        console.log(a)\n\n        if (order \x3c 0) {\n            element = a[i];\n            a[i] = a[low_end];\n            a[low_end] = element;\n            low_end\x2b\x2b;\n        }\n        console.log(a)\n    }\n}\n\nconsole.log(\x27最后的结果为\x27, a)\nconsole.log(low_end)\nconsole.log(high_start)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 假设代码执行到这里，为了方便演示，我们直接设置 low_end 等变量的值\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 可以直接复制到浏览器中查看数组变换效果\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e a = [\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e]\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e low_end = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e high_start = \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e pivot = \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27起始数组为\x27\x3c\/span\x3e, a)\n\npartition: \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = low_end \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e; i \x26lt; high_start; i\x2b\x2b) {\n\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e element = a[i];\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27循环当前的元素为：\x27\x3c\/span\x3e, a[i])\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e order = element - pivot;\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (order \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n        a[i] = a[low_end];\n        a[low_end] = element;\n        low_end\x2b\x2b;\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(a)\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (order \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3edo\x3c\/span\x3e {\n            high_start--;\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (high_start == i) \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e partition;\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e top_elem = a[high_start];\n            order = top_elem - pivot;\n        } \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (order \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n\n        a[i] = a[high_start];\n        a[high_start] = element;\n\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(a)\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (order \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n            element = a[i];\n            a[i] = a[low_end];\n            a[low_end] = element;\n            low_end\x2b\x2b;\n        }\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(a)\n    }\n}\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27最后的结果为\x27\x3c\/span\x3e, a)\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(low_end)\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(high_start)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e6.此时数组为 \x3ccode\x3e[0, 5, 8, 7, 6, 9, 4, 3, 2, 1, 10]\x3c\/code\x3e，循环从第三个元素开始，a[i] 的值为 8，因为大于基准值 5，即 order \x26gt; 0，开始执行 do while 循环，do while 循环的目的在于倒序查找元素，找到第一个小于基准值的元素，然后让这个元素跟 a[i] 的位置交换。\x3cbr\x3e第一个小于基准值的元素为 1，然后 1 与 8 交换，数组变成  \x3ccode\x3e[0, 5, 1, 7, 6, 9, 4, 3, 2, 8, 10]\x3c\/code\x3e。high_start 的值是为了记录倒序查找到哪里了。\x3c\/p\x3e\n\x3cp\x3e7.此时 a[i] 的值变成了 1，然后让 1 跟 基准值 5 交换，数组变成了 \x3ccode\x3e[0, 1, 5, 7, 6, 9, 4, 3, 2, 8, 10]\x3c\/code\x3e，low_end 的值加 1，low_end 的值是为了记录基准值的所在位置。\x3c\/p\x3e\n\x3cp\x3e8.循环接着执行，遍历第四个元素 7，跟第 6、7 的步骤一致，数组先变成 \x3ccode\x3e[0, 1, 5, 2, 6, 9, 4, 3, 7, 8, 10]\x3c\/code\x3e，再变成 \x3ccode\x3e[0, 1, 2, 5, 6, 9, 4, 3, 7, 8, 10]\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e9.遍历第五个元素 6，跟第 6、7 的步骤一致，数组先变成 \x3ccode\x3e[0, 1, 2, 5, 3, 9, 4, 6, 7, 8, 10]\x3c\/code\x3e，再变成 \x3ccode\x3e[0, 1, 2, 3, 5, 9, 4, 6, 7, 8, 10]\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e10.遍历第六个元素 9，跟第 6、7 的步骤一致，数组先变成 \x3ccode\x3e[0, 1, 2, 3, 5, 4, 9, 6, 7, 8, 10]\x3c\/code\x3e，再变成 \x3ccode\x3e[0, 1, 2, 3, 4, 5, 9, 6, 7, 8, 10]\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e11.在下一次遍历中，因为 i == high_start，意味着正序和倒序的查找终于找到一起了，后面的元素肯定都是大于基准值的，此时退出循环\x3c\/p\x3e\n\x3cp\x3e12.遍历后的结果为 \x3ccode\x3e[0, 1, 2, 3, 4, 5, 9, 6, 7, 8, 10]\x3c\/code\x3e，在基准值 5 前面的元素都小于 5，后面的元素都大于 5，然后我们分别对两个子集进行 QuickSort\x3c\/p\x3e\n\x3cp\x3e13.此时 low_end 值为 5，high_start 值为 6，to 的值依然是 10，from 的值依然是 0，\x3ccode\x3eto - high_start \x26lt; low_end - from \x3c\/code\x3e 的结果为 \x3ccode\x3etrue\x3c\/code\x3e，我们对 QuickSort(a, 6, 10)，即对后面的元素进行排序，但是注意，在新的 QuickSort 中，因为 from - to 的值小于 10，所以这一次其实是采用了插入排序。所以准确的说，\x3cstrong\x3e当数组长度大于 10 的时候，v8 采用了快速排序和插入排序的混合排序方法。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e14.然后 \x3ccode\x3eto = low_end\x3c\/code\x3e 即设置 to 为 5，因为 while(true) 的原因，会再执行一遍，to - from 的值为 5，执行 InsertionSort(a, 0, 5)，即对基准值前面的元素执行一次插入排序。\x3c\/p\x3e\n\x3cp\x3e15.因为在 to - from \x26lt;= 10 的判断中，有 return 语句，所以 while 循环结束。\x3c\/p\x3e\n\x3cp\x3e16.v8 在对数组进行了一次快速排序后，然后对两个子集分别进行了插入排序，最终修改数组为正确排序后的数组。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader18\x22\x3e比较\x3c\/h2\x3e\n\x3cp\x3e最后来张示意图感受下插入排序和快速排序：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011623646?w=1036\x26amp;h=517\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011623646?w=1036\x26amp;h=517\x22 alt=\x22插入排序和快速排序\x22 title=\x22插入排序和快速排序\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e图片来自于 \x3ca href=\x22https:\/\/www.toptal.com\/developers\/sorting-algorithms\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/www.toptal.com\/developers\/sorting-algorithms\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader19\x22\x3e专题系列\x3c\/h2\x3e\n\x3cp\x3eJavaScript专题系列目录地址：\x3ca href=\x22https:\/\/github.com\/mqyqingfeng\/Blog\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/mqyqingfeng\/Blog\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3eJavaScript专题系列预计写二十篇左右，主要研究日常开发中一些功能点的实现，比如防抖、节流、去重、类型判断、拷贝、最值、扁平、柯里、递归、乱序、排序等，特点是研(chao)究(xi) underscore 和 jQuery 的实现方式。\x3c\/p\x3e\n\x3cp\x3e如果有错误或者不严谨的地方，请务必给予指正，十分感谢。如果喜欢或者有所启发，欢迎 star，对作者也是一种鼓励。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>JavaScript专题之解读 v8 排序源码</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011623637">https://segmentfault.com/a/1190000011623637</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/tarrvk1f7or/" target="_blank">https://alili.tech/archive/tarrvk1f7or/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>