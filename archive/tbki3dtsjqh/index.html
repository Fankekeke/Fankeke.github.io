<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="前端学习笔记之闭包——看了一张图终于明白啥是闭包了"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>前端学习笔记之闭包——看了一张图终于明白啥是闭包了 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/tbki3dtsjqh/",
				"appid": "1613049289050283", 
				"title": "前端学习笔记之闭包——看了一张图终于明白啥是闭包了 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-11-30T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/s64lmhj4bu/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/tf2n0ppkn8/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2ftbki3dtsjqh%2f&text=%e5%89%8d%e7%ab%af%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%e4%b9%8b%e9%97%ad%e5%8c%85%e2%80%94%e2%80%94%e7%9c%8b%e4%ba%86%e4%b8%80%e5%bc%a0%e5%9b%be%e7%bb%88%e4%ba%8e%e6%98%8e%e7%99%bd%e5%95%a5%e6%98%af%e9%97%ad%e5%8c%85%e4%ba%86"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2ftbki3dtsjqh%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2ftbki3dtsjqh%2f&text=%e5%89%8d%e7%ab%af%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%e4%b9%8b%e9%97%ad%e5%8c%85%e2%80%94%e2%80%94%e7%9c%8b%e4%ba%86%e4%b8%80%e5%bc%a0%e5%9b%be%e7%bb%88%e4%ba%8e%e6%98%8e%e7%99%bd%e5%95%a5%e6%98%af%e9%97%ad%e5%8c%85%e4%ba%86"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2ftbki3dtsjqh%2f&title=%e5%89%8d%e7%ab%af%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%e4%b9%8b%e9%97%ad%e5%8c%85%e2%80%94%e2%80%94%e7%9c%8b%e4%ba%86%e4%b8%80%e5%bc%a0%e5%9b%be%e7%bb%88%e4%ba%8e%e6%98%8e%e7%99%bd%e5%95%a5%e6%98%af%e9%97%ad%e5%8c%85%e4%ba%86"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2ftbki3dtsjqh%2f&is_video=false&description=%e5%89%8d%e7%ab%af%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%e4%b9%8b%e9%97%ad%e5%8c%85%e2%80%94%e2%80%94%e7%9c%8b%e4%ba%86%e4%b8%80%e5%bc%a0%e5%9b%be%e7%bb%88%e4%ba%8e%e6%98%8e%e7%99%bd%e5%95%a5%e6%98%af%e9%97%ad%e5%8c%85%e4%ba%86"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%89%8d%e7%ab%af%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%e4%b9%8b%e9%97%ad%e5%8c%85%e2%80%94%e2%80%94%e7%9c%8b%e4%ba%86%e4%b8%80%e5%bc%a0%e5%9b%be%e7%bb%88%e4%ba%8e%e6%98%8e%e7%99%bd%e5%95%a5%e6%98%af%e9%97%ad%e5%8c%85%e4%ba%86&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2ftbki3dtsjqh%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2ftbki3dtsjqh%2f&title=%e5%89%8d%e7%ab%af%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%e4%b9%8b%e9%97%ad%e5%8c%85%e2%80%94%e2%80%94%e7%9c%8b%e4%ba%86%e4%b8%80%e5%bc%a0%e5%9b%be%e7%bb%88%e4%ba%8e%e6%98%8e%e7%99%bd%e5%95%a5%e6%98%af%e9%97%ad%e5%8c%85%e4%ba%86"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftbki3dtsjqh%2f&title=%e5%89%8d%e7%ab%af%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%e4%b9%8b%e9%97%ad%e5%8c%85%e2%80%94%e2%80%94%e7%9c%8b%e4%ba%86%e4%b8%80%e5%bc%a0%e5%9b%be%e7%bb%88%e4%ba%8e%e6%98%8e%e7%99%bd%e5%95%a5%e6%98%af%e9%97%ad%e5%8c%85%e4%ba%86"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftbki3dtsjqh%2f&title=%e5%89%8d%e7%ab%af%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%e4%b9%8b%e9%97%ad%e5%8c%85%e2%80%94%e2%80%94%e7%9c%8b%e4%ba%86%e4%b8%80%e5%bc%a0%e5%9b%be%e7%bb%88%e4%ba%8e%e6%98%8e%e7%99%bd%e5%95%a5%e6%98%af%e9%97%ad%e5%8c%85%e4%ba%86"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftbki3dtsjqh%2f&title=%e5%89%8d%e7%ab%af%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%e4%b9%8b%e9%97%ad%e5%8c%85%e2%80%94%e2%80%94%e7%9c%8b%e4%ba%86%e4%b8%80%e5%bc%a0%e5%9b%be%e7%bb%88%e4%ba%8e%e6%98%8e%e7%99%bd%e5%95%a5%e6%98%af%e9%97%ad%e5%8c%85%e4%ba%86"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">前端学习笔记之闭包——看了一张图终于明白啥是闭包了</h1><div class="meta"><div class="postdate"><time datetime="2018-11-30" itemprop="datePublished">2018-11-30</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch3 id=\x22articleHeader0\x22\x3e闭包\x3c\/h3\x3e\n\x3cp\x3e闭包定义：指拥有多个变量和绑定了这些变量的环境的表达式（通常是一个函数），因而这些变量也是该表达式的一部分。\x3cbr\x3e函数内部可以直接读取全局变量。\x3cbr\x3e函数内部变量无法在函数外部访问。\x3cbr\x3e函数内部声明要用var或者let声明，不然会变成全局变量\x3cbr\x3e链式作用域：子对象会一级级向上寻找父对象的变量，父对象的变量子对象都是可见的，反之则不行。\x3cbr\x3e在一个闭包环境内修改变量值，不会影响另一个闭包中的变量。\x3cbr\x3e普通的函数内嵌，内部函数是先执行；而闭包则是：先把内部函数赋给外部函数，然后在执行。\x3c\/p\x3e\n\x3cp\x3e下面这段代码就是一根典型的闭包\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function f1(){\n    var a = 10;\n    function f2(){\n        alert(a);\n    }\n    f2();    \/\/①\n}\nf1();        \/\/10  ②\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ef1\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e a = \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ef2\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n        alert(a);\n    }\n    f2();    \x3cspan class=\x22hljs-comment\x22\x3e\/\/①\x3c\/span\x3e\n}\nf1();        \x3cspan class=\x22hljs-comment\x22\x3e\/\/10  ②\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3ef1\x3c\/code\x3e和\x3ccode\x3ef1()\x3c\/code\x3e的区别不加括号是代码，加\x3ccode\x3e()\x3c\/code\x3e是执行这段代码，加\x3ccode\x3ereturn\x3c\/code\x3e是返回一个值，可以把返回的值赋值给变量，不加\x3ccode\x3ereturn\x3c\/code\x3e默认返回\x3ccode\x3eundefined\x3c\/code\x3e；\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e所以\x3ccode\x3e①\x3c\/code\x3e处有三种写法：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e第一种：\x3c\/strong\x3e\x3ccode\x3e①\x3c\/code\x3e处写\x3ccode\x3ef2();\x3c\/code\x3e，\x3ccode\x3e②\x3c\/code\x3e处调用需要这样写\x3ccode\x3ef1();\x3c\/code\x3e。具体执行过程：\x3ccode\x3ef1\x3c\/code\x3e体内调用\x3ccode\x3ef2\x3c\/code\x3e函数，并执行。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e第二种：\x3c\/strong\x3e\x3ccode\x3e①\x3c\/code\x3e处写\x3ccode\x3ereturn f2();\x3c\/code\x3e，\x3ccode\x3e②\x3c\/code\x3e处调用需这样写\x3ccode\x3ef1();\x3c\/code\x3e。具体执行过程：同上；区别是多了个\x3ccode\x3ereturn\x3c\/code\x3e，因为现在\x3ccode\x3ef2\x3c\/code\x3e函数中没有返回值，所以\x3ccode\x3ef1\x3c\/code\x3e在调用\x3ccode\x3ef2\x3c\/code\x3e只是执行一下\x3ccode\x3ealert(a)\x3c\/code\x3e，\x3ccode\x3ef1\x3c\/code\x3e的返回值是\x3ccode\x3eundefined\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e第三种：\x3c\/strong\x3e\x3ccode\x3e①\x3c\/code\x3e处写\x3ccode\x3ereturn f2;\x3c\/code\x3e，\x3ccode\x3e②\x3c\/code\x3e处调用需这样写\x3ccode\x3ef1()();\x3c\/code\x3e。这里返回的是\x3ccode\x3ef2\x3c\/code\x3e函数的代码，所以在调用\x3ccode\x3ef1\x3c\/code\x3e时要加上2个括号，第一个括号是执行\x3ccode\x3ef1\x3c\/code\x3e函数，第2个括号是执行\x3ccode\x3ef2\x3c\/code\x3e函数，如果\x3ccode\x3e①\x3c\/code\x3e处省略\x3ccode\x3ereturn\x3c\/code\x3e会报错。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ereturn\x3c\/code\x3e和函数调用时是否加括号的意思都明白，但是把它俩结合起来，就搞不清了。\x3c\/p\x3e\n\x3cp\x3e正好今天学闭包时碰上了，顺便就把它搞清楚了。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e到底什么是闭包\x3c\/h3\x3e\n\x3cp\x3e对于新人（当然了是说我了），看很多闭包的定义，代码，还是不知啥是闭包，云里雾里的，这里感谢方方老师的文章\x3ca href=\x22https:\/\/zhuanlan.zhihu.com\/p\/22486908\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJS 中的闭包是什么？\x3c\/a\x3e，看完后，虽然还是说不出啥是闭包，但现在已经知道啥是闭包了，果然用图说话最牛逼。（图在文章中，我就不放出来了）\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e闭包的应用\x3c\/h3\x3e\n\x3cp\x3eMDN 上这个例子也写的很好\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000014894041?w=703\x26amp;h=877\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000014894041?w=703\x26amp;h=877\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e调用\x3ccode\x3eCounter.value()\x3c\/code\x3e时，返回的是\x3ccode\x3eCounter\x3c\/code\x3e内部的变量\x3ccode\x3eprivateCounter\x3c\/code\x3e；\x3cbr\x3e\x3ccode\x3eincrement\x3c\/code\x3e内部没有返回值，这个方法只是执行了\x3ccode\x3eprivateCounter \x2b 1\x3c\/code\x3e操作，没有返回值；\x3cbr\x3e同理\x3ccode\x3edecrement\x3c\/code\x3e是将\x3ccode\x3eprivateCounter - 1\x3c\/code\x3e，也没有返回值；\x3cbr\x3e所以执行\x3ccode\x3eCounter.increment\x3c\/code\x3e，会返回\x3ccode\x3eundefined\x3c\/code\x3e，但是接着操作\x3ccode\x3eCounter.value()\x3c\/code\x3e时就可以得到\x3ccode\x3e1\x3c\/code\x3e，因为执行上一步\x3ccode\x3eCounter.increment\x3c\/code\x3e时\x3ccode\x3eprivateCounter\x3c\/code\x3e被\x3ccode\x3e\x2b1\x3c\/code\x3e了。\x3c\/p\x3e\n\x3cp\x3e今天在下面三段代码上花费了大量的时间，一直似懂非懂，心里不踏实。\x3c\/p\x3e\n\x3cp\x3e代码一：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var name = \x27window\x27;\nvar obj = {\n    name: \x27object\x27,\n    getName: function() {\n        return this.name;\n    }\n};\nobj.getName(); \/\/object\n(obj.getName = obj.getName)(); \/\/window 非严格模式下\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e name = \x3cspan class=\x22hljs-string\x22\x3e\x27window\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e obj = {\n    name: \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e,\n    getName: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.name;\n    }\n};\nobj.getName(); \x3cspan class=\x22hljs-comment\x22\x3e\/\/object\x3c\/span\x3e\n(obj.getName = obj.getName)(); \x3cspan class=\x22hljs-comment\x22\x3e\/\/window 非严格模式下\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e代码二：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var name = \x27window\x27;\nvar obj = {\n    name: \x27object\x27,\n    getName: function() {\n        return function(){\n            return this.name;    \n        }\n    }\n};\nobj.getName()(); \/\/window\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e name = \x3cspan class=\x22hljs-string\x22\x3e\x27window\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e obj = {\n    name: \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e,\n    getName: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.name;    \n        }\n    }\n};\nobj.getName()(); \x3cspan class=\x22hljs-comment\x22\x3e\/\/window\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e代码三：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var name = \x27window\x27;\n　　var obj = {\n　　　　name : \x27object\x27,\n　　　　getName : function(){\n　　　　　　var that = this;\n　　　　　　return function(){\n　　　　　　　　return that.name;\n　　　　　　};\n　　　　}\n　　};\nobj.getName()();    \/\/object\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e name = \x3cspan class=\x22hljs-string\x22\x3e\x27window\x27\x3c\/span\x3e;\n　　\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e obj = {\n　　　　name : \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e,\n　　　　getName : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n　　　　　　\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e that = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n　　　　　　\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e{\n　　　　　　　　\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e that.name;\n　　　　　　};\n　　　　}\n　　};\nobj.getName()();    \x3cspan class=\x22hljs-comment\x22\x3e\/\/object\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e今天在看阮一峰的博客\x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2009\/08\/learning_javascript_closures.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e学习Javascript闭包（Closure）\x3c\/a\x3e，对代码二、代码三部分很是不解，看到一网友搬出犀牛书（还没看过，我买了红宝石书才看了一点点）里的话，实在不解什么是作为函数调用，什么是作为方法调用；\x3c\/p\x3e\n\x3cblockquote\x3e《Javascript权威指南》上说：如果嵌套函数作为函数调用，其this值不是全局对象（非严格模式下）就是undefined（严格模式下）; 如果嵌套函数作为方法调用，其this值指向调用它的对象。\x3c\/blockquote\x3e\n\x3cp\x3e又有一位网友说\x3c\/p\x3e\n\x3cblockquote\x3e每个函数在被调用时，其活动对象都会自动取得两个特殊变量：this和arguments。内部函数在搜索这个变量时，只会搜索到其活动对象为止，因此永远不可能直接访问外部函数中的这两个变量(这一点通过前面的图可以看得更清楚)。意思就是说找到匿名函数中的this和arguments就不会再往下找了(这里的往下指的是外层的包含函数，和最外层的window全局环境)，而匿名函数的this对象通常指向window，所以输出的是全局的那个字符串。不过，把外部作用域中的this对象保存在一个闭包能够访问到的变量里，就可以让闭包访问该对象了。\x3c\/blockquote\x3e\n\x3cp\x3e看到这里大概明白匿名函数的作用域是全局，继续翻看下面评论，大概意思是说“把\x3ccode\x3ethis\x3c\/code\x3e保存在\x3ccode\x3eobj\x3c\/code\x3e作用域下的一个变量中，\x3ccode\x3ethis\x3c\/code\x3e就在当前函数的作用域下了”。直到看完也是，似懂非懂，反正就是感觉哪里不对劲，但也说不上了。\x3c\/p\x3e\n\x3cp\x3e直到看到\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000004585904\x22\x3e【JavaScript】【函数】闭包闭包！\x3c\/a\x3e这篇文章的代码一部分，终于明白其中的逻辑了。\x3c\/p\x3e\n\x3cp\x3e下面就来分析其中的逻辑，我分析的方法就是把不懂的地方一个个用\x3ccode\x3econsole\x3c\/code\x3e打印出来\x3c\/p\x3e\n\x3cp\x3e代码二和代码一的区别是多了一层嵌套函数，\x3ccode\x3ethis\x3c\/code\x3e值就不一样了。\x3cbr\x3eps：我一开始以为在代码二中再嵌套一层函数，就会打印出\x3ccode\x3eobject\x3c\/code\x3e =_=|||\x3c\/p\x3e\n\x3cp\x3e先来看代码一，明白之后，另外两段代码自然就懂了。\x3c\/p\x3e\n\x3cp\x3e为什么\x3ccode\x3eobj.getName()\x3c\/code\x3e打印出来的是\x3ccode\x3eobject\x3c\/code\x3e，因为这时\x3ccode\x3egetName\x3c\/code\x3e方法是在\x3ccode\x3eobj\x3c\/code\x3e的作用域下，所以\x3ccode\x3ethis\x3c\/code\x3e指向\x3ccode\x3eobj\x3c\/code\x3e，返回值当然就是\x3ccode\x3eobject\x3c\/code\x3e了。\x3c\/p\x3e\n\x3cp\x3e接着看\x3ccode\x3e(obj.getName = obj.getName)()\x3c\/code\x3e删掉右边后，打印出的结果变成了\x3ccode\x3eobject\x3c\/code\x3e，这就纳闷了。\x3cbr\x3eps：第一眼看上去，这啥玩意，把自己赋值给自己？这不是多此一举，直接用不就行了！\x3c\/p\x3e\n\x3cp\x3e用\x3ccode\x3econsole.log\x3c\/code\x3e打印出\x3ccode\x3eobj.getName\x3c\/code\x3e后，终于拨云见天，\x3ccode\x3eobj.getName = obj.getName\x3c\/code\x3e这句话的意思就是把\x3ccode\x3egetName\x3c\/code\x3e函数赋值给自己，这个时候就不是\x3ccode\x3eobj.getName\x3c\/code\x3e，而是\x3ccode\x3egetName\x3c\/code\x3e匿名函数了，匿名函数通常用的方法是\x3ccode\x3e()()\x3c\/code\x3e立即执行，此时再看匿名函数已经脱离\x3ccode\x3eobj\x3c\/code\x3e了，当然\x3ccode\x3ethis\x3c\/code\x3e也就指向了全局，打印出\x3ccode\x3ewindow\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e再来看代码二，用\x3ccode\x3econsole\x3c\/code\x3e打印出\x3ccode\x3eobj.getName()\x3c\/code\x3e会发现是一个匿名函数，而匿名函数的this通常会指向全局，所以也就不难理解了\x3c\/p\x3e\n\x3cp\x3e理解上面两段代码，代码三也就很好理解了。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e闭包中引用循环变量\x3c\/h3\x3e\n\x3cp\x3e廖雪峰的\x3ca href=\x22https:\/\/www.liaoxuefeng.com\/wiki\/001434446689867b27157e896e74d51a89c25cc8b43bdb3000\/00143449934543461c9d5dfeeb848f5b72bd012e1113d15000\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e闭包\x3c\/a\x3e在文中就很形象的讲解了函数中的引用会变化的变量会有什么后果，我节选了他的结论和代码。\x3c\/p\x3e\n\x3cblockquote\x3e返回闭包时牢记的一点就是：\x3cstrong\x3e返回函数不要引用任何循环变量，或者后续会发生变化的变量。\x3c\/strong\x3e\x3cbr\x3e 如果一定要引用循环变量怎么办？方法是\x3cstrong\x3e再创建一个函数，用该函数的参数绑定循环变量当前的值\x3c\/strong\x3e，无论该循环变量后续如何更改，已绑定到函数参数的值不变：\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function count() {\n    var arr = [];\n    for (var i=1; i\x3c=3; i\x2b\x2b) {\n        arr.push((function (n) {\n            return function () {\n                return n * n;\n            }\n        })(i));\n    }\n    return arr;\n}\n\nvar results = count();\nvar f1 = results[0];\nvar f2 = results[1];\nvar f3 = results[2];\n\nf1(); \/\/ 1\nf2(); \/\/ 4\nf3(); \/\/ 9\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecount\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e arr = [];\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i=\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e; i\x26lt;=\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e; i\x2b\x2b) {\n        arr.push((\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(n)\x3c\/span\x3e \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e n * n;\n            }\n        })(i));\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e arr;\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e results = count();\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e f1 = results[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e f2 = results[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e];\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e f3 = results[\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e];\n\nf1(); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1\x3c\/span\x3e\nf2(); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 4\x3c\/span\x3e\nf3(); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 9\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里的核心就是立即执行，如果不是立即执行的话，变量\x3ccode\x3ei\x3c\/code\x3e就是\x3ccode\x3efor\x3c\/code\x3e循环结束后的值了。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>前端学习笔记之闭包——看了一张图终于明白啥是闭包了</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000014894036">https://segmentfault.com/a/1190000014894036</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/tbki3dtsjqh/" target="_blank">https://alili.tech/archive/tbki3dtsjqh/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>