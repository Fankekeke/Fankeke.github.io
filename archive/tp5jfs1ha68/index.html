<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="【30分钟学完】canvas动画|游戏基础(1)：理论先行"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>【30分钟学完】canvas动画|游戏基础(1)：理论先行 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/tp5jfs1ha68/",
				"appid": "1613049289050283", 
				"title": "【30分钟学完】canvas动画|游戏基础(1)：理论先行 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-09T02:30:08"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/3nabqcdtt2n/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/y6pkk9sgqcm/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2ftp5jfs1ha68%2f&text=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%281%29%ef%bc%9a%e7%90%86%e8%ae%ba%e5%85%88%e8%a1%8c"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2ftp5jfs1ha68%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2ftp5jfs1ha68%2f&text=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%281%29%ef%bc%9a%e7%90%86%e8%ae%ba%e5%85%88%e8%a1%8c"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2ftp5jfs1ha68%2f&title=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%281%29%ef%bc%9a%e7%90%86%e8%ae%ba%e5%85%88%e8%a1%8c"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2ftp5jfs1ha68%2f&is_video=false&description=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%281%29%ef%bc%9a%e7%90%86%e8%ae%ba%e5%85%88%e8%a1%8c"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%281%29%ef%bc%9a%e7%90%86%e8%ae%ba%e5%85%88%e8%a1%8c&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2ftp5jfs1ha68%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2ftp5jfs1ha68%2f&title=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%281%29%ef%bc%9a%e7%90%86%e8%ae%ba%e5%85%88%e8%a1%8c"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftp5jfs1ha68%2f&title=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%281%29%ef%bc%9a%e7%90%86%e8%ae%ba%e5%85%88%e8%a1%8c"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftp5jfs1ha68%2f&title=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%281%29%ef%bc%9a%e7%90%86%e8%ae%ba%e5%85%88%e8%a1%8c"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftp5jfs1ha68%2f&title=%e3%80%9030%e5%88%86%e9%92%9f%e5%ad%a6%e5%ae%8c%e3%80%91canvas%e5%8a%a8%e7%94%bb%7c%e6%b8%b8%e6%88%8f%e5%9f%ba%e7%a1%80%281%29%ef%bc%9a%e7%90%86%e8%ae%ba%e5%85%88%e8%a1%8c"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">【30分钟学完】canvas动画|游戏基础(1)：理论先行</h1><div class="meta"><div class="postdate"><time datetime="2018-12-09" itemprop="datePublished">2018-12-09</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e前言\x3c\/h2\x3e\n\x3cp\x3e本文虽说是基础教程，但这是相对动画\/游戏领域来说，在前端领域算是中级教程了，不适合前端小白或萌新。阅读前请确保自己对前端三大件（JavaScript\x2bCSS\x2bHTML）的基础已经十分熟悉，而且有高中水平的数学和物理知识。demo采用ES6编写，遵循Airbnb规范，不依赖第三方框架或库，请在现代浏览器里运行。  \x3cbr\x3e大部分例子来自《Foundation HTML5 Animation with JavaScript》，感谢这本书作者的辛劳和启发。本教程也可以算是该书的精(tian)简(you)优(jia)化(cu)版，既是我的个人读书笔记，也是经验总结，方便没空看书的忙人阅读。  \x3cbr\x3e本人能力有限，欢迎牛人共同讨论，批评指正。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e何为动画\/游戏\x3c\/h2\x3e\n\x3cblockquote\x3e【科普】动画是指由许多帧静止的画面，以一定的速度（如每秒16张）连续播放时，肉眼因视觉残象产生错觉，而误以为画面活动的作品。为了得到活动的画面，每个画面之间都会有细微的改变。而画面的制作方式，最常见的是手绘在纸张或赛璐珞片上，其它的方式还包含了运用黏土、模型、纸偶、沙画等。\x3c\/blockquote\x3e\n\x3cp\x3e使用H5技术实现动画原理跟传统动画是一样的，都是利用“视觉暂留”现象，计算机通过一定的规则运算得到一个画面（像素数据），然后以一定速度连续播放就形成动画。但也有些许不同，传统动画的重点是绘画技法的表现，也就是每张图画得漂亮，而计算机动画更关心的是如何确立运算规则，这也是数学和物理知识的运用。  \x3cbr\x3e在计算机领域，动画和游戏界限并不明显，他们的差别就是是否有交互性，如果玩家有一定的改变动画的操作，再加上一些游戏规则，那就可以称得上是游戏了。\x3c\/p\x3e\n\x3cblockquote\x3e【PS】顺便一提，常有疑问为什么电脑玩游戏卡，看电影不卡呢？  \x3cbr\x3e因为所谓的数字版电影，不论是三维动画还是二维动画，都是已渲染好的画面，也就是数据是一帧帧的图片，而计算机只需要按顺序换图片就能播放。但游戏的画面是实时计算出来的，如果计算机性能不行，也就是无法在下一帧完成渲染，画面自然就会卡顿。在PC和主机性能低下的年代，将部分游戏画面预渲染后放入游戏也是常见的提高性能的做法。\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3eH5相关技术概述\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3ecanvas\x3c\/h3\x3e\n\x3cblockquote\x3e【科普】\x3ccode\x3e\x26lt;canvas\x26gt;\x3c\/code\x3e 是 HTML5 新增的元素，可用于通过使用JavaScript中的脚本来绘制图形。例如，它可以用于绘制图形，制作照片，创建动画，甚至可以进行实时视频处理或渲染。\x3c\/blockquote\x3e\n\x3cp\x3e作为上世代flash的升级替代品，简单来说就是浏览器提供一个画布，你的工作就是用js操作画笔在上面画画，不断重复画画和擦除的工作，就可以实现动画。  \x3cbr\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/Canvas_API\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ecanvas相关文档\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e用户交互\x3c\/h3\x3e\n\x3cp\x3e交互是游戏的根本，H5上的交互不外乎鼠标、触摸和键盘这几种，其实就是DOM标准的事件流。我们在事件中拿到屏幕上的坐标或键盘的键位代号，执行相应的操作。这不是本教程重点，不懂的右转HTML相关基础，这里就不细说了。  \x3cbr\x3e这里有些简单例子，可以在控制台看到效果：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part1\/03-mouse-events.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e演示所有鼠标事件\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part1\/04-mouse-position.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e演示鼠标按下坐标获取\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part1\/05-touch-events.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e演示触摸事件\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part1\/06-keyboard-events.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e演示键盘事件\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/nimokuri.github.io\/H5Learning-animationDemo\/part1\/07-key-codes.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e演示键盘上、下、左、右\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3edemo中为了方便使用封装了这些交互方法，放在工具库\x3ca href=\x22https:\/\/github.com\/nimokuri\/H5Learning-animationDemo\/blob\/master\/common\/utils.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eutils.js\x3c\/a\x3e里，这里以获取鼠标事件，触摸事件同理为例。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22utils.captureMouse = function captureMouse(element) {\n  const mouse = {\n    x: 0,\n    y: 0,\n  };\n  element.addEventListener(\x27mousemove\x27, (event) =\x3e {\n    let x;\n    let y;\n    if (event.pageX || event.pageY) {\n      x = event.pageX;\n      y = event.pageY;\n    } else {\n      x = event.clientX \x2b document.body.scrollLeft \x2b document.documentElement.scrollLeft;\n      y = event.clientY \x2b document.body.scrollTop \x2b document.documentElement.scrollTop;\n    }\n    x -= element.offsetLeft;\n    y -= element.offsetTop;\n\n    mouse.x = x;\n    mouse.y = y;\n  }, false);\n\n  return mouse;\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eutils.captureMouse = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecaptureMouse\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eelement\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e mouse = {\n    \x3cspan class=\x22hljs-attr\x22\x3ex\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ey\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n  };\n  element.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mousemove\x27\x3c\/span\x3e, (event) =\x26gt; {\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e x;\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e y;\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (event.pageX || event.pageY) {\n      x = event.pageX;\n      y = event.pageY;\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      x = event.clientX \x2b \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.scrollLeft \x2b \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.documentElement.scrollLeft;\n      y = event.clientY \x2b \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.scrollTop \x2b \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.documentElement.scrollTop;\n    }\n    x -= element.offsetLeft;\n    y -= element.offsetTop;\n\n    mouse.x = x;\n    mouse.y = y;\n  }, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e mouse;\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e动画循环\x3c\/h2\x3e\n\x3cp\x3e这是计算机动画在代码层面的核心，简单来说就是一个循环调用（不断递归）的过程，每次循环都是一帧画面的产生，实现方式大体可以归纳为三类。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e基于帧的动画（requestAnimationFrame）\x3c\/h3\x3e\n\x3cblockquote\x3e【科普】在视频领域，电影、电视、数字视频等可视为随时间连续变换的许多张画面，而帧是指每一张画面。\x3c\/blockquote\x3e\n\x3cp\x3e一般来说1秒15帧就可让人眼不发觉黑暗的间隔，25帧就可感觉流畅，每秒钟帧数 (fps) 愈多，所显示的动作就会愈流畅。W3C所建议的刷新率是1秒60帧，大部分浏览器是遵循这一标准的。  \x3cbr\x3erequestAnimationFrame是H5加入的函数，用法类似于setTimeout，用于告诉浏览器下一帧的时候该干什么，比如一个物体每1帧要移动多少距离。它提供\x3cstrong\x3e基于浏览器的优化实现\x3c\/strong\x3e，是实现H5动画的首选，所有demo都有使用。至于它优化了什么，下面会提到。  \x3cbr\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/Window\/requestAnimationFrame\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3erequestAnimationFrame文档链接\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e基于定时器的动画\x3c\/h3\x3e\n\x3cp\x3e在requestAnimationFrame还未出现的时代，一般是用setTimeout和setInterval实现动画，也可以使用他们模拟requestAnimationFrame，只需把时间间隔设为1000\/60毫秒，也就是大约16.7毫秒执行下一个循环，当然你也可以定义自己需要的帧率，达到游戏中常见的\x3cstrong\x3e锁帧\x3c\/strong\x3e效果。  \x3cbr\x3e所谓模拟，另一层意思就是不可能相同，我们的程序在浏览器沙盒中运行是不知道显卡和显示器硬件实际是否在刷新的，但浏览器是可以知道的，所以浏览器才可以真正的知道什么时候屏幕会刷新，更好的配合硬件工作，这也是requestAnimationFrame优于定时器的原因。  \x3cbr\x3e基于此我们可以创造一个polyfill放到工具库\x3ca href=\x22https:\/\/github.com\/nimokuri\/H5Learning-animationDemo\/blob\/master\/common\/utils.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eutils.js\x3c\/a\x3e里。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (!window.requestAnimationFrame) {\n  window.requestAnimationFrame = (window.webkitRequestAnimationFrame ||\n    window.mozRequestAnimationFrame ||\n    window.oRequestAnimationFrame ||\n    window.msRequestAnimationFrame ||\n    function timeout(callback) {\n      return window.setTimeout(callback, 1000 \/ 60);\n    });\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.requestAnimationFrame) {\n  \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.requestAnimationFrame = (\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.webkitRequestAnimationFrame ||\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.mozRequestAnimationFrame ||\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.oRequestAnimationFrame ||\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.msRequestAnimationFrame ||\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etimeout\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ecallback\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.setTimeout(callback, \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e \/ \x3cspan class=\x22hljs-number\x22\x3e60\x3c\/span\x3e);\n    });\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e特别注意：\x3cstrong\x3ejs中给定时器规定的时间间隔仅仅表示最少的时间，而非确切的时间\x3c\/strong\x3e，对于过复杂需要超过时间间隔才执行完的程序，执行时间就会被延后。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e基于时间的动画\x3c\/h3\x3e\n\x3cp\x3e其实无论是requestAnimationFrame还是定时器，都不能保证以特定速率播放。也就是说复杂的动画在性能较差的计算机上播放，会比它设计速度慢。这个在游戏的体验上是十分不友好的，所以就有了游戏里常见的\x3cstrong\x3e跳帧\x3c\/strong\x3e做法。  \x3cbr\x3e其实就是使用真实的时间来度量每个物体的运动变化，而不是依靠每帧的变化。将物体每帧移动距离，转变为物体每秒移动距离。  \x3cbr\x3e由于demo都是简单动画，所以暂时不会使用这个操作。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e计算机中一些数学概念与标准的差异\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e弧度(radian)与角度(degree)\x3c\/h3\x3e\n\x3cp\x3e日常我们使用角度会比较多，应该没有人不知道一个圆是360度吧（笑）。但计算机中不使用角度概念而是使用弧度。学校也有说过，这里就不讲解他们的关系了，只要明确一圆周是2π弧度，两者的转换用代码表示就是：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let radians = degrees * Math.PI \/ 180;\nlet degrees = radians * 180 \/ Math.PI;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e radians = degrees * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.PI \/ \x3cspan class=\x22hljs-number\x22\x3e180\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e degrees = radians * \x3cspan class=\x22hljs-number\x22\x3e180\x3c\/span\x3e \/ \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.PI;\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e坐标系\x3c\/h3\x3e\n\x3cp\x3e计算机里的坐标系也不是日常使用的标准坐标系，可以说是标准坐标系的颠倒版本，如下图，越往右x轴值越大，越往下y轴值越大，反之亦然。\x3c\/p\x3e\n\x3cblockquote\x3e【科普】这个坐标系有一定的历史背景，因为“大屁股”显示器里的电子枪是从左往右，从上往下扫描屏幕的。\x3c\/blockquote\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV6Jz5?w=680\x26amp;h=554\x22 src=\x22https:\/\/static.alili.tech\/img\/bV6Jz5?w=680\x26amp;h=554\x22 alt=\x22坐标系\x22 title=\x22坐标系\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e这个坐标系还导致了另一个问题，就是\x3cstrong\x3e角度的正负值是与标准坐标系相反的\x3c\/strong\x3e，如下图，顺时针角度才是正值，逆时针为负值。  \x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV6JDn?w=714\x26amp;h=640\x22 src=\x22https:\/\/static.alili.tech\/img\/bV6JDn?w=714\x26amp;h=640\x22 alt=\x22角度\x22 title=\x22角度\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>【30分钟学完】canvas动画|游戏基础(1)：理论先行</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000013957160">https://segmentfault.com/a/1190000013957160</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/tp5jfs1ha68/" target="_blank">https://alili.tech/archive/tp5jfs1ha68/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>