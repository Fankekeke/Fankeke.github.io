<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="读Zepto源码之Touch模块"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>读Zepto源码之Touch模块 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/uxg2f7jwqjs/",
				"appid": "1613049289050283", 
				"title": "读Zepto源码之Touch模块 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-31T02:30:29"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/b7he5kpyeq/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/yedv97n5xzd/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fuxg2f7jwqjs%2f&text=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bTouch%e6%a8%a1%e5%9d%97"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fuxg2f7jwqjs%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fuxg2f7jwqjs%2f&text=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bTouch%e6%a8%a1%e5%9d%97"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fuxg2f7jwqjs%2f&title=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bTouch%e6%a8%a1%e5%9d%97"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fuxg2f7jwqjs%2f&is_video=false&description=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bTouch%e6%a8%a1%e5%9d%97"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bTouch%e6%a8%a1%e5%9d%97&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fuxg2f7jwqjs%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fuxg2f7jwqjs%2f&title=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bTouch%e6%a8%a1%e5%9d%97"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fuxg2f7jwqjs%2f&title=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bTouch%e6%a8%a1%e5%9d%97"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fuxg2f7jwqjs%2f&title=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bTouch%e6%a8%a1%e5%9d%97"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fuxg2f7jwqjs%2f&title=%e8%af%bbZepto%e6%ba%90%e7%a0%81%e4%b9%8bTouch%e6%a8%a1%e5%9d%97"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">读Zepto源码之Touch模块</h1><div class="meta"><div class="postdate"><time datetime="2018-12-31" itemprop="datePublished">2018-12-31</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e大家都知道，因为历史原因，移动端上的点击事件会有 \x3ccode\x3e300ms\x3c\/code\x3e 左右的延迟，\x3ccode\x3eZepto\x3c\/code\x3e 的 \x3ccode\x3etouch\x3c\/code\x3e 模块解决的就是移动端点击延迟的问题，同时也提供了滑动的 \x3ccode\x3eswipe\x3c\/code\x3e 事件。\x3c\/p\x3e\n\x3cp\x3e读 Zepto 源码系列文章已经放到了github上，欢迎star: \x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereading-zepto\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e源码版本\x3c\/h2\x3e\n\x3cp\x3e本文阅读的源码为 \x3ca href=\x22https:\/\/github.com\/madrobby\/zepto\/tree\/v1.2.0\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ezepto1.2.0\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3eGitBook\x3c\/h2\x3e\n\x3cp\x3e《\x3ca href=\x22https:\/\/yeyuqiudeng.gitbooks.io\/reading-zepto\/content\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereading-zepto\x3c\/a\x3e》\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e实现的事件\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22;[\x27swipe\x27, \x27swipeLeft\x27, \x27swipeRight\x27, \x27swipeUp\x27, \x27swipeDown\x27,\n  \x27doubleTap\x27, \x27tap\x27, \x27singleTap\x27, \x27longTap\x27].forEach(function(eventName){\n  $.fn[eventName] = function(callback){ return this.on(eventName, callback) }\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e;[\x3cspan class=\x22hljs-string\x22\x3e\x27swipe\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27swipeLeft\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27swipeRight\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27swipeUp\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27swipeDown\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27doubleTap\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27tap\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27singleTap\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27longTap\x27\x3c\/span\x3e].forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eeventName\x3c\/span\x3e)\x3c\/span\x3e{\n  $.fn[eventName] = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ecallback\x3c\/span\x3e)\x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.on(eventName, callback) }\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e从上面的代码中可以看到，\x3ccode\x3eZepto\x3c\/code\x3e 实现了以下的事件：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eswipe: 滑动事件\x3c\/li\x3e\n\x3cli\x3eswipeLeft: 向左滑动事件\x3c\/li\x3e\n\x3cli\x3eswipeRight: 向右滑动事件\x3c\/li\x3e\n\x3cli\x3eswipeUp: 向上滑动事件\x3c\/li\x3e\n\x3cli\x3eswipeDown: 向下滑动事件\x3c\/li\x3e\n\x3cli\x3edoubleTap: 屏幕双击事件\x3c\/li\x3e\n\x3cli\x3etap: 屏幕点击事件，比 \x3ccode\x3eclick\x3c\/code\x3e 事件响应更快\x3c\/li\x3e\n\x3cli\x3esingleTap: 屏幕单击事件\x3c\/li\x3e\n\x3cli\x3elongTap: 长按事件\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e并且为每个事件都注册了快捷方法。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e内部方法\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3eswipeDirection\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function swipeDirection(x1, x2, y1, y2) {\n  return Math.abs(x1 - x2) \x3e=\n    Math.abs(y1 - y2) ? (x1 - x2 \x3e 0 ? \x27Left\x27 : \x27Right\x27) : (y1 - y2 \x3e 0 ? \x27Up\x27 : \x27Down\x27)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eswipeDirection\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ex1, x2, y1, y2\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(x1 - x2) \x26gt;=\n    \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(y1 - y2) ? (x1 - x2 \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e ? \x3cspan class=\x22hljs-string\x22\x3e\x27Left\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27Right\x27\x3c\/span\x3e) : (y1 - y2 \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e ? \x3cspan class=\x22hljs-string\x22\x3e\x27Up\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27Down\x27\x3c\/span\x3e)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e返回的是滑动的方法。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ex1\x3c\/code\x3e 为 \x3ccode\x3ex轴\x3c\/code\x3e 起点坐标， \x3ccode\x3ex2\x3c\/code\x3e 为 \x3ccode\x3ex轴\x3c\/code\x3e 终点坐标， \x3ccode\x3ey1\x3c\/code\x3e 为 \x3ccode\x3ey轴\x3c\/code\x3e 起点坐标， \x3ccode\x3ey2\x3c\/code\x3e 为 \x3ccode\x3ey轴\x3c\/code\x3e 终点坐标。\x3c\/p\x3e\n\x3cp\x3e这里有多组三元表达式，首先对比的是 \x3ccode\x3ex轴\x3c\/code\x3e 和 \x3ccode\x3ey轴\x3c\/code\x3e 上的滑动距离，如果 \x3ccode\x3ex轴\x3c\/code\x3e 的滑动距离比 \x3ccode\x3ey轴\x3c\/code\x3e 大，则为左右滑动，否则为上下滑动。\x3c\/p\x3e\n\x3cp\x3e在 \x3ccode\x3ex轴\x3c\/code\x3e 上，如果起点位置比终点位置大，则为向左滑动，返回 \x3ccode\x3eLeft\x3c\/code\x3e ，否则为向右滑动，返回 \x3ccode\x3eRight\x3c\/code\x3e 。\x3c\/p\x3e\n\x3cp\x3e在 \x3ccode\x3ey轴\x3c\/code\x3e 上，如果起点位置比终点位置大，则为向上滑动，返回 \x3ccode\x3eUp\x3c\/code\x3e ，否则为向下滑动，返回 \x3ccode\x3eDown\x3c\/code\x3e 。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3elongTap\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var touch = {},\n    touchTimeout, tapTimeout, swipeTimeout, longTapTimeout,\n    longTapDelay = 750,\n    gesture\nfunction longTap() {\n  longTapTimeout = null\n  if (touch.last) {\n    touch.el.trigger(\x27longTap\x27)\n    touch = {}\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e touch = {},\n    touchTimeout, tapTimeout, swipeTimeout, longTapTimeout,\n    longTapDelay = \x3cspan class=\x22hljs-number\x22\x3e750\x3c\/span\x3e,\n    gesture\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3elongTap\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  longTapTimeout = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touch.last) {\n    touch.el.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27longTap\x27\x3c\/span\x3e)\n    touch = {}\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e触发长按事件。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3etouch\x3c\/code\x3e 对象保存的是触摸过程中的信息。\x3c\/p\x3e\n\x3cp\x3e在触发 \x3ccode\x3elongTap\x3c\/code\x3e 事件前，先将保存定时器的变量 \x3ccode\x3elongTapTimeout\x3c\/code\x3e 释放，如果 \x3ccode\x3etouch\x3c\/code\x3e 对象中存在 \x3ccode\x3elast\x3c\/code\x3e ，则触发 \x3ccode\x3elongTap\x3c\/code\x3e 事件， \x3ccode\x3elast\x3c\/code\x3e 保存的是最后触摸的时间。最后将 \x3ccode\x3etouch\x3c\/code\x3e 重置为空对象，以便下一次使用。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3ecancelLongTap\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function cancelLongTap() {\n  if (longTapTimeout) clearTimeout(longTapTimeout)\n  longTapTimeout = null\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecancelLongTap\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (longTapTimeout) clearTimeout(longTapTimeout)\n  longTapTimeout = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e撤销 \x3ccode\x3elongTap\x3c\/code\x3e 事件的触发。\x3c\/p\x3e\n\x3cp\x3e如果有触发 \x3ccode\x3elongTap\x3c\/code\x3e 的定时器，清除定时器即可阻止 \x3ccode\x3elongTap\x3c\/code\x3e 事件的触发。\x3c\/p\x3e\n\x3cp\x3e最后同样需要将 \x3ccode\x3elongTapTimeout\x3c\/code\x3e 变量置为 \x3ccode\x3enull\x3c\/code\x3e ，等待垃圾回收。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3ecancelAll\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function cancelAll() {\n  if (touchTimeout) clearTimeout(touchTimeout)\n  if (tapTimeout) clearTimeout(tapTimeout)\n  if (swipeTimeout) clearTimeout(swipeTimeout)\n  if (longTapTimeout) clearTimeout(longTapTimeout)\n  touchTimeout = tapTimeout = swipeTimeout = longTapTimeout = null\n  touch = {}\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecancelAll\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touchTimeout) clearTimeout(touchTimeout)\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (tapTimeout) clearTimeout(tapTimeout)\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (swipeTimeout) clearTimeout(swipeTimeout)\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (longTapTimeout) clearTimeout(longTapTimeout)\n  touchTimeout = tapTimeout = swipeTimeout = longTapTimeout = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n  touch = {}\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e清除所有事件的执行。\x3c\/p\x3e\n\x3cp\x3e其实就是清除所有相关的定时器，最后将 \x3ccode\x3etouch\x3c\/code\x3e 对象设置为 \x3ccode\x3enull\x3c\/code\x3e 。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3eisPrimaryTouch\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function isPrimaryTouch(event){\n  return (event.pointerType == \x27touch\x27 ||\n          event.pointerType == event.MSPOINTER_TYPE_TOUCH)\n  \x26amp;\x26amp; event.isPrimary\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eisPrimaryTouch\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (event.pointerType == \x3cspan class=\x22hljs-string\x22\x3e\x27touch\x27\x3c\/span\x3e ||\n          event.pointerType == event.MSPOINTER_TYPE_TOUCH)\n  \x26amp;\x26amp; event.isPrimary\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e是否为主触点。\x3c\/p\x3e\n\x3cp\x3e当 \x3ccode\x3epointerType\x3c\/code\x3e 为 \x3ccode\x3etouch\x3c\/code\x3e 并且 \x3ccode\x3eisPrimary\x3c\/code\x3e 为 \x3ccode\x3etrue\x3c\/code\x3e 时，才为主触点。 \x3ccode\x3epointerType\x3c\/code\x3e 可为 \x3ccode\x3etouch\x3c\/code\x3e 、 \x3ccode\x3epen\x3c\/code\x3e 和 \x3ccode\x3emouse\x3c\/code\x3e ，这里只处理手指触摸的情况。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3eisPointerEventType\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function isPointerEventType(e, type){\n  return (e.type == \x27pointer\x27\x2btype ||\n          e.type.toLowerCase() == \x27mspointer\x27\x2btype)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eisPointerEventType\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee, type\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (e.type == \x3cspan class=\x22hljs-string\x22\x3e\x27pointer\x27\x3c\/span\x3e\x2btype ||\n          e.type.toLowerCase() == \x3cspan class=\x22hljs-string\x22\x3e\x27mspointer\x27\x3c\/span\x3e\x2btype)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e触发的是否为 \x3ccode\x3epointerEvent\x3c\/code\x3e 。\x3c\/p\x3e\n\x3cp\x3e在低版本的移动端 IE 浏览器中，只实现了 \x3ccode\x3ePointerEvent\x3c\/code\x3e ，并没有实现 \x3ccode\x3eTouchEvent\x3c\/code\x3e ，所以需要这个来判断。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e事件触发\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e整体分析\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$(document).ready(function(){\n    var now, delta, deltaX = 0, deltaY = 0, firstTouch, _isPointerType\n\n    $(document)\n      .bind(\x27MSGestureEnd\x27, function(e){\n        ...\n      })\n      .on(\x27touchstart MSPointerDown pointerdown\x27, function(e){\n        ...\n      })\n      .on(\x27touchmove MSPointerMove pointermove\x27, function(e){\n        ...\n      })\n      .on(\x27touchend MSPointerUp pointerup\x27, function(e){\n        ...\n      })\n      \n      .on(\x27touchcancel MSPointerCancel pointercancel\x27, cancelAll)\n\n    $(window).on(\x27scroll\x27, cancelAll)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e$(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e).ready(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e now, delta, deltaX = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, deltaY = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, firstTouch, _isPointerType\n\n    $(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e)\n      .bind(\x3cspan class=\x22hljs-string\x22\x3e\x27MSGestureEnd\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n        ...\n      })\n      .on(\x3cspan class=\x22hljs-string\x22\x3e\x27touchstart MSPointerDown pointerdown\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n        ...\n      })\n      .on(\x3cspan class=\x22hljs-string\x22\x3e\x27touchmove MSPointerMove pointermove\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n        ...\n      })\n      .on(\x3cspan class=\x22hljs-string\x22\x3e\x27touchend MSPointerUp pointerup\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n        ...\n      })\n      \n      .on(\x3cspan class=\x22hljs-string\x22\x3e\x27touchcancel MSPointerCancel pointercancel\x27\x3c\/span\x3e, cancelAll)\n\n    $(\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e).on(\x3cspan class=\x22hljs-string\x22\x3e\x27scroll\x27\x3c\/span\x3e, cancelAll)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e先来说明几个变量，\x3ccode\x3enow\x3c\/code\x3e 用来保存当前时间， \x3ccode\x3edelta\x3c\/code\x3e 用来保存两次触摸之间的时间差， \x3ccode\x3edeltaX\x3c\/code\x3e 用来保存 \x3ccode\x3ex轴\x3c\/code\x3e 上的位移， \x3ccode\x3edeltaY\x3c\/code\x3e 来用保存 \x3ccode\x3ey轴\x3c\/code\x3e 上的位移， \x3ccode\x3efirstTouch\x3c\/code\x3e 保存初始触摸点的信息， \x3ccode\x3e_isPointerType\x3c\/code\x3e 保存是否为 \x3ccode\x3epointerEvent\x3c\/code\x3e 的判断结果。\x3c\/p\x3e\n\x3cp\x3e从上面可以看到， \x3ccode\x3eZepto\x3c\/code\x3e 所触发的事件，是从 \x3ccode\x3etouch\x3c\/code\x3e 、 \x3ccode\x3epointer\x3c\/code\x3e 或者 IE 的 \x3ccode\x3eguesture\x3c\/code\x3e 事件中，根据不同情况计算出来的。这些事件都绑定在 \x3ccode\x3edocument\x3c\/code\x3e 上。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3eIE Gesture 事件的处理\x3c\/h3\x3e\n\x3cp\x3e\x3ccode\x3eIE\x3c\/code\x3e 的手势使用，需要经历三步：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e创建手势对象\x3c\/li\x3e\n\x3cli\x3e指定目标元素\x3c\/li\x3e\n\x3cli\x3e指定手势识别时需要处理的指针\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (\x27MSGesture\x27 in window) {\n  gesture = new MSGesture()\n  gesture.target = document.body\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x27MSGesture\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e) {\n  gesture = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e MSGesture()\n  gesture.target = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这段代码包含了前两步。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22on(\x27touchstart MSPointerDown pointerdown\x27, function(e){\n  ...\n  if (gesture \x26amp;\x26amp; _isPointerType) gesture.addPointer(e.pointerId)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eon(\x3cspan class=\x22hljs-string\x22\x3e\x27touchstart MSPointerDown pointerdown\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n  ...\n  if (gesture \x26amp;\x26amp; _isPointerType) gesture.addPointer(e.pointerId)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这段是第三步，用 \x3ccode\x3eaddPointer\x3c\/code\x3e 的方法，指定需要处理的指针。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22bind(\x27MSGestureEnd\x27, function(e){\n  var swipeDirectionFromVelocity =\n      e.velocityX \x3e 1 ? \x27Right\x27 : e.velocityX \x3c -1 ? \x27Left\x27 : e.velocityY \x3e 1 ? \x27Down\x27 : e.velocityY \x3c -1 ? \x27Up\x27 : null\n  if (swipeDirectionFromVelocity) {\n    touch.el.trigger(\x27swipe\x27)\n    touch.el.trigger(\x27swipe\x27\x2b swipeDirectionFromVelocity)\n  }\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3ebind(\x3cspan class=\x22hljs-string\x22\x3e\x27MSGestureEnd\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e swipeDirectionFromVelocity =\n      e.velocityX \x26gt; \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e ? \x3cspan class=\x22hljs-string\x22\x3e\x27Right\x27\x3c\/span\x3e : e.velocityX \x26lt; \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e ? \x3cspan class=\x22hljs-string\x22\x3e\x27Left\x27\x3c\/span\x3e : e.velocityY \x26gt; \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e ? \x3cspan class=\x22hljs-string\x22\x3e\x27Down\x27\x3c\/span\x3e : e.velocityY \x26lt; \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e ? \x3cspan class=\x22hljs-string\x22\x3e\x27Up\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (swipeDirectionFromVelocity) {\n    touch.el.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27swipe\x27\x3c\/span\x3e)\n    touch.el.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27swipe\x27\x3c\/span\x3e\x2b swipeDirectionFromVelocity)\n  }\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e接下来就是分析手势了，\x3ccode\x3eGesture\x3c\/code\x3e 里只处理 \x3ccode\x3eswipe\x3c\/code\x3e 事件。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3evelocityX\x3c\/code\x3e 和 \x3ccode\x3evelocityY\x3c\/code\x3e 分别为 \x3ccode\x3ex轴\x3c\/code\x3e 和 \x3ccode\x3ey轴\x3c\/code\x3e 上的速率。这里以 \x3ccode\x3e1\x3c\/code\x3e  或 \x3ccode\x3e-1\x3c\/code\x3e 为临界点，判断 \x3ccode\x3eswipe\x3c\/code\x3e 的方向。\x3c\/p\x3e\n\x3cp\x3e如果 \x3ccode\x3eswipe\x3c\/code\x3e 的方向存在，则触发 \x3ccode\x3eswipe\x3c\/code\x3e 事件，同时也触发带方向的 \x3ccode\x3eswipe\x3c\/code\x3e 事件。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3estart\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22on(\x27touchstart MSPointerDown pointerdown\x27, function(e){\n  if((_isPointerType = isPointerEventType(e, \x27down\x27)) \x26amp;\x26amp;\n     !isPrimaryTouch(e)) return\n  firstTouch = _isPointerType ? e : e.touches[0]\n  if (e.touches \x26amp;\x26amp; e.touches.length === 1 \x26amp;\x26amp; touch.x2) {\n    touch.x2 = undefined\n    touch.y2 = undefined\n  }\n  now = Date.now()\n  delta = now - (touch.last || now)\n  touch.el = $(\x27tagName\x27 in firstTouch.target ?\n               firstTouch.target : firstTouch.target.parentNode)\n  touchTimeout \x26amp;\x26amp; clearTimeout(touchTimeout)\n  touch.x1 = firstTouch.pageX\n  touch.y1 = firstTouch.pageY\n  if (delta \x3e 0 \x26amp;\x26amp; delta \x3c= 250) touch.isDoubleTap = true\n  touch.last = now\n  longTapTimeout = setTimeout(longTap, longTapDelay)\n  if (gesture \x26amp;\x26amp; _isPointerType) gesture.addPointer(e.pointerId)\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eon(\x3cspan class=\x22hljs-string\x22\x3e\x27touchstart MSPointerDown pointerdown\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e((_isPointerType = isPointerEventType(e, \x3cspan class=\x22hljs-string\x22\x3e\x27down\x27\x3c\/span\x3e)) \x26amp;\x26amp;\n     !isPrimaryTouch(e)) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n  firstTouch = _isPointerType ? e : e.touches[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (e.touches \x26amp;\x26amp; e.touches.length === \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e \x26amp;\x26amp; touch.x2) {\n    touch.x2 = \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e\n    touch.y2 = \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e\n  }\n  now = \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e.now()\n  delta = now - (touch.last || now)\n  touch.el = $(\x3cspan class=\x22hljs-string\x22\x3e\x27tagName\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e firstTouch.target ?\n               firstTouch.target : firstTouch.target.parentNode)\n  touchTimeout \x26amp;\x26amp; clearTimeout(touchTimeout)\n  touch.x1 = firstTouch.pageX\n  touch.y1 = firstTouch.pageY\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (delta \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e \x26amp;\x26amp; delta \x26lt;= \x3cspan class=\x22hljs-number\x22\x3e250\x3c\/span\x3e) touch.isDoubleTap = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n  touch.last = now\n  longTapTimeout = setTimeout(longTap, longTapDelay)\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (gesture \x26amp;\x26amp; _isPointerType) gesture.addPointer(e.pointerId)\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e过滤掉非触屏事件\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if((_isPointerType = isPointerEventType(e, \x27down\x27)) \x26amp;\x26amp;\n   !isPrimaryTouch(e)) return\nfirstTouch = _isPointerType ? e : e.touches[0]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e((_isPointerType = isPointerEventType(e, \x3cspan class=\x22hljs-string\x22\x3e\x27down\x27\x3c\/span\x3e)) \x26amp;\x26amp;\n   !isPrimaryTouch(e)) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\nfirstTouch = _isPointerType ? e : e.touches[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里还将 \x3ccode\x3eisPointerEventType\x3c\/code\x3e 的判断结果保存到了 \x3ccode\x3e_isPointerType\x3c\/code\x3e 中，用来判断是否为 \x3ccode\x3ePointerEvent\x3c\/code\x3e 。\x3c\/p\x3e\n\x3cp\x3e这里的判断其实就是只处理 \x3ccode\x3ePointerEvent\x3c\/code\x3e 和 \x3ccode\x3eTouchEvent\x3c\/code\x3e ，并且 \x3ccode\x3eTouchEvent\x3c\/code\x3e 的 \x3ccode\x3eisPrimary\x3c\/code\x3e 必须为 \x3ccode\x3etrue\x3c\/code\x3e 。\x3c\/p\x3e\n\x3cp\x3e因为 \x3ccode\x3eTouchEvent\x3c\/code\x3e 支持多点触碰，这里只取触碰的第一点存入 \x3ccode\x3efirstTouch\x3c\/code\x3e 变量。\x3c\/p\x3e\n\x3ch4\x3e重置终点坐标\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (e.touches \x26amp;\x26amp; e.touches.length === 1 \x26amp;\x26amp; touch.x2) {\n  touch.x2 = undefined\n  touch.y2 = undefined\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (e.touches \x26amp;\x26amp; e.touches.length === \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e \x26amp;\x26amp; touch.x2) {\n  touch.x2 = \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e\n  touch.y2 = \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果还需要记录，终点坐标是需要更新的。\x3c\/p\x3e\n\x3cp\x3e正常情况下，\x3ccode\x3etouch\x3c\/code\x3e 对象会在 \x3ccode\x3etouchEnd\x3c\/code\x3e 或者 \x3ccode\x3ecancel\x3c\/code\x3e 的时候清空，但是如果用户自己调用了 \x3ccode\x3epreventDefault\x3c\/code\x3e 等，就可能会出现没有清空的情况。\x3c\/p\x3e\n\x3cp\x3e这里有一点不太明白，为什么只会在 \x3ccode\x3etouches\x3c\/code\x3e 单点操作的时候才清空呢？多个触碰点的时候不需要清空吗？\x3c\/p\x3e\n\x3ch4\x3e记录触碰点的信息\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22now = Date.now()\ndelta = now - (touch.last || now)\ntouch.el = $(\x27tagName\x27 in firstTouch.target ?\n             firstTouch.target : firstTouch.target.parentNode)\ntouchTimeout \x26amp;\x26amp; clearTimeout(touchTimeout)\ntouch.x1 = firstTouch.pageX\ntouch.y1 = firstTouch.pageY\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3enow = \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e.now()\ndelta = now - (touch.last || now)\ntouch.el = $(\x3cspan class=\x22hljs-string\x22\x3e\x27tagName\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e firstTouch.target ?\n             firstTouch.target : firstTouch.target.parentNode)\ntouchTimeout \x26amp;\x26amp; clearTimeout(touchTimeout)\ntouch.x1 = firstTouch.pageX\ntouch.y1 = firstTouch.pageY\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3enow\x3c\/code\x3e 用来保存当前时间。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3edelta\x3c\/code\x3e 用来保存两次点击时的时间间隔，用来处理双击事件。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3etouch.el\x3c\/code\x3e 用来保存目标元素，这里有个判断，如果 \x3ccode\x3etarget\x3c\/code\x3e 不是标签节点时，取父节点作为目标元素。这会在点击伪类元素时出现。\x3c\/p\x3e\n\x3cp\x3e如果 \x3ccode\x3etouchTimeout\x3c\/code\x3e 存在，则清除定时器，避免重复触发。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3etouch.x1\x3c\/code\x3e 和 \x3ccode\x3etouch.y1\x3c\/code\x3e 分别保存 \x3ccode\x3ex轴\x3c\/code\x3e 坐标和 \x3ccode\x3ey轴\x3c\/code\x3e 坐标。\x3c\/p\x3e\n\x3ch4\x3e双击事件\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (delta \x3e 0 \x26amp;\x26amp; delta \x3c= 250) touch.isDoubleTap = true\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (delta \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e \x26amp;\x26amp; delta \x26lt;= \x3cspan class=\x22hljs-number\x22\x3e250\x3c\/span\x3e) touch.isDoubleTap = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以很清楚地看到， \x3ccode\x3eZepto\x3c\/code\x3e 将两次点击的时间间隔小于 \x3ccode\x3e250ms\x3c\/code\x3e 时，作为 \x3ccode\x3edoubleTap\x3c\/code\x3e 事件处理，将 \x3ccode\x3eisDoubleTap\x3c\/code\x3e 设置为 \x3ccode\x3etrue\x3c\/code\x3e 。\x3c\/p\x3e\n\x3ch4\x3e长按事件\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22touch.last = now\nlongTapTimeout = setTimeout(longTap, longTapDelay)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3etouch.last = now\nlongTapTimeout = setTimeout(longTap, longTapDelay)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e将 \x3ccode\x3etouch.last\x3c\/code\x3e 设置为当前时间。这样就可以记录两次点击时的时间差了。\x3c\/p\x3e\n\x3cp\x3e同时开始长按事件定时器，从上面的代码可以看到，长按事件会在 \x3ccode\x3e750ms\x3c\/code\x3e 后触发。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader14\x22\x3emove\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22on(\x27touchmove MSPointerMove pointermove\x27, function(e){\n  if((_isPointerType = isPointerEventType(e, \x27move\x27)) \x26amp;\x26amp;\n     !isPrimaryTouch(e)) return\n  firstTouch = _isPointerType ? e : e.touches[0]\n  cancelLongTap()\n  touch.x2 = firstTouch.pageX\n  touch.y2 = firstTouch.pageY\n\n  deltaX \x2b= Math.abs(touch.x1 - touch.x2)\n  deltaY \x2b= Math.abs(touch.y1 - touch.y2)\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eon(\x3cspan class=\x22hljs-string\x22\x3e\x27touchmove MSPointerMove pointermove\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e((_isPointerType = isPointerEventType(e, \x3cspan class=\x22hljs-string\x22\x3e\x27move\x27\x3c\/span\x3e)) \x26amp;\x26amp;\n     !isPrimaryTouch(e)) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n  firstTouch = _isPointerType ? e : e.touches[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]\n  cancelLongTap()\n  touch.x2 = firstTouch.pageX\n  touch.y2 = firstTouch.pageY\n\n  deltaX \x2b= \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(touch.x1 - touch.x2)\n  deltaY \x2b= \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(touch.y1 - touch.y2)\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3emove\x3c\/code\x3e 事件处理了两件事，一是记录终点坐标，一是计算起点到终点之间的位移。\x3c\/p\x3e\n\x3cp\x3e要注意这里还调用了 \x3ccode\x3ecancelLongTap\x3c\/code\x3e 清除了长按定时器，避免长按事件的触发。因为有移动，肯定就不是长按了。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader15\x22\x3eend\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22on(\x27touchend MSPointerUp pointerup\x27, function(e){\n  if((_isPointerType = isPointerEventType(e, \x27up\x27)) \x26amp;\x26amp;\n     !isPrimaryTouch(e)) return\n  cancelLongTap()\n\n  if ((touch.x2 \x26amp;\x26amp; Math.abs(touch.x1 - touch.x2) \x3e 30) ||\n      (touch.y2 \x26amp;\x26amp; Math.abs(touch.y1 - touch.y2) \x3e 30))\n\n    swipeTimeout = setTimeout(function() {\n      if (touch.el){\n        touch.el.trigger(\x27swipe\x27)\n        touch.el.trigger(\x27swipe\x27 \x2b (swipeDirection(touch.x1, touch.x2, touch.y1, touch.y2)))\n      }\n      touch = {}\n    }, 0)\n\n  else if (\x27last\x27 in touch)\n  \n    if (deltaX \x3c 30 \x26amp;\x26amp; deltaY \x3c 30) {\n    \n      tapTimeout = setTimeout(function() {\n        \n        var event = $.Event(\x27tap\x27)\n        event.cancelTouch = cancelAll\n        \n        if (touch.el) touch.el.trigger(event)\n\n        if (touch.isDoubleTap) {\n          if (touch.el) touch.el.trigger(\x27doubleTap\x27)\n          touch = {}\n        }\n\n        else {\n          touchTimeout = setTimeout(function(){\n            touchTimeout = null\n            if (touch.el) touch.el.trigger(\x27singleTap\x27)\n            touch = {}\n          }, 250)\n        }\n      }, 0)\n    } else {\n      touch = {}\n    }\n  deltaX = deltaY = 0\n\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eon(\x3cspan class=\x22hljs-string\x22\x3e\x27touchend MSPointerUp pointerup\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e((_isPointerType = isPointerEventType(e, \x3cspan class=\x22hljs-string\x22\x3e\x27up\x27\x3c\/span\x3e)) \x26amp;\x26amp;\n     !isPrimaryTouch(e)) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n  cancelLongTap()\n\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e ((touch.x2 \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(touch.x1 - touch.x2) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e) ||\n      (touch.y2 \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(touch.y1 - touch.y2) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e))\n\n    swipeTimeout = setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touch.el){\n        touch.el.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27swipe\x27\x3c\/span\x3e)\n        touch.el.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27swipe\x27\x3c\/span\x3e \x2b (swipeDirection(touch.x1, touch.x2, touch.y1, touch.y2)))\n      }\n      touch = {}\n    }, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\n\n  \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x27last\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e touch)\n  \n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (deltaX \x26lt; \x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e \x26amp;\x26amp; deltaY \x26lt; \x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e) {\n    \n      tapTimeout = setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e event = $.Event(\x3cspan class=\x22hljs-string\x22\x3e\x27tap\x27\x3c\/span\x3e)\n        event.cancelTouch = cancelAll\n        \n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touch.el) touch.el.trigger(event)\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touch.isDoubleTap) {\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touch.el) touch.el.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27doubleTap\x27\x3c\/span\x3e)\n          touch = {}\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n          touchTimeout = setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n            touchTimeout = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touch.el) touch.el.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27singleTap\x27\x3c\/span\x3e)\n            touch = {}\n          }, \x3cspan class=\x22hljs-number\x22\x3e250\x3c\/span\x3e)\n        }\n      }, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      touch = {}\n    }\n  deltaX = deltaY = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3eswipe\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22cancelLongTap()\nif ((touch.x2 \x26amp;\x26amp; Math.abs(touch.x1 - touch.x2) \x3e 30) ||\n    (touch.y2 \x26amp;\x26amp; Math.abs(touch.y1 - touch.y2) \x3e 30))\n\n  swipeTimeout = setTimeout(function() {\n    if (touch.el){\n      touch.el.trigger(\x27swipe\x27)\n      touch.el.trigger(\x27swipe\x27 \x2b (swipeDirection(touch.x1, touch.x2, touch.y1, touch.y2)))\n    }\n    touch = {}\n  }, 0)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3ecancelLongTap()\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e ((touch.x2 \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(touch.x1 - touch.x2) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e) ||\n    (touch.y2 \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(touch.y1 - touch.y2) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e))\n\n  swipeTimeout = setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touch.el){\n      touch.el.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27swipe\x27\x3c\/span\x3e)\n      touch.el.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27swipe\x27\x3c\/span\x3e \x2b (swipeDirection(touch.x1, touch.x2, touch.y1, touch.y2)))\n    }\n    touch = {}\n  }, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e进入 \x3ccode\x3eend\x3c\/code\x3e 时，立刻清除 \x3ccode\x3elongTap\x3c\/code\x3e 定时器的执行。\x3c\/p\x3e\n\x3cp\x3e可以看到，起点和终点的距离超过 \x3ccode\x3e30\x3c\/code\x3e 时，会被判定为 \x3ccode\x3eswipe\x3c\/code\x3e 滑动事件。\x3c\/p\x3e\n\x3cp\x3e在触发完 \x3ccode\x3eswipe\x3c\/code\x3e 事件后，立即触发对应方向上的 \x3ccode\x3eswipe\x3c\/code\x3e 事件。\x3c\/p\x3e\n\x3cp\x3e注意，\x3ccode\x3eswipe\x3c\/code\x3e 事件并不是在 \x3ccode\x3eend\x3c\/code\x3e 系列事件触发时立即触发的，而是设置了一个 \x3ccode\x3e0ms\x3c\/code\x3e 的定时器，让事件异步触发，这个有什么用呢？后面会讲到。\x3c\/p\x3e\n\x3ch4\x3etap\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22else if (\x27last\x27 in touch)\n  \n  if (deltaX \x3c 30 \x26amp;\x26amp; deltaY \x3c 30) {\n\n    tapTimeout = setTimeout(function() {\n\n      var event = $.Event(\x27tap\x27)\n      event.cancelTouch = cancelAll\n\n      if (touch.el) touch.el.trigger(event)\n\n    }, 0)\n  } else {\n    touch = {}\n  }\ndeltaX = deltaY = 0\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x27last\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e touch)\n  \n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (deltaX \x26lt; \x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e \x26amp;\x26amp; deltaY \x26lt; \x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e) {\n\n    tapTimeout = setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e event = $.Event(\x3cspan class=\x22hljs-string\x22\x3e\x27tap\x27\x3c\/span\x3e)\n      event.cancelTouch = cancelAll\n\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touch.el) touch.el.trigger(event)\n\n    }, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    touch = {}\n  }\ndeltaX = deltaY = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e终于看到重点了，首先判断 \x3ccode\x3elast\x3c\/code\x3e 是否存在，从 \x3ccode\x3estart\x3c\/code\x3e 中可以看到，如果触发了 \x3ccode\x3estart\x3c\/code\x3e ， \x3ccode\x3elast\x3c\/code\x3e 肯定是存在的，但是如果触发了长按事件，\x3ccode\x3etouch\x3c\/code\x3e 对象会被清空，这时不会再触发 \x3ccode\x3etap\x3c\/code\x3e 事件。\x3c\/p\x3e\n\x3cp\x3e如果不是 \x3ccode\x3eswipe\x3c\/code\x3e 事件，也不存在 \x3ccode\x3elast\x3c\/code\x3e ，则只将 \x3ccode\x3etouch\x3c\/code\x3e 清空，不触发任何事件。\x3c\/p\x3e\n\x3cp\x3e在最后会将 \x3ccode\x3edeltaX\x3c\/code\x3e 和 \x3ccode\x3edeltaY\x3c\/code\x3e 重置为 \x3ccode\x3e0\x3c\/code\x3e 。\x3c\/p\x3e\n\x3cp\x3e触发 \x3ccode\x3etap\x3c\/code\x3e 事件时，会在 \x3ccode\x3eevent\x3c\/code\x3e 中加了 \x3ccode\x3ecancelTouch\x3c\/code\x3e 方法，外界可以通过这个方法取消所有事件的执行。\x3c\/p\x3e\n\x3cp\x3e这里同样用了 \x3ccode\x3esetTimeout\x3c\/code\x3e 异步触发事件。\x3c\/p\x3e\n\x3ch4\x3edoubleTap\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (touch.isDoubleTap) {\n  if (touch.el) touch.el.trigger(\x27doubleTap\x27)\n  touch = {}\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touch.isDoubleTap) {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touch.el) touch.el.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27doubleTap\x27\x3c\/span\x3e)\n  touch = {}\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个 \x3ccode\x3eisDoubleTap\x3c\/code\x3e 在 \x3ccode\x3estart\x3c\/code\x3e 时确定的，上面已经分析过了，在 \x3ccode\x3eend\x3c\/code\x3e 的时候触发 \x3ccode\x3edoubleTap\x3c\/code\x3e 事件。\x3c\/p\x3e\n\x3cp\x3e因此，可以知道，在触发 \x3ccode\x3edoubleTap\x3c\/code\x3e 事件之前会触发两次 \x3ccode\x3etap\x3c\/code\x3e 事件。\x3c\/p\x3e\n\x3ch4\x3esingleTap\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22touchTimeout = setTimeout(function(){\n  touchTimeout = null\n  if (touch.el) touch.el.trigger(\x27singleTap\x27)\n  touch = {}\n}, 250)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3etouchTimeout = setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  touchTimeout = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touch.el) touch.el.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27singleTap\x27\x3c\/span\x3e)\n  touch = {}\n}, \x3cspan class=\x22hljs-number\x22\x3e250\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果不是 \x3ccode\x3edoubleTap\x3c\/code\x3e ，会在 \x3ccode\x3etap\x3c\/code\x3e 事件触发的 \x3ccode\x3e250ms\x3c\/code\x3e 后，触发 \x3ccode\x3esingleTap\x3c\/code\x3e 事件。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader16\x22\x3ecancel\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22.on(\x27touchcancel MSPointerCancel pointercancel\x27, cancelAll)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e.on(\x3cspan class=\x22hljs-string\x22\x3e\x27touchcancel MSPointerCancel pointercancel\x27\x3c\/span\x3e, cancelAll)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在接受到 \x3ccode\x3ecancel\x3c\/code\x3e 事件时，调用 \x3ccode\x3ecancelAll\x3c\/code\x3e 方法，取消所有事件的触发。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader17\x22\x3escroll\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$(window).on(\x27scroll\x27, cancelAll)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e$(\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e).on(\x3cspan class=\x22hljs-string\x22\x3e\x27scroll\x27\x3c\/span\x3e, cancelAll)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e从前面的分析可以看到，所有的事件触发都是异步的。\x3c\/p\x3e\n\x3cp\x3e因为在 \x3ccode\x3escroll\x3c\/code\x3e 的时候，肯定是只想响应滚动的事件，异步触发是为了在 \x3ccode\x3escroll\x3c\/code\x3e 的过程中和外界调用 \x3ccode\x3ecancelTouch\x3c\/code\x3e 方法时， 可以将事件取消。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader18\x22\x3e系列文章\x3c\/h2\x3e\n\x3col\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E4%BB%A3%E7%A0%81%E7%BB%93%E6%9E%84.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之代码结构\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E5%86%85%E9%83%A8%E6%96%B9%E6%B3%95.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之内部方法\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之工具函数\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E7%A5%9E%E5%A5%87%E7%9A%84%24.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之神奇的$\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之集合操作\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E9%9B%86%E5%90%88%E5%85%83%E7%B4%A0%E6%9F%A5%E6%89%BE.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之集合元素查找\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E6%93%8D%E4%BD%9CDOM.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之操作DOM\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E6%A0%B7%E5%BC%8F%E6%93%8D%E4%BD%9C.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之样式操作\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E5%B1%9E%E6%80%A7%E6%93%8D%E4%BD%9C.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之属性操作\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BEvent%E6%A8%A1%E5%9D%97.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之Event模块\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BIE%E6%A8%A1%E5%9D%97.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之IE模块\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BCallbacks%E6%A8%A1%E5%9D%97.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之Callbacks模块\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BDeferred%E6%A8%A1%E5%9D%97.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之Deferred模块\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BAjax%E6%A8%A1%E5%9D%97.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之Ajax模块\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8Bassets%E6%A8%A1%E5%9D%97.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之Assets模块\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/yeyuqiudeng\/reading-zepto\/blob\/master\/src\/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BSelector%E6%A8%A1%E5%9D%97.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e读Zepto源码之Selector模块\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader19\x22\x3e参考\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000005882908\x22\x3ezepto touch 库源码分析\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/PointerEvent\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ePointerEvent\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/Pointer_events\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ePointer events\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/TouchEvent\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eTouchEvent\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/Touch\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eTouch\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/GestureEvent\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGestureEvent\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/API\/MSGestureEvent\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMSGestureEvent\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/zrysmt.github.io\/2017\/04\/28\/%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5DIY%20zepto%E5%BA%93%EF%BC%8C%E7%A0%94%E7%A9%B6zepto%E6%BA%90%E7%A0%818--touch%E6%A8%A1%E5%9D%97\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e一步一步DIY zepto库，研究zepto源码8--touch模块\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/www.bbsmax.com\/A\/Vx5M9nPv5N\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ezepto源码学习-06 touch\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/blog.h5min.cn\/u013055396\/article\/details\/76606048\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ezepto源码之touch.js\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/msdn.microsoft.com\/en-us\/library\/hh968251(v=vs.85\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eaddPointer method\x3c\/a\x3e.aspx)\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader20\x22\x3eLicense\x3c\/h2\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/creativecommons.org\/licenses\/by-nc-nd\/4.0\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e署名-非商业性使用-禁止演绎 4.0 国际 (CC BY-NC-ND 4.0)\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e最后，所有文章都会同步发送到微信公众号上，欢迎关注,欢迎提意见：  \x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000009735938?w=430\x26amp;h=430\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000009735938?w=430\x26amp;h=430\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e作者：对角另一面\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>读Zepto源码之Touch模块</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011268249">https://segmentfault.com/a/1190000011268249</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/uxg2f7jwqjs/" target="_blank">https://alili.tech/archive/uxg2f7jwqjs/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>