<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="ajax跨域，这应该是最全的解决方案了"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>ajax跨域，这应该是最全的解决方案了 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/vaj5jj7ve7/",
				"appid": "1613049289050283", 
				"title": "ajax跨域，这应该是最全的解决方案了 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-21T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/63g8jh3bjpq/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/mf22y6zyunk/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fvaj5jj7ve7%2f&text=ajax%e8%b7%a8%e5%9f%9f%ef%bc%8c%e8%bf%99%e5%ba%94%e8%af%a5%e6%98%af%e6%9c%80%e5%85%a8%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88%e4%ba%86"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fvaj5jj7ve7%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fvaj5jj7ve7%2f&text=ajax%e8%b7%a8%e5%9f%9f%ef%bc%8c%e8%bf%99%e5%ba%94%e8%af%a5%e6%98%af%e6%9c%80%e5%85%a8%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88%e4%ba%86"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fvaj5jj7ve7%2f&title=ajax%e8%b7%a8%e5%9f%9f%ef%bc%8c%e8%bf%99%e5%ba%94%e8%af%a5%e6%98%af%e6%9c%80%e5%85%a8%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88%e4%ba%86"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fvaj5jj7ve7%2f&is_video=false&description=ajax%e8%b7%a8%e5%9f%9f%ef%bc%8c%e8%bf%99%e5%ba%94%e8%af%a5%e6%98%af%e6%9c%80%e5%85%a8%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88%e4%ba%86"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=ajax%e8%b7%a8%e5%9f%9f%ef%bc%8c%e8%bf%99%e5%ba%94%e8%af%a5%e6%98%af%e6%9c%80%e5%85%a8%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88%e4%ba%86&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fvaj5jj7ve7%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fvaj5jj7ve7%2f&title=ajax%e8%b7%a8%e5%9f%9f%ef%bc%8c%e8%bf%99%e5%ba%94%e8%af%a5%e6%98%af%e6%9c%80%e5%85%a8%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88%e4%ba%86"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fvaj5jj7ve7%2f&title=ajax%e8%b7%a8%e5%9f%9f%ef%bc%8c%e8%bf%99%e5%ba%94%e8%af%a5%e6%98%af%e6%9c%80%e5%85%a8%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88%e4%ba%86"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fvaj5jj7ve7%2f&title=ajax%e8%b7%a8%e5%9f%9f%ef%bc%8c%e8%bf%99%e5%ba%94%e8%af%a5%e6%98%af%e6%9c%80%e5%85%a8%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88%e4%ba%86"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fvaj5jj7ve7%2f&title=ajax%e8%b7%a8%e5%9f%9f%ef%bc%8c%e8%bf%99%e5%ba%94%e8%af%a5%e6%98%af%e6%9c%80%e5%85%a8%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88%e4%ba%86"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">ajax跨域，这应该是最全的解决方案了</h1><div class="meta"><div class="postdate"><time datetime="2018-12-21" itemprop="datePublished">2018-12-21</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e前言\x3c\/h2\x3e\n\x3cp\x3e从刚接触前端开发起，\x3ccode\x3e跨域\x3c\/code\x3e这个词就一直以很高的频率在身边重复出现，一直到现在，已经调试过N个跨域相关的问题了，16年时也整理过一篇相关文章，但是感觉还是差了点什么，于是现在重新梳理了一下。\x3c\/p\x3e\n\x3cp\x3e个人见识有限，如有差错，请多多见谅，欢迎提出issue，另外看到这个标题，请勿喷~\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e题纲\x3c\/h2\x3e\n\x3cp\x3e关于跨域，有N种类型，本文只专注于\x3ccode\x3eajax请求跨域\x3c\/code\x3e(,ajax跨域只是属于浏览器\x22同源策略\x22中的一部分,其它的还有Cookie跨域iframe跨域,LocalStorage跨域等这里不做介绍)，内容大概如下:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3e什么是ajax跨域\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e原理\x3c\/li\x3e\n\x3cli\x3e表现(整理了一些遇到的问题以及解决方案)\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e如何解决ajax跨域\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eJSONP方式\x3c\/li\x3e\n\x3cli\x3eCORS方式\x3c\/li\x3e\n\x3cli\x3e代理请求方式\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e如何分析ajax跨域\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3ehttp抓包的分析\x3c\/li\x3e\n\x3cli\x3e一些示例\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e什么是ajax跨域\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3eajax跨域的原理\x3c\/h3\x3e\n\x3cp\x3eajax出现请求跨域错误问题,主要原因就是因为浏览器的“同源策略”,可以参考\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2016\/04\/same-origin-policy.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e浏览器同源政策及其规避方法(阮一峰)\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3eCORS请求原理\x3c\/h3\x3e\n\x3cp\x3eCORS是一个W3C标准，全称是\x22跨域资源共享\x22（Cross-origin resource sharing）。它允许浏览器向跨源服务器，发出XMLHttpRequest请求，从而克服了AJAX只能同源使用的限制。\x3c\/p\x3e\n\x3cp\x3e基本上目前所有的浏览器都实现了CORS标准,其实目前几乎所有的浏览器ajax请求都是基于CORS机制的,只不过可能平时前端开发人员并不关心而已(所以说其实现在CORS解决方案主要是考虑后台该如何实现的问题)。\x3c\/p\x3e\n\x3cp\x3e关于CORS，强烈推荐阅读\x26nbsp;\x3cbr\x3e\x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2016\/04\/cors.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e跨域资源共享 CORS 详解(阮一峰)\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e另外，这里也整理了一个实现原理图(简化版):\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012469718?w=1070\x26amp;h=827\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012469718?w=1070\x26amp;h=827\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e如何判断是否是简单请求?\x3c\/h4\x3e\n\x3cp\x3e浏览器将CORS请求分成两类：简单请求（simple request）和非简单请求（not-so-simple request）。只要同时满足以下两大条件，就属于简单请求。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e请求方法是以下三种方法之一：HEAD,GET,POST\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3eHTTP的头信息不超出以下几种字段：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eAccept\x3c\/li\x3e\n\x3cli\x3eAccept-Language\x3c\/li\x3e\n\x3cli\x3eContent-Language\x3c\/li\x3e\n\x3cli\x3eLast-Event-ID\x3c\/li\x3e\n\x3cli\x3eContent-Type(只限于三个值application\/x-www-form-urlencoded、     multipart\/form-data、text\/plain)\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e凡是不同时满足上面两个条件，就属于非简单请求。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3eajax跨域的表现\x3c\/h3\x3e\n\x3cp\x3e说实话，当初整理过一篇文章，然后作为了一个解决方案，但是后来发现仍然有很多人还是不会。无奈只能耗时又耗力的调试。然而就算是我来分析，也只会根据对应的表现来判断是否是跨域，因此这一点是很重要的。\x3c\/p\x3e\n\x3cp\x3eajax请求时,如果存在跨域现象,并且没有进行解决,会有如下表现:(注意，是ajax请求，请不要说为什么http请求可以，而ajax不行，因为ajax是伴随着跨域的，所以仅仅是http请求ok是不行的)\x3c\/p\x3e\n\x3cp\x3e注意:具体的后端跨域配置请看题纲位置。\x3c\/p\x3e\n\x3ch4\x3e第一种现象:\x3ccode\x3eNo \x27Access-Control-Allow-Origin\x27 header is present on the requested resource\x3c\/code\x3e,并且\x3ccode\x3eThe response had HTTP status code 404\x3c\/code\x3e\n\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012469719?w=858\x26amp;h=455\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012469719?w=858\x26amp;h=455\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e出现这种情况的原因如下：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e本次ajax请求是“非简单请求”,所以请求前会发送一次预检请求(OPTIONS)\x3c\/li\x3e\n\x3cli\x3e服务器端后台接口没有允许OPTIONS请求,导致无法找到对应接口地址\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e解决方案: 后端允许options请求\x3c\/p\x3e\n\x3ch4\x3e第二种现象:\x3ccode\x3eNo \x27Access-Control-Allow-Origin\x27 header is present on the requested resource\x3c\/code\x3e,并且\x3ccode\x3eThe response had HTTP status code 405\x3c\/code\x3e\n\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012469720?w=860\x26amp;h=443\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012469720?w=860\x26amp;h=443\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e这种现象和第一种有区别,这种情况下，后台方法允许OPTIONS请求,但是一些配置文件中(如\x3ccode\x3e安全配置\x3c\/code\x3e),阻止了OPTIONS请求,才会导致这个现象\x3c\/p\x3e\n\x3cp\x3e解决方案: 后端关闭对应的安全配置\x3c\/p\x3e\n\x3ch4\x3e第三种现象:\x3ccode\x3eNo \x27Access-Control-Allow-Origin\x27 header is present on the requested resource\x3c\/code\x3e,并且\x3ccode\x3estatus 200\x3c\/code\x3e\n\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012469721?w=858\x26amp;h=426\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012469721?w=858\x26amp;h=426\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e这种现象和第一种和第二种有区别,这种情况下，服务器端后台允许OPTIONS请求,并且接口也允许OPTIONS请求,但是头部匹配时出现不匹配现象\x3c\/p\x3e\n\x3cp\x3e比如origin头部检查不匹配,比如少了一些头部的支持(如常见的X-Requested-With头部),然后服务端就会将response返回给前端,前端检测到这个后就触发XHR.onerror,导致前端控制台报错\x3c\/p\x3e\n\x3cp\x3e解决方案: 后端增加对应的头部支持\x3c\/p\x3e\n\x3ch4\x3e第四种现象:\x3ccode\x3eheade contains multiple values \x27*,*\x27\x3c\/code\x3e\n\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012469722?w=1234\x26amp;h=806\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012469722?w=1234\x26amp;h=806\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012469723?w=810\x26amp;h=64\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012469723?w=810\x26amp;h=64\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e表现现象是，后台响应的http头部信息有两个\x3ccode\x3eAccess-Control-Allow-Origin:*\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e说实话，这种问题出现的主要原因就是进行跨域配置的人不了解原理，导致了重复配置，如:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e常见于.net后台(一般在web.config中配置了一次origin,然后代码中又手动添加了一次origin(比如代码手动设置了返回*))\x3c\/li\x3e\n\x3cli\x3e常见于.net后台(在IIS和项目的webconfig中同时设置Origin:*)\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e解决方案(一一对应):\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e建议删除代码中手动添加的*，只用项目配置中的即可\x3c\/li\x3e\n\x3cli\x3e建议删除IIS下的配置*，只用项目配置中的即可\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e如何解决ajax跨域\x3c\/h2\x3e\n\x3cp\x3e一般ajax跨域解决就是通过JSONP解决或者CORS解决,如以下:(注意，现在已经几乎不会再使用JSONP了，所以JSONP了解下即可)\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3eJSONP方式解决跨域问题\x3c\/h3\x3e\n\x3cp\x3ejsonp解决跨域问题是一个比较古老的方案(实际中不推荐使用),这里做简单介绍(实际项目中如果要使用JSONP,一般会使用JQ等对JSONP进行了封装的类库来进行ajax请求)\x3c\/p\x3e\n\x3ch4\x3e实现原理\x3c\/h4\x3e\n\x3cp\x3eJSONP之所以能够用来解决跨域方案,主要是因为 \x26lt;script\x26gt; 脚本拥有跨域能力,而JSONP正是利用这一点来实现。具体原理如图\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012469724?w=901\x26amp;h=701\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012469724?w=901\x26amp;h=701\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e实现流程\x3c\/h4\x3e\n\x3cp\x3eJSONP的实现步骤大致如下(参考了来源中的文章)\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3e客户端网页网页通过添加一个\x26lt;script\x26gt;元素，向服务器请求JSON数据，这种做法不受同源政策限制\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function addScriptTag(src) {\n  var script = document.createElement(\x27script\x27);\n  script.setAttribute(\x26quot;type\x26quot;,\x26quot;text\/javascript\x26quot;);\n  script.src = src;\n  document.body.appendChild(script);\n}\n\nwindow.onload = function () {\n  addScriptTag(\x27http:\/\/example.com\/ip?callback=foo\x27);\n}\n\nfunction foo(data) {\n  console.log(\x27response data: \x27 \x2b JSON.stringify(data));\n};                      \n    \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eaddScriptTag\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3esrc\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e script = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27script\x27\x3c\/span\x3e);\n  script.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e);\n  script.src = src;\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(script);\n}\n\n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  addScriptTag(\x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/example.com\/ip?callback=foo\x27\x3c\/span\x3e);\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efoo\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27response data: \x27\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(data));\n};                      \n    \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e请求时,接口地址是作为构建出的脚本标签的src的,这样,当脚本标签构建出来时,最终的src是接口返回的内容\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e服务端对应的接口在返回参数外面添加函数包裹层\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22foo({\n  \x26quot;test\x26quot;: \x26quot;testData\x26quot;\n});                     \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3efoo({\n  \x3cspan class=\x22hljs-string\x22\x3e\x22test\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22testData\x22\x3c\/span\x3e\n});                     \x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e由于\x26lt;script\x26gt;元素请求的脚本，直接作为代码运行。这时，只要浏览器定义了foo函数，该函数就会立即调用。作为参数的JSON数据被视为JavaScript对象，而不是字符串，因此避免了使用JSON.parse的步骤。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e注意,一般的JSONP接口和普通接口返回数据是有区别的,所以接口如果要做JSONO兼容,需要进行判断是否有对应callback关键字参数,如果有则是JSONP请求,返回JSONP数据,否则返回普通数据\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e使用注意\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e基于JSONP的实现原理,所以JSONP只能是“GET”请求,不能进行较为复杂的POST和其它请求,所以遇到那种情况,就得参考下面的CORS解决跨域了(所以如今它也基本被淘汰了)\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3eCORS解决跨域问题\x3c\/h3\x3e\n\x3cp\x3eCORS的原理上文中已经介绍了，这里主要介绍的是，实际项目中，后端应该如何配置以解决问题(因为大量项目实践都是由后端进行解决的)，这里整理了一些常见的后端解决方案:\x3c\/p\x3e\n\x3ch4\x3ePHP后台配置\x3c\/h4\x3e\n\x3cp\x3ePHP后台得配置几乎是所有后台中最为简单的,遵循如下步骤即可:\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e第一步:配置Php 后台允许跨域\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c?php\nheader(\x27Access-Control-Allow-Origin: *\x27);\nheader(\x27Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept\x27);\n\/\/主要为跨域CORS配置的两大基本信息,Origin和headers\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x26lt;?php\nheader(\x3cspan class=\x22hljs-string\x22\x3e\x27Access-Control-Allow-Origin: *\x27\x3c\/span\x3e);\nheader(\x3cspan class=\x22hljs-string\x22\x3e\x27Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/主要为跨域CORS配置的两大基本信息,Origin和headers\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e第二步:配置Apache web服务器跨域(httpd.conf中)\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e原始代码\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cDirectory \/\x3e\n    AllowOverride none\n    Require all denied\n\x3c\/Directory\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eDirectory\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n    AllowOverride none\n    Require all denied\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eDirectory\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e改为以下代码\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cDirectory \/\x3e\n    Options FollowSymLinks\n    AllowOverride none\n    Order deny,allow\n    Allow from all\n\x3c\/Directory\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eDirectory\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n    Options FollowSymLinks\n    AllowOverride none\n    Order deny,allow\n    Allow from all\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eDirectory\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3eNode.js后台配置(express框架)\x3c\/h4\x3e\n\x3cp\x3eNode.js的后台也相对来说比较简单就可以进行配置。只需用express如下配置:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22app.all(\x27*\x27, function(req, res, next) {\n    res.header(\x26quot;Access-Control-Allow-Origin\x26quot;, \x26quot;*\x26quot;);\n    res.header(\x26quot;Access-Control-Allow-Headers\x26quot;, \x26quot;X-Requested-With\x26quot;);\n    res.header(\x26quot;Access-Control-Allow-Methods\x26quot;, \x26quot;PUT,POST,GET,DELETE,OPTIONS\x26quot;);\n    res.header(\x26quot;X-Powered-By\x26quot;, \x27 3.2.1\x27)\n        \/\/这段仅仅为了方便返回json而已\n    res.header(\x26quot;Content-Type\x26quot;, \x26quot;application\/json;charset=utf-8\x26quot;);\n    if(req.method == \x27OPTIONS\x27) {\n        \/\/让options请求快速返回\n        res.sendStatus(200); \n    } else { \n        next(); \n    }\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3eapp.all(\x3cspan class=\x22hljs-string\x22\x3e\x27*\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res, next\x3c\/span\x3e) \x3c\/span\x3e{\n    res.header(\x3cspan class=\x22hljs-string\x22\x3e\x22Access-Control-Allow-Origin\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22*\x22\x3c\/span\x3e);\n    res.header(\x3cspan class=\x22hljs-string\x22\x3e\x22Access-Control-Allow-Headers\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22X-Requested-With\x22\x3c\/span\x3e);\n    res.header(\x3cspan class=\x22hljs-string\x22\x3e\x22Access-Control-Allow-Methods\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22PUT,POST,GET,DELETE,OPTIONS\x22\x3c\/span\x3e);\n    res.header(\x3cspan class=\x22hljs-string\x22\x3e\x22X-Powered-By\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27 3.2.1\x27\x3c\/span\x3e)\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/这段仅仅为了方便返回json而已\x3c\/span\x3e\n    res.header(\x3cspan class=\x22hljs-string\x22\x3e\x22Content-Type\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22application\/json;charset=utf-8\x22\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(req.method == \x3cspan class=\x22hljs-string\x22\x3e\x27OPTIONS\x27\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/让options请求快速返回\x3c\/span\x3e\n        res.sendStatus(\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e); \n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e { \n        next(); \n    }\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3eJAVA后台配置\x3c\/h4\x3e\n\x3cp\x3eJAVA后台配置只需要遵循如下步骤即可:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e第一步:获取依赖jar包\x3cp\x3e下载\x26nbsp;\x3ca href=\x22https:\/\/dailc.github.io\/staticResource\/blog\/basicKnowledge\/ajax\/resource\/cors-filter-2.4.jar\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ecors-filter-1.7.jar\x3c\/a\x3e,\x26nbsp;\x3ca href=\x22https:\/\/dailc.github.io\/staticResource\/blog\/basicKnowledge\/ajax\/resource\/java-property-utils-1.9.1.jar\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ejava-property-utils-1.9.jar\x3c\/a\x3e\x26nbsp;这两个库文件放到lib目录下。(放到对应项目的webcontent\/WEB-INF\/lib\/下)\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e第二步:如果项目用了Maven构建的,请添加如下依赖到pom.xml中:(非maven请忽视)\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdependency\x3e\n    \x3cgroupId\x3ecom.thetransactioncompany\x3c\/groupId\x3e\n    \x3cartifactId\x3ecors-filter\x3c\/artifactId\x3e\n    \x3cversion\x3e[ version ]\x3c\/version\x3e\n\x3c\/dependency\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3edependency\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3egroupId\x3c\/span\x3e\x26gt;\x3c\/span\x3ecom.thetransactioncompany\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3egroupId\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eartifactId\x3c\/span\x3e\x26gt;\x3c\/span\x3ecors-filter\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eartifactId\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eversion\x3c\/span\x3e\x26gt;\x3c\/span\x3e[ version ]\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eversion\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3edependency\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其中版本应该是最新的稳定版本,CORS过滤器\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e第三步:添加CORS配置到项目的Web.xml中( App\/WEB-INF\/web.xml)\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c!-- 跨域配置--\x3e    \n\x3cfilter\x3e\n        \x3c!-- The CORS filter with parameters --\x3e\n        \x3cfilter-name\x3eCORS\x3c\/filter-name\x3e\n        \x3cfilter-class\x3ecom.thetransactioncompany.cors.CORSFilter\x3c\/filter-class\x3e\n        \n        \x3c!-- Note: All parameters are options, if omitted the CORS \n             Filter will fall back to the respective default values.\n          --\x3e\n        \x3cinit-param\x3e\n            \x3cparam-name\x3ecors.allowGenericHttpRequests\x3c\/param-name\x3e\n            \x3cparam-value\x3etrue\x3c\/param-value\x3e\n        \x3c\/init-param\x3e\n        \n        \x3cinit-param\x3e\n            \x3cparam-name\x3ecors.allowOrigin\x3c\/param-name\x3e\n            \x3cparam-value\x3e*\x3c\/param-value\x3e\n        \x3c\/init-param\x3e\n        \n        \x3cinit-param\x3e\n            \x3cparam-name\x3ecors.allowSubdomains\x3c\/param-name\x3e\n            \x3cparam-value\x3efalse\x3c\/param-value\x3e\n        \x3c\/init-param\x3e\n        \n        \x3cinit-param\x3e\n            \x3cparam-name\x3ecors.supportedMethods\x3c\/param-name\x3e\n            \x3cparam-value\x3eGET, HEAD, POST, OPTIONS\x3c\/param-value\x3e\n        \x3c\/init-param\x3e\n        \n        \x3cinit-param\x3e\n            \x3cparam-name\x3ecors.supportedHeaders\x3c\/param-name\x3e\n            \x3cparam-value\x3eAccept, Origin, X-Requested-With, Content-Type, Last-Modified\x3c\/param-value\x3e\n        \x3c\/init-param\x3e\n        \n        \x3cinit-param\x3e\n            \x3cparam-name\x3ecors.exposedHeaders\x3c\/param-name\x3e\n            \x3c!--这里可以添加一些自己的暴露Headers   --\x3e\n            \x3cparam-value\x3eX-Test-1, X-Test-2\x3c\/param-value\x3e\n        \x3c\/init-param\x3e\n        \n        \x3cinit-param\x3e\n            \x3cparam-name\x3ecors.supportsCredentials\x3c\/param-name\x3e\n            \x3cparam-value\x3etrue\x3c\/param-value\x3e\n        \x3c\/init-param\x3e\n        \n        \x3cinit-param\x3e\n            \x3cparam-name\x3ecors.maxAge\x3c\/param-name\x3e\n            \x3cparam-value\x3e3600\x3c\/param-value\x3e\n        \x3c\/init-param\x3e\n\n    \x3c\/filter\x3e\n\n    \x3cfilter-mapping\x3e\n        \x3c!-- CORS Filter mapping --\x3e\n        \x3cfilter-name\x3eCORS\x3c\/filter-name\x3e\n        \x3curl-pattern\x3e\/*\x3c\/url-pattern\x3e\n    \x3c\/filter-mapping\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!-- 跨域配置--\x26gt;\x3c\/span\x3e    \n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3efilter\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!-- The CORS filter with parameters --\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3efilter-name\x3c\/span\x3e\x26gt;\x3c\/span\x3eCORS\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3efilter-name\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3efilter-class\x3c\/span\x3e\x26gt;\x3c\/span\x3ecom.thetransactioncompany.cors.CORSFilter\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3efilter-class\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \n        \x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!-- \x3cspan class=\x22hljs-doctag\x22\x3eNote:\x3c\/span\x3e All parameters are options, if omitted the CORS \n             Filter will fall back to the respective default values.\n          --\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3ecors.allowGenericHttpRequests\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3etrue\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3ecors.allowOrigin\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3e*\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3ecors.allowSubdomains\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3efalse\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3ecors.supportedMethods\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3eGET, HEAD, POST, OPTIONS\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3ecors.supportedHeaders\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3eAccept, Origin, X-Requested-With, Content-Type, Last-Modified\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3ecors.exposedHeaders\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!--这里可以添加一些自己的暴露Headers   --\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3eX-Test-1, X-Test-2\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3ecors.supportsCredentials\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3etrue\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3ecors.maxAge\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-name\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3e3600\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eparam-value\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3einit-param\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3efilter\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3efilter-mapping\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!-- CORS Filter mapping --\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3efilter-name\x3c\/span\x3e\x26gt;\x3c\/span\x3eCORS\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3efilter-name\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eurl-pattern\x3c\/span\x3e\x26gt;\x3c\/span\x3e\/*\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eurl-pattern\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3efilter-mapping\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e请注意,以上配置文件请放到web.xml的前面,作为第一个filter存在(可以有多个filter的)\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e第四步:可能的安全模块配置错误(注意，某些框架中-譬如公司私人框架，有安全模块的，有时候这些安全模块配置会影响跨域配置，这时候可以先尝试关闭它们)\x3c\/li\x3e\x3c\/ul\x3e\n\x3ch4\x3eJAVA Spring Boot配置\x3c\/h4\x3e\n\x3cp\x3e\x3cstrong\x3e20171230补充\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e仅列举简单的全局配置\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@Configuration\npublic class CorsConfig {\n\n    private CorsConfiguration buildConfig() {\n        CorsConfiguration corsConfiguration = new CorsConfiguration();\n        \n        \/\/ 可以自行筛选\n        corsConfiguration.addAllowedOrigin(\x26quot;*\x26quot;);\n        corsConfiguration.addAllowedHeader(\x26quot;*\x26quot;);\n        corsConfiguration.addAllowedMethod(\x26quot;*\x26quot;);\n        \n        return corsConfiguration;\n    }\n\n    @Bean\n    public CorsFilter corsFilter() {\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n        \n        source.registerCorsConfiguration(\x26quot;\/**\x26quot;, buildConfig());\n        \n        return new CorsFilter(source);  \n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e@Configuration\npublic \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eCorsConfig\x3c\/span\x3e \x3c\/span\x3e{\n\n    private CorsConfiguration buildConfig() {\n        CorsConfiguration corsConfiguration = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e CorsConfiguration();\n        \n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 可以自行筛选\x3c\/span\x3e\n        corsConfiguration.addAllowedOrigin(\x3cspan class=\x22hljs-string\x22\x3e\x22*\x22\x3c\/span\x3e);\n        corsConfiguration.addAllowedHeader(\x3cspan class=\x22hljs-string\x22\x3e\x22*\x22\x3c\/span\x3e);\n        corsConfiguration.addAllowedMethod(\x3cspan class=\x22hljs-string\x22\x3e\x22*\x22\x3c\/span\x3e);\n        \n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e corsConfiguration;\n    }\n\n    @Bean\n    public CorsFilter corsFilter() {\n        UrlBasedCorsConfigurationSource source = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e UrlBasedCorsConfigurationSource();\n        \n        source.registerCorsConfiguration(\x3cspan class=\x22hljs-string\x22\x3e\x22\/**\x22\x3c\/span\x3e, buildConfig());\n        \n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e CorsFilter(source);  \n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e新建配置，然后添加Configuration注解即可配置成功\x3c\/p\x3e\n\x3cp\x3e\x3cem\x3ePS：这一部分方法是收录的，没有亲身实践过，但根据反馈，理论上可行\x3c\/em\x3e\x3c\/p\x3e\n\x3ch4\x3eNET后台配置\x3c\/h4\x3e\n\x3cp\x3e.NET后台配置可以参考如下步骤:\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e第一步:网站配置\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e打开控制面板，选择管理工具,选择iis;右键单击自己的网站，选择浏览;打开网站所在目录,用记事本打开web.config文件添加下述配置信息,重启网站\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012469725?w=1240\x26amp;h=550\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012469725?w=1240\x26amp;h=550\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e请注意,以上截图较老,如果配置仍然出问题,可以考虑增加更多的headers允许,比如:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;Access-Control-Allow-Headers\x26quot;:\x26quot;X-Requested-With,Content-Type,Accept,Origin\x26quot;            \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x22Access-Control-Allow-Headers\x22:\x22X-Requested-With,Content-Type,Accept,Origin\x22            \x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cp\x3e第二步:其它更多配置,如果第一步进行了后,仍然有跨域问题，可能是:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e接口中有限制死一些请求类型(比如写死了POST等)，这时候请去除限    制\x3c\/li\x3e\n\x3cli\x3e接口中，重复配置了\x3ccode\x3eOrigin:*\x3c\/code\x3e，请去除即可\x3c\/li\x3e\n\x3cli\x3eIIS服务器中，重复配置了\x3ccode\x3eOrigin:*\x3c\/code\x3e，请去除即可\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e代理请求方式解决接口跨域问题\x3c\/h3\x3e\n\x3cp\x3e注意，由于接口代理是有代价的，所以这个仅是开发过程中进行的。\x3c\/p\x3e\n\x3cp\x3e与前面的方法不同，前面CORS是后端解决，而这个主要是前端对接口进行代理，也就是:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e前端ajax请求的是本地接口\x3c\/li\x3e\n\x3cli\x3e本地接口接收到请求后向实际的接口请求数据，然后再将信息返回给前端\x3c\/li\x3e\n\x3cli\x3e一般用node.js即可代理\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e关于如何实现代理，这里就不重点描述了，方法和多，也不难，基本都是基于node.js的。\x3c\/p\x3e\n\x3cp\x3e搜索关键字\x3ccode\x3enode.js\x3c\/code\x3e,\x3ccode\x3e代理请求\x3c\/code\x3e即可找到一大票的方案。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3eOPTIONS预检的优化\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Max-Age: \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eAccess-Control-Max-Age: \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个头部加上后，可以缓存此次请求的秒数。\x3c\/p\x3e\n\x3cp\x3e在这个时间范围内，所有同类型的请求都将不再发送预检请求而是直接使用此次返回的头作为判断依据。\x3c\/p\x3e\n\x3cp\x3e非常有用，可以大幅优化请求次数\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader11\x22\x3e如何分析ajax跨域\x3c\/h2\x3e\n\x3cp\x3e上述已经介绍了跨域的原理以及如何解决，但实际过程中，发现仍然有很多人对照着类似的文档无法解决跨域问题，主要体现在，前端人员不知道什么时候是跨域问题造成的，什么时候不是，因此这里稍微介绍下如何分析一个请求是否跨域:\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e抓包请求数据\x3c\/h3\x3e\n\x3cp\x3e第一步当然是得知道我们的ajax请求发送了什么数据，接收了什么，做到这一步并不难，也不需要\x3ccode\x3efiddler\x3c\/code\x3e等工具，仅基于\x3ccode\x3eChrome\x3c\/code\x3e即可\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ccode\x3eChrome\x3c\/code\x3e浏览器打开对应发生ajax的页面，\x3ccode\x3eF12\x3c\/code\x3e打开\x3ccode\x3eDev Tools\x3c\/code\x3e\n\x3c\/li\x3e\n\x3cli\x3e发送ajax请求\x3c\/li\x3e\n\x3cli\x3e右侧面板-\x26gt;\x3ccode\x3eNetWork\x3c\/code\x3e-\x26gt;\x3ccode\x3eXHR\x3c\/code\x3e，然后找到刚才的ajax请求，点进去\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch4\x3e示例一(正常的ajax请求)\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012469726?w=659\x26amp;h=884\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012469726?w=659\x26amp;h=884\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e上述请求是一个正确的请求，为了方便，我把每一个头域的意思都表明了，我们可以清晰的看到，接口返回的响应头域中，包括了\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Allow-Headers: X-Requested-With,Content-Type,Accept\nAccess-Control-Allow-Methods: Get,Post,Put,OPTIONS\nAccess-Control-Allow-Origin: *\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3eAccess-Control-Allow-Headers: X-Requested-With,Content-Type,Accept\nAccess-Control-Allow-Methods: Get,Post,Put,OPTIONS\nAccess-Control-Allow-Origin: *\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e所以浏览器接收到响应时，判断的是正确的请求，自然不会报错，成功的拿到了响应数据。\x3c\/p\x3e\n\x3ch4\x3e示例二(跨域错误的ajax请求)\x3c\/h4\x3e\n\x3cp\x3e为了方便，我们仍然拿上面的错误表现示例举例。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012469721?w=858\x26amp;h=426\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012469721?w=858\x26amp;h=426\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e这个请求中，接口Allow里面没有包括\x3ccode\x3eOPTIONS\x3c\/code\x3e，所以请求出现了跨域、\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012469722?w=1234\x26amp;h=806\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012469722?w=1234\x26amp;h=806\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e这个请求中，\x3ccode\x3eAccess-Control-Allow-Origin: *\x3c\/code\x3e出现了两次，导致了跨域配置没有正确配置，出现了错误。\x3c\/p\x3e\n\x3cp\x3e更多跨域错误基本都是类似的，就是以上三样没有满足(Headers,Allow,Origin)，这里不再一一赘述。\x3c\/p\x3e\n\x3ch4\x3e示例三(与跨域无关的ajax请求)\x3c\/h4\x3e\n\x3cp\x3e当然，也并不是所有的ajax请求错误都与跨域有关，所以请不要混淆，比如以下:\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012469727?w=656\x26amp;h=451\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012469727?w=656\x26amp;h=451\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000012469728?w=664\x26amp;h=157\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000012469728?w=664\x26amp;h=157\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e比如这个请求，它的跨域配置没有一点问题，它出错仅仅是因为request的\x3ccode\x3eAccept\x3c\/code\x3e和response的\x3ccode\x3eContent-Type\x3c\/code\x3e不匹配而已。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3e更多\x3c\/h3\x3e\n\x3cp\x3e基本上都是这样去分析一个ajax请求，通过\x3ccode\x3eChrome\x3c\/code\x3e就可以知道了发送了什么数据，收到了什么数据，然后再一一比对就知道问题何在了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader14\x22\x3e写在最后的话\x3c\/h2\x3e\n\x3cp\x3e跨域是一个老生常谈的话题，网上也有大量跨域的资料，并且有不少精品(比如阮一峰前辈的)，但是身为一个前端人员不应该浅尝而止，故而才有了本文。\x3c\/p\x3e\n\x3cp\x3e漫漫前端路，望与诸君共勉之！\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader15\x22\x3e附录\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader16\x22\x3e参考资料\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2016\/04\/same-origin-policy.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e浏览器同源政策及其规避方法(阮一峰)\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2016\/04\/cors.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e跨域资源共享 CORS 详解(阮一峰)\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/dailc\/p\/5893341.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e本人之前在cnblog上的文章\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader17\x22\x3e博客\x3c\/h3\x3e\n\x3cp\x3e初次发布\x3ccode\x3e2017.03.22\x3c\/code\x3e于个人博客\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3ca href=\x22http:\/\/www.dailichun.com\/2017\/03\/22\/ajaxCrossDomainSolution.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.dailichun.com\/2017\/03\/22\/ajaxCrossDomainSolution.html\x3c\/a\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>ajax跨域，这应该是最全的解决方案了</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000012469713">https://segmentfault.com/a/1190000012469713</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/vaj5jj7ve7/" target="_blank">https://alili.tech/archive/vaj5jj7ve7/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>