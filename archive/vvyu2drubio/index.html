<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="打造一个属于自己的server"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>打造一个属于自己的server | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/vvyu2drubio/",
				"appid": "1613049289050283", 
				"title": "打造一个属于自己的server | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-12T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/923oaegben6/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/wifazru14de/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fvvyu2drubio%2f&text=%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84server"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fvvyu2drubio%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fvvyu2drubio%2f&text=%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84server"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fvvyu2drubio%2f&title=%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84server"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fvvyu2drubio%2f&is_video=false&description=%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84server"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84server&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fvvyu2drubio%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fvvyu2drubio%2f&title=%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84server"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fvvyu2drubio%2f&title=%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84server"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fvvyu2drubio%2f&title=%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84server"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fvvyu2drubio%2f&title=%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e5%b1%9e%e4%ba%8e%e8%87%aa%e5%b7%b1%e7%9a%84server"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">打造一个属于自己的server</h1><div class="meta"><div class="postdate"><time datetime="2018-12-12" itemprop="datePublished">2018-12-12</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e什么是server\x3c\/h2\x3e\n\x3cp\x3e在开始打造自己的服务器之前,我们首先明确一下服务器的定义:一个管理资源并为用户提供服务的计算机软件。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e根据功能服务器分为两类\x3c\/h2\x3e\n\x3cblockquote\x3e\x3cul\x3e\n\x3cli\x3estatic web server,例如常见的nginx apache等等\x3c\/li\x3e\n\x3cli\x3edynamic web server,例如常见的tomcat,jboss,resin等等\x3c\/li\x3e\n\x3c\/ul\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e动静态服务器区别\x3c\/h2\x3e\n\x3cp\x3e对于静态服务器来说一般就是读取资源然后返回给browser;动态服务器意味着返回给browser的文件是经过逻辑处理动态产生的。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader3\x22\x3e服务器具有的功能特性\x3c\/h1\x3e\n\x3cblockquote\x3e\x3cul\x3e\x3cli\x3enginx,tomcat这个两个之前用过,也研究过,所以拿这两个举一下示例,不过现在很少用了,现在基本上都是使用node相关的,所以最后构建的serve会基于node。\x3c\/li\x3e\x3c\/ul\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3enginx\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3enginx特点\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cul\x3e\n\x3cli\x3e配置简单,灵活(只有一个主配置文件nginx.conf)\x3c\/li\x3e\n\x3cli\x3e支持高并发(静态小文件)\x3c\/li\x3e\n\x3cli\x3e占用资源相对较少(2w并发,开启10个线程,内存消耗只有几百M)\x3c\/li\x3e\n\x3cli\x3e功能种类多(例如proxy,cache,Log,Gzip等等)\x3c\/li\x3e\n\x3c\/ul\x3e\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3enginx应用场景\x3c\/h3\x3e\n\x3ch4\x3e静态服务器(图片,js,css等等)\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22server {\n        listen       8080;\n        server_name  localhost;\n\n        location \/ {\n            root   html;\n            index  index.html index.htm;\n        }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs nginx\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-section\x22\x3eserver\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-attribute\x22\x3elisten\x3c\/span\x3e       \x3cspan class=\x22hljs-number\x22\x3e8080\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-attribute\x22\x3eserver_name\x3c\/span\x3e  localhost;\n\n        \x3cspan class=\x22hljs-attribute\x22\x3elocation\x3c\/span\x3e \/ {\n            \x3cspan class=\x22hljs-attribute\x22\x3eroot\x3c\/span\x3e   html;\n            \x3cspan class=\x22hljs-attribute\x22\x3eindex\x3c\/span\x3e  index.html index.htm;\n        }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e说明\x3c\/strong\x3e 上面是nginx配置,指定访问根目录和默认主页,以及监听端口\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22➜  ~ clear\n➜  ~ curl -i  http:\/\/127.0.0.1:8080\nHTTP\/1.1 200 OK\nServer: nginx\/1.12.2 \/\/服务器类型和版本\nDate: Fri, 02 Mar 2018 08:49:44 GMT\nContent-Type: text\/html\nContent-Length: 11\nLast-Modified: Fri, 02 Mar 2018 08:46:27 GMT \/\/支持Last-Modified缓存机制\nConnection: keep-alive \/\/支持持久连接\nETag: \x26quot;5a990f63-b\x26quot;  \/\/支持ETag缓存机制\nAccept-Ranges: bytes \/\/ 支持断点续传\n\nhello  jsdt% \/\/响应体\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3e➜  ~ clear\n➜  ~ curl -i  \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/127.0.0.1:8080\x3c\/span\x3e\nHTTP\/\x3cspan class=\x22hljs-number\x22\x3e1.1\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e OK\n\x3cspan class=\x22hljs-string\x22\x3eServer:\x3c\/span\x3e nginx\x3cspan class=\x22hljs-regexp\x22\x3e\/1.12.2 \/\x3c\/span\x3e\/服务器类型和版本\n\x3cspan class=\x22hljs-string\x22\x3eDate:\x3c\/span\x3e Fri, \x3cspan class=\x22hljs-number\x22\x3e02\x3c\/span\x3e Mar \x3cspan class=\x22hljs-number\x22\x3e2018\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e08\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e49\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e44\x3c\/span\x3e GMT\nContent-\x3cspan class=\x22hljs-string\x22\x3eType:\x3c\/span\x3e text\/html\nContent-\x3cspan class=\x22hljs-string\x22\x3eLength:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e11\x3c\/span\x3e\nLast-\x3cspan class=\x22hljs-string\x22\x3eModified:\x3c\/span\x3e Fri, \x3cspan class=\x22hljs-number\x22\x3e02\x3c\/span\x3e Mar \x3cspan class=\x22hljs-number\x22\x3e2018\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e08\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e46\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e27\x3c\/span\x3e GMT \x3cspan class=\x22hljs-comment\x22\x3e\/\/支持Last-Modified缓存机制\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eConnection:\x3c\/span\x3e keep-alive \x3cspan class=\x22hljs-comment\x22\x3e\/\/支持持久连接\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eETag:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x225a990f63-b\x22\x3c\/span\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/\/支持ETag缓存机制\x3c\/span\x3e\nAccept-\x3cspan class=\x22hljs-string\x22\x3eRanges:\x3c\/span\x3e bytes \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 支持断点续传\x3c\/span\x3e\n\nhello  jsdt% \x3cspan class=\x22hljs-comment\x22\x3e\/\/响应体\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e说明\x3c\/strong\x3e  上面是本地测试请求,从响应头中可以看到支持很多功能\x3c\/p\x3e\n\x3ch4\x3e反向代理,负载均衡\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22https:\/\/img.wuage.com\/151998515776555server-jsdt-demo.png\x22 src=\x22https:\/\/static.alili.techhttps:\/\/img.wuage.com\/151998515776555server-jsdt-demo.png\x22 alt=\x22jsdt-server-demo\x22 title=\x22jsdt-server-demo\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e\x3cstrong\x3e说明\x3c\/strong\x3e  上面是试验效果\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 upstream  jsdt.com {  \n          server    127.0.0.1:8083  max_fails=3 fail_timeout=30s weight=1;\n          server    47.97.xxx.xxx:8084  max_fails=3 fail_timeout=30s  weight=2;  \/\/为了安全 隐藏真实ip地址\n      } \n    server {\n        listen       8080;\n        server_name  localhost; \n\n        location \/ {\n            root   html;\n           # index  index.html index.htm;\n            proxy_pass http:\/\/jsdt.com;  \n            proxy_redirect default;\n        }\n        error_page   500 502 503 504  \/50x.html;\n        location = \/50x.html {\n            root   html;\n        \x22}}\x22\n        \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs puppet\x22\x3e\x3ccode\x3e upstream  jsdt.\x3cspan class=\x22hljs-keyword\x22\x3ecom\x3c\/span\x3e {  \n          server    \x3cspan class=\x22hljs-number\x22\x3e127.0\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e8083\x3c\/span\x3e  max_fails=\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e fail_timeout=\x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3es weight=\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n          server    \x3cspan class=\x22hljs-number\x22\x3e47.97\x3c\/span\x3e.xxx.xxx:\x3cspan class=\x22hljs-number\x22\x3e8084\x3c\/span\x3e  max_fails=\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e fail_timeout=\x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3es  weight=\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;  \/\/为了安全 隐藏真实\x3cspan class=\x22hljs-literal\x22\x3eip\x3c\/span\x3e地址\n      } \n    \x3cspan class=\x22hljs-keyword\x22\x3eserver\x3c\/span\x3e {\n        listen       \x3cspan class=\x22hljs-number\x22\x3e8080\x3c\/span\x3e;\n        server_name  localhost; \n\n        location \/ {\n            \x3cspan class=\x22hljs-literal\x22\x3eroot\x3c\/span\x3e   html;\n           \x3cspan class=\x22hljs-comment\x22\x3e# index  index.html index.htm;\x3c\/span\x3e\n            proxy_pass http:\/\/jsdt.com;  \n            proxy_redirect \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e;\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3eerror_page\x3c\/span\x3e   500 502 503 504  \/50x.html;\n        location = \/50x.\x3cspan class=\x22hljs-keyword\x22\x3ehtml\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-literal\x22\x3eroot\x3c\/span\x3e   html;\n        \x22}}\x22\n        \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e说明\x3c\/strong\x3e  上面我摘取了关键的部分配置,采用了轮训\x2bweight算法,其它还有ip_hash、url_hash等算法。真实的应用情况,还需要考虑很多问题,例如集群的session同步,记得大学实习期间,当时公司用的是cookie\x2bmemcache集群的方案。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3etomcat\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3etomcat特点\x3c\/h3\x3e\n\x3cblockquote\x3etomcat运行在jvm上,跨平台,是一个Servlet容器(可以运行Servlet,编译jsp),实现了在http请求响应处理中所需要的http接口相关实现类。除此之外也支持虚拟主机,session共享,静态文件处理等等,只不过没那么专业而已。\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3etomcat应用场景\x3c\/h3\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22https:\/\/img.wuage.com\/152005445853060tomcat-jsdt.png\x22 src=\x22https:\/\/static.alili.techhttps:\/\/img.wuage.com\/152005445853060tomcat-jsdt.png\x22 alt=\x22tomcat-jsdt\x22 title=\x22tomcat-jsdt\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e\x3cstrong\x3e说明\x3c\/strong\x3e 如上所示,我们可以在页面中添加动态的处理逻辑,返回的数据根据用户可定制化(相比静态服务器优点),最终.jsp被tomcat编译为.java,然后被javac编译为通用字节码文件,最终运行在jvm上。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e如何实现一个自己的服务器\x3c\/h2\x3e\n\x3cblockquote\x3e在实现自己的服务器之前,首先我们明确一下server的本质,server属于应用层的协议,基于tcp的封装, 而tcp的应用实现是基于socket(无论是node,还是java都有socket)的封装。\x3cbr\x3esocket监听某个端口,获取面向流的数据data,我们的server所要做的就是对data进行解析封装,以使其符合http的规范。\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e接下来实现自己的静态server\x3c\/h3\x3e\n\x3cp\x3e因为有http模块,所以node当中实现一个基础server很简单。但是如果附加额外的功能,例如压缩,缓存,断点续传,反向代理什么的就需要自己添加了。\x3cbr\x3e接下来首先看一下项目结构,bin目录主要是放启动脚本相关的,主逻辑在app.js中,然后根据功能将代码拆分成不同的模块。templatet目录放置编译的原始模板。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22|____bin\n| |____.DS_Store\n| |____deamon.js\n| |____start\n| |____yargsConfig.js\n|____node_modules\n|____package-lock.json\n|____package.json\n|____readme.md\n|____src\n| |____.DS_Store\n| |____app.js\n| |____asset\n| |____cacheSupport.js\n| |____config.js\n| |____picGuard.js\n| |____template\n| |____util.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gherkin\x22\x3e\x3ccode\x3e|\x3cspan class=\x22hljs-string\x22\x3e____bin\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e \x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e____.DS_Store\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e \x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e____deamon.js\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e \x3c\/span\x3e|____start\n|\x3cspan class=\x22hljs-string\x22\x3e \x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e____yargsConfig.js\n\x3c\/span\x3e|____node_modules\n|\x3cspan class=\x22hljs-string\x22\x3e____package-lock.json\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e____package.json\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e____readme.md\n\x3c\/span\x3e|____src\n|\x3cspan class=\x22hljs-string\x22\x3e \x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e____.DS_Store\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e \x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e____app.js\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e \x3c\/span\x3e|____asset\n|\x3cspan class=\x22hljs-string\x22\x3e \x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e____cacheSupport.js\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e \x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e____config.js\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e \x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e____picGuard.js\n\x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e \x3c\/span\x3e|____template\n|\x3cspan class=\x22hljs-string\x22\x3e \x3c\/span\x3e|\x3cspan class=\x22hljs-string\x22\x3e____util.js\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在server运行前,首先我们通过yargs模块获取解析好的命令行参数。如下所示\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if(argv.D){\n    let sp = cp.spawn(process.execPath, [\x27deamon.js\x27],{\n        cwd: __dirname,\n        stdio: [\x27ignore\x27,\x27ignore\x27,\x27ignore\x27],\n        env: argv,\n        detached: true  \/\/http:\/\/nodejs.cn\/api\/child_process.html#child_process_child_process_spawn_command_args_options\n    } )\n    sp.unref()\n} else {\n    let config = Object.assign({}, defautConfig, argv)\n    let server = new Server(config);\n    server.start();\n    console.log(\x27server already started\x27)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(argv.D){\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e sp = cp.spawn(process.execPath, [\x3cspan class=\x22hljs-string\x22\x3e\x27deamon.js\x27\x3c\/span\x3e],{\n        \x3cspan class=\x22hljs-attr\x22\x3ecwd\x3c\/span\x3e: __dirname,\n        \x3cspan class=\x22hljs-attr\x22\x3estdio\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27ignore\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27ignore\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27ignore\x27\x3c\/span\x3e],\n        \x3cspan class=\x22hljs-attr\x22\x3eenv\x3c\/span\x3e: argv,\n        \x3cspan class=\x22hljs-attr\x22\x3edetached\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/\/http:\/\/nodejs.cn\/api\/child_process.html#child_process_child_process_spawn_command_args_options\x3c\/span\x3e\n    } )\n    sp.unref()\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e config = \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.assign({}, defautConfig, argv)\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e server = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Server(config);\n    server.start();\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27server already started\x27\x3c\/span\x3e)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e说明\x3c\/strong\x3e  如果开启deamon模式,则通过子进程的方式让服务在后台运行,反之则直接启动server实例\x3c\/p\x3e\n\x3cp\x3e在启动server之后,开始接受并处理请求,下面以断点续传功能模块作为示例\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function byteRangeStream(req, res, filepath, statObj) {\n    let start = 0\n    let end = statObj.size-1\n    let range = req.headers[\x27range\x27]\n    if (range){\n        res.setHeader(\x27Accept-Range\x27,\x27bytes\x27)\n        res.statusCode = 206 \/\/a part of content\n        let result = range.match(\/bytes=(\\d*)-(\\d*)\/);\n        if (result) {\n            start = isNaN(result[1]) ? start : parseInt(result[1]);\n            end = isNaN(result[2]) ? end : parseInt(result[2]) - 1;\n        }\n    }\n    return fs.createReadStream(filepath,{\n        start,\n        end\n    })\n}\nmodule.exports ={\n    byteRangeStream\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs nimrod\x22\x3e\x3ccode\x3efunction byteRangeStream(req, res, filepath, statObj) {\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e start = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eend\x3c\/span\x3e = statObj.size-\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3erange\x3c\/span\x3e = req.headers[\x27\x3cspan class=\x22hljs-built_in\x22\x3erange\x3c\/span\x3e\x27]\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3erange\x3c\/span\x3e){\n        res.setHeader(\x27\x3cspan class=\x22hljs-type\x22\x3eAccept\x3c\/span\x3e-\x3cspan class=\x22hljs-type\x22\x3eRange\x3c\/span\x3e\x27,\x27bytes\x27)\n        res.statusCode = \x3cspan class=\x22hljs-number\x22\x3e206\x3c\/span\x3e \/\/a part \x3cspan class=\x22hljs-keyword\x22\x3eof\x3c\/span\x3e content\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3eresult\x3c\/span\x3e = \x3cspan class=\x22hljs-built_in\x22\x3erange\x3c\/span\x3e.match(\/bytes=(\\d*)-(\\d*)\/);\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-literal\x22\x3eresult\x3c\/span\x3e) {\n            start = isNaN(\x3cspan class=\x22hljs-literal\x22\x3eresult\x3c\/span\x3e[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e]) ? start : parseInt(\x3cspan class=\x22hljs-literal\x22\x3eresult\x3c\/span\x3e[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e]);\n            \x3cspan class=\x22hljs-keyword\x22\x3eend\x3c\/span\x3e = isNaN(\x3cspan class=\x22hljs-literal\x22\x3eresult\x3c\/span\x3e[\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e]) ? \x3cspan class=\x22hljs-keyword\x22\x3eend\x3c\/span\x3e : parseInt(\x3cspan class=\x22hljs-literal\x22\x3eresult\x3c\/span\x3e[\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e]) - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n        }\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e fs.createReadStream(filepath,{\n        start,\n        \x3cspan class=\x22hljs-keyword\x22\x3eend\x3c\/span\x3e\n    })\n}\nmodule.exports ={\n    byteRangeStream\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e说明\x3c\/strong\x3e 在主模块app.js中,导入上述模块,如代码中所示首先判断客户端是否支持断点续传,依据range请求头,如果有请求范围,直接返回请求范围内的数据,否则全部读取返回,靠的是browser和server的协商机制,需要双方都支持才能完成整个过程。\x3cbr\x3e更多功能模块可以参考我的\x3ca href=\x22https:\/\/github.com\/gcyStar\/server-cli\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3egithub\x3c\/a\x3e, 欢迎star。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader12\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e写这篇文章,总结了下server的相关知识,参考了之前大学时做的笔记,看到之前做的记录,回忆当时在学校学习和公司实习的经历,感慨万千。时光易逝,做好当下的自己。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>打造一个属于自己的server</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000013501940">https://segmentfault.com/a/1190000013501940</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/vvyu2drubio/" target="_blank">https://alili.tech/archive/vvyu2drubio/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>