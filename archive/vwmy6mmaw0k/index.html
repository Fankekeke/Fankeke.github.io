<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="说点Angular Cli打包的事"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>说点Angular Cli打包的事 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/vwmy6mmaw0k/",
				"appid": "1613049289050283", 
				"title": "说点Angular Cli打包的事 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-02T02:30:09"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/2scu7p55bb9/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/7euugcip813/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fvwmy6mmaw0k%2f&text=%e8%af%b4%e7%82%b9Angular%20Cli%e6%89%93%e5%8c%85%e7%9a%84%e4%ba%8b"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fvwmy6mmaw0k%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fvwmy6mmaw0k%2f&text=%e8%af%b4%e7%82%b9Angular%20Cli%e6%89%93%e5%8c%85%e7%9a%84%e4%ba%8b"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fvwmy6mmaw0k%2f&title=%e8%af%b4%e7%82%b9Angular%20Cli%e6%89%93%e5%8c%85%e7%9a%84%e4%ba%8b"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fvwmy6mmaw0k%2f&is_video=false&description=%e8%af%b4%e7%82%b9Angular%20Cli%e6%89%93%e5%8c%85%e7%9a%84%e4%ba%8b"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e8%af%b4%e7%82%b9Angular%20Cli%e6%89%93%e5%8c%85%e7%9a%84%e4%ba%8b&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fvwmy6mmaw0k%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fvwmy6mmaw0k%2f&title=%e8%af%b4%e7%82%b9Angular%20Cli%e6%89%93%e5%8c%85%e7%9a%84%e4%ba%8b"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fvwmy6mmaw0k%2f&title=%e8%af%b4%e7%82%b9Angular%20Cli%e6%89%93%e5%8c%85%e7%9a%84%e4%ba%8b"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fvwmy6mmaw0k%2f&title=%e8%af%b4%e7%82%b9Angular%20Cli%e6%89%93%e5%8c%85%e7%9a%84%e4%ba%8b"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fvwmy6mmaw0k%2f&title=%e8%af%b4%e7%82%b9Angular%20Cli%e6%89%93%e5%8c%85%e7%9a%84%e4%ba%8b"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">说点Angular Cli打包的事</h1><div class="meta"><div class="postdate"><time datetime="2019-01-02" itemprop="datePublished">2019-01-02</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e一、引言\x3c\/h1\x3e\n\x3cp\x3eAngular从开发再到生产环境部署都离不开Angular Cli工具集，而Angular Cli本质上是使用 Webpack（当前使用版本为3） 来打包资源。\x3c\/p\x3e\n\x3cp\x3eWebpack 本身并不复杂，略用过一点都清楚，只需要创建一个 \x3ccode\x3ewebpack.config.js\x3c\/code\x3e 的文件并简单的配置，就可以把一个复杂的应用所有文件全部打包成若干静态资源文件。\x3c\/p\x3e\n\x3cp\x3e然而一个复杂的应用免不了使用到第三方类库，当这些外部类库与自身业务脚本联系在一起时，就产生一个大家都关心的问题：\x3cstrong\x3e性能优化\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3eAngular Cli在构建一个含有路由、表单、HTTP等基本的Angular应用大约在150KB左右，就Angular体量而言，自己写一个 Webpack 也很难能优化到这个大小。所以说，Angular Cli是很有良心的作品。然而极大的简化对 Webpack 的使用，何乐不为呢？\x3c\/p\x3e\n\x3cp\x3e本文我将介绍Angular Cli的一些配置在生产环境中所产生的效果，希望能让大家由于一些不合理的行为可能会导致文件体量的上升在改善这一问题时有所帮助。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3e二、\x3ccode\x3e.angular-cli.json\x3c\/code\x3e 配置\x3c\/h1\x3e\n\x3cp\x3eAngular Cli 的配置文件是根目录下的 \x3ccode\x3e.angular-cli.json\x3c\/code\x3e，而会影响文件体量的只有 \x3ccode\x3estyles\x3c\/code\x3e、\x3ccode\x3escripts\x3c\/code\x3e 两个节点。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e1、scripts\x3c\/h2\x3e\n\x3cp\x3e\x3ccode\x3escripts\x3c\/code\x3e 节点最后会生成一个独立的 \x3ccode\x3escripts.bundle.js\x3c\/code\x3e 文件，一般我们会把一些外部非Angular组件的类库放置在这里，比如：\x3ccode\x3ejQuery\x3c\/code\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;scripts\x26quot;: [\n    \x26quot;..\/node_modules\/jquery\/dist\/jquery.js\x26quot;,\n    \x26quot;..\/test.ts\x26quot;\n]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22json hljs\x22\x3e\x3ccode class=\x22json\x22\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22scripts\x22\x3c\/span\x3e: [\n    \x3cspan class=\x22hljs-string\x22\x3e\x22..\/node_modules\/jquery\/dist\/jquery.js\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22..\/test.ts\x22\x3c\/span\x3e\n]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3e\x3ccode\x3escripts\x3c\/code\x3e 节点还允许 \x3ccode\x3e*.ts\x3c\/code\x3e 文件。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e2、styles\x3c\/h2\x3e\n\x3cp\x3e\x3ccode\x3estyles\x3c\/code\x3e 节点最后会生成一个独立的 \x3ccode\x3estyles.bundle.css\x3c\/code\x3e 文件。除此之外，组件内（\x3ccode\x3estyles\x3c\/code\x3e 或 \x3ccode\x3estyleUrls\x3c\/code\x3e）的样式会全部打包进 \x3ccode\x3e.js\x3c\/code\x3e 文件中。\x3c\/p\x3e\n\x3cp\x3e正如 jQuery 一样，如果我们需要引用第三方UI库，比如：\x3ccode\x3ebootstrap\x3c\/code\x3e 那么：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;styles\x26quot;: [\n    \x26quot;..\/node_modules\/bootstrap\/scss\/bootstrap.scss\x26quot;,\n    \x26quot;styles.scss\x26quot;\n]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22json hljs\x22\x3e\x3ccode class=\x22json\x22\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22styles\x22\x3c\/span\x3e: [\n    \x3cspan class=\x22hljs-string\x22\x3e\x22..\/node_modules\/bootstrap\/scss\/bootstrap.scss\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22styles.scss\x22\x3c\/span\x3e\n]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e默认情况引用的是 \x3ccode\x3e.\/src\/styles.scss\x3c\/code\x3e，你可以继续导入外部其它外部样式文件。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@import \x26quot;variables\x26quot;;\n@import \x26quot;nav\x26quot;;\n@import \x26quot;layout\x26quot;;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22scss hljs\x22\x3e\x3ccode class=\x22scss\x22\x3e@\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22variables\x22\x3c\/span\x3e;\n@\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22nav\x22\x3c\/span\x3e;\n@\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22layout\x22\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e组件类样式\x3c\/h3\x3e\n\x3cp\x3eAngular组件内使用 \x3ccode\x3estyles\x3c\/code\x3e 或 \x3ccode\x3estyleUrls\x3c\/code\x3e 的样式会全部打包进相应模块的 \x3ccode\x3e.js\x3c\/code\x3e 文件中；并且样式生成存储的方式是无法改变的。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e\x3ccode\x3eencapsulation\x3c\/code\x3e\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e顺带提一下。既然是Angular组件，如果说此时还需要外部的样式这显得有点框住组件\x3cstrong\x3e独立性\x3c\/strong\x3e的特点，然而组件样式是否污染其它组件呢？我们通过指定 \x3ccode\x3eencapsulation\x3c\/code\x3e 样式封装方式来改变这一些行为，它包括三个值：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ccode\x3eViewEncapsulation.Emulated\x3c\/code\x3e 默认，采用额外添加一些 \x3ccode\x3e_ngcontent\x3c\/code\x3e 属性来限定样式隔离\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eViewEncapsulation.Native\x3c\/code\x3e 采用Shadow Dom隔离方式\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eViewEncapsulation.None\x3c\/code\x3e 不隔离\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch1 id=\x22articleHeader5\x22\x3e三、\x3ccode\x3eng build\x3c\/code\x3e 指令\x3c\/h1\x3e\n\x3cp\x3eAngular Cli 会根据 \x3ccode\x3e.angular-cli.json\x3c\/code\x3e 配置（\x3ccode\x3eapps\/root\x3c\/code\x3e、\x3ccode\x3eapps\/main\x3c\/code\x3e）决定从哪里开始启动。因此，当执行：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ng build --prod  --build-optimizer\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22bash hljs\x22\x3e\x3ccode class=\x22bash\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eng build --prod  --build-optimizer\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3e\x3ccode\x3e--build-optimizer\x3c\/code\x3e 从 \x3ccode\x3e1.3.0-rc.5\x3c\/code\x3e 才开始支持。相比较之前 Cli 版本，Tree-Shaking 力度更大，当然相应的文件大小也更轻。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e会从根模块开始逐一对每一个模块进行打包，并保存在每一个文件当中。若采用路由迟延加载模块的话，会在 \x3ccode\x3einline.js\x3c\/code\x3e 中加上相应的动态加载脚本代码。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e1、文件名哈希\x3c\/h2\x3e\n\x3cp\x3eAngular Cli 提供了 \x3ccode\x3e--output-hashing\x3c\/code\x3e 参数，来指定文件名哈希模式，它包括四种：\x3c\/p\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth\x3e模式\x3c\/th\x3e\n\x3cth\x3e说明\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x3ccode\x3enone\x3c\/code\x3e\x3c\/td\x3e\n\x3ctd\x3e不哈希\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x3ccode\x3eall\x3c\/code\x3e\x3c\/td\x3e\n\x3ctd\x3e所有（若 \x3ccode\x3e--prod\x3c\/code\x3e 时默认）\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x3ccode\x3emedia\x3c\/code\x3e\x3c\/td\x3e\n\x3ctd\x3e限资源文件\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e\x3ccode\x3ebundles\x3c\/code\x3e\x3c\/td\x3e\n\x3ctd\x3e限webpack打包后的js文件\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3cp\x3e\x3cstrong\x3e注意：\x3c\/strong\x3e这里并不会哈希 \x3ccode\x3eassets\x3c\/code\x3e 文件夹，因为该文件夹采用是直接复制的形式。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e2、指定输出\x3c\/h2\x3e\n\x3cp\x3eAngular应用很多时候可能是放在现有WEB服务的某个目录下（例如：\x3ccode\x3ev2\x3c\/code\x3e），因此，访问地址会变成：\x3ccode\x3ehttps:\/\/www.demo.com\/v2\x3c\/code\x3e。但会发现，无法加载应用；这是由 \x3ccode\x3eindex.html\x3c\/code\x3e 会包括一句：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cbase href=\x26quot;\/\x26quot;\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebase\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ehref\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e倒置所有脚本资源的加载URL指向根目录。Angular Cli 提供一个参数改变该值。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ng build --prod --bh \/v2\/\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22bash hljs\x22\x3e\x3ccode class=\x22bash\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eng build --prod --bh \/v2\/\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3e往往在开发过程中总需要依赖一些图片资源的访问，倘若在代码中采用绝对路径，那就懵逼了，所以\x3cstrong\x3e建议不要在代码中使用绝对路径访问资源文件\x3c\/strong\x3e。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch1 id=\x22articleHeader8\x22\x3e四、优化方式\x3c\/h1\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e1、输出包体组成分析文件\x3c\/h2\x3e\n\x3cp\x3eWebpack 有一个非常好用的工具叫 \x3ca href=\x22https:\/\/www.npmjs.com\/package\/webpack-bundle-analyzer\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack-bundle-analyzer\x3c\/a\x3e，会自动分析包体组成结构，并以一种可视化的方式显示。\x3c\/p\x3e\n\x3cp\x3e首先，生成 \x3ccode\x3estats.json\x3c\/code\x3e 包体组成结构的统计文件。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ng build --prod --stats-json\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22bash hljs\x22\x3e\x3ccode class=\x22bash\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eng build --prod --stats-json\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最后访问 \x3ca href=\x22https:\/\/webpack.github.io\/analyse\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack analyse\x3c\/a\x3e 导入生成的JSON文件即可。\x3c\/p\x3e\n\x3cp\x3e利用可视化的视觉可以了解一些优化的细节。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e2、Rollup 摇树优化\x3c\/h2\x3e\n\x3cp\x3e所谓Rollup是指Webpack2会把那些应用中未使用的引用代码除掉，\x3cstrong\x3e但不会删除这些代码\x3c\/strong\x3e，所以就需要配合 UglifyJs 能够智能的移除这些未使用的代码。从而减少包体大小。\x3c\/p\x3e\n\x3cp\x3e而Agnular应用是基于Typescript，因此Angular Cli提供了一个叫 \x3ca href=\x22https:\/\/github.com\/angular\/devkit\/tree\/master\/packages\/angular_devkit\/build_optimizer\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAngular Build Optimizer\x3c\/a\x3e 插件，将 Typescript 编译结果转化成更友好的UglifyJs版本。这样UglifyJs就能够更有效的移除那些未使用的代码。\x3c\/p\x3e\n\x3cp\x3eAngular Cli只需要加上 \x3ccode\x3e--build-optimizer\x3c\/code\x3e 参数就可以，在一些情况下压缩的还是很厉害的。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ng build --prod --build-optimizer\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22bash hljs\x22\x3e\x3ccode class=\x22bash\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3eng build --prod --build-optimizer\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader11\x22\x3e3、导出Webpack配置\x3c\/h2\x3e\n\x3cp\x3eAngular Cli 是基于 Webpack 封闭的一个Angular命令行工具，但并不表示我们无法了解细节。\x3c\/p\x3e\n\x3cp\x3eWebpack 的核心是 \x3ccode\x3ewebpack.config.js\x3c\/code\x3e 文件，然后 Angular Cli 构建的项目并看不到该文件。\x3c\/p\x3e\n\x3cp\x3e但是可以透过 \x3ccode\x3eng eject\x3c\/code\x3e （更多细节见\x3ca href=\x22https:\/\/github.com\/angular\/angular-cli\/wiki\/eject\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewiki\x3c\/a\x3e） 转化成 Webapck 项目所需要的配置文件与运行配置指令。这时候会在根目录产生 \x3ccode\x3ewebpack.config.js\x3c\/code\x3e 文件。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e不过\x3c\/strong\x3e，同时也会改变了 \x3ccode\x3epackage.json\x3c\/code\x3e 与 \x3ccode\x3e.angular-cli.json\x3c\/code\x3e 的一些配置，若你只想查看 Webpack 配置信息，可以还原这些配置即可。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader12\x22\x3e结论\x3c\/h1\x3e\n\x3cp\x3e本文只是日常做一次总结，都是一些网络中可以查阅到的知识，并无新意。而上面所有 Angular Cli 相关命令，都可以在 \x3ca href=\x22https:\/\/github.com\/angular\/angular-cli\/wiki\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eWiki\x3c\/a\x3e 都有相应的描述。\x3c\/p\x3e\n\x3cp\x3eHappy coding!\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>说点Angular Cli打包的事</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010981919">https://segmentfault.com/a/1190000010981919</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/vwmy6mmaw0k/" target="_blank">https://alili.tech/archive/vwmy6mmaw0k/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>