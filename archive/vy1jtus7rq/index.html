<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="前端也要学系列：设计模式之策略模式"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>前端也要学系列：设计模式之策略模式 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/vy1jtus7rq/",
				"appid": "1613049289050283", 
				"title": "前端也要学系列：设计模式之策略模式 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-11-29T09:34:56"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/8888ci8m3pg/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/66j6pgp9jne/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fvy1jtus7rq%2f&text=%e5%89%8d%e7%ab%af%e4%b9%9f%e8%a6%81%e5%ad%a6%e7%b3%bb%e5%88%97%ef%bc%9a%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%e4%b9%8b%e7%ad%96%e7%95%a5%e6%a8%a1%e5%bc%8f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fvy1jtus7rq%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fvy1jtus7rq%2f&text=%e5%89%8d%e7%ab%af%e4%b9%9f%e8%a6%81%e5%ad%a6%e7%b3%bb%e5%88%97%ef%bc%9a%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%e4%b9%8b%e7%ad%96%e7%95%a5%e6%a8%a1%e5%bc%8f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fvy1jtus7rq%2f&title=%e5%89%8d%e7%ab%af%e4%b9%9f%e8%a6%81%e5%ad%a6%e7%b3%bb%e5%88%97%ef%bc%9a%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%e4%b9%8b%e7%ad%96%e7%95%a5%e6%a8%a1%e5%bc%8f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fvy1jtus7rq%2f&is_video=false&description=%e5%89%8d%e7%ab%af%e4%b9%9f%e8%a6%81%e5%ad%a6%e7%b3%bb%e5%88%97%ef%bc%9a%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%e4%b9%8b%e7%ad%96%e7%95%a5%e6%a8%a1%e5%bc%8f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%89%8d%e7%ab%af%e4%b9%9f%e8%a6%81%e5%ad%a6%e7%b3%bb%e5%88%97%ef%bc%9a%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%e4%b9%8b%e7%ad%96%e7%95%a5%e6%a8%a1%e5%bc%8f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fvy1jtus7rq%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fvy1jtus7rq%2f&title=%e5%89%8d%e7%ab%af%e4%b9%9f%e8%a6%81%e5%ad%a6%e7%b3%bb%e5%88%97%ef%bc%9a%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%e4%b9%8b%e7%ad%96%e7%95%a5%e6%a8%a1%e5%bc%8f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fvy1jtus7rq%2f&title=%e5%89%8d%e7%ab%af%e4%b9%9f%e8%a6%81%e5%ad%a6%e7%b3%bb%e5%88%97%ef%bc%9a%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%e4%b9%8b%e7%ad%96%e7%95%a5%e6%a8%a1%e5%bc%8f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fvy1jtus7rq%2f&title=%e5%89%8d%e7%ab%af%e4%b9%9f%e8%a6%81%e5%ad%a6%e7%b3%bb%e5%88%97%ef%bc%9a%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%e4%b9%8b%e7%ad%96%e7%95%a5%e6%a8%a1%e5%bc%8f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fvy1jtus7rq%2f&title=%e5%89%8d%e7%ab%af%e4%b9%9f%e8%a6%81%e5%ad%a6%e7%b3%bb%e5%88%97%ef%bc%9a%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f%e4%b9%8b%e7%ad%96%e7%95%a5%e6%a8%a1%e5%bc%8f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">前端也要学系列：设计模式之策略模式</h1><div class="meta"><div class="postdate"><time datetime="2018-11-29" itemprop="datePublished">2018-11-29</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e做前端开发已经好几年了，对设计模式一直没有深入学习总结过。随着架构相关的工作越来越多，越来越能感觉到设计模式成为了我前进道路上的一个阻碍。所以从今天开始深入学习和总结经典的设计模式以及面向对象的几大原则。\x3c\/blockquote\x3e\n\x3cp\x3e今天第一天，首先来讲策略模式。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3e什么是策略模式？\x3c\/h1\x3e\n\x3cp\x3eGoF四兄弟的经典《设计模式》中，对策略模式的定义如下：\x3c\/p\x3e\n\x3cblockquote\x3e定义一系列的算法，把它们一个个封装起来，并且使它们可互相替换。\x3c\/blockquote\x3e\n\x3cp\x3e上边这句话，从字面来看很简单。但是如何在开发过程中去应用，仅凭一个定义依然是一头雾水。以笔者曾经做过的商户进销存系统为例：\x3c\/p\x3e\n\x3cblockquote\x3e某超市准备举行促销活动，市场人员经过调查分析制定了一些促销策略：\x3c\/blockquote\x3e\n\x3col\x3e\n\x3cli\x3e购物满100减10\x3c\/li\x3e\n\x3cli\x3e购物满200减30\x3c\/li\x3e\n\x3cli\x3e购物满300减50\x3c\/li\x3e\n\x3cli\x3e。。。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e收银软件的界面是这样的（简单示意）：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVba6Vy?w=368\x26amp;h=653\x22 src=\x22https:\/\/static.alili.tech\/img\/bVba6Vy?w=368\x26amp;h=653\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e我们应该如何计算实际消费金额？\x3c\/p\x3e\n\x3cp\x3e最初的实现是这样的：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/方便起见，我们把各个促销策略定义为枚举值：0,1,2...\nvar getActualTotal = function(onSaleType,originTotal){\n    if(onSaleType===0){\n        return originTotal-Math.floor(originTotal\/100)*10\n    }\n    if(onSaleType===1){\n        return originTotal-Math.floor(originTotal\/200)*30\n    }\n    if(onSaleType===0){\n        return originTotal-Math.floor(originTotal\/300)*50\n    }\n}\n\ngetActualTotal(1,2680); \/\/2208\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/方便起见，我们把各个促销策略定义为枚举值：0,1,2...\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e getActualTotal = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eonSaleType,originTotal\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(onSaleType===\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e){\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e originTotal-\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(originTotal\/\x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e)*\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(onSaleType===\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e){\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e originTotal-\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(originTotal\/\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e)*\x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(onSaleType===\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e){\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e originTotal-\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(originTotal\/\x3cspan class=\x22hljs-number\x22\x3e300\x3c\/span\x3e)*\x3cspan class=\x22hljs-number\x22\x3e50\x3c\/span\x3e\n    }\n}\n\ngetActualTotal(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e2680\x3c\/span\x3e); \x3cspan class=\x22hljs-comment\x22\x3e\/\/2208\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面这段代码很简单，而且缺点也很明显。随着我的满减策略逐渐增多，\x3ccode\x3egetActualTotal\x3c\/code\x3e函数会越变越大，而且充满了\x3ccode\x3eif\x3c\/code\x3e判断，稍一疏忽就容易弄错。\x3c\/p\x3e\n\x3cp\x3eOK，有人说我很懒，虽然这样不够优雅但并不影响我的使用，毕竟满减策略再多也多不到哪去。\x3cbr\x3e我只能说，需求永远不是程序员定的。。这时，市场人员说我们新版程序添加了会员功能，我们需要支持以下的促销策略：\x3c\/p\x3e\n\x3cblockquote\x3e会员促销策略：\x3c\/blockquote\x3e\n\x3col\x3e\n\x3cli\x3e会员充300返60，且首单打9折\x3c\/li\x3e\n\x3cli\x3e会员充500返100，且首单打8折\x3c\/li\x3e\n\x3cli\x3e会员充1000返300，且首单打7折\x3c\/li\x3e\n\x3cli\x3e...\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e这个时候，如果你还在原先的\x3ccode\x3egetActualTotal\x3c\/code\x3e函数中继续添加\x3ccode\x3eif\x3c\/code\x3e判断，我想如果你的领导review你这段代码，可能会怀疑自己当初怎么把你招进来。。\x3c\/p\x3e\n\x3cp\x3eOK，我们终于下定决心要重构促销策略的代码，我们可以这么做：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var vipPolicy_0=function(originTotal){\n    return originTotal-Math.floor(originTotal\/100)*10\n}\nvar vipPolicy_1=function(originTotal){\n    return originTotal-Math.floor(originTotal\/200)*30\n}\n...\n\/\/会员充1000返300\nvar vipPolicy_10=function(account,originTotal){\n    if(account===0){\n        account\x2b=1300;\n        return originTotal*0.9\n    }else{\n        account\x2b=1300;\n        return originTotal;\n    }\n    return originTotal-Math.floor(originTotal\/200)*30\n}\n...\nvar vipPolicy_n=function(){\n    ...\n}\n\nvar getActualTotal=function(onSaleType,originTotal,account){\n    switch(onSaleType){\n        case 0:\n            return vipPolicy_0(originTotal);\n        case 1:\n            return vipPolicy_0(originTotal);\n        ...\n        case n:\n            return ...\n        default:\n            return originTotal;\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e vipPolicy_0=\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eoriginTotal\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e originTotal-\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(originTotal\/\x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e)*\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e vipPolicy_1=\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eoriginTotal\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e originTotal-\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(originTotal\/\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e)*\x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e\n}\n...\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/会员充1000返300\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e vipPolicy_10=\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eaccount,originTotal\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(account===\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e){\n        account\x2b=\x3cspan class=\x22hljs-number\x22\x3e1300\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e originTotal*\x3cspan class=\x22hljs-number\x22\x3e0.9\x3c\/span\x3e\n    }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n        account\x2b=\x3cspan class=\x22hljs-number\x22\x3e1300\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e originTotal;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e originTotal-\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(originTotal\/\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e)*\x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e\n}\n...\nvar vipPolicy_n=\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    ...\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e getActualTotal=\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eonSaleType,originTotal,account\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e(onSaleType){\n        \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e:\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e vipPolicy_0(originTotal);\n        \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e:\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e vipPolicy_0(originTotal);\n        ...\n        case n:\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e ...\n        default:\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e originTotal;\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e好了，现在我们每种策略都有自己独立的空间了，看起来井井有条。但是还有两个问题没有解决：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e随着促销策略的增加，\x3ccode\x3egetActualTotal\x3c\/code\x3e的代码量依然会越来越大\x3c\/li\x3e\n\x3cli\x3e系统缺乏弹性，如果需要增加一种策略，那么除了添加一个策略函数，还需要修改\x3ccode\x3eswitch...case..\x3c\/code\x3e语句\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e让我们再来回顾一下策略模式的定义：\x3c\/p\x3e\n\x3cblockquote\x3e定义一系列的算法，把它们一个个封装起来，并且使它们可互相替换\x3c\/blockquote\x3e\n\x3cp\x3e在我们的例子中，每种促销策略的实现方式是不一样的，但我们最终的目的都是为了求得实际金额。策略模式可以把我们对促销策略的算法一个个封装起来，并且使它们可互相替换而不影响我们对实际金额的求值，这正好是我们所需要的。\x3c\/p\x3e\n\x3cp\x3e下面我们用策略模式来重构上面的代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var policies={\n    \x26quot;Type_0\x26quot;:function(originTotal){\n        return originTotal-Math.floor(originTotal\/100)*10 \n    },\n    \x26quot;Type_1\x26quot;:function(originTotal){\n        return originTotal-Math.floor(originTotal\/200)*30 \n    },\n    ...\n    \x26quot;Type_n\x26quot;:function(originTotal){\n        ... \n    }\n}\n\nvar getActualTotal=function(onSaleType,originTotal,account){\n    return policies[\x26quot;Type_\x26quot;\x2bonSaleType](originTotal,account)\n}\n\/\/执行\ngetActualTotal(0,2680.00);\/\/2208\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e policies={\n    \x3cspan class=\x22hljs-string\x22\x3e\x22Type_0\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eoriginTotal\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e originTotal-\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(originTotal\/\x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e)*\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e \n    },\n    \x3cspan class=\x22hljs-string\x22\x3e\x22Type_1\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eoriginTotal\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e originTotal-\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(originTotal\/\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e)*\x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e \n    },\n    ...\n    \x3cspan class=\x22hljs-string\x22\x3e\x22Type_n\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eoriginTotal\x3c\/span\x3e)\x3c\/span\x3e{\n        ... \n    }\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e getActualTotal=\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eonSaleType,originTotal,account\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e policies[\x3cspan class=\x22hljs-string\x22\x3e\x22Type_\x22\x3c\/span\x3e\x2bonSaleType](originTotal,account)\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/执行\x3c\/span\x3e\ngetActualTotal(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e2680.00\x3c\/span\x3e);\x3cspan class=\x22hljs-comment\x22\x3e\/\/2208\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e分析上面的代码我们发现，不管促销策略如何增加，\x3ccode\x3egetActualTotal\x3c\/code\x3e函数完全不需要再变化了。我们要做的，就是增加新策略的函数而已。\x3c\/p\x3e\n\x3cp\x3e通过策略模式的代码，我们消除了让人反胃的大片条件分支语句，\x3ccode\x3egetActualTotal\x3c\/code\x3e本身并没有计算能力，而是将计算全权委托给了策略函数。\x3c\/p\x3e\n\x3cp\x3e由此我们可以总结出策略模式实现的要点：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e将变化的算法封装成独立的策略函数，并负责具体的计算\x3c\/li\x3e\n\x3cli\x3e委托函数，该函数接受客户请求，并将请求委托给某一个具体的策略函数\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e用一张UML图表示如下：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVba6Vz?w=524\x26amp;h=295\x22 src=\x22https:\/\/static.alili.tech\/img\/bVba6Vz?w=524\x26amp;h=295\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e怎么样？现在看到上面这张图是不是有了了然于胸的感觉？那就赶紧去试一试策略模式吧！\x3c\/p\x3e\n\x3chr\x3e\n\x3cp\x3e参考书籍：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cem\x3e《设计模式：可复用面向对象软件的基础》\x3c\/em\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cem\x3e《大话设计模式》\x3c\/em\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cem\x3e《Javascript设计模式与开发实践》\x3c\/em\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>前端也要学系列：设计模式之策略模式</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000015002235">https://segmentfault.com/a/1190000015002235</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/vy1jtus7rq/" target="_blank">https://alili.tech/archive/vy1jtus7rq/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>