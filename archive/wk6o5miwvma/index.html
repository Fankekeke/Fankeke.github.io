<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="为什么0.1&#43;0.2不等于0.3"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>为什么0.1&#43;0.2不等于0.3 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/wk6o5miwvma/",
				"appid": "1613049289050283", 
				"title": "为什么0.1&#43;0.2不等于0.3 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-24T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/6d463s516uj/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/6rgg1uutzbr/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fwk6o5miwvma%2f&text=%e4%b8%ba%e4%bb%80%e4%b9%880.1%2b0.2%e4%b8%8d%e7%ad%89%e4%ba%8e0.3"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fwk6o5miwvma%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fwk6o5miwvma%2f&text=%e4%b8%ba%e4%bb%80%e4%b9%880.1%2b0.2%e4%b8%8d%e7%ad%89%e4%ba%8e0.3"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fwk6o5miwvma%2f&title=%e4%b8%ba%e4%bb%80%e4%b9%880.1%2b0.2%e4%b8%8d%e7%ad%89%e4%ba%8e0.3"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fwk6o5miwvma%2f&is_video=false&description=%e4%b8%ba%e4%bb%80%e4%b9%880.1%2b0.2%e4%b8%8d%e7%ad%89%e4%ba%8e0.3"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%b8%ba%e4%bb%80%e4%b9%880.1%2b0.2%e4%b8%8d%e7%ad%89%e4%ba%8e0.3&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fwk6o5miwvma%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fwk6o5miwvma%2f&title=%e4%b8%ba%e4%bb%80%e4%b9%880.1%2b0.2%e4%b8%8d%e7%ad%89%e4%ba%8e0.3"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fwk6o5miwvma%2f&title=%e4%b8%ba%e4%bb%80%e4%b9%880.1%2b0.2%e4%b8%8d%e7%ad%89%e4%ba%8e0.3"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fwk6o5miwvma%2f&title=%e4%b8%ba%e4%bb%80%e4%b9%880.1%2b0.2%e4%b8%8d%e7%ad%89%e4%ba%8e0.3"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fwk6o5miwvma%2f&title=%e4%b8%ba%e4%bb%80%e4%b9%880.1%2b0.2%e4%b8%8d%e7%ad%89%e4%ba%8e0.3"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">为什么0.1&#43;0.2不等于0.3</h1><div class="meta"><div class="postdate"><time datetime="2018-12-24" itemprop="datePublished">2018-12-24</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e原文地址：\x3ca href=\x22http:\/\/u3xyz.com\/#\/detail\/28\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e为什么0.1\x2b0.2不等于0.3\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e先看两个简单但诡异的代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x220.1 \x2b 0.2 \x3e 0.3 \/\/ true\n0.1 * 0.1 = 0.010000000000000002\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lsl\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-number\x22\x3e0.1\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-number\x22\x3e0.2\x3c\/span\x3e \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0.3\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/ true\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e0.1\x3c\/span\x3e * \x3cspan class=\x22hljs-number\x22\x3e0.1\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e0.010000000000000002\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e0.1加0.2为什么就不等于0.3昵？要回答这个问题，得先了解计算机内部是如何表示数的。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader0\x22\x3e计算机内部如何表示数\x3c\/h3\x3e\n\x3cp\x3e我们都知道，计算机用位来储存及处理数据。每一个二进制数（二进制串）都一一对应一个十进制数。\x3c\/p\x3e\n\x3ch5\x3e1. 计算机内部如何表示整数\x3c\/h5\x3e\n\x3cp\x3e这里以十进制数13来展示“按位计数法”如何表示整数：\x3c\/p\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth\x3e十进制值\x3c\/th\x3e\n\x3cth\x3e进制\x3c\/th\x3e\n\x3cth\x3e按位格式\x3c\/th\x3e\n\x3cth\x3e描述\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd\x3e13\x3c\/td\x3e\n\x3ctd\x3e10\x3c\/td\x3e\n\x3ctd\x3e13\x3c\/td\x3e\n\x3ctd\x3e1x10^1 \x2b 3x10^0 = 10 \x2b 3\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e13\x3c\/td\x3e\n\x3ctd\x3e2\x3c\/td\x3e\n\x3ctd\x3e1101\x3c\/td\x3e\n\x3ctd\x3e1x2^3 \x2b 1x2^2 \x2b 0x2^1 \x2b 1x2^0 = 8 \x2b 4 \x2b 0 \x2b 1\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3ch5\x3e2. 计算机内部如何表示小数\x3c\/h5\x3e\n\x3cp\x3e再看小数怎么用按位计数法表示，以十进制数0.625为例：\x3c\/p\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth\x3e十进制值\x3c\/th\x3e\n\x3cth\x3e进制\x3c\/th\x3e\n\x3cth\x3e按位格式\x3c\/th\x3e\n\x3cth\x3e描述\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd\x3e0.625\x3c\/td\x3e\n\x3ctd\x3e10\x3c\/td\x3e\n\x3ctd\x3e0.625\x3c\/td\x3e\n\x3ctd\x3e6x10^-1 \x2b 2x10^-2 \x2b 5x10^-3 = 0.6 \x2b 0.02 \x2b 0.005\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3e0.625\x3c\/td\x3e\n\x3ctd\x3e2\x3c\/td\x3e\n\x3ctd\x3e0.101\x3c\/td\x3e\n\x3ctd\x3e1x2^-1 \x2b 0 x2^-2 \x2b 1x2^-3 = 1\/2 \x2b 0 \x2b 1\/8\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3ch5\x3e3. 如何用二进制表示0.1\x3c\/h5\x3e\n\x3cp\x3e关于十进制与二进制间如何转换，这里不细说，直接给出结论：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e十进制整数转二进制方法：除2取余；十进制小数转二进制方法：乘2除整\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e十进制0.1转换成二进制，乘2取整过程：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x220.1 * 2 = 0.2 # 0\n0.2 * 2 = 0.4 # 0\n0.4 * 2 = 0.8 # 0\n0.8 * 2 = 1.6 # 1\n0.6 * 2 = 1.2 # 1\n0.2 * 2 = 0.4 # 0\n\n.....\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lsl\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-number\x22\x3e0.1\x3c\/span\x3e * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e0.2\x3c\/span\x3e # \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e0.2\x3c\/span\x3e * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e0.4\x3c\/span\x3e # \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e0.4\x3c\/span\x3e * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e0.8\x3c\/span\x3e # \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e0.8\x3c\/span\x3e * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e1.6\x3c\/span\x3e # \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e0.6\x3c\/span\x3e * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e1.2\x3c\/span\x3e # \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e0.2\x3c\/span\x3e * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e0.4\x3c\/span\x3e # \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n\n.....\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e从上面可以看出，0.1的二进制格式是：0.0001100011....。这是一个\x3cstrong\x3e二进制无限循环小数\x3c\/strong\x3e，但计算机内存有限，我们不能用储存所有的小数位数。那么在精度与内存间如何取舍呢？\x3c\/p\x3e\n\x3cp\x3e答案是：\x3cstrong\x3e在某个精度点直接舍弃\x3c\/strong\x3e。当然，代价就是，0.1在计算机内部根本就不是精确的0.1，而是一个有舍入误差的0.1。当代码被编译或解释后，0.1已经被四舍五入成一个与之很接近的计算机内部数字，以至于计算还没开始，一个很小的舍入错误就已经产生了。这也就是 0.1 \x2b 0.2 不等于0.3 的原因。\x3c\/p\x3e\n\x3cp\x3e有误差的两个数，其计算的结果，当然就\x3cstrong\x3e很可能\x3c\/strong\x3e与我们期望的不一样了。注意前面的这句话中的“很可能”这三个字？为啥是很可能昵？\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e0.1 \x2b 0.1 为什么等于0.2\x3c\/h3\x3e\n\x3cp\x3e答案是：两个有舍入误差的值在求和时，相互抵消了，但这种“负负得正，相互抵消”不一定是可靠的，当这两个数字是用不同长度数位来表示的浮点数时，舍入误差可能不会相互抵消。\x3c\/p\x3e\n\x3cp\x3e又如，对于 0.1 \x2b 0.3 ，结果其实并不是0.4，但0.4是最接近真实结果的数，比其它任何浮点数都更接近。许多语言也就直接显示结果为0.4了，而不展示一个浮点数的真实结果了。\x3c\/p\x3e\n\x3cp\x3e另外要注意，\x3cstrong\x3e二进制能精确地表示位数有限且分母是2的倍数的小数\x3c\/strong\x3e，比如0.5，0.5在计算机内部就没有舍入误差。所以0.5 \x2b 0.5 === 1\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e计算机这样胡乱舍入，能满足所有的计算需求吗\x3c\/h3\x3e\n\x3cp\x3e我们看两个现实的场景：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e对于一个修建铁路的工程师而言，10米宽，还是10.0001米宽并没有什么不同。铁路工程师就不需要这么高0.x这样的精度\x3c\/li\x3e\n\x3cli\x3e对于芯片设计师，0.0001米就会是一个巨大不同，他也永远不用处理超过0.1米距离\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e不同行业，要求的精度不是线性的，我们允许（对结果无关紧要的）误差存在\x3c\/strong\x3e。10.0001与10.001在铁路工程师看来都是合格的。\x3c\/p\x3e\n\x3cp\x3e虽然允许误差存在，但程序员在使用浮点数进行计算或逻辑处理时，不注意，就可能出问题。记住，永远\x3cstrong\x3e不要直接比较两个浮点的大小\x3c\/strong\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var a = 0.1\nvar b = 0.2\n\nif (a \x2b b === 0.3) {\n  \/\/ doSomething\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e a = \x3cspan class=\x22hljs-number\x22\x3e0.1\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e b = \x3cspan class=\x22hljs-number\x22\x3e0.2\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (a \x2b b === \x3cspan class=\x22hljs-number\x22\x3e0.3\x3c\/span\x3e) {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ doSomething\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3eJS中如何进入浮点数运算\x3c\/h3\x3e\n\x3ch5\x3e将浮点运算转换成整数计算\x3c\/h5\x3e\n\x3cp\x3e整数是完全精度的，不存在舍入误差。例如，一些关于人民币的运算，都会以分为基本单位，计算采用分，展示再转换成元。当然，这样也有一些问题，会带来额外的工作量，如果那天人民币新增了一个货币单位，对系统的扩展性也会有考验。\x3c\/p\x3e\n\x3ch4\x3e使用\x3ca href=\x22https:\/\/github.com\/MikeMcl\/bignumber.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ebignumber\x3c\/a\x3e进行运算\x3c\/h4\x3e\n\x3cp\x3ebignumber.js会在一定精度内，让浮点数计算结果符合我们的期望。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  let x = new BigNumber(0.1);\n  let y = new BigNumber(0.2)\n  let z = new BigNumber(0.3)\n\n  console.log(z.equals(x.add(y))) \/\/ 0.3 === 0.1 \x2b 0.2, true\n  console.log(z.minus(x).equals(y)) \/\/ true\n  console.log(z.minus(y).equals(x)) \/\/ true\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e x = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e BigNumber(\x3cspan class=\x22hljs-number\x22\x3e0.1\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e y = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e BigNumber(\x3cspan class=\x22hljs-number\x22\x3e0.2\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e z = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e BigNumber(\x3cspan class=\x22hljs-number\x22\x3e0.3\x3c\/span\x3e)\n\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(z.equals(x.add(y))) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 0.3 === 0.1 \x2b 0.2, true\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(z.minus(x).equals(y)) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ true\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(z.minus(y).equals(x)) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ true\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  let x = 0.2\n  console.log(x * x === 0.04) \/\/ false\n  let y = new BigNumber(0.2)\n  let r = y.mul(y) \/\/ 0.04\n  console.log(r.equals(new BigNumber(0.04))) \/\/ true\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs clojure\x22\x3e\x3ccode\x3e{\n  let x = \x3cspan class=\x22hljs-number\x22\x3e0.2\x3c\/span\x3e\n  console.log(\x3cspan class=\x22hljs-name\x22\x3ex\x3c\/span\x3e * x === \x3cspan class=\x22hljs-number\x22\x3e0.04\x3c\/span\x3e) \/\/ \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n  let y = new BigNumber(\x3cspan class=\x22hljs-number\x22\x3e0.2\x3c\/span\x3e)\n  let r = y.mul(\x3cspan class=\x22hljs-name\x22\x3ey\x3c\/span\x3e) \/\/ \x3cspan class=\x22hljs-number\x22\x3e0.04\x3c\/span\x3e\n  console.log(\x3cspan class=\x22hljs-name\x22\x3er.equals\x3c\/span\x3e(\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-builtin-name\x22\x3enew\x3c\/span\x3e\x3c\/span\x3e BigNumber(\x3cspan class=\x22hljs-number\x22\x3e0.04\x3c\/span\x3e))) \/\/ \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e更多例子，可以看bignumber.js官方示例。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e小结\x3c\/h3\x3e\n\x3cp\x3e本文主要介绍了浮点数计算问题，简单回答了为什么以及怎么办两个问题：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e为什么0.1 \x2b 0.2 不等于0.3。因为计算机不能精确表示0.1， 0.2这样的浮点数，计算时使用的是带有舍入误差的数\x3c\/li\x3e\n\x3cli\x3e并不是所有的浮点数在计算机内部都存在舍入误差，比如0.5就没有舍入误差\x3c\/li\x3e\n\x3cli\x3e具有舍入误差的运算结可能会符合我们的期望，原因可能是“负负得正”\x3c\/li\x3e\n\x3cli\x3e怎么办？1个办法是使用整型代替浮点数计算；2是不要直接比较两个浮点数，而应该使用bignumber.js这样的浮点数运算库\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e最后，本文只是简单回答了为什么，如果读者对更根本深入的原理感兴趣，可以自行google之。限于水平有限，本文如果有错误，欢迎指正。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>为什么0.1+0.2不等于0.3</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000012175422">https://segmentfault.com/a/1190000012175422</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/wk6o5miwvma/" target="_blank">https://alili.tech/archive/wk6o5miwvma/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>