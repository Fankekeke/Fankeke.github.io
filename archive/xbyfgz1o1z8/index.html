<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="前端基础进阶（十三）：透彻掌握Promise的使用，读这篇就够了"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>前端基础进阶（十三）：透彻掌握Promise的使用，读这篇就够了 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/xbyfgz1o1z8/",
				"appid": "1613049289050283", 
				"title": "前端基础进阶（十三）：透彻掌握Promise的使用，读这篇就够了 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-19T02:30:08"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/2p4g2i6vnvx/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/aiff4ut7rhf/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fxbyfgz1o1z8%2f&text=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%e4%b8%89%ef%bc%89%ef%bc%9a%e9%80%8f%e5%bd%bb%e6%8e%8c%e6%8f%a1Promise%e7%9a%84%e4%bd%bf%e7%94%a8%ef%bc%8c%e8%af%bb%e8%bf%99%e7%af%87%e5%b0%b1%e5%a4%9f%e4%ba%86"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fxbyfgz1o1z8%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fxbyfgz1o1z8%2f&text=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%e4%b8%89%ef%bc%89%ef%bc%9a%e9%80%8f%e5%bd%bb%e6%8e%8c%e6%8f%a1Promise%e7%9a%84%e4%bd%bf%e7%94%a8%ef%bc%8c%e8%af%bb%e8%bf%99%e7%af%87%e5%b0%b1%e5%a4%9f%e4%ba%86"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fxbyfgz1o1z8%2f&title=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%e4%b8%89%ef%bc%89%ef%bc%9a%e9%80%8f%e5%bd%bb%e6%8e%8c%e6%8f%a1Promise%e7%9a%84%e4%bd%bf%e7%94%a8%ef%bc%8c%e8%af%bb%e8%bf%99%e7%af%87%e5%b0%b1%e5%a4%9f%e4%ba%86"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fxbyfgz1o1z8%2f&is_video=false&description=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%e4%b8%89%ef%bc%89%ef%bc%9a%e9%80%8f%e5%bd%bb%e6%8e%8c%e6%8f%a1Promise%e7%9a%84%e4%bd%bf%e7%94%a8%ef%bc%8c%e8%af%bb%e8%bf%99%e7%af%87%e5%b0%b1%e5%a4%9f%e4%ba%86"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%e4%b8%89%ef%bc%89%ef%bc%9a%e9%80%8f%e5%bd%bb%e6%8e%8c%e6%8f%a1Promise%e7%9a%84%e4%bd%bf%e7%94%a8%ef%bc%8c%e8%af%bb%e8%bf%99%e7%af%87%e5%b0%b1%e5%a4%9f%e4%ba%86&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fxbyfgz1o1z8%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fxbyfgz1o1z8%2f&title=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%e4%b8%89%ef%bc%89%ef%bc%9a%e9%80%8f%e5%bd%bb%e6%8e%8c%e6%8f%a1Promise%e7%9a%84%e4%bd%bf%e7%94%a8%ef%bc%8c%e8%af%bb%e8%bf%99%e7%af%87%e5%b0%b1%e5%a4%9f%e4%ba%86"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxbyfgz1o1z8%2f&title=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%e4%b8%89%ef%bc%89%ef%bc%9a%e9%80%8f%e5%bd%bb%e6%8e%8c%e6%8f%a1Promise%e7%9a%84%e4%bd%bf%e7%94%a8%ef%bc%8c%e8%af%bb%e8%bf%99%e7%af%87%e5%b0%b1%e5%a4%9f%e4%ba%86"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxbyfgz1o1z8%2f&title=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%e4%b8%89%ef%bc%89%ef%bc%9a%e9%80%8f%e5%bd%bb%e6%8e%8c%e6%8f%a1Promise%e7%9a%84%e4%bd%bf%e7%94%a8%ef%bc%8c%e8%af%bb%e8%bf%99%e7%af%87%e5%b0%b1%e5%a4%9f%e4%ba%86"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxbyfgz1o1z8%2f&title=%e5%89%8d%e7%ab%af%e5%9f%ba%e7%a1%80%e8%bf%9b%e9%98%b6%ef%bc%88%e5%8d%81%e4%b8%89%ef%bc%89%ef%bc%9a%e9%80%8f%e5%bd%bb%e6%8e%8c%e6%8f%a1Promise%e7%9a%84%e4%bd%bf%e7%94%a8%ef%bc%8c%e8%af%bb%e8%bf%99%e7%af%87%e5%b0%b1%e5%a4%9f%e4%ba%86"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">前端基础进阶（十三）：透彻掌握Promise的使用，读这篇就够了</h1><div class="meta"><div class="postdate"><time datetime="2018-12-19" itemprop="datePublished">2018-12-19</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008932857\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008932857\x22 alt=\x22Promise：高手必备\x22 title=\x22Promise：高手必备\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3ePromise的重要性我认为我没有必要多讲，概括起来说就是必须得掌握，而且还要掌握透彻。这篇文章的开头，主要跟大家分析一下，为什么会有Promise出现。\x3c\/p\x3e\n\x3cp\x3e在实际的使用当中，有非常多的应用场景我们不能立即知道应该如何继续往下执行。最重要也是最主要的一个场景就是ajax请求。通俗来说，由于网速的不同，可能你得到返回值的时间也是不同的，这个时候我们就需要等待，结果出来了之后才知道怎么样继续下去。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 简单的ajax原生实现\nvar url = \x27https:\/\/hq.tigerbrokers.com\/fundamental\/finance_calendar\/getType\/2017-02-26\/2017-06-10\x27;\nvar result;\n\nvar XHR = new XMLHttpRequest();\nXHR.open(\x27GET\x27, url, true);\nXHR.send();\n\nXHR.onreadystatechange = function() {\n    if (XHR.readyState == 4 \x26amp;\x26amp; XHR.status == 200) {\n        result = XHR.response;\n        console.log(result);\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 简单的ajax原生实现\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/hq.tigerbrokers.com\/fundamental\/finance_calendar\/getType\/2017-02-26\/2017-06-10\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e result;\n\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e XHR = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nXHR.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\nXHR.send();\n\nXHR.onreadystatechange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (XHR.readyState == \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e \x26amp;\x26amp; XHR.status == \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e) {\n        result = XHR.response;\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(result);\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在ajax的原生实现中，利用了onreadystatechange事件，当该事件触发并且符合一定条件时，才能拿到我们想要的数据，之后我们才能开始处理数据。\x3c\/p\x3e\n\x3cp\x3e这样做看上去并没有什么麻烦，但是如果这个时候，我们还需要做另外一个ajax请求，这个新的ajax请求的其中一个参数，得从上一个ajax请求中获取，这个时候我们就不得不如下这样做：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var url = \x27https:\/\/hq.tigerbrokers.com\/fundamental\/finance_calendar\/getType\/2017-02-26\/2017-06-10\x27;\nvar result;\n\nvar XHR = new XMLHttpRequest();\nXHR.open(\x27GET\x27, url, true);\nXHR.send();\n\nXHR.onreadystatechange = function() {\n    if (XHR.readyState == 4 \x26amp;\x26amp; XHR.status == 200) {\n        result = XHR.response;\n        console.log(result);\n\n        \/\/ 伪代码\n        var url2 = \x27http:xxx.yyy.com\/zzz?ddd=\x27 \x2b result.someParams;\n        var XHR2 = new XMLHttpRequest();\n        XHR2.open(\x27GET\x27, url, true);\n        XHR2.send();\n        XHR2.onreadystatechange = function() {\n            ...\n        }\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/hq.tigerbrokers.com\/fundamental\/finance_calendar\/getType\/2017-02-26\/2017-06-10\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e result;\n\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e XHR = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\nXHR.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\nXHR.send();\n\nXHR.onreadystatechange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (XHR.readyState == \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e \x26amp;\x26amp; XHR.status == \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e) {\n        result = XHR.response;\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(result);\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 伪代码\x3c\/span\x3e\n        \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e url2 = \x3cspan class=\x22hljs-string\x22\x3e\x27http:xxx.yyy.com\/zzz?ddd=\x27\x3c\/span\x3e \x2b result.someParams;\n        \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e XHR2 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n        XHR2.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\n        XHR2.send();\n        XHR2.onreadystatechange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            ...\n        }\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当出现第三个ajax(甚至更多)仍然依赖上一个请求的时候，我们的代码就变成了一场灾难。这场灾难，往往也被称为\x3cstrong\x3e回调地狱\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e因此我们需要一个叫做Promise的东西，来解决这个问题。\x3c\/p\x3e\n\x3cp\x3e当然，除了回调地狱之外，还有一个非常重要的需求：\x3cstrong\x3e为了我们的代码更加具有可读性和可维护性，我们需要将数据请求与数据处理明确的区分开来\x3c\/strong\x3e。上面的写法，是完全没有区分开，当数据变得复杂时，也许我们自己都无法轻松维护自己的代码了。这也是模块化过程中，必须要掌握的一个重要技能，请一定重视。\x3c\/p\x3e\n\x3cp\x3e从前面几篇文中的知识我们可以知道，当我们想要确保某代码在谁谁之后执行时，我们可以利用函数调用栈，将我们想要执行的代码放入回调函数中。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 一个简单的封装\nfunction want() {\n    console.log(\x27这是你想要执行的代码\x27);\n}\n\nfunction fn(want) {\n    console.log(\x27这里表示执行了一大堆各种代码\x27);\n\n    \/\/ 其他代码执行完毕，最后执行回调函数\n    want \x26amp;\x26amp; want();\n}\n\nfn(want);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 一个简单的封装\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ewant\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27这是你想要执行的代码\x27\x3c\/span\x3e);\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efn\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ewant\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27这里表示执行了一大堆各种代码\x27\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 其他代码执行完毕，最后执行回调函数\x3c\/span\x3e\n    want \x26amp;\x26amp; want();\n}\n\nfn(want);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e利用回调函数封装，是我们在初学JavaScript时常常会使用的技能。\x3c\/p\x3e\n\x3cp\x3e确保我们想要的代码压后执行，除了利用函数调用栈的执行顺序之外，我们还可以利用上一篇文章所述的队列机制。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function want() {\n    console.log(\x27这是你想要执行的代码\x27);\n}\n\nfunction fn(want) {\n    \/\/ 将想要执行的代码放入队列中，根据事件循环的机制，我们就不用非得将它放到最后面了，由你自由选择\n    want \x26amp;\x26amp; setTimeout(want, 0);\n    console.log(\x27这里表示执行了一大堆各种代码\x27);\n}\n\nfn(want);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ewant\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27这是你想要执行的代码\x27\x3c\/span\x3e);\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efn\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ewant\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 将想要执行的代码放入队列中，根据事件循环的机制，我们就不用非得将它放到最后面了，由你自由选择\x3c\/span\x3e\n    want \x26amp;\x26amp; setTimeout(want, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27这里表示执行了一大堆各种代码\x27\x3c\/span\x3e);\n}\n\nfn(want);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果浏览器已经支持了原生的Promise对象，那么我们就知道，浏览器的js引擎里已经有了Promise队列，这样就可以利用Promise将任务放在它的队列中去。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function want() {\n    console.log(\x27这是你想要执行的代码\x27);\n}\n\nfunction fn(want) {\n    console.log(\x27这里表示执行了一大堆各种代码\x27);\n\n    \/\/ 返回Promise对象\n    return new Promise(function(resolve, reject) {\n        if (typeof want == \x27function\x27) {\n            resolve(want);\n        } else {\n            reject(\x27TypeError: \x27\x2b want \x2b\x27不是一个函数\x27)\n        }\n    })\n}\n\nfn(want).then(function(want) {\n    want();\n})\n\nfn(\x271234\x27).catch(function(err) {\n    console.log(err);\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ewant\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27这是你想要执行的代码\x27\x3c\/span\x3e);\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efn\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ewant\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27这里表示执行了一大堆各种代码\x27\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 返回Promise对象\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e want == \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e) {\n            resolve(want);\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            reject(\x3cspan class=\x22hljs-string\x22\x3e\x27TypeError: \x27\x3c\/span\x3e\x2b want \x2b\x3cspan class=\x22hljs-string\x22\x3e\x27不是一个函数\x27\x3c\/span\x3e)\n        }\n    })\n}\n\nfn(want).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ewant\x3c\/span\x3e) \x3c\/span\x3e{\n    want();\n})\n\nfn(\x3cspan class=\x22hljs-string\x22\x3e\x271234\x27\x3c\/span\x3e).catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(err);\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e看上去变得更加复杂了。可是代码变得更加健壮，处理了错误输入的情况。\x3c\/p\x3e\n\x3cp\x3e为了更好的往下扩展Promise的应用，这里需要先跟大家介绍一下Promsie的基础知识。\x3c\/p\x3e\n\x3cp\x3e一、 Promise对象有三种状态，他们分别是：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3epending: 等待中，或者进行中，表示还没有得到结果\x3c\/li\x3e\n\x3cli\x3eresolved(Fulfilled): 已经完成，表示得到了我们想要的结果，可以继续往下执行\x3c\/li\x3e\n\x3cli\x3erejected: 也表示得到结果，但是由于结果并非我们所愿，因此拒绝执行\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e这三种状态不受外界影响，而且状态只能从pending改变为resolved或者rejected，并且不可逆。在Promise对象的构造函数中，将一个函数作为第一个参数。而这个函数，就是用来处理Promise的状态变化。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new Promise(function(resolve, reject) {\n    if(true) { resolve() };\n    if(false) { reject() };\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lisp\x22\x3e\x3ccode\x3enew Promise(\x3cspan class=\x22hljs-name\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-name\x22\x3eresolve\x3c\/span\x3e, reject) {\n    if(\x3cspan class=\x22hljs-name\x22\x3etrue\x3c\/span\x3e) { resolve() }\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n    if(\x3cspan class=\x22hljs-name\x22\x3efalse\x3c\/span\x3e) { reject() }\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面的resolve和reject都为一个函数，他们的作用分别是将状态修改为resolved和rejected。\x3c\/p\x3e\n\x3cp\x3e二、 Promise对象中的then方法，可以接收构造函数中处理的状态变化，并分别对应执行。then方法有2个参数，第一个函数接收resolved状态的执行，第二个参数接收reject状态的执行。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function fn(num) {\n    return new Promise(function(resolve, reject) {\n        if (typeof num == \x27number\x27) {\n            resolve();\n        } else {\n            reject();\n        }\n    }).then(function() {\n        console.log(\x27参数是一个number值\x27);\n    }, function() {\n        console.log(\x27参数不是一个number值\x27);\n    })\n}\n\nfn(\x27hahha\x27);\nfn(1234);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efn\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3enum\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e num == \x3cspan class=\x22hljs-string\x22\x3e\x27number\x27\x3c\/span\x3e) {\n            resolve();\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            reject();\n        }\n    }).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27参数是一个number值\x27\x3c\/span\x3e);\n    }, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27参数不是一个number值\x27\x3c\/span\x3e);\n    })\n}\n\nfn(\x3cspan class=\x22hljs-string\x22\x3e\x27hahha\x27\x3c\/span\x3e);\nfn(\x3cspan class=\x22hljs-number\x22\x3e1234\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ethen方法的执行结果也会返回一个Promise对象。因此我们可以进行then的链式执行，这也是解决回调地狱的主要方式。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function fn(num) {\n    return new Promise(function(resolve, reject) {\n        if (typeof num == \x27number\x27) {\n            resolve();\n        } else {\n            reject();\n        }\n    })\n    .then(function() {\n        console.log(\x27参数是一个number值\x27);\n    })\n    .then(null, function() {\n        console.log(\x27参数不是一个number值\x27);\n    })\n}\n\nfn(\x27hahha\x27);\nfn(1234);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efn\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3enum\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e num == \x3cspan class=\x22hljs-string\x22\x3e\x27number\x27\x3c\/span\x3e) {\n            resolve();\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            reject();\n        }\n    })\n    .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27参数是一个number值\x27\x3c\/span\x3e);\n    })\n    .then(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27参数不是一个number值\x27\x3c\/span\x3e);\n    })\n}\n\nfn(\x3cspan class=\x22hljs-string\x22\x3e\x27hahha\x27\x3c\/span\x3e);\nfn(\x3cspan class=\x22hljs-number\x22\x3e1234\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3ethen(null, function() {}) 就等同于catch(function() {})\x3c\/blockquote\x3e\n\x3cp\x3e三、Promise中的数据传递\x3c\/p\x3e\n\x3cp\x3e大家自行从下面的例子中领悟吧。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var fn = function(num) {\n    return new Promise(function(resolve, reject) {\n        if (typeof num == \x27number\x27) {\n            resolve(num);\n        } else {\n            reject(\x27TypeError\x27);\n        }\n    })\n}\n\nfn(2).then(function(num) {\n    console.log(\x27first: \x27 \x2b num);\n    return num \x2b 1;\n})\n.then(function(num) {\n    console.log(\x27second: \x27 \x2b num);\n    return num \x2b 1;\n})\n.then(function(num) {\n    console.log(\x27third: \x27 \x2b num);\n    return num \x2b 1;\n});\n\n\/\/ 输出结果\nfirst: 2\nsecond: 3\nthird: 4\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e fn = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3enum\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e num == \x3cspan class=\x22hljs-string\x22\x3e\x27number\x27\x3c\/span\x3e) {\n            resolve(num);\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            reject(\x3cspan class=\x22hljs-string\x22\x3e\x27TypeError\x27\x3c\/span\x3e);\n        }\n    })\n}\n\nfn(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3enum\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27first: \x27\x3c\/span\x3e \x2b num);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e num \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n})\n.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3enum\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27second: \x27\x3c\/span\x3e \x2b num);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e num \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n})\n.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3enum\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27third: \x27\x3c\/span\x3e \x2b num);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e num \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n});\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 输出结果\x3c\/span\x3e\nfirst: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\nsecond: \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\nthird: \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eOK，了解了这些基础知识之后，我们再回过头，利用Promise的知识，对最开始的ajax的例子进行一个简单的封装。看看会是什么样子。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var url = \x27https:\/\/hq.tigerbrokers.com\/fundamental\/finance_calendar\/getType\/2017-02-26\/2017-06-10\x27;\n\n\/\/ 封装一个get请求的方法\nfunction getJSON(url) {\n    return new Promise(function(resolve, reject) {\n        var XHR = new XMLHttpRequest();\n        XHR.open(\x27GET\x27, url, true);\n        XHR.send();\n\n        XHR.onreadystatechange = function() {\n            if (XHR.readyState == 4) {\n                if (XHR.status == 200) {\n                    try {\n                        var response = JSON.parse(XHR.responseText);\n                        resolve(response);\n                    } catch (e) {\n                        reject(e);\n                    }\n                } else {\n                    reject(new Error(XHR.statusText));\n                }\n            }\n        }\n    })\n}\n\ngetJSON(url).then(resp =\x3e console.log(resp));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e url = \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/hq.tigerbrokers.com\/fundamental\/finance_calendar\/getType\/2017-02-26\/2017-06-10\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 封装一个get请求的方法\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetJSON\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eurl\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e XHR = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n        XHR.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, url, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\n        XHR.send();\n\n        XHR.onreadystatechange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (XHR.readyState == \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e) {\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (XHR.status == \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e) {\n                    \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n                        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e response = \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.parse(XHR.responseText);\n                        resolve(response);\n                    } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (e) {\n                        reject(e);\n                    }\n                } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                    reject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(XHR.statusText));\n                }\n            }\n        }\n    })\n}\n\ngetJSON(url).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eresp\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(resp));\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e为了健壮性，处理了很多可能出现的异常，总之，就是正确的返回结果，就resolve一下，错误的返回结果，就reject一下。并且利用上面的参数传递的方式，将正确结果或者错误信息通过他们的参数传递出来。\x3c\/p\x3e\n\x3cblockquote\x3e现在所有的库几乎都将ajax请求利用Promise进行了封装，因此我们在使用jQuery等库中的ajax请求时，都可以利用Promise来让我们的代码更加优雅和简单。这也是Promise最常用的一个场景，因此我们一定要非常非常熟悉它，这样才能在应用的时候更加灵活。\x3c\/blockquote\x3e\n\x3cp\x3e四、Promise.all\x3c\/p\x3e\n\x3cp\x3e当有一个ajax请求，它的参数需要另外2个甚至更多请求都有返回结果之后才能确定，那么这个时候，就需要用到Promise.all来帮助我们应对这个场景。\x3c\/p\x3e\n\x3cp\x3ePromise.all接收一个Promise对象组成的数组作为参数，当这个数组所有的Promise对象状态都变成resolved或者rejected的时候，它才会去调用then方法。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var url = \x27https:\/\/hq.tigerbrokers.com\/fundamental\/finance_calendar\/getType\/2017-02-26\/2017-06-10\x27;\nvar url1 = \x27https:\/\/hq.tigerbrokers.com\/fundamental\/finance_calendar\/getType\/2017-03-26\/2017-06-10\x27;\n\nfunction renderAll() {\n    return Promise.all([getJSON(url), getJSON(url1)]);\n}\n\nrenderAll().then(function(value) {\n    \/\/ 建议大家在浏览器中看看这里的value值\n    console.log(value);\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/hq.tigerbrokers.com\/fundamental\/finance_calendar\/getType\/2017-02-26\/2017-06-10\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e url1 = \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/hq.tigerbrokers.com\/fundamental\/finance_calendar\/getType\/2017-03-26\/2017-06-10\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erenderAll\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e Promise.all([getJSON(\x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e), getJSON(url1)]);\n}\n\nrenderAll().then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 建议大家在浏览器中看看这里的value值\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value);\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e五、 Promise.race\x3c\/p\x3e\n\x3cp\x3e与Promise.all相似的是，Promise.race都是以一个Promise对象组成的数组作为参数，不同的是，只要当数组中的其中一个Promsie状态变成resolved或者rejected时，就可以调用.then方法了。而传递给then方法的值也会有所不同，大家可以再浏览器中运行下面的例子与上面的例子进行对比。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function renderRace() {\n    return Promise.race([getJSON(url), getJSON(url1)]);\n}\n\nrenderRace().then(function(value) {\n    console.log(value);\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs fortran\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3c\/span\x3e renderRace() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e Promise.race([getJSON(url), getJSON(url1)]);\n}\n\nrenderRace().\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e\x3c\/span\x3e {\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e);\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e嗯，我所知道的，关于Promise的基础知识就这些了，如果还有别的，欢迎大家补充。\x3c\/p\x3e\n\x3cp\x3e那么接下来，我们要结合三个不同的应用场景来让大家感受一下Promise在模块系统中如何使用。\x3c\/p\x3e\n\x3cblockquote\x3e这里选择requirejs是因为学习成本最低，能够快速上手进行简单的运用。接下来的这些例子，会涉及到很多其他的知识，因此如果想要彻底掌握，一定要动手实践，自己试着完成一遍。\x3cp\x3e我在github上创建了对应的项目，大家可以直接clone下来进行学习。这样学习效果会更好。\x3c\/p\x3e\n\x3cp\x3e项目地址： \x3ca href=\x22https:\/\/github.com\/yangbo5207\/promiseApps\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/yangbo5207...\x3c\/a\x3e\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cblockquote\x3e往下阅读例子之前，请一定要对requirejs有一个简单的了解。\x3cp\x3erequirejs中文文档 \x3ca href=\x22http:\/\/www.requirejs.cn\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.requirejs.cn\/\x3c\/a\x3e\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008932858\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008932858\x22 alt=\x22代码结构\x22 title=\x22代码结构\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e项目的代码结果如上图所示，所有的html文件都放在根目录下。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3epages: html直接引入的js\x3c\/li\x3e\n\x3cli\x3elibs: 常用的库\x3c\/li\x3e\n\x3cli\x3ecomponents: 针对项目自定义的模块\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e首先为了能够让require起作用，我们需要在html中引入require.js，写法如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ index.js为入口文件\n\x3cscript data-main=\x26quot;.\/pages\/index.js\x26quot; src=\x26quot;.\/libs\/require.js\x26quot;\x3e\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\/\/ index.js为入口文件\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edata-main\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22.\/pages\/index.js\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22.\/libs\/require.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在入口的index.js中，我们可以对常用的模块进行映射配置，这样在引入时就可以少写一些代码。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 具体的配置项的含义，请参阅require的中文文档\nrequirejs.config({\n    baseUrl: \x27.\/\x27,\n    paths: {\n        jquery: \x26quot;.\/libs\/jquery-3.2.0\x26quot;,\n        API: \x27.\/libs\/API\x27,\n        request: \x27.\/libs\/request\x27,\n        calendar: \x27.\/components\/calendar\x27,\n        imageCenter: \x27.\/components\/imageCenter\x27,\n        dialog: \x27.\/components\/Dialog\x27\n    }\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 具体的配置项的含义，请参阅require的中文文档\x3c\/span\x3e\n\x3cspan class=\x22hljs-selector-tag\x22\x3erequirejs\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.config\x3c\/span\x3e({\n    \x3cspan class=\x22hljs-attribute\x22\x3ebaseUrl\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attribute\x22\x3epaths\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attribute\x22\x3ejquery\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22.\/libs\/jquery-3.2.0\x22\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attribute\x22\x3eAPI\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/libs\/API\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attribute\x22\x3erequest\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/libs\/request\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attribute\x22\x3ecalendar\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/components\/calendar\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attribute\x22\x3eimageCenter\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/components\/imageCenter\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attribute\x22\x3edialog\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/components\/Dialog\x27\x3c\/span\x3e\n    }\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e配置之后，那么我们在其他模块中，引入配置过的模块，就可以简单的这样写：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var $ = require(\x27jquery\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ruby\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3evar $ = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27jquery\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果不进行配置，也可以这样引入模块：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22require(\x27.\/components\/button\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/components\/button\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们可以使用define定义一个模块：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 其他方式请参阅文档\ndefine(function(require) {\n\n})\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 其他方式请参阅文档\x3c\/span\x3e\ndefine(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(require)\x3c\/span\x3e \x3c\/span\x3e{\n\n})\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e使用return可以直接对外提供方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 在其他模块通过require引入时得到的值，就是这里返回的值\ndefine(function(require) {\n    return {\n        a: 1\n    }\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在其他模块通过require引入时得到的值，就是这里返回的值\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3edefine\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(function(require)\x3c\/span\x3e\x3c\/span\x3e {\n    return {\n        \x3cspan class=\x22hljs-selector-tag\x22\x3ea\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n    }\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eOK，了解上面这些，应付基础的使用已经没有问题了。我们接下来重点总结第一个常用的应用场景：ajax。\x3c\/p\x3e\n\x3cp\x3e关于ajax的简单使用和简单封装，我们在上面都已经讲过了，这里就不再多说，直接使用jquery封装好的方法即可。而我们需要处理的问题在于，如何有效的将ajax的数据请求和数据处理分别放在不同的模块中进行管理，这样做的主要目的在于降低后期维护成本，便于管理。\x3c\/p\x3e\n\x3cp\x3e来看看怎么样简单操作的。\x3c\/p\x3e\n\x3cp\x3e首先，将所有的url放在一个模块中统一处理。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ libs\/API.js\ndefine(function() {\n    return {\n        dayInfo: \x27https:\/\/hq.tigerbrokers.com\/fundamental\/finance_calendar\/get_day\/2017-04-03\x27,\n        typeInfo: \x27https:\/\/hq.tigerbrokers.com\/fundamental\/finance_calendar\/getType\/2017-03-26\/2017-04-15\x27\n    }\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ libs\/API.js\x3c\/span\x3e\ndefine(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n        dayInfo: \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/hq.tigerbrokers.com\/fundamental\/finance_calendar\/get_day\/2017-04-03\x27\x3c\/span\x3e,\n        typeInfo: \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/hq.tigerbrokers.com\/fundamental\/finance_calendar\/getType\/2017-03-26\/2017-04-15\x27\x3c\/span\x3e\n    }\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在实际开发中，url并不是直接通过字符串就能直接确认的，某些url还需要通过参数拼接等，这个时候需要我们灵活处理。\x3c\/p\x3e\n\x3cp\x3e第二步，将所有的数据请求这个动作放在同一个模块中统一管理。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ libs\/request.js\ndefine(function(require) {\n    var API = require(\x27API\x27);\n\n    \/\/ 因为jQuery中的get方法也是通过Promise进行了封装，最终返回的是一个Promise对象，因此这样我们就可以将数据请求与数据处理放在不同的模块\n    \/\/ 这样我们就可以使用一个统一的模块来管理所有的数据请求\n\n    \/\/ 获取当天的信息\n    getDayInfo = function() {\n        return $.get(API.dayInfo);\n    }\n\n    \/\/ 获取type信息\n    getTypeInfo = function() {\n        return $.get(API.typeInfo);\n    };\n\n    return {\n        getDayInfo: getDayInfo,\n        getTypeInfo: getTypeInfo\n    }\n});\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ libs\/request.js\x3c\/span\x3e\ndefine(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3erequire\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e API = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27API\x27\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 因为jQuery中的get方法也是通过Promise进行了封装，最终返回的是一个Promise对象，因此这样我们就可以将数据请求与数据处理放在不同的模块\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这样我们就可以使用一个统一的模块来管理所有的数据请求\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取当天的信息\x3c\/span\x3e\n    getDayInfo = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $.get(API.dayInfo);\n    }\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取type信息\x3c\/span\x3e\n    getTypeInfo = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $.get(API.typeInfo);\n    };\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-attr\x22\x3egetDayInfo\x3c\/span\x3e: getDayInfo,\n        \x3cspan class=\x22hljs-attr\x22\x3egetTypeInfo\x3c\/span\x3e: getTypeInfo\n    }\n});\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在这个模块中，我们还可以对拿到的数据进行一些你需要的过滤处理，确保最终返回给下一个模块的数据是能够直接使用的。\x3c\/p\x3e\n\x3cp\x3e第三步：就是拿到数据并且处理数据了。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ components\/calendar.js\ndefine(function(require) {\n    var request = require(\x27request\x27);\n\n    \/\/ 拿到数据之后，需要处理的组件，可以根据数据渲染出需求想要的样式\n    \/\/ 当然这里为了简化，就仅仅只是输出数据就行了，在实际中，拿到数据之后还要进行相应的处理\n\n    request.getTypeInfo()\n        .then(function(resp) {\n\n            \/\/ 拿到数据，并执行处理操作\n            console.log(resp);\n        })\n\n    \/\/ 这样，我们就把请求数据，与处理数据分离开来，维护起来就更加方便了，代码结构也足够清晰\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ components\/calendar.js\x3c\/span\x3e\ndefine(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3erequire\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e request = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27request\x27\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 拿到数据之后，需要处理的组件，可以根据数据渲染出需求想要的样式\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 当然这里为了简化，就仅仅只是输出数据就行了，在实际中，拿到数据之后还要进行相应的处理\x3c\/span\x3e\n\n    request.getTypeInfo()\n        .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresp\x3c\/span\x3e) \x3c\/span\x3e{\n\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 拿到数据，并执行处理操作\x3c\/span\x3e\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(resp);\n        })\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这样，我们就把请求数据，与处理数据分离开来，维护起来就更加方便了，代码结构也足够清晰\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这就是我所了解的处理ajax的比较好的一个方式，如果你有其他更好的方式也欢迎分享。\x3c\/p\x3e\n\x3cp\x3e第二个应用场景就是图片加载的问题。\x3cbr\x3e在一些实际应用中，常常会有一些图片需要放置在某一个块中，比如头像，比如某些图片列表。可是源图片的尺寸可能很难保证长宽比例都是一致的，如果我们直接给图片设定宽高，就有可能导致图片变形。变形之后高大上的页面就直接垮掉了。\x3c\/p\x3e\n\x3cp\x3e因此为了解决这个问题，我们需要一个定制的image组件来解决这个问题。我们期望图片能够根据自己的宽高比，合理的缩放，保证在这个块中不变形的情况下尽可能的显示更多的内容。\x3c\/p\x3e\n\x3cp\x3e假如有一堆图片，如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3csection class=\x26quot;img-wrap\x26quot;\x3e\n    \x3cdiv class=\x26quot;img-center\x26quot;\x3e\n        ![](https:\/\/timgsa.baidu.com\/timg?image\x26amp;quality=80\x26amp;size=b9999_10000\x26amp;sec=1491191204817\x26amp;di=48ea9cde3319576ed6e0b6dc6c6b75b4\x26amp;imgtype=0\x26amp;src=http%3A%2F%2Fa.hiphotos.baidu.com%2Fzhidao%2Fpic%2Fitem%2F342ac65c103853438b3c5f8b9613b07ecb8088ad.jpg)\n    \x3c\/div\x3e\n\n    \x3cdiv class=\x26quot;img-center\x26quot;\x3e\n        ![](https:\/\/timgsa.baidu.com\/timg?image\x26amp;quality=80\x26amp;size=b9999_10000\x26amp;sec=1491191241712\x26amp;di=9dbd9c614b82f0b02c92c6e60875983a\x26amp;imgtype=0\x26amp;src=http%3A%2F%2Fpic5.qiyipic.com%2Fcommon%2F20130524%2F7dc5679567cd4243a0a41e5bf626ad77.jpg%3Fsrc%3Dfocustat_4_20130527_7)\n    \x3c\/div\x3e\n\n    \x3cdiv class=\x26quot;img-center\x26quot;\x3e\n        ![](https:\/\/timgsa.baidu.com\/timg?image\x26amp;quality=80\x26amp;size=b9999_10000\x26amp;sec=1491191271233\x26amp;di=0c9dd2677413beadcccd66b9d4598c6b\x26amp;imgtype=0\x26amp;src=http%3A%2F%2Fb.zol-img.com.cn%2Fdesk%2Fbizhi%2Fimage%2F4%2F960x600%2F1390442684896.jpg)\n    \x3c\/div\x3e\n\n    \x3cdiv class=\x26quot;img-center\x26quot;\x3e\n        ![](https:\/\/timgsa.baidu.com\/timg?image\x26amp;quality=80\x26amp;size=b9999_10000\x26amp;sec=1491191294538\x26amp;di=6474f3b560f2c100e62f118dde7e8d6c\x26amp;imgtype=0\x26amp;src=http%3A%2F%2Ff.hiphotos.baidu.com%2Fzhidao%2Fpic%2Fitem%2Fc9fcc3cec3fdfc03dfdfafcad23f8794a4c22618.jpg)\n    \x3c\/div\x3e\n\x3c\/section\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs llvm\x22\x3e\x3ccode\x3e\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3esection\x3c\/span\x3e class=\x3cspan class=\x22hljs-string\x22\x3e\x22img-wrap\x22\x3c\/span\x3e\x26gt;\n    \x26lt;div class=\x3cspan class=\x22hljs-string\x22\x3e\x22img-center\x22\x3c\/span\x3e\x26gt;\n        ![](https:\/\/timgsa.baidu.com\/timg?image\x26amp;quality=\x3cspan class=\x22hljs-number\x22\x3e80\x3c\/span\x3e\x26amp;size=b\x3cspan class=\x22hljs-number\x22\x3e9999\x3c\/span\x3e_\x3cspan class=\x22hljs-number\x22\x3e10000\x3c\/span\x3e\x26amp;sec=\x3cspan class=\x22hljs-number\x22\x3e1491191204817\x3c\/span\x3e\x26amp;di=\x3cspan class=\x22hljs-number\x22\x3e48\x3c\/span\x3eea\x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3ecde\x3cspan class=\x22hljs-number\x22\x3e3319576\x3c\/span\x3eed\x3cspan class=\x22hljs-number\x22\x3e6e0\x3c\/span\x3eb\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3edc\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ec\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3eb\x3cspan class=\x22hljs-number\x22\x3e75\x3c\/span\x3eb\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e\x26amp;imgtype=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\x26amp;src=http\x3cspan class=\x22hljs-symbol\x22\x3e%3\x3c\/span\x3eA\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eF\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eFa.hiphotos.baidu.com\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eFzhidao\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eFpic\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eFitem\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eF\x3cspan class=\x22hljs-number\x22\x3e342\x3c\/span\x3eac\x3cspan class=\x22hljs-number\x22\x3e65\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ec\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e103853438\x3c\/span\x3eb\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ec\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3ef\x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3eb\x3cspan class=\x22hljs-number\x22\x3e9613\x3c\/span\x3eb\x3cspan class=\x22hljs-number\x22\x3e07\x3c\/span\x3eecb\x3cspan class=\x22hljs-number\x22\x3e8088\x3c\/span\x3ead.jpg)\n    \x26lt;\/div\x26gt;\n\n    \x26lt;div class=\x3cspan class=\x22hljs-string\x22\x3e\x22img-center\x22\x3c\/span\x3e\x26gt;\n        ![](https:\/\/timgsa.baidu.com\/timg?image\x26amp;quality=\x3cspan class=\x22hljs-number\x22\x3e80\x3c\/span\x3e\x26amp;size=b\x3cspan class=\x22hljs-number\x22\x3e9999\x3c\/span\x3e_\x3cspan class=\x22hljs-number\x22\x3e10000\x3c\/span\x3e\x26amp;sec=\x3cspan class=\x22hljs-number\x22\x3e1491191241712\x3c\/span\x3e\x26amp;di=\x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3edbd\x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ec\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e614\x3c\/span\x3eb\x3cspan class=\x22hljs-number\x22\x3e82\x3c\/span\x3ef\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3eb\x3cspan class=\x22hljs-number\x22\x3e02\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ec\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e92\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ec\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e6e60875983\x3c\/span\x3ea\x26amp;imgtype=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\x26amp;src=http\x3cspan class=\x22hljs-symbol\x22\x3e%3\x3c\/span\x3eA\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eF\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eFpic\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e.qiyipic.com\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eFcommon\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eF\x3cspan class=\x22hljs-number\x22\x3e20130524\x3c\/span\x3e\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eF\x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3edc\x3cspan class=\x22hljs-number\x22\x3e5679567\x3c\/span\x3ecd\x3cspan class=\x22hljs-number\x22\x3e4243\x3c\/span\x3ea\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3ea\x3cspan class=\x22hljs-number\x22\x3e41e5\x3c\/span\x3ebf\x3cspan class=\x22hljs-number\x22\x3e626\x3c\/span\x3ead\x3cspan class=\x22hljs-number\x22\x3e77\x3c\/span\x3e.jpg\x3cspan class=\x22hljs-symbol\x22\x3e%3\x3c\/span\x3eFsrc\x3cspan class=\x22hljs-symbol\x22\x3e%3\x3c\/span\x3eDfocustat_\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e_\x3cspan class=\x22hljs-number\x22\x3e20130527\x3c\/span\x3e_\x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e)\n    \x26lt;\/div\x26gt;\n\n    \x26lt;div class=\x3cspan class=\x22hljs-string\x22\x3e\x22img-center\x22\x3c\/span\x3e\x26gt;\n        ![](https:\/\/timgsa.baidu.com\/timg?image\x26amp;quality=\x3cspan class=\x22hljs-number\x22\x3e80\x3c\/span\x3e\x26amp;size=b\x3cspan class=\x22hljs-number\x22\x3e9999\x3c\/span\x3e_\x3cspan class=\x22hljs-number\x22\x3e10000\x3c\/span\x3e\x26amp;sec=\x3cspan class=\x22hljs-number\x22\x3e1491191271233\x3c\/span\x3e\x26amp;di=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ec\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3edd\x3cspan class=\x22hljs-number\x22\x3e2677413\x3c\/span\x3ebeadcccd\x3cspan class=\x22hljs-number\x22\x3e66\x3c\/span\x3eb\x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3ed\x3cspan class=\x22hljs-number\x22\x3e4598\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ec\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3eb\x26amp;imgtype=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\x26amp;src=http\x3cspan class=\x22hljs-symbol\x22\x3e%3\x3c\/span\x3eA\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eF\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eFb.zol-img.com.cn\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eFdesk\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eFbizhi\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eFimage\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eF\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eF\x3cspan class=\x22hljs-number\x22\x3e960\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ex\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e600\x3c\/span\x3e\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eF\x3cspan class=\x22hljs-number\x22\x3e1390442684896\x3c\/span\x3e.jpg)\n    \x26lt;\/div\x26gt;\n\n    \x26lt;div class=\x3cspan class=\x22hljs-string\x22\x3e\x22img-center\x22\x3c\/span\x3e\x26gt;\n        ![](https:\/\/timgsa.baidu.com\/timg?image\x26amp;quality=\x3cspan class=\x22hljs-number\x22\x3e80\x3c\/span\x3e\x26amp;size=b\x3cspan class=\x22hljs-number\x22\x3e9999\x3c\/span\x3e_\x3cspan class=\x22hljs-number\x22\x3e10000\x3c\/span\x3e\x26amp;sec=\x3cspan class=\x22hljs-number\x22\x3e1491191294538\x3c\/span\x3e\x26amp;di=\x3cspan class=\x22hljs-number\x22\x3e6474\x3c\/span\x3ef\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3eb\x3cspan class=\x22hljs-number\x22\x3e560\x3c\/span\x3ef\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ec\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e100e62\x3c\/span\x3ef\x3cspan class=\x22hljs-number\x22\x3e118\x3c\/span\x3edde\x3cspan class=\x22hljs-number\x22\x3e7e8\x3c\/span\x3ed\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ec\x3c\/span\x3e\x26amp;imgtype=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\x26amp;src=http\x3cspan class=\x22hljs-symbol\x22\x3e%3\x3c\/span\x3eA\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eF\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eFf.hiphotos.baidu.com\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eFzhidao\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eFpic\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eFitem\x3cspan class=\x22hljs-symbol\x22\x3e%2\x3c\/span\x3eFc\x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3efcc\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3ecec\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3efdfc\x3cspan class=\x22hljs-number\x22\x3e03\x3c\/span\x3edfdfafcad\x3cspan class=\x22hljs-number\x22\x3e23\x3c\/span\x3ef\x3cspan class=\x22hljs-number\x22\x3e8794\x3c\/span\x3ea\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ec\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e22618\x3c\/span\x3e.jpg)\n    \x26lt;\/div\x26gt;\n\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3esection\x3c\/span\x3e\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e每一张图片都有一个包裹的div，这些div的宽高，就是我们期望图片能保持的宽高。\x3c\/p\x3e\n\x3cp\x3e当图片宽度值过大时，我们期望图片的高度为100%，并且左右居中。\x3cbr\x3e当图片高度值过大时，我们期望图片的宽度为100%，并且上下居中。\x3c\/p\x3e\n\x3cp\x3e根据这一点，我们来看看具体怎么实现。\x3c\/p\x3e\n\x3cp\x3e首先是样式的定义很重要。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22.img-center {\n    width: 200px;\n    height: 150px;\n    margin: 20px;\n    overflow: hidden;\n    position: relative;\n}\n\n.img-center img {\n    display: block;\n    position: absolute;\n}\n\n.img-center img.aspectFill-x {\n    width: 100%;\n    top: 50%;\n    transform: translateY(-50%);\n}\n\n.img-center img.aspectFill-y {\n    height: 100%;\n    left: 50%;\n    transform: translateX(-50%);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.img-center\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attribute\x22\x3ewidth\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e200px\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attribute\x22\x3eheight\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e150px\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attribute\x22\x3emargin\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e20px\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attribute\x22\x3eoverflow\x3c\/span\x3e: hidden;\n    \x3cspan class=\x22hljs-attribute\x22\x3eposition\x3c\/span\x3e: relative;\n}\n\n\x3cspan class=\x22hljs-selector-class\x22\x3e.img-center\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3eimg\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attribute\x22\x3edisplay\x3c\/span\x3e: block;\n    \x3cspan class=\x22hljs-attribute\x22\x3eposition\x3c\/span\x3e: absolute;\n}\n\n\x3cspan class=\x22hljs-selector-class\x22\x3e.img-center\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3eimg\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.aspectFill-x\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attribute\x22\x3ewidth\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e100%\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attribute\x22\x3etop\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e50%\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attribute\x22\x3etransform\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3etranslateY\x3c\/span\x3e(-50%);\n}\n\n\x3cspan class=\x22hljs-selector-class\x22\x3e.img-center\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3eimg\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.aspectFill-y\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attribute\x22\x3eheight\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e100%\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attribute\x22\x3eleft\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e50%\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attribute\x22\x3etransform\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3etranslateX\x3c\/span\x3e(-50%);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我分别定义了\x3ccode\x3easpectFill-x\x3c\/code\x3e与\x3ccode\x3easpectFill-y\x3c\/code\x3e，通过判断不同的宽高比，来决定将他们中的其中一个加入到img标签的class中去即可。\x3c\/p\x3e\n\x3cp\x3e获取图片的原始宽高，需要等到图片加载完毕之后才能获取。而当图片已经存在缓存时，则有一个compete属性变成true。那么我们就可以根据这些基础知识，定义一个模块来处理这件事情。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ components\/imageCenter.js\ndefine(function(require) {\n\n    \/\/ 利用Promise封装一个加载函数，这里也是可以单独放在一个功能模块中进一步优化\n    var imageLoad = function(img) {\n        return new Promise(function(resolve, reject) {\n            if (img.complete) {\n                resolve();\n            } else {\n                img.onload = function(event) {\n                    resolve(event);\n                }\n\n                img.onerror = function(err) {\n                    reject(err);\n                }\n            }\n        })\n    }\n\n    var imageCenter = function(domList, mode) {\n\n        domList.forEach(function(item) {\n            var img = item.children[0];\n            var itemW = item.offsetWidth;\n            var itemH = item.offsetHeight;\n            var itemR = itemW \/ itemH;\n\n            imageLoad(img).then(function() {\n                var imgW = img.naturalWidth;\n                var imgH = img.naturalHeight;\n                var imgR = imgW \/ imgH;\n\n                var resultMode = null;\n\n                switch (mode) {\n                    \/\/ 这样写是因为期待未来可以扩展其他的展示方式\n                    case \x27aspectFill\x27:\n                        resultMode = imgR \x3e 1 ? \x27aspectFill-x\x27 : \x27aspectFill-y\x27;\n                        break;\n                    case \x27wspectFill\x27:\n                        resultMode = itemR \x3e imgR ? \x27aspectFill-x\x27 : \x27aspectFill-y\x27\n                        break;\n                    default:\n                }\n\n                $(img).addClass(resultMode);\n            })\n        })\n    }\n\n    return imageCenter;\n})\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ components\/imageCenter.js\x3c\/span\x3e\ndefine(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3erequire\x3c\/span\x3e) \x3c\/span\x3e{\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 利用Promise封装一个加载函数，这里也是可以单独放在一个功能模块中进一步优化\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e imageLoad = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eimg\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (img.complete) {\n                resolve();\n            } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                img.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n                    resolve(event);\n                }\n\n                img.onerror = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e) \x3c\/span\x3e{\n                    reject(err);\n                }\n            }\n        })\n    }\n\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e imageCenter = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edomList, mode\x3c\/span\x3e) \x3c\/span\x3e{\n\n        domList.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e img = item.children[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e itemW = item.offsetWidth;\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e itemH = item.offsetHeight;\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e itemR = itemW \/ itemH;\n\n            imageLoad(img).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e imgW = img.naturalWidth;\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e imgH = img.naturalHeight;\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e imgR = imgW \/ imgH;\n\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e resultMode = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n\n                \x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e (mode) {\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这样写是因为期待未来可以扩展其他的展示方式\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27aspectFill\x27\x3c\/span\x3e:\n                        resultMode = imgR \x26gt; \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e ? \x3cspan class=\x22hljs-string\x22\x3e\x27aspectFill-x\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27aspectFill-y\x27\x3c\/span\x3e;\n                        \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n                    \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27wspectFill\x27\x3c\/span\x3e:\n                        resultMode = itemR \x26gt; imgR ? \x3cspan class=\x22hljs-string\x22\x3e\x27aspectFill-x\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27aspectFill-y\x27\x3c\/span\x3e\n                        \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n                    \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e:\n                }\n\n                $(img).addClass(resultMode);\n            })\n        })\n    }\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e imageCenter;\n})\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e那么在使用时，直接引入这个模块并调用imageCenter方法即可。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ index.js\nvar imageCenter = require(\x27imageCenter\x27);\nvar imageWrapList = document.querySelectorAll(\x27.img-center\x27);\nimageCenter(imageWrapList, \x27wspectFill\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dart\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ index.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e imageCenter = require(\x3cspan class=\x22hljs-string\x22\x3e\x27imageCenter\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e imageWrapList = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.\x3cspan class=\x22hljs-built_in\x22\x3equerySelectorAll\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.img-center\x27\x3c\/span\x3e);\nimageCenter(imageWrapList, \x3cspan class=\x22hljs-string\x22\x3e\x27wspectFill\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008932859\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008932859\x22 alt=\x22一堆尺寸乱七八糟的图片就这样被驯服了\x22 title=\x22一堆尺寸乱七八糟的图片就这样被驯服了\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e第三个应用场景，则是自定义弹窗的处理。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008932860\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008932860\x22 alt=\x22这种类型的弹窗随处可见，而且十分常用\x22 title=\x22这种类型的弹窗随处可见，而且十分常用\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e因此自己专门定义一个常用的弹窗就变得非常有必要，这对于我们开发效率的提高非常有帮助。当然，我这里只是简单的写了一个简陋的，仅供参考。\x3c\/p\x3e\n\x3cp\x3e我们期望的是利用Promise，当我们点击确认时，状态变成resolved，点击取消时，状态变成rejected。这样也方便将弹窗生成与后续的操作处理区分开来。\x3c\/p\x3e\n\x3cp\x3e先定义一个Dialog模块。使用的是最简单的方式定义，应该不会有什么理解上的困难。主要提供了show和hide2个方法，用于展示和隐藏。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ components\/Dialog.js\ndefine(function(require) {\n\n    \/\/ 利用闭包的特性，判断是否已经存在实例\n    var instance;\n\n    function Dialog(config) {\n\n        this.title = config.title ? config.title : \x27这是标题\x27;\n        this.content = config.content ? config.content : \x27这是提示内容\x27;\n\n        this.html = \x27\x3cdiv class=\x26quot;dialog-dropback\x26quot;\x3e\x27 \x2b\n            \x27\x3cdiv class=\x26quot;container\x26quot;\x3e\x27 \x2b\n                \x27\x3cdiv class=\x26quot;head\x26quot;\x3e\x27\x2b this.title \x2b\x27\x3c\/div\x3e\x27 \x2b\n                \x27\x3cdiv class=\x26quot;content\x26quot;\x3e\x27\x2b this.content \x2b\x27\x3c\/div\x3e\x27 \x2b\n                \x27\x3cdiv class=\x26quot;footer\x26quot;\x3e\x27 \x2b\n                    \x27\x3cbutton class=\x26quot;cancel\x26quot;\x3e取消\x3c\/button\x3e\x27 \x2b\n                    \x27\x3cbutton class=\x26quot;confirm\x26quot;\x3e确认\x3c\/button\x3e\x27 \x2b\n                \x27\x3c\/div\x3e\x27 \x2b\n            \x27\x3c\/div\x3e\x27 \x2b\n        \x27\x3c\/div\x3e\x27\n    }\n\n    Dialog.prototype = {\n        constructor: Dialog,\n        show: function() {\n            var _this = this;\n            if (instance) {\n                this.destory();\n            }\n            $(this.html).appendTo($(document.body));\n            instance = this;\n\n            return new Promise(function(resolve, reject) {\n                $(\x27.dialog-dropback .cancel\x27).on(\x27click\x27, function(e) {\n                    _this.hide();\n                    reject(e);\n                })\n\n                $(\x27.dialog-dropback .confirm\x27).on(\x27click\x27, function(e) {\n                    _this.hide();\n                    resolve(e);\n                })\n            })\n        },\n\n        destory: function() {\n            instance = null;\n            $(\x27.dialog-dropback .cancel\x27).off(\x27click\x27);\n            $(\x27.dialog-dropback .confirm\x27).off(\x27click\x27);\n            $(\x27.dialog-dropback\x27).remove();\n        },\n\n        hide: function() {\n            this.destory();\n        }\n    }\n\n    return function(config) {\n        return new Dialog(config);\n    }\n})\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ components\/Dialog.js\x3c\/span\x3e\ndefine(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3erequire\x3c\/span\x3e) \x3c\/span\x3e{\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 利用闭包的特性，判断是否已经存在实例\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e instance;\n\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eDialog\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3econfig\x3c\/span\x3e) \x3c\/span\x3e{\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.title = config.title ? config.title : \x3cspan class=\x22hljs-string\x22\x3e\x27这是标题\x27\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.content = config.content ? config.content : \x3cspan class=\x22hljs-string\x22\x3e\x27这是提示内容\x27\x3c\/span\x3e;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.html = \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div class=\x22dialog-dropback\x22\x26gt;\x27\x3c\/span\x3e \x2b\n            \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div class=\x22container\x22\x26gt;\x27\x3c\/span\x3e \x2b\n                \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div class=\x22head\x22\x26gt;\x27\x3c\/span\x3e\x2b \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.title \x2b\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;\/div\x26gt;\x27\x3c\/span\x3e \x2b\n                \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div class=\x22content\x22\x26gt;\x27\x3c\/span\x3e\x2b \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.content \x2b\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;\/div\x26gt;\x27\x3c\/span\x3e \x2b\n                \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div class=\x22footer\x22\x26gt;\x27\x3c\/span\x3e \x2b\n                    \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;button class=\x22cancel\x22\x26gt;取消\x26lt;\/button\x26gt;\x27\x3c\/span\x3e \x2b\n                    \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;button class=\x22confirm\x22\x26gt;确认\x26lt;\/button\x26gt;\x27\x3c\/span\x3e \x2b\n                \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;\/div\x26gt;\x27\x3c\/span\x3e \x2b\n            \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;\/div\x26gt;\x27\x3c\/span\x3e \x2b\n        \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;\/div\x26gt;\x27\x3c\/span\x3e\n    }\n\n    Dialog.prototype = {\n        \x3cspan class=\x22hljs-attr\x22\x3econstructor\x3c\/span\x3e: Dialog,\n        \x3cspan class=\x22hljs-attr\x22\x3eshow\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _this = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (instance) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.destory();\n            }\n            $(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.html).appendTo($(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body));\n            instance = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) \x3c\/span\x3e{\n                $(\x3cspan class=\x22hljs-string\x22\x3e\x27.dialog-dropback .cancel\x27\x3c\/span\x3e).on(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n                    _this.hide();\n                    reject(e);\n                })\n\n                $(\x3cspan class=\x22hljs-string\x22\x3e\x27.dialog-dropback .confirm\x27\x3c\/span\x3e).on(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n                    _this.hide();\n                    resolve(e);\n                })\n            })\n        },\n\n        \x3cspan class=\x22hljs-attr\x22\x3edestory\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            instance = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n            $(\x3cspan class=\x22hljs-string\x22\x3e\x27.dialog-dropback .cancel\x27\x3c\/span\x3e).off(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e);\n            $(\x3cspan class=\x22hljs-string\x22\x3e\x27.dialog-dropback .confirm\x27\x3c\/span\x3e).off(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e);\n            $(\x3cspan class=\x22hljs-string\x22\x3e\x27.dialog-dropback\x27\x3c\/span\x3e).remove();\n        },\n\n        \x3cspan class=\x22hljs-attr\x22\x3ehide\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.destory();\n        }\n    }\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3econfig\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Dialog(config);\n    }\n})\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e那么在另外一个模块中需要使用它时：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22define(function(require) {\n    var Dialog = require(\x27dialog\x27);\n\n    $(\x27button.aspect\x27).on(\x27click\x27, function() {\n        Dialog({\n            title: \x27友情提示\x27,\n            content: \x27外面空气不太好，你确定你要出门逛逛吗？\x27\n        }).show().then(function() {\n            console.log(\x27你点击了确认按钮.\x27);\n        }).catch(function() {\n            console.log(\x27你点击了取消按钮.\x27);\n        })\n    })\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3edefine(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3erequire\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e Dialog = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27dialog\x27\x3c\/span\x3e);\n\n    $(\x3cspan class=\x22hljs-string\x22\x3e\x27button.aspect\x27\x3c\/span\x3e).on(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        Dialog({\n            \x3cspan class=\x22hljs-attr\x22\x3etitle\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27友情提示\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3econtent\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27外面空气不太好，你确定你要出门逛逛吗？\x27\x3c\/span\x3e\n        }).show().then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27你点击了确认按钮.\x27\x3c\/span\x3e);\n        }).catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27你点击了取消按钮.\x27\x3c\/span\x3e);\n        })\n    })\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这三种场景就介绍完了，主要是需要大家通过源码来慢慢理解和揣摩。真正掌握之后，相信大家对于Promise在另外的场景中的使用也会变得得心应手。\x3c\/p\x3e\n\x3cp\x3e最后总结一下，这篇文章，涉及到的东西，有点多。大概包括Promise基础知识，ajax基础知识，如何利用Promise封装ajax，如何使用require模块系统，如何在模块中使用Promise，并且对应的三个应用场景又各自有许多需要了解的知识，因此对于基础稍差的朋友来说，理解透彻了肯定会有一个比较大的进步。当然也会花费你更多的时间。\x3c\/p\x3e\n\x3cp\x3e另外在我们的工作中还有一件非常重要的事情是需要我们持续去做的。那就是将常用的场景封装成为可以共用的模块，等到下次使用时，就可以直接拿来使用而节省非常多的开发时间。比如我这里对于img的处理，对于弹窗的处理，都是可以扩展成为一个通用的模块的。慢慢积累多了，你的开发效率就可以得到明显的提高，这些积累，也将会变成你的优势所在。\x3c\/p\x3e\n\x3cp\x3e后续的文章我会分享如何利用react与es6模块系统封装的共用组件，大家也可以学习了之后，根据自己的需求，封装最适合你自己的一套组件。\x3c\/p\x3e\n\x3cblockquote\x3e最后，最近问我怎么学习的人越来越多，我真的有点回答不过来了，我想把我这些文章里的知识都掌握了，应付毕业之后的第一份工作应该不是什么问题的吧？而且为了你们能够掌握Promise的使用，我还专门给读者老爷们创建了一个项目，列举了整整三个实例，还有源代码供你们学习，我学Promise的时候，找好久都没找到一个稍微接近实际应用的案例，学了好久才知道怎么使用，效率之低可想而知。所以静下心来慢慢学习吧，花点时间是值得的 ~ ~ 。\x3c\/blockquote\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000012646488\x22\x3e前端基础进阶系列目录\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV0emY?w=800\x26amp;h=300\x22 src=\x22https:\/\/static.alili.tech\/img\/bV0emY?w=800\x26amp;h=300\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>前端基础进阶（十三）：透彻掌握Promise的使用，读这篇就够了</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000012646402">https://segmentfault.com/a/1190000012646402</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/xbyfgz1o1z8/" target="_blank">https://alili.tech/archive/xbyfgz1o1z8/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>