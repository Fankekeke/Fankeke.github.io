<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="《Node.js在CLI下的工程化体系实践》成都OSC源创会分享总结"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>《Node.js在CLI下的工程化体系实践》成都OSC源创会分享总结 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/xj9uv2b0lv/",
				"appid": "1613049289050283", 
				"title": "《Node.js在CLI下的工程化体系实践》成都OSC源创会分享总结 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-30T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/oqn50rvq4ce/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/f5e5pieo9hl/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fxj9uv2b0lv%2f&text=%e3%80%8aNode.js%e5%9c%a8CLI%e4%b8%8b%e7%9a%84%e5%b7%a5%e7%a8%8b%e5%8c%96%e4%bd%93%e7%b3%bb%e5%ae%9e%e8%b7%b5%e3%80%8b%e6%88%90%e9%83%bdOSC%e6%ba%90%e5%88%9b%e4%bc%9a%e5%88%86%e4%ba%ab%e6%80%bb%e7%bb%93"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fxj9uv2b0lv%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fxj9uv2b0lv%2f&text=%e3%80%8aNode.js%e5%9c%a8CLI%e4%b8%8b%e7%9a%84%e5%b7%a5%e7%a8%8b%e5%8c%96%e4%bd%93%e7%b3%bb%e5%ae%9e%e8%b7%b5%e3%80%8b%e6%88%90%e9%83%bdOSC%e6%ba%90%e5%88%9b%e4%bc%9a%e5%88%86%e4%ba%ab%e6%80%bb%e7%bb%93"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fxj9uv2b0lv%2f&title=%e3%80%8aNode.js%e5%9c%a8CLI%e4%b8%8b%e7%9a%84%e5%b7%a5%e7%a8%8b%e5%8c%96%e4%bd%93%e7%b3%bb%e5%ae%9e%e8%b7%b5%e3%80%8b%e6%88%90%e9%83%bdOSC%e6%ba%90%e5%88%9b%e4%bc%9a%e5%88%86%e4%ba%ab%e6%80%bb%e7%bb%93"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fxj9uv2b0lv%2f&is_video=false&description=%e3%80%8aNode.js%e5%9c%a8CLI%e4%b8%8b%e7%9a%84%e5%b7%a5%e7%a8%8b%e5%8c%96%e4%bd%93%e7%b3%bb%e5%ae%9e%e8%b7%b5%e3%80%8b%e6%88%90%e9%83%bdOSC%e6%ba%90%e5%88%9b%e4%bc%9a%e5%88%86%e4%ba%ab%e6%80%bb%e7%bb%93"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e3%80%8aNode.js%e5%9c%a8CLI%e4%b8%8b%e7%9a%84%e5%b7%a5%e7%a8%8b%e5%8c%96%e4%bd%93%e7%b3%bb%e5%ae%9e%e8%b7%b5%e3%80%8b%e6%88%90%e9%83%bdOSC%e6%ba%90%e5%88%9b%e4%bc%9a%e5%88%86%e4%ba%ab%e6%80%bb%e7%bb%93&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fxj9uv2b0lv%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fxj9uv2b0lv%2f&title=%e3%80%8aNode.js%e5%9c%a8CLI%e4%b8%8b%e7%9a%84%e5%b7%a5%e7%a8%8b%e5%8c%96%e4%bd%93%e7%b3%bb%e5%ae%9e%e8%b7%b5%e3%80%8b%e6%88%90%e9%83%bdOSC%e6%ba%90%e5%88%9b%e4%bc%9a%e5%88%86%e4%ba%ab%e6%80%bb%e7%bb%93"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxj9uv2b0lv%2f&title=%e3%80%8aNode.js%e5%9c%a8CLI%e4%b8%8b%e7%9a%84%e5%b7%a5%e7%a8%8b%e5%8c%96%e4%bd%93%e7%b3%bb%e5%ae%9e%e8%b7%b5%e3%80%8b%e6%88%90%e9%83%bdOSC%e6%ba%90%e5%88%9b%e4%bc%9a%e5%88%86%e4%ba%ab%e6%80%bb%e7%bb%93"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxj9uv2b0lv%2f&title=%e3%80%8aNode.js%e5%9c%a8CLI%e4%b8%8b%e7%9a%84%e5%b7%a5%e7%a8%8b%e5%8c%96%e4%bd%93%e7%b3%bb%e5%ae%9e%e8%b7%b5%e3%80%8b%e6%88%90%e9%83%bdOSC%e6%ba%90%e5%88%9b%e4%bc%9a%e5%88%86%e4%ba%ab%e6%80%bb%e7%bb%93"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxj9uv2b0lv%2f&title=%e3%80%8aNode.js%e5%9c%a8CLI%e4%b8%8b%e7%9a%84%e5%b7%a5%e7%a8%8b%e5%8c%96%e4%bd%93%e7%b3%bb%e5%ae%9e%e8%b7%b5%e3%80%8b%e6%88%90%e9%83%bdOSC%e6%ba%90%e5%88%9b%e4%bc%9a%e5%88%86%e4%ba%ab%e6%80%bb%e7%bb%93"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">《Node.js在CLI下的工程化体系实践》成都OSC源创会分享总结</h1><div class="meta"><div class="postdate"><time datetime="2018-12-30" itemprop="datePublished">2018-12-30</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3e背景: 随着开发团队规模不断发展壮大，在人员增加的同时也带来了协作成本的增加，业务项目越来越多，类型也各不相同。常见的类型有组件类、活动类、基于React\x2bredux的业务项目、RN项目、Node.js项目等等。如果想要对每个项目进行一些规范的约束比如Git提交规范、Javascript规范简直难于登天。所有的这些，只因为缺少一个好用的工程化工具。从项目创建、开发、构建、代码规范检查到最终项目上线，通过CLI可以提升效率，同时保障开发规范的实施。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader0\x22\x3eNode.js实现CLI的基本原理\x3c\/h3\x3e\n\x3cp\x3e关键点在于package.json里面的bin字段。模块全局安装，对于类unix系统，在\/usr\/local\/bin目录创建软链接；对于windows系统，在C:\\Users\\username\\AppData\\Roaming\\npm目录创建软链接。\x3cbr\x3e模块局部安装，会在项目内的.\/node_modules\/.bin目录创建软链接。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e现代化web工程的生命周期\x3c\/h3\x3e\n\x3cp\x3e随着前端工程的不断演进，一方面工程变得日趋复杂，同时对规范和质量的诉求在不断增加。现代化web工程应该包含以下几个阶段：初始化、开发、构建、检查、发布。如下图所示：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011355232\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011355232\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e痛点1：项目拷贝\x3c\/h3\x3e\n\x3cp\x3e项目拷贝存在的问题显而易见，大致有以下三个方面：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e容易出错；一旦某个关键文件拷贝丢失或者错误，很可能需要耗费半天到一天的时间排查环境问题。\x3c\/li\x3e\n\x3cli\x3e不同场景下对目录结构要求不同；平时开发过程中，工程通常会分为运营活动、Hybrid业务、入口级别的项目（对性能和体验有极致和苛刻的要求）。需要基于RN或者Node.js的首屏直出，还有常用的业务组件等的开发。\x3c\/li\x3e\n\x3cli\x3e新的Feature和BugFix难以同步；某个同学开发过程中增加的新方法或者解决的bug很难传递给其它同学并且沉淀成经验积累下来。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e社区里面提供了完美的Yeoman解决方案，它是为了自动化项目的创建而生。Yeoman创建项目包括以下几个阶段：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3einitializing:  初始化一些状态之类的，通常是和用户输入的 options 或者 arguments 打交道\x3c\/li\x3e\n\x3cli\x3eprompting: 和用户交互的时候（命令行问答之类的）调用\x3c\/li\x3e\n\x3cli\x3econfiguring: 保存配置文件（如 .babelrc 等）\x3c\/li\x3e\n\x3cli\x3ewriting: 生成模板文件\x3c\/li\x3e\n\x3cli\x3einstall: 安装依赖\x3c\/li\x3e\n\x3cli\x3eend:  结束部分，初始代码自动提交\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e我们只需要继承Yeoman的Generator类做模板定制化，基于Yeoman的脚手架设计思路应该如下图所示：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011355233\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011355233\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e首先，开发者会和CLI进行交互，开发者会告诉CLI需要创建哪一种类型的项目，CLI收到命令后。从本地已经安装的Yeoman脚手架里面选择某种类型的模板。然后，CLI会调用Gitlab API在远程创建仓库并且授予开发者master权限。接下来，会根据实际业务场景需要，自动化申请一些打点信息，常见的如离线包id，监控告警id等等。之后，在本地目录生成代码并且安装项目依赖的npm包，最后将本次初始化生成的所有代码自动提交到远程Git仓库。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e痛点2：运营配置频繁修改\x3c\/h3\x3e\n\x3cp\x3e基于React\x2bredux组件化开发方式中，一个页面或者webapp是由多个容器组件拼装后渲染而成。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011355234\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011355234\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e某个组件通常是由：模板、cgi数据和事件组成。理想情况下，开发和产品和平共处，你可以把一个组件写成下面这个样子，比如规则组件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22render() {\n    return (\n        \x3cdiv className=\x26quot;lottery-rule\x26quot;\x3e\n            \x3cdiv className=\x26quot;section\x26quot;\x3e\n                \x3ch3\x3e活动时间：\x3c\/h3\x3e\n                \x3cp\x3e9月14日～9月30日\x3c\/p\x3e\n            \x3c\/div\x3e\n            \x3cdiv className=\x26quot;section\x26quot;\x3e\n                \x3ch3\x3e活动规则：\x3c\/h3\x3e\n                \x3cp\x3e1、活动期间，在NOW app上录制小视频，上传成功后即可参赛。\x3c\/p\x3e\n                \x3cp\x3e2、根据参赛小视频获得的点赞数进行排行。\x3c\/p\x3e\n                \x3cp\x3e3、按照城市评选，分别评选“明日之子”（仅限男性参加）和”闪亮女神“仅限女性参加。\x3c\/p\x3e\n            \x3c\/div\x3e\n        \x3c\/div\x3e\n    );\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3erender() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n        \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22lottery-rule\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22section\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e活动时间：\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e9月14日～9月30日\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22section\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e活动规则：\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e1、活动期间，在NOW app上录制小视频，上传成功后即可参赛。\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e2、根据参赛小视频获得的点赞数进行排行。\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e3、按照城市评选，分别评选“明日之子”（仅限男性参加）和”闪亮女神“仅限女性参加。\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n    );\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e咋一看，上面的写法没什么问题。实际确很可能是7、8次的文案修改，甚至对外入口开放后仍然要修改文案或者图片等静态数据。然后，你需要走代码发布流程。\x3c\/p\x3e\n\x3cp\x3e更好的解决思路是：在开发某个业务组件之前，结合以往的经验，分析哪些静态数据很可能是需要高频次的修改。将这些高频次修改的静态数据抽离出来，对于万年不变的数据则没有必要抽出来。那么，如何将静态数据动态化呢？\x3c\/p\x3e\n\x3cp\x3e答案是： \x3cstrong\x3e Schema First \x3c\/strong\x3e， 开发组件之前先设计Schema，通过schema生成一个form表单，达到静态数据和模板分离。如果使用React开发，可以基于\x3ca href=\x22https:\/\/github.com\/mozilla-services\/react-jsonschema-form\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-jsonschema-form\x3c\/a\x3e定制。静态数据和模板分离之后应该如下图：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011355235\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011355235\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e痛点3：缺少协作规范\x3c\/h3\x3e\n\x3cp\x3e此处以Git commit规范为例子进行相关改进介绍。\x3c\/p\x3e\n\x3cp\x3e良好的Git commit规范有以下优势：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e加快Review的流程\x3c\/li\x3e\n\x3cli\x3e根据Commit元数据生成Changelog\x3c\/li\x3e\n\x3cli\x3e后续维护者可以知道feature被添加的原因\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e此处采用Google angular项目的提交作为参考，整理出Git commit的解决方案：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011355236\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011355236\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e具体的提交格式要求如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3ctype\x3e(\x3cscope\x3e): \x3csubject\x3e\n\x3cBLANK LINE\x3e\n\x3cbody\x3e\n\x3cBLANK LINE\x3e\n\x3cfooter\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etype\x3c\/span\x3e\x26gt;\x3c\/span\x3e(\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escope\x3c\/span\x3e\x26gt;\x3c\/span\x3e): \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3esubject\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eBLANK\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eLINE\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eBLANK\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eLINE\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3efooter\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e对格式的说明如下：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3etype代表某次提交的类型，比如是修复一个bug还是增加一个新的feature。所有的type类型如下：\x3c\/li\x3e\n\x3cli\x3efeat： 新增feature\x3c\/li\x3e\n\x3cli\x3efix: 修复bug\x3c\/li\x3e\n\x3cli\x3edocs: 仅仅修改了文档，比如README, CHANGELOG, CONTRIBUTE等等\x3c\/li\x3e\n\x3cli\x3estyle: 仅仅修改了空格、格式缩进、都好等等，不改变代码逻辑\x3c\/li\x3e\n\x3cli\x3erefactor: 代码重构，没有加新功能或者修复bug\x3c\/li\x3e\n\x3cli\x3eperf: 优化相关，比如提升性能、体验\x3c\/li\x3e\n\x3cli\x3etest: 测试用例，包括单元测试、集成测试等\x3c\/li\x3e\n\x3cli\x3echore: 改变构建流程、或者增加依赖库、工具等\x3c\/li\x3e\n\x3cli\x3erevert: 回滚到上一个版本\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e一键生成Changelog版本日志：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011355237\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011355237\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e痛点4: 缺少代码规范\x3c\/h3\x3e\n\x3cp\x3e一次血淋淋的生产环境事故：2017年4月13日，腾讯高级工程师小圣在做充值业务时，修改了苹果iap支付配置，将JSON配置增加了重复的key。代码发布后，有小部分使用了vivo手机的用户反馈充值页面白屏，无法在Now app内进行充值。最后问题定位是：vivo手机使用了系统自带的webview而没有使用X5内核，解析JSON时遇到重复key报错，导致页面白屏。\x3c\/p\x3e\n\x3cp\x3e分析：现代化的浏览器对于JSON里面的重复key会做兼容处理，但是某些老旧的浏览器内核并不会，比如此处的vivo手机，导致代码直接出错。那么，如何避免类似问题再次出现呢？\x3c\/p\x3e\n\x3cp\x3e此处不得不提及ESLint，ESLint于2013年6月推出最新版本v4.6.0，是一款适用于Javascript和JSX的代码规范检查工具，相比JSLint和JSHint而言，它更加灵活，支持自定义配置、插件扩展和配置错误级别。虽然接入ESLint会给团队的同学增加不少代码修改的成本，但是从长远来看，收益肯定是大于付出的。\x3c\/p\x3e\n\x3cp\x3eJavascript规范制定的原则：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e不重复造轮子，基于eslint:recommend 配置并改进\x3c\/li\x3e\n\x3cli\x3e能够帮助发现代码错误的规则，全部开启\x3c\/li\x3e\n\x3cli\x3e配置不应该依赖于某个具体项目，而应尽可能的合理\x3c\/li\x3e\n\x3cli\x3e帮助保持团队的代码风格统一，而不是限制开发体验\x3c\/li\x3e\n\x3cli\x3e有对应的解释文档\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e为了更好的定制和维护Javascript规范，我们创建了eslint的\x3ca href=\x22https:\/\/github.com\/iv-web\/eslint-config-ivweb\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eshareable config\x3c\/a\x3e。一方面，我们觉得eslint:recommend 里面的部分配置定义的错误级别过于严格，比如代码里面出现了console会导致校验错误，另一方面，它没有包含ESLint的最佳实践和其它规则。我们定义的部分规则解释如下：\x3c\/p\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth align=\x22left\x22\x3e规则名称\x3c\/th\x3e\n\x3cth align=\x22left\x22\x3e错误级别\x3c\/th\x3e\n\x3cth align=\x22left\x22\x3e说明\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e\x3ca href=\x22https:\/\/eslint.org\/docs\/rules\/for-direction\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3efor-direction\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3eerror\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3efor 循环的方向要求必须正确\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e\x3ca href=\x22https:\/\/eslint.org\/docs\/rules\/getter-return\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3egetter-return\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3eerror\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3egetter必须有返回值，并且禁止返回值为undefined, 比如 return;\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e\x3ca href=\x22https:\/\/eslint.org\/docs\/rules\/no-await-in-loop\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eno-await-in-loop\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3eoff\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3e允许在循环里面使用await\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e\x3ca href=\x22https:\/\/eslint.org\/docs\/rules\/no-console\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eno-console\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3eoff\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3e允许在代码里面使用console\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e\x3ca href=\x22https:\/\/eslint.org\/docs\/rules\/no-prototype-builtins\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eno-prototype-builtins\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3ewarn\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3e直接调用对象原型链上的方法\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e\x3ca href=\x22https:\/\/eslint.org\/docs\/rules\/valid-jsdoc\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3evalid-jsdoc\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3eoff\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3e函数注释一定要遵守jsdoc规则\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e\x3ca href=\x22https:\/\/eslint.org\/docs\/rules\/no-template-curly-in-string\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eno-template-curly-in-string\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3ewarn\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3e在字符串里面出现{和}进行警告\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e\x3ca href=\x22https:\/\/eslint.org\/docs\/rules\/accessor-pairs\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eaccessor-pairs\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3ewarn\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3egetter和setter没有成对出现时给出警告\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e\x3ca href=\x22https:\/\/eslint.org\/docs\/rules\/array-callback-return\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3earray-callback-return\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3eerror\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3e对于数据相关操作函数比如reduce, map, filter等，callback必须有return\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e\x3ca href=\x22https:\/\/eslint.org\/docs\/rules\/block-scoped-var\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eblock-scoped-var\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3eerror\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3e把var关键字看成块级作用域，防止变量提升导致的bug\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e\x3ca href=\x22https:\/\/eslint.org\/docs\/rules\/class-methods-use-this\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eclass-methods-use-this\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3eerror\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3e要求在Class里面合理使用this，如果某个方法没有使用this,则应该申明为静态方法\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e\x3ca href=\x22https:\/\/eslint.org\/docs\/rules\/complexity\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ecomplexity\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3eoff\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3e关闭代码复杂度限制\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3e\x3ca href=\x22https:\/\/eslint.org\/docs\/rules\/default-case\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3edefault-case\x3c\/a\x3e\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3eerror\x3c\/td\x3e\n\x3ctd align=\x22left\x22\x3eswitch case语句里面一定需要default分支\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3cp\x3eESLint的执行可以接入到PUSH hook里面，步骤如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22#1, 安装husky\n$ npm install husky --save-dev\n\n#2, 集成进npm script\n{\n  \x26quot;scripts\x26quot;: {\n    \x26quot;precommit\x26quot;: \x26quot;validate-commit-msg\x26quot;,\n    \x26quot;prepush\x26quot;: \x26quot;eslint src .\/.eslintrc.js --ext \x27.js,.jsx\x27\x26quot;\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22bash hljs\x22\x3e\x3ccode class=\x22bash\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e#1, 安装husky\x3c\/span\x3e\n$ npm install husky --save-dev\n\n\x3cspan class=\x22hljs-comment\x22\x3e#2, 集成进npm script\x3c\/span\x3e\n{\n  \x3cspan class=\x22hljs-string\x22\x3e\x22scripts\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-string\x22\x3e\x22precommit\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22validate-commit-msg\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22prepush\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22eslint src .\/.eslintrc.js --ext \x27.js,.jsx\x27\x22\x3c\/span\x3e\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3eCLI设计\x3c\/h3\x3e\n\x3cp\x3eCLI的作用是将工程开发过程中遇到的一系列痛点问题连接起来，提升开发效率，同时保障规范的实施。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011355238\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011355238\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e插件设计\x3c\/h3\x3e\n\x3ch4\x3e插件实现原理\x3c\/h4\x3e\n\x3cp\x3e这里有一个非常巧妙的设计，通过使用node提供的module和vm模块，可以通注入feflow全局变量来访问到cli的实例。从而能够访问cli上的各种属性，比如config, log和一些helper等。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 loadPlugin(path, callback) {\n    const self = this;\n\n    return fs.readFile(path).then((script) =\x3e {\n\n      const module = new Module(path);\n      module.filename = path;\n      module.paths = Module._nodeModulePaths(path);\n\n      function require(path) {\n          return module.require(path);\n      }\n\n      require.resolve = function(request) {\n          return Module._resolveFilename(request, module);\n      };\n\n      require.main = process.mainModule;\n      require.extensions = Module._extensions;\n      require.cache = Module._cache;\n\n      \/\/ Inject feflow variable\n      script = \x27(function(exports, require, module, __filename, __dirname, feflow){\x27 \x2b\n          script \x2b \x27});\x27;\n\n      const fn = vm.runInThisContext(script, path);\n\n      return fn(module.exports, require, module, path, pathFn.dirname(path), self);\n      }).asCallback(callback);\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e loadPlugin(path, callback) {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e self = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e fs.readFile(path).then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3escript\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Module(path);\n      \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.filename = path;\n      \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.paths = Module._nodeModulePaths(path);\n\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3epath\x3c\/span\x3e) \x3c\/span\x3e{\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.require(path);\n      }\n\n      \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e.resolve = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3erequest\x3c\/span\x3e) \x3c\/span\x3e{\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e Module._resolveFilename(request, \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e);\n      };\n\n      \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e.main = process.mainModule;\n      \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e.extensions = Module._extensions;\n      \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e.cache = Module._cache;\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Inject feflow variable\x3c\/span\x3e\n      script = \x3cspan class=\x22hljs-string\x22\x3e\x27(function(exports, require, module, __filename, __dirname, feflow){\x27\x3c\/span\x3e \x2b\n          script \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27});\x27\x3c\/span\x3e;\n\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e fn = vm.runInThisContext(script, path);\n\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e fn(\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports, \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e, path, pathFn.dirname(path), self);\n      }).asCallback(callback);\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e命令注册：\x3c\/h4\x3e\n\x3cp\x3e命令需要以feflow.cmd.register进行注册，比如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22feflow.cmd.register(\x27deps\x27, \x27Config ivweb dependencies\x27, function(args) {\n    console.log(args); \n    \/\/ Plugin logic here.\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3efeflow.cmd.register(\x3cspan class=\x22hljs-string\x22\x3e\x27deps\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27Config ivweb dependencies\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eargs\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(args); \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Plugin logic here.\x3c\/span\x3e\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e说明：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eregister有3个参数，第一个是子命令名称，第二个是命令描述说明信息，第三个是对应的子命令执行逻辑函数。\x3c\/li\x3e\n\x3cli\x3efeflow会将命令行参数args解析成Object对象，传递给插件处理函数\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch4\x3e配置\x3c\/h4\x3e\n\x3cp\x3e可以通过feflow.version获取当前feflow的版本，feflow.baseDir 获取feflow跟目录（在用户目录下的.feflow），通过feflow.pluginDir 获取插件目录\x3c\/p\x3e\n\x3ch4\x3e日志\x3c\/h4\x3e\n\x3cp\x3e通过feflow.log来进行相关命令行日志输出\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const log = feflow.log;\nlog.info() \x26nbsp;  \/\/ 提示日志，控制台中显示绿色\nlog.debug() \x26nbsp; \/\/ 调试日志,  命令行增加--debug可以开启，控制台中显示灰色\nlog.warn() \x26nbsp;  \/\/ 警告日志，控制台中显示黄色背景\nlog.error() \x26nbsp; \/\/ 错误日志，控制台中显示红色\nlog.fatal() \x26nbsp; \/\/ 致命错误日志，，控制台中显示红色\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e log = feflow.log;\nlog.info() \x26nbsp;  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 提示日志，控制台中显示绿色\x3c\/span\x3e\nlog.debug() \x26nbsp; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 调试日志,  命令行增加--debug可以开启，控制台中显示灰色\x3c\/span\x3e\nlog.warn() \x26nbsp;  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 警告日志，控制台中显示黄色背景\x3c\/span\x3e\nlog.error() \x26nbsp; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 错误日志，控制台中显示红色\x3c\/span\x3e\nlog.fatal() \x26nbsp; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 致命错误日志，，控制台中显示红色\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e最后\x3c\/h3\x3e\n\x3cp\x3e感谢OSC源创汇提供的交流机会，能和广大开发者分享和交流学习，CLI源代码托管在Github和码云上：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eGithub主页：\x3ca href=\x22https:\/\/github.com\/cpselvis\/feflow-cli\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/cpselvis\/f...\x3c\/a\x3e\n\x3c\/li\x3e\n\x3cli\x3e码云主页：\x3ca href=\x22https:\/\/gitee.com\/cpselvis\/feflow-cli\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/gitee.com\/cpselvis\/fe...\x3c\/a\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e附件：\x3ca href=\x22https:\/\/github.com\/cpselvis\/sharing\/blob\/master\/ppt\/%E6%88%90%E9%83%BDOSC%E5%88%86%E4%BA%AB2017-09-23\/Node.js%E5%9C%A8CLI%E4%B8%8B%E5%B7%A5%E7%A8%8B%E5%8C%96%E4%BD%93%E7%B3%BB%E5%AE%9E%E8%B7%B5.pdf\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e本次分享PPT\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>《Node.js在CLI下的工程化体系实践》成都OSC源创会分享总结</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000011355227">https://segmentfault.com/a/1190000011355227</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/xj9uv2b0lv/" target="_blank">https://alili.tech/archive/xj9uv2b0lv/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>