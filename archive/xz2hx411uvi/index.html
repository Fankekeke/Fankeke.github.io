<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="JavaScript 社区由一个库引发的“smoosh门”事件到底怎么回事？"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>JavaScript 社区由一个库引发的“smoosh门”事件到底怎么回事？ | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/xz2hx411uvi/",
				"appid": "1613049289050283", 
				"title": "JavaScript 社区由一个库引发的“smoosh门”事件到底怎么回事？ | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-10T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/qlk7l3b8qc/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/nuzlwwjjtom/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fxz2hx411uvi%2f&text=JavaScript%20%e7%a4%be%e5%8c%ba%e7%94%b1%e4%b8%80%e4%b8%aa%e5%ba%93%e5%bc%95%e5%8f%91%e7%9a%84%e2%80%9csmoosh%e9%97%a8%e2%80%9d%e4%ba%8b%e4%bb%b6%e5%88%b0%e5%ba%95%e6%80%8e%e4%b9%88%e5%9b%9e%e4%ba%8b%ef%bc%9f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fxz2hx411uvi%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fxz2hx411uvi%2f&text=JavaScript%20%e7%a4%be%e5%8c%ba%e7%94%b1%e4%b8%80%e4%b8%aa%e5%ba%93%e5%bc%95%e5%8f%91%e7%9a%84%e2%80%9csmoosh%e9%97%a8%e2%80%9d%e4%ba%8b%e4%bb%b6%e5%88%b0%e5%ba%95%e6%80%8e%e4%b9%88%e5%9b%9e%e4%ba%8b%ef%bc%9f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fxz2hx411uvi%2f&title=JavaScript%20%e7%a4%be%e5%8c%ba%e7%94%b1%e4%b8%80%e4%b8%aa%e5%ba%93%e5%bc%95%e5%8f%91%e7%9a%84%e2%80%9csmoosh%e9%97%a8%e2%80%9d%e4%ba%8b%e4%bb%b6%e5%88%b0%e5%ba%95%e6%80%8e%e4%b9%88%e5%9b%9e%e4%ba%8b%ef%bc%9f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fxz2hx411uvi%2f&is_video=false&description=JavaScript%20%e7%a4%be%e5%8c%ba%e7%94%b1%e4%b8%80%e4%b8%aa%e5%ba%93%e5%bc%95%e5%8f%91%e7%9a%84%e2%80%9csmoosh%e9%97%a8%e2%80%9d%e4%ba%8b%e4%bb%b6%e5%88%b0%e5%ba%95%e6%80%8e%e4%b9%88%e5%9b%9e%e4%ba%8b%ef%bc%9f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=JavaScript%20%e7%a4%be%e5%8c%ba%e7%94%b1%e4%b8%80%e4%b8%aa%e5%ba%93%e5%bc%95%e5%8f%91%e7%9a%84%e2%80%9csmoosh%e9%97%a8%e2%80%9d%e4%ba%8b%e4%bb%b6%e5%88%b0%e5%ba%95%e6%80%8e%e4%b9%88%e5%9b%9e%e4%ba%8b%ef%bc%9f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fxz2hx411uvi%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fxz2hx411uvi%2f&title=JavaScript%20%e7%a4%be%e5%8c%ba%e7%94%b1%e4%b8%80%e4%b8%aa%e5%ba%93%e5%bc%95%e5%8f%91%e7%9a%84%e2%80%9csmoosh%e9%97%a8%e2%80%9d%e4%ba%8b%e4%bb%b6%e5%88%b0%e5%ba%95%e6%80%8e%e4%b9%88%e5%9b%9e%e4%ba%8b%ef%bc%9f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxz2hx411uvi%2f&title=JavaScript%20%e7%a4%be%e5%8c%ba%e7%94%b1%e4%b8%80%e4%b8%aa%e5%ba%93%e5%bc%95%e5%8f%91%e7%9a%84%e2%80%9csmoosh%e9%97%a8%e2%80%9d%e4%ba%8b%e4%bb%b6%e5%88%b0%e5%ba%95%e6%80%8e%e4%b9%88%e5%9b%9e%e4%ba%8b%ef%bc%9f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxz2hx411uvi%2f&title=JavaScript%20%e7%a4%be%e5%8c%ba%e7%94%b1%e4%b8%80%e4%b8%aa%e5%ba%93%e5%bc%95%e5%8f%91%e7%9a%84%e2%80%9csmoosh%e9%97%a8%e2%80%9d%e4%ba%8b%e4%bb%b6%e5%88%b0%e5%ba%95%e6%80%8e%e4%b9%88%e5%9b%9e%e4%ba%8b%ef%bc%9f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxz2hx411uvi%2f&title=JavaScript%20%e7%a4%be%e5%8c%ba%e7%94%b1%e4%b8%80%e4%b8%aa%e5%ba%93%e5%bc%95%e5%8f%91%e7%9a%84%e2%80%9csmoosh%e9%97%a8%e2%80%9d%e4%ba%8b%e4%bb%b6%e5%88%b0%e5%ba%95%e6%80%8e%e4%b9%88%e5%9b%9e%e4%ba%8b%ef%bc%9f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">JavaScript 社区由一个库引发的“smoosh门”事件到底怎么回事？</h1><div class="meta"><div class="postdate"><time datetime="2018-12-10" itemprop="datePublished">2018-12-10</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e原文: \x3ca href=\x22https:\/\/developers.google.com\/web\/updates\/2018\/03\/smooshgate\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e#SmooshGate FAQ\x3c\/a\x3e\x3cbr\x3e作者：\x3ca href=\x22https:\/\/developers.google.com\/web\/resources\/contributors\/mathiasbynens\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMathias Bynens\x3c\/a\x3e\n\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e\n\x3cstrong\x3esmoosh\x3c\/strong\x3e？！发生了什么？！\x3c\/h2\x3e\n\x3cp\x3e一项名为 JavaScript 功能的\x3ca href=\x22https:\/\/tc39.github.io\/proposal-flatMap\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e提案\x3c\/a\x3e \x3ccode\x3eArray.prototype.flatten\x3c\/code\x3e 证明与 Web 不兼容。在 Firefox Nightly 中发布该功能会导致\x3ca href=\x22https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1443630\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e至少一个受欢迎的网站\x3c\/a\x3e中断。鉴于有问题的代码是广泛使用的 MooTools 库的一部分，很可能会有更多网站受到影响。（尽管 MooTools 在 2018 年并不常用于新网站，但它曾经非常流行，并且仍然存在于许多已经正在运行的网站上。）\x3c\/p\x3e\n\x3cp\x3e该提案笔者开玩笑地建议\x3ca href=\x22https:\/\/github.com\/tc39\/proposal-flatMap\/pull\/56\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e把 \x3ccode\x3eflatten\x3c\/code\x3e 重命名为 \x3ccode\x3esmoosh\x3c\/code\x3e\x3c\/a\x3e，以避免兼容性问题。\x3c\/p\x3e\n\x3cp\x3e但是，并非所有人都知道这是一个笑话，有些人开始错误地认为这个新名字已经被确定，并且事情迅速升级。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e\n\x3ccode\x3eArray.prototype.flatten\x3c\/code\x3e 是什么？\x3c\/h2\x3e\n\x3cp\x3e\x3ccode\x3eArray.prototype.flatten\x3c\/code\x3e 递归地将数组展按照指定的 \x3ccode\x3edepth\x3c\/code\x3e 进行展平，\x3ccode\x3edepth\x3c\/code\x3e 的默认值为 \x3ccode\x3e1\x3c\/code\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Flatten one level:\nconst array = [1, [2, [3]]];\narray.flatten();\n\/\/ → [1, 2, [3]]\n\n\/\/ Flatten recursively until the array contains no more nested arrays:\narray.flatten(Infinity);\n\/\/ → [1, 2, 3]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Flatten one level:\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e array = [\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, [\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, [\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e]]];\narray.flatten();\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ → [1, 2, [3]]\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Flatten recursively until the array contains no more nested arrays:\x3c\/span\x3e\narray.flatten(\x3cspan class=\x22hljs-literal\x22\x3eInfinity\x3c\/span\x3e);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ → [1, 2, 3]\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e同样的提议还包括 \x3ccode\x3eArray.prototype.flatMap\x3c\/code\x3e，如同 \x3ccode\x3eArray.prototype.map\x3c\/code\x3e 一样，可以在参数里面传递一个回调函数。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22[2, 3, 4].flatMap((x) =\x3e [x, x * 2]);\n\/\/ → [2, 4, 3, 6, 4, 8]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e[\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e].flatMap(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3ex\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e [x, x * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e]);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ → [2, 4, 3, 6, 4, 8]\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3eMooTools 导致了什么问题？\x3c\/h2\x3e\n\x3cp\x3eMooTools 定义了他们自己的非标准版本 \x3ccode\x3eArray.prototype.flatten\x3c\/code\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Array.prototype.flatten = \/* non-standard implementation *\/;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e.prototype.flatten = \x3cspan class=\x22hljs-comment\x22\x3e\/* non-standard implementation *\/\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eMooTools 的 \x3ccode\x3eflatten\x3c\/code\x3e 实现与建议的标准不同。但是，这并不是问题！当浏览器提供了原生的 \x3ccode\x3eArray.prototype.flatten\x3c\/code\x3e 时，MooTools 会覆盖原生实现。这可确保依赖 MooTools 的代码按预期运行，无论原生 \x3ccode\x3eflatten\x3c\/code\x3e 是否可用。到现在为止还挺好！\x3c\/p\x3e\n\x3cp\x3e不幸的是，发生了其他事情。MooTools 将其所有自定义数组方法复制到 \x3ccode\x3eElements.prototype\x3c\/code\x3e（\x3ccode\x3eElements\x3c\/code\x3e 是 MooTools 特定的 API）：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22for (var key in Array.prototype) {\n  Elements.prototype[key] = Array.prototype[key];\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e key \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e.prototype) {\n  Elements.prototype[key] = \x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e.prototype[key];\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3efor\x3c\/code\x3e-\x3ccode\x3ein\x3c\/code\x3e 遍历“可枚举”属性，其中不包括像原生方法 \x3ccode\x3eArray.prototype.sort\x3c\/code\x3e，而是包括自定义的属性\x3ccode\x3eArray.prototype.foo = whatever\x3c\/code\x3e。但是 - 背锅开始了 - 如果你覆盖了一个非枚举属性，例如 \x3ccode\x3eArray.prototype.sort = whatever\x3c\/code\x3e，那么这个属性仍然是不可枚举的。\x3c\/p\x3e\n\x3cp\x3e目前，\x3ccode\x3eArray.prototype.flatten = mooToolsFlattenImplementation\x3c\/code\x3e 创建一个枚举 \x3ccode\x3eflatten\x3c\/code\x3e 属性，所以它以后会被复制到 \x3ccode\x3eElements\x3c\/code\x3e。但是，如果我们发布原生版本的 \x3ccode\x3eflatten\x3c\/code\x3e，它将变得不可枚举，并且不会被复制到 \x3ccode\x3eElements\x3c\/code\x3e。\x3cstrong\x3e现在，任何使用 MooTools 并依赖于 \x3ccode\x3eElements.prototype.flatten\x3c\/code\x3e 的代码都被破坏了\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e尽管将原生 \x3ccode\x3eArray.prototype.flatten\x3c\/code\x3e 变为可枚举可能会解决问题，但它可能会导致更多的兼容性问题。每个依赖于 \x3ccode\x3efor\x3c\/code\x3e-\x3ccode\x3ein\x3c\/code\x3e 遍历数组（这是一个糟糕的做法，但它经常被使用）的网站会突然得到该 \x3ccode\x3eflatten\x3c\/code\x3e 属性的循环迭代。\x3c\/p\x3e\n\x3cp\x3e这里更大的底层问题是修改内置对象。现在扩展本地原型通常被认为是一种不好的做法，因为它不能很好地与其他库和第三方代码结合。不要修改不属于你的对象！\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e我们为什么不保留现有名称并打破网络？\x3c\/h2\x3e\n\x3cp\x3e1996 年，在 CSS 广泛传播之前，早在“HTML5”之前，\x3ca href=\x22https:\/\/www.warnerbros.com\/archive\/spacejam\/movie\/jam.htm\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eSpace Jam 网站\x3c\/a\x3e就已经开始运行了。今天，该网站已经顺利运行 22年了。\x3c\/p\x3e\n\x3cp\x3e这是怎么做到的呢？这些年有没有人维护该网站，每次浏览器供应商发布新功能时都会更新它？\x3c\/p\x3e\n\x3cp\x3e事实证明，“不要打破网络”是 HTML，CSS，JavaScript 和 Web 任何标准上都广泛使用的头号\x3ca href=\x22https:\/\/www.w3.org\/TR\/html-design-principles\/#support-existing-content\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e设计原则\x3c\/a\x3e。如果发布新的浏览器功能导致现有网站停止工作，那对每个人都不利：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e受影响网站的访问者突然得到一个破坏的用户体验;\x3c\/li\x3e\n\x3cli\x3e网站所有者从一个完美的网站变成了一个没有功能的网站，而网站所有者却并没有改变任何东西;\x3c\/li\x3e\n\x3cli\x3e用户看到“只支持 XXX 浏览器”之后切换浏览器，因此推出新功能的浏览器供应商失去了市场份额。\x3c\/li\x3e\n\x3cli\x3e一旦知道兼容性问题，其他浏览器供应商拒绝实现此特性。导致某特性的规范与实际实现情况不符（“\x3ca href=\x22https:\/\/www.webstandards.org\/2009\/05\/13\/interview-with-ian-hickson-editor-of-the-html-5-specification\/#about-browsers\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e只是虚构的作品\x3c\/a\x3e”），这对标准化过程不利。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e当然，回想起来 MooTools 做错了一件事 - 但是打破网络并不惩罚它们（MooTools），而是会惩罚用户。这些用户不知道 MooTools 是什么。\x3c\/p\x3e\n\x3cp\x3e或者，我们可以找到另一种解决方案，用户可以继续使用网络。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e这是否意味着无法从 Web 平台中删除不好的 API？\x3c\/h2\x3e\n\x3cp\x3e在极少数情况下，\x3ca href=\x22https:\/\/whatwg.org\/faq#removing-bad-ideas\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e可以从网络中删除不良的功能\x3c\/a\x3e。即使仅仅弄清楚是否可以删除一个功能也是非常棘手的工作，需要大量的遥测来量化有多少网页会改变他们的行为。但是，如果功能足够不安全，对用户有害，或者很少使用，则可以完成此操作。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3e\x26lt;applet\x26gt;\x3c\/code\x3e，\x3ccode\x3e\x26lt;keygen\x26gt;\x3c\/code\x3e 和 \x3ca href=\x22https:\/\/dev.opera.com\/blog\/showmodaldialog\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3ccode\x3eshowModalDialog()\x3c\/code\x3e\x3c\/a\x3e 都是从 Web 平台成功删除的错误 API 的示例。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e为什么不修复 MooTools？\x3c\/h2\x3e\n\x3cp\x3e修补 MooTools 以便它不再扩展内置对象是个不错的主意。但是，它并没有解决手头的问题。即使 MooTools 发布补丁版本，所有使用它的现有网站也必须更新，这样兼容性问题才能消失。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e能不能只更新网站中使用的 MooTools 副本？\x3c\/h2\x3e\n\x3cp\x3e在理想情况下 MooTools 会发布一个补丁，每个使用 MooTools 的网站都会在第二天神奇地更新。问题解决了，对吧？！\x3c\/p\x3e\n\x3cp\x3e不幸的是，这是不现实的。即使有人以某种方式识别了整套受影响的网站，也可以设法找到每一个网站的联系信息，成功地与所有网站所有者联系并说服他们全部执行更新（这可能意味着重构他们的网站完整的代码库），整个过程最多需要几年的时间。\x3c\/p\x3e\n\x3cp\x3e请记住，这些网站很多都是旧的，可​​能无法维护。即使维护人员仍然在身边，也可能他们不是像您一样的高技能 Web 开发人员。由于网络兼容性问题，我们不能指望每个人都去改变他们已经运行了七八年的网站。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3eTC39 的工作流程是什么样的？\x3c\/h2\x3e\n\x3cp\x3eJavaScript 语言基于 ECMAScript 标准，TC39 是负责 JavaScript 语言更新发展的委员会\x3c\/p\x3e\n\x3cp\x3e“Smoosh门”事件使得一些人误认为“TC39 想要把 \x3ccode\x3eflatten\x3c\/code\x3e 重新命名为 \x3ccode\x3esmoosh\x3c\/code\x3e”，但这是一个没有很好沟通的笑话。重命名提案等重大决策不会被轻视，不会被单个人采纳，并且绝对不会在 GitHub 的评论上完成。\x3c\/p\x3e\n\x3cp\x3eTC39 对于功能提案有着清晰得分级过程。ECMAScript 提案及其任何重大变更（包括方法更新）在 TC39 会议期间进行讨论，并且需要整个委员会批准后方可正式提交。在这种情况下 \x3ccode\x3eArray.prototype.flatten\x3c\/code\x3e 提案已经经历了好几个阶段的讨论，一直到 Stage 3，表明该功能已准备好在 Web 浏览器中实现。实施过程中出现其他规范问题很常见。在这种情况下，最重要的反馈意见是在试图发布它之后才有的：该特性在当前状态下打破了 Web。即使浏览器发布新功能后 TC39 的流程并没有结束，就是因为这些难以预测的问题。\x3c\/p\x3e\n\x3cp\x3eTC39 以协商一致的方式运作，这意味着委员会必须就任何新的变化达成一致。即使 \x3ccode\x3esmoosh\x3c\/code\x3e 是一个严肃的建议，委员会成员似乎也可能会反对，而是赞成使用更常见的名称，例如 \x3ccode\x3ecompact\x3c\/code\x3e 或 \x3ccode\x3echain\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e把 \x3ccode\x3eflatten\x3c\/code\x3e 重命名为 \x3ccode\x3esmoosh\x3c\/code\x3e（即使它不是一个笑话）从未在 TC39 会议上讨论。因此，关于这个问题的官方 TC39 立场目前是未知的。在下次会议达成共识之前，没有任何一个人可以代表所有 TC39 发言。\x3c\/p\x3e\n\x3cp\x3eTC39 会议通常由具有高度多样化背景的人士出席：一些人拥有多年的编程语言设计经验，另一些人使用浏览器或 JavaScript 引擎工作，越来越多的 JavaScript 开发人员社区参与者。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e接下来发生什么？\x3c\/h2\x3e\n\x3cp\x3e下一次 TC39 会议将于本周举行。\x3ca href=\x22https:\/\/github.com\/tc39\/agendas\/blob\/master\/2018\/03.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e议程中\x3c\/a\x3e有一项讨论 \x3ccode\x3eflatten\x3c\/code\x3e 及其网络兼容性问题。希望在会议结束后我们会更多地了解下一步。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>JavaScript 社区由一个库引发的“smoosh门”事件到底怎么回事？</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000013855516">https://segmentfault.com/a/1190000013855516</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/xz2hx411uvi/" target="_blank">https://alili.tech/archive/xz2hx411uvi/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>