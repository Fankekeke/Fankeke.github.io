<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="做一个可复用的 echarts-vue 组件（延迟动画加载）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>做一个可复用的 echarts-vue 组件（延迟动画加载） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/z6h4liz7mmo/",
				"appid": "1613049289050283", 
				"title": "做一个可复用的 echarts-vue 组件（延迟动画加载） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-12-18T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/jlhloj2tlvs/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/ji6a2q4pn1/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fz6h4liz7mmo%2f&text=%e5%81%9a%e4%b8%80%e4%b8%aa%e5%8f%af%e5%a4%8d%e7%94%a8%e7%9a%84%20echarts-vue%20%e7%bb%84%e4%bb%b6%ef%bc%88%e5%bb%b6%e8%bf%9f%e5%8a%a8%e7%94%bb%e5%8a%a0%e8%bd%bd%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fz6h4liz7mmo%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fz6h4liz7mmo%2f&text=%e5%81%9a%e4%b8%80%e4%b8%aa%e5%8f%af%e5%a4%8d%e7%94%a8%e7%9a%84%20echarts-vue%20%e7%bb%84%e4%bb%b6%ef%bc%88%e5%bb%b6%e8%bf%9f%e5%8a%a8%e7%94%bb%e5%8a%a0%e8%bd%bd%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fz6h4liz7mmo%2f&title=%e5%81%9a%e4%b8%80%e4%b8%aa%e5%8f%af%e5%a4%8d%e7%94%a8%e7%9a%84%20echarts-vue%20%e7%bb%84%e4%bb%b6%ef%bc%88%e5%bb%b6%e8%bf%9f%e5%8a%a8%e7%94%bb%e5%8a%a0%e8%bd%bd%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fz6h4liz7mmo%2f&is_video=false&description=%e5%81%9a%e4%b8%80%e4%b8%aa%e5%8f%af%e5%a4%8d%e7%94%a8%e7%9a%84%20echarts-vue%20%e7%bb%84%e4%bb%b6%ef%bc%88%e5%bb%b6%e8%bf%9f%e5%8a%a8%e7%94%bb%e5%8a%a0%e8%bd%bd%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%81%9a%e4%b8%80%e4%b8%aa%e5%8f%af%e5%a4%8d%e7%94%a8%e7%9a%84%20echarts-vue%20%e7%bb%84%e4%bb%b6%ef%bc%88%e5%bb%b6%e8%bf%9f%e5%8a%a8%e7%94%bb%e5%8a%a0%e8%bd%bd%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fz6h4liz7mmo%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fz6h4liz7mmo%2f&title=%e5%81%9a%e4%b8%80%e4%b8%aa%e5%8f%af%e5%a4%8d%e7%94%a8%e7%9a%84%20echarts-vue%20%e7%bb%84%e4%bb%b6%ef%bc%88%e5%bb%b6%e8%bf%9f%e5%8a%a8%e7%94%bb%e5%8a%a0%e8%bd%bd%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fz6h4liz7mmo%2f&title=%e5%81%9a%e4%b8%80%e4%b8%aa%e5%8f%af%e5%a4%8d%e7%94%a8%e7%9a%84%20echarts-vue%20%e7%bb%84%e4%bb%b6%ef%bc%88%e5%bb%b6%e8%bf%9f%e5%8a%a8%e7%94%bb%e5%8a%a0%e8%bd%bd%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fz6h4liz7mmo%2f&title=%e5%81%9a%e4%b8%80%e4%b8%aa%e5%8f%af%e5%a4%8d%e7%94%a8%e7%9a%84%20echarts-vue%20%e7%bb%84%e4%bb%b6%ef%bc%88%e5%bb%b6%e8%bf%9f%e5%8a%a8%e7%94%bb%e5%8a%a0%e8%bd%bd%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fz6h4liz7mmo%2f&title=%e5%81%9a%e4%b8%80%e4%b8%aa%e5%8f%af%e5%a4%8d%e7%94%a8%e7%9a%84%20echarts-vue%20%e7%bb%84%e4%bb%b6%ef%bc%88%e5%bb%b6%e8%bf%9f%e5%8a%a8%e7%94%bb%e5%8a%a0%e8%bd%bd%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">做一个可复用的 echarts-vue 组件（延迟动画加载）</h1><div class="meta"><div class="postdate"><time datetime="2018-12-18" itemprop="datePublished">2018-12-18</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e在 vue 项目使用 echarts 的场景中，以下三点不容忽视：1. 可视化的数据往往是异步加载的；2. 若一个页面存在大量的图表（ 尤其当存在关系图和地图时 ），往往会导致该页面的渲染速度很慢并可能在几秒内卡死，产生极差的用户体验。3. 引入 echarts 组件导致编译后的文件过大从而使得首次访问的加载极慢。关于第三点，大家可以参考之前的撰文\x26nbsp;\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000010955172#articleHeader2\x22\x3e优化 Vue 项目编译文件大小\x3c\/a\x3e。以下针对上述前两点，给出数据异步、延迟渲染的 echarts vue 组件的设计和实现方式，并对实现之中可能存在的问题进行介绍。\x3c\/blockquote\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3e1. 抽离 echarts 公共部分形成基础组件\x3c\/h1\x3e\n\x3chr\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e1.1 调研公共部分\x3c\/h3\x3e\n\x3cp\x3e首先，我们需要把 echarts 使用中公共的部分抽离出来，形成基础组件。\x3c\/p\x3e\n\x3cp\x3e让我们在\x26nbsp;\x3ca href=\x22http:\/\/echarts.baidu.com\/tutorial.html#5%20%E5%88%86%E9%92%9F%E4%B8%8A%E6%89%8B%20ECharts\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e官网 - 5 分钟上手 ECharts\x3c\/a\x3e\x26nbsp;教程中找到使用 echarts 的步骤：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22# 1. 获取一个用于挂在 echarts 的 DOM 元素\nlet $echartsDOM = document.getElementById(\x27echarts-dom\x27)\n\n# 2. 初始化\nlet myEcharts = echarts.init($echartsDOM)\n\n# 3. 设置配置项\nlet option = {...}\n\n# 4. 为 echarts 指定配置\nmyEcharts.setOption(option)\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs nimrod\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e# 1. 获取一个用于挂在 echarts 的 DOM 元素\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e $echartsDOM = document.getElementById(\x27echarts-dom\x27)\n\n\x3cspan class=\x22hljs-comment\x22\x3e# 2. 初始化\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e myEcharts = echarts.init($echartsDOM)\n\n\x3cspan class=\x22hljs-comment\x22\x3e# 3. 设置配置项\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e option = \x3cspan class=\x22hljs-meta\x22\x3e{...}\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e# 4. 为 echarts 指定配置\x3c\/span\x3e\nmyEcharts.setOption(option)\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch6\x3e注：在 Vue 中，首先我们需要使用 import echarts from \x27echarts\x27 以引入 echarts。\x3c\/h6\x3e\n\x3cp\x3e由上可知，在 echarts 使用中，除第三步设置配置项以外，其他的步骤都是重复的，即可以抽离出来放入组件中统一实现。\x3c\/p\x3e\n\x3ch6\x3e注：其实 option 配置中也存在可以抽离的部分，比如我们可以将 echarts 的颜色、散点大小、折线粗细等提取出来统一赋值，以保证 echarts 风格的统一。但由于不同类型的 ehcarts 图的颜色配置方式不同，因而实现起来相对繁琐，这里不进行说明，有兴趣的同学可以自行尝试。\x3c\/h6\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e1.2 实现 echarts 功能\x3c\/h3\x3e\n\x3cp\x3e首先我们书写一个简单 \x3ccode\x3eehcart.vue\x3c\/code\x3e，其中，配置项直接复制于官网的教程示例。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cstyle scoped\x3e\n    .echarts {\n        width: 100%;\n        height: 100%;\n    }\n\x3c\/style\x3e\n\n\x3ctemplate\x3e\n    \x3cdiv\x3e\n        \x3cdiv class=\x26quot;echarts\x26quot; id=\x26quot;echarts-dom\x26quot;\x3e\x3c\/div\x3e\n    \x3c\/div\x3e\n\x3c\/template\x3e\n\n\x3cscript\x3e\n    import echarts from \x27echarts\x27\n\n     export default {\n        name: \x27echarts\x27,\n        data() {\n            return {}\n        },\n        mounted() {\n            let $echartsDOM = document.getElementById(\x27echarts-dom\x27)\n            let myEcharts = echarts.init($echartsDOM)\n            let option = {\n                title: {\n                    text: \x27ECharts 入门示例\x27\n                },\n                tooltip: {},\n                legend: {\n                    data: [\x27销量\x27]\n                },\n                xAxis: {\n                    data: [\x26quot;衬衫\x26quot;, \x26quot;羊毛衫\x26quot;, \x26quot;雪纺衫\x26quot;, \x26quot;裤子\x26quot;, \x26quot;高跟鞋\x26quot;, \x26quot;袜子\x26quot;]\n                },\n                yAxis: {},\n                series: [{\n                    name: \x27销量\x27,\n                    type: \x27bar\x27,\n                    data: [5, 20, 36, 10, 10, 20]\n                }]\n            }\n            myEcharts.setOption(option)\n        }\n    }\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3estyle\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3escoped\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22css\x22\x3e\n    \x3cspan class=\x22hljs-selector-class\x22\x3e.echarts\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-attribute\x22\x3ewidth\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e100%\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-attribute\x22\x3eheight\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e100%\x3c\/span\x3e;\n    }\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3estyle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22echarts\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22echarts-dom\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e echarts \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27echarts\x27\x3c\/span\x3e\n\n     \x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27echarts\x27\x3c\/span\x3e,\n        data() {\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {}\n        },\n        mounted() {\n            \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e $echartsDOM = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27echarts-dom\x27\x3c\/span\x3e)\n            \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e myEcharts = echarts.init($echartsDOM)\n            \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e option = {\n                \x3cspan class=\x22hljs-attr\x22\x3etitle\x3c\/span\x3e: {\n                    \x3cspan class=\x22hljs-attr\x22\x3etext\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27ECharts 入门示例\x27\x3c\/span\x3e\n                },\n                \x3cspan class=\x22hljs-attr\x22\x3etooltip\x3c\/span\x3e: {},\n                \x3cspan class=\x22hljs-attr\x22\x3elegend\x3c\/span\x3e: {\n                    \x3cspan class=\x22hljs-attr\x22\x3edata\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27销量\x27\x3c\/span\x3e]\n                },\n                \x3cspan class=\x22hljs-attr\x22\x3exAxis\x3c\/span\x3e: {\n                    \x3cspan class=\x22hljs-attr\x22\x3edata\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x22衬衫\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22羊毛衫\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22雪纺衫\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22裤子\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22高跟鞋\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22袜子\x22\x3c\/span\x3e]\n                },\n                \x3cspan class=\x22hljs-attr\x22\x3eyAxis\x3c\/span\x3e: {},\n                \x3cspan class=\x22hljs-attr\x22\x3eseries\x3c\/span\x3e: [{\n                    \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27销量\x27\x3c\/span\x3e,\n                    \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27bar\x27\x3c\/span\x3e,\n                    \x3cspan class=\x22hljs-attr\x22\x3edata\x3c\/span\x3e: [\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e36\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e]\n                }]\n            }\n            myEcharts.setOption(option)\n        }\n    }\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后在\x3ccode\x3eApp.vue\x3c\/code\x3e中引入这一组件，并设置 echarts 的宽高：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cstyle\x3e\n    .echarts-container{\n        width: 100%;\n        height: 20rem;\n    }\n\x3c\/style\x3e\n\n\x3ctemplate\x3e\n    \x3cdiv id=\x26quot;app\x26quot;\x3e\n        \x3ci-echart class=\x26quot;echarts-container\x26quot;\x3e\x3c\/i-echart\x3e\n    \x3c\/div\x3e\n\x3c\/template\x3e\n\n\x3cscript\x3e\n    import iEchart from \x27.\/components\/echart\x27\n\n    export default {\n        name: \x27app\x27,\n        components: {\n            iEchart\n        }\n    }\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3estyle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22css\x22\x3e\n    \x3cspan class=\x22hljs-selector-class\x22\x3e.echarts-container\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-attribute\x22\x3ewidth\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e100%\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-attribute\x22\x3eheight\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e20rem\x3c\/span\x3e;\n    }\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3estyle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22app\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ei-echart\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22echarts-container\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ei-echart\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e iEchart \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/components\/echart\x27\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27app\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3ecomponents\x3c\/span\x3e: {\n            iEchart\n        }\n    }\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e刷新页面后，即可看到柱状图。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e1.3 组件化\x3c\/h3\x3e\n\x3cp\x3e由于我们需要抽离 option 部分，最好的方式是将其作为组件的属性，即 props 交由调用方配置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22# echart.vue\n\nimport echarts from \x27echarts\x27\n\nexport default {\n    name: \x27echarts\x27,\n    props: {\n        option: {\n            type: Object,\n            default(){\n                return {}\n            }\n        }\n    },\n    data() {\n        return {}\n    },\n    mounted() {\n        let $echartsDOM = document.getElementById(\x27echarts-dom\x27)\n        let myEcharts = echarts.init($echartsDOM)\n        let option = this.option\n        myEcharts.setOption(option)\n    }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haskell\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-meta\x22\x3e# echart.vue\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e echarts from \x27echarts\x27\n\n\x3cspan class=\x22hljs-title\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n    name: \x27echarts\x27,\n    props: {\n        option: {\n            \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-type\x22\x3eObject\x3c\/span\x3e,\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e(){\n                return {}\n            }\n        }\n    },\n    \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e() {\n        \x3cspan class=\x22hljs-title\x22\x3ereturn\x3c\/span\x3e {}\x3c\/span\x3e\n    },\n    mounted() {\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e $echartsDOM = document.getElementById(\x27echarts-dom\x27)\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e myEcharts = echarts.init($echartsDOM)\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e option = this.option\n        myEcharts.setOption(option)\n    }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e1.4 调用组件\x3c\/h3\x3e\n\x3cp\x3e然后我们可以将 option 配置抽离到组件调用方，并通过「传参」的方式进行调用：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3ci-echart :option=\x26quot;option\x26quot; class=\x26quot;echarts-container\x26quot;\x3e\x3c\/i-echart\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x26lt;i-echart :option=\x3cspan class=\x22hljs-string\x22\x3e\x22option\x22\x3c\/span\x3e \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22echarts-container\x22\x3c\/span\x3e\x26gt;\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ei-echart\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e1.5 提高组件强壮型\x3c\/h3\x3e\n\x3cp\x3e之前我们注意到，在 option 参数中，我们给出了默认值 {}，即空对象。这样做其实是有问题的，即在 echarts 中，如果传入的 option 配置对象不含有 series 键，就会抛出错误：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Error: Option should contains series.\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs subunit\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eError: \x3c\/span\x3eOption should contains series.\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e默认值处理是需要存在的，即当调用方传入的对象为空或不存在 series 配置时，应在页面上显示一些提示（ 对用户友好的提示，而不是对编程人员 ），即避免因报错而造成空白的情况。\x3c\/p\x3e\n\x3cp\x3e此外，当我们像之前那样给 option 这一参数进行类型限制后，倘若调用方传入非对象类型，Vue 会直接抛出错误——这一结果也不是我们想要的。我们应该取消类型限制，并在 option 发生变化时进行依次以下判断：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x221. 是否为对象；\n2. 是否为空对象；\n3. 是否包含 series 键；\n4. series 是否为数组；\n5. series 数组是否为空。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs markdown\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-bullet\x22\x3e1. \x3c\/span\x3e是否为对象；\n\x3cspan class=\x22hljs-bullet\x22\x3e2. \x3c\/span\x3e是否为空对象；\n\x3cspan class=\x22hljs-bullet\x22\x3e3. \x3c\/span\x3e是否包含 series 键；\n\x3cspan class=\x22hljs-bullet\x22\x3e4. \x3c\/span\x3eseries 是否为数组；\n\x3cspan class=\x22hljs-bullet\x22\x3e5. \x3c\/span\x3eseries 数组是否为空。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e代码实现如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function isValidOption(option){\n    return isObject(option) \x26amp;\x26amp; !isEmptyObject(option)\n            \x26amp;\x26amp; hasSeriesKey(option)\n            \x26amp;\x26amp; isSeriesArray(option) \x26amp;\x26amp; !isSeriesEmpty(option)\n}\n\nfunction isObject(option) {\n    return Object.prototype.isPrototypeOf(option)\n}\n\nfunction isEmptyObject(option){\n    return Object.keys(option).length === 0\n}\n\nfunction hasSeriesKey(option){\n    return !!option[\x27series\x27]\n}\n\nfunction isSeriesArray(option) {\n    return Array.isArray(option[\x27series\x27])\n}\n\nfunction isSeriesEmpty(option){\n    return option[\x27series\x27].length === 0 \n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eisValidOption\x3c\/span\x3e(option){\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eisObject(option)\x3c\/span\x3e \x26amp;\x26amp; !isEmptyObject(option)\n            \x26amp;\x26amp; hasSeriesKey(option)\n            \x26amp;\x26amp; isSeriesArray(option) \x26amp;\x26amp; !isSeriesEmpty(option)\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eisObject\x3c\/span\x3e(option) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eObject.prototype.isPrototypeOf(option)\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eisEmptyObject\x3c\/span\x3e(option){\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eObject.keys(option).length\x3c\/span\x3e === \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ehasSeriesKey\x3c\/span\x3e(option){\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3e!!option[\x27series\x27]\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eisSeriesArray\x3c\/span\x3e(option) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eArray.isArray(option[\x27series\x27])\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eisSeriesEmpty\x3c\/span\x3e(option){\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eoption[\x27series\x27].length\x3c\/span\x3e === \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e \n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch6\x3e注：实际上，当判断出 option 为对象后，可以直接进行第三步的判断。\x3c\/h6\x3e\n\x3cp\x3e然后，当判断 option 符合上述三种情况时，在页面上显示如「数据为空」之类的提示：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import echarts from \x27echarts\x27\n\nexport default {\n    name: \x27echarts\x27,\n    props: {\n        option: {\n            default(){\n                return {}\n            }\n        }\n    },\n    data() {\n        return { }\n    },\n    mounted() {\n        \/\/# 1. 获取一个用于挂在 echarts 的 DOM 元素\n        let $echartsDOM = document.getElementById(\x27echarts-dom\x27)\n        \/\/# 2. 初始化\n        let myEcharts = echarts.init($echartsDOM)\n        \/\/# 3. 设置配置项    let option = {...}\n       \/\/# 4. 为 echarts 指定配置   myEcharts.setOption(option)\n        this.myEcharts = myEcharts\n        this.checkAndSetOption()\n    },\n    watch: {\n        option(option){\n            this.checkAndSetOption()\n        }\n    },\n    methods: {\n        checkAndSetOption(){\n            let option = this.option    \/\/配置等于父组件传过来的数据\n            if(isValidOption(option)){\n                this.myEcharts.setOption(option);       \/\/渲染出来\n                this.myEcharts.hideLoading();           \/\/隐藏加载动画\n            }else{\n                this.myEcharts.showLoading();           \/\/加载动画\n            }\n        }\n    }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e echarts from \x3cspan class=\x22hljs-string\x22\x3e\x27echarts\x27\x3c\/span\x3e\n\nexport \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n    name: \x3cspan class=\x22hljs-string\x22\x3e\x27echarts\x27\x3c\/span\x3e,\n    props: {\n        option: {\n            \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e(){\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {}\n            }\n        }\n    },\n    \x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e { }\n    },\n    mounted() {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/# 1. 获取一个用于挂在 echarts 的 DOM 元素\x3c\/span\x3e\n        let $echartsDOM = document.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27echarts-dom\x27\x3c\/span\x3e)\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/# 2. 初始化\x3c\/span\x3e\n        let myEcharts = echarts.init($echartsDOM)\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/# 3. 设置配置项    let option = {...}\x3c\/span\x3e\n       \x3cspan class=\x22hljs-comment\x22\x3e\/\/# 4. 为 echarts 指定配置   myEcharts.setOption(option)\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.myEcharts = myEcharts\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.checkAndSetOption()\n    },\n    watch: {\n        option(option){\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.checkAndSetOption()\n        }\n    },\n    methods: {\n        checkAndSetOption(){\n            let option = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.option    \x3cspan class=\x22hljs-comment\x22\x3e\/\/配置等于父组件传过来的数据\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(isValidOption(option)){\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.myEcharts.setOption(option);       \x3cspan class=\x22hljs-comment\x22\x3e\/\/渲染出来\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.myEcharts.hideLoading();           \x3cspan class=\x22hljs-comment\x22\x3e\/\/隐藏加载动画\x3c\/span\x3e\n            }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.myEcharts.showLoading();           \x3cspan class=\x22hljs-comment\x22\x3e\/\/加载动画\x3c\/span\x3e\n            }\n        }\n    }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里在书写代码时，有以下几点需要注意：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cstrong\x3e1、\x3c\/strong\x3e我们对 DOM 元素获取结果做了校验，即当 option 不符合要求时，ID       为 echarts-dom 的 DOM 元素是不存在的，此时 \x3ccode\x3edocument.getElementById()\x3c\/code\x3e 的返回结果为空，不能直接使用 \x3ccode\x3eecharts.init()\x3c\/code\x3e，否则会抛出错误：\x3ccode\x3eError: Initialize failed: invalid dom\x3c\/code\x3e；\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3e2、\x3c\/strong\x3e在 Vue 中，初始化的值不会被 watch 钩子捕捉，从而导致组件被调用方调用并赋予 option 参数时不会进入校验。虽然可以使用 \x3ccode\x3eimmediate: true\x3c\/code\x3e 使得 \x3ccode\x3ewatch\x3c\/code\x3e 钩子能够在属性初始化赋值时被触发，但这样做是不合适的。因为这样设置之后，在 option 初始化从而触发 watch 时，用于挂载 echarts 的 DOM 元素还未存在于页面中，从而导致出现 \x3ccode\x3eTypeError: Cannot read property \x27setOption\x27 of null\x3c\/code\x3e 的错误。我们要重点注意 echarts 作用的生命周期，这一点后续还会涉及。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e1.6 增强组件功能 - 数据加载提示\x3c\/h3\x3e\n\x3cp\x3e在实际场景中，用于渲染的数据常常是异步获取的，在异步加载数据之中，我们可能需要在页面中显示如「正在加载...」的字样来表示加载过程正在进行以提高用户体验。而加载过程就组件而言是无法直接获取的，所以，我们需要使用某一参数用于进行加载信息的显示\x3c\/p\x3e\n\x3cp\x3eECharts 默认有提供了一个简单的加载动画。只需要调用\x26nbsp;\x3ca href=\x22http:\/\/echarts.baidu.com\/api.html#echartsInstance.showLoading\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eshowLoading\x3c\/a\x3e\x26nbsp;方法显示。数据加载完成后再调用\x26nbsp;\x3ca href=\x22http:\/\/echarts.baidu.com\/api.html#echartsInstance.hideLoading\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehideLoading\x3c\/a\x3e\x26nbsp;方法隐藏加载动画。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/在App.vue中模拟3秒后获取数据\ndata() {\n  return {\n    option:  {}\n  }\n},\ncreated(){\n    setTimeout(()=\x3e{\n        this.option={\n                      title: {\n        text: \x27ECharts 入门示例\x27\n      },\n      tooltip: {},\n      legend: {\n        data: [\x27销量\x27]\n      },\n      xAxis: {\n        data: [\x26quot;衬衫\x26quot;, \x26quot;羊毛衫\x26quot;, \x26quot;雪纺衫\x26quot;, \x26quot;裤子\x26quot;, \x26quot;高跟鞋\x26quot;, \x26quot;袜子\x26quot;]\n      },\n      yAxis: {},\n      series: [{\n        name: \x27销量\x27,\n        type: \x27bar\x27,\n        data: [5, 20, 36, 10, 10, 20]\n      }]\n        }\n        console.log(this.option);\n    },3000)\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xquery\x22\x3e\x3ccode\x3e\/\/在App.vue中模拟\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e秒后获取数据\ndata() {\n  return {\n    option:  {}\n  }\n},\ncreated(){\n    setTimeout(()=\x26gt;{\n        this.option={\n                      title: {\n        text: \x3cspan class=\x22hljs-string\x22\x3e\x27ECharts 入门示例\x27\x3c\/span\x3e\n      },\n      tooltip: {},\n      legend: {\n        data: [\x3cspan class=\x22hljs-string\x22\x3e\x27销量\x27\x3c\/span\x3e]\n      },\n      xAxis: {\n        data: [\x3cspan class=\x22hljs-string\x22\x3e\x22衬衫\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22羊毛衫\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22雪纺衫\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22裤子\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22高跟鞋\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22袜子\x22\x3c\/span\x3e]\n      },\n      yAxis: {},\n      series: [{\n        name: \x3cspan class=\x22hljs-string\x22\x3e\x27销量\x27\x3c\/span\x3e,\n        type: \x3cspan class=\x22hljs-string\x22\x3e\x27bar\x27\x3c\/span\x3e,\n        data: [\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e36\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e]\n      }]\n        }\n        console.log(this.option);\n    },\x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e)\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后就可以在echarts组件里调用了\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22methods: {\n    checkAndSetOption(){\n        let option = this.option    \/\/配置等于父组件传过来的数据\n        if(isValidOption(option)){\n            this.myEcharts.setOption(option);       \/\/渲染出来\n            this.myEcharts.hideLoading();           \/\/隐藏加载动画\n        }else{\n            this.myEcharts.showLoading();           \/\/加载动画\n        }\n    }\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3emethods: {\n    checkAndSetOption(){\n        let option = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.option    \x3cspan class=\x22hljs-comment\x22\x3e\/\/配置等于父组件传过来的数据\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(isValidOption(option)){\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.myEcharts.setOption(option);       \x3cspan class=\x22hljs-comment\x22\x3e\/\/渲染出来\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.myEcharts.hideLoading();           \x3cspan class=\x22hljs-comment\x22\x3e\/\/隐藏加载动画\x3c\/span\x3e\n        }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.myEcharts.showLoading();           \x3cspan class=\x22hljs-comment\x22\x3e\/\/加载动画\x3c\/span\x3e\n        }\n    }\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e1.7 增强组件功能 - 数据不合法提示\x3c\/h3\x3e\n\x3cp\x3e当传入的 option 值不符合规定时。基于这一标识，我们可以对 echarts 组件进行优化，当 option 不合法或数据为空时给出提示信息而不是显示空白甚至报错。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3ePS:暂时更新到这了，如果有后续，我回接着更新了\x3c\/h2\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>做一个可复用的 echarts-vue 组件（延迟动画加载）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000012803831">https://segmentfault.com/a/1190000012803831</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/z6h4liz7mmo/" target="_blank">https://alili.tech/archive/z6h4liz7mmo/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>