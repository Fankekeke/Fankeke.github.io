<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Angular系列之变化检测(Change Detection)"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Angular系列之变化检测(Change Detection) | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/zvnv3kt7ylj/",
				"appid": "1613049289050283", 
				"title": "Angular系列之变化检测(Change Detection) | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-02T02:30:09"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/gtah5reudx/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/yncddz4mg5f/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fzvnv3kt7ylj%2f&text=Angular%e7%b3%bb%e5%88%97%e4%b9%8b%e5%8f%98%e5%8c%96%e6%a3%80%e6%b5%8b%28Change%20Detection%29"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fzvnv3kt7ylj%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fzvnv3kt7ylj%2f&text=Angular%e7%b3%bb%e5%88%97%e4%b9%8b%e5%8f%98%e5%8c%96%e6%a3%80%e6%b5%8b%28Change%20Detection%29"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fzvnv3kt7ylj%2f&title=Angular%e7%b3%bb%e5%88%97%e4%b9%8b%e5%8f%98%e5%8c%96%e6%a3%80%e6%b5%8b%28Change%20Detection%29"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fzvnv3kt7ylj%2f&is_video=false&description=Angular%e7%b3%bb%e5%88%97%e4%b9%8b%e5%8f%98%e5%8c%96%e6%a3%80%e6%b5%8b%28Change%20Detection%29"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Angular%e7%b3%bb%e5%88%97%e4%b9%8b%e5%8f%98%e5%8c%96%e6%a3%80%e6%b5%8b%28Change%20Detection%29&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fzvnv3kt7ylj%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fzvnv3kt7ylj%2f&title=Angular%e7%b3%bb%e5%88%97%e4%b9%8b%e5%8f%98%e5%8c%96%e6%a3%80%e6%b5%8b%28Change%20Detection%29"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fzvnv3kt7ylj%2f&title=Angular%e7%b3%bb%e5%88%97%e4%b9%8b%e5%8f%98%e5%8c%96%e6%a3%80%e6%b5%8b%28Change%20Detection%29"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fzvnv3kt7ylj%2f&title=Angular%e7%b3%bb%e5%88%97%e4%b9%8b%e5%8f%98%e5%8c%96%e6%a3%80%e6%b5%8b%28Change%20Detection%29"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fzvnv3kt7ylj%2f&title=Angular%e7%b3%bb%e5%88%97%e4%b9%8b%e5%8f%98%e5%8c%96%e6%a3%80%e6%b5%8b%28Change%20Detection%29"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Angular系列之变化检测(Change Detection)</h1><div class="meta"><div class="postdate"><time datetime="2019-01-02" itemprop="datePublished">2019-01-02</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e概述\x3c\/h1\x3e\n\x3cblockquote\x3e\x3cp\x3e简单来说变化检测就是\x3ccode\x3eAngular\x3c\/code\x3e用来检测视图与模型之间绑定的值是否发生了改变，当检测到模型中绑定的值发生改变时，则同步到视图上，反之，当检测到视图上绑定的值发生改变时，则回调对应的绑定函数。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3e什么情况下会引起变化检测？\x3c\/h1\x3e\n\x3cp\x3e总结起来, 主要有如下几种情况可能也改变数据：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e用户输入操作，比如点击，提交等\x3c\/li\x3e\n\x3cli\x3e请求服务端数据(XHR)\x3c\/li\x3e\n\x3cli\x3e定时事件，比如\x3ccode\x3esetTimeout\x3c\/code\x3e，\x3ccode\x3esetInterval\x3c\/code\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e上述三种情况都有一个共同点，即这些导致绑定值发生改变的事件都是异步发生的。如果这些异步的事件在发生时能够通知到\x3ccode\x3eAngular\x3c\/code\x3e框架，那么\x3ccode\x3eAngular\x3c\/code\x3e框架就能及时的检测到变化。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVT0qO?w=663\x26amp;h=291\x22 src=\x22https:\/\/static.alili.tech\/img\/bVT0qO?w=663\x26amp;h=291\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e左边表示将要运行的代码，这里的\x3ccode\x3estack\x3c\/code\x3e表示\x3ccode\x3eJavascript\x3c\/code\x3e的运行栈，而\x3ccode\x3ewebApi\x3c\/code\x3e则是浏览器中提供的一些\x3ccode\x3eJavascript\x3c\/code\x3e的\x3ccode\x3eAPI\x3c\/code\x3e，\x3ccode\x3eTaskQueue\x3c\/code\x3e表示\x3ccode\x3eJavascript\x3c\/code\x3e中任务队列，因为\x3ccode\x3eJavascript\x3c\/code\x3e是单线程的，异步任务在任务队列中执行。\x3c\/p\x3e\n\x3cp\x3e具体来说，异步执行的运行机制如下:\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e所有同步任务都在主线程上执行，形成一个执行栈（\x3ccode\x3eexecution context stack\x3c\/code\x3e）。\x3c\/li\x3e\n\x3cli\x3e主线程之外，还存在一个\x22任务队列\x22（\x3ccode\x3etask queue\x3c\/code\x3e）。只要异步任务有了运行结果，就在\x22任务队列\x22之        中放置一个事件。\x3c\/li\x3e\n\x3cli\x3e一旦\x22执行栈\x22中的所有同步任务执行完毕，系统就会读取\x22任务队列\x22，看看里面有哪些事件。那些对应的异步任务，于是结束等待状态，进入执行栈，开始执行。\x3c\/li\x3e\n\x3cli\x3e主线程不断重复上面的第三步。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e当上述代码在\x3ccode\x3eJavascript\x3c\/code\x3e中执行时，首先\x3ccode\x3efunc1\x3c\/code\x3e 进入运行栈，\x3ccode\x3efunc1\x3c\/code\x3e执行完毕后，\x3ccode\x3esetTimeout\x3c\/code\x3e进入运行栈，执行\x3ccode\x3esetTimeout\x3c\/code\x3e过程中将回调函数\x3ccode\x3ecb\x3c\/code\x3e 加入到任务队列，然后\x3ccode\x3esetTimeout\x3c\/code\x3e出栈，接着执行\x3ccode\x3efunc2\x3c\/code\x3e函数，\x3ccode\x3efunc2\x3c\/code\x3e函数执行完毕时，运行栈为空，接着任务队列中\x3ccode\x3ecb\x3c\/code\x3e 进入运行栈得到执行。可以看出异步任务首先会进入任务队列，当运行栈中的同步任务都执行完毕时，异步任务进入运行栈得到执行。如果这些异步的任务执行前与执行后能提供一些钩子函数，通过这些钩子函数，\x3ccode\x3eAngular\x3c\/code\x3e便能获知异步任务的执行。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3eangular2 获取变化通知\x3c\/h1\x3e\n\x3cp\x3e那么问题来了，\x3ccode\x3eangular2\x3c\/code\x3e是如何知道数据发生了改变？又是如何知道需要修改DOM的位置，准确的最小范围的修改DOM呢？没错，尽可能小的范围修改DOM，因为操作DOM对于性能来说可是一件奢侈品。\x3c\/p\x3e\n\x3cp\x3e在\x3ccode\x3eAngularJS\x3c\/code\x3e中是由代码\x3ccode\x3e$scope.$apply()\x3c\/code\x3e或者\x3ccode\x3e$scope.$digest\x3c\/code\x3e触发，而\x3ccode\x3eAngular\x3c\/code\x3e接入了\x3ccode\x3eZoneJS\x3c\/code\x3e，由它监听了\x3ccode\x3eAngular\x3c\/code\x3e所有的异步事件。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eZoneJS\x3c\/code\x3e是怎么做到的呢？\x3c\/p\x3e\n\x3cp\x3e实际上Zone有一个叫猴子补丁的东西。在\x3ccode\x3eZone.js\x3c\/code\x3e运行时，就会为这些异步事件做一层代理包裹，也就是说Zone.js运行后，调用\x3ccode\x3esetTimeout、addEventListener\x3c\/code\x3e等浏览器异步事件时，不再是调用原生的方法，而是被猴子补丁包装过后的代理方法。代理里setup了钩子函数, 通过这些钩子函数, 可以方便的进入异步任务执行的上下文.\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/以下是Zone.js启动时执行逻辑的抽象代码片段\nfunction zoneAwareAddEventListener() {...}\nfunction zoneAwareRemoveEventListener() {...}\nfunction zoneAwarePromise() {...}\nfunction patchTimeout() {...}\nwindow.prototype.addEventListener=zoneAwareAddEventListener;\nwindow.prototype.removeEventListener=zoneAwareRemoveEventListener;\nwindow.prototype.promise = zoneAwarePromise;\nwindow.prototype.setTimeout = patchTimeout;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/以下是Zone.js启动时执行逻辑的抽象代码片段\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ezoneAwareAddEventListener\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{...}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ezoneAwareRemoveEventListener\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{...}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ezoneAwarePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{...}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3epatchTimeout\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{...}\n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.prototype.addEventListener=zoneAwareAddEventListener;\n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.prototype.removeEventListener=zoneAwareRemoveEventListener;\n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.prototype.promise = zoneAwarePromise;\n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.prototype.setTimeout = patchTimeout;\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader3\x22\x3e变化检测的过程\x3c\/h1\x3e\n\x3cp\x3e\x3ccode\x3eAngular\x3c\/code\x3e的核心是组件化，组件的嵌套会使得最终形成一棵组件树。Angular的变化检测可以分组件进行，每一个\x3ccode\x3eComponent\x3c\/code\x3e都对应有一个changeDetector，我们可以在Component中通过依赖注入来获取到\x3ccode\x3echangeDetector\x3c\/code\x3e。而我们的多个\x3ccode\x3eComponent\x3c\/code\x3e是一个树状结构的组织，由于一个Component对应一个\x3ccode\x3echangeDetector\x3c\/code\x3e，那么\x3ccode\x3echangeDetector\x3c\/code\x3e之间同样是一个树状结构的组织.\x3c\/p\x3e\n\x3cp\x3e另外，Angular的数据流是自顶而下，从父组件到子组件单向流动。单向数据流向保证了高效、可预测的变化检测。尽管检查了父组件之后，子组件可能会改变父组件的数据使得父组件需要再次被检查，这是不被推荐的数据处理方式。在开发模式下，Angular会进行二次检查，如果出现上述情况，二次检查就会报错：\x3ccode\x3eExpression Changed After It Has Been Checked Error\x3c\/code\x3e。而在生产环境中，脏检查只会执行一次。\x3c\/p\x3e\n\x3cp\x3e相比之下，\x3ccode\x3eAngularJS\x3c\/code\x3e采用的是双向数据流，错综复杂的数据流使得它不得不多次检查，使得数据最终趋向稳定。理论上，数据可能永远不稳定。\x3ccode\x3eAngularJS\x3c\/code\x3e给出的策略是，脏检查超过10次，就认为程序有问题，不再进行检查。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVT00z?w=600\x26amp;h=450\x22 src=\x22https:\/\/static.alili.tech\/img\/bVT00z?w=600\x26amp;h=450\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader4\x22\x3e变化检测策略\x3c\/h1\x3e\n\x3cblockquote\x3e\x3cp\x3eAngular有两种变化检测策略。\x3ccode\x3eDefault\x3c\/code\x3e是Angular默认的变化检测策略，也就是上述提到的脏检查,只要有值发生变化，就全部从父组件到所有子组件进行检查,。另一种更加高效的变化检测方式：\x3ccode\x3eOnPush\x3c\/code\x3e。OnPush策略，\x3cstrong\x3e就是只有当输入数据(即@Input)的引用发生变化或者有事件触发时，组件才进行变化检测。\x3c\/strong\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3edefalut 策略\x3c\/h2\x3e\n\x3cp\x3emain.component.ts\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@Component({\n  selector: \x27app-root\x27,\n  template: `\n  \x3ch1\x3e变更检测策略\x3c\/h1\x3e\n  \x3cp\x3e\x22{{\x22 slogan \x22}}\x22\x3c\/p\x3e\n  \x3cbutton type=\x26quot;button\x26quot; (click)=\x26quot;changeStar()\x26quot;\x3e  改变明星属性\n  \x3c\/button\x3e\n  \x3cbutton type=\x26quot;button\x26quot; (click)=\x26quot;changeStarObject()\x26quot;\x3e\n     改变明星对象\n  \x3c\/button\x3e\n  \x3cmovie [title]=\x26quot;title\x26quot; [star]=\x26quot;star\x26quot;\x3e\x3c\/movie\x3e`,\n})\nexport class AppComponent {\n  slogan: string = \x27change detection\x27;\n  title: string = \x27default 策略\x27;\n  star: Star = new Star(\x27周\x27, \x27杰伦\x27);\n  changeStar() {\n    this.star.firstName = \x27吴\x27;\n    this.star.lastName = \x27彦祖\x27;\n  }\n  changeStarObject() {\n    this.star = new Star(\x27刘\x27, \x27德华\x27);\n  }\n  \n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e@Component({\n  selector: \x3cspan class=\x22hljs-string\x22\x3e\x27app-root\x27\x3c\/span\x3e,\n  template: `\x3cspan class=\x22javascript\x22\x3e\n  \x26lt;h1\x26gt;变更检测策略\x26lt;\x3cspan class=\x22hljs-regexp\x22\x3e\/h1\x26gt;\n  \x26lt;p\x26gt;\x22{{\x22 slogan \x22}}\x22\x26lt;\/\x3c\/span\x3ep\x26gt;\n  \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22button\x22\x3c\/span\x3e (\x3cspan class=\x22hljs-attr\x22\x3eclick\x3c\/span\x3e)=\x3cspan class=\x22hljs-string\x22\x3e\x22changeStar()\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e  改变明星属性\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n  \x26lt;button type=\x3cspan class=\x22hljs-string\x22\x3e\x22button\x22\x3c\/span\x3e (click)=\x3cspan class=\x22hljs-string\x22\x3e\x22changeStarObject()\x22\x3c\/span\x3e\x26gt;\n     改变明星对象\n  \x26lt;\x3cspan class=\x22hljs-regexp\x22\x3e\/button\x26gt;\n  \x26lt;movie [title]=\x22title\x22 [star]=\x22star\x22\x26gt;\x26lt;\/m\x3c\/span\x3eovie\x26gt;\x3c\/span\x3e`,\n})\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eAppComponent\x3c\/span\x3e {\x3c\/span\x3e\n  slogan: string = \x3cspan class=\x22hljs-string\x22\x3e\x27change detection\x27\x3c\/span\x3e;\n  title: string = \x3cspan class=\x22hljs-string\x22\x3e\x27default 策略\x27\x3c\/span\x3e;\n  star: Star = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Star(\x3cspan class=\x22hljs-string\x22\x3e\x27周\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27杰伦\x27\x3c\/span\x3e);\n  changeStar() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.star.firstName = \x3cspan class=\x22hljs-string\x22\x3e\x27吴\x27\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.star.lastName = \x3cspan class=\x22hljs-string\x22\x3e\x27彦祖\x27\x3c\/span\x3e;\n  }\n  changeStarObject() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.star = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Star(\x3cspan class=\x22hljs-string\x22\x3e\x27刘\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27德华\x27\x3c\/span\x3e);\n  }\n  \n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3emovie.component.ts\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@Component({\n  selector: \x27movie\x27,\n  styles: [\x27div {border: 1px solid black}\x27],\n  template: `\n\x3cdiv\x3e\n\x3ch3\x3e\x22{{\x22 title \x22}}\x22\x3c\/h3\x3e\n\x3cp\x3e\n\x3clabel\x3eStar:\x3c\/label\x3e\n\x3cspan\x3e\x22{{\x22star.firstName\x22}}\x22 \x22{{\x22star.lastName\x22}}\x22\x3c\/span\x3e\n\x3c\/p\x3e\n\x3c\/div\x3e`,\n\n})\nexport class MovieComponent {\n  @Input() title: string;\n  @Input() star;\n\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e@Component({\n  selector: \x3cspan class=\x22hljs-string\x22\x3e\x27movie\x27\x3c\/span\x3e,\n  styles: [\x3cspan class=\x22hljs-string\x22\x3e\x27div {border: 1px solid black}\x27\x3c\/span\x3e],\n  template: `\x3cspan class=\x22javascript\x22\x3e\n\x26lt;div\x26gt;\n\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x22{{\x22 title \x22}}\x22\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n\x26lt;p\x26gt;\n\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e\x26gt;\x3c\/span\x3eStar:\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n\x26lt;span\x26gt;\x22{{\x22star.firstName\x22}}\x22 \x22{{\x22star.lastName\x22}}\x22\x26lt;\x3cspan class=\x22hljs-regexp\x22\x3e\/span\x26gt;\n\x26lt;\/\x3c\/span\x3ep\x26gt;\n\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3c\/span\x3e`,\n\n})\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eMovieComponent\x3c\/span\x3e {\x3c\/span\x3e\n  @Input() title: string;\n  @Input() star;\n\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面代码中, 当点击第一个按钮改变明星属性时,依次对\x3ccode\x3eslogan\x3c\/code\x3e, \x3ccode\x3etitle\x3c\/code\x3e, \x3ccode\x3estar\x3c\/code\x3e三个属性进行检测, 此时三个属性都没有变化, \x3ccode\x3estar\x3c\/code\x3e没有发生变化,是因为实质上在对\x3ccode\x3estar\x3c\/code\x3e检测时只检测\x3ccode\x3estar\x3c\/code\x3e本身的引用值是否发生了改变，改变\x3ccode\x3estar\x3c\/code\x3e的属性值并未改变\x3ccode\x3estar\x3c\/code\x3e本身的引用，因此是没有发生变化。\x3c\/p\x3e\n\x3cp\x3e而当我们点击第二个按钮改变明星对象时 ，重新new了一个 \x3ccode\x3estar\x3c\/code\x3e ，这时变化检测才会检测到 \x3ccode\x3estar\x3c\/code\x3e发生了改变。\x3c\/p\x3e\n\x3cp\x3e然后变化检测进入到子组件中,检测到\x3ccode\x3estar.firstName\x3c\/code\x3e和\x3ccode\x3estar.lastName\x3c\/code\x3e发生了变化, 然后更新视图.\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3eOnPush策略\x3c\/h2\x3e\n\x3cp\x3e与上面代码相比, 只在\x3ccode\x3emovie.component.ts\x3c\/code\x3e中的\x3ccode\x3e@component\x3c\/code\x3e中增加了一行代码:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 changeDetection:ChangeDetectionStrategy.OnPush \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e changeDetection:ChangeDetectionStrategy\x3cspan class=\x22hljs-selector-class\x22\x3e.OnPush\x3c\/span\x3e \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e此时, 当点击第一个按钮时, 检测到\x3ccode\x3estar\x3c\/code\x3e没有发生变化, ok,变化检测到此结束, 不会进入到子组件中, 视图不会发生变化.\x3c\/p\x3e\n\x3cp\x3e当点击第二个按钮时,检测到\x3ccode\x3estar\x3c\/code\x3e发生了变化, 然后变化检测进入到子组件中,检测到\x3ccode\x3estar.firstName\x3c\/code\x3e和\x3ccode\x3estar.lastName\x3c\/code\x3e发生了变化, 然后更新视图.\x3c\/p\x3e\n\x3cp\x3e所以，当你使用了\x3ccode\x3eOnPush\x3c\/code\x3e检测机制时，在修改一个绑定值的属性时，要确保同时修改到了绑定值本身的引用。但是每次需要改变属性值的时候去new一个新的对象会很麻烦，immutable.js 你值得拥有！\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e变化检测对象引用\x3c\/h2\x3e\n\x3cp\x3e通过引用变化检测对象\x3ccode\x3eChangeDetectorRef\x3c\/code\x3e，可以手动去操作变化检测。我们可以在组件中的通过依赖注入的方式来获取该对象：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22constructor(\n    private changeRef:ChangeDetectorRef\n  ){}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs delphi\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(\n    \x3cspan class=\x22hljs-keyword\x22\x3eprivate\x3c\/span\x3e changeRef:ChangeDetectorRef\n  )\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e{}\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e变化检测对象提供的方法有以下几种：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ccode\x3emarkForCheck()\x3c\/code\x3e - 在组件的 metadata 中如果设置了 \x3ccode\x3echangeDetection:ChangeDetectionStrategy.OnPush\x3c\/code\x3e 条件，那么变化检测不会再次执行，除非手动调用该方法, 该方法的意思是在变化监测时必须检测该组件。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3edetach()\x3c\/code\x3e - 从变化检测树中分离变化检测器，该组件的变化检测器将不再执行变化检测，除非手动调用 reattach() 方法。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3ereattach()\x3c\/code\x3e - 重新添加已分离的变化检测器，使得该组件及其子组件都能执行变化检测\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3edetectChanges()\x3c\/code\x3e - 从该组件到各个子组件执行一次变化检测\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3eOnPush策略下手动发起变化检测\x3c\/h2\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cp\x3e组件中添加事件改变输入属性\x3c\/p\x3e\n\x3cp\x3e在上面代码movie.component.ts中修改如下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@Component({\n  selector: \x27movie\x27,\n  styles: [\x27div {border: 1px solid black}\x27],\n  template: `\n\x3cdiv\x3e\n\x3ch3\x3e\x22{{\x22 title \x22}}\x22\x3c\/h3\x3e\n\x3cp\x3e\n\x3cbutton (click)=\x26quot;changeStar()\x26quot;\x3e点击切换名字\x3c\/button\x3e        \n\x3clabel\x3eStar:\x3c\/label\x3e\n\x3cspan\x3e\x22{{\x22star.firstName\x22}}\x22 \x22{{\x22star.lastName\x22}}\x22\x3c\/span\x3e\n\x3c\/p\x3e\n\x3c\/div\x3e`,\nchangeDetection:ChangeDetectionStrategy.OnPush\n})\nexport class MovieComponent {\n  constructor(\n    private changeRef:ChangeDetectorRef\n  ){}\n  @Input() title: string;\n  @Input() star;\n  \n  changeStar(){\n    this.star.lastName = \x27xjl\x27;\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e@Component({\n  selector: \x3cspan class=\x22hljs-string\x22\x3e\x27movie\x27\x3c\/span\x3e,\n  styles: [\x3cspan class=\x22hljs-string\x22\x3e\x27div {border: 1px solid black}\x27\x3c\/span\x3e],\n  template: `\x3cspan class=\x22javascript\x22\x3e\n\x26lt;div\x26gt;\n\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x22{{\x22 title \x22}}\x22\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n\x26lt;p\x26gt;\n\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e (\x3cspan class=\x22hljs-attr\x22\x3eclick\x3c\/span\x3e)=\x3cspan class=\x22hljs-string\x22\x3e\x22changeStar()\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e点击切换名字\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e        \n\x26lt;label\x26gt;Star:\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n\x26lt;span\x26gt;\x22{{\x22star.firstName\x22}}\x22 \x22{{\x22star.lastName\x22}}\x22\x26lt;\x3cspan class=\x22hljs-regexp\x22\x3e\/span\x26gt;\n\x26lt;\/\x3c\/span\x3ep\x26gt;\n\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3c\/span\x3e`,\nchangeDetection:ChangeDetectionStrategy.OnPush\n})\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eMovieComponent\x3c\/span\x3e {\x3c\/span\x3e\n  constructor(\n    private changeRef:ChangeDetectorRef\n  ){}\n  @Input() title: string;\n  @Input() star;\n  \n  changeStar(){\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.star.lastName = \x3cspan class=\x22hljs-string\x22\x3e\x27xjl\x27\x3c\/span\x3e;\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e此时点击按钮切换名字时,star更改如下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22![图片描述][3]\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs markdown\x22\x3e\x3ccode\x3e![\x3cspan class=\x22hljs-string\x22\x3e图片描述\x3c\/span\x3e][\x3cspan class=\x22hljs-symbol\x22\x3e3\x3c\/span\x3e]\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cp\x3e第二种就是上面讲到的使用变化检测对象中的 \x3ccode\x3emarkForCheck()\x3c\/code\x3e方法.\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ngOnInit() {\n    setInterval(() =\x3e {\n      this.star.lastName = \x27xjl\x27;\n      this.changeRef.markForCheck();\n    }, 1000);\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3engOnInit() {\n    setInterval(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.star.lastName = \x3cspan class=\x22hljs-string\x22\x3e\x27xjl\x27\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.changeRef.markForCheck();\n    }, \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e);\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\x3c\/ul\x3e\n\x3ch1 id=\x22articleHeader9\x22\x3e输入属性为Observable\x3c\/h1\x3e\n\x3cp\x3e修改app.component.ts\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@Component({\n  selector: \x27app-root\x27,\n  template: `\n  \x3ch1\x3e变更检测策略\x3c\/h1\x3e\n  \x3cp\x3e\x22{{\x22 slogan \x22}}\x22\x3c\/p\x3e\n  \x3cbutton type=\x26quot;button\x26quot; (click)=\x26quot;changeStar()\x26quot;\x3e  改变明星属性\n  \x3c\/button\x3e\n  \x3cbutton type=\x26quot;button\x26quot; (click)=\x26quot;changeStarObject()\x26quot;\x3e\n     改变明星对象\n  \x3c\/button\x3e\n  \x3cmovie [title]=\x26quot;title\x26quot; [star]=\x26quot;star\x26quot; [addCount]=\x26quot;count\x26quot;\x3e\x3c\/movie\x3e`,\n})\nexport class AppComponent implements OnInit{\n  slogan: string = \x27change detection\x27;\n  title: string = \x27OnPush 策略\x27;\n  star: Star = new Star(\x27周\x27, \x27杰伦\x27);\n  count:Observable\x3cany\x3e;\n\n  ngOnInit(){\n    this.count = Observable.timer(0, 1000)\n  }\n  changeStar() {\n    this.star.firstName = \x27吴\x27;\n    this.star.lastName = \x27彦祖\x27;\n  }\n  changeStarObject() {\n    this.star = new Star(\x27刘\x27, \x27德华\x27);\n  }\n  \n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs arduino\x22\x3e\x3ccode\x3e@Component({\n  selector: \x3cspan class=\x22hljs-string\x22\x3e\x27app-root\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-keyword\x22\x3etemplate\x3c\/span\x3e: `\n  \x26lt;h1\x26gt;变更检测策略\x26lt;\/h1\x26gt;\n  \x26lt;p\x26gt;\x22{{\x22 slogan \x22}}\x22\x26lt;\/p\x26gt;\n  \x26lt;button type=\x3cspan class=\x22hljs-string\x22\x3e\x22button\x22\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3eclick\x3c\/span\x3e)=\x3cspan class=\x22hljs-string\x22\x3e\x22changeStar()\x22\x3c\/span\x3e\x26gt;  改变明星属性\n  \x26lt;\/button\x26gt;\n  \x26lt;button type=\x3cspan class=\x22hljs-string\x22\x3e\x22button\x22\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3eclick\x3c\/span\x3e)=\x3cspan class=\x22hljs-string\x22\x3e\x22changeStarObject()\x22\x3c\/span\x3e\x26gt;\n     改变明星对象\n  \x26lt;\/button\x26gt;\n  \x26lt;movie [title]=\x3cspan class=\x22hljs-string\x22\x3e\x22title\x22\x3c\/span\x3e [star]=\x3cspan class=\x22hljs-string\x22\x3e\x22star\x22\x3c\/span\x3e [addCount]=\x3cspan class=\x22hljs-string\x22\x3e\x22count\x22\x3c\/span\x3e\x26gt;\x26lt;\/movie\x26gt;`,\n})\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e AppComponent implements OnInit{\n  slogan: \x3cspan class=\x22hljs-keyword\x22\x3estring\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x27change detection\x27\x3c\/span\x3e;\n  title: \x3cspan class=\x22hljs-keyword\x22\x3estring\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x27OnPush 策略\x27\x3c\/span\x3e;\n  star: Star = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Star(\x3cspan class=\x22hljs-string\x22\x3e\x27周\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27杰伦\x27\x3c\/span\x3e);\n  count:Observable\x26lt;any\x26gt;;\n\n  ngOnInit(){\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.count = Observable.timer(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e)\n  }\n  changeStar() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.star.firstName = \x3cspan class=\x22hljs-string\x22\x3e\x27吴\x27\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.star.lastName = \x3cspan class=\x22hljs-string\x22\x3e\x27彦祖\x27\x3c\/span\x3e;\n  }\n  changeStarObject() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.star = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Star(\x3cspan class=\x22hljs-string\x22\x3e\x27刘\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27德华\x27\x3c\/span\x3e);\n  }\n  \n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e此时,有两种方式让MovieComponent进入检测,一种是使用变化检测对象中的 \x3ccode\x3emarkForCheck()\x3c\/code\x3e方法.\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ngOnInit() {\n    this.addCount.subscribe(() =\x3e {\n      this.count\x2b\x2b;\n      this.changeRef.markForCheck();\n    })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3engOnInit() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.addCount.subscribe(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.count\x2b\x2b;\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.changeRef.markForCheck();\n    })\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e另外一种是使用async pipe 管道\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@Component({\n  selector: \x27movie\x27,\n  styles: [\x27div {border: 1px solid black}\x27],\n  template: `\n\x3cdiv\x3e\n\x3ch3\x3e\x22{{\x22 title \x22}}\x22\x3c\/h3\x3e\n\x3cp\x3e\n\x3cbutton (click)=\x26quot;changeStar()\x26quot;\x3e点击切换名字\x3c\/button\x3e        \n\x3clabel\x3eStar:\x3c\/label\x3e\n\x3cspan\x3e\x22{{\x22star.firstName\x22}}\x22 \x22{{\x22star.lastName\x22}}\x22\x3c\/span\x3e\n\x3c\/p\x3e\n\x3cp\x3e\x22{{\x22addCount | async\x22}}\x22\x3c\/p\x3e\n\x3c\/div\x3e`,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dust\x22\x3e\x3ccode\x3e\x3cspan class=\x22xml\x22\x3e@Component(\x3c\/span\x3e\x3cspan class=\x22hljs-template-variable\x22\x3e{\n  selector: \x27movie\x27,\n  styles: [\x27div {border: 1px solid black}\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e\x27],\n  template: `\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-template-variable\x22\x3e\x22{{\x22 title }\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh3\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e (\x3cspan class=\x22hljs-attr\x22\x3eclick\x3c\/span\x3e)=\x3cspan class=\x22hljs-string\x22\x3e\x22changeStar()\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e点击切换名字\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e        \n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e\x26gt;\x3c\/span\x3eStar:\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-template-variable\x22\x3e\x22{{\x22star.firstName}\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e} \x3c\/span\x3e\x3cspan class=\x22hljs-template-variable\x22\x3e\x22{{\x22star.lastName}\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-template-variable\x22\x3e\x22{{\x22addCount | async}\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e`,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\n\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Angular系列之变化检测(Change Detection)</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010928087">https://segmentfault.com/a/1190000010928087</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/zvnv3kt7ylj/" target="_blank">https://alili.tech/archive/zvnv3kt7ylj/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/hvvo3rmt3dj/">JS打包工具rollup——完全入门指南<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/semhn25oasq/">Spring Boot [基于Spring Boot 与 Vue的后台脚手架] SanJi Boot Security<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/t1iml4tjj7r/">WebGL入门demo<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/8gbs1y0r0ns/">[面试专题]一线互联网大厂面试总结<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/4os59l0zeel/">react&#43;react-router4&#43;redux最新版构建分享<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/dznv6a9ewcj/">react虚拟dom机制与diff算法<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/myiqarfowok/">一套Vue的单页模板：N3-admin<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/2eeweuxgjbk/">使用 json-server 搭建 api mock 服务 (一)<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/h7cszygcoqq/">使用Ionic3框架开始第一个混合开发APP<aside class="dates">2019-01-04</aside></a></li><li><a href="/archive/g8by6kv9q8t/">如何只用 CSS 完成漂亮的加载<aside class="dates">2019-01-04</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>